[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m31183 | [0m[35m    }[0m
[30;1m31184 | [0m[35m    return bytes;[0m
[30;1m31185 | [0m[35m  } catch (_) {[0m
[30;1m31186 | [0m[35m    throw new Error('Converting base64 string to bytes failed.');[0m
[30;1m31187 | [0m[35m  }[0m
[30;1m31188 | [0m[35m}[0m
[30;1m31189 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m31170 | [0m[35m      /**@suppress{checkTypes}*/[0m
[30;1m31171 | [0m[35m      buf = Buffer.from(s, 'base64');[0m
[30;1m31172 | [0m[35m    } catch (_) {[0m
[30;1m31173 | [0m[35m      buf = new Buffer(s, 'base64');[0m
[30;1m31174 | [0m[35m    }[0m
[30;1m31175 | [0m[35m    return new Uint8Array(buf['buffer'], buf['byteOffset'], buf['byteLength']);[0m
[30;1m31176 | [0m[35m  }[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m31168 | [0m[35m    try {[0m
[30;1m31169 | [0m[35m      // TODO: Update Node.js externs, Closure does not recognize the following Buffer.from()[0m
[30;1m31170 | [0m[35m      /**@suppress{checkTypes}*/[0m
[30;1m31171 | [0m[35m      buf = Buffer.from(s, 'base64');[0m
[30;1m31172 | [0m[35m    } catch (_) {[0m
[30;1m31173 | [0m[35m      buf = new Buffer(s, 'base64');[0m
[30;1m31174 | [0m[35m    }[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m28343 | [0m[35m}[0m
[30;1m28344 | [0m[35m[0m
[30;1m28345 | [0m[35m// Prefix of data URIs emitted by SINGLE_FILE and related options.[0m
[30;1m28346 | [0m[35mvar dataURIPrefix = 'data:application/octet-stream;base64,';[0m
[30;1m28347 | [0m[35m[0m
[30;1m28348 | [0m[35m// Indicates whether filename is a base64 data URI.[0m
[30;1m28349 | [0m[35mfunction isDataURI(filename) {[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m33 | [0m[35m		// like Node.[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m		// use process.env (if available) for reading Flac environment settings:[0m
[30;1m36 | [0m[35m		var env = typeof process !== 'undefined' && process && process.env? process.env : root;[0m
[30;1m37 | [0m[35m		factory(env, module, module.require);[0m
[30;1m38 | [0m[35m	} else {[0m
[30;1m39 | [0m[35m		// Browser globals[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m33 | [0m[35m		// like Node.[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m		// use process.env (if available) for reading Flac environment settings:[0m
[30;1m36 | [0m[35m		var env = typeof process !== 'undefined' && process && process.env? process.env : root;[0m
[30;1m37 | [0m[35m		factory(env, module, module.require);[0m
[30;1m38 | [0m[35m	} else {[0m
[30;1m39 | [0m[35m		// Browser globals[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m32 | [0m[35m		// only CommonJS-like environments that support module.exports,[0m
[30;1m33 | [0m[35m		// like Node.[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m		// use process.env (if available) for reading Flac environment settings:[0m
[30;1m36 | [0m[35m		var env = typeof process !== 'undefined' && process && process.env? process.env : root;[0m
[30;1m37 | [0m[35m		factory(env, module, module.require);[0m
[30;1m38 | [0m[35m	} else {[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m30656 | [0m[35m          this.lengthKnown = true;[0m
[30;1m30657 | [0m[35m        };[0m
[30;1m30658 | [0m[35m        if (typeof XMLHttpRequest !== 'undefined') {[0m
[30;1m30659 | [0m[35m          if (!ENVIRONMENT_IS_WORKER) throw 'Cannot do synchronous binary XHRs outside webworkers in[0m
[30;1m30660 | [0m[35m          var lazyArray = new LazyUint8Array();[0m
[30;1m30661 | [0m[35m          Object.defineProperties(lazyArray, {[0m
[30;1m30662 | [0m[35m            length: {[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m28389 | [0m[35mfunction getBinaryPromise() {[0m
[30;1m28390 | [0m[35m  // If we don't have the binary yet, and have the Fetch api, use that;[0m
[30;1m28391 | [0m[35m  // in some environments, like Electron's render process, Fetch api may be present, but have a diff[0m
[30;1m28392 | [0m[35m  if (!wasmBinary && (ENVIRONMENT_IS_WEB || ENVIRONMENT_IS_WORKER) && typeof fetch === 'function'[0m
[30;1m28393 | [0m[35m      // Let's not use fetch to get objects over file:// as it's most likely Cordova which doesn't s[0m
[30;1m28394 | [0m[35m      && !isFileURI(wasmBinaryFile)[0m
[30;1m28395 | [0m[35m      ) {[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m278 | [0m[35m// Node.js workers are detected as a combination of ENVIRONMENT_IS_WORKER and[0m
[30;1m279 | [0m[35m// ENVIRONMENT_IS_NODE.[0m
[30;1m280 | [0m[35mif (ENVIRONMENT_IS_WEB || ENVIRONMENT_IS_WORKER) {[0m
[30;1m281 | [0m[35m  if (ENVIRONMENT_IS_WORKER) { // Check worker, not web, since window could be polyfilled[0m
[30;1m282 | [0m[35m    scriptDirectory = self.location.href;[0m
[30;1m283 | [0m[35m  } else if (document.currentScript) { // web[0m
[30;1m284 | [0m[35m    scriptDirectory = document.currentScript.src;[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m144 | [0m[35mvar ENVIRONMENT_IS_NODE = false;[0m
[30;1m145 | [0m[35mvar ENVIRONMENT_IS_SHELL = false;[0m
[30;1m146 | [0m[35mENVIRONMENT_IS_WEB = typeof window === 'object';[0m
[30;1m147 | [0m[35mENVIRONMENT_IS_WORKER = typeof importScripts === 'function';[0m
[30;1m148 | [0m[35m// N.b. Electron.js environment is simultaneously a NODE-environment, but[0m
[30;1m149 | [0m[35m// also a web environment.[0m
[30;1m150 | [0m[35mENVIRONMENT_IS_NODE = typeof process === 'object' && typeof process.versions === 'object' && typeof [0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/icon.svg[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m  | [0m[35mnkscape:window-maximized="1"[0m
[30;1m  | [0m[35m     inkscape:current-layer="layer1" /><defs[0m
[30;1m  | [0m[35m     id="defs1" /><g[0m
[30;1m  | [0m[35m     inkscape:label="Layer 1"[0m
[30;1m  | [0m[35m     inkscape:groupmode="layer"[0m
[30;1m  | [0m[35m     id="layer1"><image[0m
[30;1m  | [0m[35m       width="134.69167"[0m
[30;1m  | [0m[35m       height="134.69167"[0m
[30;1m  | [0m[35m       preserveAspectRatio="none"[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/icon_monochrome.svg[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m  | [0m[35mnkscape:window-maximized="1"[0m
[30;1m  | [0m[35m     inkscape:current-layer="layer1" /><defs[0m
[30;1m  | [0m[35m     id="defs1" /><g[0m
[30;1m  | [0m[35m     inkscape:label="Layer 1"[0m
[30;1m  | [0m[35m     inkscape:groupmode="layer"[0m
[30;1m  | [0m[35m     id="layer1"><image[0m
[30;1m  | [0m[35m       width="135.46666"[0m
[30;1m  | [0m[35m       height="135.46666"[0m
[30;1m  | [0m[35m       preserveAspectRatio="none"[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m92 | [0m[35m        default_value=None,[0m
[30;1m93 | [0m[35m        required=False,[0m
[30;1m94 | [0m[35m        label="Device password",[0m
[30;1m95 | [0m[35m        description="Some devices require a password to connect/play.",[0m
[30;1m96 | [0m[35m        category="airplay",[0m
[30;1m97 | [0m[35m    ),[0m
[30;1m98 | [0m[35m    ConfigEntry([0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m91 | [0m[35m        type=ConfigEntryType.SECURE_STRING,[0m
[30;1m92 | [0m[35m        default_value=None,[0m
[30;1m93 | [0m[35m        required=False,[0m
[30;1m94 | [0m[35m        label="Device password",[0m
[30;1m95 | [0m[35m        description="Some devices require a password to connect/play.",[0m
[30;1m96 | [0m[35m        category="airplay",[0m
[30;1m97 | [0m[35m    ),[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m87 | [0m[35m    ),[0m
[30;1m88 | [0m[35m    CONF_ENTRY_SYNC_ADJUST,[0m
[30;1m89 | [0m[35m    ConfigEntry([0m
[30;1m90 | [0m[35m        key=CONF_PASSWORD,[0m
[30;1m91 | [0m[35m        type=ConfigEntryType.SECURE_STRING,[0m
[30;1m92 | [0m[35m        default_value=None,[0m
[30;1m93 | [0m[35m        required=False,[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m46 | [0m[35m    CACHE_KEY_PREV_VOLUME,[0m
[30;1m47 | [0m[35m    CONF_ALAC_ENCODE,[0m
[30;1m48 | [0m[35m    CONF_ENCRYPTION,[0m
[30;1m49 | [0m[35m    CONF_PASSWORD,[0m
[30;1m50 | [0m[35m    CONF_READ_AHEAD_BUFFER,[0m
[30;1m51 | [0m[35m    FALLBACK_VOLUME,[0m
[30;1m52 | [0m[35m)[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1194 | [0m[35m        is_mpd = "dash+xml" in manifest_type[0m
[30;1m1195 | [0m[35m[0m
[30;1m1196 | [0m[35m        if is_mpd and "manifest" in stream_data:[0m
[30;1m1197 | [0m[35m            url = f"data:application/dash+xml;base64,{stream_data['manifest']}"[0m
[30;1m1198 | [0m[35m        else:[0m
[30;1m1199 | [0m[35m            # For non-MPD streams, use the direct URL[0m
[30;1m1200 | [0m[35m            urls = stream_data.get("urls", [])[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m339 | [0m[35m    async def handle_async_init(self) -> None:[0m
[30;1m340 | [0m[35m        """Handle async initialization of the provider."""[0m
[30;1m341 | [0m[35m        # Load auth info from individual config values[0m
[30;1m342 | [0m[35m        access_token = self.config.get_value(CONF_AUTH_TOKEN)[0m
[30;1m343 | [0m[35m        refresh_token = self.config.get_value(CONF_REFRESH_TOKEN)[0m
[30;1m344 | [0m[35m        expires_at = self.config.get_value(CONF_EXPIRY_TIME)[0m
[30;1m345 | [0m[35m        user_id = self.config.get_value(CONF_USER_ID)[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m331 | [0m[35m[0m
[30;1m332 | [0m[35m    def _update_auth_config(self, auth_info: dict[str, Any]) -> None:[0m
[30;1m333 | [0m[35m        """Update auth config with new auth info."""[0m
[30;1m334 | [0m[35m        self.update_config_value(CONF_AUTH_TOKEN, auth_info["access_token"], encrypted=True)[0m
[30;1m335 | [0m[35m        self.update_config_value(CONF_REFRESH_TOKEN, auth_info["refresh_token"], encrypted=True)[0m
[30;1m336 | [0m[35m        self.update_config_value(CONF_EXPIRY_TIME, auth_info["expires_at"])[0m
[30;1m337 | [0m[35m        self.update_config_value(CONF_USER_ID, auth_info["userId"])[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m278 | [0m[35m            label="Authentication token for Tidal",[0m
[30;1m279 | [0m[35m            description="You need to link Music Assistant to your Tidal account.",[0m
[30;1m280 | [0m[35m            hidden=True,[0m
[30;1m281 | [0m[35m            value=cast("str", values.get(CONF_AUTH_TOKEN)) if values else None,[0m
[30;1m282 | [0m[35m        ),[0m
[30;1m283 | [0m[35m        ConfigEntry([0m
[30;1m284 | [0m[35m            key=CONF_REFRESH_TOKEN,[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m273 | [0m[35m    return ([0m
[30;1m274 | [0m[35m        *auth_entries,[0m
[30;1m275 | [0m[35m        ConfigEntry([0m
[30;1m276 | [0m[35m            key=CONF_AUTH_TOKEN,[0m
[30;1m277 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m278 | [0m[35m            label="Authentication token for Tidal",[0m
[30;1m279 | [0m[35m            description="You need to link Music Assistant to your Tidal account.",[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m161 | [0m[35m        values[CONF_EXPIRY_TIME] = None[0m
[30;1m162 | [0m[35m        values[CONF_USER_ID] = None[0m
[30;1m163 | [0m[35m[0m
[30;1m164 | [0m[35m    if values.get(CONF_AUTH_TOKEN):[0m
[30;1m165 | [0m[35m        auth_entries: tuple[ConfigEntry, ...] = ([0m
[30;1m166 | [0m[35m            ConfigEntry([0m
[30;1m167 | [0m[35m                key="label_ok",[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m156 | [0m[35m        values[CONF_TEMP_SESSION] = ""[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m    if action == CONF_ACTION_CLEAR_AUTH:[0m
[30;1m159 | [0m[35m        values[CONF_AUTH_TOKEN] = None[0m
[30;1m160 | [0m[35m        values[CONF_REFRESH_TOKEN] = None[0m
[30;1m161 | [0m[35m        values[CONF_EXPIRY_TIME] = None[0m
[30;1m162 | [0m[35m        values[CONF_USER_ID] = None[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m149 | [0m[35m        auth_data = await TidalAuthManager.process_pkce_login([0m
[30;1m150 | [0m[35m            mass.http_session, base64_session, pkce_url[0m
[30;1m151 | [0m[35m        )[0m
[30;1m152 | [0m[35m        values[CONF_AUTH_TOKEN] = auth_data["access_token"][0m
[30;1m153 | [0m[35m        values[CONF_REFRESH_TOKEN] = auth_data["refresh_token"][0m
[30;1m154 | [0m[35m        values[CONF_EXPIRY_TIME] = auth_data["expires_at"][0m
[30;1m155 | [0m[35m        values[CONF_USER_ID] = auth_data["userId"][0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m79 | [0m[35mCONF_OOPS_URL = "oops_url"[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m# Config keys[0m
[30;1m82 | [0m[35mCONF_AUTH_TOKEN = "auth_token"[0m
[30;1m83 | [0m[35mCONF_REFRESH_TOKEN = "refresh_token"[0m
[30;1m84 | [0m[35mCONF_USER_ID = "user_id"[0m
[30;1m85 | [0m[35mCONF_EXPIRY_TIME = "expiry_time"[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m79 | [0m[35mCONF_OOPS_URL = "oops_url"[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m# Config keys[0m
[30;1m82 | [0m[35mCONF_AUTH_TOKEN = "auth_token"[0m
[30;1m83 | [0m[35mCONF_REFRESH_TOKEN = "refresh_token"[0m
[30;1m84 | [0m[35mCONF_USER_ID = "user_id"[0m
[30;1m85 | [0m[35mCONF_EXPIRY_TIME = "expiry_time"[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/siriusxm/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m        self._client = SXMClientAsync([0m
[30;1m131 | [0m[35m            username,[0m
[30;1m132 | [0m[35m            password,[0m
[30;1m133 | [0m[35m            region,[0m
[30;1m134 | [0m[35m            quality=QualitySize.LARGE_256k,[0m
[30;1m135 | [0m[35m            update_handler=self._channel_updated,[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/siriusxm/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m121 | [0m[35m    async def handle_async_init(self) -> None:[0m
[30;1m122 | [0m[35m        """Handle async initialization of the provider."""[0m
[30;1m123 | [0m[35m        username: str = self.config.get_value(CONF_SXM_USERNAME)[0m
[30;1m124 | [0m[35m        password: str = self.config.get_value(CONF_SXM_PASSWORD)[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m        region: RegionChoice = ([0m
[30;1m127 | [0m[35m            RegionChoice.US if self.config.get_value(CONF_SXM_REGION) == "US" else RegionChoice.CA[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/siriusxm/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m121 | [0m[35m    async def handle_async_init(self) -> None:[0m
[30;1m122 | [0m[35m        """Handle async initialization of the provider."""[0m
[30;1m123 | [0m[35m        username: str = self.config.get_value(CONF_SXM_USERNAME)[0m
[30;1m124 | [0m[35m        password: str = self.config.get_value(CONF_SXM_PASSWORD)[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m        region: RegionChoice = ([0m
[30;1m127 | [0m[35m            RegionChoice.US if self.config.get_value(CONF_SXM_REGION) == "US" else RegionChoice.CA[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/siriusxm/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m99 | [0m[35m    """SiriusXM Music Provider."""[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m    _username: str[0m
[30;1m102 | [0m[35m    _password: str[0m
[30;1m103 | [0m[35m    _region: str[0m
[30;1m104 | [0m[35m    _client: SXMClientAsync[0m
[30;1m105 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/siriusxm/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m78 | [0m[35m        ConfigEntry([0m
[30;1m79 | [0m[35m            key=CONF_SXM_PASSWORD,[0m
[30;1m80 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m81 | [0m[35m            label="Password",[0m
[30;1m82 | [0m[35m            required=True,[0m
[30;1m83 | [0m[35m        ),[0m
[30;1m84 | [0m[35m        ConfigEntry([0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/siriusxm/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m76 | [0m[35m            required=True,[0m
[30;1m77 | [0m[35m        ),[0m
[30;1m78 | [0m[35m        ConfigEntry([0m
[30;1m79 | [0m[35m            key=CONF_SXM_PASSWORD,[0m
[30;1m80 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m81 | [0m[35m            label="Password",[0m
[30;1m82 | [0m[35m            required=True,[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/siriusxm/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m43 | [0m[35mfrom sxm.models import QualitySize, RegionChoice, XMChannel, XMLiveChannel[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35mCONF_SXM_USERNAME = "sxm_email_address"[0m
[30;1m46 | [0m[35mCONF_SXM_PASSWORD = "sxm_password"[0m
[30;1m47 | [0m[35mCONF_SXM_REGION = "sxm_region"[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/siriusxm/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m43 | [0m[35mfrom sxm.models import QualitySize, RegionChoice, XMChannel, XMLiveChannel[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35mCONF_SXM_USERNAME = "sxm_email_address"[0m
[30;1m46 | [0m[35mCONF_SXM_PASSWORD = "sxm_password"[0m
[30;1m47 | [0m[35mCONF_SXM_REGION = "sxm_region"[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/_template_plugin_provider/__init__.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m27 | [0m[35mIMPORTANT NOTE:[0m
[30;1m28 | [0m[35mWe strongly recommend developing on either MacOS or Linux and start your development[0m
[30;1m29 | [0m[35menvironment by running the setup.sh scripts in the scripts folder of the repository.[0m
[30;1m30 | [0m[35mThis will create a virtual environment and install all dependencies needed for development.[0m
[30;1m31 | [0m[35mSee also our general DEVELOPMENT.md guide in the repository for more information.[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m"""[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass_players/__init__.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m622 | [0m[35m            ws_url = self.hass_prov.hass._websocket_url or "ws://supervisor/core/websocket"[0m
[30;1m623 | [0m[35m            hass_url = ws_url.replace("ws://", "http://").replace("wss://", "https://")[0m
[30;1m624 | [0m[35m            hass_url = hass_url.replace("/api/websocket", "").replace("/websocket", "")[0m
[30;1m625 | [0m[35m            api_token = self.hass_prov.hass._token or os.environ.get("HASSIO_TOKEN")[0m
[30;1m626 | [0m[35m            url = f"{hass_url}/api/diagnostics/config_entry/{conf_entry_id}"[0m
[30;1m627 | [0m[35m            headers = {[0m
[30;1m628 | [0m[35m                "Authorization": f"Bearer {api_token}",[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_smb/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m218 | [0m[35m            # pass the username+password using (scoped) env variables[0m
[30;1m219 | [0m[35m            # to prevent leaking in the process list and special chars supported[0m
[30;1m220 | [0m[35m            if password:[0m
[30;1m221 | [0m[35m                env_vars["PASSWD"] = str(password)[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m            mount_cmd = [[0m
[30;1m224 | [0m[35m                "mount",[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_smb/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m            # pass the username+password using (scoped) env variables[0m
[30;1m219 | [0m[35m            # to prevent leaking in the process list and special chars supported[0m
[30;1m220 | [0m[35m            if password:[0m
[30;1m221 | [0m[35m                env_vars["PASSWD"] = str(password)[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m            mount_cmd = [[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_smb/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m215 | [0m[35m                options += mount_options.split(",")[0m
[30;1m216 | [0m[35m            options_str = ",".join(options)[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m            # pass the username+password using (scoped) env variables[0m
[30;1m219 | [0m[35m            # to prevent leaking in the process list and special chars supported[0m
[30;1m220 | [0m[35m            if password:[0m
[30;1m221 | [0m[35m                env_vars["PASSWD"] = str(password)[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_smb/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m205 | [0m[35m                "mount",[0m
[30;1m206 | [0m[35m                "-t",[0m
[30;1m207 | [0m[35m                "smbfs",[0m
[30;1m208 | [0m[35m                f"//{username}{password_str}@{server}/{share}{subfolder}",[0m
[30;1m209 | [0m[35m                self.base_path,[0m
[30;1m210 | [0m[35m            ][0m
[30;1m211 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_smb/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m200 | [0m[35m[0m
[30;1m201 | [0m[35m        if platform.system() == "Darwin":[0m
[30;1m202 | [0m[35m            # NOTE: MacOS does not support special characters in the username/password[0m
[30;1m203 | [0m[35m            password_str = f":{password}" if password else ""[0m
[30;1m204 | [0m[35m            mount_cmd = [[0m
[30;1m205 | [0m[35m                "mount",[0m
[30;1m206 | [0m[35m                "-t",[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_smb/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m200 | [0m[35m[0m
[30;1m201 | [0m[35m        if platform.system() == "Darwin":[0m
[30;1m202 | [0m[35m            # NOTE: MacOS does not support special characters in the username/password[0m
[30;1m203 | [0m[35m            password_str = f":{password}" if password else ""[0m
[30;1m204 | [0m[35m            mount_cmd = [[0m
[30;1m205 | [0m[35m                "mount",[0m
[30;1m206 | [0m[35m                "-t",[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_smb/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m200 | [0m[35m[0m
[30;1m201 | [0m[35m        if platform.system() == "Darwin":[0m
[30;1m202 | [0m[35m            # NOTE: MacOS does not support special characters in the username/password[0m
[30;1m203 | [0m[35m            password_str = f":{password}" if password else ""[0m
[30;1m204 | [0m[35m            mount_cmd = [[0m
[30;1m205 | [0m[35m                "mount",[0m
[30;1m206 | [0m[35m                "-t",[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_smb/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m199 | [0m[35m        }[0m
[30;1m200 | [0m[35m[0m
[30;1m201 | [0m[35m        if platform.system() == "Darwin":[0m
[30;1m202 | [0m[35m            # NOTE: MacOS does not support special characters in the username/password[0m
[30;1m203 | [0m[35m            password_str = f":{password}" if password else ""[0m
[30;1m204 | [0m[35m            mount_cmd = [[0m
[30;1m205 | [0m[35m                "mount",[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_smb/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m182 | [0m[35m        """Mount the SMB location to a temporary folder."""[0m
[30;1m183 | [0m[35m        server = str(self.config.get_value(CONF_HOST))[0m
[30;1m184 | [0m[35m        username = str(self.config.get_value(CONF_USERNAME))[0m
[30;1m185 | [0m[35m        password = self.config.get_value(CONF_PASSWORD)[0m
[30;1m186 | [0m[35m        share = str(self.config.get_value(CONF_SHARE))[0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35m        # handle optional subfolder[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_smb/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m182 | [0m[35m        """Mount the SMB location to a temporary folder."""[0m
[30;1m183 | [0m[35m        server = str(self.config.get_value(CONF_HOST))[0m
[30;1m184 | [0m[35m        username = str(self.config.get_value(CONF_USERNAME))[0m
[30;1m185 | [0m[35m        password = self.config.get_value(CONF_PASSWORD)[0m
[30;1m186 | [0m[35m        share = str(self.config.get_value(CONF_SHARE))[0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35m        # handle optional subfolder[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_smb/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m96 | [0m[35m        ConfigEntry([0m
[30;1m97 | [0m[35m            key=CONF_PASSWORD,[0m
[30;1m98 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m99 | [0m[35m            label="Password",[0m
[30;1m100 | [0m[35m            required=False,[0m
[30;1m101 | [0m[35m            default_value=None,[0m
[30;1m102 | [0m[35m            description="The username to authenticate to the remote server. "[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_smb/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m94 | [0m[35m            "For anynymous access you may want to try with the user `guest`.",[0m
[30;1m95 | [0m[35m        ),[0m
[30;1m96 | [0m[35m        ConfigEntry([0m
[30;1m97 | [0m[35m            key=CONF_PASSWORD,[0m
[30;1m98 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m99 | [0m[35m            label="Password",[0m
[30;1m100 | [0m[35m            required=False,[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_smb/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m10 | [0m[35mfrom music_assistant_models.enums import ConfigEntryType[0m
[30;1m11 | [0m[35mfrom music_assistant_models.errors import LoginFailed[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mfrom music_assistant.constants import CONF_PASSWORD, CONF_USERNAME, VERBOSE_LOG_LEVEL[0m
[30;1m14 | [0m[35mfrom music_assistant.helpers.process import check_output[0m
[30;1m15 | [0m[35mfrom music_assistant.helpers.util import get_ip_from_host[0m
[30;1m16 | [0m[35mfrom music_assistant.providers.filesystem_local import LocalFileSystemProvider, exists, makedirs[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/podcastfeed/icon_monochrome.svg[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m  | [0m[35mnkscape:window-maximized="1"[0m
[30;1m  | [0m[35m     inkscape:current-layer="layer1" /><defs[0m
[30;1m  | [0m[35m     id="defs1" /><g[0m
[30;1m  | [0m[35m     inkscape:label="Layer 1"[0m
[30;1m  | [0m[35m     inkscape:groupmode="layer"[0m
[30;1m  | [0m[35m     id="layer1"><image[0m
[30;1m  | [0m[35m       width="135.46666"[0m
[30;1m  | [0m[35m       height="135.46666"[0m
[30;1m  | [0m[35m       preserveAspectRatio="none"[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/helpers.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    result = await asyncio.to_thread(_get_libraries)[0m
[30;1m61 | [0m[35m    # use short expiration for in-memory cache[0m
[30;1m62 | [0m[35m    await mass.cache.set(cache_key, result, checksum=auth_token, expiration=3600)[0m
[30;1m63 | [0m[35m    return result[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/helpers.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m54 | [0m[35m            all_libraries.append(f"{plex_server.friendlyName} / {media_section.title}")[0m
[30;1m55 | [0m[35m        return all_libraries[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    if cache := await mass.cache.get(cache_key, checksum=auth_token):[0m
[30;1m58 | [0m[35m        return cast("list[str]", cache)[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    result = await asyncio.to_thread(_get_libraries)[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/helpers.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m44 | [0m[35m        else:[0m
[30;1m45 | [0m[35m            plex_server = PlexServer([0m
[30;1m46 | [0m[35m                f"{local_server_protocol}://{local_server_ip}:{local_server_port}",[0m
[30;1m47 | [0m[35m                auth_token,[0m
[30;1m48 | [0m[35m                session=session,[0m
[30;1m49 | [0m[35m            )[0m
[30;1m50 | [0m[35m        for media_section in cast("list[PlexLibrarySection]", plex_server.library.sections()):[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/helpers.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m37 | [0m[35m        session.verify = local_server_verify_cert[0m
[30;1m38 | [0m[35m        local_server_protocol = "https" if local_server_ssl else "http"[0m
[30;1m39 | [0m[35m        plex_server: PlexServer[0m
[30;1m40 | [0m[35m        if auth_token is None:[0m
[30;1m41 | [0m[35m            plex_server = PlexServer([0m
[30;1m42 | [0m[35m                f"{local_server_protocol}://{local_server_ip}:{local_server_port}"[0m
[30;1m43 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/helpers.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35masync def get_libraries([0m
[30;1m19 | [0m[35m    mass: MusicAssistant,[0m
[30;1m20 | [0m[35m    auth_token: str | None,[0m
[30;1m21 | [0m[35m    local_server_ssl: bool,[0m
[30;1m22 | [0m[35m    local_server_ip: str,[0m
[30;1m23 | [0m[35m    local_server_port: str,[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ibroadcast/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m113 | [0m[35m            self._client = IBroadcastClient(session)[0m
[30;1m114 | [0m[35m            status = await self._client.login([0m
[30;1m115 | [0m[35m                self.config.get_value(CONF_USERNAME),[0m
[30;1m116 | [0m[35m                self.config.get_value(CONF_PASSWORD),[0m
[30;1m117 | [0m[35m            )[0m
[30;1m118 | [0m[35m            self._user_id = status["user"]["id"][0m
[30;1m119 | [0m[35m            self._token = status["user"]["token"][0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ibroadcast/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m94 | [0m[35m        ConfigEntry([0m
[30;1m95 | [0m[35m            key=CONF_PASSWORD,[0m
[30;1m96 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m97 | [0m[35m            label="Password",[0m
[30;1m98 | [0m[35m            required=True,[0m
[30;1m99 | [0m[35m        ),[0m
[30;1m100 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ibroadcast/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m92 | [0m[35m            required=True,[0m
[30;1m93 | [0m[35m        ),[0m
[30;1m94 | [0m[35m        ConfigEntry([0m
[30;1m95 | [0m[35m            key=CONF_PASSWORD,[0m
[30;1m96 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m97 | [0m[35m            label="Password",[0m
[30;1m98 | [0m[35m            required=True,[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ibroadcast/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m64 | [0m[35m    mass: MusicAssistant, manifest: ProviderManifest, config: ProviderConfig[0m
[30;1m65 | [0m[35m) -> ProviderInstanceType:[0m
[30;1m66 | [0m[35m    """Initialize provider(instance) with given configuration."""[0m
[30;1m67 | [0m[35m    if not config.get_value(CONF_USERNAME) or not config.get_value(CONF_PASSWORD):[0m
[30;1m68 | [0m[35m        msg = "Invalid login credentials"[0m
[30;1m69 | [0m[35m        raise LoginFailed(msg)[0m
[30;1m70 | [0m[35m    return IBroadcastProvider(mass, manifest, config)[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ibroadcast/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m31 | [0m[35mfrom music_assistant_models.streamdetails import StreamDetails[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35mfrom music_assistant.constants import ([0m
[30;1m34 | [0m[35m    CONF_PASSWORD,[0m
[30;1m35 | [0m[35m    CONF_USERNAME,[0m
[30;1m36 | [0m[35m    UNKNOWN_ARTIST,[0m
[30;1m37 | [0m[35m    VARIOUS_ARTISTS_MBID,[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m302 | [0m[35m        """Handle async initialization of the plugin."""[0m
[30;1m303 | [0m[35m        self._player_controls = {}[0m
[30;1m304 | [0m[35m        url = get_websocket_url(self.config.get_value(CONF_URL))[0m
[30;1m305 | [0m[35m        token = self.config.get_value(CONF_AUTH_TOKEN)[0m
[30;1m306 | [0m[35m        logging.getLogger("hass_client").setLevel(self.logger.level + 10)[0m
[30;1m307 | [0m[35m        self.hass = HomeAssistantClient(url, token, self.mass.http_session)[0m
[30;1m308 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m162 | [0m[35m                description="You can either paste a Long Lived Token here manually or use the "[0m
[30;1m163 | [0m[35m                "'authenticate' button to generate a token for you with logging in.",[0m
[30;1m164 | [0m[35m                depends_on=CONF_URL,[0m
[30;1m165 | [0m[35m                value=cast("str", values.get(CONF_AUTH_TOKEN)) if values else None,[0m
[30;1m166 | [0m[35m                category="advanced",[0m
[30;1m167 | [0m[35m            ),[0m
[30;1m168 | [0m[35m            ConfigEntry([0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m156 | [0m[35m                required=False,[0m
[30;1m157 | [0m[35m            ),[0m
[30;1m158 | [0m[35m            ConfigEntry([0m
[30;1m159 | [0m[35m                key=CONF_AUTH_TOKEN,[0m
[30;1m160 | [0m[35m                type=ConfigEntryType.SECURE_STRING,[0m
[30;1m161 | [0m[35m                label="Authentication token for HomeAssistant",[0m
[30;1m162 | [0m[35m                description="You can either paste a Long Lived Token here manually or use the "[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m119 | [0m[35m            ConfigEntry([0m
[30;1m120 | [0m[35m                key=CONF_AUTH_TOKEN,[0m
[30;1m121 | [0m[35m                type=ConfigEntryType.STRING,[0m
[30;1m122 | [0m[35m                label=CONF_AUTH_TOKEN,[0m
[30;1m123 | [0m[35m                required=False,[0m
[30;1m124 | [0m[35m                default_value=None,[0m
[30;1m125 | [0m[35m                value=None,[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m117 | [0m[35m                hidden=True,[0m
[30;1m118 | [0m[35m            ),[0m
[30;1m119 | [0m[35m            ConfigEntry([0m
[30;1m120 | [0m[35m                key=CONF_AUTH_TOKEN,[0m
[30;1m121 | [0m[35m                type=ConfigEntryType.STRING,[0m
[30;1m122 | [0m[35m                label=CONF_AUTH_TOKEN,[0m
[30;1m123 | [0m[35m                required=False,[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m100 | [0m[35m            lifespan=365 * 2,[0m
[30;1m101 | [0m[35m        )[0m
[30;1m102 | [0m[35m        # set the retrieved token on the values object to pass along[0m
[30;1m103 | [0m[35m        values[CONF_AUTH_TOKEN] = long_lived_token[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m    base_entries: tuple[ConfigEntry, ...][0m
[30;1m106 | [0m[35m    if mass.running_as_hass_addon:[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35mDOMAIN = "hass"[0m
[30;1m48 | [0m[35mCONF_URL = "url"[0m
[30;1m49 | [0m[35mCONF_AUTH_TOKEN = "token"[0m
[30;1m50 | [0m[35mCONF_ACTION_AUTH = "auth"[0m
[30;1m51 | [0m[35mCONF_VERIFY_SSL = "verify_ssl"[0m
[30;1m52 | [0m[35mCONF_POWER_CONTROLS = "power_controls"[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/deezer/__init__.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m792 | [0m[35m        cipher = Blowfish.new([0m
[30;1m793 | [0m[35m            blowfish_key.encode("ascii"),[0m
[30;1m794 | [0m[35m            Blowfish.MODE_CBC,[0m
[30;1m795 | [0m[35m            b"\x00\x01\x02\x03\x04\x05\x06\x07",[0m
[30;1m796 | [0m[35m        )[0m
[30;1m797 | [0m[35m        return cipher.decrypt(chunk)[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m816 | [0m[35m[0m
[30;1m817 | [0m[35m    async def _get_license(self, challenge: bytes, license_url: str, uri: str, item_id: str) -> str:[0m
[30;1m818 | [0m[35m        """Get the license for a song based on the challenge."""[0m
[30;1m819 | [0m[35m        challenge_b64 = base64.b64encode(challenge).decode("utf-8")[0m
[30;1m820 | [0m[35m        data = {[0m
[30;1m821 | [0m[35m            "challenge": challenge_b64,[0m
[30;1m822 | [0m[35m            "key-system": "com.widevine.alpha",[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m811 | [0m[35m        pssh_data = WidevinePsshData()[0m
[30;1m812 | [0m[35m        pssh_data.algorithm = 1[0m
[30;1m813 | [0m[35m        pssh_data.key_ids.append(key_id)[0m
[30;1m814 | [0m[35m        init_data = base64.b64encode(pssh_data.SerializeToString()).decode("utf-8")[0m
[30;1m815 | [0m[35m        return PSSH.new(system_id=PSSH.SystemId.Widevine, init_data=init_data)[0m
[30;1m816 | [0m[35m[0m
[30;1m817 | [0m[35m    async def _get_license(self, challenge: bytes, license_url: str, uri: str, item_id: str) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m365 | [0m[35m        stream_url, uri = await self._parse_stream_url_and_uri(stream_metadata["assets"])[0m
[30;1m366 | [0m[35m        if not stream_url or not uri:[0m
[30;1m367 | [0m[35m            raise MediaNotFoundError("No stream URL found for song.")[0m
[30;1m368 | [0m[35m        key_id = base64.b64decode(uri.split(",")[1])[0m
[30;1m369 | [0m[35m        return StreamDetails([0m
[30;1m370 | [0m[35m            item_id=item_id,[0m
[30;1m371 | [0m[35m            provider=self.lookup_key,[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom __future__ import annotations[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mimport base64[0m
[30;1m6 | [0m[35mimport json[0m
[30;1m7 | [0m[35mimport os[0m
[30;1m8 | [0m[35mfrom typing import TYPE_CHECKING, Any[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m784 | [0m[35m        pssh = self._get_pssh(key_id)[0m
[30;1m785 | [0m[35m        device = Device([0m
[30;1m786 | [0m[35m            client_id=self._decrypt_client_id,[0m
[30;1m787 | [0m[35m            private_key=self._decrypt_private_key,[0m
[30;1m788 | [0m[35m            type_=DeviceTypes.ANDROID,[0m
[30;1m789 | [0m[35m            security_level=3,[0m
[30;1m790 | [0m[35m            flags={},[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m784 | [0m[35m        pssh = self._get_pssh(key_id)[0m
[30;1m785 | [0m[35m        device = Device([0m
[30;1m786 | [0m[35m            client_id=self._decrypt_client_id,[0m
[30;1m787 | [0m[35m            private_key=self._decrypt_private_key,[0m
[30;1m788 | [0m[35m            type_=DeviceTypes.ANDROID,[0m
[30;1m789 | [0m[35m            security_level=3,[0m
[30;1m790 | [0m[35m            flags={},[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m130 | [0m[35m        async with aiofiles.open([0m
[30;1m131 | [0m[35m            os.path.join(WIDEVINE_BASE_PATH, DECRYPT_PRIVATE_KEY_FILENAME), "rb"[0m
[30;1m132 | [0m[35m        ) as _file:[0m
[30;1m133 | [0m[35m            self._decrypt_private_key = await _file.read()[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m    @property[0m
[30;1m136 | [0m[35m    def supported_features(self) -> set[ProviderFeature]:[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m128 | [0m[35m        ) as _file:[0m
[30;1m129 | [0m[35m            self._decrypt_client_id = await _file.read()[0m
[30;1m130 | [0m[35m        async with aiofiles.open([0m
[30;1m131 | [0m[35m            os.path.join(WIDEVINE_BASE_PATH, DECRYPT_PRIVATE_KEY_FILENAME), "rb"[0m
[30;1m132 | [0m[35m        ) as _file:[0m
[30;1m133 | [0m[35m            self._decrypt_private_key = await _file.read()[0m
[30;1m134 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m    async def handle_async_init(self) -> None:[0m
[30;1m123 | [0m[35m        """Handle async initialization of the provider."""[0m
[30;1m124 | [0m[35m        self._music_user_token = self.config.get_value(CONF_PASSWORD)[0m
[30;1m125 | [0m[35m        self._storefront = await self._get_user_storefront()[0m
[30;1m126 | [0m[35m        async with aiofiles.open([0m
[30;1m127 | [0m[35m            os.path.join(WIDEVINE_BASE_PATH, DECRYPT_CLIENT_ID_FILENAME), "rb"[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m114 | [0m[35m    _music_user_token: str | None = None[0m
[30;1m115 | [0m[35m    _storefront: str | None = None[0m
[30;1m116 | [0m[35m    _decrypt_client_id: bytes | None = None[0m
[30;1m117 | [0m[35m    _decrypt_private_key: bytes | None = None[0m
[30;1m118 | [0m[35m    # rate limiter needs to be specified on provider-level,[0m
[30;1m119 | [0m[35m    # so make it an instance attribute[0m
[30;1m120 | [0m[35m    throttler = ThrottlerManager(rate_limit=1, period=2, initial_backoff=15)[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m100 | [0m[35m    # ruff: noqa: ARG001[0m
[30;1m101 | [0m[35m    return ([0m
[30;1m102 | [0m[35m        ConfigEntry([0m
[30;1m103 | [0m[35m            key=CONF_PASSWORD,[0m
[30;1m104 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m105 | [0m[35m            label="Music user token",[0m
[30;1m106 | [0m[35m            required=True,[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m73 | [0m[35mDEVELOPER_TOKEN = app_var(8)[0m
[30;1m74 | [0m[35mWIDEVINE_BASE_PATH = "/usr/local/bin/widevine_cdm"[0m
[30;1m75 | [0m[35mDECRYPT_CLIENT_ID_FILENAME = "client_id.bin"[0m
[30;1m76 | [0m[35mDECRYPT_PRIVATE_KEY_FILENAME = "private_key.pem"[0m
[30;1m77 | [0m[35mUNKNOWN_PLAYLIST_NAME = "Unknown Apple Music Playlist"[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m73 | [0m[35mDEVELOPER_TOKEN = app_var(8)[0m
[30;1m74 | [0m[35mWIDEVINE_BASE_PATH = "/usr/local/bin/widevine_cdm"[0m
[30;1m75 | [0m[35mDECRYPT_CLIENT_ID_FILENAME = "client_id.bin"[0m
[30;1m76 | [0m[35mDECRYPT_PRIVATE_KEY_FILENAME = "private_key.pem"[0m
[30;1m77 | [0m[35mUNKNOWN_PLAYLIST_NAME = "Unknown Apple Music Playlist"[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m41 | [0m[35mfrom pywidevine import PSSH, Cdm, Device, DeviceTypes[0m
[30;1m42 | [0m[35mfrom pywidevine.license_protocol_pb2 import WidevinePsshData[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35mfrom music_assistant.constants import CONF_PASSWORD[0m
[30;1m45 | [0m[35mfrom music_assistant.helpers.app_vars import app_var[0m
[30;1m46 | [0m[35mfrom music_assistant.helpers.json import json_loads[0m
[30;1m47 | [0m[35mfrom music_assistant.helpers.playlists import fetch_playlist[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/fanarttv/icon.svg[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m  | [0m[35mnkscape:window-maximized="1"[0m
[30;1m  | [0m[35m     inkscape:current-layer="layer1" /><defs[0m
[30;1m  | [0m[35m     id="defs1" /><g[0m
[30;1m  | [0m[35m     inkscape:label="Layer 1"[0m
[30;1m  | [0m[35m     inkscape:groupmode="layer"[0m
[30;1m  | [0m[35m     id="layer1"><image[0m
[30;1m  | [0m[35m       width="135.46666"[0m
[30;1m  | [0m[35m       height="135.46666"[0m
[30;1m  | [0m[35m       preserveAspectRatio="none"[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/_template_player_provider/__init__.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m24 | [0m[35mIMPORTANT NOTE:[0m
[30;1m25 | [0m[35mWe strongly recommend developing on either MacOS or Linux and start your development[0m
[30;1m26 | [0m[35menvironment by running the setup.sh scripts in the scripts folder of the repository.[0m
[30;1m27 | [0m[35mThis will create a virtual environment and install all dependencies needed for development.[0m
[30;1m28 | [0m[35mSee also our general DEVELOPMENT.md guide in the repository for more information.[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m"""[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/fanarttv/icon_monochrome.svg[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m  | [0m[35minkscape:window-height="1129"[0m
[30;1m  | [0m[35m     inkscape:window-x="-8"[0m
[30;1m  | [0m[35m     inkscape:window-y="-8"[0m
[30;1m  | [0m[35m     inkscape:window-maximized="1"[0m
[30;1m  | [0m[35m     inkscape:current-layer="svg1" /><defs[0m
[30;1m  | [0m[35m     id="defs1" /><image[0m
[30;1m  | [0m[35m     width="135.46666"[0m
[30;1m  | [0m[35m     height="135.46666"[0m
[30;1m  | [0m[35m     preserveAspectRatio="none"[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/fanarttv/icon_monochrome.svg[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m209 | [0m[35m                ) = await aioabs.get_user_and_socket_client_by_token(session_config=session_config)[0m
[30;1m210 | [0m[35m            else:[0m
[30;1m211 | [0m[35m                self._client, self._client_socket = await aioabs.get_user_and_socket_client([0m
[30;1m212 | [0m[35m                    session_config=session_config, username=username, password=password[0m
[30;1m213 | [0m[35m                )[0m
[30;1m214 | [0m[35m            await self._client_socket.init_client()[0m
[30;1m215 | [0m[35m        except AbsLoginError as exc:[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m209 | [0m[35m                ) = await aioabs.get_user_and_socket_client_by_token(session_config=session_config)[0m
[30;1m210 | [0m[35m            else:[0m
[30;1m211 | [0m[35m                self._client, self._client_socket = await aioabs.get_user_and_socket_client([0m
[30;1m212 | [0m[35m                    session_config=session_config, username=username, password=password[0m
[30;1m213 | [0m[35m                )[0m
[30;1m214 | [0m[35m            await self._client_socket.init_client()[0m
[30;1m215 | [0m[35m        except AbsLoginError as exc:[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m190 | [0m[35m        """Pass config values to client and initialize."""[0m
[30;1m191 | [0m[35m        base_url = str(self.config.get_value(CONF_URL))[0m
[30;1m192 | [0m[35m        username = str(self.config.get_value(CONF_USERNAME))[0m
[30;1m193 | [0m[35m        password = str(self.config.get_value(CONF_PASSWORD))[0m
[30;1m194 | [0m[35m        token = self.config.get_value(CONF_TOKEN)[0m
[30;1m195 | [0m[35m        verify_ssl = bool(self.config.get_value(CONF_VERIFY_SSL))[0m
[30;1m196 | [0m[35m        session_config = aioabs.SessionConfiguration([0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m190 | [0m[35m        """Pass config values to client and initialize."""[0m
[30;1m191 | [0m[35m        base_url = str(self.config.get_value(CONF_URL))[0m
[30;1m192 | [0m[35m        username = str(self.config.get_value(CONF_USERNAME))[0m
[30;1m193 | [0m[35m        password = str(self.config.get_value(CONF_PASSWORD))[0m
[30;1m194 | [0m[35m        token = self.config.get_value(CONF_TOKEN)[0m
[30;1m195 | [0m[35m        verify_ssl = bool(self.config.get_value(CONF_VERIFY_SSL))[0m
[30;1m196 | [0m[35m        session_config = aioabs.SessionConfiguration([0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m149 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m150 | [0m[35m            label="Token _instead_ of user/ password.",[0m
[30;1m151 | [0m[35m            required=False,[0m
[30;1m152 | [0m[35m            description="Instead of using username and password, you may provide the user's token."[0m
[30;1m153 | [0m[35m            "\nThe token can be seen in Audiobookshelf as an admin user in Settings -> Users.",[0m
[30;1m154 | [0m[35m        ),[0m
[30;1m155 | [0m[35m        ConfigEntry([0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m147 | [0m[35m        ConfigEntry([0m
[30;1m148 | [0m[35m            key=CONF_TOKEN,[0m
[30;1m149 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m150 | [0m[35m            label="Token _instead_ of user/ password.",[0m
[30;1m151 | [0m[35m            required=False,[0m
[30;1m152 | [0m[35m            description="Instead of using username and password, you may provide the user's token."[0m
[30;1m153 | [0m[35m            "\nThe token can be seen in Audiobookshelf as an admin user in Settings -> Users.",[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m142 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m143 | [0m[35m            label="Password",[0m
[30;1m144 | [0m[35m            required=False,[0m
[30;1m145 | [0m[35m            description="The password to authenticate to the remote server.",[0m
[30;1m146 | [0m[35m        ),[0m
[30;1m147 | [0m[35m        ConfigEntry([0m
[30;1m148 | [0m[35m            key=CONF_TOKEN,[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m140 | [0m[35m        ConfigEntry([0m
[30;1m141 | [0m[35m            key=CONF_PASSWORD,[0m
[30;1m142 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m143 | [0m[35m            label="Password",[0m
[30;1m144 | [0m[35m            required=False,[0m
[30;1m145 | [0m[35m            description="The password to authenticate to the remote server.",[0m
[30;1m146 | [0m[35m        ),[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m138 | [0m[35m            description="The username to authenticate to the remote server.",[0m
[30;1m139 | [0m[35m        ),[0m
[30;1m140 | [0m[35m        ConfigEntry([0m
[30;1m141 | [0m[35m            key=CONF_PASSWORD,[0m
[30;1m142 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m143 | [0m[35m            label="Password",[0m
[30;1m144 | [0m[35m            required=False,[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m120 | [0m[35m            type=ConfigEntryType.LABEL,[0m
[30;1m121 | [0m[35m            label="Please provide the address of your Audiobookshelf instance. To authenticate "[0m
[30;1m122 | [0m[35m            "you have two options: "[0m
[30;1m123 | [0m[35m            "a) Provide username AND password. Leave token empty."[0m
[30;1m124 | [0m[35m            "b) Provide ONLY the token.",[0m
[30;1m125 | [0m[35m        ),[0m
[30;1m126 | [0m[35m        ConfigEntry([0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m71 | [0m[35m    CACHE_CATEGORY_LIBRARIES,[0m
[30;1m72 | [0m[35m    CACHE_KEY_LIBRARIES,[0m
[30;1m73 | [0m[35m    CONF_HIDE_EMPTY_PODCASTS,[0m
[30;1m74 | [0m[35m    CONF_PASSWORD,[0m
[30;1m75 | [0m[35m    CONF_TOKEN,[0m
[30;1m76 | [0m[35m    CONF_URL,[0m
[30;1m77 | [0m[35m    CONF_USERNAME,[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/constants.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m7 | [0m[35m# CONFIG[0m
[30;1m8 | [0m[35mCONF_URL = "url"[0m
[30;1m9 | [0m[35mCONF_USERNAME = "username"[0m
[30;1m10 | [0m[35mCONF_PASSWORD = "password"[0m
[30;1m11 | [0m[35mCONF_TOKEN = "token"[0m
[30;1m12 | [0m[35mCONF_VERIFY_SSL = "verify_ssl"[0m
[30;1m13 | [0m[35m# optionally hide podcasts with no episodes[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/constants.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m7 | [0m[35m# CONFIG[0m
[30;1m8 | [0m[35mCONF_URL = "url"[0m
[30;1m9 | [0m[35mCONF_USERNAME = "username"[0m
[30;1m10 | [0m[35mCONF_PASSWORD = "password"[0m
[30;1m11 | [0m[35mCONF_TOKEN = "token"[0m
[30;1m12 | [0m[35mCONF_VERIFY_SSL = "verify_ssl"[0m
[30;1m13 | [0m[35m# optionally hide podcasts with no episodes[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/const.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m12 | [0m[35mCONF_ENCRYPTION = "encryption"[0m
[30;1m13 | [0m[35mCONF_ALAC_ENCODE = "alac_encode"[0m
[30;1m14 | [0m[35mCONF_VOLUME_START = "volume_start"[0m
[30;1m15 | [0m[35mCONF_PASSWORD = "password"[0m
[30;1m16 | [0m[35mCONF_BIND_INTERFACE = "bind_interface"[0m
[30;1m17 | [0m[35mCONF_READ_AHEAD_BUFFER = "read_ahead_buffer"[0m
[30;1m18 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/const.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m12 | [0m[35mCONF_ENCRYPTION = "encryption"[0m
[30;1m13 | [0m[35mCONF_ALAC_ENCODE = "alac_encode"[0m
[30;1m14 | [0m[35mCONF_VOLUME_START = "volume_start"[0m
[30;1m15 | [0m[35mCONF_PASSWORD = "password"[0m
[30;1m16 | [0m[35mCONF_BIND_INTERFACE = "bind_interface"[0m
[30;1m17 | [0m[35mCONF_READ_AHEAD_BUFFER = "read_ahead_buffer"[0m
[30;1m18 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m90 | [0m[35m        self.set_default(CONF_SERVER_ID, uuid4().hex)[0m
[30;1m91 | [0m[35m        server_id: str = self.get(CONF_SERVER_ID)[0m
[30;1m92 | [0m[35m        assert server_id[0m
[30;1m93 | [0m[35m        fernet_key = base64.urlsafe_b64encode(server_id.encode()[:32])[0m
[30;1m94 | [0m[35m        self._fernet = Fernet(fernet_key)[0m
[30;1m95 | [0m[35m        config_entries.ENCRYPT_CALLBACK = self.encrypt_string[0m
[30;1m96 | [0m[35m        config_entries.DECRYPT_CALLBACK = self.decrypt_string[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom __future__ import annotations[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mimport base64[0m
[30;1m6 | [0m[35mimport logging[0m
[30;1m7 | [0m[35mimport os[0m
[30;1m8 | [0m[35mfrom contextlib import suppress[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m784 | [0m[35m        try:[0m
[30;1m785 | [0m[35m            return self._fernet.decrypt(encrypted_str.replace(ENCRYPT_SUFFIX, "").encode()).decode()[0m
[30;1m786 | [0m[35m        except InvalidToken as err:[0m
[30;1m787 | [0m[35m            msg = "Password decryption failed"[0m
[30;1m788 | [0m[35m            raise InvalidDataError(msg) from err[0m
[30;1m789 | [0m[35m[0m
[30;1m790 | [0m[35m    async def _load(self) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m776 | [0m[35m        return ENCRYPT_SUFFIX + self._fernet.encrypt(str_value.encode()).decode()[0m
[30;1m777 | [0m[35m[0m
[30;1m778 | [0m[35m    def decrypt_string(self, encrypted_str: str) -> str:[0m
[30;1m779 | [0m[35m        """Decrypt a (password)string with Fernet."""[0m
[30;1m780 | [0m[35m        if not encrypted_str:[0m
[30;1m781 | [0m[35m            return encrypted_str[0m
[30;1m782 | [0m[35m        if not encrypted_str.startswith(ENCRYPT_SUFFIX):[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m770 | [0m[35m            )[0m
[30;1m771 | [0m[35m[0m
[30;1m772 | [0m[35m    def encrypt_string(self, str_value: str) -> str:[0m
[30;1m773 | [0m[35m        """Encrypt a (password)string with Fernet."""[0m
[30;1m774 | [0m[35m        if str_value.startswith(ENCRYPT_SUFFIX):[0m
[30;1m775 | [0m[35m            return str_value[0m
[30;1m776 | [0m[35m        return ENCRYPT_SUFFIX + self._fernet.encrypt(str_value.encode()).decode()[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m86 | [0m[35m        """Async initialize of controller."""[0m
[30;1m87 | [0m[35m        await self._load()[0m
[30;1m88 | [0m[35m        self.initialized = True[0m
[30;1m89 | [0m[35m        # create default server ID if needed (also used for encrypting passwords)[0m
[30;1m90 | [0m[35m        self.set_default(CONF_SERVER_ID, uuid4().hex)[0m
[30;1m91 | [0m[35m        server_id: str = self.get(CONF_SERVER_ID)[0m
[30;1m92 | [0m[35m        assert server_id[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/metadata.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m373 | [0m[35m        )[0m
[30;1m374 | [0m[35m        if base64:[0m
[30;1m375 | [0m[35m            enc_image = b64encode(thumbnail).decode()[0m
[30;1m376 | [0m[35m            thumbnail = f"data:image/{image_format};base64,{enc_image}"[0m
[30;1m377 | [0m[35m        return thumbnail[0m
[30;1m378 | [0m[35m[0m
[30;1m379 | [0m[35m    async def handle_imageproxy(self, request: web.Request) -> web.Response:[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/metadata.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m371 | [0m[35m        thumbnail = await get_image_thumb([0m
[30;1m372 | [0m[35m            self.mass, path, size=size, provider=provider, image_format=image_format[0m
[30;1m373 | [0m[35m        )[0m
[30;1m374 | [0m[35m        if base64:[0m
[30;1m375 | [0m[35m            enc_image = b64encode(thumbnail).decode()[0m
[30;1m376 | [0m[35m            thumbnail = f"data:image/{image_format};base64,{enc_image}"[0m
[30;1m377 | [0m[35m        return thumbnail[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/metadata.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m359 | [0m[35m        path: str,[0m
[30;1m360 | [0m[35m        provider: str,[0m
[30;1m361 | [0m[35m        size: int | None = None,[0m
[30;1m362 | [0m[35m        base64: bool = False,[0m
[30;1m363 | [0m[35m        image_format: str = "png",[0m
[30;1m364 | [0m[35m    ) -> bytes | str:[0m
[30;1m365 | [0m[35m        """Get/create thumbnail image for path (image url or local path)."""[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/metadata.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m8 | [0m[35mimport os[0m
[30;1m9 | [0m[35mimport random[0m
[30;1m10 | [0m[35mimport urllib.parse[0m
[30;1m11 | [0m[35mfrom base64 import b64encode[0m
[30;1m12 | [0m[35mfrom contextlib import suppress[0m
[30;1m13 | [0m[35mfrom time import time[0m
[30;1m14 | [0m[35mfrom typing import TYPE_CHECKING, cast[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/raop.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m237 | [0m[35m        if device_password := self.mass.config.get_raw_player_config_value([0m
[30;1m238 | [0m[35m            player_id, CONF_PASSWORD, None[0m
[30;1m239 | [0m[35m        ):[0m
[30;1m240 | [0m[35m            extra_args += ["-password", str(device_password)][0m
[30;1m241 | [0m[35m        if self.prov.logger.isEnabledFor(logging.DEBUG):[0m
[30;1m242 | [0m[35m            extra_args += ["-debug", "5"][0m
[30;1m243 | [0m[35m        elif self.prov.logger.isEnabledFor(VERBOSE_LOG_LEVEL):[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/raop.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m237 | [0m[35m        if device_password := self.mass.config.get_raw_player_config_value([0m
[30;1m238 | [0m[35m            player_id, CONF_PASSWORD, None[0m
[30;1m239 | [0m[35m        ):[0m
[30;1m240 | [0m[35m            extra_args += ["-password", str(device_password)][0m
[30;1m241 | [0m[35m        if self.prov.logger.isEnabledFor(logging.DEBUG):[0m
[30;1m242 | [0m[35m            extra_args += ["-debug", "5"][0m
[30;1m243 | [0m[35m        elif self.prov.logger.isEnabledFor(VERBOSE_LOG_LEVEL):[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/raop.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m235 | [0m[35m        sync_adjust = self.mass.config.get_raw_player_config_value(player_id, CONF_SYNC_ADJUST, 0)[0m
[30;1m236 | [0m[35m        assert isinstance(sync_adjust, int)[0m
[30;1m237 | [0m[35m        if device_password := self.mass.config.get_raw_player_config_value([0m
[30;1m238 | [0m[35m            player_id, CONF_PASSWORD, None[0m
[30;1m239 | [0m[35m        ):[0m
[30;1m240 | [0m[35m            extra_args += ["-password", str(device_password)][0m
[30;1m241 | [0m[35m        if self.prov.logger.isEnabledFor(logging.DEBUG):[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/raop.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m234 | [0m[35m                extra_args += [f"-{prop}", prop_value][0m
[30;1m235 | [0m[35m        sync_adjust = self.mass.config.get_raw_player_config_value(player_id, CONF_SYNC_ADJUST, 0)[0m
[30;1m236 | [0m[35m        assert isinstance(sync_adjust, int)[0m
[30;1m237 | [0m[35m        if device_password := self.mass.config.get_raw_player_config_value([0m
[30;1m238 | [0m[35m            player_id, CONF_PASSWORD, None[0m
[30;1m239 | [0m[35m        ):[0m
[30;1m240 | [0m[35m            extra_args += ["-password", str(device_password)][0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/raop.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m26 | [0m[35m    CONF_ALAC_ENCODE,[0m
[30;1m27 | [0m[35m    CONF_BIND_INTERFACE,[0m
[30;1m28 | [0m[35m    CONF_ENCRYPTION,[0m
[30;1m29 | [0m[35m    CONF_PASSWORD,[0m
[30;1m30 | [0m[35m    CONF_READ_AHEAD_BUFFER,[0m
[30;1m31 | [0m[35m)[0m
[30;1m32 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/json.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m28 | [0m[35m    if hasattr(obj, "to_dict"):[0m
[30;1m29 | [0m[35m        return obj.to_dict()[0m
[30;1m30 | [0m[35m    if isinstance(obj, bytes):[0m
[30;1m31 | [0m[35m        return base64.b64encode(obj).decode("ascii")[0m
[30;1m32 | [0m[35m    if isinstance(obj, DO_NOT_SERIALIZE_TYPES):[0m
[30;1m33 | [0m[35m        return None[0m
[30;1m34 | [0m[35m    if raise_unhandled:[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/json.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35m"""Helpers to work with (de)serializing of json."""[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport asyncio[0m
[30;1m4 | [0m[35mimport base64[0m
[30;1m5 | [0m[35mfrom _collections_abc import dict_keys, dict_values[0m
[30;1m6 | [0m[35mfrom types import MethodType[0m
[30;1m7 | [0m[35mfrom typing import Any, TypeVar[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/database.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35mLOGGER = logging.getLogger(f"{MASS_LOGGER_NAME}.database")[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mENABLE_DEBUG = os.environ.get("PYTHONDEVMODE") == "1"[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m@asynccontextmanager[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/images.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m42 | [0m[35m                return await resp.read()[0m
[30;1m43 | [0m[35m        except ClientError as err:[0m
[30;1m44 | [0m[35m            raise FileNotFoundError from err[0m
[30;1m45 | [0m[35m    # handle base64 embedded images[0m
[30;1m46 | [0m[35m    if path_or_url.startswith("data:image"):[0m
[30;1m47 | [0m[35m        return b64decode(path_or_url.split(",")[-1])[0m
[30;1m48 | [0m[35m    # handle FILE location (of type image)[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/images.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m6 | [0m[35mimport itertools[0m
[30;1m7 | [0m[35mimport os[0m
[30;1m8 | [0m[35mimport random[0m
[30;1m9 | [0m[35mfrom base64 import b64decode[0m
[30;1m10 | [0m[35mfrom collections.abc import Iterable[0m
[30;1m11 | [0m[35mfrom io import BytesIO[0m
[30;1m12 | [0m[35mfrom typing import TYPE_CHECKING[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/_template_music_provider/__init__.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m30 | [0m[35mIMPORTANT NOTE:[0m
[30;1m31 | [0m[35mWe strongly recommend developing on either MacOS or Linux and start your development[0m
[30;1m32 | [0m[35menvironment by running the setup.sh script in the scripts folder of the repository.[0m
[30;1m33 | [0m[35mThis will create a virtual environment and install all dependencies needed for development.[0m
[30;1m34 | [0m[35mSee also our general DEVELOPMENT.md guide in the repository for more information.[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m"""[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/listenbrainz_scrobble/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m36 | [0m[35m    assert token != SECURE_STRING_SUBSTITUTE[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m    client = ListenBrainz()[0m
[30;1m39 | [0m[35m    client.set_auth_token(token)[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m    return ListenBrainzScrobbleProvider(mass, manifest, config, client)[0m
[30;1m42 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/constants.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m44 | [0m[35mCONF_CORE: Final[str] = "core"[0m
[30;1m45 | [0m[35mCONF_PATH: Final[str] = "path"[0m
[30;1m46 | [0m[35mCONF_USERNAME: Final[str] = "username"[0m
[30;1m47 | [0m[35mCONF_PASSWORD: Final[str] = "password"[0m
[30;1m48 | [0m[35mCONF_VOLUME_NORMALIZATION: Final[str] = "volume_normalization"[0m
[30;1m49 | [0m[35mCONF_VOLUME_NORMALIZATION_TARGET: Final[str] = "volume_normalization_target"[0m
[30;1m50 | [0m[35mCONF_OUTPUT_LIMITER: Final[str] = "output_limiter"[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/constants.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m44 | [0m[35mCONF_CORE: Final[str] = "core"[0m
[30;1m45 | [0m[35mCONF_PATH: Final[str] = "path"[0m
[30;1m46 | [0m[35mCONF_USERNAME: Final[str] = "username"[0m
[30;1m47 | [0m[35mCONF_PASSWORD: Final[str] = "password"[0m
[30;1m48 | [0m[35mCONF_VOLUME_NORMALIZATION: Final[str] = "volume_normalization"[0m
[30;1m49 | [0m[35mCONF_VOLUME_NORMALIZATION_TARGET: Final[str] = "volume_normalization_target"[0m
[30;1m50 | [0m[35mCONF_OUTPUT_LIMITER: Final[str] = "output_limiter"[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/mass.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m77 | [0m[35m    EventCallBackType, tuple[EventType, ...] | None, tuple[str, ...] | None[0m
[30;1m78 | [0m[35m][0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35mENABLE_DEBUG = os.environ.get("PYTHONDEVMODE") == "1"[0m
[30;1m81 | [0m[35mLOGGER = logging.getLogger(MASS_LOGGER_NAME)[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35mBASE_DIR = os.path.dirname(os.path.abspath(__file__))[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/__main__.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m190 | [0m[35m    log_level = hass_options.get("log_level", args.log_level).upper()[0m
[30;1m191 | [0m[35m    dev_mode = os.environ.get("PYTHONDEVMODE", "0") == "1"[0m
[30;1m192 | [0m[35m    safe_mode = bool([0m
[30;1m193 | [0m[35m        args.safe_mode or hass_options.get("safe_mode") or os.environ.get("MASS_SAFE_MODE")[0m
[30;1m194 | [0m[35m    )[0m
[30;1m195 | [0m[35m[0m
[30;1m196 | [0m[35m    # setup logger[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/__main__.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m    # prefer value in hass_options[0m
[30;1m190 | [0m[35m    log_level = hass_options.get("log_level", args.log_level).upper()[0m
[30;1m191 | [0m[35m    dev_mode = os.environ.get("PYTHONDEVMODE", "0") == "1"[0m
[30;1m192 | [0m[35m    safe_mode = bool([0m
[30;1m193 | [0m[35m        args.safe_mode or hass_options.get("safe_mode") or os.environ.get("MASS_SAFE_MODE")[0m
[30;1m194 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/__main__.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m50 | [0m[35m    parser.add_argument([0m
[30;1m51 | [0m[35m        "--log-level",[0m
[30;1m52 | [0m[35m        type=str,[0m
[30;1m53 | [0m[35m        default=os.environ.get("LOG_LEVEL", "info"),[0m
[30;1m54 | [0m[35m        help="Provide logging level. Example --log-level debug, "[0m
[30;1m55 | [0m[35m        "default=info, possible=(critical, error, warning, info, debug, verbose)",[0m
[30;1m56 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m800 | [0m[35m            data = {}[0m
[30;1m801 | [0m[35m        url = f"http://www.qobuz.com/api.json/0.2/{endpoint}"[0m
[30;1m802 | [0m[35m        params["app_id"] = app_var(0)[0m
[30;1m803 | [0m[35m        params["user_auth_token"] = await self._auth_token()[0m
[30;1m804 | [0m[35m        async with self.mass.http_session.post([0m
[30;1m805 | [0m[35m            url, params=params, json=data, ssl=False[0m
[30;1m806 | [0m[35m        ) as response:[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m800 | [0m[35m            data = {}[0m
[30;1m801 | [0m[35m        url = f"http://www.qobuz.com/api.json/0.2/{endpoint}"[0m
[30;1m802 | [0m[35m        params["app_id"] = app_var(0)[0m
[30;1m803 | [0m[35m        params["user_auth_token"] = await self._auth_token()[0m
[30;1m804 | [0m[35m        async with self.mass.http_session.post([0m
[30;1m805 | [0m[35m            url, params=params, json=data, ssl=False[0m
[30;1m806 | [0m[35m        ) as response:[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m768 | [0m[35m            kwargs["request_ts"] = request_ts[0m
[30;1m769 | [0m[35m            kwargs["request_sig"] = request_sig[0m
[30;1m770 | [0m[35m            kwargs["app_id"] = app_var(0)[0m
[30;1m771 | [0m[35m            kwargs["user_auth_token"] = await self._auth_token()[0m
[30;1m772 | [0m[35m        async with ([0m
[30;1m773 | [0m[35m            self.mass.http_session.get(url, headers=headers, params=kwargs) as response,[0m
[30;1m774 | [0m[35m        ):[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m768 | [0m[35m            kwargs["request_ts"] = request_ts[0m
[30;1m769 | [0m[35m            kwargs["request_sig"] = request_sig[0m
[30;1m770 | [0m[35m            kwargs["app_id"] = app_var(0)[0m
[30;1m771 | [0m[35m            kwargs["user_auth_token"] = await self._auth_token()[0m
[30;1m772 | [0m[35m        async with ([0m
[30;1m773 | [0m[35m            self.mass.http_session.get(url, headers=headers, params=kwargs) as response,[0m
[30;1m774 | [0m[35m        ):[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m755 | [0m[35m            if not auth_token:[0m
[30;1m756 | [0m[35m                self.logger.debug("Not logged in")[0m
[30;1m757 | [0m[35m                return None[0m
[30;1m758 | [0m[35m            headers["X-User-Auth-Token"] = auth_token[0m
[30;1m759 | [0m[35m        if sign_request:[0m
[30;1m760 | [0m[35m            signing_data = "".join(endpoint.split("/"))[0m
[30;1m761 | [0m[35m            keys = list(kwargs.keys())[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m752 | [0m[35m        headers["Accept-Language"] = f"{locale}, {language};q=0.9, *;q=0.5"[0m
[30;1m753 | [0m[35m        if endpoint != "user/login":[0m
[30;1m754 | [0m[35m            auth_token = await self._auth_token()[0m
[30;1m755 | [0m[35m            if not auth_token:[0m
[30;1m756 | [0m[35m                self.logger.debug("Not logged in")[0m
[30;1m757 | [0m[35m                return None[0m
[30;1m758 | [0m[35m            headers["X-User-Auth-Token"] = auth_token[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m751 | [0m[35m        language = locale.split("-")[0][0m
[30;1m752 | [0m[35m        headers["Accept-Language"] = f"{locale}, {language};q=0.9, *;q=0.5"[0m
[30;1m753 | [0m[35m        if endpoint != "user/login":[0m
[30;1m754 | [0m[35m            auth_token = await self._auth_token()[0m
[30;1m755 | [0m[35m            if not auth_token:[0m
[30;1m756 | [0m[35m                self.logger.debug("Not logged in")[0m
[30;1m757 | [0m[35m                return None[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m751 | [0m[35m        language = locale.split("-")[0][0m
[30;1m752 | [0m[35m        headers["Accept-Language"] = f"{locale}, {language};q=0.9, *;q=0.5"[0m
[30;1m753 | [0m[35m        if endpoint != "user/login":[0m
[30;1m754 | [0m[35m            auth_token = await self._auth_token()[0m
[30;1m755 | [0m[35m            if not auth_token:[0m
[30;1m756 | [0m[35m                self.logger.debug("Not logged in")[0m
[30;1m757 | [0m[35m                return None[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m718 | [0m[35m                "Successfully logged in to Qobuz as %s", details["user"]["display_name"][0m
[30;1m719 | [0m[35m            )[0m
[30;1m720 | [0m[35m            self.mass.metadata.set_default_preferred_language(details["user"]["country_code"])[0m
[30;1m721 | [0m[35m            return details["user_auth_token"][0m
[30;1m722 | [0m[35m        return None[0m
[30;1m723 | [0m[35m[0m
[30;1m724 | [0m[35m    async def _get_all_items(self, endpoint, key="tracks", **kwargs):[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m708 | [0m[35m            return self._user_auth_info["user_auth_token"][0m
[30;1m709 | [0m[35m        params = {[0m
[30;1m710 | [0m[35m            "username": self.config.get_value(CONF_USERNAME),[0m
[30;1m711 | [0m[35m            "password": self.config.get_value(CONF_PASSWORD),[0m
[30;1m712 | [0m[35m            "device_manufacturer_id": "music_assistant",[0m
[30;1m713 | [0m[35m        }[0m
[30;1m714 | [0m[35m        details = await self._get_data("user/login", **params)[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m708 | [0m[35m            return self._user_auth_info["user_auth_token"][0m
[30;1m709 | [0m[35m        params = {[0m
[30;1m710 | [0m[35m            "username": self.config.get_value(CONF_USERNAME),[0m
[30;1m711 | [0m[35m            "password": self.config.get_value(CONF_PASSWORD),[0m
[30;1m712 | [0m[35m            "device_manufacturer_id": "music_assistant",[0m
[30;1m713 | [0m[35m        }[0m
[30;1m714 | [0m[35m        details = await self._get_data("user/login", **params)[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m705 | [0m[35m    async def _auth_token(self):[0m
[30;1m706 | [0m[35m        """Login to qobuz and store the token."""[0m
[30;1m707 | [0m[35m        if self._user_auth_info:[0m
[30;1m708 | [0m[35m            return self._user_auth_info["user_auth_token"][0m
[30;1m709 | [0m[35m        params = {[0m
[30;1m710 | [0m[35m            "username": self.config.get_value(CONF_USERNAME),[0m
[30;1m711 | [0m[35m            "password": self.config.get_value(CONF_PASSWORD),[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m702 | [0m[35m        return playlist[0m
[30;1m703 | [0m[35m[0m
[30;1m704 | [0m[35m    @lock[0m
[30;1m705 | [0m[35m    async def _auth_token(self):[0m
[30;1m706 | [0m[35m        """Login to qobuz and store the token."""[0m
[30;1m707 | [0m[35m        if self._user_auth_info:[0m
[30;1m708 | [0m[35m            return self._user_auth_info["user_auth_token"][0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m131 | [0m[35m            msg = "Invalid login credentials"[0m
[30;1m132 | [0m[35m            raise LoginFailed(msg)[0m
[30;1m133 | [0m[35m        # try to get a token, raise if that fails[0m
[30;1m134 | [0m[35m        token = await self._auth_token()[0m
[30;1m135 | [0m[35m        if not token:[0m
[30;1m136 | [0m[35m            msg = f"Login failed for user {self.config.get_value(CONF_USERNAME)}"[0m
[30;1m137 | [0m[35m            raise LoginFailed(msg)[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    async def handle_async_init(self) -> None:[0m
[30;1m129 | [0m[35m        """Handle async initialization of the provider."""[0m
[30;1m130 | [0m[35m        if not self.config.get_value(CONF_USERNAME) or not self.config.get_value(CONF_PASSWORD):[0m
[30;1m131 | [0m[35m            msg = "Invalid login credentials"[0m
[30;1m132 | [0m[35m            raise LoginFailed(msg)[0m
[30;1m133 | [0m[35m        # try to get a token, raise if that fails[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m111 | [0m[35m        ConfigEntry([0m
[30;1m112 | [0m[35m            key=CONF_PASSWORD,[0m
[30;1m113 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m114 | [0m[35m            label="Password",[0m
[30;1m115 | [0m[35m            required=True,[0m
[30;1m116 | [0m[35m        ),[0m
[30;1m117 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m109 | [0m[35m            required=True,[0m
[30;1m110 | [0m[35m        ),[0m
[30;1m111 | [0m[35m        ConfigEntry([0m
[30;1m112 | [0m[35m            key=CONF_PASSWORD,[0m
[30;1m113 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m114 | [0m[35m            label="Password",[0m
[30;1m115 | [0m[35m            required=True,[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m40 | [0m[35mfrom music_assistant_models.streamdetails import StreamDetails[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35mfrom music_assistant.constants import ([0m
[30;1m43 | [0m[35m    CONF_PASSWORD,[0m
[30;1m44 | [0m[35m    CONF_USERNAME,[0m
[30;1m45 | [0m[35m    VARIOUS_ARTISTS_MBID,[0m
[30;1m46 | [0m[35m    VARIOUS_ARTISTS_NAME,[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/app_vars.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/soundcloud/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m106 | [0m[35m        """Set up the Soundcloud provider."""[0m
[30;1m107 | [0m[35m        client_id = self.config.get_value(CONF_CLIENT_ID)[0m
[30;1m108 | [0m[35m        auth_token = self.config.get_value(CONF_AUTHORIZATION)[0m
[30;1m109 | [0m[35m        self._soundcloud = SoundcloudAsyncAPI(auth_token, client_id, self.mass.http_session)[0m
[30;1m110 | [0m[35m        await self._soundcloud.login()[0m
[30;1m111 | [0m[35m        self._me = await self._soundcloud.get_account_details()[0m
[30;1m112 | [0m[35m        self._user_id = self._me["id"][0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/soundcloud/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m105 | [0m[35m    async def handle_async_init(self) -> None:[0m
[30;1m106 | [0m[35m        """Set up the Soundcloud provider."""[0m
[30;1m107 | [0m[35m        client_id = self.config.get_value(CONF_CLIENT_ID)[0m
[30;1m108 | [0m[35m        auth_token = self.config.get_value(CONF_AUTHORIZATION)[0m
[30;1m109 | [0m[35m        self._soundcloud = SoundcloudAsyncAPI(auth_token, client_id, self.mass.http_session)[0m
[30;1m110 | [0m[35m        await self._soundcloud.login()[0m
[30;1m111 | [0m[35m        self._me = await self._soundcloud.get_account_details()[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/opensubsonic/sonic_provider.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m108 | [0m[35m        self._conn = SonicConnection([0m
[30;1m109 | [0m[35m            self.config.get_value(CONF_BASE_URL),[0m
[30;1m110 | [0m[35m            username=self.config.get_value(CONF_USERNAME),[0m
[30;1m111 | [0m[35m            password=self.config.get_value(CONF_PASSWORD),[0m
[30;1m112 | [0m[35m            legacyAuth=self.config.get_value(CONF_ENABLE_LEGACY_AUTH),[0m
[30;1m113 | [0m[35m            port=port,[0m
[30;1m114 | [0m[35m            serverPath=path,[0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/opensubsonic/sonic_provider.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m108 | [0m[35m        self._conn = SonicConnection([0m
[30;1m109 | [0m[35m            self.config.get_value(CONF_BASE_URL),[0m
[30;1m110 | [0m[35m            username=self.config.get_value(CONF_USERNAME),[0m
[30;1m111 | [0m[35m            password=self.config.get_value(CONF_PASSWORD),[0m
[30;1m112 | [0m[35m            legacyAuth=self.config.get_value(CONF_ENABLE_LEGACY_AUTH),[0m
[30;1m113 | [0m[35m            port=port,[0m
[30;1m114 | [0m[35m            serverPath=path,[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/opensubsonic/sonic_provider.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m46 | [0m[35mfrom music_assistant_models.unique_list import UniqueList[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35mfrom music_assistant.constants import ([0m
[30;1m49 | [0m[35m    CONF_PASSWORD,[0m
[30;1m50 | [0m[35m    CONF_PATH,[0m
[30;1m51 | [0m[35m    CONF_PORT,[0m
[30;1m52 | [0m[35m    CONF_USERNAME,[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m298 | [0m[35m                raise LoginFailed("Do not use gpodder.net. See docs for explanation.")[0m
[30;1m299 | [0m[35m            try:[0m
[30;1m300 | [0m[35m                await self._client.init_gpodder([0m
[30;1m301 | [0m[35m                    username=username, password=password, base_url=base_url, device=device_id[0m
[30;1m302 | [0m[35m                )[0m
[30;1m303 | [0m[35m            except RuntimeError as exc:[0m
[30;1m304 | [0m[35m                raise LoginFailed("Login failed.") from exc[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m298 | [0m[35m                raise LoginFailed("Do not use gpodder.net. See docs for explanation.")[0m
[30;1m299 | [0m[35m            try:[0m
[30;1m300 | [0m[35m                await self._client.init_gpodder([0m
[30;1m301 | [0m[35m                    username=username, password=password, base_url=base_url, device=device_id[0m
[30;1m302 | [0m[35m                )[0m
[30;1m303 | [0m[35m            except RuntimeError as exc:[0m
[30;1m304 | [0m[35m                raise LoginFailed("Login failed.") from exc[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m291 | [0m[35m            if _username is None or _password is None or _device_id is None:[0m
[30;1m292 | [0m[35m                raise LoginFailed("Must provide username, password and device_id.")[0m
[30;1m293 | [0m[35m            username = str(_username)[0m
[30;1m294 | [0m[35m            password = str(_password)[0m
[30;1m295 | [0m[35m            device_id = str(_device_id)[0m
[30;1m296 | [0m[35m[0m
[30;1m297 | [0m[35m            if base_url.rstrip("/") == "https://gpodder.net":[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m291 | [0m[35m            if _username is None or _password is None or _device_id is None:[0m
[30;1m292 | [0m[35m                raise LoginFailed("Must provide username, password and device_id.")[0m
[30;1m293 | [0m[35m            username = str(_username)[0m
[30;1m294 | [0m[35m            password = str(_password)[0m
[30;1m295 | [0m[35m            device_id = str(_device_id)[0m
[30;1m296 | [0m[35m[0m
[30;1m297 | [0m[35m            if base_url.rstrip("/") == "https://gpodder.net":[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m289 | [0m[35m        else:[0m
[30;1m290 | [0m[35m            self.update_config_value(CONF_USING_GPODDER, True)[0m
[30;1m291 | [0m[35m            if _username is None or _password is None or _device_id is None:[0m
[30;1m292 | [0m[35m                raise LoginFailed("Must provide username, password and device_id.")[0m
[30;1m293 | [0m[35m            username = str(_username)[0m
[30;1m294 | [0m[35m            password = str(_password)[0m
[30;1m295 | [0m[35m            device_id = str(_device_id)[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m288 | [0m[35m            self._client.init_nc(base_url=nc_url, nc_token=str(nc_token))[0m
[30;1m289 | [0m[35m        else:[0m
[30;1m290 | [0m[35m            self.update_config_value(CONF_USING_GPODDER, True)[0m
[30;1m291 | [0m[35m            if _username is None or _password is None or _device_id is None:[0m
[30;1m292 | [0m[35m                raise LoginFailed("Must provide username, password and device_id.")[0m
[30;1m293 | [0m[35m            username = str(_username)[0m
[30;1m294 | [0m[35m            password = str(_password)[0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m274 | [0m[35m        """Pass config values to client and initialize."""[0m
[30;1m275 | [0m[35m        base_url = str(self.config.get_value(CONF_URL))[0m
[30;1m276 | [0m[35m        _username = self.config.get_value(CONF_USERNAME)[0m
[30;1m277 | [0m[35m        _password = self.config.get_value(CONF_PASSWORD)[0m
[30;1m278 | [0m[35m        _device_id = self.config.get_value(CONF_DEVICE_ID)[0m
[30;1m279 | [0m[35m        nc_url = str(self.config.get_value(CONF_URL_NC))[0m
[30;1m280 | [0m[35m        nc_token = self.config.get_value(CONF_TOKEN_NC)[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m274 | [0m[35m        """Pass config values to client and initialize."""[0m
[30;1m275 | [0m[35m        base_url = str(self.config.get_value(CONF_URL))[0m
[30;1m276 | [0m[35m        _username = self.config.get_value(CONF_USERNAME)[0m
[30;1m277 | [0m[35m        _password = self.config.get_value(CONF_PASSWORD)[0m
[30;1m278 | [0m[35m        _device_id = self.config.get_value(CONF_DEVICE_ID)[0m
[30;1m279 | [0m[35m        nc_url = str(self.config.get_value(CONF_URL_NC))[0m
[30;1m280 | [0m[35m        nc_token = self.config.get_value(CONF_TOKEN_NC)[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m181 | [0m[35m            required=False,[0m
[30;1m182 | [0m[35m            description="Password for gPodder instance.",[0m
[30;1m183 | [0m[35m            hidden=authenticated_nc,[0m
[30;1m184 | [0m[35m            value=values.get(CONF_PASSWORD),[0m
[30;1m185 | [0m[35m        ),[0m
[30;1m186 | [0m[35m        ConfigEntry([0m
[30;1m187 | [0m[35m            key=CONF_DEVICE_ID,[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m179 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m180 | [0m[35m            label="Password",[0m
[30;1m181 | [0m[35m            required=False,[0m
[30;1m182 | [0m[35m            description="Password for gPodder instance.",[0m
[30;1m183 | [0m[35m            hidden=authenticated_nc,[0m
[30;1m184 | [0m[35m            value=values.get(CONF_PASSWORD),[0m
[30;1m185 | [0m[35m        ),[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m177 | [0m[35m        ConfigEntry([0m
[30;1m178 | [0m[35m            key=CONF_PASSWORD,[0m
[30;1m179 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m180 | [0m[35m            label="Password",[0m
[30;1m181 | [0m[35m            required=False,[0m
[30;1m182 | [0m[35m            description="Password for gPodder instance.",[0m
[30;1m183 | [0m[35m            hidden=authenticated_nc,[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m175 | [0m[35m            value=values.get(CONF_USERNAME),[0m
[30;1m176 | [0m[35m        ),[0m
[30;1m177 | [0m[35m        ConfigEntry([0m
[30;1m178 | [0m[35m            key=CONF_PASSWORD,[0m
[30;1m179 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m180 | [0m[35m            label="Password",[0m
[30;1m181 | [0m[35m            required=False,[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m133 | [0m[35m                raise LoginFailed("The specified url seems not to belong to a nextcloud instance.")[0m
[30;1m134 | [0m[35m            if response.status == 200:[0m
[30;1m135 | [0m[35m                data = await response.json()[0m
[30;1m136 | [0m[35m                values[CONF_TOKEN_NC] = data["appPassword"][0m
[30;1m137 | [0m[35m                break[0m
[30;1m138 | [0m[35m            await asyncio.sleep(1)[0m
[30;1m139 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m69 | [0m[35m# Config for "classic" gpodder api[0m
[30;1m70 | [0m[35mCONF_URL = "url"[0m
[30;1m71 | [0m[35mCONF_USERNAME = "username"[0m
[30;1m72 | [0m[35mCONF_PASSWORD = "password"[0m
[30;1m73 | [0m[35mCONF_DEVICE_ID = "device_id"[0m
[30;1m74 | [0m[35mCONF_USING_GPODDER = "using_gpodder"  # hidden, bool, true if not nextcloud used[0m
[30;1m75 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m69 | [0m[35m# Config for "classic" gpodder api[0m
[30;1m70 | [0m[35mCONF_URL = "url"[0m
[30;1m71 | [0m[35mCONF_USERNAME = "username"[0m
[30;1m72 | [0m[35mCONF_PASSWORD = "password"[0m
[30;1m73 | [0m[35mCONF_DEVICE_ID = "device_id"[0m
[30;1m74 | [0m[35mCONF_USING_GPODDER = "using_gpodder"  # hidden, bool, true if not nextcloud used[0m
[30;1m75 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.get\(.*(fromhex|decode)[0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.get\(.*(fromhex|decode)[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.get\(.*(fromhex|decode)[0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/jellyfin/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m154 | [0m[35m            self._client = await authenticate_by_name([0m
[30;1m155 | [0m[35m                session_config,[0m
[30;1m156 | [0m[35m                username,[0m
[30;1m157 | [0m[35m                str(self.config.get_value(CONF_PASSWORD)),[0m
[30;1m158 | [0m[35m            )[0m
[30;1m159 | [0m[35m        except Exception as err:[0m
[30;1m160 | [0m[35m            raise LoginFailed(f"Authentication failed: {err}") from err[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/jellyfin/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m103 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m104 | [0m[35m            label="Password",[0m
[30;1m105 | [0m[35m            required=False,[0m
[30;1m106 | [0m[35m            description="The password to authenticate to the remote server.",[0m
[30;1m107 | [0m[35m        ),[0m
[30;1m108 | [0m[35m        ConfigEntry([0m
[30;1m109 | [0m[35m            key=CONF_VERIFY_SSL,[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/jellyfin/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m101 | [0m[35m        ConfigEntry([0m
[30;1m102 | [0m[35m            key=CONF_PASSWORD,[0m
[30;1m103 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m104 | [0m[35m            label="Password",[0m
[30;1m105 | [0m[35m            required=False,[0m
[30;1m106 | [0m[35m            description="The password to authenticate to the remote server.",[0m
[30;1m107 | [0m[35m        ),[0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/jellyfin/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m99 | [0m[35m            "the remote host, For example 'media'.",[0m
[30;1m100 | [0m[35m        ),[0m
[30;1m101 | [0m[35m        ConfigEntry([0m
[30;1m102 | [0m[35m            key=CONF_PASSWORD,[0m
[30;1m103 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m104 | [0m[35m            label="Password",[0m
[30;1m105 | [0m[35m            required=False,[0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/jellyfin/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35mCONF_URL = "url"[0m
[30;1m57 | [0m[35mCONF_USERNAME = "username"[0m
[30;1m58 | [0m[35mCONF_PASSWORD = "password"[0m
[30;1m59 | [0m[35mCONF_VERIFY_SSL = "verify_ssl"[0m
[30;1m60 | [0m[35mFAKE_ARTIST_PREFIX = "_fake://"[0m
[30;1m61 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/jellyfin/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35mCONF_URL = "url"[0m
[30;1m57 | [0m[35mCONF_USERNAME = "username"[0m
[30;1m58 | [0m[35mCONF_PASSWORD = "password"[0m
[30;1m59 | [0m[35mCONF_VERIFY_SSL = "verify_ssl"[0m
[30;1m60 | [0m[35mFAKE_ARTIST_PREFIX = "_fake://"[0m
[30;1m61 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/provider.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m648 | [0m[35m    ) -> None:[0m
[30;1m649 | [0m[35m        """Handle enqueuing of the next queue item using the legacy unpnp api."""[0m
[30;1m650 | [0m[35m        xml_data = f"""[0m
[30;1m651 | [0m[35m            <s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/" s:encodingStyle="http://[0m
[30;1m652 | [0m[35m                <s:Body>[0m
[30;1m653 | [0m[35m                    <u:SetNextAVTransportURI xmlns:u="urn:schemas-upnp-org:service:AVTransport:1">[0m
[30;1m654 | [0m[35m                        <InstanceID>0</InstanceID>[0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m147 | [0m[35m        self.username = username[0m
[30;1m148 | [0m[35m        self.device = device[0m
[30;1m149 | [0m[35m        self.base_url = base_url.rstrip("/")[0m
[30;1m150 | [0m[35m        self.auth = aiohttp.BasicAuth(username, password)[0m
[30;1m151 | [0m[35m        await self._post(endpoint=f"api/2/auth/{username}/login.json")[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m142 | [0m[35m        self.token = nc_token[0m
[30;1m143 | [0m[35m        self.base_url = base_url.rstrip("/")[0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35m    async def init_gpodder(self, username: str, password: str, device: str, base_url: str) -> None:[0m
[30;1m146 | [0m[35m        """Init via basic auth."""[0m
[30;1m147 | [0m[35m        self.username = username[0m
[30;1m148 | [0m[35m        self.device = device[0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m960 | [0m[35m[0m
[30;1m961 | [0m[35m        def _refresh_plex_token() -> MyPlexAccount:[0m
[30;1m962 | [0m[35m            if self._myplex_account is None:[0m
[30;1m963 | [0m[35m                myplex_account = MyPlexAccount(token=auth_token)[0m
[30;1m964 | [0m[35m                self._myplex_account = myplex_account[0m
[30;1m965 | [0m[35m            self._myplex_account.ping()[0m
[30;1m966 | [0m[35m            return self._myplex_account[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m955 | [0m[35m[0m
[30;1m956 | [0m[35m    async def get_myplex_account_and_refresh_token(self, auth_token: str) -> MyPlexAccount:[0m
[30;1m957 | [0m[35m        """Get a MyPlexAccount object and refresh the token if needed."""[0m
[30;1m958 | [0m[35m        if auth_token == AUTH_TOKEN_UNAUTH:[0m
[30;1m959 | [0m[35m            return self._myplex_account[0m
[30;1m960 | [0m[35m[0m
[30;1m961 | [0m[35m        def _refresh_plex_token() -> MyPlexAccount:[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m955 | [0m[35m[0m
[30;1m956 | [0m[35m    async def get_myplex_account_and_refresh_token(self, auth_token: str) -> MyPlexAccount:[0m
[30;1m957 | [0m[35m        """Get a MyPlexAccount object and refresh the token if needed."""[0m
[30;1m958 | [0m[35m        if auth_token == AUTH_TOKEN_UNAUTH:[0m
[30;1m959 | [0m[35m            return self._myplex_account[0m
[30;1m960 | [0m[35m[0m
[30;1m961 | [0m[35m        def _refresh_plex_token() -> MyPlexAccount:[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m953 | [0m[35m[0m
[30;1m954 | [0m[35m        await asyncio.to_thread(mark_played)[0m
[30;1m955 | [0m[35m[0m
[30;1m956 | [0m[35m    async def get_myplex_account_and_refresh_token(self, auth_token: str) -> MyPlexAccount:[0m
[30;1m957 | [0m[35m        """Get a MyPlexAccount object and refresh the token if needed."""[0m
[30;1m958 | [0m[35m        if auth_token == AUTH_TOKEN_UNAUTH:[0m
[30;1m959 | [0m[35m            return self._myplex_account[0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m417 | [0m[35m    async def _run_async([0m
[30;1m418 | [0m[35m        self, call: Callable[Param, RetType], *args: Param.args, **kwargs: Param.kwargs[0m
[30;1m419 | [0m[35m    ) -> RetType:[0m
[30;1m420 | [0m[35m        await self.get_myplex_account_and_refresh_token(str(self.config.get_value(CONF_AUTH_TOKEN)))[0m
[30;1m421 | [0m[35m        return await asyncio.to_thread(call, *args, **kwargs)[0m
[30;1m422 | [0m[35m[0m
[30;1m423 | [0m[35m    async def _get_data(self, key: str, cls: type[PlexObjectT]) -> PlexObjectT:[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m372 | [0m[35m            return plex_server[0m
[30;1m373 | [0m[35m[0m
[30;1m374 | [0m[35m        self._myplex_account = await self.get_myplex_account_and_refresh_token([0m
[30;1m375 | [0m[35m            str(self.config.get_value(CONF_AUTH_TOKEN))[0m
[30;1m376 | [0m[35m        )[0m
[30;1m377 | [0m[35m        try:[0m
[30;1m378 | [0m[35m            self._plex_server = await self._run_async(connect)[0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m363 | [0m[35m                    # token invalid, invalidate the config[0m
[30;1m364 | [0m[35m                    self.mass.create_task([0m
[30;1m365 | [0m[35m                        self.mass.config.remove_provider_config_value([0m
[30;1m366 | [0m[35m                            self.instance_id, CONF_AUTH_TOKEN[0m
[30;1m367 | [0m[35m                        ),[0m
[30;1m368 | [0m[35m                    )[0m
[30;1m369 | [0m[35m                    msg = "Authentication failed"[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m346 | [0m[35m                    f"{local_server_protocol}://{self.config.get_value(CONF_LOCAL_SERVER_IP)}"[0m
[30;1m347 | [0m[35m                    f":{self.config.get_value(CONF_LOCAL_SERVER_PORT)}"[0m
[30;1m348 | [0m[35m                )[0m
[30;1m349 | [0m[35m                if token == AUTH_TOKEN_UNAUTH:[0m
[30;1m350 | [0m[35m                    # Doing local connection, not via plex.tv.[0m
[30;1m351 | [0m[35m                    plex_server = PlexServer(plex_url)[0m
[30;1m352 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m341 | [0m[35m                local_server_protocol = ([0m
[30;1m342 | [0m[35m                    "https" if self.config.get_value(CONF_LOCAL_SERVER_SSL) else "http"[0m
[30;1m343 | [0m[35m                )[0m
[30;1m344 | [0m[35m                token = self.config.get_value(CONF_AUTH_TOKEN)[0m
[30;1m345 | [0m[35m                plex_url = ([0m
[30;1m346 | [0m[35m                    f"{local_server_protocol}://{self.config.get_value(CONF_LOCAL_SERVER_IP)}"[0m
[30;1m347 | [0m[35m                    f":{self.config.get_value(CONF_LOCAL_SERVER_PORT)}"[0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m272 | [0m[35m        entries.append(conf_libraries)[0m
[30;1m273 | [0m[35m[0m
[30;1m274 | [0m[35m    # show authentication options[0m
[30;1m275 | [0m[35m    if values is None or not values.get(CONF_AUTH_TOKEN):[0m
[30;1m276 | [0m[35m        entries.append([0m
[30;1m277 | [0m[35m            ConfigEntry([0m
[30;1m278 | [0m[35m                key=CONF_ACTION_AUTH_MYPLEX,[0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m240 | [0m[35m            CONF_ACTION_AUTH_MYPLEX,[0m
[30;1m241 | [0m[35m            CONF_ACTION_AUTH_LOCAL,[0m
[30;1m242 | [0m[35m        ):[0m
[30;1m243 | [0m[35m            token = mass.config.decrypt_string(str(values.get(CONF_AUTH_TOKEN)))[0m
[30;1m244 | [0m[35m            server_http_ip = str(values.get(CONF_LOCAL_SERVER_IP))[0m
[30;1m245 | [0m[35m            server_http_port = str(values.get(CONF_LOCAL_SERVER_PORT))[0m
[30;1m246 | [0m[35m            server_http_ssl = bool(values.get(CONF_LOCAL_SERVER_SSL))[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m231 | [0m[35m            label="Library",[0m
[30;1m232 | [0m[35m            required=True,[0m
[30;1m233 | [0m[35m            description="The library to connect to (e.g. Music)",[0m
[30;1m234 | [0m[35m            depends_on=CONF_AUTH_TOKEN,[0m
[30;1m235 | [0m[35m            action=CONF_ACTION_LIBRARY,[0m
[30;1m236 | [0m[35m            action_label="Select Plex Music Library",[0m
[30;1m237 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m224 | [0m[35m    # config flow auth action/step to pick the library to use[0m
[30;1m225 | [0m[35m    # because this call is very slow, we only show/calculate the dropdown if we do[0m
[30;1m226 | [0m[35m    # not yet have this info or we/user invalidated it.[0m
[30;1m227 | [0m[35m    if values and values.get(CONF_AUTH_TOKEN):[0m
[30;1m228 | [0m[35m        conf_libraries = ConfigEntry([0m
[30;1m229 | [0m[35m            key=CONF_LIBRARY_ID,[0m
[30;1m230 | [0m[35m            type=ConfigEntryType.STRING,[0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m216 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m217 | [0m[35m            label=CONF_AUTH_TOKEN,[0m
[30;1m218 | [0m[35m            action=CONF_AUTH_TOKEN,[0m
[30;1m219 | [0m[35m            value=cast("str | None", values.get(CONF_AUTH_TOKEN)) if values else None,[0m
[30;1m220 | [0m[35m            hidden=True,[0m
[30;1m221 | [0m[35m        ),[0m
[30;1m222 | [0m[35m    ][0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m215 | [0m[35m            key=CONF_AUTH_TOKEN,[0m
[30;1m216 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m217 | [0m[35m            label=CONF_AUTH_TOKEN,[0m
[30;1m218 | [0m[35m            action=CONF_AUTH_TOKEN,[0m
[30;1m219 | [0m[35m            value=cast("str | None", values.get(CONF_AUTH_TOKEN)) if values else None,[0m
[30;1m220 | [0m[35m            hidden=True,[0m
[30;1m221 | [0m[35m        ),[0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m214 | [0m[35m        ConfigEntry([0m
[30;1m215 | [0m[35m            key=CONF_AUTH_TOKEN,[0m
[30;1m216 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m217 | [0m[35m            label=CONF_AUTH_TOKEN,[0m
[30;1m218 | [0m[35m            action=CONF_AUTH_TOKEN,[0m
[30;1m219 | [0m[35m            value=cast("str | None", values.get(CONF_AUTH_TOKEN)) if values else None,[0m
[30;1m220 | [0m[35m            hidden=True,[0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m212 | [0m[35m            category="advanced",[0m
[30;1m213 | [0m[35m        ),[0m
[30;1m214 | [0m[35m        ConfigEntry([0m
[30;1m215 | [0m[35m            key=CONF_AUTH_TOKEN,[0m
[30;1m216 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m217 | [0m[35m            label=CONF_AUTH_TOKEN,[0m
[30;1m218 | [0m[35m            action=CONF_AUTH_TOKEN,[0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m156 | [0m[35m    # handle action Local auth (no MyPlex)[0m
[30;1m157 | [0m[35m    if action == CONF_ACTION_AUTH_LOCAL:[0m
[30;1m158 | [0m[35m        assert values[0m
[30;1m159 | [0m[35m        values[CONF_AUTH_TOKEN] = AUTH_TOKEN_UNAUTH[0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35m    # collect all config entries to show[0m
[30;1m162 | [0m[35m    entries: list[ConfigEntry] = [][0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m156 | [0m[35m    # handle action Local auth (no MyPlex)[0m
[30;1m157 | [0m[35m    if action == CONF_ACTION_AUTH_LOCAL:[0m
[30;1m158 | [0m[35m        assert values[0m
[30;1m159 | [0m[35m        values[CONF_AUTH_TOKEN] = AUTH_TOKEN_UNAUTH[0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35m    # collect all config entries to show[0m
[30;1m162 | [0m[35m    entries: list[ConfigEntry] = [][0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m151 | [0m[35m                msg = "Authentication to MyPlex failed"[0m
[30;1m152 | [0m[35m                raise LoginFailed(msg)[0m
[30;1m153 | [0m[35m            # set the retrieved token on the values object to pass along[0m
[30;1m154 | [0m[35m            values[CONF_AUTH_TOKEN] = plex_auth.token[0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35m    # handle action Local auth (no MyPlex)[0m
[30;1m157 | [0m[35m    if action == CONF_ACTION_AUTH_LOCAL:[0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m142 | [0m[35m    # handle action MyPlex auth[0m
[30;1m143 | [0m[35m    if action == CONF_ACTION_AUTH_MYPLEX:[0m
[30;1m144 | [0m[35m        assert values[0m
[30;1m145 | [0m[35m        values[CONF_AUTH_TOKEN] = None[0m
[30;1m146 | [0m[35m        async with AuthenticationHelper(mass, str(values["session_id"])) as auth_helper:[0m
[30;1m147 | [0m[35m            plex_auth = MyPlexPinLogin(headers={"X-Plex-Product": "Music Assistant"}, oauth=True)[0m
[30;1m148 | [0m[35m            auth_url = plex_auth.oauthUrl(auth_helper.callback_url)[0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m133 | [0m[35m    # handle action clear authentication[0m
[30;1m134 | [0m[35m    if action == CONF_ACTION_CLEAR_AUTH:[0m
[30;1m135 | [0m[35m        assert values[0m
[30;1m136 | [0m[35m        values[CONF_AUTH_TOKEN] = None[0m
[30;1m137 | [0m[35m        values[CONF_LOCAL_SERVER_IP] = None[0m
[30;1m138 | [0m[35m        values[CONF_LOCAL_SERVER_PORT] = 32400[0m
[30;1m139 | [0m[35m        values[CONF_LOCAL_SERVER_SSL] = False[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m94 | [0m[35m    mass: MusicAssistant, manifest: ProviderManifest, config: ProviderConfig[0m
[30;1m95 | [0m[35m) -> ProviderInstanceType:[0m
[30;1m96 | [0m[35m    """Initialize provider(instance) with given configuration."""[0m
[30;1m97 | [0m[35m    if not config.get_value(CONF_AUTH_TOKEN):[0m
[30;1m98 | [0m[35m        msg = "Invalid login credentials"[0m
[30;1m99 | [0m[35m        raise LoginFailed(msg)[0m
[30;1m100 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35mFAKE_ARTIST_PREFIX = "_fake://"[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35mAUTH_TOKEN_UNAUTH = "local_auth"[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35masync def setup([0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m78 | [0m[35mCONF_ACTION_LIBRARY = "library"[0m
[30;1m79 | [0m[35mCONF_ACTION_GDM = "gdm"[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35mCONF_AUTH_TOKEN = "token"[0m
[30;1m82 | [0m[35mCONF_LIBRARY_ID = "library_id"[0m
[30;1m83 | [0m[35mCONF_LOCAL_SERVER_IP = "local_server_ip"[0m
[30;1m84 | [0m[35mCONF_LOCAL_SERVER_PORT = "local_server_port"[0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/bin/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m2 | [0m[35mYou need a custom CDM if you would like to playback Apple music on your local machine. The music pro[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35m1. client_id.bin[0m
[30;1m5 | [0m[35m2. private_key.pem[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mThese two files allow Music Assistant to decrypt Widevine protected songs. More info on how you can [0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/fully_kiosk/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m95 | [0m[35m            self.mass.http_session,[0m
[30;1m96 | [0m[35m            self.config.get_value(CONF_IP_ADDRESS),[0m
[30;1m97 | [0m[35m            self.config.get_value(CONF_PORT),[0m
[30;1m98 | [0m[35m            self.config.get_value(CONF_PASSWORD),[0m
[30;1m99 | [0m[35m        )[0m
[30;1m100 | [0m[35m        try:[0m
[30;1m101 | [0m[35m            async with asyncio.timeout(15):[0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/fully_kiosk/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m65 | [0m[35m        ConfigEntry([0m
[30;1m66 | [0m[35m            key=CONF_PASSWORD,[0m
[30;1m67 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m68 | [0m[35m            label="Password to use to connect to the Fully Kiosk API.",[0m
[30;1m69 | [0m[35m            required=True,[0m
[30;1m70 | [0m[35m        ),[0m
[30;1m71 | [0m[35m        ConfigEntry([0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/fully_kiosk/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m63 | [0m[35m            required=True,[0m
[30;1m64 | [0m[35m        ),[0m
[30;1m65 | [0m[35m        ConfigEntry([0m
[30;1m66 | [0m[35m            key=CONF_PASSWORD,[0m
[30;1m67 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m68 | [0m[35m            label="Password to use to connect to the Fully Kiosk API.",[0m
[30;1m69 | [0m[35m            required=True,[0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/fully_kiosk/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m18 | [0m[35m    CONF_ENTRY_HTTP_PROFILE,[0m
[30;1m19 | [0m[35m    CONF_ENTRY_OUTPUT_CODEC_DEFAULT_MP3,[0m
[30;1m20 | [0m[35m    CONF_IP_ADDRESS,[0m
[30;1m21 | [0m[35m    CONF_PASSWORD,[0m
[30;1m22 | [0m[35m    CONF_PORT,[0m
[30;1m23 | [0m[35m    VERBOSE_LOG_LEVEL,[0m
[30;1m24 | [0m[35m)[0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/opensubsonic/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m51 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m52 | [0m[35m            label="Password",[0m
[30;1m53 | [0m[35m            required=True,[0m
[30;1m54 | [0m[35m            description="The password associated with the username",[0m
[30;1m55 | [0m[35m        ),[0m
[30;1m56 | [0m[35m        ConfigEntry([0m
[30;1m57 | [0m[35m            key=CONF_BASE_URL,[0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/opensubsonic/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m49 | [0m[35m        ConfigEntry([0m
[30;1m50 | [0m[35m            key=CONF_PASSWORD,[0m
[30;1m51 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m52 | [0m[35m            label="Password",[0m
[30;1m53 | [0m[35m            required=True,[0m
[30;1m54 | [0m[35m            description="The password associated with the username",[0m
[30;1m55 | [0m[35m        ),[0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/opensubsonic/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m47 | [0m[35m            description="Your username for this Open Subsonic server",[0m
[30;1m48 | [0m[35m        ),[0m
[30;1m49 | [0m[35m        ConfigEntry([0m
[30;1m50 | [0m[35m            key=CONF_PASSWORD,[0m
[30;1m51 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m52 | [0m[35m            label="Password",[0m
[30;1m53 | [0m[35m            required=True,[0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/opensubsonic/__init__.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m7 | [0m[35mfrom music_assistant_models.config_entries import ConfigEntry, ConfigValueType, ProviderConfig[0m
[30;1m8 | [0m[35mfrom music_assistant_models.enums import ConfigEntryType[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mfrom music_assistant.constants import CONF_PASSWORD, CONF_PATH, CONF_PORT, CONF_USERNAME[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mfrom .sonic_provider import ([0m
[30;1m13 | [0m[35m    CONF_BASE_URL,[0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/radiobrowser/icon.svg[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m  | [0m[35mnkscape:window-maximized="1"[0m
[30;1m  | [0m[35m     inkscape:current-layer="layer1" /><defs[0m
[30;1m  | [0m[35m     id="defs1" /><g[0m
[30;1m  | [0m[35m     inkscape:label="Layer 1"[0m
[30;1m  | [0m[35m     inkscape:groupmode="layer"[0m
[30;1m  | [0m[35m     id="layer1"><image[0m
[30;1m  | [0m[35m       width="135.06667"[0m
[30;1m  | [0m[35m       height="134.73334"[0m
[30;1m  | [0m[35m       preserveAspectRatio="none"[0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m30826 | [0m[35m            if (fail == 0) onload(); else onerror();[0m
[30;1m30827 | [0m[35m          }[0m
[30;1m30828 | [0m[35m          paths.forEach(function(path) {[0m
[30;1m30829 | [0m[35m            var getRequest = files.get(path);[0m
[30;1m30830 | [0m[35m            getRequest.onsuccess = function getRequest_onsuccess() {[0m
[30;1m30831 | [0m[35m              if (FS.analyzePath(path).exists) {[0m
[30;1m30832 | [0m[35m                FS.unlink(path);[0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m30725 | [0m[35m            }[0m
[30;1m30726 | [0m[35m          } else {[0m
[30;1m30727 | [0m[35m            for (var i = 0; i < size; i++) { // LazyUint8Array from sync binary XHR[0m
[30;1m30728 | [0m[35m              buffer[offset + i] = contents.get(position + i);[0m
[30;1m30729 | [0m[35m            }[0m
[30;1m30730 | [0m[35m          }[0m
[30;1m30731 | [0m[35m          return size;[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m515 | [0m[35m}[0m
[30;1m516 | [0m[35m[0m
[30;1m517 | [0m[35mfunction removeFunctionWasm(index) {[0m
[30;1m518 | [0m[35m  functionsInTableMap.delete(wasmTable.get(index));[0m
[30;1m519 | [0m[35m  freeTableIndexes.push(index);[0m
[30;1m520 | [0m[35m}[0m
[30;1m521 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m474 | [0m[35m    }[0m
[30;1m475 | [0m[35m  }[0m
[30;1m476 | [0m[35m  if (functionsInTableMap.has(func)) {[0m
[30;1m477 | [0m[35m    return functionsInTableMap.get(func);[0m
[30;1m478 | [0m[35m  }[0m
[30;1m479 | [0m[35m[0m
[30;1m480 | [0m[35m  // It's not in the table, add it now.[0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m466 | [0m[35m  if (!functionsInTableMap) {[0m
[30;1m467 | [0m[35m    functionsInTableMap = new WeakMap();[0m
[30;1m468 | [0m[35m    for (var i = 0; i < table.length; i++) {[0m
[30;1m469 | [0m[35m      var item = table.get(i);[0m
[30;1m470 | [0m[35m      // Ignore null values.[0m
[30;1m471 | [0m[35m      if (item) {[0m
[30;1m472 | [0m[35m        functionsInTableMap.set(item, i);[0m

[31m--[ [0m[34mMatch #[0m[33m232[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m31109 | [0m[35m    var chr = array[i];[0m
[30;1m31110 | [0m[35m    if (chr > 0xFF) {[0m
[30;1m31111 | [0m[35m      if (ASSERTIONS) {[0m
[30;1m31112 | [0m[35m        assert(false, 'Character code ' + chr + ' (' + String.fromCharCode(chr) + ')  at offset ' + [0m
[30;1m31113 | [0m[35m      }[0m
[30;1m31114 | [0m[35m      chr &= 0xFF;[0m
[30;1m31115 | [0m[35m    }[0m

[31m--[ [0m[34mMatch #[0m[33m233[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m29514 | [0m[35m        FS.syncFSRequests++;[0m
[30;1m29515 | [0m[35m[0m
[30;1m29516 | [0m[35m        if (FS.syncFSRequests > 1) {[0m
[30;1m29517 | [0m[35m          err('warning: ' + FS.syncFSRequests + ' FS.syncfs operations in flight at once, probably j[0m
[30;1m29518 | [0m[35m        }[0m
[30;1m29519 | [0m[35m[0m
[30;1m29520 | [0m[35m        var mounts = FS.getMounts(FS.root.mount);[0m

[31m--[ [0m[34mMatch #[0m[33m234[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m29058 | [0m[35m        },mknod:function(parent, name, mode, dev) {[0m
[30;1m29059 | [0m[35m          return MEMFS.createNode(parent, name, mode, dev);[0m
[30;1m29060 | [0m[35m        },rename:function(old_node, new_dir, new_name) {[0m
[30;1m29061 | [0m[35m          // if we're overwriting a directory at new_name, make sure it's empty.[0m
[30;1m29062 | [0m[35m          if (FS.isDir(old_node.mode)) {[0m
[30;1m29063 | [0m[35m            var new_node;[0m
[30;1m29064 | [0m[35m            try {[0m

[31m--[ [0m[34mMatch #[0m[33m235[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m28990 | [0m[35mershooting the allocation cap by a very large margin.[0m
[30;1m28991 | [0m[35m        var CAPACITY_DOUBLING_MAX = 1024 * 1024;[0m
[30;1m28992 | [0m[35m        newCapacity = Math.max(newCapacity, (prevCapacity * (prevCapacity < CAPACITY_DOUBLING_MAX ? [0m
[30;1m28993 | [0m[35m        if (prevCapacity != 0) newCapacity = Math.max(newCapacity, 256); // At minimum allocate 256b[0m
[30;1m28994 | [0m[35m        var oldContents = node.contents;[0m
[30;1m28995 | [0m[35m        node.contents = new Uint8Array(newCapacity); // Allocate new storage.[0m

[31m--[ [0m[34mMatch #[0m[33m236[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m28395 | [0m[35m      ) {[0m
[30;1m28396 | [0m[35m    return fetch(wasmBinaryFile, { credentials: 'same-origin' }).then(function(response) {[0m
[30;1m28397 | [0m[35m      if (!response['ok']) {[0m
[30;1m28398 | [0m[35m        throw "failed to load wasm binary file at '" + wasmBinaryFile + "'";[0m
[30;1m28399 | [0m[35m      }[0m
[30;1m28400 | [0m[35m      return response['arrayBuffer']();[0m
[30;1m28401 | [0m[35m    }).catch(function () {[0m

[31m--[ [0m[34mMatch #[0m[33m237[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m137 | [0m[35m};[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m// Determine the runtime environment we are in. You can customize this by[0m
[30;1m140 | [0m[35m// setting the ENVIRONMENT setting at compile time (see settings.js).[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35mvar ENVIRONMENT_IS_WEB = false;[0m
[30;1m143 | [0m[35mvar ENVIRONMENT_IS_WORKER = false;[0m

[31m--[ [0m[34mMatch #[0m[33m238[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31183 | [0m[35m    }[0m
[30;1m31184 | [0m[35m    return bytes;[0m
[30;1m31185 | [0m[35m  } catch (_) {[0m
[30;1m31186 | [0m[35m    throw new Error('Converting base64 string to bytes failed.');[0m
[30;1m31187 | [0m[35m  }[0m
[30;1m31188 | [0m[35m}[0m
[30;1m31189 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m239[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30926 | [0m[35m        }[0m
[30;1m30927 | [0m[35m        var node;[0m
[30;1m30928 | [0m[35m        var lookup = FS.lookupPath(path, { follow: true });[0m
[30;1m30929 | [0m[35m        node = lookup.node;[0m
[30;1m30930 | [0m[35m        if (!node) {[0m
[30;1m30931 | [0m[35m          return -44;[0m
[30;1m30932 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m240[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30682 | [0m[35m          var properties = { isDevice: false, url: url };[0m
[30;1m30683 | [0m[35m        }[0m
[30;1m30684 | [0m[35m[0m
[30;1m30685 | [0m[35m        var node = FS.createFile(parent, name, properties, canRead, canWrite);[0m
[30;1m30686 | [0m[35m        // This is a total hack, but I want to get this lazy file code out of the[0m
[30;1m30687 | [0m[35m        // core of MEMFS. If we want to keep this lazy file concept I feel it should[0m
[30;1m30688 | [0m[35m        // be its own thin LAZYFS proxying calls to MEMFS.[0m

[31m--[ [0m[34mMatch #[0m[33m241[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30483 | [0m[35m      },createDataFile:function(parent, name, data, canRead, canWrite, canOwn) {[0m
[30;1m30484 | [0m[35m        var path = name ? PATH.join2(typeof parent === 'string' ? parent : FS.getPath(parent), name)[0m
[30;1m30485 | [0m[35m        var mode = FS.getMode(canRead, canWrite);[0m
[30;1m30486 | [0m[35m        var node = FS.create(path, mode);[0m
[30;1m30487 | [0m[35m        if (data) {[0m
[30;1m30488 | [0m[35m          if (typeof data === 'string') {[0m
[30;1m30489 | [0m[35m            var arr = new Array(data.length);[0m

[31m--[ [0m[34mMatch #[0m[33m242[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30306 | [0m[35m        FS.mkdir('/proc/self/fd');[0m
[30;1m30307 | [0m[35m        FS.mount({[0m
[30;1m30308 | [0m[35m          mount: function() {[0m
[30;1m30309 | [0m[35m            var node = FS.createNode('/proc/self', 'fd', 16384 | 511 /* 0777 */, 73);[0m
[30;1m30310 | [0m[35m            node.node_ops = {[0m
[30;1m30311 | [0m[35m              lookup: function(parent, name) {[0m
[30;1m30312 | [0m[35m                var fd = +name;[0m

[31m--[ [0m[34mMatch #[0m[33m243[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29996 | [0m[35m            }[0m
[30;1m29997 | [0m[35m          } else {[0m
[30;1m29998 | [0m[35m            // node doesn't exist, try to create it[0m
[30;1m29999 | [0m[35m            node = FS.mknod(path, mode, 0);[0m
[30;1m30000 | [0m[35m            created = true;[0m
[30;1m30001 | [0m[35m          }[0m
[30;1m30002 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m244[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29981 | [0m[35m            var lookup = FS.lookupPath(path, {[0m
[30;1m29982 | [0m[35m              follow: !(flags & 131072)[0m
[30;1m29983 | [0m[35m            });[0m
[30;1m29984 | [0m[35m            node = lookup.node;[0m
[30;1m29985 | [0m[35m          } catch (e) {[0m
[30;1m29986 | [0m[35m            // ignore[0m
[30;1m29987 | [0m[35m          }[0m

[31m--[ [0m[34mMatch #[0m[33m245[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29974 | [0m[35m        }[0m
[30;1m29975 | [0m[35m        var node;[0m
[30;1m29976 | [0m[35m        if (typeof path === 'object') {[0m
[30;1m29977 | [0m[35m          node = path;[0m
[30;1m29978 | [0m[35m        } else {[0m
[30;1m29979 | [0m[35m          path = PATH.normalize(path);[0m
[30;1m29980 | [0m[35m          try {[0m

[31m--[ [0m[34mMatch #[0m[33m246[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29957 | [0m[35m        FS.truncate(stream.node, len);[0m
[30;1m29958 | [0m[35m      },utime:function(path, atime, mtime) {[0m
[30;1m29959 | [0m[35m        var lookup = FS.lookupPath(path, { follow: true });[0m
[30;1m29960 | [0m[35m        var node = lookup.node;[0m
[30;1m29961 | [0m[35m        node.node_ops.setattr(node, {[0m
[30;1m29962 | [0m[35m          timestamp: Math.max(atime, mtime)[0m
[30;1m29963 | [0m[35m        });[0m

[31m--[ [0m[34mMatch #[0m[33m247[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29927 | [0m[35m          var lookup = FS.lookupPath(path, { follow: true });[0m
[30;1m29928 | [0m[35m          node = lookup.node;[0m
[30;1m29929 | [0m[35m        } else {[0m
[30;1m29930 | [0m[35m          node = path;[0m
[30;1m29931 | [0m[35m        }[0m
[30;1m29932 | [0m[35m        if (!node.node_ops.setattr) {[0m
[30;1m29933 | [0m[35m          throw new FS.ErrnoError(63);[0m

[31m--[ [0m[34mMatch #[0m[33m248[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29925 | [0m[35m        var node;[0m
[30;1m29926 | [0m[35m        if (typeof path === 'string') {[0m
[30;1m29927 | [0m[35m          var lookup = FS.lookupPath(path, { follow: true });[0m
[30;1m29928 | [0m[35m          node = lookup.node;[0m
[30;1m29929 | [0m[35m        } else {[0m
[30;1m29930 | [0m[35m          node = path;[0m
[30;1m29931 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m249[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29901 | [0m[35m          var lookup = FS.lookupPath(path, { follow: !dontFollow });[0m
[30;1m29902 | [0m[35m          node = lookup.node;[0m
[30;1m29903 | [0m[35m        } else {[0m
[30;1m29904 | [0m[35m          node = path;[0m
[30;1m29905 | [0m[35m        }[0m
[30;1m29906 | [0m[35m        if (!node.node_ops.setattr) {[0m
[30;1m29907 | [0m[35m          throw new FS.ErrnoError(63);[0m

[31m--[ [0m[34mMatch #[0m[33m250[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29899 | [0m[35m        var node;[0m
[30;1m29900 | [0m[35m        if (typeof path === 'string') {[0m
[30;1m29901 | [0m[35m          var lookup = FS.lookupPath(path, { follow: !dontFollow });[0m
[30;1m29902 | [0m[35m          node = lookup.node;[0m
[30;1m29903 | [0m[35m        } else {[0m
[30;1m29904 | [0m[35m          node = path;[0m
[30;1m29905 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m251[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29878 | [0m[35m          var lookup = FS.lookupPath(path, { follow: !dontFollow });[0m
[30;1m29879 | [0m[35m          node = lookup.node;[0m
[30;1m29880 | [0m[35m        } else {[0m
[30;1m29881 | [0m[35m          node = path;[0m
[30;1m29882 | [0m[35m        }[0m
[30;1m29883 | [0m[35m        if (!node.node_ops.setattr) {[0m
[30;1m29884 | [0m[35m          throw new FS.ErrnoError(63);[0m

[31m--[ [0m[34mMatch #[0m[33m252[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29876 | [0m[35m        var node;[0m
[30;1m29877 | [0m[35m        if (typeof path === 'string') {[0m
[30;1m29878 | [0m[35m          var lookup = FS.lookupPath(path, { follow: !dontFollow });[0m
[30;1m29879 | [0m[35m          node = lookup.node;[0m
[30;1m29880 | [0m[35m        } else {[0m
[30;1m29881 | [0m[35m          node = path;[0m
[30;1m29882 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m253[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29862 | [0m[35m        return PATH_FS.resolve(FS.getPath(link.parent), link.node_ops.readlink(link));[0m
[30;1m29863 | [0m[35m      },stat:function(path, dontFollow) {[0m
[30;1m29864 | [0m[35m        var lookup = FS.lookupPath(path, { follow: !dontFollow });[0m
[30;1m29865 | [0m[35m        var node = lookup.node;[0m
[30;1m29866 | [0m[35m        if (!node) {[0m
[30;1m29867 | [0m[35m          throw new FS.ErrnoError(44);[0m
[30;1m29868 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m254[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29822 | [0m[35m        var lookup = FS.lookupPath(path, { parent: true });[0m
[30;1m29823 | [0m[35m        var parent = lookup.node;[0m
[30;1m29824 | [0m[35m        var name = PATH.basename(path);[0m
[30;1m29825 | [0m[35m        var node = FS.lookupNode(parent, name);[0m
[30;1m29826 | [0m[35m        var errCode = FS.mayDelete(parent, name, false);[0m
[30;1m29827 | [0m[35m        if (errCode) {[0m
[30;1m29828 | [0m[35m          // According to POSIX, we should map EISDIR to EPERM, but[0m

[31m--[ [0m[34mMatch #[0m[33m255[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29813 | [0m[35m        }[0m
[30;1m29814 | [0m[35m      },readdir:function(path) {[0m
[30;1m29815 | [0m[35m        var lookup = FS.lookupPath(path, { follow: true });[0m
[30;1m29816 | [0m[35m        var node = lookup.node;[0m
[30;1m29817 | [0m[35m        if (!node.node_ops.readdir) {[0m
[30;1m29818 | [0m[35m          throw new FS.ErrnoError(54);[0m
[30;1m29819 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m256[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29786 | [0m[35m        var lookup = FS.lookupPath(path, { parent: true });[0m
[30;1m29787 | [0m[35m        var parent = lookup.node;[0m
[30;1m29788 | [0m[35m        var name = PATH.basename(path);[0m
[30;1m29789 | [0m[35m        var node = FS.lookupNode(parent, name);[0m
[30;1m29790 | [0m[35m        var errCode = FS.mayDelete(parent, name, true);[0m
[30;1m29791 | [0m[35m        if (errCode) {[0m
[30;1m29792 | [0m[35m          throw new FS.ErrnoError(errCode);[0m

[31m--[ [0m[34mMatch #[0m[33m257[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29601 | [0m[35m[0m
[30;1m29602 | [0m[35m        // destroy the nodes for this mount, and all its child mounts[0m
[30;1m29603 | [0m[35m        var node = lookup.node;[0m
[30;1m29604 | [0m[35m        var mount = node.mounted;[0m
[30;1m29605 | [0m[35m        var mounts = FS.getMounts(mount);[0m
[30;1m29606 | [0m[35m[0m
[30;1m29607 | [0m[35m        Object.keys(FS.nameTable).forEach(function (hash) {[0m

[31m--[ [0m[34mMatch #[0m[33m258[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29600 | [0m[35m        }[0m
[30;1m29601 | [0m[35m[0m
[30;1m29602 | [0m[35m        // destroy the nodes for this mount, and all its child mounts[0m
[30;1m29603 | [0m[35m        var node = lookup.node;[0m
[30;1m29604 | [0m[35m        var mount = node.mounted;[0m
[30;1m29605 | [0m[35m        var mounts = FS.getMounts(mount);[0m
[30;1m29606 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m259[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29567 | [0m[35m          }[0m
[30;1m29568 | [0m[35m        }[0m
[30;1m29569 | [0m[35m[0m
[30;1m29570 | [0m[35m        var mount = {[0m
[30;1m29571 | [0m[35m          type: type,[0m
[30;1m29572 | [0m[35m          opts: opts,[0m
[30;1m29573 | [0m[35m          mountpoint: mountpoint,[0m

[31m--[ [0m[34mMatch #[0m[33m260[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29556 | [0m[35m          var lookup = FS.lookupPath(mountpoint, { follow_mount: false });[0m
[30;1m29557 | [0m[35m[0m
[30;1m29558 | [0m[35m          mountpoint = lookup.path;  // use the absolute path[0m
[30;1m29559 | [0m[35m          node = lookup.node;[0m
[30;1m29560 | [0m[35m[0m
[30;1m29561 | [0m[35m          if (FS.isMountpoint(node)) {[0m
[30;1m29562 | [0m[35m            throw new FS.ErrnoError(10);[0m

[31m--[ [0m[34mMatch #[0m[33m261[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29396 | [0m[35m      },mayDelete:function(dir, name, isdir) {[0m
[30;1m29397 | [0m[35m        var node;[0m
[30;1m29398 | [0m[35m        try {[0m
[30;1m29399 | [0m[35m          node = FS.lookupNode(dir, name);[0m
[30;1m29400 | [0m[35m        } catch (e) {[0m
[30;1m29401 | [0m[35m          return e.errno;[0m
[30;1m29402 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m262[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29388 | [0m[35m        return 0;[0m
[30;1m29389 | [0m[35m      },mayCreate:function(dir, name) {[0m
[30;1m29390 | [0m[35m        try {[0m
[30;1m29391 | [0m[35m          var node = FS.lookupNode(dir, name);[0m
[30;1m29392 | [0m[35m          return 20;[0m
[30;1m29393 | [0m[35m        } catch (e) {[0m
[30;1m29394 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m263[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29339 | [0m[35m      },destroyNode:function(node) {[0m
[30;1m29340 | [0m[35m        FS.hashRemoveNode(node);[0m
[30;1m29341 | [0m[35m      },isRoot:function(node) {[0m
[30;1m29342 | [0m[35m        return node === node.parent;[0m
[30;1m29343 | [0m[35m      },isMountpoint:function(node) {[0m
[30;1m29344 | [0m[35m        return !!node.mounted;[0m
[30;1m29345 | [0m[35m      },isFile:function(mode) {[0m

[31m--[ [0m[34mMatch #[0m[33m264[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29331 | [0m[35m        // if we failed to find it in the cache, call into the VFS[0m
[30;1m29332 | [0m[35m        return FS.lookup(parent, name);[0m
[30;1m29333 | [0m[35m      },createNode:function(parent, name, mode, rdev) {[0m
[30;1m29334 | [0m[35m        var node = new FS.FSNode(parent, name, mode, rdev);[0m
[30;1m29335 | [0m[35m[0m
[30;1m29336 | [0m[35m        FS.hashAddNode(node);[0m
[30;1m29337 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m265[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29322 | [0m[35m          throw new FS.ErrnoError(errCode, parent);[0m
[30;1m29323 | [0m[35m        }[0m
[30;1m29324 | [0m[35m        var hash = FS.hashName(parent.id, name);[0m
[30;1m29325 | [0m[35m        for (var node = FS.nameTable[hash]; node; node = node.name_next) {[0m
[30;1m29326 | [0m[35m          var nodeName = node.name;[0m
[30;1m29327 | [0m[35m          if (node.parent.id === parent.id && nodeName === name) {[0m
[30;1m29328 | [0m[35m            return node;[0m

[31m--[ [0m[34mMatch #[0m[33m266[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29322 | [0m[35m          throw new FS.ErrnoError(errCode, parent);[0m
[30;1m29323 | [0m[35m        }[0m
[30;1m29324 | [0m[35m        var hash = FS.hashName(parent.id, name);[0m
[30;1m29325 | [0m[35m        for (var node = FS.nameTable[hash]; node; node = node.name_next) {[0m
[30;1m29326 | [0m[35m          var nodeName = node.name;[0m
[30;1m29327 | [0m[35m          if (node.parent.id === parent.id && nodeName === name) {[0m
[30;1m29328 | [0m[35m            return node;[0m

[31m--[ [0m[34mMatch #[0m[33m267[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29288 | [0m[35m            return mount[mount.length-1] !== '/' ? mount + '/' + path : mount + path;[0m
[30;1m29289 | [0m[35m          }[0m
[30;1m29290 | [0m[35m          path = path ? node.name + '/' + path : node.name;[0m
[30;1m29291 | [0m[35m          node = node.parent;[0m
[30;1m29292 | [0m[35m        }[0m
[30;1m29293 | [0m[35m      },hashName:function(parentid, name) {[0m
[30;1m29294 | [0m[35m        var hash = 0;[0m

[31m--[ [0m[34mMatch #[0m[33m268[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29285 | [0m[35m          if (FS.isRoot(node)) {[0m
[30;1m29286 | [0m[35m            var mount = node.mount.mountpoint;[0m
[30;1m29287 | [0m[35m            if (!path) return mount;[0m
[30;1m29288 | [0m[35m            return mount[mount.length-1] !== '/' ? mount + '/' + path : mount + path;[0m
[30;1m29289 | [0m[35m          }[0m
[30;1m29290 | [0m[35m          path = path ? node.name + '/' + path : node.name;[0m
[30;1m29291 | [0m[35m          node = node.parent;[0m

[31m--[ [0m[34mMatch #[0m[33m269[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29285 | [0m[35m          if (FS.isRoot(node)) {[0m
[30;1m29286 | [0m[35m            var mount = node.mount.mountpoint;[0m
[30;1m29287 | [0m[35m            if (!path) return mount;[0m
[30;1m29288 | [0m[35m            return mount[mount.length-1] !== '/' ? mount + '/' + path : mount + path;[0m
[30;1m29289 | [0m[35m          }[0m
[30;1m29290 | [0m[35m          path = path ? node.name + '/' + path : node.name;[0m
[30;1m29291 | [0m[35m          node = node.parent;[0m

[31m--[ [0m[34mMatch #[0m[33m270[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29283 | [0m[35m        var path;[0m
[30;1m29284 | [0m[35m        while (true) {[0m
[30;1m29285 | [0m[35m          if (FS.isRoot(node)) {[0m
[30;1m29286 | [0m[35m            var mount = node.mount.mountpoint;[0m
[30;1m29287 | [0m[35m            if (!path) return mount;[0m
[30;1m29288 | [0m[35m            return mount[mount.length-1] !== '/' ? mount + '/' + path : mount + path;[0m
[30;1m29289 | [0m[35m          }[0m

[31m--[ [0m[34mMatch #[0m[33m271[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29122 | [0m[35m          }[0m
[30;1m29123 | [0m[35m[0m
[30;1m29124 | [0m[35m          if (!length) return 0;[0m
[30;1m29125 | [0m[35m          var node = stream.node;[0m
[30;1m29126 | [0m[35m          node.timestamp = Date.now();[0m
[30;1m29127 | [0m[35m[0m
[30;1m29128 | [0m[35m          if (buffer.subarray && (!node.contents || node.contents.subarray)) { // This write is from[0m

[31m--[ [0m[34mMatch #[0m[33m272[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29094 | [0m[35m          }[0m
[30;1m29095 | [0m[35m          return entries;[0m
[30;1m29096 | [0m[35m        },symlink:function(parent, newname, oldpath) {[0m
[30;1m29097 | [0m[35m          var node = MEMFS.createNode(parent, newname, 511 /* 0777 */ | 40960, 0);[0m
[30;1m29098 | [0m[35m          node.link = oldpath;[0m
[30;1m29099 | [0m[35m          return node;[0m
[30;1m29100 | [0m[35m        },readlink:function(node) {[0m

[31m--[ [0m[34mMatch #[0m[33m273[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29079 | [0m[35m        },unlink:function(parent, name) {[0m
[30;1m29080 | [0m[35m          delete parent.contents[name];[0m
[30;1m29081 | [0m[35m        },rmdir:function(parent, name) {[0m
[30;1m29082 | [0m[35m          var node = FS.lookupNode(parent, name);[0m
[30;1m29083 | [0m[35m          for (var i in node.contents) {[0m
[30;1m29084 | [0m[35m            throw new FS.ErrnoError(55);[0m
[30;1m29085 | [0m[35m          }[0m

[31m--[ [0m[34mMatch #[0m[33m274[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m28945 | [0m[35m            }[0m
[30;1m28946 | [0m[35m          };[0m
[30;1m28947 | [0m[35m        }[0m
[30;1m28948 | [0m[35m        var node = FS.createNode(parent, name, mode, dev);[0m
[30;1m28949 | [0m[35m        if (FS.isDir(node.mode)) {[0m
[30;1m28950 | [0m[35m          node.node_ops = MEMFS.ops_table.dir.node;[0m
[30;1m28951 | [0m[35m          node.stream_ops = MEMFS.ops_table.dir.stream;[0m

[31m--[ [0m[34mMatch #[0m[33m275[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m137 | [0m[35m};[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m// Determine the runtime environment we are in. You can customize this by[0m
[30;1m140 | [0m[35m// setting the ENVIRONMENT setting at compile time (see settings.js).[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35mvar ENVIRONMENT_IS_WEB = false;[0m
[30;1m143 | [0m[35mvar ENVIRONMENT_IS_WORKER = false;[0m

[31m--[ [0m[34mMatch #[0m[33m276[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m68 | [0m[35m		return path + fileName;[0m
[30;1m69 | [0m[35m	};[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m	//NOTE will be overwritten if emscripten has env specific implementation for this[0m
[30;1m72 | [0m[35m	var readBinary = function(filePath){[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m		//for Node: use default implementation (copied from generated code):[0m

[31m--[ [0m[34mMatch #[0m[33m277[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m33 | [0m[35m		// like Node.[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m		// use process.env (if available) for reading Flac environment settings:[0m
[30;1m36 | [0m[35m		var env = typeof process !== 'undefined' && process && process.env? process.env : root;[0m
[30;1m37 | [0m[35m		factory(env, module, module.require);[0m
[30;1m38 | [0m[35m	} else {[0m
[30;1m39 | [0m[35m		// Browser globals[0m

[31m--[ [0m[34mMatch #[0m[33m278[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/3rd-party/libflac.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35m// 1. Not defined. We create it here[0m
[30;1m6 | [0m[35m// 2. A function parameter, function(Module) { ..generated code.. }[0m
[30;1m7 | [0m[35m// 3. pre-run appended it, var Module = {}; ..generated code..[0m
[30;1m8 | [0m[35m// 4. External script tag defines var Module.[0m
[30;1m9 | [0m[35m// We need to check if Module already exists (e.g. case 3 above).[0m
[30;1m10 | [0m[35m// Substitution will be replaced with actual code on later stage of the build,[0m
[30;1m11 | [0m[35m// this way Closure Compiler will not mangle it (e.g. case 4. above).[0m

[31m--[ [0m[34mMatch #[0m[33m279[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/dlna/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m460 | [0m[35m            else:[0m
[30;1m461 | [0m[35m                # new player detected, setup our DLNAPlayer wrapper[0m
[30;1m462 | [0m[35m                conf_key = f"{CONF_PLAYERS}/{udn}/enabled"[0m
[30;1m463 | [0m[35m                enabled = self.mass.config.get(conf_key, True)[0m
[30;1m464 | [0m[35m                # ignore disabled players[0m
[30;1m465 | [0m[35m                if not enabled:[0m
[30;1m466 | [0m[35m                    self.logger.debug("Ignoring disabled player: %s", udn)[0m

[31m--[ [0m[34mMatch #[0m[33m280[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/dlna/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m450 | [0m[35m    async def _device_discovered(self, udn: str, description_url: str) -> None:[0m
[30;1m451 | [0m[35m        """Handle discovered DLNA player."""[0m
[30;1m452 | [0m[35m        async with self.lock:[0m
[30;1m453 | [0m[35m            if dlna_player := self.dlnaplayers.get(udn):[0m
[30;1m454 | [0m[35m                # existing player[0m
[30;1m455 | [0m[35m                if dlna_player.description_url == description_url and dlna_player.player.available:[0m
[30;1m456 | [0m[35m                    # nothing to do, device is already connected[0m

[31m--[ [0m[34mMatch #[0m[33m281[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/dlna/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m399 | [0m[35m                    return[0m
[30;1m400 | [0m[35m[0m
[30;1m401 | [0m[35m                ssdp_usn: str = discovery_info["usn"][0m
[30;1m402 | [0m[35m                ssdp_udn: str | None = discovery_info.get("_udn")[0m
[30;1m403 | [0m[35m                if not ssdp_udn and ssdp_usn.startswith("uuid:"):[0m
[30;1m404 | [0m[35m                    ssdp_udn = ssdp_usn.split("::")[0][0m
[30;1m405 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m282[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/dlna/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m390 | [0m[35m[0m
[30;1m391 | [0m[35m            async def on_response(discovery_info: CaseInsensitiveDict) -> None:[0m
[30;1m392 | [0m[35m                """Process discovered device from ssdp search."""[0m
[30;1m393 | [0m[35m                ssdp_st: str = discovery_info.get("st", discovery_info.get("nt"))[0m
[30;1m394 | [0m[35m                if not ssdp_st:[0m
[30;1m395 | [0m[35m                    return[0m
[30;1m396 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m283[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/dlna/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m390 | [0m[35m[0m
[30;1m391 | [0m[35m            async def on_response(discovery_info: CaseInsensitiveDict) -> None:[0m
[30;1m392 | [0m[35m                """Process discovered device from ssdp search."""[0m
[30;1m393 | [0m[35m                ssdp_st: str = discovery_info.get("st", discovery_info.get("nt"))[0m
[30;1m394 | [0m[35m                if not ssdp_st:[0m
[30;1m395 | [0m[35m                    return[0m
[30;1m396 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m284[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/dlna/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m265 | [0m[35m        changed_keys: set[str],[0m
[30;1m266 | [0m[35m    ) -> None:[0m
[30;1m267 | [0m[35m        """Call (by config manager) when the configuration of a player changes."""[0m
[30;1m268 | [0m[35m        if dlna_player := self.dlnaplayers.get(config.player_id):[0m
[30;1m269 | [0m[35m            # reset player features based on config values[0m
[30;1m270 | [0m[35m            self._set_player_features(dlna_player)[0m
[30;1m271 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m285[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/dlna/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m586 | [0m[35m        supported_features: set[PlayerFeature] = {[0m
[30;1m587 | [0m[35m            # there is no way to check if a dlna player support enqueuing[0m
[30;1m588 | [0m[35m            # so we simply assume it does and if it doesn't[0m
[30;1m589 | [0m[35m            # you'll find out at playback time and we log a warning[0m
[30;1m590 | [0m[35m            PlayerFeature.ENQUEUE,[0m
[30;1m591 | [0m[35m            PlayerFeature.GAPLESS_PLAYBACK,[0m
[30;1m592 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m286[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/dlna/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m548 | [0m[35m        if service.service_id == "urn:upnp-org:serviceId:AVTransport":[0m
[30;1m549 | [0m[35m            for state_variable in state_variables:[0m
[30;1m550 | [0m[35m                # Force a state refresh when player begins or pauses playback[0m
[30;1m551 | [0m[35m                # to update the position info.[0m
[30;1m552 | [0m[35m                if state_variable.name == "TransportState" and state_variable.value in ([0m
[30;1m553 | [0m[35m                    TransportState.PLAYING,[0m
[30;1m554 | [0m[35m                    TransportState.PAUSED_PLAYBACK,[0m

[31m--[ [0m[34mMatch #[0m[33m287[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/dlna/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m523 | [0m[35m                self.logger.debug("Error while subscribing during device connect: %r", err)[0m
[30;1m524 | [0m[35m                raise[0m
[30;1m525 | [0m[35m            else:[0m
[30;1m526 | [0m[35m                # connect was successful, update device info[0m
[30;1m527 | [0m[35m                dlna_player.player.device_info = DeviceInfo([0m
[30;1m528 | [0m[35m                    model=dlna_player.device.model_name,[0m
[30;1m529 | [0m[35m                    ip_address=dlna_player.device.device.presentation_url[0m

[31m--[ [0m[34mMatch #[0m[33m288[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/dlna/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m495 | [0m[35m[0m
[30;1m496 | [0m[35m    async def _device_connect(self, dlna_player: DLNAPlayer) -> None:[0m
[30;1m497 | [0m[35m        """Connect DLNA/DMR Device."""[0m
[30;1m498 | [0m[35m        self.logger.debug("Connecting to device at %s", dlna_player.description_url)[0m
[30;1m499 | [0m[35m[0m
[30;1m500 | [0m[35m        async with dlna_player.lock:[0m
[30;1m501 | [0m[35m            if dlna_player.device:[0m

[31m--[ [0m[34mMatch #[0m[33m289[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/dlna/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m455 | [0m[35m                if dlna_player.description_url == description_url and dlna_player.player.available:[0m
[30;1m456 | [0m[35m                    # nothing to do, device is already connected[0m
[30;1m457 | [0m[35m                    return[0m
[30;1m458 | [0m[35m                # update description url to newly discovered one[0m
[30;1m459 | [0m[35m                dlna_player.description_url = description_url[0m
[30;1m460 | [0m[35m            else:[0m
[30;1m461 | [0m[35m                # new player detected, setup our DLNAPlayer wrapper[0m

[31m--[ [0m[34mMatch #[0m[33m290[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/dlna/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m179 | [0m[35m                # TODO: handle other possible sources here[0m
[30;1m180 | [0m[35m                self.player.active_source = None[0m
[30;1m181 | [0m[35m            if self.device.media_position:[0m
[30;1m182 | [0m[35m                # only update elapsed_time if the device actually reports it[0m
[30;1m183 | [0m[35m                self.player.elapsed_time = float(self.device.media_position)[0m
[30;1m184 | [0m[35m                if self.device.media_position_updated_at is not None:[0m
[30;1m185 | [0m[35m                    self.player.elapsed_time_last_updated = ([0m

[31m--[ [0m[34mMatch #[0m[33m291[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/dlna/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m586 | [0m[35m        supported_features: set[PlayerFeature] = {[0m
[30;1m587 | [0m[35m            # there is no way to check if a dlna player support enqueuing[0m
[30;1m588 | [0m[35m            # so we simply assume it does and if it doesn't[0m
[30;1m589 | [0m[35m            # you'll find out at playback time and we log a warning[0m
[30;1m590 | [0m[35m            PlayerFeature.ENQUEUE,[0m
[30;1m591 | [0m[35m            PlayerFeature.GAPLESS_PLAYBACK,[0m
[30;1m592 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m292[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/dlna/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m586 | [0m[35m        supported_features: set[PlayerFeature] = {[0m
[30;1m587 | [0m[35m            # there is no way to check if a dlna player support enqueuing[0m
[30;1m588 | [0m[35m            # so we simply assume it does and if it doesn't[0m
[30;1m589 | [0m[35m            # you'll find out at playback time and we log a warning[0m
[30;1m590 | [0m[35m            PlayerFeature.ENQUEUE,[0m
[30;1m591 | [0m[35m            PlayerFeature.GAPLESS_PLAYBACK,[0m
[30;1m592 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m293[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/dlna/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35mimport asyncio[0m
[30;1m12 | [0m[35mimport functools[0m
[30;1m13 | [0m[35mimport logging[0m
[30;1m14 | [0m[35mimport time[0m
[30;1m15 | [0m[35mfrom contextlib import suppress[0m
[30;1m16 | [0m[35mfrom dataclasses import dataclass, field[0m
[30;1m17 | [0m[35mfrom ipaddress import IPv4Address[0m
[30;1m18 | [0m[35mfrom typing import TYPE_CHECKING, Any, Concatenate, ParamSpec, TypeVar[0m

[31m--[ [0m[34mMatch #[0m[33m294[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m684 | [0m[35m        prev_active_remote_id = airplay_player.raop_stream.active_remote_id[0m
[30;1m685 | [0m[35m        while count < 40:[0m
[30;1m686 | [0m[35m            count += 1[0m
[30;1m687 | [0m[35m            if not (airplay_player := self._players.get(player_id)):[0m
[30;1m688 | [0m[35m                return[0m
[30;1m689 | [0m[35m            if not (raop_stream := airplay_player.raop_stream):[0m
[30;1m690 | [0m[35m                return[0m

[31m--[ [0m[34mMatch #[0m[33m295[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m677 | [0m[35m    async def monitor_prevent_playback(self, player_id: str) -> None:[0m
[30;1m678 | [0m[35m        """Monitor the prevent playback state of an airplay player."""[0m
[30;1m679 | [0m[35m        count = 0[0m
[30;1m680 | [0m[35m        if not (airplay_player := self._players.get(player_id)):[0m
[30;1m681 | [0m[35m            return[0m
[30;1m682 | [0m[35m        if not airplay_player.raop_stream:[0m
[30;1m683 | [0m[35m            return[0m

[31m--[ [0m[34mMatch #[0m[33m296[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m610 | [0m[35m            elif path == "/ctrl-int/1/volumedown":[0m
[30;1m611 | [0m[35m                self.mass.create_task(self.mass.players.cmd_volume_down(player_id))[0m
[30;1m612 | [0m[35m            elif path == "/ctrl-int/1/shuffle_songs":[0m
[30;1m613 | [0m[35m                queue = self.mass.player_queues.get(player_id)[0m
[30;1m614 | [0m[35m                if not queue:[0m
[30;1m615 | [0m[35m                    return[0m
[30;1m616 | [0m[35m                self.mass.player_queues.set_shuffle([0m

[31m--[ [0m[34mMatch #[0m[33m297[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m584 | [0m[35m                return[0m
[30;1m585 | [0m[35m[0m
[30;1m586 | [0m[35m            player_id = airplay_player.player_id[0m
[30;1m587 | [0m[35m            mass_player = self.mass.players.get(player_id)[0m
[30;1m588 | [0m[35m            if not mass_player:[0m
[30;1m589 | [0m[35m                return[0m
[30;1m590 | [0m[35m            ignore_volume_report = ([0m

[31m--[ [0m[34mMatch #[0m[33m298[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m563 | [0m[35m                    continue[0m
[30;1m564 | [0m[35m                x, y = line.split(":", 1)[0m
[30;1m565 | [0m[35m                headers[x.strip()] = y.strip()[0m
[30;1m566 | [0m[35m            active_remote = headers.get("Active-Remote")[0m
[30;1m567 | [0m[35m            _, path, _ = headers_split[0].split(" ")[0m
[30;1m568 | [0m[35m            airplay_player = next([0m
[30;1m569 | [0m[35m                ([0m

[31m--[ [0m[34mMatch #[0m[33m299[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m509 | [0m[35m            display_name += " (Airplay)"[0m
[30;1m510 | [0m[35m[0m
[30;1m511 | [0m[35m        self._players[player_id] = AirPlayPlayer(self, player_id, info, address)[0m
[30;1m512 | [0m[35m        if not (volume := await self.mass.cache.get(player_id, base_key=CACHE_KEY_PREV_VOLUME)):[0m
[30;1m513 | [0m[35m            volume = FALLBACK_VOLUME[0m
[30;1m514 | [0m[35m        mass_player = Player([0m
[30;1m515 | [0m[35m            player_id=player_id,[0m

[31m--[ [0m[34mMatch #[0m[33m300[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m467 | [0m[35m        group_child_ids = {player_id}[0m
[30;1m468 | [0m[35m        group_child_ids.update(mass_player.group_childs)[0m
[30;1m469 | [0m[35m        for child_id in group_child_ids:[0m
[30;1m470 | [0m[35m            if client := self._players.get(child_id):[0m
[30;1m471 | [0m[35m                sync_clients.append(client)[0m
[30;1m472 | [0m[35m        return sync_clients[0m
[30;1m473 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m301[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m460 | [0m[35m[0m
[30;1m461 | [0m[35m    def _get_sync_clients(self, player_id: str) -> list[AirPlayPlayer]:[0m
[30;1m462 | [0m[35m        """Get all sync clients for a player."""[0m
[30;1m463 | [0m[35m        mass_player = self.mass.players.get(player_id, True)[0m
[30;1m464 | [0m[35m        assert mass_player[0m
[30;1m465 | [0m[35m        sync_clients: list[AirPlayPlayer] = [][0m
[30;1m466 | [0m[35m        # we need to return the player itself too[0m

[31m--[ [0m[34mMatch #[0m[33m302[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m451 | [0m[35m        if player_id in group_leader.group_childs:[0m
[30;1m452 | [0m[35m            group_leader.group_childs.remove(player_id)[0m
[30;1m453 | [0m[35m        mass_player.synced_to = None[0m
[30;1m454 | [0m[35m        airplay_player = self._players.get(player_id)[0m
[30;1m455 | [0m[35m        if airplay_player:[0m
[30;1m456 | [0m[35m            await airplay_player.cmd_stop()[0m
[30;1m457 | [0m[35m        # make sure that the player manager gets an update[0m

[31m--[ [0m[34mMatch #[0m[33m303[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m446 | [0m[35m        ap_player = self._players[player_id][0m
[30;1m447 | [0m[35m        if ap_player.raop_stream and ap_player.raop_stream.running:[0m
[30;1m448 | [0m[35m            await ap_player.raop_stream.session.remove_client(ap_player)[0m
[30;1m449 | [0m[35m        group_leader = self.mass.players.get(mass_player.synced_to, raise_unavailable=True)[0m
[30;1m450 | [0m[35m        assert group_leader[0m
[30;1m451 | [0m[35m        if player_id in group_leader.group_childs:[0m
[30;1m452 | [0m[35m            group_leader.group_childs.remove(player_id)[0m

[31m--[ [0m[34mMatch #[0m[33m304[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m440 | [0m[35m[0m
[30;1m441 | [0m[35m            - player_id: player_id of the player to handle the command.[0m
[30;1m442 | [0m[35m        """[0m
[30;1m443 | [0m[35m        mass_player = self.mass.players.get(player_id, raise_unavailable=True)[0m
[30;1m444 | [0m[35m        if not mass_player or not mass_player.synced_to:[0m
[30;1m445 | [0m[35m            return[0m
[30;1m446 | [0m[35m        ap_player = self._players[player_id][0m

[31m--[ [0m[34mMatch #[0m[33m305[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m404 | [0m[35m            # nothing to do: player is already part of the group[0m
[30;1m405 | [0m[35m            return[0m
[30;1m406 | [0m[35m        # ensure the child does not have an existing steam session active[0m
[30;1m407 | [0m[35m        if airplay_player := self._players.get(player_id):[0m
[30;1m408 | [0m[35m            if airplay_player.raop_stream and airplay_player.raop_stream.running:[0m
[30;1m409 | [0m[35m                await airplay_player.raop_stream.session.remove_client(airplay_player)[0m
[30;1m410 | [0m[35m        # always make sure that the parent player is part of the sync group[0m

[31m--[ [0m[34mMatch #[0m[33m306[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m394 | [0m[35m            return[0m
[30;1m395 | [0m[35m        child_player = self.mass.players.get(player_id)[0m
[30;1m396 | [0m[35m        assert child_player  # guard[0m
[30;1m397 | [0m[35m        parent_player = self.mass.players.get(target_player)[0m
[30;1m398 | [0m[35m        assert parent_player  # guard[0m
[30;1m399 | [0m[35m        if parent_player.synced_to:[0m
[30;1m400 | [0m[35m            raise RuntimeError("Player is already synced")[0m

[31m--[ [0m[34mMatch #[0m[33m307[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m392 | [0m[35m        """[0m
[30;1m393 | [0m[35m        if player_id == target_player:[0m
[30;1m394 | [0m[35m            return[0m
[30;1m395 | [0m[35m        child_player = self.mass.players.get(player_id)[0m
[30;1m396 | [0m[35m        assert child_player  # guard[0m
[30;1m397 | [0m[35m        parent_player = self.mass.players.get(target_player)[0m
[30;1m398 | [0m[35m        assert parent_player  # guard[0m

[31m--[ [0m[34mMatch #[0m[33m308[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m372 | [0m[35m        airplay_player = self._players[player_id][0m
[30;1m373 | [0m[35m        if airplay_player.raop_stream and airplay_player.raop_stream.running:[0m
[30;1m374 | [0m[35m            await airplay_player.raop_stream.send_cli_command(f"VOLUME={volume_level}\n")[0m
[30;1m375 | [0m[35m        mass_player = self.mass.players.get(player_id)[0m
[30;1m376 | [0m[35m        if not mass_player:[0m
[30;1m377 | [0m[35m            return[0m
[30;1m378 | [0m[35m        mass_player.volume_level = volume_level[0m

[31m--[ [0m[34mMatch #[0m[33m309[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m334 | [0m[35m        elif media.queue_id and media.queue_item_id:[0m
[30;1m335 | [0m[35m            # regular queue (flow) stream request[0m
[30;1m336 | [0m[35m            input_format = AIRPLAY_FLOW_PCM_FORMAT[0m
[30;1m337 | [0m[35m            queue = self.mass.player_queues.get(media.queue_id)[0m
[30;1m338 | [0m[35m            assert queue[0m
[30;1m339 | [0m[35m            start_queue_item = self.mass.player_queues.get_item(media.queue_id, media.queue_item_id)[0m
[30;1m340 | [0m[35m            assert start_queue_item[0m

[31m--[ [0m[34mMatch #[0m[33m310[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m296 | [0m[35m        if player.synced_to:[0m
[30;1m297 | [0m[35m            # this should not happen, but guard anyways[0m
[30;1m298 | [0m[35m            raise RuntimeError("Player is synced")[0m
[30;1m299 | [0m[35m        if not (airplay_player := self._players.get(player_id)):[0m
[30;1m300 | [0m[35m            # this should not happen, but guard anyways[0m
[30;1m301 | [0m[35m            raise PlayerUnavailableError[0m
[30;1m302 | [0m[35m        # set the active source for the player to the media queue[0m

[31m--[ [0m[34mMatch #[0m[33m311[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m290 | [0m[35m        media: PlayerMedia,[0m
[30;1m291 | [0m[35m    ) -> None:[0m
[30;1m292 | [0m[35m        """Handle PLAY MEDIA on given player."""[0m
[30;1m293 | [0m[35m        if not (player := self.mass.players.get(player_id)):[0m
[30;1m294 | [0m[35m            # this should not happen, but guard anyways[0m
[30;1m295 | [0m[35m            raise PlayerUnavailableError[0m
[30;1m296 | [0m[35m        if player.synced_to:[0m

[31m--[ [0m[34mMatch #[0m[33m312[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m272 | [0m[35m[0m
[30;1m273 | [0m[35m        - player_id: player_id of the player to handle the command.[0m
[30;1m274 | [0m[35m        """[0m
[30;1m275 | [0m[35m        player = self.mass.players.get(player_id)[0m
[30;1m276 | [0m[35m        if not player:[0m
[30;1m277 | [0m[35m            return[0m
[30;1m278 | [0m[35m        if player.group_childs:[0m

[31m--[ [0m[34mMatch #[0m[33m313[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m264 | [0m[35m[0m
[30;1m265 | [0m[35m        - player_id: player_id of the player to handle the command.[0m
[30;1m266 | [0m[35m        """[0m
[30;1m267 | [0m[35m        if airplay_player := self._players.get(player_id):[0m
[30;1m268 | [0m[35m            await airplay_player.cmd_play()[0m
[30;1m269 | [0m[35m[0m
[30;1m270 | [0m[35m    async def cmd_pause(self, player_id: str) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m314[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m256 | [0m[35m[0m
[30;1m257 | [0m[35m        - player_id: player_id of the player to handle the command.[0m
[30;1m258 | [0m[35m        """[0m
[30;1m259 | [0m[35m        if airplay_player := self._players.get(player_id):[0m
[30;1m260 | [0m[35m            await airplay_player.cmd_stop()[0m
[30;1m261 | [0m[35m[0m
[30;1m262 | [0m[35m    async def cmd_play(self, player_id: str) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m315[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m246 | [0m[35m        """Return all (provider/player specific) Config Entries for the given player (if any)."""[0m
[30;1m247 | [0m[35m        base_entries = await super().get_player_config_entries(player_id)[0m
[30;1m248 | [0m[35m[0m
[30;1m249 | [0m[35m        if player := self.mass.players.get(player_id):[0m
[30;1m250 | [0m[35m            if is_broken_raop_model(player.device_info.manufacturer, player.device_info.model):[0m
[30;1m251 | [0m[35m                return (*base_entries, BROKEN_RAOP_WARN, *PLAYER_CONFIG_ENTRIES)[0m
[30;1m252 | [0m[35m        return (*base_entries, *PLAYER_CONFIG_ENTRIES)[0m

[31m--[ [0m[34mMatch #[0m[33m316[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m208 | [0m[35m            return[0m
[30;1m209 | [0m[35m        # handle update for existing device[0m
[30;1m210 | [0m[35m        if airplay_player := self._players.get(player_id):[0m
[30;1m211 | [0m[35m            if mass_player := self.mass.players.get(player_id):[0m
[30;1m212 | [0m[35m                cur_address = get_primary_ip_address(info)[0m
[30;1m213 | [0m[35m                if cur_address and cur_address != airplay_player.address:[0m
[30;1m214 | [0m[35m                    airplay_player.logger.debug([0m

[31m--[ [0m[34mMatch #[0m[33m317[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m207 | [0m[35m                self.mass.players.update(player_id)[0m
[30;1m208 | [0m[35m            return[0m
[30;1m209 | [0m[35m        # handle update for existing device[0m
[30;1m210 | [0m[35m        if airplay_player := self._players.get(player_id):[0m
[30;1m211 | [0m[35m            if mass_player := self.mass.players.get(player_id):[0m
[30;1m212 | [0m[35m                cur_address = get_primary_ip_address(info)[0m
[30;1m213 | [0m[35m                if cur_address and cur_address != airplay_player.address:[0m

[31m--[ [0m[34mMatch #[0m[33m318[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m198 | [0m[35m        player_id = f"ap{raw_id.lower()}"[0m
[30;1m199 | [0m[35m        # handle removed player[0m
[30;1m200 | [0m[35m        if state_change == ServiceStateChange.Removed:[0m
[30;1m201 | [0m[35m            if mass_player := self.mass.players.get(player_id):[0m
[30;1m202 | [0m[35m                if not mass_player.available:[0m
[30;1m203 | [0m[35m                    return[0m
[30;1m204 | [0m[35m                # the player has become unavailable[0m

[31m--[ [0m[34mMatch #[0m[33m319[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m190 | [0m[35m            return[0m
[30;1m191 | [0m[35m        if "@" in name:[0m
[30;1m192 | [0m[35m            raw_id, display_name = name.split(".")[0].split("@", 1)[0m
[30;1m193 | [0m[35m        elif deviceid := info.decoded_properties.get("deviceid"):[0m
[30;1m194 | [0m[35m            raw_id = deviceid.replace(":", "")[0m
[30;1m195 | [0m[35m            display_name = info.name.split(".")[0][0m
[30;1m196 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m320[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m454 | [0m[35m        airplay_player = self._players.get(player_id)[0m
[30;1m455 | [0m[35m        if airplay_player:[0m
[30;1m456 | [0m[35m            await airplay_player.cmd_stop()[0m
[30;1m457 | [0m[35m        # make sure that the player manager gets an update[0m
[30;1m458 | [0m[35m        self.mass.players.update(mass_player.player_id, skip_forward=True)[0m
[30;1m459 | [0m[35m        self.mass.players.update(group_leader.player_id, skip_forward=True)[0m
[30;1m460 | [0m[35m[0m
[30;1m461 | [0m[35m    def _get_sync_clients(self, player_id: str) -> list[AirPlayPlayer]:[0m

[31m--[ [0m[34mMatch #[0m[33m321[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m428 | [0m[35m                task_id=f"resume_{active_queue.queue_id}",[0m
[30;1m429 | [0m[35m            )[0m
[30;1m430 | [0m[35m        else:[0m
[30;1m431 | [0m[35m            # make sure that the player manager gets an update[0m
[30;1m432 | [0m[35m            self.mass.players.update(child_player.player_id, skip_forward=True)[0m
[30;1m433 | [0m[35m            self.mass.players.update(parent_player.player_id, skip_forward=True)[0m
[30;1m434 | [0m[35m[0m
[30;1m435 | [0m[35m    @lock[0m

[31m--[ [0m[34mMatch #[0m[33m322[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m418 | [0m[35m            # playback needs to be restarted to form a new multi client stream session[0m
[30;1m419 | [0m[35m            # TODO: allow late joining to existing stream[0m
[30;1m420 | [0m[35m            await self.mass.player_queues.stop(active_queue.queue_id)[0m
[30;1m421 | [0m[35m            # this could potentially be called by multiple players at the exact same time[0m
[30;1m422 | [0m[35m            # so we debounce the resync a bit here with a timer[0m
[30;1m423 | [0m[35m            self.mass.call_later([0m
[30;1m424 | [0m[35m                0.5,[0m

[31m--[ [0m[34mMatch #[0m[33m323[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m223 | [0m[35m                if not mass_player.available:[0m
[30;1m224 | [0m[35m                    self.logger.debug("Player back online: %s", display_name)[0m
[30;1m225 | [0m[35m                    mass_player.available = True[0m
[30;1m226 | [0m[35m            # always update the latest discovery info[0m
[30;1m227 | [0m[35m            airplay_player.discovery_info = info[0m
[30;1m228 | [0m[35m            self.mass.players.update(player_id)[0m
[30;1m229 | [0m[35m            return[0m

[31m--[ [0m[34mMatch #[0m[33m324[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m206 | [0m[35m                mass_player.available = False[0m
[30;1m207 | [0m[35m                self.mass.players.update(player_id)[0m
[30;1m208 | [0m[35m            return[0m
[30;1m209 | [0m[35m        # handle update for existing device[0m
[30;1m210 | [0m[35m        if airplay_player := self._players.get(player_id):[0m
[30;1m211 | [0m[35m            if mass_player := self.mass.players.get(player_id):[0m
[30;1m212 | [0m[35m                cur_address = get_primary_ip_address(info)[0m

[31m--[ [0m[34mMatch #[0m[33m325[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m# TODO: Airplay provider[0m
[30;1m137 | [0m[35m# - Implement authentication for Apple TV[0m
[30;1m138 | [0m[35m# - Implement volume control for Apple devices using pyatv[0m
[30;1m139 | [0m[35m# - Implement metadata for Apple Apple devices using pyatv[0m
[30;1m140 | [0m[35m# - Use pyatv for communicating with original Apple devices (and use cliraop for actual streaming)[0m
[30;1m141 | [0m[35m# - Implement Airplay 2 support[0m

[31m--[ [0m[34mMatch #[0m[33m326[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m129 | [0m[35m    default_value=None,[0m
[30;1m130 | [0m[35m    required=False,[0m
[30;1m131 | [0m[35m    label="This player is known to have broken Airplay 1 (RAOP) support. "[0m
[30;1m132 | [0m[35m    "Playback may fail or simply be silent. There is no workaround for this issue at the moment.",[0m
[30;1m133 | [0m[35m)[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m327[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m82 | [0m[35m        default_value=True,[0m
[30;1m83 | [0m[35m        label="Enable compression",[0m
[30;1m84 | [0m[35m        description="Save some network bandwidth by sending the audio as "[0m
[30;1m85 | [0m[35m        "(lossless) ALAC at the cost of a bit CPU.",[0m
[30;1m86 | [0m[35m        category="airplay",[0m
[30;1m87 | [0m[35m    ),[0m
[30;1m88 | [0m[35m    CONF_ENTRY_SYNC_ADJUST,[0m

[31m--[ [0m[34mMatch #[0m[33m328[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m418 | [0m[35m            # playback needs to be restarted to form a new multi client stream session[0m
[30;1m419 | [0m[35m            # TODO: allow late joining to existing stream[0m
[30;1m420 | [0m[35m            await self.mass.player_queues.stop(active_queue.queue_id)[0m
[30;1m421 | [0m[35m            # this could potentially be called by multiple players at the exact same time[0m
[30;1m422 | [0m[35m            # so we debounce the resync a bit here with a timer[0m
[30;1m423 | [0m[35m            self.mass.call_later([0m
[30;1m424 | [0m[35m                0.5,[0m
[30;1m425 | [0m[35m                self.mass.player_queues.resume,[0m

[31m--[ [0m[34mMatch #[0m[33m329[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m238 | [0m[35m        # shutdown DACP server[0m
[30;1m239 | [0m[35m        if self._dacp_server:[0m
[30;1m240 | [0m[35m            self._dacp_server.close()[0m
[30;1m241 | [0m[35m        # shutdown DACP zeroconf service[0m
[30;1m242 | [0m[35m        if self._dacp_info:[0m
[30;1m243 | [0m[35m            await self.mass.aiozc.async_unregister_service(self._dacp_info)[0m
[30;1m244 | [0m[35m[0m
[30;1m245 | [0m[35m    async def get_player_config_entries(self, player_id: str) -> tuple[ConfigEntry, ...]:[0m

[31m--[ [0m[34mMatch #[0m[33m330[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m185 | [0m[35m    async def on_mdns_service_state_change([0m
[30;1m186 | [0m[35m        self, name: str, state_change: ServiceStateChange, info: AsyncServiceInfo | None[0m
[30;1m187 | [0m[35m    ) -> None:[0m
[30;1m188 | [0m[35m        """Handle MDNS service state callback."""[0m
[30;1m189 | [0m[35m        if not info:[0m
[30;1m190 | [0m[35m            return[0m
[30;1m191 | [0m[35m        if "@" in name:[0m

[31m--[ [0m[34mMatch #[0m[33m331[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mimport asyncio[0m
[30;1m6 | [0m[35mimport socket[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35mfrom random import randrange[0m
[30;1m9 | [0m[35mfrom typing import cast[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mfrom music_assistant_models.config_entries import ConfigEntry[0m

[31m--[ [0m[34mMatch #[0m[33m332[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m32 | [0m[35m    if manufacturer and model:[0m
[30;1m33 | [0m[35m        return (manufacturer, model)[0m
[30;1m34 | [0m[35m    # try parse from am property[0m
[30;1m35 | [0m[35m    if am_property := info.decoded_properties.get("am"):[0m
[30;1m36 | [0m[35m        model = am_property[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m    if not model:[0m

[31m--[ [0m[34mMatch #[0m[33m333[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35mdef get_model_info(info: AsyncServiceInfo) -> tuple[str, str]:[0m
[30;1m29 | [0m[35m    """Return Manufacturer and Model name from mdns info."""[0m
[30;1m30 | [0m[35m    manufacturer = info.decoded_properties.get("manufacturer")[0m
[30;1m31 | [0m[35m    model = info.decoded_properties.get("model")[0m
[30;1m32 | [0m[35m    if manufacturer and model:[0m
[30;1m33 | [0m[35m        return (manufacturer, model)[0m
[30;1m34 | [0m[35m    # try parse from am property[0m

[31m--[ [0m[34mMatch #[0m[33m334[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35mdef get_model_info(info: AsyncServiceInfo) -> tuple[str, str]:[0m
[30;1m29 | [0m[35m    """Return Manufacturer and Model name from mdns info."""[0m
[30;1m30 | [0m[35m    manufacturer = info.decoded_properties.get("manufacturer")[0m
[30;1m31 | [0m[35m    model = info.decoded_properties.get("model")[0m
[30;1m32 | [0m[35m    if manufacturer and model:[0m
[30;1m33 | [0m[35m        return (manufacturer, model)[0m

[31m--[ [0m[34mMatch #[0m[33m335[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35mdef get_primary_ip_address(discovery_info: AsyncServiceInfo) -> str | None:[0m
[30;1m72 | [0m[35m    """Get primary IP address from zeroconf discovery info."""[0m
[30;1m73 | [0m[35m    for address in discovery_info.parsed_addresses(IPVersion.V4Only):[0m
[30;1m74 | [0m[35m        if address.startswith("127"):[0m
[30;1m75 | [0m[35m            # filter out loopback address[0m

[31m--[ [0m[34mMatch #[0m[33m336[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1853 | [0m[35m                            )[0m
[30;1m1854 | [0m[35m                        ][0m
[30;1m1855 | [0m[35m                    )[0m
[30;1m1856 | [0m[35m        elif picture := (playlist_obj.get("squareImage") or playlist_obj.get("image")):[0m
[30;1m1857 | [0m[35m            picture_id = picture.replace("-", "/")[0m
[30;1m1858 | [0m[35m            image_url = f"{RESOURCES_URL}/{picture_id}/750x750.jpg"[0m
[30;1m1859 | [0m[35m            playlist.metadata.images = UniqueList([0m

[31m--[ [0m[34mMatch #[0m[33m337[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1853 | [0m[35m                            )[0m
[30;1m1854 | [0m[35m                        ][0m
[30;1m1855 | [0m[35m                    )[0m
[30;1m1856 | [0m[35m        elif picture := (playlist_obj.get("squareImage") or playlist_obj.get("image")):[0m
[30;1m1857 | [0m[35m            picture_id = picture.replace("-", "/")[0m
[30;1m1858 | [0m[35m            image_url = f"{RESOURCES_URL}/{picture_id}/750x750.jpg"[0m
[30;1m1859 | [0m[35m            playlist.metadata.images = UniqueList([0m

[31m--[ [0m[34mMatch #[0m[33m338[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1841 | [0m[35m        # Handle images differently based on type[0m
[30;1m1842 | [0m[35m        if is_mix:[0m
[30;1m1843 | [0m[35m            if pictures := playlist_obj.get("images", {}).get("LARGE"):[0m
[30;1m1844 | [0m[35m                image_url = pictures.get("url", "")[0m
[30;1m1845 | [0m[35m                if image_url:[0m
[30;1m1846 | [0m[35m                    playlist.metadata.images = UniqueList([0m
[30;1m1847 | [0m[35m                        [[0m

[31m--[ [0m[34mMatch #[0m[33m339[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1840 | [0m[35m[0m
[30;1m1841 | [0m[35m        # Handle images differently based on type[0m
[30;1m1842 | [0m[35m        if is_mix:[0m
[30;1m1843 | [0m[35m            if pictures := playlist_obj.get("images", {}).get("LARGE"):[0m
[30;1m1844 | [0m[35m                image_url = pictures.get("url", "")[0m
[30;1m1845 | [0m[35m                if image_url:[0m
[30;1m1846 | [0m[35m                    playlist.metadata.images = UniqueList([0m

[31m--[ [0m[34mMatch #[0m[33m340[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1840 | [0m[35m[0m
[30;1m1841 | [0m[35m        # Handle images differently based on type[0m
[30;1m1842 | [0m[35m        if is_mix:[0m
[30;1m1843 | [0m[35m            if pictures := playlist_obj.get("images", {}).get("LARGE"):[0m
[30;1m1844 | [0m[35m                image_url = pictures.get("url", "")[0m
[30;1m1845 | [0m[35m                if image_url:[0m
[30;1m1846 | [0m[35m                    playlist.metadata.images = UniqueList([0m

[31m--[ [0m[34mMatch #[0m[33m341[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1834 | [0m[35m[0m
[30;1m1835 | [0m[35m        # Add the description from the subtitle for mixes[0m
[30;1m1836 | [0m[35m        if is_mix:[0m
[30;1m1837 | [0m[35m            subtitle = playlist_obj.get("subTitle")[0m
[30;1m1838 | [0m[35m            if subtitle:[0m
[30;1m1839 | [0m[35m                playlist.metadata.description = subtitle[0m
[30;1m1840 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m342[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1830 | [0m[35m        else:[0m
[30;1m1831 | [0m[35m            playlist.cache_checksum = str(playlist_obj.get("lastUpdated", ""))[0m
[30;1m1832 | [0m[35m            if "popularity" in playlist_obj:[0m
[30;1m1833 | [0m[35m                playlist.metadata.popularity = playlist_obj.get("popularity", 0)[0m
[30;1m1834 | [0m[35m[0m
[30;1m1835 | [0m[35m        # Add the description from the subtitle for mixes[0m
[30;1m1836 | [0m[35m        if is_mix:[0m

[31m--[ [0m[34mMatch #[0m[33m343[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1828 | [0m[35m        if is_mix:[0m
[30;1m1829 | [0m[35m            playlist.cache_checksum = str(playlist_obj.get("updated", ""))[0m
[30;1m1830 | [0m[35m        else:[0m
[30;1m1831 | [0m[35m            playlist.cache_checksum = str(playlist_obj.get("lastUpdated", ""))[0m
[30;1m1832 | [0m[35m            if "popularity" in playlist_obj:[0m
[30;1m1833 | [0m[35m                playlist.metadata.popularity = playlist_obj.get("popularity", 0)[0m
[30;1m1834 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m344[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1826 | [0m[35m[0m
[30;1m1827 | [0m[35m        # Metadata - different fields based on type[0m
[30;1m1828 | [0m[35m        if is_mix:[0m
[30;1m1829 | [0m[35m            playlist.cache_checksum = str(playlist_obj.get("updated", ""))[0m
[30;1m1830 | [0m[35m        else:[0m
[30;1m1831 | [0m[35m            playlist.cache_checksum = str(playlist_obj.get("lastUpdated", ""))[0m
[30;1m1832 | [0m[35m            if "popularity" in playlist_obj:[0m

[31m--[ [0m[34mMatch #[0m[33m345[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1811 | [0m[35m        playlist = Playlist([0m
[30;1m1812 | [0m[35m            item_id=playlist_id,[0m
[30;1m1813 | [0m[35m            provider=self.instance_id if is_editable else self.lookup_key,[0m
[30;1m1814 | [0m[35m            name=playlist_obj.get("title", "Unknown"),[0m
[30;1m1815 | [0m[35m            owner=owner_name,[0m
[30;1m1816 | [0m[35m            provider_mappings={[0m
[30;1m1817 | [0m[35m                ProviderMapping([0m

[31m--[ [0m[34mMatch #[0m[33m346[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1793 | [0m[35m            creator_id = None[0m
[30;1m1794 | [0m[35m            creator = playlist_obj.get("creator", {})[0m
[30;1m1795 | [0m[35m            if creator:[0m
[30;1m1796 | [0m[35m                creator_id = creator.get("id")[0m
[30;1m1797 | [0m[35m            is_editable = bool(creator_id and str(creator_id) == str(self.auth.user_id))[0m
[30;1m1798 | [0m[35m[0m
[30;1m1799 | [0m[35m            owner_name = "Tidal"[0m

[31m--[ [0m[34mMatch #[0m[33m347[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1791 | [0m[35m            is_editable = False[0m
[30;1m1792 | [0m[35m        else:[0m
[30;1m1793 | [0m[35m            creator_id = None[0m
[30;1m1794 | [0m[35m            creator = playlist_obj.get("creator", {})[0m
[30;1m1795 | [0m[35m            if creator:[0m
[30;1m1796 | [0m[35m                creator_id = creator.get("id")[0m
[30;1m1797 | [0m[35m            is_editable = bool(creator_id and str(creator_id) == str(self.auth.user_id))[0m

[31m--[ [0m[34mMatch #[0m[33m348[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1780 | [0m[35m    def _parse_playlist(self, playlist_obj: dict[str, Any], is_mix: bool = False) -> Playlist:[0m
[30;1m1781 | [0m[35m        """Parse tidal playlist object to generic layout."""[0m
[30;1m1782 | [0m[35m        # Get ID based on playlist type[0m
[30;1m1783 | [0m[35m        raw_id = str(playlist_obj.get("id" if is_mix else "uuid", ""))[0m
[30;1m1784 | [0m[35m[0m
[30;1m1785 | [0m[35m        # Add prefix for mixes to distinguish them[0m
[30;1m1786 | [0m[35m        playlist_id = f"mix_{raw_id}" if is_mix else raw_id[0m

[31m--[ [0m[34mMatch #[0m[33m349[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1741 | [0m[35m                )[0m
[30;1m1742 | [0m[35m            },[0m
[30;1m1743 | [0m[35m            disc_number=track_obj.get("volumeNumber", 0) or 0,[0m
[30;1m1744 | [0m[35m            track_number=track_obj.get("trackNumber", 0) or 0,[0m
[30;1m1745 | [0m[35m        )[0m
[30;1m1746 | [0m[35m        if "isrc" in track_obj:[0m
[30;1m1747 | [0m[35m            track.external_ids.add((ExternalID.ISRC, track_obj["isrc"]))[0m

[31m--[ [0m[34mMatch #[0m[33m350[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1740 | [0m[35m                    available=track_obj["streamReady"],[0m
[30;1m1741 | [0m[35m                )[0m
[30;1m1742 | [0m[35m            },[0m
[30;1m1743 | [0m[35m            disc_number=track_obj.get("volumeNumber", 0) or 0,[0m
[30;1m1744 | [0m[35m            track_number=track_obj.get("trackNumber", 0) or 0,[0m
[30;1m1745 | [0m[35m        )[0m
[30;1m1746 | [0m[35m        if "isrc" in track_obj:[0m

[31m--[ [0m[34mMatch #[0m[33m351[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1726 | [0m[35m            provider=self.lookup_key,[0m
[30;1m1727 | [0m[35m            name=track_obj.get("title", "Unknown"),[0m
[30;1m1728 | [0m[35m            version=version,[0m
[30;1m1729 | [0m[35m            duration=track_obj.get("duration", 0),[0m
[30;1m1730 | [0m[35m            provider_mappings={[0m
[30;1m1731 | [0m[35m                ProviderMapping([0m
[30;1m1732 | [0m[35m                    item_id=str(track_id),[0m

[31m--[ [0m[34mMatch #[0m[33m352[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1724 | [0m[35m        track = Track([0m
[30;1m1725 | [0m[35m            item_id=track_id,[0m
[30;1m1726 | [0m[35m            provider=self.lookup_key,[0m
[30;1m1727 | [0m[35m            name=track_obj.get("title", "Unknown"),[0m
[30;1m1728 | [0m[35m            version=version,[0m
[30;1m1729 | [0m[35m            duration=track_obj.get("duration", 0),[0m
[30;1m1730 | [0m[35m            provider_mappings={[0m

[31m--[ [0m[34mMatch #[0m[33m353[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1719 | [0m[35m        version = track_obj.get("version", "") or ""[0m
[30;1m1720 | [0m[35m        track_id = str(track_obj.get("id", 0))[0m
[30;1m1721 | [0m[35m        media_metadata = track_obj.get("mediaMetadata", {})[0m
[30;1m1722 | [0m[35m        tags = media_metadata.get("tags", [])[0m
[30;1m1723 | [0m[35m        hi_res_lossless = any(tag in tags for tag in ["HIRES_LOSSLESS", "HI_RES_LOSSLESS"])[0m
[30;1m1724 | [0m[35m        track = Track([0m
[30;1m1725 | [0m[35m            item_id=track_id,[0m

[31m--[ [0m[34mMatch #[0m[33m354[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1718 | [0m[35m        """Parse tidal track object to generic layout."""[0m
[30;1m1719 | [0m[35m        version = track_obj.get("version", "") or ""[0m
[30;1m1720 | [0m[35m        track_id = str(track_obj.get("id", 0))[0m
[30;1m1721 | [0m[35m        media_metadata = track_obj.get("mediaMetadata", {})[0m
[30;1m1722 | [0m[35m        tags = media_metadata.get("tags", [])[0m
[30;1m1723 | [0m[35m        hi_res_lossless = any(tag in tags for tag in ["HIRES_LOSSLESS", "HI_RES_LOSSLESS"])[0m
[30;1m1724 | [0m[35m        track = Track([0m

[31m--[ [0m[34mMatch #[0m[33m355[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1717 | [0m[35m    ) -> Track:[0m
[30;1m1718 | [0m[35m        """Parse tidal track object to generic layout."""[0m
[30;1m1719 | [0m[35m        version = track_obj.get("version", "") or ""[0m
[30;1m1720 | [0m[35m        track_id = str(track_obj.get("id", 0))[0m
[30;1m1721 | [0m[35m        media_metadata = track_obj.get("mediaMetadata", {})[0m
[30;1m1722 | [0m[35m        tags = media_metadata.get("tags", [])[0m
[30;1m1723 | [0m[35m        hi_res_lossless = any(tag in tags for tag in ["HIRES_LOSSLESS", "HI_RES_LOSSLESS"])[0m

[31m--[ [0m[34mMatch #[0m[33m356[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1716 | [0m[35m        track_obj: dict[str, Any],[0m
[30;1m1717 | [0m[35m    ) -> Track:[0m
[30;1m1718 | [0m[35m        """Parse tidal track object to generic layout."""[0m
[30;1m1719 | [0m[35m        version = track_obj.get("version", "") or ""[0m
[30;1m1720 | [0m[35m        track_id = str(track_obj.get("id", 0))[0m
[30;1m1721 | [0m[35m        media_metadata = track_obj.get("mediaMetadata", {})[0m
[30;1m1722 | [0m[35m        tags = media_metadata.get("tags", [])[0m

[31m--[ [0m[34mMatch #[0m[33m357[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1694 | [0m[35m        album.metadata.popularity = album_obj.get("popularity", 0)[0m
[30;1m1695 | [0m[35m[0m
[30;1m1696 | [0m[35m        # Safely handle cover image[0m
[30;1m1697 | [0m[35m        cover = album_obj.get("cover")[0m
[30;1m1698 | [0m[35m        if cover:[0m
[30;1m1699 | [0m[35m            picture_id = cover.replace("-", "/")[0m
[30;1m1700 | [0m[35m            image_url = f"{RESOURCES_URL}/{picture_id}/750x750.jpg"[0m

[31m--[ [0m[34mMatch #[0m[33m358[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1691 | [0m[35m[0m
[30;1m1692 | [0m[35m        album.metadata.copyright = album_obj.get("copyright", "")[0m
[30;1m1693 | [0m[35m        album.metadata.explicit = album_obj.get("explicit", False)[0m
[30;1m1694 | [0m[35m        album.metadata.popularity = album_obj.get("popularity", 0)[0m
[30;1m1695 | [0m[35m[0m
[30;1m1696 | [0m[35m        # Safely handle cover image[0m
[30;1m1697 | [0m[35m        cover = album_obj.get("cover")[0m

[31m--[ [0m[34mMatch #[0m[33m359[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1690 | [0m[35m            album.external_ids.add((ExternalID.BARCODE, upc))[0m
[30;1m1691 | [0m[35m[0m
[30;1m1692 | [0m[35m        album.metadata.copyright = album_obj.get("copyright", "")[0m
[30;1m1693 | [0m[35m        album.metadata.explicit = album_obj.get("explicit", False)[0m
[30;1m1694 | [0m[35m        album.metadata.popularity = album_obj.get("popularity", 0)[0m
[30;1m1695 | [0m[35m[0m
[30;1m1696 | [0m[35m        # Safely handle cover image[0m

[31m--[ [0m[34mMatch #[0m[33m360[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1689 | [0m[35m        if upc:[0m
[30;1m1690 | [0m[35m            album.external_ids.add((ExternalID.BARCODE, upc))[0m
[30;1m1691 | [0m[35m[0m
[30;1m1692 | [0m[35m        album.metadata.copyright = album_obj.get("copyright", "")[0m
[30;1m1693 | [0m[35m        album.metadata.explicit = album_obj.get("explicit", False)[0m
[30;1m1694 | [0m[35m        album.metadata.popularity = album_obj.get("popularity", 0)[0m
[30;1m1695 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m361[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1685 | [0m[35m                album.metadata.release_date = datetime.fromisoformat(release_date)[0m
[30;1m1686 | [0m[35m[0m
[30;1m1687 | [0m[35m        # Safely set metadata[0m
[30;1m1688 | [0m[35m        upc = album_obj.get("upc")[0m
[30;1m1689 | [0m[35m        if upc:[0m
[30;1m1690 | [0m[35m            album.external_ids.add((ExternalID.BARCODE, upc))[0m
[30;1m1691 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m362[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1676 | [0m[35m            album.album_type = AlbumType.SINGLE[0m
[30;1m1677 | [0m[35m[0m
[30;1m1678 | [0m[35m        # Safely parse year[0m
[30;1m1679 | [0m[35m        if release_date := album_obj.get("releaseDate", ""):[0m
[30;1m1680 | [0m[35m            try:[0m
[30;1m1681 | [0m[35m                album.year = int(release_date.split("-")[0])[0m
[30;1m1682 | [0m[35m            except (ValueError, IndexError):[0m

[31m--[ [0m[34mMatch #[0m[33m363[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1665 | [0m[35m                self.logger.warning("Error parsing artist in album %s: %s", name, err)[0m
[30;1m1666 | [0m[35m[0m
[30;1m1667 | [0m[35m        # Safely determine album type[0m
[30;1m1668 | [0m[35m        album_type = album_obj.get("type", "ALBUM")[0m
[30;1m1669 | [0m[35m        if album_type == "COMPILATION" or various_artist_album:[0m
[30;1m1670 | [0m[35m            album.album_type = AlbumType.COMPILATION[0m
[30;1m1671 | [0m[35m        elif album_type == "ALBUM":[0m

[31m--[ [0m[34mMatch #[0m[33m364[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1658 | [0m[35m        various_artist_album: bool = False[0m
[30;1m1659 | [0m[35m        for artist_obj in album_obj.get("artists", []):[0m
[30;1m1660 | [0m[35m            try:[0m
[30;1m1661 | [0m[35m                if artist_obj.get("name") == "Various Artists":[0m
[30;1m1662 | [0m[35m                    various_artist_album = True[0m
[30;1m1663 | [0m[35m                album.artists.append(self._parse_artist(artist_obj))[0m
[30;1m1664 | [0m[35m            except (KeyError, TypeError) as err:[0m

[31m--[ [0m[34mMatch #[0m[33m365[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1656 | [0m[35m[0m
[30;1m1657 | [0m[35m        # Safely handle artists array[0m
[30;1m1658 | [0m[35m        various_artist_album: bool = False[0m
[30;1m1659 | [0m[35m        for artist_obj in album_obj.get("artists", []):[0m
[30;1m1660 | [0m[35m            try:[0m
[30;1m1661 | [0m[35m                if artist_obj.get("name") == "Various Artists":[0m
[30;1m1662 | [0m[35m                    various_artist_album = True[0m

[31m--[ [0m[34mMatch #[0m[33m366[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1649 | [0m[35m                        content_type=ContentType.FLAC,[0m
[30;1m1650 | [0m[35m                    ),[0m
[30;1m1651 | [0m[35m                    url=f"https://tidal.com/album/{album_id}",[0m
[30;1m1652 | [0m[35m                    available=album_obj.get("streamReady", True),  # Default to available[0m
[30;1m1653 | [0m[35m                )[0m
[30;1m1654 | [0m[35m            },[0m
[30;1m1655 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m367[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1633 | [0m[35m        """Parse tidal album object to generic layout."""[0m
[30;1m1634 | [0m[35m        name = album_obj.get("title", "Unknown Album")[0m
[30;1m1635 | [0m[35m        version = album_obj.get("version", "") or ""[0m
[30;1m1636 | [0m[35m        album_id = str(album_obj.get("id", ""))[0m
[30;1m1637 | [0m[35m[0m
[30;1m1638 | [0m[35m        album = Album([0m
[30;1m1639 | [0m[35m            item_id=album_id,[0m

[31m--[ [0m[34mMatch #[0m[33m368[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1632 | [0m[35m    def _parse_album(self, album_obj: dict[str, Any]) -> Album:[0m
[30;1m1633 | [0m[35m        """Parse tidal album object to generic layout."""[0m
[30;1m1634 | [0m[35m        name = album_obj.get("title", "Unknown Album")[0m
[30;1m1635 | [0m[35m        version = album_obj.get("version", "") or ""[0m
[30;1m1636 | [0m[35m        album_id = str(album_obj.get("id", ""))[0m
[30;1m1637 | [0m[35m[0m
[30;1m1638 | [0m[35m        album = Album([0m

[31m--[ [0m[34mMatch #[0m[33m369[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1631 | [0m[35m[0m
[30;1m1632 | [0m[35m    def _parse_album(self, album_obj: dict[str, Any]) -> Album:[0m
[30;1m1633 | [0m[35m        """Parse tidal album object to generic layout."""[0m
[30;1m1634 | [0m[35m        name = album_obj.get("title", "Unknown Album")[0m
[30;1m1635 | [0m[35m        version = album_obj.get("version", "") or ""[0m
[30;1m1636 | [0m[35m        album_id = str(album_obj.get("id", ""))[0m
[30;1m1637 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m370[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1411 | [0m[35m        playlist_path = f"users/{user_id}/playlistsAndFavoritePlaylists"[0m
[30;1m1412 | [0m[35m[0m
[30;1m1413 | [0m[35m        async for playlist_item in self._paginate_api(playlist_path, nested_key="playlist"):[0m
[30;1m1414 | [0m[35m            if playlist_item and playlist_item.get("uuid"):[0m
[30;1m1415 | [0m[35m                yield self._parse_playlist(playlist_item)[0m
[30;1m1416 | [0m[35m[0m
[30;1m1417 | [0m[35m    async def library_add(self, item: MediaItemType) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m371[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1405 | [0m[35m        async for mix_item in self._paginate_api([0m
[30;1m1406 | [0m[35m            mix_path, item_key="items", base_url=self.BASE_URL_V2[0m
[30;1m1407 | [0m[35m        ):[0m
[30;1m1408 | [0m[35m            if mix_item and mix_item.get("id"):[0m
[30;1m1409 | [0m[35m                yield self._parse_playlist(mix_item, is_mix=True)[0m
[30;1m1410 | [0m[35m[0m
[30;1m1411 | [0m[35m        playlist_path = f"users/{user_id}/playlistsAndFavoritePlaylists"[0m

[31m--[ [0m[34mMatch #[0m[33m372[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1394 | [0m[35m        path = f"users/{user_id}/favorites/tracks"[0m
[30;1m1395 | [0m[35m[0m
[30;1m1396 | [0m[35m        async for track_item in self._paginate_api(path, nested_key="item"):[0m
[30;1m1397 | [0m[35m            if track_item and track_item.get("id"):[0m
[30;1m1398 | [0m[35m                yield self._parse_track(track_item)[0m
[30;1m1399 | [0m[35m[0m
[30;1m1400 | [0m[35m    async def get_library_playlists(self) -> AsyncGenerator[Playlist, None]:[0m

[31m--[ [0m[34mMatch #[0m[33m373[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1385 | [0m[35m        path = f"users/{user_id}/favorites/albums"[0m
[30;1m1386 | [0m[35m[0m
[30;1m1387 | [0m[35m        async for album_item in self._paginate_api(path, nested_key="item"):[0m
[30;1m1388 | [0m[35m            if album_item and album_item.get("id"):[0m
[30;1m1389 | [0m[35m                yield self._parse_album(album_item)[0m
[30;1m1390 | [0m[35m[0m
[30;1m1391 | [0m[35m    async def get_library_tracks(self) -> AsyncGenerator[Track, None]:[0m

[31m--[ [0m[34mMatch #[0m[33m374[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1376 | [0m[35m        path = f"users/{user_id}/favorites/artists"[0m
[30;1m1377 | [0m[35m[0m
[30;1m1378 | [0m[35m        async for artist_item in self._paginate_api(path, nested_key="item"):[0m
[30;1m1379 | [0m[35m            if artist_item and artist_item.get("id"):[0m
[30;1m1380 | [0m[35m                yield self._parse_artist(artist_item)[0m
[30;1m1381 | [0m[35m[0m
[30;1m1382 | [0m[35m    async def get_library_albums(self) -> AsyncGenerator[Album, None]:[0m

[31m--[ [0m[34mMatch #[0m[33m375[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1316 | [0m[35m            self.logger.debug([0m
[30;1m1317 | [0m[35m                "Using cached page content for '%s' (age: %.1f minutes)",[0m
[30;1m1318 | [0m[35m                page_path,[0m
[30;1m1319 | [0m[35m                cached_parser.content_stats.get("cache_age_minutes", 0),[0m
[30;1m1320 | [0m[35m            )[0m
[30;1m1321 | [0m[35m            return cached_parser[0m
[30;1m1322 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m376[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1279 | [0m[35m        )[0m
[30;1m1280 | [0m[35m        tracks_data = self._extract_data(api_result)[0m
[30;1m1281 | [0m[35m[0m
[30;1m1282 | [0m[35m        if not tracks_data and not tracks_data.get("data"):[0m
[30;1m1283 | [0m[35m            return None[0m
[30;1m1284 | [0m[35m[0m
[30;1m1285 | [0m[35m        track_data = tracks_data["data"][0][0m

[31m--[ [0m[34mMatch #[0m[33m377[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1233 | [0m[35m        """Get track by ISRC from library item, with caching."""[0m
[30;1m1234 | [0m[35m        # Try to get from cache first[0m
[30;1m1235 | [0m[35m        cache_key = f"isrc_map_{item_id}"[0m
[30;1m1236 | [0m[35m        cached_track_id = await self.mass.cache.get([0m
[30;1m1237 | [0m[35m            cache_key, category=CACHE_CATEGORY_DEFAULT, base_key=self.lookup_key[0m
[30;1m1238 | [0m[35m        )[0m
[30;1m1239 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m378[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1208 | [0m[35m        audio_quality: str | None = stream_data.get("audioQuality")[0m
[30;1m1209 | [0m[35m        if audio_quality in ("HIRES_LOSSLESS", "HI_RES_LOSSLESS", "LOSSLESS"):[0m
[30;1m1210 | [0m[35m            content_type = ContentType.FLAC[0m
[30;1m1211 | [0m[35m        elif codec := stream_data.get("codec"):[0m
[30;1m1212 | [0m[35m            content_type = ContentType.try_parse(codec)[0m
[30;1m1213 | [0m[35m        else:[0m
[30;1m1214 | [0m[35m            content_type = ContentType.MP4[0m

[31m--[ [0m[34mMatch #[0m[33m379[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1205 | [0m[35m        # Determine audio format info[0m
[30;1m1206 | [0m[35m        bit_depth = stream_data.get("bitDepth", 16)[0m
[30;1m1207 | [0m[35m        sample_rate = stream_data.get("sampleRate", 44100)[0m
[30;1m1208 | [0m[35m        audio_quality: str | None = stream_data.get("audioQuality")[0m
[30;1m1209 | [0m[35m        if audio_quality in ("HIRES_LOSSLESS", "HI_RES_LOSSLESS", "LOSSLESS"):[0m
[30;1m1210 | [0m[35m            content_type = ContentType.FLAC[0m
[30;1m1211 | [0m[35m        elif codec := stream_data.get("codec"):[0m

[31m--[ [0m[34mMatch #[0m[33m380[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1204 | [0m[35m[0m
[30;1m1205 | [0m[35m        # Determine audio format info[0m
[30;1m1206 | [0m[35m        bit_depth = stream_data.get("bitDepth", 16)[0m
[30;1m1207 | [0m[35m        sample_rate = stream_data.get("sampleRate", 44100)[0m
[30;1m1208 | [0m[35m        audio_quality: str | None = stream_data.get("audioQuality")[0m
[30;1m1209 | [0m[35m        if audio_quality in ("HIRES_LOSSLESS", "HI_RES_LOSSLESS", "LOSSLESS"):[0m
[30;1m1210 | [0m[35m            content_type = ContentType.FLAC[0m

[31m--[ [0m[34mMatch #[0m[33m381[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1203 | [0m[35m            url = urls[0][0m
[30;1m1204 | [0m[35m[0m
[30;1m1205 | [0m[35m        # Determine audio format info[0m
[30;1m1206 | [0m[35m        bit_depth = stream_data.get("bitDepth", 16)[0m
[30;1m1207 | [0m[35m        sample_rate = stream_data.get("sampleRate", 44100)[0m
[30;1m1208 | [0m[35m        audio_quality: str | None = stream_data.get("audioQuality")[0m
[30;1m1209 | [0m[35m        if audio_quality in ("HIRES_LOSSLESS", "HI_RES_LOSSLESS", "LOSSLESS"):[0m

[31m--[ [0m[34mMatch #[0m[33m382[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1197 | [0m[35m            url = f"data:application/dash+xml;base64,{stream_data['manifest']}"[0m
[30;1m1198 | [0m[35m        else:[0m
[30;1m1199 | [0m[35m            # For non-MPD streams, use the direct URL[0m
[30;1m1200 | [0m[35m            urls = stream_data.get("urls", [])[0m
[30;1m1201 | [0m[35m            if not urls:[0m
[30;1m1202 | [0m[35m                raise MediaNotFoundError(f"No stream URL for track {item_id}")[0m
[30;1m1203 | [0m[35m            url = urls[0][0m

[31m--[ [0m[34mMatch #[0m[33m383[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1190 | [0m[35m        stream_data = self._extract_data(api_result)[0m
[30;1m1191 | [0m[35m[0m
[30;1m1192 | [0m[35m        # Extract streaming information[0m
[30;1m1193 | [0m[35m        manifest_type = stream_data.get("manifestMimeType", "")[0m
[30;1m1194 | [0m[35m        is_mpd = "dash+xml" in manifest_type[0m
[30;1m1195 | [0m[35m[0m
[30;1m1196 | [0m[35m        if is_mpd and "manifest" in stream_data:[0m

[31m--[ [0m[34mMatch #[0m[33m384[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1088 | [0m[35m                except (KeyError, ValueError, TypeError, AttributeError) as err:[0m
[30;1m1089 | [0m[35m                    self.logger.warning([0m
[30;1m1090 | [0m[35m                        "Error processing module %s: %s",[0m
[30;1m1091 | [0m[35m                        module_info.get("title", "Unknown"),[0m
[30;1m1092 | [0m[35m                        err,[0m
[30;1m1093 | [0m[35m                    )[0m
[30;1m1094 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m385[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1048 | [0m[35m                        continue[0m
[30;1m1049 | [0m[35m[0m
[30;1m1050 | [0m[35m                    # Check if it's a "because you listened to" module[0m
[30;1m1051 | [0m[35m                    pre_title = module_info.get("raw_data", {}).get("preTitle")[0m
[30;1m1052 | [0m[35m                    is_because_module = pre_title and "because you listened to" in pre_title.lower()[0m
[30;1m1053 | [0m[35m[0m
[30;1m1054 | [0m[35m                    # Get module items[0m

[31m--[ [0m[34mMatch #[0m[33m386[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1048 | [0m[35m                        continue[0m
[30;1m1049 | [0m[35m[0m
[30;1m1050 | [0m[35m                    # Check if it's a "because you listened to" module[0m
[30;1m1051 | [0m[35m                    pre_title = module_info.get("raw_data", {}).get("preTitle")[0m
[30;1m1052 | [0m[35m                    is_because_module = pre_title and "because you listened to" in pre_title.lower()[0m
[30;1m1053 | [0m[35m[0m
[30;1m1054 | [0m[35m                    # Get module items[0m

[31m--[ [0m[34mMatch #[0m[33m387[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1041 | [0m[35m            # Process all modules in a single pass[0m
[30;1m1042 | [0m[35m            for module_info in home_parser._module_map:[0m
[30;1m1043 | [0m[35m                try:[0m
[30;1m1044 | [0m[35m                    module_title = module_info.get("title", "Unknown")[0m
[30;1m1045 | [0m[35m[0m
[30;1m1046 | [0m[35m                    # Skip modules without proper titles[0m
[30;1m1047 | [0m[35m                    if not module_title or module_title == "Unknown":[0m

[31m--[ [0m[34mMatch #[0m[33m388[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1008 | [0m[35m        """Get this provider's recommendations organized into folders."""[0m
[30;1m1009 | [0m[35m        # Check cache first[0m
[30;1m1010 | [0m[35m        cache_key = f"tidal_recommendations_{self.lookup_key}"[0m
[30;1m1011 | [0m[35m        cached_recommendations: list[RecommendationFolder] = await self.mass.cache.get([0m
[30;1m1012 | [0m[35m            cache_key, category=CACHE_CATEGORY_RECOMMENDATIONS, base_key=self.lookup_key[0m
[30;1m1013 | [0m[35m        )[0m
[30;1m1014 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m389[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m984 | [0m[35m            if not module or "pagedList" not in module:[0m
[30;1m985 | [0m[35m                raise MediaNotFoundError(f"Invalid mix module for {prov_playlist_id}")[0m
[30;1m986 | [0m[35m[0m
[30;1m987 | [0m[35m            all_tracks = module["pagedList"].get("items", [])[0m
[30;1m988 | [0m[35m[0m
[30;1m989 | [0m[35m            # Manually paginate the results[0m
[30;1m990 | [0m[35m            start_idx = min(offset, len(all_tracks))[0m

[31m--[ [0m[34mMatch #[0m[33m390[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m965 | [0m[35m        )[0m
[30;1m966 | [0m[35m        tidal_tracks = self._extract_data(api_result)[0m
[30;1m967 | [0m[35m[0m
[30;1m968 | [0m[35m        return self._process_track_results(tidal_tracks.get("items", []), offset)[0m
[30;1m969 | [0m[35m[0m
[30;1m970 | [0m[35m    async def _get_mix_playlist_tracks([0m
[30;1m971 | [0m[35m        self, prov_playlist_id: str, page_size: int, offset: int[0m

[31m--[ [0m[34mMatch #[0m[33m391[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m917 | [0m[35m            )[0m
[30;1m918 | [0m[35m            artist_top_tracks = self._extract_data(api_result)[0m
[30;1m919 | [0m[35m            return [[0m
[30;1m920 | [0m[35m                self._parse_track(track_obj) for track_obj in artist_top_tracks.get("items", [])[0m
[30;1m921 | [0m[35m            ][0m
[30;1m922 | [0m[35m        except ResourceTemporarilyUnavailable:[0m
[30;1m923 | [0m[35m            raise[0m

[31m--[ [0m[34mMatch #[0m[33m392[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m903 | [0m[35m        try:[0m
[30;1m904 | [0m[35m            api_result = await self._get_data(f"artists/{prov_artist_id}/albums")[0m
[30;1m905 | [0m[35m            artist_albums = self._extract_data(api_result)[0m
[30;1m906 | [0m[35m            return [self._parse_album(album_obj) for album_obj in artist_albums.get("items", [])][0m
[30;1m907 | [0m[35m        except ResourceTemporarilyUnavailable:[0m
[30;1m908 | [0m[35m            raise[0m
[30;1m909 | [0m[35m        except (ClientError, KeyError, ValueError) as err:[0m

[31m--[ [0m[34mMatch #[0m[33m393[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m892 | [0m[35m        try:[0m
[30;1m893 | [0m[35m            api_result = await self._get_data(f"albums/{prov_album_id}/tracks")[0m
[30;1m894 | [0m[35m            album_tracks = self._extract_data(api_result)[0m
[30;1m895 | [0m[35m            return [self._parse_track(track_obj) for track_obj in album_tracks.get("items", [])][0m
[30;1m896 | [0m[35m        except ResourceTemporarilyUnavailable:[0m
[30;1m897 | [0m[35m            raise[0m
[30;1m898 | [0m[35m        except (ClientError, KeyError, ValueError) as err:[0m

[31m--[ [0m[34mMatch #[0m[33m394[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m875 | [0m[35m                                    mix_obj["subTitle"] = subtitle[0m
[30;1m876 | [0m[35m[0m
[30;1m877 | [0m[35m            # Safely check if we have useful images[0m
[30;1m878 | [0m[35m            images = mix_obj.get("images", {})[0m
[30;1m879 | [0m[35m            if images and any(key in images for key in ["MEDIUM", "LARGE", "SMALL"]):[0m
[30;1m880 | [0m[35m                self.logger.debug("Found images for mix %s: %s", prov_mix_id, list(images.keys()))[0m
[30;1m881 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m395[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m870 | [0m[35m                                    )[0m
[30;1m871 | [0m[35m[0m
[30;1m872 | [0m[35m                                # Get subtitle if it exists[0m
[30;1m873 | [0m[35m                                subtitle = mix_data.get("subTitle")[0m
[30;1m874 | [0m[35m                                if subtitle:[0m
[30;1m875 | [0m[35m                                    mix_obj["subTitle"] = subtitle[0m
[30;1m876 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m396[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m860 | [0m[35m                    if modules and isinstance(modules, list) and len(modules) > 0:[0m
[30;1m861 | [0m[35m                        header_module = modules[0][0m
[30;1m862 | [0m[35m                        if isinstance(header_module, dict):[0m
[30;1m863 | [0m[35m                            mix_data = header_module.get("mix", {})[0m
[30;1m864 | [0m[35m                            if isinstance(mix_data, dict):[0m
[30;1m865 | [0m[35m                                # Get images if they exist[0m
[30;1m866 | [0m[35m                                if "images" in mix_data and isinstance(mix_data["images"], dict):[0m

[31m--[ [0m[34mMatch #[0m[33m397[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m856 | [0m[35m            if rows and isinstance(rows, list) and len(rows) > 0:[0m
[30;1m857 | [0m[35m                first_row = rows[0][0m
[30;1m858 | [0m[35m                if isinstance(first_row, dict):[0m
[30;1m859 | [0m[35m                    modules = first_row.get("modules", [])[0m
[30;1m860 | [0m[35m                    if modules and isinstance(modules, list) and len(modules) > 0:[0m
[30;1m861 | [0m[35m                        header_module = modules[0][0m
[30;1m862 | [0m[35m                        if isinstance(header_module, dict):[0m

[31m--[ [0m[34mMatch #[0m[33m398[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m852 | [0m[35m            }[0m
[30;1m853 | [0m[35m[0m
[30;1m854 | [0m[35m            # Safely extract the mix object and its images from the header module[0m
[30;1m855 | [0m[35m            rows = tidal_mix.get("rows", [])[0m
[30;1m856 | [0m[35m            if rows and isinstance(rows, list) and len(rows) > 0:[0m
[30;1m857 | [0m[35m                first_row = rows[0][0m
[30;1m858 | [0m[35m                if isinstance(first_row, dict):[0m

[31m--[ [0m[34mMatch #[0m[33m399[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m847 | [0m[35m            mix_obj = {[0m
[30;1m848 | [0m[35m                "id": prov_mix_id,[0m
[30;1m849 | [0m[35m                "title": tidal_mix.get("title", "Unknown Mix"),[0m
[30;1m850 | [0m[35m                "updated": tidal_mix.get("lastUpdated", ""),[0m
[30;1m851 | [0m[35m                "images": {},  # Initialize empty images dict[0m
[30;1m852 | [0m[35m            }[0m
[30;1m853 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m400[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m846 | [0m[35m            # Create basic mix object with required fields[0m
[30;1m847 | [0m[35m            mix_obj = {[0m
[30;1m848 | [0m[35m                "id": prov_mix_id,[0m
[30;1m849 | [0m[35m                "title": tidal_mix.get("title", "Unknown Mix"),[0m
[30;1m850 | [0m[35m                "updated": tidal_mix.get("lastUpdated", ""),[0m
[30;1m851 | [0m[35m                "images": {},  # Initialize empty images dict[0m
[30;1m852 | [0m[35m            }[0m

[31m--[ [0m[34mMatch #[0m[33m401[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m745 | [0m[35m                f"tracks/{prov_track_id}/radio", params={"limit": limit}[0m
[30;1m746 | [0m[35m            )[0m
[30;1m747 | [0m[35m            similar_tracks = self._extract_data(api_result)[0m
[30;1m748 | [0m[35m            return [self._parse_track(track_obj) for track_obj in similar_tracks.get("items", [])][0m
[30;1m749 | [0m[35m        except ResourceTemporarilyUnavailable:[0m
[30;1m750 | [0m[35m            raise[0m
[30;1m751 | [0m[35m        except (ClientError, KeyError, ValueError) as err:[0m

[31m--[ [0m[34mMatch #[0m[33m402[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m615 | [0m[35m            response = self._extract_data(api_result)[0m
[30;1m616 | [0m[35m[0m
[30;1m617 | [0m[35m            # Extract items from response[0m
[30;1m618 | [0m[35m            items = response.get(item_key, [])[0m
[30;1m619 | [0m[35m            if not items:[0m
[30;1m620 | [0m[35m                break[0m
[30;1m621 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m403[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m585 | [0m[35m[0m
[30;1m586 | [0m[35m            # Return with etag if requested[0m
[30;1m587 | [0m[35m            if return_etag:[0m
[30;1m588 | [0m[35m                etag = response.headers.get("ETag", "")[0m
[30;1m589 | [0m[35m                return data, etag[0m
[30;1m590 | [0m[35m            return data[0m
[30;1m591 | [0m[35m        except json.JSONDecodeError as err:[0m

[31m--[ [0m[34mMatch #[0m[33m404[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m553 | [0m[35m            raise MediaNotFoundError(f"Item not found: {response.url}")[0m
[30;1m554 | [0m[35m[0m
[30;1m555 | [0m[35m        if response.status == 429:[0m
[30;1m556 | [0m[35m            retry_after = int(response.headers.get("Retry-After", 30))[0m
[30;1m557 | [0m[35m            raise ResourceTemporarilyUnavailable([0m
[30;1m558 | [0m[35m                "Tidal Rate limit reached", backoff_time=retry_after[0m
[30;1m559 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m405[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m512 | [0m[35m[0m
[30;1m513 | [0m[35m        if as_form:[0m
[30;1m514 | [0m[35m            # Set content type for form data[0m
[30;1m515 | [0m[35m            headers = kwargs.get("headers", {})[0m
[30;1m516 | [0m[35m            headers["Content-Type"] = "application/x-www-form-urlencoded"[0m
[30;1m517 | [0m[35m            kwargs["headers"] = headers[0m
[30;1m518 | [0m[35m            # Use data parameter for form-encoded data[0m

[31m--[ [0m[34mMatch #[0m[33m406[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m489 | [0m[35m                    await self._handle_response(response, return_etag=False),[0m
[30;1m490 | [0m[35m                )[0m
[30;1m491 | [0m[35m        # Use json parameter for JSON data (default)[0m
[30;1m492 | [0m[35m        async with self.mass.http_session.post(url, json=data, **kwargs) as response:[0m
[30;1m493 | [0m[35m            return cast([0m
[30;1m494 | [0m[35m                "dict[str, Any]",[0m
[30;1m495 | [0m[35m                await self._handle_response(response, return_etag=False),[0m

[31m--[ [0m[34mMatch #[0m[33m407[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m483 | [0m[35m            headers["Content-Type"] = "application/x-www-form-urlencoded"[0m
[30;1m484 | [0m[35m            kwargs["headers"] = headers[0m
[30;1m485 | [0m[35m            # Use data parameter for form-encoded data[0m
[30;1m486 | [0m[35m            async with self.mass.http_session.post(url, data=data, **kwargs) as response:[0m
[30;1m487 | [0m[35m                return cast([0m
[30;1m488 | [0m[35m                    "dict[str, Any]",[0m
[30;1m489 | [0m[35m                    await self._handle_response(response, return_etag=False),[0m

[31m--[ [0m[34mMatch #[0m[33m408[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m479 | [0m[35m[0m
[30;1m480 | [0m[35m        if as_form:[0m
[30;1m481 | [0m[35m            # Set content type for form data[0m
[30;1m482 | [0m[35m            headers = kwargs.get("headers", {})[0m
[30;1m483 | [0m[35m            headers["Content-Type"] = "application/x-www-form-urlencoded"[0m
[30;1m484 | [0m[35m            kwargs["headers"] = headers[0m
[30;1m485 | [0m[35m            # Use data parameter for form-encoded data[0m

[31m--[ [0m[34mMatch #[0m[33m409[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m462 | [0m[35m[0m
[30;1m463 | [0m[35m        self.logger.debug("Making request to Tidal API: %s", endpoint)[0m
[30;1m464 | [0m[35m[0m
[30;1m465 | [0m[35m        async with self.mass.http_session.get(url, **kwargs) as response:[0m
[30;1m466 | [0m[35m            return await self._handle_response(response, return_etag)[0m
[30;1m467 | [0m[35m[0m
[30;1m468 | [0m[35m    @prepare_api_request[0m

[31m--[ [0m[34mMatch #[0m[33m410[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m380 | [0m[35m        api_result = await self._get_data("sessions")[0m
[30;1m381 | [0m[35m        user_info = self._extract_data(api_result)[0m
[30;1m382 | [0m[35m        logged_in_user = await self.get_user(str(user_info.get("userId")))[0m
[30;1m383 | [0m[35m        await self.auth.update_user_info(logged_in_user, str(user_info.get("sessionId")))[0m
[30;1m384 | [0m[35m[0m
[30;1m385 | [0m[35m    @property[0m
[30;1m386 | [0m[35m    def supported_features(self) -> set[ProviderFeature]:[0m

[31m--[ [0m[34mMatch #[0m[33m411[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m379 | [0m[35m        # Get user information from sessions API[0m
[30;1m380 | [0m[35m        api_result = await self._get_data("sessions")[0m
[30;1m381 | [0m[35m        user_info = self._extract_data(api_result)[0m
[30;1m382 | [0m[35m        logged_in_user = await self.get_user(str(user_info.get("userId")))[0m
[30;1m383 | [0m[35m        await self.auth.update_user_info(logged_in_user, str(user_info.get("sessionId")))[0m
[30;1m384 | [0m[35m[0m
[30;1m385 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m412[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m301 | [0m[35m            label="Your Tidal User ID",[0m
[30;1m302 | [0m[35m            description="This is your unique Tidal user ID.",[0m
[30;1m303 | [0m[35m            hidden=True,[0m
[30;1m304 | [0m[35m            value=cast("str", values.get(CONF_USER_ID)) if values else None,[0m
[30;1m305 | [0m[35m        ),[0m
[30;1m306 | [0m[35m    )[0m
[30;1m307 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m413[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m293 | [0m[35m            type=ConfigEntryType.STRING,[0m
[30;1m294 | [0m[35m            label="Expiry time of auth token for Tidal",[0m
[30;1m295 | [0m[35m            hidden=True,[0m
[30;1m296 | [0m[35m            value=cast("str", values.get(CONF_EXPIRY_TIME)) if values else None,[0m
[30;1m297 | [0m[35m        ),[0m
[30;1m298 | [0m[35m        ConfigEntry([0m
[30;1m299 | [0m[35m            key=CONF_USER_ID,[0m

[31m--[ [0m[34mMatch #[0m[33m414[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m286 | [0m[35m            label="Refresh token for Tidal",[0m
[30;1m287 | [0m[35m            description="You need to link Music Assistant to your Tidal account.",[0m
[30;1m288 | [0m[35m            hidden=True,[0m
[30;1m289 | [0m[35m            value=cast("str", values.get(CONF_REFRESH_TOKEN)) if values else None,[0m
[30;1m290 | [0m[35m        ),[0m
[30;1m291 | [0m[35m        ConfigEntry([0m
[30;1m292 | [0m[35m            key=CONF_EXPIRY_TIME,[0m

[31m--[ [0m[34mMatch #[0m[33m415[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m278 | [0m[35m            label="Authentication token for Tidal",[0m
[30;1m279 | [0m[35m            description="You need to link Music Assistant to your Tidal account.",[0m
[30;1m280 | [0m[35m            hidden=True,[0m
[30;1m281 | [0m[35m            value=cast("str", values.get(CONF_AUTH_TOKEN)) if values else None,[0m
[30;1m282 | [0m[35m        ),[0m
[30;1m283 | [0m[35m        ConfigEntry([0m
[30;1m284 | [0m[35m            key=CONF_REFRESH_TOKEN,[0m

[31m--[ [0m[34mMatch #[0m[33m416[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m245 | [0m[35m                " Tidal.com and being redirected to a page that prominently displays"[0m
[30;1m246 | [0m[35m                " 'Oops' at the top.",[0m
[30;1m247 | [0m[35m                depends_on=CONF_ACTION_START_PKCE_LOGIN,[0m
[30;1m248 | [0m[35m                value=cast("str", values.get(CONF_OOPS_URL)) if values else None,[0m
[30;1m249 | [0m[35m                hidden=action != CONF_ACTION_START_PKCE_LOGIN,[0m
[30;1m250 | [0m[35m            ),[0m
[30;1m251 | [0m[35m            ConfigEntry([0m

[31m--[ [0m[34mMatch #[0m[33m417[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m228 | [0m[35m                label="Temporary session for Tidal",[0m
[30;1m229 | [0m[35m                hidden=True,[0m
[30;1m230 | [0m[35m                required=False,[0m
[30;1m231 | [0m[35m                value=cast("str", values.get(CONF_TEMP_SESSION)) if values else None,[0m
[30;1m232 | [0m[35m            ),[0m
[30;1m233 | [0m[35m            ConfigEntry([0m
[30;1m234 | [0m[35m                key=LABEL_OOPS_URL,[0m

[31m--[ [0m[34mMatch #[0m[33m418[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m219 | [0m[35m                action=CONF_ACTION_START_PKCE_LOGIN,[0m
[30;1m220 | [0m[35m                depends_on=CONF_QUALITY,[0m
[30;1m221 | [0m[35m                action_label="Starts the auth process via PKCE on Tidal.com",[0m
[30;1m222 | [0m[35m                value=cast("str", values.get(CONF_TEMP_SESSION)) if values else None,[0m
[30;1m223 | [0m[35m                hidden=action == CONF_ACTION_START_PKCE_LOGIN,[0m
[30;1m224 | [0m[35m            ),[0m
[30;1m225 | [0m[35m            ConfigEntry([0m

[31m--[ [0m[34mMatch #[0m[33m419[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m198 | [0m[35m                description="HIGH_LOSSLESS = 16bit 44.1kHz, HI_RES = Up to 24bit 192kHz",[0m
[30;1m199 | [0m[35m                options=[ConfigValueOption(x.value, x.name) for x in TidalQualityEnum],[0m
[30;1m200 | [0m[35m                default_value=TidalQualityEnum.HI_RES.value,[0m
[30;1m201 | [0m[35m                value=cast("str", values.get(CONF_QUALITY)) if values else None,[0m
[30;1m202 | [0m[35m            ),[0m
[30;1m203 | [0m[35m            ConfigEntry([0m
[30;1m204 | [0m[35m                key=LABEL_START_PKCE_LOGIN,[0m

[31m--[ [0m[34mMatch #[0m[33m420[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m184 | [0m[35m                hidden=True,[0m
[30;1m185 | [0m[35m                value=cast("str", values.get(CONF_QUALITY) or TidalQualityEnum.HI_RES.value),[0m
[30;1m186 | [0m[35m                default_value=cast([0m
[30;1m187 | [0m[35m                    "str", values.get(CONF_QUALITY) or TidalQualityEnum.HI_RES.value[0m
[30;1m188 | [0m[35m                ),[0m
[30;1m189 | [0m[35m            ),[0m
[30;1m190 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m421[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m182 | [0m[35m                label=CONF_QUALITY,[0m
[30;1m183 | [0m[35m                required=True,[0m
[30;1m184 | [0m[35m                hidden=True,[0m
[30;1m185 | [0m[35m                value=cast("str", values.get(CONF_QUALITY) or TidalQualityEnum.HI_RES.value),[0m
[30;1m186 | [0m[35m                default_value=cast([0m
[30;1m187 | [0m[35m                    "str", values.get(CONF_QUALITY) or TidalQualityEnum.HI_RES.value[0m
[30;1m188 | [0m[35m                ),[0m

[31m--[ [0m[34mMatch #[0m[33m422[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m161 | [0m[35m        values[CONF_EXPIRY_TIME] = None[0m
[30;1m162 | [0m[35m        values[CONF_USER_ID] = None[0m
[30;1m163 | [0m[35m[0m
[30;1m164 | [0m[35m    if values.get(CONF_AUTH_TOKEN):[0m
[30;1m165 | [0m[35m        auth_entries: tuple[ConfigEntry, ...] = ([0m
[30;1m166 | [0m[35m            ConfigEntry([0m
[30;1m167 | [0m[35m                key="label_ok",[0m

[31m--[ [0m[34mMatch #[0m[33m423[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m145 | [0m[35m    if action == CONF_ACTION_COMPLETE_PKCE_LOGIN:[0m
[30;1m146 | [0m[35m        quality = str(values.get(CONF_QUALITY))[0m
[30;1m147 | [0m[35m        pkce_url = str(values.get(CONF_OOPS_URL))[0m
[30;1m148 | [0m[35m        base64_session = str(values.get(CONF_TEMP_SESSION))[0m
[30;1m149 | [0m[35m        auth_data = await TidalAuthManager.process_pkce_login([0m
[30;1m150 | [0m[35m            mass.http_session, base64_session, pkce_url[0m
[30;1m151 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m424[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35m    if action == CONF_ACTION_COMPLETE_PKCE_LOGIN:[0m
[30;1m146 | [0m[35m        quality = str(values.get(CONF_QUALITY))[0m
[30;1m147 | [0m[35m        pkce_url = str(values.get(CONF_OOPS_URL))[0m
[30;1m148 | [0m[35m        base64_session = str(values.get(CONF_TEMP_SESSION))[0m
[30;1m149 | [0m[35m        auth_data = await TidalAuthManager.process_pkce_login([0m
[30;1m150 | [0m[35m            mass.http_session, base64_session, pkce_url[0m

[31m--[ [0m[34mMatch #[0m[33m425[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m143 | [0m[35m            await asyncio.sleep(15)[0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35m    if action == CONF_ACTION_COMPLETE_PKCE_LOGIN:[0m
[30;1m146 | [0m[35m        quality = str(values.get(CONF_QUALITY))[0m
[30;1m147 | [0m[35m        pkce_url = str(values.get(CONF_OOPS_URL))[0m
[30;1m148 | [0m[35m        base64_session = str(values.get(CONF_TEMP_SESSION))[0m
[30;1m149 | [0m[35m        auth_data = await TidalAuthManager.process_pkce_login([0m

[31m--[ [0m[34mMatch #[0m[33m426[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m133 | [0m[35m        async with ManualAuthenticationHelper([0m
[30;1m134 | [0m[35m            mass, cast("str", values["session_id"])[0m
[30;1m135 | [0m[35m        ) as auth_helper:[0m
[30;1m136 | [0m[35m            quality = str(values.get(CONF_QUALITY))[0m
[30;1m137 | [0m[35m            base64_session = await TidalAuthManager.generate_auth_url(auth_helper, quality)[0m
[30;1m138 | [0m[35m            values[CONF_TEMP_SESSION] = base64_session[0m
[30;1m139 | [0m[35m            # Tidal is using the ManualAuthenticationHelper just to send the user to an URL[0m

[31m--[ [0m[34mMatch #[0m[33m427[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m626 | [0m[35m                else:[0m
[30;1m627 | [0m[35m                    yield item[0m
[30;1m628 | [0m[35m[0m
[30;1m629 | [0m[35m            # Update offset for next batch[0m
[30;1m630 | [0m[35m            offset += len(items)[0m
[30;1m631 | [0m[35m[0m
[30;1m632 | [0m[35m            # Stop if we've received fewer items than the limit[0m

[31m--[ [0m[34mMatch #[0m[33m428[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m356 | [0m[35m                dt = datetime.datetime.fromisoformat(expires_at)[0m
[30;1m357 | [0m[35m                # Convert to timestamp[0m
[30;1m358 | [0m[35m                expires_at = dt.timestamp()[0m
[30;1m359 | [0m[35m                # Update the config with the numeric value[0m
[30;1m360 | [0m[35m                self.update_config_value(CONF_EXPIRY_TIME, expires_at)[0m
[30;1m361 | [0m[35m            except ValueError:[0m
[30;1m362 | [0m[35m                self.logger.warning([0m

[31m--[ [0m[34mMatch #[0m[33m429[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m243 | [0m[35m                label="Oops URL from Tidal redirect",[0m
[30;1m244 | [0m[35m                description="This field should be filled manually by you after authenticating on"[0m
[30;1m245 | [0m[35m                " Tidal.com and being redirected to a page that prominently displays"[0m
[30;1m246 | [0m[35m                " 'Oops' at the top.",[0m
[30;1m247 | [0m[35m                depends_on=CONF_ACTION_START_PKCE_LOGIN,[0m
[30;1m248 | [0m[35m                value=cast("str", values.get(CONF_OOPS_URL)) if values else None,[0m
[30;1m249 | [0m[35m                hidden=action != CONF_ACTION_START_PKCE_LOGIN,[0m

[31m--[ [0m[34mMatch #[0m[33m430[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m215 | [0m[35m                label="Starts the auth process via PKCE on Tidal.com",[0m
[30;1m216 | [0m[35m                description="This button will redirect you to Tidal.com to authenticate."[0m
[30;1m217 | [0m[35m                " After authenticating, you will be redirected to a page that prominently displays"[0m
[30;1m218 | [0m[35m                " 'Oops' at the top.",[0m
[30;1m219 | [0m[35m                action=CONF_ACTION_START_PKCE_LOGIN,[0m
[30;1m220 | [0m[35m                depends_on=CONF_QUALITY,[0m
[30;1m221 | [0m[35m                action_label="Starts the auth process via PKCE on Tidal.com",[0m

[31m--[ [0m[34mMatch #[0m[33m431[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m205 | [0m[35m                type=ConfigEntryType.LABEL,[0m
[30;1m206 | [0m[35m                label="The button below will redirect you to Tidal.com to authenticate.\n\n"[0m
[30;1m207 | [0m[35m                " After authenticating, you will be redirected to a page that prominently displays"[0m
[30;1m208 | [0m[35m                " 'Oops' at the top. That is normal, you need to copy that URL from the "[0m
[30;1m209 | [0m[35m                "address bar and come back here",[0m
[30;1m210 | [0m[35m                hidden=action == CONF_ACTION_START_PKCE_LOGIN,[0m
[30;1m211 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m432[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m360 | [0m[35m                self.update_config_value(CONF_EXPIRY_TIME, expires_at)[0m
[30;1m361 | [0m[35m            except ValueError:[0m
[30;1m362 | [0m[35m                self.logger.warning([0m
[30;1m363 | [0m[35m                    "Could not parse expiry time %s, setting to expired", expires_at[0m
[30;1m364 | [0m[35m                )[0m
[30;1m365 | [0m[35m                expires_at = 0[0m
[30;1m366 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m433[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m291 | [0m[35m        ConfigEntry([0m
[30;1m292 | [0m[35m            key=CONF_EXPIRY_TIME,[0m
[30;1m293 | [0m[35m            type=ConfigEntryType.STRING,[0m
[30;1m294 | [0m[35m            label="Expiry time of auth token for Tidal",[0m
[30;1m295 | [0m[35m            hidden=True,[0m
[30;1m296 | [0m[35m            value=cast("str", values.get(CONF_EXPIRY_TIME)) if values else None,[0m
[30;1m297 | [0m[35m        ),[0m

[31m--[ [0m[34mMatch #[0m[33m434[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/siriusxm/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m259 | [0m[35m        if live_data.id != current_channel:[0m
[30;1m260 | [0m[35m            # This can happen when changing channels[0m
[30;1m261 | [0m[35m            self.logger.debug([0m
[30;1m262 | [0m[35m                f"Received update for channel {live_data.id}, current channel is {current_channel}"[0m
[30;1m263 | [0m[35m            )[0m
[30;1m264 | [0m[35m            return[0m
[30;1m265 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m435[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/siriusxm/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m253 | [0m[35m        """Handle a channel update event."""[0m
[30;1m254 | [0m[35m        live_data = XMLiveChannel.from_dict(live_channel_raw)[0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35m        self.logger.debug(f"Got update for SiriusXM channel {live_data.id}")[0m
[30;1m257 | [0m[35m        current_channel = self._current_stream_details.item_id[0m
[30;1m258 | [0m[35m[0m
[30;1m259 | [0m[35m        if live_data.id != current_channel:[0m

[31m--[ [0m[34mMatch #[0m[33m436[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/siriusxm/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m250 | [0m[35m        return [self._parse_radio(channel) for channel in self._channels][0m
[30;1m251 | [0m[35m[0m
[30;1m252 | [0m[35m    def _channel_updated(self, live_channel_raw: dict[str, Any]) -> None:[0m
[30;1m253 | [0m[35m        """Handle a channel update event."""[0m
[30;1m254 | [0m[35m        live_data = XMLiveChannel.from_dict(live_channel_raw)[0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35m        self.logger.debug(f"Got update for SiriusXM channel {live_data.id}")[0m

[31m--[ [0m[34mMatch #[0m[33m437[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/siriusxm/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m224 | [0m[35m        hls_path = f"http://{self._base_url}/{item_id}.m3u8"[0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m        # Keep a reference to the current `StreamDetails` object so that we can[0m
[30;1m227 | [0m[35m        # update the `stream_title` attribute as callbacks come in from the[0m
[30;1m228 | [0m[35m        # sxm-client with the channel's live data.[0m
[30;1m229 | [0m[35m        # See `_channel_updated` for where this is handled.[0m
[30;1m230 | [0m[35m        self._current_stream_details = StreamDetails([0m

[31m--[ [0m[34mMatch #[0m[33m438[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/siriusxm/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m172 | [0m[35m            ],[0m
[30;1m173 | [0m[35m        )[0m
[30;1m174 | [0m[35m[0m
[30;1m175 | [0m[35m        self.logger.debug(f"SXM Proxy server running at {bind_ip}:{bind_port}")[0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m    async def unload(self, is_removed: bool = False) -> None:[0m
[30;1m178 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m439[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/siriusxm/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m342 | [0m[35m        radio.metadata.links = [MediaItemLink(type=LinkType.WEBSITE, url=channel.url)][0m
[30;1m343 | [0m[35m        radio.metadata.description = channel.medium_description[0m
[30;1m344 | [0m[35m        radio.metadata.explicit = bool(channel.is_mature)[0m
[30;1m345 | [0m[35m        radio.metadata.genres = [cat.name for cat in channel.categories][0m
[30;1m346 | [0m[35m[0m
[30;1m347 | [0m[35m        return radio[0m

[31m--[ [0m[34mMatch #[0m[33m440[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/siriusxm/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m213 | [0m[35m    async def get_stream_details(self, item_id: str, media_type: MediaType) -> StreamDetails:[0m
[30;1m214 | [0m[35m        """Get streamdetails for a track/radio."""[0m
[30;1m215 | [0m[35m        # There's a chance that the SiriusXM auth session has expired[0m
[30;1m216 | [0m[35m        # by the time the user clicks to play a station.  The sxm-client[0m
[30;1m217 | [0m[35m        # will attempt to reauthenticate automatically, but this causes[0m
[30;1m218 | [0m[35m        # a delay in streaming, and ffmpeg raises a TimeoutError.[0m
[30;1m219 | [0m[35m        # To prevent this, we're going to explicitly authenticate with[0m

[31m--[ [0m[34mMatch #[0m[33m441[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/multi_client_stream.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m            queue = asyncio.Queue(2)[0m
[30;1m65 | [0m[35m            self.subscribers.append(queue)[0m
[30;1m66 | [0m[35m            while True:[0m
[30;1m67 | [0m[35m                chunk = await queue.get()[0m
[30;1m68 | [0m[35m                if chunk == b"":[0m
[30;1m69 | [0m[35m                    break[0m
[30;1m70 | [0m[35m                yield chunk[0m

[31m--[ [0m[34mMatch #[0m[33m442[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/_template_plugin_provider/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m106 | [0m[35m        """Return the features supported by this Provider."""[0m
[30;1m107 | [0m[35m        # you should return a set of provider-level features[0m
[30;1m108 | [0m[35m        # here that your plugin provider supports or empty set if none.[0m
[30;1m109 | [0m[35m        # at time of writing the only plugin-specific feature is the[0m
[30;1m110 | [0m[35m        # 'AUDIO_SOURCE' feature which indicates that this provider can[0m
[30;1m111 | [0m[35m        # provide a (single) audio source to Music Assistant, such as a live stream.[0m
[30;1m112 | [0m[35m        # we add this feature here to demonstrate the concept.[0m

[31m--[ [0m[34mMatch #[0m[33m443[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/_template_plugin_provider/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m92 | [0m[35m    which in turn is a subclass of the generic Provider model.[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m    The base implementation already takes care of some convenience methods,[0m
[30;1m95 | [0m[35m    such as the mass object and the logger. Take a look at the base class[0m
[30;1m96 | [0m[35m    for more information on what is available.[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m    Just like with any other subclass, make sure that if you override[0m

[31m--[ [0m[34mMatch #[0m[33m444[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/_template_plugin_provider/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m5 | [0m[35mIts meant to get started developing a new plugin provider for Music Assistant.[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mUse it as a reference to discover what methods exists and what they should return.[0m
[30;1m8 | [0m[35mAlso it is good to look at existing plugin providers to get a better understanding.[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mIn general, a plugin provider does not have any mandatory implementation details.[0m
[30;1m11 | [0m[35mIt provides additional functionality to Music Assistant and most often it will[0m

[31m--[ [0m[34mMatch #[0m[33m445[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/_template_plugin_provider/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m106 | [0m[35m        """Return the features supported by this Provider."""[0m
[30;1m107 | [0m[35m        # you should return a set of provider-level features[0m
[30;1m108 | [0m[35m        # here that your plugin provider supports or empty set if none.[0m
[30;1m109 | [0m[35m        # at time of writing the only plugin-specific feature is the[0m
[30;1m110 | [0m[35m        # 'AUDIO_SOURCE' feature which indicates that this provider can[0m
[30;1m111 | [0m[35m        # provide a (single) audio source to Music Assistant, such as a live stream.[0m
[30;1m112 | [0m[35m        # we add this feature here to demonstrate the concept.[0m

[31m--[ [0m[34mMatch #[0m[33m446[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/tidal_page_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m209 | [0m[35m        parser._page_path = page_path[0m
[30;1m210 | [0m[35m        parser._module_map = cached_data.get("module_map", [])[0m
[30;1m211 | [0m[35m        parser._content_map = cached_data.get("content_map", {})[0m
[30;1m212 | [0m[35m        parser._parsed_at = cached_data.get("parsed_at", 0)[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35m        return parser[0m
[30;1m215 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m447[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/tidal_page_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m208 | [0m[35m        parser = cls(provider)[0m
[30;1m209 | [0m[35m        parser._page_path = page_path[0m
[30;1m210 | [0m[35m        parser._module_map = cached_data.get("module_map", [])[0m
[30;1m211 | [0m[35m        parser._content_map = cached_data.get("content_map", {})[0m
[30;1m212 | [0m[35m        parser._parsed_at = cached_data.get("parsed_at", 0)[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35m        return parser[0m

[31m--[ [0m[34mMatch #[0m[33m448[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/tidal_page_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m        parser = cls(provider)[0m
[30;1m209 | [0m[35m        parser._page_path = page_path[0m
[30;1m210 | [0m[35m        parser._module_map = cached_data.get("module_map", [])[0m
[30;1m211 | [0m[35m        parser._content_map = cached_data.get("content_map", {})[0m
[30;1m212 | [0m[35m        parser._parsed_at = cached_data.get("parsed_at", 0)[0m
[30;1m213 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m449[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/tidal_page_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m197 | [0m[35m    async def from_cache(cls, provider: TidalProvider, page_path: str) -> TidalPageParser | None:[0m
[30;1m198 | [0m[35m        """Create a parser instance from cached data if available and valid."""[0m
[30;1m199 | [0m[35m        cache_key = f"tidal_page_{page_path}"[0m
[30;1m200 | [0m[35m        cached_data = await provider.mass.cache.get([0m
[30;1m201 | [0m[35m            cache_key,[0m
[30;1m202 | [0m[35m            category=CACHE_CATEGORY_RECOMMENDATIONS,[0m
[30;1m203 | [0m[35m            base_key=provider.lookup_key,[0m

[31m--[ [0m[34mMatch #[0m[33m450[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/tidal_page_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m146 | [0m[35m[0m
[30;1m147 | [0m[35m        # If no explicit type, try to infer from structure[0m
[30;1m148 | [0m[35m        if not item_type:[0m
[30;1m149 | [0m[35m            if "mixType" in item or item.get("subTitle"):[0m
[30;1m150 | [0m[35m                item_type = "MIX"[0m
[30;1m151 | [0m[35m            elif "uuid" in item:[0m
[30;1m152 | [0m[35m                item_type = "PLAYLIST"[0m

[31m--[ [0m[34mMatch #[0m[33m451[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/tidal_page_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m128 | [0m[35m                continue[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m            # Use inferred type if no explicit type[0m
[30;1m131 | [0m[35m            item_type = item.get("type", inferred_type)[0m
[30;1m132 | [0m[35m            if parsed_item := self._parse_item(item, type_counts, item_type):[0m
[30;1m133 | [0m[35m                result.append(parsed_item)[0m
[30;1m134 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m452[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/tidal_page_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m115 | [0m[35m    ) -> None:[0m
[30;1m116 | [0m[35m        """Process items from a paged list module."""[0m
[30;1m117 | [0m[35m        paged_list = module_data.get("pagedList", {})[0m
[30;1m118 | [0m[35m        items = paged_list.get("items", [])[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m        # Handle module-specific type inference[0m
[30;1m121 | [0m[35m        inferred_type: str | None = None[0m

[31m--[ [0m[34mMatch #[0m[33m453[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/tidal_page_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m114 | [0m[35m        type_counts: dict[MediaType, int],[0m
[30;1m115 | [0m[35m    ) -> None:[0m
[30;1m116 | [0m[35m        """Process items from a paged list module."""[0m
[30;1m117 | [0m[35m        paged_list = module_data.get("pagedList", {})[0m
[30;1m118 | [0m[35m        items = paged_list.get("items", [])[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m        # Handle module-specific type inference[0m

[31m--[ [0m[34mMatch #[0m[33m454[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/tidal_page_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m101 | [0m[35m        for highlight in highlights:[0m
[30;1m102 | [0m[35m            if isinstance(highlight, dict):  # Make sure highlight is a dict[0m
[30;1m103 | [0m[35m                highlight_item = highlight.get("item", {})[0m
[30;1m104 | [0m[35m                highlight_type = highlight.get("type", "")[0m
[30;1m105 | [0m[35m                if isinstance(highlight_item, dict):[0m
[30;1m106 | [0m[35m                    if parsed_item := self._parse_item(highlight_item, type_counts, highlight_type):[0m
[30;1m107 | [0m[35m                        result.append(parsed_item)[0m

[31m--[ [0m[34mMatch #[0m[33m455[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/tidal_page_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m100 | [0m[35m        highlights = module_data.get("highlight", [])[0m
[30;1m101 | [0m[35m        for highlight in highlights:[0m
[30;1m102 | [0m[35m            if isinstance(highlight, dict):  # Make sure highlight is a dict[0m
[30;1m103 | [0m[35m                highlight_item = highlight.get("item", {})[0m
[30;1m104 | [0m[35m                highlight_type = highlight.get("type", "")[0m
[30;1m105 | [0m[35m                if isinstance(highlight_item, dict):[0m
[30;1m106 | [0m[35m                    if parsed_item := self._parse_item(highlight_item, type_counts, highlight_type):[0m

[31m--[ [0m[34mMatch #[0m[33m456[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/tidal_page_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m97 | [0m[35m        type_counts: dict[MediaType, int],[0m
[30;1m98 | [0m[35m    ) -> None:[0m
[30;1m99 | [0m[35m        """Process highlights from a HIGHLIGHT_MODULE."""[0m
[30;1m100 | [0m[35m        highlights = module_data.get("highlight", [])[0m
[30;1m101 | [0m[35m        for highlight in highlights:[0m
[30;1m102 | [0m[35m            if isinstance(highlight, dict):  # Make sure highlight is a dict[0m
[30;1m103 | [0m[35m                highlight_item = highlight.get("item", {})[0m

[31m--[ [0m[34mMatch #[0m[33m457[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/tidal_page_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m        }[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m        module_data = module_info.get("raw_data", {})[0m
[30;1m71 | [0m[35m        module_type = module_data.get("type", "")[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m        # Extract items based on module type[0m
[30;1m74 | [0m[35m        if module_type == "HIGHLIGHT_MODULE":[0m

[31m--[ [0m[34mMatch #[0m[33m458[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/tidal_page_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m            MediaType.ARTIST: 0,[0m
[30;1m68 | [0m[35m        }[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m        module_data = module_info.get("raw_data", {})[0m
[30;1m71 | [0m[35m        module_type = module_data.get("type", "")[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m        # Extract items based on module type[0m

[31m--[ [0m[34mMatch #[0m[33m459[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/tidal_page_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m47 | [0m[35m                # Store basic module info for later processing[0m
[30;1m48 | [0m[35m                module_info = {[0m
[30;1m49 | [0m[35m                    "title": module.get("title", ""),[0m
[30;1m50 | [0m[35m                    "type": module.get("type", ""),[0m
[30;1m51 | [0m[35m                    "raw_data": module,[0m
[30;1m52 | [0m[35m                    "module_idx": module_idx,[0m
[30;1m53 | [0m[35m                    "row_idx": row_idx,[0m

[31m--[ [0m[34mMatch #[0m[33m460[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/tidal_page_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m            for module in row.get("modules", []):[0m
[30;1m47 | [0m[35m                # Store basic module info for later processing[0m
[30;1m48 | [0m[35m                module_info = {[0m
[30;1m49 | [0m[35m                    "title": module.get("title", ""),[0m
[30;1m50 | [0m[35m                    "type": module.get("type", ""),[0m
[30;1m51 | [0m[35m                    "raw_data": module,[0m
[30;1m52 | [0m[35m                    "module_idx": module_idx,[0m

[31m--[ [0m[34mMatch #[0m[33m461[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/tidal_page_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m        # Extract modules from rows[0m
[30;1m44 | [0m[35m        module_idx = 0[0m
[30;1m45 | [0m[35m        for row_idx, row in enumerate(page_data.get("rows", [])):[0m
[30;1m46 | [0m[35m            for module in row.get("modules", []):[0m
[30;1m47 | [0m[35m                # Store basic module info for later processing[0m
[30;1m48 | [0m[35m                module_info = {[0m
[30;1m49 | [0m[35m                    "title": module.get("title", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m462[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/tidal_page_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m        # Extract modules from rows[0m
[30;1m44 | [0m[35m        module_idx = 0[0m
[30;1m45 | [0m[35m        for row_idx, row in enumerate(page_data.get("rows", [])):[0m
[30;1m46 | [0m[35m            for module in row.get("modules", []):[0m
[30;1m47 | [0m[35m                # Store basic module info for later processing[0m
[30;1m48 | [0m[35m                module_info = {[0m

[31m--[ [0m[34mMatch #[0m[33m463[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/tidal_page_parser.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mfrom __future__ import annotations[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mimport json[0m
[30;1m6 | [0m[35mimport time[0m
[30;1m7 | [0m[35mfrom typing import TYPE_CHECKING, Any[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mfrom music_assistant_models.enums import MediaType[0m
[30;1m10 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m464[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/auth_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m293 | [0m[35m        auth_data = {**token_data, **user_info}[0m
[30;1m294 | [0m[35m[0m
[30;1m295 | [0m[35m        # Add standard fields used by TidalProvider[0m
[30;1m296 | [0m[35m        auth_data["expires_at"] = time.time() + token_data.get("expires_in", 3600)[0m
[30;1m297 | [0m[35m        auth_data["quality"] = quality[0m
[30;1m298 | [0m[35m        auth_data["client_id"] = client_id[0m
[30;1m299 | [0m[35m        auth_data["client_secret"] = client_secret[0m

[31m--[ [0m[34mMatch #[0m[33m465[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/auth_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m282 | [0m[35m        sessions_url = "https://api.tidal.com/v1/sessions"[0m
[30;1m283 | [0m[35m[0m
[30;1m284 | [0m[35m        # Again use mass.http_session[0m
[30;1m285 | [0m[35m        async with http_session.get(sessions_url, headers=headers) as response:[0m
[30;1m286 | [0m[35m            if response.status != 200:[0m
[30;1m287 | [0m[35m                error_text = await response.text()[0m
[30;1m288 | [0m[35m                raise LoginFailed(f"Failed to get user info: {error_text}")[0m

[31m--[ [0m[34mMatch #[0m[33m466[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/auth_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m274 | [0m[35m            token_data = await response.json()[0m
[30;1m275 | [0m[35m[0m
[30;1m276 | [0m[35m        # Validate we have authentication data[0m
[30;1m277 | [0m[35m        if not token_data.get("access_token") or not token_data.get("refresh_token"):[0m
[30;1m278 | [0m[35m            raise LoginFailed("Failed to obtain authentication tokens from Tidal")[0m
[30;1m279 | [0m[35m[0m
[30;1m280 | [0m[35m        # Get user information using the new token[0m

[31m--[ [0m[34mMatch #[0m[33m467[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/auth_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m274 | [0m[35m            token_data = await response.json()[0m
[30;1m275 | [0m[35m[0m
[30;1m276 | [0m[35m        # Validate we have authentication data[0m
[30;1m277 | [0m[35m        if not token_data.get("access_token") or not token_data.get("refresh_token"):[0m
[30;1m278 | [0m[35m            raise LoginFailed("Failed to obtain authentication tokens from Tidal")[0m
[30;1m279 | [0m[35m[0m
[30;1m280 | [0m[35m        # Get user information using the new token[0m

[31m--[ [0m[34mMatch #[0m[33m468[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/auth_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m266 | [0m[35m        headers = {"Content-Type": "application/x-www-form-urlencoded"}[0m
[30;1m267 | [0m[35m[0m
[30;1m268 | [0m[35m        # Make the token exchange request[0m
[30;1m269 | [0m[35m        async with http_session.post(token_url, data=data, headers=headers) as response:[0m
[30;1m270 | [0m[35m            if response.status != 200:[0m
[30;1m271 | [0m[35m                error_text = await response.text()[0m
[30;1m272 | [0m[35m                raise LoginFailed(f"Token exchange failed: {error_text}")[0m

[31m--[ [0m[34mMatch #[0m[33m469[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/auth_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m246 | [0m[35m        # Extract the authorization code from the redirect URL[0m
[30;1m247 | [0m[35m        parsed_url = urllib.parse.urlparse(redirect_url)[0m
[30;1m248 | [0m[35m        query_params = urllib.parse.parse_qs(parsed_url.query)[0m
[30;1m249 | [0m[35m        code = query_params.get("code", [""])[0][0m
[30;1m250 | [0m[35m[0m
[30;1m251 | [0m[35m        if not code:[0m
[30;1m252 | [0m[35m            raise LoginFailed("No authorization code found in redirect URL")[0m

[31m--[ [0m[34mMatch #[0m[33m470[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/auth_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m238 | [0m[35m        client_unique_key = auth_params.get("client_unique_key")[0m
[30;1m239 | [0m[35m        client_secret = auth_params.get("client_secret")[0m
[30;1m240 | [0m[35m        client_id = auth_params.get("client_id")[0m
[30;1m241 | [0m[35m        quality = auth_params.get("quality")[0m
[30;1m242 | [0m[35m[0m
[30;1m243 | [0m[35m        if not code_verifier or not client_unique_key:[0m
[30;1m244 | [0m[35m            raise LoginFailed("Missing required authentication parameters")[0m

[31m--[ [0m[34mMatch #[0m[33m471[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/auth_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m237 | [0m[35m        code_verifier = auth_params.get("code_verifier")[0m
[30;1m238 | [0m[35m        client_unique_key = auth_params.get("client_unique_key")[0m
[30;1m239 | [0m[35m        client_secret = auth_params.get("client_secret")[0m
[30;1m240 | [0m[35m        client_id = auth_params.get("client_id")[0m
[30;1m241 | [0m[35m        quality = auth_params.get("quality")[0m
[30;1m242 | [0m[35m[0m
[30;1m243 | [0m[35m        if not code_verifier or not client_unique_key:[0m

[31m--[ [0m[34mMatch #[0m[33m472[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/auth_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m236 | [0m[35m        # Extract required parameters[0m
[30;1m237 | [0m[35m        code_verifier = auth_params.get("code_verifier")[0m
[30;1m238 | [0m[35m        client_unique_key = auth_params.get("client_unique_key")[0m
[30;1m239 | [0m[35m        client_secret = auth_params.get("client_secret")[0m
[30;1m240 | [0m[35m        client_id = auth_params.get("client_id")[0m
[30;1m241 | [0m[35m        quality = auth_params.get("quality")[0m
[30;1m242 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m473[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/auth_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m235 | [0m[35m[0m
[30;1m236 | [0m[35m        # Extract required parameters[0m
[30;1m237 | [0m[35m        code_verifier = auth_params.get("code_verifier")[0m
[30;1m238 | [0m[35m        client_unique_key = auth_params.get("client_unique_key")[0m
[30;1m239 | [0m[35m        client_secret = auth_params.get("client_secret")[0m
[30;1m240 | [0m[35m        client_id = auth_params.get("client_id")[0m
[30;1m241 | [0m[35m        quality = auth_params.get("quality")[0m

[31m--[ [0m[34mMatch #[0m[33m474[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/auth_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m234 | [0m[35m            raise LoginFailed("Invalid authentication data") from err[0m
[30;1m235 | [0m[35m[0m
[30;1m236 | [0m[35m        # Extract required parameters[0m
[30;1m237 | [0m[35m        code_verifier = auth_params.get("code_verifier")[0m
[30;1m238 | [0m[35m        client_unique_key = auth_params.get("client_unique_key")[0m
[30;1m239 | [0m[35m        client_secret = auth_params.get("client_secret")[0m
[30;1m240 | [0m[35m        client_id = auth_params.get("client_id")[0m

[31m--[ [0m[34mMatch #[0m[33m475[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/auth_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m182 | [0m[35m            country_code=user_info.get("countryCode"),[0m
[30;1m183 | [0m[35m            session_id=session_id,[0m
[30;1m184 | [0m[35m            profile_name=user_info.get("profileName"),[0m
[30;1m185 | [0m[35m            user_name=user_info.get("username"),[0m
[30;1m186 | [0m[35m        )[0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35m    @staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m476[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/auth_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m181 | [0m[35m            user_id=user_info.get("id"),[0m
[30;1m182 | [0m[35m            country_code=user_info.get("countryCode"),[0m
[30;1m183 | [0m[35m            session_id=session_id,[0m
[30;1m184 | [0m[35m            profile_name=user_info.get("profileName"),[0m
[30;1m185 | [0m[35m            user_name=user_info.get("username"),[0m
[30;1m186 | [0m[35m        )[0m
[30;1m187 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m477[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/auth_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m179 | [0m[35m        # Update the TidalUser dataclass with values from API response[0m
[30;1m180 | [0m[35m        self.user = TidalUser([0m
[30;1m181 | [0m[35m            user_id=user_info.get("id"),[0m
[30;1m182 | [0m[35m            country_code=user_info.get("countryCode"),[0m
[30;1m183 | [0m[35m            session_id=session_id,[0m
[30;1m184 | [0m[35m            profile_name=user_info.get("profileName"),[0m
[30;1m185 | [0m[35m            user_name=user_info.get("username"),[0m

[31m--[ [0m[34mMatch #[0m[33m478[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/auth_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m178 | [0m[35m        """Update user info from API response."""[0m
[30;1m179 | [0m[35m        # Update the TidalUser dataclass with values from API response[0m
[30;1m180 | [0m[35m        self.user = TidalUser([0m
[30;1m181 | [0m[35m            user_id=user_info.get("id"),[0m
[30;1m182 | [0m[35m            country_code=user_info.get("countryCode"),[0m
[30;1m183 | [0m[35m            session_id=session_id,[0m
[30;1m184 | [0m[35m            profile_name=user_info.get("profileName"),[0m

[31m--[ [0m[34mMatch #[0m[33m479[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/auth_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m151 | [0m[35m[0m
[30;1m152 | [0m[35m        headers = {"Content-Type": "application/x-www-form-urlencoded"}[0m
[30;1m153 | [0m[35m[0m
[30;1m154 | [0m[35m        async with self.http_session.post([0m
[30;1m155 | [0m[35m            f"{AUTH_URL}/token", data=data, headers=headers[0m
[30;1m156 | [0m[35m        ) as response:[0m
[30;1m157 | [0m[35m            if response.status != 200:[0m

[31m--[ [0m[34mMatch #[0m[33m480[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/auth_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m140 | [0m[35m        if not refresh_token:[0m
[30;1m141 | [0m[35m            return False[0m
[30;1m142 | [0m[35m[0m
[30;1m143 | [0m[35m        client_id = self._auth_info.get("client_id", app_var(9))[0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35m        data = {[0m
[30;1m146 | [0m[35m            "refresh_token": refresh_token,[0m

[31m--[ [0m[34mMatch #[0m[33m481[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/auth_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m        if not self._auth_info:[0m
[30;1m137 | [0m[35m            return False[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m        refresh_token = self._auth_info.get("refresh_token")  # type: ignore[unreachable][0m
[30;1m140 | [0m[35m        if not refresh_token:[0m
[30;1m141 | [0m[35m            return False[0m
[30;1m142 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m482[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/auth_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m            return False[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m        # Check if token is expired[0m
[30;1m127 | [0m[35m        expires_at = self._auth_info.get("expires_at", 0)  # type: ignore[unreachable][0m
[30;1m128 | [0m[35m        if expires_at > time.time() - 60:[0m
[30;1m129 | [0m[35m            return True[0m
[30;1m130 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m483[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/auth_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m116 | [0m[35m    @property[0m
[30;1m117 | [0m[35m    def access_token(self) -> str | None:[0m
[30;1m118 | [0m[35m        """Return the current access token."""[0m
[30;1m119 | [0m[35m        return self._auth_info.get("access_token") if self._auth_info else None[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m    async def ensure_valid_token(self) -> bool:[0m
[30;1m122 | [0m[35m        """Ensure we have a valid token, refresh if needed."""[0m

[31m--[ [0m[34mMatch #[0m[33m484[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/auth_manager.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m    async def update_user_info(self, user_info: dict[str, Any], session_id: str) -> None:[0m
[30;1m178 | [0m[35m        """Update user info from API response."""[0m
[30;1m179 | [0m[35m        # Update the TidalUser dataclass with values from API response[0m
[30;1m180 | [0m[35m        self.user = TidalUser([0m
[30;1m181 | [0m[35m            user_id=user_info.get("id"),[0m
[30;1m182 | [0m[35m            country_code=user_info.get("countryCode"),[0m

[31m--[ [0m[34mMatch #[0m[33m485[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/auth_manager.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m165 | [0m[35m            if "refresh_token" in token_data:[0m
[30;1m166 | [0m[35m                self._auth_info["refresh_token"] = token_data["refresh_token"][0m
[30;1m167 | [0m[35m[0m
[30;1m168 | [0m[35m            # Update expiration[0m
[30;1m169 | [0m[35m            if "expires_in" in token_data:[0m
[30;1m170 | [0m[35m                self._auth_info["expires_at"] = time.time() + token_data["expires_in"][0m
[30;1m171 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m486[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/auth_manager.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35m            token_data = await response.json()[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m            # Update auth info[0m
[30;1m164 | [0m[35m            self._auth_info["access_token"] = token_data["access_token"][0m
[30;1m165 | [0m[35m            if "refresh_token" in token_data:[0m
[30;1m166 | [0m[35m                self._auth_info["refresh_token"] = token_data["refresh_token"][0m

[31m--[ [0m[34mMatch #[0m[33m487[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/auth_manager.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m289 | [0m[35m[0m
[30;1m290 | [0m[35m            user_info = await response.json()[0m
[30;1m291 | [0m[35m[0m
[30;1m292 | [0m[35m        # Combine token and user info, add expiration time[0m
[30;1m293 | [0m[35m        auth_data = {**token_data, **user_info}[0m
[30;1m294 | [0m[35m[0m
[30;1m295 | [0m[35m        # Add standard fields used by TidalProvider[0m
[30;1m296 | [0m[35m        auth_data["expires_at"] = time.time() + token_data.get("expires_in", 3600)[0m

[31m--[ [0m[34mMatch #[0m[33m488[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tidal/auth_manager.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport json[0m
[30;1m4 | [0m[35mimport random[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35mimport urllib[0m
[30;1m7 | [0m[35mfrom collections.abc import Callable[0m
[30;1m8 | [0m[35mfrom dataclasses import dataclass[0m
[30;1m9 | [0m[35mfrom types import TracebackType[0m

[31m--[ [0m[34mMatch #[0m[33m489[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass_players/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m628 | [0m[35m                "Authorization": f"Bearer {api_token}",[0m
[30;1m629 | [0m[35m                "content-type": "application/json",[0m
[30;1m630 | [0m[35m            }[0m
[30;1m631 | [0m[35m            async with self.mass.http_session.get(url, headers=headers) as response:[0m
[30;1m632 | [0m[35m                if response.status != 200:[0m
[30;1m633 | [0m[35m                    raise LoginFailed("Unable to contact Home Assistant to retrieve diagnostics")[0m
[30;1m634 | [0m[35m                data = await response.json()[0m

[31m--[ [0m[34mMatch #[0m[33m490[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass_players/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m622 | [0m[35m            ws_url = self.hass_prov.hass._websocket_url or "ws://supervisor/core/websocket"[0m
[30;1m623 | [0m[35m            hass_url = ws_url.replace("ws://", "http://").replace("wss://", "https://")[0m
[30;1m624 | [0m[35m            hass_url = hass_url.replace("/api/websocket", "").replace("/websocket", "")[0m
[30;1m625 | [0m[35m            api_token = self.hass_prov.hass._token or os.environ.get("HASSIO_TOKEN")[0m
[30;1m626 | [0m[35m            url = f"{hass_url}/api/diagnostics/config_entry/{conf_entry_id}"[0m
[30;1m627 | [0m[35m            headers = {[0m
[30;1m628 | [0m[35m                "Authorization": f"Bearer {api_token}",[0m

[31m--[ [0m[34mMatch #[0m[33m491[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass_players/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m557 | [0m[35m        if entity_additions := event.get("a"):[0m
[30;1m558 | [0m[35m            for entity_id, state in entity_additions.items():[0m
[30;1m559 | [0m[35m                update_player_from_state_msg(entity_id, state)[0m
[30;1m560 | [0m[35m        if entity_changes := event.get("c"):[0m
[30;1m561 | [0m[35m            for entity_id, state_diff in entity_changes.items():[0m
[30;1m562 | [0m[35m                if "+" not in state_diff:[0m
[30;1m563 | [0m[35m                    continue[0m

[31m--[ [0m[34mMatch #[0m[33m492[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass_players/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m554 | [0m[35m                self._update_player_attributes(player, state["a"])[0m
[30;1m555 | [0m[35m            self.mass.players.update(entity_id)[0m
[30;1m556 | [0m[35m[0m
[30;1m557 | [0m[35m        if entity_additions := event.get("a"):[0m
[30;1m558 | [0m[35m            for entity_id, state in entity_additions.items():[0m
[30;1m559 | [0m[35m                update_player_from_state_msg(entity_id, state)[0m
[30;1m560 | [0m[35m        if entity_changes := event.get("c"):[0m

[31m--[ [0m[34mMatch #[0m[33m493[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass_players/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m546 | [0m[35m                self.mass.create_task(self._late_add_player(entity_id))[0m
[30;1m547 | [0m[35m                return[0m
[30;1m548 | [0m[35m            if "s" in state:[0m
[30;1m549 | [0m[35m                player.state = StateMap.get(state["s"], PlayerState.IDLE)[0m
[30;1m550 | [0m[35m                player.available = state["s"] not in UNAVAILABLE_STATES[0m
[30;1m551 | [0m[35m                if PlayerFeature.POWER in player.supported_features:[0m
[30;1m552 | [0m[35m                    player.powered = state["s"] not in OFF_STATES[0m

[31m--[ [0m[34mMatch #[0m[33m494[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass_players/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m536 | [0m[35m[0m
[30;1m537 | [0m[35m        def update_player_from_state_msg(entity_id: str, state: CompressedState) -> None:[0m
[30;1m538 | [0m[35m            """Handle updating MA player with updated info in a HA CompressedState."""[0m
[30;1m539 | [0m[35m            player = self.mass.players.get(entity_id)[0m
[30;1m540 | [0m[35m            if player is None:[0m
[30;1m541 | [0m[35m                # edge case - one of our subscribed entities was not available at startup[0m
[30;1m542 | [0m[35m                # and now came available - we should still set it up[0m

[31m--[ [0m[34mMatch #[0m[33m495[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass_players/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m498 | [0m[35m            name=state["attributes"]["friendly_name"],[0m
[30;1m499 | [0m[35m            available=state["state"] not in UNAVAILABLE_STATES,[0m
[30;1m500 | [0m[35m            device_info=DeviceInfo.from_dict(dev_info),[0m
[30;1m501 | [0m[35m            state=StateMap.get(state["state"], PlayerState.IDLE),[0m
[30;1m502 | [0m[35m            extra_data=extra_player_data,[0m
[30;1m503 | [0m[35m        )[0m
[30;1m504 | [0m[35m        # work out supported features[0m

[31m--[ [0m[34mMatch #[0m[33m496[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass_players/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m486 | [0m[35m                dev_info["model_id"] = model_id[0m
[30;1m487 | [0m[35m            if sw_version := hass_device.get("sw_version"):[0m
[30;1m488 | [0m[35m                dev_info["software_version"] = sw_version[0m
[30;1m489 | [0m[35m            if connections := hass_device.get("connections"):[0m
[30;1m490 | [0m[35m                for key, value in connections:[0m
[30;1m491 | [0m[35m                    if key == "mac":[0m
[30;1m492 | [0m[35m                        dev_info["mac_address"] = value[0m

[31m--[ [0m[34mMatch #[0m[33m497[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass_players/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m484 | [0m[35m                dev_info["manufacturer"] = manufacturer[0m
[30;1m485 | [0m[35m            if model_id := hass_device.get("model_id"):[0m
[30;1m486 | [0m[35m                dev_info["model_id"] = model_id[0m
[30;1m487 | [0m[35m            if sw_version := hass_device.get("sw_version"):[0m
[30;1m488 | [0m[35m                dev_info["software_version"] = sw_version[0m
[30;1m489 | [0m[35m            if connections := hass_device.get("connections"):[0m
[30;1m490 | [0m[35m                for key, value in connections:[0m

[31m--[ [0m[34mMatch #[0m[33m498[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass_players/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m482 | [0m[35m                dev_info["model"] = model[0m
[30;1m483 | [0m[35m            if manufacturer := hass_device.get("manufacturer"):[0m
[30;1m484 | [0m[35m                dev_info["manufacturer"] = manufacturer[0m
[30;1m485 | [0m[35m            if model_id := hass_device.get("model_id"):[0m
[30;1m486 | [0m[35m                dev_info["model_id"] = model_id[0m
[30;1m487 | [0m[35m            if sw_version := hass_device.get("sw_version"):[0m
[30;1m488 | [0m[35m                dev_info["software_version"] = sw_version[0m

[31m--[ [0m[34mMatch #[0m[33m499[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass_players/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m480 | [0m[35m            extra_player_data["hass_device_id"] = hass_device["id"][0m
[30;1m481 | [0m[35m            if model := hass_device.get("model"):[0m
[30;1m482 | [0m[35m                dev_info["model"] = model[0m
[30;1m483 | [0m[35m            if manufacturer := hass_device.get("manufacturer"):[0m
[30;1m484 | [0m[35m                dev_info["manufacturer"] = manufacturer[0m
[30;1m485 | [0m[35m            if model_id := hass_device.get("model_id"):[0m
[30;1m486 | [0m[35m                dev_info["model_id"] = model_id[0m

[31m--[ [0m[34mMatch #[0m[33m500[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass_players/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m478 | [0m[35m        dev_info: dict[str, Any] = {}[0m
[30;1m479 | [0m[35m        if hass_device:[0m
[30;1m480 | [0m[35m            extra_player_data["hass_device_id"] = hass_device["id"][0m
[30;1m481 | [0m[35m            if model := hass_device.get("model"):[0m
[30;1m482 | [0m[35m                dev_info["model"] = model[0m
[30;1m483 | [0m[35m            if manufacturer := hass_device.get("manufacturer"):[0m
[30;1m484 | [0m[35m                dev_info["manufacturer"] = manufacturer[0m

[31m--[ [0m[34mMatch #[0m[33m501[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass_players/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m458 | [0m[35m        hass_domain: str | None = None[0m
[30;1m459 | [0m[35m        extra_player_data: dict[str, Any] = {}[0m
[30;1m460 | [0m[35m        if entity_registry_entry := entity_registry.get(state["entity_id"]):[0m
[30;1m461 | [0m[35m            hass_device = device_registry.get(entity_registry_entry["device_id"])[0m
[30;1m462 | [0m[35m            hass_domain = entity_registry_entry["platform"][0m
[30;1m463 | [0m[35m            extra_player_data["entity_registry_id"] = entity_registry_entry["id"][0m
[30;1m464 | [0m[35m            extra_player_data["hass_domain"] = hass_domain[0m

[31m--[ [0m[34mMatch #[0m[33m502[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass_players/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m457 | [0m[35m        hass_device: HassDevice | None = None[0m
[30;1m458 | [0m[35m        hass_domain: str | None = None[0m
[30;1m459 | [0m[35m        extra_player_data: dict[str, Any] = {}[0m
[30;1m460 | [0m[35m        if entity_registry_entry := entity_registry.get(state["entity_id"]):[0m
[30;1m461 | [0m[35m            hass_device = device_registry.get(entity_registry_entry["device_id"])[0m
[30;1m462 | [0m[35m            hass_domain = entity_registry_entry["platform"][0m
[30;1m463 | [0m[35m            extra_player_data["entity_registry_id"] = entity_registry_entry["id"][0m

[31m--[ [0m[34mMatch #[0m[33m503[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass_players/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m348 | [0m[35m        self, player_id: str, announcement: PlayerMedia, volume_level: int | None = None[0m
[30;1m349 | [0m[35m    ) -> None:[0m
[30;1m350 | [0m[35m        """Handle (provider native) playback of an announcement on given player."""[0m
[30;1m351 | [0m[35m        player = self.mass.players.get(player_id, True)[0m
[30;1m352 | [0m[35m        self.logger.info([0m
[30;1m353 | [0m[35m            "Playing announcement %s on %s",[0m
[30;1m354 | [0m[35m            announcement.uri,[0m

[31m--[ [0m[34mMatch #[0m[33m504[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass_players/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m339 | [0m[35m            target={"entity_id": player_id},[0m
[30;1m340 | [0m[35m        )[0m
[30;1m341 | [0m[35m        # optimistically set the elapsed_time as some HA players do not report this[0m
[30;1m342 | [0m[35m        if player := self.mass.players.get(player_id):[0m
[30;1m343 | [0m[35m            player.elapsed_time = 0[0m
[30;1m344 | [0m[35m            player.elapsed_time_last_updated = time.time()[0m
[30;1m345 | [0m[35m            player.current_media = media[0m

[31m--[ [0m[34mMatch #[0m[33m505[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass_players/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m318 | [0m[35m                "imageUrl": media.image_url,[0m
[30;1m319 | [0m[35m            },[0m
[30;1m320 | [0m[35m        }[0m
[30;1m321 | [0m[35m        if player.extra_data.get("hass_domain") == "esphome":[0m
[30;1m322 | [0m[35m            # tell esphome mediaproxy to bypass the proxy,[0m
[30;1m323 | [0m[35m            # as MA already delivers an optimized stream[0m
[30;1m324 | [0m[35m            extra_data["bypass_proxy"] = True[0m

[31m--[ [0m[34mMatch #[0m[33m506[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass_players/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m303 | [0m[35m[0m
[30;1m304 | [0m[35m    async def play_media(self, player_id: str, media: PlayerMedia) -> None:[0m
[30;1m305 | [0m[35m        """Handle PLAY MEDIA on given player."""[0m
[30;1m306 | [0m[35m        player = self.mass.players.get(player_id, True)[0m
[30;1m307 | [0m[35m        assert player[0m
[30;1m308 | [0m[35m        extra_data = {[0m
[30;1m309 | [0m[35m            # passing metadata to the player[0m

[31m--[ [0m[34mMatch #[0m[33m507[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass_players/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m277 | [0m[35m            # some HA players do not support STOP[0m
[30;1m278 | [0m[35m            if "does not support this service" not in str(exc):[0m
[30;1m279 | [0m[35m                raise[0m
[30;1m280 | [0m[35m            if player := self.mass.players.get(player_id):[0m
[30;1m281 | [0m[35m                if PlayerFeature.PAUSE in player.supported_features:[0m
[30;1m282 | [0m[35m                    await self.cmd_pause(player_id)[0m
[30;1m283 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m508[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass_players/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m249 | [0m[35m            )[0m
[30;1m250 | [0m[35m[0m
[30;1m251 | [0m[35m        # add alert if player is a known player type that has a native provider in MA[0m
[30;1m252 | [0m[35m        if player and player.extra_data.get("hass_domain") in WARN_HASS_INTEGRATIONS:[0m
[30;1m253 | [0m[35m            base_entries = (CONF_ENTRY_WARN_HASS_INTEGRATION, *base_entries)[0m
[30;1m254 | [0m[35m[0m
[30;1m255 | [0m[35m        # enable flow mode by default if player does not report enqueue support[0m

[31m--[ [0m[34mMatch #[0m[33m509[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass_players/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m208 | [0m[35m        base_entries = await super().get_player_config_entries(player_id)[0m
[30;1m209 | [0m[35m        base_entries = (*base_entries, *DEFAULT_PLAYER_CONFIG_ENTRIES)[0m
[30;1m210 | [0m[35m        player = self.mass.players.get(player_id)[0m
[30;1m211 | [0m[35m        if player and player.extra_data.get("esphome_supported_audio_formats"):[0m
[30;1m212 | [0m[35m            # optimized config for new ESPHome mediaplayer[0m
[30;1m213 | [0m[35m            supported_sample_rates: list[int] = [][0m
[30;1m214 | [0m[35m            supported_bit_depths: list[int] = [][0m

[31m--[ [0m[34mMatch #[0m[33m510[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass_players/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m207 | [0m[35m        """Return all (provider/player specific) Config Entries for the given player (if any)."""[0m
[30;1m208 | [0m[35m        base_entries = await super().get_player_config_entries(player_id)[0m
[30;1m209 | [0m[35m        base_entries = (*base_entries, *DEFAULT_PLAYER_CONFIG_ENTRIES)[0m
[30;1m210 | [0m[35m        player = self.mass.players.get(player_id)[0m
[30;1m211 | [0m[35m        if player and player.extra_data.get("esphome_supported_audio_formats"):[0m
[30;1m212 | [0m[35m            # optimized config for new ESPHome mediaplayer[0m
[30;1m213 | [0m[35m            supported_sample_rates: list[int] = [][0m

[31m--[ [0m[34mMatch #[0m[33m511[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass_players/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m95 | [0m[35m        supported_features = MediaPlayerEntityFeature(state["attributes"]["supported_features"])[0m
[30;1m96 | [0m[35m        if MediaPlayerEntityFeature.PLAY_MEDIA not in supported_features:[0m
[30;1m97 | [0m[35m            continue[0m
[30;1m98 | [0m[35m        if entity_registry_entry := entity_registry.get(state["entity_id"]):[0m
[30;1m99 | [0m[35m            hass_domain = entity_registry_entry["platform"][0m
[30;1m100 | [0m[35m            if hass_domain in BLOCKLISTED_HASS_INTEGRATIONS:[0m
[30;1m101 | [0m[35m                continue[0m

[31m--[ [0m[34mMatch #[0m[33m512[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass_players/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m538 | [0m[35m            """Handle updating MA player with updated info in a HA CompressedState."""[0m
[30;1m539 | [0m[35m            player = self.mass.players.get(entity_id)[0m
[30;1m540 | [0m[35m            if player is None:[0m
[30;1m541 | [0m[35m                # edge case - one of our subscribed entities was not available at startup[0m
[30;1m542 | [0m[35m                # and now came available - we should still set it up[0m
[30;1m543 | [0m[35m                player_ids: list[str] = self.config.get_value(CONF_PLAYERS)[0m
[30;1m544 | [0m[35m                if entity_id not in player_ids:[0m

[31m--[ [0m[34mMatch #[0m[33m513[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass_players/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m216 | [0m[35m            supported_formats: list[ESPHomeSupportedAudioFormat] = player.extra_data[[0m
[30;1m217 | [0m[35m                "esphome_supported_audio_formats"[0m
[30;1m218 | [0m[35m            ][0m
[30;1m219 | [0m[35m            # sort on purpose field, so we prefer the media pipeline[0m
[30;1m220 | [0m[35m            # but allows fallback to announcements pipeline if no media pipeline is available[0m
[30;1m221 | [0m[35m            supported_formats.sort(key=lambda x: x["purpose"])[0m
[30;1m222 | [0m[35m            for supported_format in supported_formats:[0m

[31m--[ [0m[34mMatch #[0m[33m514[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass_players/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35mimport asyncio[0m
[30;1m11 | [0m[35mimport logging[0m
[30;1m12 | [0m[35mimport os[0m
[30;1m13 | [0m[35mimport time[0m
[30;1m14 | [0m[35mfrom typing import TYPE_CHECKING, Any, TypedDict, cast[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35mfrom hass_client.exceptions import FailedCommand[0m
[30;1m17 | [0m[35mfrom music_assistant_models.config_entries import ConfigEntry, ConfigValueOption, ConfigValueType[0m

[31m--[ [0m[34mMatch #[0m[33m515[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_smb/__init__.py[0m
   Pattern: [32m.hostname[0m
[30;1m73 | [0m[35m            type=ConfigEntryType.STRING,[0m
[30;1m74 | [0m[35m            label="Server",[0m
[30;1m75 | [0m[35m            required=True,[0m
[30;1m76 | [0m[35m            description="The (fqdn) hostname of the SMB/CIFS/DFS server to connect to."[0m
[30;1m77 | [0m[35m            "For example mynas.local.",[0m
[30;1m78 | [0m[35m        ),[0m
[30;1m79 | [0m[35m        ConfigEntry([0m

[31m--[ [0m[34mMatch #[0m[33m516[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_smb/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m241 | [0m[35m        )[0m
[30;1m242 | [0m[35m        returncode, output = await check_output(*mount_cmd, env=env_vars)[0m
[30;1m243 | [0m[35m        if returncode != 0:[0m
[30;1m244 | [0m[35m            msg = f"SMB mount failed with error: {output.decode()}"[0m
[30;1m245 | [0m[35m            raise LoginFailed(msg)[0m
[30;1m246 | [0m[35m[0m
[30;1m247 | [0m[35m    async def unmount(self, ignore_error: bool = False) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m517[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_smb/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m236 | [0m[35m        self.logger.debug("Mounting //%s/%s%s to %s", server, share, subfolder, self.base_path)[0m
[30;1m237 | [0m[35m        self.logger.log([0m
[30;1m238 | [0m[35m            VERBOSE_LOG_LEVEL,[0m
[30;1m239 | [0m[35m            "Using mount command: %s",[0m
[30;1m240 | [0m[35m            " ".join(mount_cmd),[0m
[30;1m241 | [0m[35m        )[0m
[30;1m242 | [0m[35m        returncode, output = await check_output(*mount_cmd, env=env_vars)[0m

[31m--[ [0m[34mMatch #[0m[33m518[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_smb/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m215 | [0m[35m                options += mount_options.split(",")[0m
[30;1m216 | [0m[35m            options_str = ",".join(options)[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m            # pass the username+password using (scoped) env variables[0m
[30;1m219 | [0m[35m            # to prevent leaking in the process list and special chars supported[0m
[30;1m220 | [0m[35m            if password:[0m
[30;1m221 | [0m[35m                env_vars["PASSWD"] = str(password)[0m

[31m--[ [0m[34mMatch #[0m[33m519[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_smb/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m141 | [0m[35m    Implementation of an SMB File System Provider.[0m
[30;1m142 | [0m[35m[0m
[30;1m143 | [0m[35m    Basically this is just a wrapper around the regular local files provider,[0m
[30;1m144 | [0m[35m    except for the fact that it will mount a remote folder to a temporary location.[0m
[30;1m145 | [0m[35m    We went for this OS-depdendent approach because there is no solid async-compatible[0m
[30;1m146 | [0m[35m    smb library for Python (and we tried both pysmb and smbprotocol).[0m
[30;1m147 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m520[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_smb/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m119 | [0m[35m            category="advanced",[0m
[30;1m120 | [0m[35m            default_value="noserverino,file_mode=0775,dir_mode=0775,uid=0,gid=0",[0m
[30;1m121 | [0m[35m            description="[optional] Any additional mount options you "[0m
[30;1m122 | [0m[35m            "want to pass to the mount command if needed for your particular setup.",[0m
[30;1m123 | [0m[35m        ),[0m
[30;1m124 | [0m[35m        CONF_ENTRY_MISSING_ALBUM_ARTIST,[0m
[30;1m125 | [0m[35m        CONF_ENTRY_IGNORE_ALBUM_PLAYLISTS,[0m

[31m--[ [0m[34mMatch #[0m[33m521[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_smb/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m118 | [0m[35m            required=False,[0m
[30;1m119 | [0m[35m            category="advanced",[0m
[30;1m120 | [0m[35m            default_value="noserverino,file_mode=0775,dir_mode=0775,uid=0,gid=0",[0m
[30;1m121 | [0m[35m            description="[optional] Any additional mount options you "[0m
[30;1m122 | [0m[35m            "want to pass to the mount command if needed for your particular setup.",[0m
[30;1m123 | [0m[35m        ),[0m
[30;1m124 | [0m[35m        CONF_ENTRY_MISSING_ALBUM_ARTIST,[0m

[31m--[ [0m[34mMatch #[0m[33m522[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_smb/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35m    if not share or "/" in share or "\\" in share:[0m
[30;1m49 | [0m[35m        msg = "Invalid share name"[0m
[30;1m50 | [0m[35m        raise LoginFailed(msg)[0m
[30;1m51 | [0m[35m    # base_path will be the path where we're going to mount the remote share[0m
[30;1m52 | [0m[35m    base_path = f"/tmp/{config.instance_id}"  # noqa: S108[0m
[30;1m53 | [0m[35m    return SMBFileSystemProvider(mass, manifest, config, base_path)[0m
[30;1m54 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m523[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m479 | [0m[35m[0m
[30;1m480 | [0m[35m    all_sonos_ips = await asyncio.to_thread(get_all_sonos_ips)[0m
[30;1m481 | [0m[35m    for ip_address in all_sonos_ips:[0m
[30;1m482 | [0m[35m        async with mass.http_session.get(f"http://{ip_address}:1400/status/zp") as resp:[0m
[30;1m483 | [0m[35m            if resp.status == 200:[0m
[30;1m484 | [0m[35m                data = await resp.text()[0m
[30;1m485 | [0m[35m                if prefer_s1 and "<SWGen>2</SWGen>" in data:[0m

[31m--[ [0m[34mMatch #[0m[33m524[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m466 | [0m[35m[0m
[30;1m467 | [0m[35masync def discover_household_ids(mass: MusicAssistant, prefer_s1: bool = True) -> list[str]:[0m
[30;1m468 | [0m[35m    """Discover the HouseHold ID of S1 speaker(s) the network."""[0m
[30;1m469 | [0m[35m    if cache := await mass.cache.get("sonos_household_ids"):[0m
[30;1m470 | [0m[35m        return cast("list[str]", cache)[0m
[30;1m471 | [0m[35m    household_ids: list[str] = [][0m
[30;1m472 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m525[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m432 | [0m[35m        if soco.uid not in self.boot_counts:[0m
[30;1m433 | [0m[35m            self.boot_counts[soco.uid] = soco.boot_seqnum[0m
[30;1m434 | [0m[35m        self.logger.debug("Adding new player: %s", speaker_info)[0m
[30;1m435 | [0m[35m        if not (mass_player := self.mass.players.get(soco.uid)):[0m
[30;1m436 | [0m[35m            mass_player = Player([0m
[30;1m437 | [0m[35m                player_id=soco.uid,[0m
[30;1m438 | [0m[35m                provider=self.instance_id,[0m

[31m--[ [0m[34mMatch #[0m[33m526[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m417 | [0m[35m        """Add discovered Sonos player."""[0m
[30;1m418 | [0m[35m        player_id = soco.uid[0m
[30;1m419 | [0m[35m        # check if existing player changed IP[0m
[30;1m420 | [0m[35m        if existing := self.sonosplayers.get(player_id):[0m
[30;1m421 | [0m[35m            if existing.soco.ip_address != soco.ip_address:[0m
[30;1m422 | [0m[35m                existing.update_ip(soco.ip_address)[0m
[30;1m423 | [0m[35m            return[0m

[31m--[ [0m[34mMatch #[0m[33m527[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m282 | [0m[35m    ) -> None:[0m
[30;1m283 | [0m[35m        """Handle PLAY MEDIA on given player."""[0m
[30;1m284 | [0m[35m        sonos_player = self.sonosplayers[player_id][0m
[30;1m285 | [0m[35m        mass_player = self.mass.players.get(player_id)[0m
[30;1m286 | [0m[35m        assert mass_player[0m
[30;1m287 | [0m[35m        if sonos_player.sync_coordinator:[0m
[30;1m288 | [0m[35m            # this should be already handled by the player manager, but just in case...[0m

[31m--[ [0m[34mMatch #[0m[33m528[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m342 | [0m[35m            # based on when we last received info from the device[0m
[30;1m343 | [0m[35m            if needs_poll := await sonos_player.check_poll():[0m
[30;1m344 | [0m[35m                await sonos_player.poll_speaker()[0m
[30;1m345 | [0m[35m            # always update the attributes[0m
[30;1m346 | [0m[35m            sonos_player.update_player(signal_update=needs_poll)[0m
[30;1m347 | [0m[35m        except ConnectionResetError as err:[0m
[30;1m348 | [0m[35m            raise PlayerUnavailableError from err[0m

[31m--[ [0m[34mMatch #[0m[33m529[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m188 | [0m[35m        )[0m
[30;1m189 | [0m[35m[0m
[30;1m190 | [0m[35m    def is_device_invisible(self, ip_address: str) -> bool:[0m
[30;1m191 | [0m[35m        """Check if device at provided IP is known to be invisible."""[0m
[30;1m192 | [0m[35m        return any(x for x in self._known_invisible if x.ip_address == ip_address)[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m    async def cmd_stop(self, player_id: str) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m530[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m416 | [0m[35m    def _add_player(self, soco: SoCo) -> None:[0m
[30;1m417 | [0m[35m        """Add discovered Sonos player."""[0m
[30;1m418 | [0m[35m        player_id = soco.uid[0m
[30;1m419 | [0m[35m        # check if existing player changed IP[0m
[30;1m420 | [0m[35m        if existing := self.sonosplayers.get(player_id):[0m
[30;1m421 | [0m[35m            if existing.soco.ip_address != soco.ip_address:[0m
[30;1m422 | [0m[35m                existing.update_ip(soco.ip_address)[0m
[30;1m423 | [0m[35m            return[0m

[31m--[ [0m[34mMatch #[0m[33m531[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m188 | [0m[35m        )[0m
[30;1m189 | [0m[35m[0m
[30;1m190 | [0m[35m    def is_device_invisible(self, ip_address: str) -> bool:[0m
[30;1m191 | [0m[35m        """Check if device at provided IP is known to be invisible."""[0m
[30;1m192 | [0m[35m        return any(x for x in self._known_invisible if x.ip_address == ip_address)[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m    async def cmd_stop(self, player_id: str) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m532[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/bluesound/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m364 | [0m[35m        if bluos_player := self.bluos_players[player_id]:[0m
[30;1m365 | [0m[35m            await bluos_player.client.volume(mute=muted)[0m
[30;1m366 | [0m[35m            # Optimistic state, reduces interface lag[0m
[30;1m367 | [0m[35m            mass_player = self.mass.players.get(player_id)[0m
[30;1m368 | [0m[35m            mass_player.volume_mute = muted[0m
[30;1m369 | [0m[35m            await bluos_player.update_attributes()[0m
[30;1m370 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m533[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/bluesound/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m354 | [0m[35m        if bluos_player := self.bluos_players[player_id]:[0m
[30;1m355 | [0m[35m            await bluos_player.client.volume(level=volume_level, timeout=1)[0m
[30;1m356 | [0m[35m            self.logger.debug("Set BluOS speaker volume to %s", volume_level)[0m
[30;1m357 | [0m[35m            mass_player = self.mass.players.get(player_id)[0m
[30;1m358 | [0m[35m            # Optimistic state, reduces interface lag[0m
[30;1m359 | [0m[35m            mass_player.volume_level = volume_level[0m
[30;1m360 | [0m[35m            await bluos_player.update_attributes()[0m

[31m--[ [0m[34mMatch #[0m[33m534[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/bluesound/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m307 | [0m[35m    ) -> tuple[ConfigEntry, ...]:[0m
[30;1m308 | [0m[35m        """Return Config Entries for the given player."""[0m
[30;1m309 | [0m[35m        base_entries = await super().get_player_config_entries(self.player_id)[0m
[30;1m310 | [0m[35m        if not self.bluos_players.get(player_id):[0m
[30;1m311 | [0m[35m            # TODO fix player entries[0m
[30;1m312 | [0m[35m            return (*base_entries,)[0m
[30;1m313 | [0m[35m        return ([0m

[31m--[ [0m[34mMatch #[0m[33m535[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/bluesound/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m245 | [0m[35m            return[0m
[30;1m246 | [0m[35m[0m
[30;1m247 | [0m[35m        if bluos_player := self.bluos_players.get(self.player_id):[0m
[30;1m248 | [0m[35m            if mass_player := self.mass.players.get(self.player_id):[0m
[30;1m249 | [0m[35m                cur_address = get_primary_ip_address_from_zeroconf(info)[0m
[30;1m250 | [0m[35m                cur_port = get_port_from_zeroconf(info)[0m
[30;1m251 | [0m[35m                if cur_address and cur_address != mass_player.device_info.ip_address:[0m

[31m--[ [0m[34mMatch #[0m[33m536[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/bluesound/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m244 | [0m[35m                self.mass.players.update(self.player_id)[0m
[30;1m245 | [0m[35m            return[0m
[30;1m246 | [0m[35m[0m
[30;1m247 | [0m[35m        if bluos_player := self.bluos_players.get(self.player_id):[0m
[30;1m248 | [0m[35m            if mass_player := self.mass.players.get(self.player_id):[0m
[30;1m249 | [0m[35m                cur_address = get_primary_ip_address_from_zeroconf(info)[0m
[30;1m250 | [0m[35m                cur_port = get_port_from_zeroconf(info)[0m

[31m--[ [0m[34mMatch #[0m[33m537[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/bluesound/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m        if state_change == ServiceStateChange.Removed:[0m
[30;1m239 | [0m[35m            # Check if the player manager has an existing entry for this player[0m
[30;1m240 | [0m[35m            if mass_player := self.mass.players.get(self.player_id):[0m
[30;1m241 | [0m[35m                # The player has become unavailable[0m
[30;1m242 | [0m[35m                self.logger.debug("Player offline: %s", mass_player.display_name)[0m
[30;1m243 | [0m[35m                mass_player.available = False[0m

[31m--[ [0m[34mMatch #[0m[33m538[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/bluesound/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m326 | [0m[35m                bluos_player.poll_state = POLL_STATE_DYNAMIC[0m
[30;1m327 | [0m[35m                bluos_player.dynamic_poll_count = 6[0m
[30;1m328 | [0m[35m                bluos_player.mass_player.poll_interval = 0.5[0m
[30;1m329 | [0m[35m            # Update media info then optimistically override playback state and source[0m
[30;1m330 | [0m[35m[0m
[30;1m331 | [0m[35m    async def cmd_play(self, player_id: str) -> None:[0m
[30;1m332 | [0m[35m        """Send PLAY command to BluOS player."""[0m

[31m--[ [0m[34mMatch #[0m[33m539[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/bluesound/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m141 | [0m[35m        self.sync_status = await self.client.sync_status()[0m
[30;1m142 | [0m[35m        self.status = await self.client.status()[0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m        # Update timing[0m
[30;1m145 | [0m[35m        self.mass_player.elapsed_time = self.status.seconds[0m
[30;1m146 | [0m[35m        self.mass_player.elapsed_time_last_updated = time.time()[0m
[30;1m147 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m540[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/bluesound/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m230 | [0m[35m    async def on_mdns_service_state_change([0m
[30;1m231 | [0m[35m        self, name: str, state_change: ServiceStateChange, info: AsyncServiceInfo | None[0m
[30;1m232 | [0m[35m    ) -> None:[0m
[30;1m233 | [0m[35m        """Handle MDNS service state callback for BluOS."""[0m
[30;1m234 | [0m[35m        name = name.split(".", 1)[0][0m
[30;1m235 | [0m[35m        self.player_id = info.decoded_properties["mac"][0m
[30;1m236 | [0m[35m        # Handle removed player[0m

[31m--[ [0m[34mMatch #[0m[33m541[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/bluesound/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mfrom __future__ import annotations[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mimport asyncio[0m
[30;1m6 | [0m[35mimport time[0m
[30;1m7 | [0m[35mfrom typing import TYPE_CHECKING, TypedDict[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mfrom music_assistant_models.enums import PlayerFeature, PlayerState, PlayerType, ProviderFeature[0m
[30;1m10 | [0m[35mfrom music_assistant_models.errors import PlayerCommandFailed[0m

[31m--[ [0m[34mMatch #[0m[33m542[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m553 | [0m[35m    async def get_stream_details(self, item_id: str, media_type: MediaType) -> StreamDetails:[0m
[30;1m554 | [0m[35m        """Get streamdetails for a track/radio."""[0m
[30;1m555 | [0m[35m        media_info = await self._get_media_info(item_id)[0m
[30;1m556 | [0m[35m        is_radio = media_info.get("icy-name") or not media_info.duration[0m
[30;1m557 | [0m[35m        return StreamDetails([0m
[30;1m558 | [0m[35m            provider=self.instance_id,[0m
[30;1m559 | [0m[35m            item_id=item_id,[0m

[31m--[ [0m[34mMatch #[0m[33m543[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m536 | [0m[35m        cache_category = CACHE_CATEGORY_MEDIA_INFO[0m
[30;1m537 | [0m[35m        cache_base_key = self.lookup_key[0m
[30;1m538 | [0m[35m        # do we have some cached info for this url ?[0m
[30;1m539 | [0m[35m        cached_info = await self.mass.cache.get([0m
[30;1m540 | [0m[35m            url, category=cache_category, base_key=cache_base_key[0m
[30;1m541 | [0m[35m        )[0m
[30;1m542 | [0m[35m        if cached_info and not force_refresh:[0m

[31m--[ [0m[34mMatch #[0m[33m544[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m488 | [0m[35m                item_id=url,[0m
[30;1m489 | [0m[35m                provider=self.domain,[0m
[30;1m490 | [0m[35m                name=media_info.get("icyname")[0m
[30;1m491 | [0m[35m                or media_info.get("programtitle")[0m
[30;1m492 | [0m[35m                or media_info.title[0m
[30;1m493 | [0m[35m                or url,[0m
[30;1m494 | [0m[35m                provider_mappings=provider_mappings,[0m

[31m--[ [0m[34mMatch #[0m[33m545[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m487 | [0m[35m            media_item = Radio([0m
[30;1m488 | [0m[35m                item_id=url,[0m
[30;1m489 | [0m[35m                provider=self.domain,[0m
[30;1m490 | [0m[35m                name=media_info.get("icyname")[0m
[30;1m491 | [0m[35m                or media_info.get("programtitle")[0m
[30;1m492 | [0m[35m                or media_info.title[0m
[30;1m493 | [0m[35m                or url,[0m

[31m--[ [0m[34mMatch #[0m[33m546[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m467 | [0m[35m    ) -> Track | Radio:[0m
[30;1m468 | [0m[35m        """Parse plain URL to MediaItem of type Radio or Track."""[0m
[30;1m469 | [0m[35m        media_info = await self._get_media_info(url, force_refresh)[0m
[30;1m470 | [0m[35m        is_radio = media_info.get("icyname") or not media_info.duration[0m
[30;1m471 | [0m[35m        provider_mappings = {[0m
[30;1m472 | [0m[35m            ProviderMapping([0m
[30;1m473 | [0m[35m                item_id=url,[0m

[31m--[ [0m[34mMatch #[0m[33m547[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m454 | [0m[35m        """Create a new playlist on provider with given name."""[0m
[30;1m455 | [0m[35m        item_id = shortuuid.random(8)[0m
[30;1m456 | [0m[35m        stored_item = StoredItem(item_id=item_id, name=name)[0m
[30;1m457 | [0m[35m        stored_items: list[StoredItem] = self.mass.config.get(CONF_KEY_PLAYLISTS, [])[0m
[30;1m458 | [0m[35m        stored_items.append(stored_item)[0m
[30;1m459 | [0m[35m        self.mass.config.set(CONF_KEY_PLAYLISTS, stored_items)[0m
[30;1m460 | [0m[35m        return await self.get_playlist(item_id)[0m

[31m--[ [0m[34mMatch #[0m[33m548[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m444 | [0m[35m        # store playlist file[0m
[30;1m445 | [0m[35m        await self._write_playlist_file_items(prov_playlist_id, playlist_items)[0m
[30;1m446 | [0m[35m        # mark last_updated on playlist object[0m
[30;1m447 | [0m[35m        stored_items: list[StoredItem] = self.mass.config.get(CONF_KEY_PLAYLISTS, [])[0m
[30;1m448 | [0m[35m        stored_item = next((x for x in stored_items if x["item_id"] == prov_playlist_id), None)[0m
[30;1m449 | [0m[35m        if stored_item:[0m
[30;1m450 | [0m[35m            stored_item["last_updated"] = int(time.time())[0m

[31m--[ [0m[34mMatch #[0m[33m549[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m427 | [0m[35m        # store playlist file[0m
[30;1m428 | [0m[35m        await self._write_playlist_file_items(prov_playlist_id, playlist_items)[0m
[30;1m429 | [0m[35m        # mark last_updated on playlist object[0m
[30;1m430 | [0m[35m        stored_items: list[StoredItem] = self.mass.config.get(CONF_KEY_PLAYLISTS, [])[0m
[30;1m431 | [0m[35m        stored_item = next((x for x in stored_items if x["item_id"] == prov_playlist_id), None)[0m
[30;1m432 | [0m[35m        if stored_item:[0m
[30;1m433 | [0m[35m            stored_item["last_updated"] = int(time.time())[0m

[31m--[ [0m[34mMatch #[0m[33m550[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m380 | [0m[35m            key = CONF_KEY_PLAYLISTS[0m
[30;1m381 | [0m[35m        else:[0m
[30;1m382 | [0m[35m            return False[0m
[30;1m383 | [0m[35m        stored_items: list[StoredItem] = self.mass.config.get(key, [])[0m
[30;1m384 | [0m[35m        stored_items = [x for x in stored_items if x["item_id"] != prov_item_id][0m
[30;1m385 | [0m[35m        self.mass.config.set(key, stored_items)[0m
[30;1m386 | [0m[35m        return True[0m

[31m--[ [0m[34mMatch #[0m[33m551[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m355 | [0m[35m        stored_item = StoredItem(item_id=item.item_id, name=item.name)[0m
[30;1m356 | [0m[35m        if item.image:[0m
[30;1m357 | [0m[35m            stored_item["image_url"] = item.image.path[0m
[30;1m358 | [0m[35m        stored_items: list[StoredItem] = self.mass.config.get(key, [])[0m
[30;1m359 | [0m[35m        # filter out existing[0m
[30;1m360 | [0m[35m        stored_items = [x for x in stored_items if x["item_id"] != item.item_id][0m
[30;1m361 | [0m[35m        stored_items.append(stored_item)[0m

[31m--[ [0m[34mMatch #[0m[33m552[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m324 | [0m[35m[0m
[30;1m325 | [0m[35m    async def get_library_radios(self) -> AsyncGenerator[Radio, None]:[0m
[30;1m326 | [0m[35m        """Retrieve library/subscribed radio stations from the provider."""[0m
[30;1m327 | [0m[35m        stored_items: list[StoredItem] = self.mass.config.get(CONF_KEY_RADIOS, [])[0m
[30;1m328 | [0m[35m        for item in stored_items:[0m
[30;1m329 | [0m[35m            try:[0m
[30;1m330 | [0m[35m                yield await self.get_radio(item["item_id"])[0m

[31m--[ [0m[34mMatch #[0m[33m553[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m313 | [0m[35m    async def get_library_playlists(self) -> AsyncGenerator[Playlist, None]:[0m
[30;1m314 | [0m[35m        """Retrieve library/subscribed playlists from the provider."""[0m
[30;1m315 | [0m[35m        # return user stored playlists[0m
[30;1m316 | [0m[35m        stored_items: list[StoredItem] = self.mass.config.get(CONF_KEY_PLAYLISTS, [])[0m
[30;1m317 | [0m[35m        for item in stored_items:[0m
[30;1m318 | [0m[35m            yield await self.get_playlist(item["item_id"])[0m
[30;1m319 | [0m[35m        # return builtin playlists[0m

[31m--[ [0m[34mMatch #[0m[33m554[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m303 | [0m[35m[0m
[30;1m304 | [0m[35m    async def get_library_tracks(self) -> AsyncGenerator[Track, None]:[0m
[30;1m305 | [0m[35m        """Retrieve library tracks from the provider."""[0m
[30;1m306 | [0m[35m        stored_items: list[StoredItem] = self.mass.config.get(CONF_KEY_TRACKS, [])[0m
[30;1m307 | [0m[35m        for item in stored_items:[0m
[30;1m308 | [0m[35m            try:[0m
[30;1m309 | [0m[35m                yield await self.get_track(item["item_id"])[0m

[31m--[ [0m[34mMatch #[0m[33m555[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m276 | [0m[35m            is_editable=True,[0m
[30;1m277 | [0m[35m        )[0m
[30;1m278 | [0m[35m        playlist.cache_checksum = str(stored_item.get("last_updated"))[0m
[30;1m279 | [0m[35m        if image_url := stored_item.get("image_url"):[0m
[30;1m280 | [0m[35m            playlist.metadata.add_image([0m
[30;1m281 | [0m[35m                MediaItemImage([0m
[30;1m282 | [0m[35m                    type=ImageType.THUMB,[0m

[31m--[ [0m[34mMatch #[0m[33m556[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m275 | [0m[35m            owner="Music Assistant",[0m
[30;1m276 | [0m[35m            is_editable=True,[0m
[30;1m277 | [0m[35m        )[0m
[30;1m278 | [0m[35m        playlist.cache_checksum = str(stored_item.get("last_updated"))[0m
[30;1m279 | [0m[35m        if image_url := stored_item.get("image_url"):[0m
[30;1m280 | [0m[35m            playlist.metadata.add_image([0m
[30;1m281 | [0m[35m                MediaItemImage([0m

[31m--[ [0m[34mMatch #[0m[33m557[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m257 | [0m[35m                ),[0m
[30;1m258 | [0m[35m            )[0m
[30;1m259 | [0m[35m        # user created universal playlist[0m
[30;1m260 | [0m[35m        stored_items: list[StoredItem] = self.mass.config.get(CONF_KEY_PLAYLISTS, [])[0m
[30;1m261 | [0m[35m        stored_item = next((x for x in stored_items if x["item_id"] == prov_playlist_id), None)[0m
[30;1m262 | [0m[35m        if not stored_item:[0m
[30;1m263 | [0m[35m            raise MediaNotFoundError[0m

[31m--[ [0m[34mMatch #[0m[33m558[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m203 | [0m[35m        if stored_item := next((x for x in stored_items if x["item_id"] == prov_radio_id), None):[0m
[30;1m204 | [0m[35m            # always prefer the stored info, such as the name[0m
[30;1m205 | [0m[35m            parsed_item.name = stored_item["name"][0m
[30;1m206 | [0m[35m            if image_url := stored_item.get("image_url"):[0m
[30;1m207 | [0m[35m                parsed_item.metadata.add_image([0m
[30;1m208 | [0m[35m                    MediaItemImage([0m
[30;1m209 | [0m[35m                        type=ImageType.THUMB,[0m

[31m--[ [0m[34mMatch #[0m[33m559[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m199 | [0m[35m        """Get full radio details by id."""[0m
[30;1m200 | [0m[35m        parsed_item = await self.parse_item(prov_radio_id, force_radio=True)[0m
[30;1m201 | [0m[35m        assert isinstance(parsed_item, Radio)[0m
[30;1m202 | [0m[35m        stored_items: list[StoredItem] = self.mass.config.get(CONF_KEY_RADIOS, [])[0m
[30;1m203 | [0m[35m        if stored_item := next((x for x in stored_items if x["item_id"] == prov_radio_id), None):[0m
[30;1m204 | [0m[35m            # always prefer the stored info, such as the name[0m
[30;1m205 | [0m[35m            parsed_item.name = stored_item["name"][0m

[31m--[ [0m[34mMatch #[0m[33m560[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m184 | [0m[35m        if stored_item := next((x for x in stored_items if x["item_id"] == prov_track_id), None):[0m
[30;1m185 | [0m[35m            # always prefer the stored info, such as the name[0m
[30;1m186 | [0m[35m            parsed_item.name = stored_item["name"][0m
[30;1m187 | [0m[35m            if image_url := stored_item.get("image_url"):[0m
[30;1m188 | [0m[35m                parsed_item.metadata.add_image([0m
[30;1m189 | [0m[35m                    MediaItemImage([0m
[30;1m190 | [0m[35m                        type=ImageType.THUMB,[0m

[31m--[ [0m[34mMatch #[0m[33m561[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m180 | [0m[35m    async def get_track(self, prov_track_id: str) -> Track:[0m
[30;1m181 | [0m[35m        """Get full track details by id."""[0m
[30;1m182 | [0m[35m        parsed_item = cast("Track", await self.parse_item(prov_track_id))[0m
[30;1m183 | [0m[35m        stored_items: list[StoredItem] = self.mass.config.get(CONF_KEY_TRACKS, [])[0m
[30;1m184 | [0m[35m        if stored_item := next((x for x in stored_items if x["item_id"] == prov_track_id), None):[0m
[30;1m185 | [0m[35m            # always prefer the stored info, such as the name[0m
[30;1m186 | [0m[35m            parsed_item.name = stored_item["name"][0m

[31m--[ [0m[34mMatch #[0m[33m562[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m388 | [0m[35m    async def get_playlist_tracks(self, prov_playlist_id: str, page: int = 0) -> list[Track]:[0m
[30;1m389 | [0m[35m        """Get playlist tracks."""[0m
[30;1m390 | [0m[35m        if page > 0:[0m
[30;1m391 | [0m[35m            # paging not supported, we always return the whole list at once[0m
[30;1m392 | [0m[35m            return [][0m
[30;1m393 | [0m[35m        if prov_playlist_id in BUILTIN_PLAYLISTS:[0m
[30;1m394 | [0m[35m            return await self._get_builtin_playlist_tracks(prov_playlist_id)[0m

[31m--[ [0m[34mMatch #[0m[33m563[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mimport asyncio[0m
[30;1m6 | [0m[35mimport os[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35mfrom collections.abc import AsyncGenerator[0m
[30;1m9 | [0m[35mfrom typing import TYPE_CHECKING, NotRequired, TypedDict, cast[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mimport aiofiles[0m

[31m--[ [0m[34mMatch #[0m[33m564[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/musicbrainz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m411 | [0m[35m        ):[0m
[30;1m412 | [0m[35m            # handle rate limiter[0m
[30;1m413 | [0m[35m            if response.status == 429:[0m
[30;1m414 | [0m[35m                backoff_time = int(response.headers.get("Retry-After", 0))[0m
[30;1m415 | [0m[35m                raise ResourceTemporarilyUnavailable("Rate Limiter", backoff_time=backoff_time)[0m
[30;1m416 | [0m[35m            # handle temporary server error[0m
[30;1m417 | [0m[35m            if response.status in (502, 503):[0m

[31m--[ [0m[34mMatch #[0m[33m565[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/musicbrainz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m407 | [0m[35m        }[0m
[30;1m408 | [0m[35m        kwargs["fmt"] = "json"[0m
[30;1m409 | [0m[35m        async with ([0m
[30;1m410 | [0m[35m            self.mass.http_session.get(url, headers=headers, params=kwargs) as response,[0m
[30;1m411 | [0m[35m        ):[0m
[30;1m412 | [0m[35m            # handle rate limiter[0m
[30;1m413 | [0m[35m            if response.status == 429:[0m

[31m--[ [0m[34mMatch #[0m[33m566[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/musicbrainz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m392 | [0m[35m        """[0m
[30;1m393 | [0m[35m        if result := await self.get_data("url", resource=resource_url, inc="artist-rels"):[0m
[30;1m394 | [0m[35m            for relation in result.get("relations", []):[0m
[30;1m395 | [0m[35m                if not (artist := relation.get("artist")):[0m
[30;1m396 | [0m[35m                    continue[0m
[30;1m397 | [0m[35m                return MusicBrainzArtist.from_dict(replace_hyphens(artist))[0m
[30;1m398 | [0m[35m        return None[0m

[31m--[ [0m[34mMatch #[0m[33m567[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/musicbrainz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m391 | [0m[35m        MusicBrainzArtist object that is returned does not contain the optional data.[0m
[30;1m392 | [0m[35m        """[0m
[30;1m393 | [0m[35m        if result := await self.get_data("url", resource=resource_url, inc="artist-rels"):[0m
[30;1m394 | [0m[35m            for relation in result.get("relations", []):[0m
[30;1m395 | [0m[35m                if not (artist := relation.get("artist")):[0m
[30;1m396 | [0m[35m                    continue[0m
[30;1m397 | [0m[35m                return MusicBrainzArtist.from_dict(replace_hyphens(artist))[0m

[31m--[ [0m[34mMatch #[0m[33m568[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/musicbrainz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m250 | [0m[35m                                replace_hyphens(artist["artist"])[0m
[30;1m251 | [0m[35m                            )[0m
[30;1m252 | [0m[35m                        else:[0m
[30;1m253 | [0m[35m                            for alias in artist["artist"].get("aliases", []):[0m
[30;1m254 | [0m[35m                                if compare_strings(alias["name"], artistname, strict):[0m
[30;1m255 | [0m[35m                                    artist_match = MusicBrainzArtist.from_dict([0m
[30;1m256 | [0m[35m                                        replace_hyphens(artist["artist"])[0m

[31m--[ [0m[34mMatch #[0m[33m569[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/musicbrainz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m239 | [0m[35m                    if ([0m
[30;1m240 | [0m[35m                        trackversion[0m
[30;1m241 | [0m[35m                        and trackversion not in searchtrack[0m
[30;1m242 | [0m[35m                        and not compare_strings(item.get("disambiguation"), trackversion, strict)[0m
[30;1m243 | [0m[35m                    ):[0m
[30;1m244 | [0m[35m                        continue[0m
[30;1m245 | [0m[35m                    # match (primary) track artist[0m

[31m--[ [0m[34mMatch #[0m[33m570[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/musicbrainz/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m"""The Musicbrainz Metadata provider for Music Assistant.[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mAt this time only used for retrieval of ID's but to be expanded to fetch metadata too.[0m
[30;1m4 | [0m[35m"""[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom __future__ import annotations[0m

[31m--[ [0m[34mMatch #[0m[33m571[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/musicbrainz/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m"""The Musicbrainz Metadata provider for Music Assistant.[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mAt this time only used for retrieval of ID's but to be expanded to fetch metadata too.[0m
[30;1m4 | [0m[35m"""[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom __future__ import annotations[0m

[31m--[ [0m[34mMatch #[0m[33m572[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/podcastfeed/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m217 | [0m[35m        return podcastparser.parse(self.feed_url, feed_stream)  # type:ignore [no-any-return][0m
[30;1m218 | [0m[35m[0m
[30;1m219 | [0m[35m    async def _cache_get_podcast(self) -> dict[str, Any]:[0m
[30;1m220 | [0m[35m        parsed_podcast = await self.mass.cache.get([0m
[30;1m221 | [0m[35m            key=self.podcast_id,[0m
[30;1m222 | [0m[35m            base_key=self.lookup_key,[0m
[30;1m223 | [0m[35m            category=CACHE_CATEGORY_PODCASTS,[0m

[31m--[ [0m[34mMatch #[0m[33m573[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/podcastfeed/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m207 | [0m[35m        # without user agent, some feeds can not be retrieved[0m
[30;1m208 | [0m[35m        # https://github.com/music-assistant/support/issues/3596[0m
[30;1m209 | [0m[35m        assert self.feed_url is not None[0m
[30;1m210 | [0m[35m        response = await self.mass.http_session.get([0m
[30;1m211 | [0m[35m            self.feed_url, headers={"User-Agent": "Mozilla/5.0"}[0m
[30;1m212 | [0m[35m        )[0m
[30;1m213 | [0m[35m        if response.status != 200:[0m

[31m--[ [0m[34mMatch #[0m[33m574[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/podcastfeed/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m196 | [0m[35m            episode=episode_obj,[0m
[30;1m197 | [0m[35m            prov_podcast_id=self.podcast_id,[0m
[30;1m198 | [0m[35m            episode_cnt=fallback_position,[0m
[30;1m199 | [0m[35m            podcast_cover=self.parsed_podcast.get("cover_url"),[0m
[30;1m200 | [0m[35m            lookup_key=self.lookup_key,[0m
[30;1m201 | [0m[35m            domain=self.domain,[0m
[30;1m202 | [0m[35m            instance_id=self.instance_id,[0m

[31m--[ [0m[34mMatch #[0m[33m575[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/podcastfeed/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m154 | [0m[35m        # sort episodes by published date[0m
[30;1m155 | [0m[35m        episodes: list[dict[str, Any]] = self.parsed_podcast["episodes"][0m
[30;1m156 | [0m[35m        if episodes and episodes[0].get("published", 0) != 0:[0m
[30;1m157 | [0m[35m            episodes.sort(key=lambda x: x.get("published", 0))[0m
[30;1m158 | [0m[35m        for idx, episode in enumerate(episodes):[0m
[30;1m159 | [0m[35m            yield await self._parse_episode(episode, idx)[0m
[30;1m160 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m576[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/podcastfeed/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m153 | [0m[35m            raise Exception(f"Podcast id not in provider: {prov_podcast_id}")[0m
[30;1m154 | [0m[35m        # sort episodes by published date[0m
[30;1m155 | [0m[35m        episodes: list[dict[str, Any]] = self.parsed_podcast["episodes"][0m
[30;1m156 | [0m[35m        if episodes and episodes[0].get("published", 0) != 0:[0m
[30;1m157 | [0m[35m            episodes.sort(key=lambda x: x.get("published", 0))[0m
[30;1m158 | [0m[35m        for idx, episode in enumerate(episodes):[0m
[30;1m159 | [0m[35m            yield await self._parse_episode(episode, idx)[0m

[31m--[ [0m[34mMatch #[0m[33m577[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/podcastfeed/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m    @property[0m
[30;1m119 | [0m[35m    def instance_name_postfix(self) -> str | None:[0m
[30;1m120 | [0m[35m        """Return a (default) instance name postfix for this provider instance."""[0m
[30;1m121 | [0m[35m        return self.parsed_podcast.get("title")[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m    async def get_library_podcasts(self) -> AsyncGenerator[Podcast, None]:[0m
[30;1m124 | [0m[35m        """Retrieve library/subscribed podcasts from the provider."""[0m

[31m--[ [0m[34mMatch #[0m[33m578[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/podcastfeed/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m151 | [0m[35m        """List all episodes for the podcast."""[0m
[30;1m152 | [0m[35m        if prov_podcast_id != self.podcast_id:[0m
[30;1m153 | [0m[35m            raise Exception(f"Podcast id not in provider: {prov_podcast_id}")[0m
[30;1m154 | [0m[35m        # sort episodes by published date[0m
[30;1m155 | [0m[35m        episodes: list[dict[str, Any]] = self.parsed_podcast["episodes"][0m
[30;1m156 | [0m[35m        if episodes and episodes[0].get("published", 0) != 0:[0m
[30;1m157 | [0m[35m            episodes.sort(key=lambda x: x.get("published", 0))[0m

[31m--[ [0m[34mMatch #[0m[33m579[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/itunes_podcasts/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m387 | [0m[35m        # https://rss.marketingtools.apple.com/[0m
[30;1m388 | [0m[35m        country = str(self.config.get_value(CONF_LOCALE))[0m
[30;1m389 | [0m[35m        url = f"https://rss.marketingtools.apple.com/api/v2/{country}/podcasts/top/15/podcasts.json"[0m
[30;1m390 | [0m[35m        response = await self.mass.http_session.get(url)[0m
[30;1m391 | [0m[35m        json_response = b""[0m
[30;1m392 | [0m[35m        if response.status == 200:[0m
[30;1m393 | [0m[35m            json_response = await response.read()[0m

[31m--[ [0m[34mMatch #[0m[33m580[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/itunes_podcasts/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m373 | [0m[35m        )[0m
[30;1m374 | [0m[35m[0m
[30;1m375 | [0m[35m    async def _cache_get_top_podcasts(self) -> list[PodcastSearchResult]:[0m
[30;1m376 | [0m[35m        parsed_top_podcasts = await self.mass.cache.get([0m
[30;1m377 | [0m[35m            key=CACHE_KEY_TOP_PODCASTS,[0m
[30;1m378 | [0m[35m            base_key=self.lookup_key,[0m
[30;1m379 | [0m[35m            category=CACHE_CATEGORY_RECOMMENDATIONS,[0m

[31m--[ [0m[34mMatch #[0m[33m581[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/itunes_podcasts/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m339 | [0m[35m        )[0m
[30;1m340 | [0m[35m        if parsed_podcast is None:[0m
[30;1m341 | [0m[35m            # see music-assistant/server@6aae82e[0m
[30;1m342 | [0m[35m            response = await self.mass.http_session.get([0m
[30;1m343 | [0m[35m                prov_podcast_id, headers={"User-Agent": "Mozilla/5.0"}[0m
[30;1m344 | [0m[35m            )[0m
[30;1m345 | [0m[35m            if response.status != 200:[0m

[31m--[ [0m[34mMatch #[0m[33m582[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/itunes_podcasts/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m331 | [0m[35m        return search_results.results[0][0m
[30;1m332 | [0m[35m[0m
[30;1m333 | [0m[35m    async def _cache_get_podcast(self, prov_podcast_id: str) -> dict[str, Any]:[0m
[30;1m334 | [0m[35m        parsed_podcast = await self.mass.cache.get([0m
[30;1m335 | [0m[35m            key=prov_podcast_id,[0m
[30;1m336 | [0m[35m            base_key=self.lookup_key,[0m
[30;1m337 | [0m[35m            category=CACHE_CATEGORY_PODCASTS,[0m

[31m--[ [0m[34mMatch #[0m[33m583[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/itunes_podcasts/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m317 | [0m[35m    ) -> PodcastSearchResult:[0m
[30;1m318 | [0m[35m        params = {"id": itunes_id}[0m
[30;1m319 | [0m[35m        url = "https://itunes.apple.com/lookup?"[0m
[30;1m320 | [0m[35m        response = await self.mass.http_session.get(url, params=params)[0m
[30;1m321 | [0m[35m        json_response = b""[0m
[30;1m322 | [0m[35m        if response.status == 200:[0m
[30;1m323 | [0m[35m            json_response = await response.read()[0m

[31m--[ [0m[34mMatch #[0m[33m584[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/itunes_podcasts/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m288 | [0m[35m            if len(episode_enclosures) < 1:[0m
[30;1m289 | [0m[35m                raise MediaNotFoundError[0m
[30;1m290 | [0m[35m            stream_url: str | None = episode_enclosures[0].get("url", None)[0m
[30;1m291 | [0m[35m            if guid_or_stream_url == episode.get("guid", stream_url):[0m
[30;1m292 | [0m[35m                return stream_url[0m
[30;1m293 | [0m[35m        return None[0m
[30;1m294 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m585[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/itunes_podcasts/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m287 | [0m[35m            episode_enclosures = episode.get("enclosures", [])[0m
[30;1m288 | [0m[35m            if len(episode_enclosures) < 1:[0m
[30;1m289 | [0m[35m                raise MediaNotFoundError[0m
[30;1m290 | [0m[35m            stream_url: str | None = episode_enclosures[0].get("url", None)[0m
[30;1m291 | [0m[35m            if guid_or_stream_url == episode.get("guid", stream_url):[0m
[30;1m292 | [0m[35m                return stream_url[0m
[30;1m293 | [0m[35m        return None[0m

[31m--[ [0m[34mMatch #[0m[33m586[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/itunes_podcasts/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m284 | [0m[35m        podcast = await self._cache_get_podcast(podcast_id)[0m
[30;1m285 | [0m[35m        episodes = podcast.get("episodes", [])[0m
[30;1m286 | [0m[35m        for cnt, episode in enumerate(episodes):[0m
[30;1m287 | [0m[35m            episode_enclosures = episode.get("enclosures", [])[0m
[30;1m288 | [0m[35m            if len(episode_enclosures) < 1:[0m
[30;1m289 | [0m[35m                raise MediaNotFoundError[0m
[30;1m290 | [0m[35m            stream_url: str | None = episode_enclosures[0].get("url", None)[0m

[31m--[ [0m[34mMatch #[0m[33m587[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/itunes_podcasts/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m282 | [0m[35m[0m
[30;1m283 | [0m[35m    async def _get_episode_stream_url(self, podcast_id: str, guid_or_stream_url: str) -> str | None:[0m
[30;1m284 | [0m[35m        podcast = await self._cache_get_podcast(podcast_id)[0m
[30;1m285 | [0m[35m        episodes = podcast.get("episodes", [])[0m
[30;1m286 | [0m[35m        for cnt, episode in enumerate(episodes):[0m
[30;1m287 | [0m[35m            episode_enclosures = episode.get("enclosures", [])[0m
[30;1m288 | [0m[35m            if len(episode_enclosures) < 1:[0m

[31m--[ [0m[34mMatch #[0m[33m588[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/itunes_podcasts/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m249 | [0m[35m            if len(episode_enclosures) < 1:[0m
[30;1m250 | [0m[35m                raise MediaNotFoundError[0m
[30;1m251 | [0m[35m            stream_url = episode_enclosures[0].get("url", None)[0m
[30;1m252 | [0m[35m            if guid_or_stream_url == episode.get("guid", stream_url):[0m
[30;1m253 | [0m[35m                return parse_podcast_episode([0m
[30;1m254 | [0m[35m                    episode=episode,[0m
[30;1m255 | [0m[35m                    prov_podcast_id=prov_podcast_id,[0m

[31m--[ [0m[34mMatch #[0m[33m589[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/itunes_podcasts/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m248 | [0m[35m            episode_enclosures = episode.get("enclosures", [])[0m
[30;1m249 | [0m[35m            if len(episode_enclosures) < 1:[0m
[30;1m250 | [0m[35m                raise MediaNotFoundError[0m
[30;1m251 | [0m[35m            stream_url = episode_enclosures[0].get("url", None)[0m
[30;1m252 | [0m[35m            if guid_or_stream_url == episode.get("guid", stream_url):[0m
[30;1m253 | [0m[35m                return parse_podcast_episode([0m
[30;1m254 | [0m[35m                    episode=episode,[0m

[31m--[ [0m[34mMatch #[0m[33m590[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/itunes_podcasts/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m245 | [0m[35m        podcast_cover = podcast.get("cover_url")[0m
[30;1m246 | [0m[35m        episodes = podcast.get("episodes", [])[0m
[30;1m247 | [0m[35m        for cnt, episode in enumerate(episodes):[0m
[30;1m248 | [0m[35m            episode_enclosures = episode.get("enclosures", [])[0m
[30;1m249 | [0m[35m            if len(episode_enclosures) < 1:[0m
[30;1m250 | [0m[35m                raise MediaNotFoundError[0m
[30;1m251 | [0m[35m            stream_url = episode_enclosures[0].get("url", None)[0m

[31m--[ [0m[34mMatch #[0m[33m591[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/itunes_podcasts/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m243 | [0m[35m        prov_podcast_id, guid_or_stream_url = prov_episode_id.split(" ")[0m
[30;1m244 | [0m[35m        podcast = await self._cache_get_podcast(prov_podcast_id)[0m
[30;1m245 | [0m[35m        podcast_cover = podcast.get("cover_url")[0m
[30;1m246 | [0m[35m        episodes = podcast.get("episodes", [])[0m
[30;1m247 | [0m[35m        for cnt, episode in enumerate(episodes):[0m
[30;1m248 | [0m[35m            episode_enclosures = episode.get("enclosures", [])[0m
[30;1m249 | [0m[35m            if len(episode_enclosures) < 1:[0m

[31m--[ [0m[34mMatch #[0m[33m592[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/itunes_podcasts/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m242 | [0m[35m        """Get single podcast episode."""[0m
[30;1m243 | [0m[35m        prov_podcast_id, guid_or_stream_url = prov_episode_id.split(" ")[0m
[30;1m244 | [0m[35m        podcast = await self._cache_get_podcast(prov_podcast_id)[0m
[30;1m245 | [0m[35m        podcast_cover = podcast.get("cover_url")[0m
[30;1m246 | [0m[35m        episodes = podcast.get("episodes", [])[0m
[30;1m247 | [0m[35m        for cnt, episode in enumerate(episodes):[0m
[30;1m248 | [0m[35m            episode_enclosures = episode.get("enclosures", [])[0m

[31m--[ [0m[34mMatch #[0m[33m593[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/itunes_podcasts/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m226 | [0m[35m        """Get podcast episodes."""[0m
[30;1m227 | [0m[35m        podcast = await self._cache_get_podcast(prov_podcast_id)[0m
[30;1m228 | [0m[35m        podcast_cover = podcast.get("cover_url")[0m
[30;1m229 | [0m[35m        episodes = podcast.get("episodes", [])[0m
[30;1m230 | [0m[35m        for cnt, episode in enumerate(episodes):[0m
[30;1m231 | [0m[35m            yield parse_podcast_episode([0m
[30;1m232 | [0m[35m                episode=episode,[0m

[31m--[ [0m[34mMatch #[0m[33m594[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/itunes_podcasts/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m225 | [0m[35m    ) -> AsyncGenerator[PodcastEpisode, None]:[0m
[30;1m226 | [0m[35m        """Get podcast episodes."""[0m
[30;1m227 | [0m[35m        podcast = await self._cache_get_podcast(prov_podcast_id)[0m
[30;1m228 | [0m[35m        podcast_cover = podcast.get("cover_url")[0m
[30;1m229 | [0m[35m        episodes = podcast.get("episodes", [])[0m
[30;1m230 | [0m[35m        for cnt, episode in enumerate(episodes):[0m
[30;1m231 | [0m[35m            yield parse_podcast_episode([0m

[31m--[ [0m[34mMatch #[0m[33m595[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/itunes_podcasts/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35m    @throttle_with_retries[0m
[30;1m166 | [0m[35m    async def _perform_search(self, url: str, params: dict[str, str | int]) -> list[Podcast]:[0m
[30;1m167 | [0m[35m        response = await self.mass.http_session.get(url, params=params)[0m
[30;1m168 | [0m[35m        json_response = b""[0m
[30;1m169 | [0m[35m        if response.status == 200:[0m
[30;1m170 | [0m[35m            json_response = await response.read()[0m

[31m--[ [0m[34mMatch #[0m[33m596[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/itunes_podcasts/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m265 | [0m[35m    async def recommendations(self) -> list[RecommendationFolder]:[0m
[30;1m266 | [0m[35m        """Get recommendations.[0m
[30;1m267 | [0m[35m[0m
[30;1m268 | [0m[35m        This provider uses a list of top podcasts for the configured country.[0m
[30;1m269 | [0m[35m        """[0m
[30;1m270 | [0m[35m        search_results = await self._cache_get_top_podcasts()[0m
[30;1m271 | [0m[35m        podcast_list = self._get_podcast_list(search_results)[0m

[31m--[ [0m[34mMatch #[0m[33m597[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/jellyfin/parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m288 | [0m[35m) -> UniqueList[MediaItemImage]:[0m
[30;1m289 | [0m[35m    images: UniqueList[MediaItemImage] = UniqueList()[0m
[30;1m290 | [0m[35m[0m
[30;1m291 | [0m[35m    for i, _ in enumerate(media_item.get("BackdropImageTags", [])):[0m
[30;1m292 | [0m[35m        images.append([0m
[30;1m293 | [0m[35m            MediaItemImage([0m
[30;1m294 | [0m[35m                type=ImageType.FANART,[0m

[31m--[ [0m[34mMatch #[0m[33m598[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/jellyfin/parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m278 | [0m[35m        playlist.metadata.description = jellyfin_playlist[ITEM_KEY_OVERVIEW][0m
[30;1m279 | [0m[35m    playlist.metadata.images = _get_artwork(instance_id, client, jellyfin_playlist)[0m
[30;1m280 | [0m[35m    user_data = jellyfin_playlist.get(ITEM_KEY_USER_DATA, {})[0m
[30;1m281 | [0m[35m    playlist.favorite = user_data.get(USER_DATA_KEY_IS_FAVORITE, False)[0m
[30;1m282 | [0m[35m    playlist.is_editable = False[0m
[30;1m283 | [0m[35m    return playlist[0m
[30;1m284 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m599[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/jellyfin/parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m277 | [0m[35m    if ITEM_KEY_OVERVIEW in jellyfin_playlist:[0m
[30;1m278 | [0m[35m        playlist.metadata.description = jellyfin_playlist[ITEM_KEY_OVERVIEW][0m
[30;1m279 | [0m[35m    playlist.metadata.images = _get_artwork(instance_id, client, jellyfin_playlist)[0m
[30;1m280 | [0m[35m    user_data = jellyfin_playlist.get(ITEM_KEY_USER_DATA, {})[0m
[30;1m281 | [0m[35m    playlist.favorite = user_data.get(USER_DATA_KEY_IS_FAVORITE, False)[0m
[30;1m282 | [0m[35m    playlist.is_editable = False[0m
[30;1m283 | [0m[35m    return playlist[0m

[31m--[ [0m[34mMatch #[0m[33m600[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/jellyfin/parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m253 | [0m[35m                exc_info=error if logger.isEnabledFor(logging.DEBUG) else None,[0m
[30;1m254 | [0m[35m            )[0m
[30;1m255 | [0m[35m    user_data = jellyfin_track.get(ITEM_KEY_USER_DATA, {})[0m
[30;1m256 | [0m[35m    track.favorite = user_data.get(USER_DATA_KEY_IS_FAVORITE, False)[0m
[30;1m257 | [0m[35m    return track[0m
[30;1m258 | [0m[35m[0m
[30;1m259 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m601[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/jellyfin/parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m252 | [0m[35m                track.name,[0m
[30;1m253 | [0m[35m                exc_info=error if logger.isEnabledFor(logging.DEBUG) else None,[0m
[30;1m254 | [0m[35m            )[0m
[30;1m255 | [0m[35m    user_data = jellyfin_track.get(ITEM_KEY_USER_DATA, {})[0m
[30;1m256 | [0m[35m    track.favorite = user_data.get(USER_DATA_KEY_IS_FAVORITE, False)[0m
[30;1m257 | [0m[35m    return track[0m
[30;1m258 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m602[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/jellyfin/parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m228 | [0m[35m        track.artists.append(UNKNOWN_ARTIST_MAPPING)[0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35m    if ITEM_KEY_ALBUM_ID in jellyfin_track:[0m
[30;1m231 | [0m[35m        if not (album_name := jellyfin_track.get(ITEM_KEY_ALBUM)):[0m
[30;1m232 | [0m[35m            logger.debug("Track %s has AlbumID but no AlbumName", track.name)[0m
[30;1m233 | [0m[35m            album_name = f"Unknown Album ({jellyfin_track[ITEM_KEY_ALBUM_ID]})"[0m
[30;1m234 | [0m[35m        track.album = ItemMapping([0m

[31m--[ [0m[34mMatch #[0m[33m603[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/jellyfin/parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m208 | [0m[35m    )[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m    track.disc_number = jellyfin_track.get(ITEM_KEY_PARENT_INDEX_NUM, 0)[0m
[30;1m211 | [0m[35m    track.track_number = jellyfin_track.get("IndexNumber", 0)[0m
[30;1m212 | [0m[35m    if track.track_number is not None and track.track_number >= 0:[0m
[30;1m213 | [0m[35m        track.position = track.track_number[0m
[30;1m214 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m604[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/jellyfin/parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m207 | [0m[35m        },[0m
[30;1m208 | [0m[35m    )[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m    track.disc_number = jellyfin_track.get(ITEM_KEY_PARENT_INDEX_NUM, 0)[0m
[30;1m211 | [0m[35m    track.track_number = jellyfin_track.get("IndexNumber", 0)[0m
[30;1m212 | [0m[35m    if track.track_number is not None and track.track_number >= 0:[0m
[30;1m213 | [0m[35m        track.position = track.track_number[0m

[31m--[ [0m[34mMatch #[0m[33m605[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/jellyfin/parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m181 | [0m[35m        channels=stream[ITEM_KEY_MEDIA_CHANNELS],[0m
[30;1m182 | [0m[35m        sample_rate=stream.get("SampleRate", 44100),[0m
[30;1m183 | [0m[35m        bit_rate=stream.get("BitRate"),[0m
[30;1m184 | [0m[35m        bit_depth=stream.get("BitDepth", 16),[0m
[30;1m185 | [0m[35m    )[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m606[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/jellyfin/parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m180 | [0m[35m        content_type=(ContentType.try_parse(codec) if codec else ContentType.UNKNOWN),[0m
[30;1m181 | [0m[35m        channels=stream[ITEM_KEY_MEDIA_CHANNELS],[0m
[30;1m182 | [0m[35m        sample_rate=stream.get("SampleRate", 44100),[0m
[30;1m183 | [0m[35m        bit_rate=stream.get("BitRate"),[0m
[30;1m184 | [0m[35m        bit_depth=stream.get("BitDepth", 16),[0m
[30;1m185 | [0m[35m    )[0m
[30;1m186 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m607[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/jellyfin/parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m179 | [0m[35m    return AudioFormat([0m
[30;1m180 | [0m[35m        content_type=(ContentType.try_parse(codec) if codec else ContentType.UNKNOWN),[0m
[30;1m181 | [0m[35m        channels=stream[ITEM_KEY_MEDIA_CHANNELS],[0m
[30;1m182 | [0m[35m        sample_rate=stream.get("SampleRate", 44100),[0m
[30;1m183 | [0m[35m        bit_rate=stream.get("BitRate"),[0m
[30;1m184 | [0m[35m        bit_depth=stream.get("BitDepth", 16),[0m
[30;1m185 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m608[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/jellyfin/parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m168 | [0m[35m        artist.sort_name = jellyfin_artist[ITEM_KEY_SORT_NAME][0m
[30;1m169 | [0m[35m    artist.metadata.images = _get_artwork(instance_id, connection, jellyfin_artist)[0m
[30;1m170 | [0m[35m    user_data = jellyfin_artist.get(ITEM_KEY_USER_DATA, {})[0m
[30;1m171 | [0m[35m    artist.favorite = user_data.get(USER_DATA_KEY_IS_FAVORITE, False)[0m
[30;1m172 | [0m[35m    return artist[0m
[30;1m173 | [0m[35m[0m
[30;1m174 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m609[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/jellyfin/parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m167 | [0m[35m    if ITEM_KEY_SORT_NAME in jellyfin_artist:[0m
[30;1m168 | [0m[35m        artist.sort_name = jellyfin_artist[ITEM_KEY_SORT_NAME][0m
[30;1m169 | [0m[35m    artist.metadata.images = _get_artwork(instance_id, connection, jellyfin_artist)[0m
[30;1m170 | [0m[35m    user_data = jellyfin_artist.get(ITEM_KEY_USER_DATA, {})[0m
[30;1m171 | [0m[35m    artist.favorite = user_data.get(USER_DATA_KEY_IS_FAVORITE, False)[0m
[30;1m172 | [0m[35m    return artist[0m
[30;1m173 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m610[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/jellyfin/parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m132 | [0m[35m        album.artists.append(UNKNOWN_ARTIST_MAPPING)[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m    user_data = jellyfin_album.get(ITEM_KEY_USER_DATA, {})[0m
[30;1m135 | [0m[35m    album.favorite = user_data.get(USER_DATA_KEY_IS_FAVORITE, False)[0m
[30;1m136 | [0m[35m    return album[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m611[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/jellyfin/parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m131 | [0m[35m    else:[0m
[30;1m132 | [0m[35m        album.artists.append(UNKNOWN_ARTIST_MAPPING)[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m    user_data = jellyfin_album.get(ITEM_KEY_USER_DATA, {})[0m
[30;1m135 | [0m[35m    album.favorite = user_data.get(USER_DATA_KEY_IS_FAVORITE, False)[0m
[30;1m136 | [0m[35m    return album[0m
[30;1m137 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m612[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/jellyfin/parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m                    name=album_artist[ITEM_KEY_NAME],[0m
[30;1m119 | [0m[35m                )[0m
[30;1m120 | [0m[35m            )[0m
[30;1m121 | [0m[35m    elif len(jellyfin_album.get(ITEM_KEY_ARTIST_ITEMS, [])) >= 1:[0m
[30;1m122 | [0m[35m        for artist_item in jellyfin_album[ITEM_KEY_ARTIST_ITEMS]:[0m
[30;1m123 | [0m[35m            album.artists.append([0m
[30;1m124 | [0m[35m                ItemMapping([0m

[31m--[ [0m[34mMatch #[0m[33m613[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m235 | [0m[35m    async def _login(self) -> None:[0m
[30;1m236 | [0m[35m        """Authenticate with Audible using the saved authentication file."""[0m
[30;1m237 | [0m[35m        try:[0m
[30;1m238 | [0m[35m            auth = self._AUTH_CACHE.get(self.instance_id)[0m
[30;1m239 | [0m[35m[0m
[30;1m240 | [0m[35m            if auth is None:[0m
[30;1m241 | [0m[35m                self.logger.debug("Loading authenticator from file")[0m

[31m--[ [0m[34mMatch #[0m[33m614[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m207 | [0m[35m            label="Authentication File",[0m
[30;1m208 | [0m[35m            hidden=True,[0m
[30;1m209 | [0m[35m            required=True,[0m
[30;1m210 | [0m[35m            value=cast("str | None", values.get(CONF_AUTH_FILE)),[0m
[30;1m211 | [0m[35m        ),[0m
[30;1m212 | [0m[35m    )[0m
[30;1m213 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m615[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m199 | [0m[35m            label="Login Url",[0m
[30;1m200 | [0m[35m            hidden=True,[0m
[30;1m201 | [0m[35m            required=False,[0m
[30;1m202 | [0m[35m            value=cast("str | None", values.get(CONF_LOGIN_URL)),[0m
[30;1m203 | [0m[35m        ),[0m
[30;1m204 | [0m[35m        ConfigEntry([0m
[30;1m205 | [0m[35m            key=CONF_AUTH_FILE,[0m

[31m--[ [0m[34mMatch #[0m[33m616[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m191 | [0m[35m            label="Serial",[0m
[30;1m192 | [0m[35m            hidden=True,[0m
[30;1m193 | [0m[35m            required=False,[0m
[30;1m194 | [0m[35m            value=cast("str | None", values.get(CONF_SERIAL)),[0m
[30;1m195 | [0m[35m        ),[0m
[30;1m196 | [0m[35m        ConfigEntry([0m
[30;1m197 | [0m[35m            key=CONF_LOGIN_URL,[0m

[31m--[ [0m[34mMatch #[0m[33m617[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m183 | [0m[35m            label="Code Verifier",[0m
[30;1m184 | [0m[35m            hidden=True,[0m
[30;1m185 | [0m[35m            required=False,[0m
[30;1m186 | [0m[35m            value=cast("str | None", values.get(CONF_CODE_VERIFIER)),[0m
[30;1m187 | [0m[35m        ),[0m
[30;1m188 | [0m[35m        ConfigEntry([0m
[30;1m189 | [0m[35m            key=CONF_SERIAL,[0m

[31m--[ [0m[34mMatch #[0m[33m618[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m166 | [0m[35m            type=ConfigEntryType.STRING,[0m
[30;1m167 | [0m[35m            label="Post Login Url",[0m
[30;1m168 | [0m[35m            required=False,[0m
[30;1m169 | [0m[35m            value=cast("str | None", values.get(CONF_POST_LOGIN_URL)),[0m
[30;1m170 | [0m[35m            hidden=not auth_required,[0m
[30;1m171 | [0m[35m        ),[0m
[30;1m172 | [0m[35m        ConfigEntry([0m

[31m--[ [0m[34mMatch #[0m[33m619[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m117 | [0m[35m    if action == CONF_ACTION_VERIFY:[0m
[30;1m118 | [0m[35m        code_verifier = str(values.get(CONF_CODE_VERIFIER))[0m
[30;1m119 | [0m[35m        serial = str(values.get(CONF_SERIAL))[0m
[30;1m120 | [0m[35m        post_login_url = str(values.get(CONF_POST_LOGIN_URL))[0m
[30;1m121 | [0m[35m        storage_path = mass.storage_path[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m        auth = await audible_custom_login(code_verifier, post_login_url, serial, locale)[0m

[31m--[ [0m[34mMatch #[0m[33m620[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m    if action == CONF_ACTION_VERIFY:[0m
[30;1m118 | [0m[35m        code_verifier = str(values.get(CONF_CODE_VERIFIER))[0m
[30;1m119 | [0m[35m        serial = str(values.get(CONF_SERIAL))[0m
[30;1m120 | [0m[35m        post_login_url = str(values.get(CONF_POST_LOGIN_URL))[0m
[30;1m121 | [0m[35m        storage_path = mass.storage_path[0m
[30;1m122 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m621[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m115 | [0m[35m        await asyncio.sleep(15)[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m    if action == CONF_ACTION_VERIFY:[0m
[30;1m118 | [0m[35m        code_verifier = str(values.get(CONF_CODE_VERIFIER))[0m
[30;1m119 | [0m[35m        serial = str(values.get(CONF_SERIAL))[0m
[30;1m120 | [0m[35m        post_login_url = str(values.get(CONF_POST_LOGIN_URL))[0m
[30;1m121 | [0m[35m        storage_path = mass.storage_path[0m

[31m--[ [0m[34mMatch #[0m[33m622[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m74 | [0m[35m        values = {}[0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m    locale = cast("str", values.get("locale", "") or "us")[0m
[30;1m77 | [0m[35m    auth_file = cast("str", values.get(CONF_AUTH_FILE))[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m    auth_required = True[0m
[30;1m80 | [0m[35m    if auth_file and await check_file_exists(auth_file):[0m

[31m--[ [0m[34mMatch #[0m[33m623[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m    if values is None:[0m
[30;1m74 | [0m[35m        values = {}[0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m    locale = cast("str", values.get("locale", "") or "us")[0m
[30;1m77 | [0m[35m    auth_file = cast("str", values.get(CONF_AUTH_FILE))[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m    auth_required = True[0m

[31m--[ [0m[34mMatch #[0m[33m624[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m            entry = gdm.entries[0][0m
[30;1m74 | [0m[35m            data = entry.get("data")[0m
[30;1m75 | [0m[35m            local_server_ip = entry.get("from")[0][0m
[30;1m76 | [0m[35m            local_server_port = data.get("Port")[0m
[30;1m77 | [0m[35m            return local_server_ip, local_server_port[0m
[30;1m78 | [0m[35m        else:[0m
[30;1m79 | [0m[35m            return None, None[0m

[31m--[ [0m[34mMatch #[0m[33m625[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m        if len(gdm.entries) > 0:[0m
[30;1m73 | [0m[35m            entry = gdm.entries[0][0m
[30;1m74 | [0m[35m            data = entry.get("data")[0m
[30;1m75 | [0m[35m            local_server_ip = entry.get("from")[0][0m
[30;1m76 | [0m[35m            local_server_port = data.get("Port")[0m
[30;1m77 | [0m[35m            return local_server_ip, local_server_port[0m
[30;1m78 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m626[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m71 | [0m[35m        gdm.scan()[0m
[30;1m72 | [0m[35m        if len(gdm.entries) > 0:[0m
[30;1m73 | [0m[35m            entry = gdm.entries[0][0m
[30;1m74 | [0m[35m            data = entry.get("data")[0m
[30;1m75 | [0m[35m            local_server_ip = entry.get("from")[0][0m
[30;1m76 | [0m[35m            local_server_port = data.get("Port")[0m
[30;1m77 | [0m[35m            return local_server_ip, local_server_port[0m

[31m--[ [0m[34mMatch #[0m[33m627[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m            all_libraries.append(f"{plex_server.friendlyName} / {media_section.title}")[0m
[30;1m55 | [0m[35m        return all_libraries[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    if cache := await mass.cache.get(cache_key, checksum=auth_token):[0m
[30;1m58 | [0m[35m        return cast("list[str]", cache)[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    result = await asyncio.to_thread(_get_libraries)[0m

[31m--[ [0m[34mMatch #[0m[33m628[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/snapcontrol.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35m        this.os = json.os;[0m
[30;1m12 | [0m[35m    }[0m
[30;1m13 | [0m[35m    arch = "";[0m
[30;1m14 | [0m[35m    ip = "";[0m
[30;1m15 | [0m[35m    mac = "";[0m
[30;1m16 | [0m[35m    name = "";[0m
[30;1m17 | [0m[35m    os = "";[0m

[31m--[ [0m[34mMatch #[0m[33m629[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/snapstream.js[0m
   Pattern: [32m.hostname[0m
[30;1m747 | [0m[35m            hello.mac = "00:00:00:00:00:00";[0m
[30;1m748 | [0m[35m            hello.arch = "web";[0m
[30;1m749 | [0m[35m            hello.os = navigator.platform;[0m
[30;1m750 | [0m[35m            hello.hostname = "Snapweb client";[0m
[30;1m751 | [0m[35m            hello.uniqueId = SnapStream.getClientId();[0m
[30;1m752 | [0m[35m            const versionElem = document.getElementsByTagName("meta").namedItem("version");[0m
[30;1m753 | [0m[35m            hello.version = versionElem ? versionElem.content : "0.0.0";[0m

[31m--[ [0m[34mMatch #[0m[33m630[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/snapstream.js[0m
   Pattern: [32m.hostname[0m
[30;1m196 | [0m[35m        return super.serialize();[0m
[30;1m197 | [0m[35m    }[0m
[30;1m198 | [0m[35m    mac = "";[0m
[30;1m199 | [0m[35m    hostname = "";[0m
[30;1m200 | [0m[35m    version = "0.0.0";[0m
[30;1m201 | [0m[35m    clientName = "Snapweb";[0m
[30;1m202 | [0m[35m    os = "";[0m

[31m--[ [0m[34mMatch #[0m[33m631[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/snapstream.js[0m
   Pattern: [32m.hostname[0m
[30;1m192 | [0m[35m        this.snapStreamProtocolVersion = this.json["SnapStreamProtocolVersion"];[0m
[30;1m193 | [0m[35m    }[0m
[30;1m194 | [0m[35m    serialize() {[0m
[30;1m195 | [0m[35m        this.json = { "MAC": this.mac, "HostName": this.hostname, "Version": this.version, "ClientNa[0m
[30;1m196 | [0m[35m        return super.serialize();[0m
[30;1m197 | [0m[35m    }[0m
[30;1m198 | [0m[35m    mac = "";[0m

[31m--[ [0m[34mMatch #[0m[33m632[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/snapstream.js[0m
   Pattern: [32m.hostname[0m
[30;1m182 | [0m[35m    deserialize(buffer) {[0m
[30;1m183 | [0m[35m        super.deserialize(buffer);[0m
[30;1m184 | [0m[35m        this.mac = this.json["MAC"];[0m
[30;1m185 | [0m[35m        this.hostname = this.json["HostName"];[0m
[30;1m186 | [0m[35m        this.version = this.json["Version"];[0m
[30;1m187 | [0m[35m        this.clientName = this.json["ClientName"];[0m
[30;1m188 | [0m[35m        this.os = this.json["OS"];[0m

[31m--[ [0m[34mMatch #[0m[33m633[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/snapstream.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m825 | [0m[35m        }[0m
[30;1m826 | [0m[35m        else if (type == 4) {[0m
[30;1m827 | [0m[35m            if (this.timeProvider) {[0m
[30;1m828 | [0m[35m                let time = new TimeMessage(msg.data);[0m
[30;1m829 | [0m[35m                this.timeProvider.setDiff(time.latency.getMilliseconds(), this.timeProvider.now() - [0m
[30;1m830 | [0m[35m            }[0m
[30;1m831 | [0m[35m            // console.log("Time sec: " + time.latency.sec + ", usec: " + time.latency.usec + ", dif[0m

[31m--[ [0m[34mMatch #[0m[33m634[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/snapstream.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m513 | [0m[35m        return localTimeMs + this.diff;[0m
[30;1m514 | [0m[35m    }[0m
[30;1m515 | [0m[35m    diffBuffer = new Array();[0m
[30;1m516 | [0m[35m    diff = 0;[0m
[30;1m517 | [0m[35m    ctx;[0m
[30;1m518 | [0m[35m}[0m
[30;1m519 | [0m[35mclass SampleFormat {[0m

[31m--[ [0m[34mMatch #[0m[33m635[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ibroadcast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m194 | [0m[35m    def _get_artist_item_mapping(self, artist_id: str, artist_obj: dict[str, Any]) -> ItemMapping:[0m
[30;1m195 | [0m[35m        if (not artist_id and artist_obj["name"] == "Various Artists") or artist_id == "0":[0m
[30;1m196 | [0m[35m            artist_id = VARIOUS_ARTISTS_MBID[0m
[30;1m197 | [0m[35m        return self._get_item_mapping(MediaType.ARTIST, artist_id, str(artist_obj.get("name")))[0m
[30;1m198 | [0m[35m[0m
[30;1m199 | [0m[35m    def _get_item_mapping(self, media_type: MediaType, key: str, name: str) -> ItemMapping:[0m
[30;1m200 | [0m[35m        return ItemMapping([0m

[31m--[ [0m[34mMatch #[0m[33m636[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1012 | [0m[35m        return [[0m
[30;1m1013 | [0m[35m            x[0m
[30;1m1014 | [0m[35m            for x in members[0m
[30;1m1015 | [0m[35m            if self.mass.players.get(x)[0m
[30;1m1016 | [0m[35m            and x not in syncgroup_childs[0m
[30;1m1017 | [0m[35m            and not x.startswith(UNIVERSAL_PREFIX)[0m
[30;1m1018 | [0m[35m        ][0m

[31m--[ [0m[34mMatch #[0m[33m637[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1005 | [0m[35m        for member in members:[0m
[30;1m1006 | [0m[35m            if not member.startswith(SYNCGROUP_PREFIX):[0m
[30;1m1007 | [0m[35m                continue[0m
[30;1m1008 | [0m[35m            if syncgroup := self.mass.players.get(member):[0m
[30;1m1009 | [0m[35m                syncgroup_childs.extend(syncgroup.group_childs)[0m
[30;1m1010 | [0m[35m        # we filter out other UGP players and syncgroup childs[0m
[30;1m1011 | [0m[35m        # if their parent is already in the list[0m

[31m--[ [0m[34mMatch #[0m[33m638[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m997 | [0m[35m            return [[0m
[30;1m998 | [0m[35m                x[0m
[30;1m999 | [0m[35m                for x in members[0m
[30;1m1000 | [0m[35m                if (player := self.mass.players.get(x))[0m
[30;1m1001 | [0m[35m                and player.provider == player_provider.instance_id[0m
[30;1m1002 | [0m[35m            ][0m
[30;1m1003 | [0m[35m        # cleanup members - filter out impossible choices[0m

[31m--[ [0m[34mMatch #[0m[33m639[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m939 | [0m[35m        if not (ugp_player := self.mass.players.get(ugp_player_id)):[0m
[30;1m940 | [0m[35m            raise web.HTTPNotFound(reason=f"Unknown UGP player: {ugp_player_id}")[0m
[30;1m941 | [0m[35m[0m
[30;1m942 | [0m[35m        if not (stream := self.ugp_streams.get(ugp_player_id, None)) or stream.done:[0m
[30;1m943 | [0m[35m            raise web.HTTPNotFound(body=f"There is no active UGP stream for {ugp_player_id}!")[0m
[30;1m944 | [0m[35m[0m
[30;1m945 | [0m[35m        http_profile: str = await self.mass.config.get_player_config_value([0m

[31m--[ [0m[34mMatch #[0m[33m640[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m936 | [0m[35m        else:[0m
[30;1m937 | [0m[35m            output_format = AudioFormat(content_type=ContentType.MP3)[0m
[30;1m938 | [0m[35m[0m
[30;1m939 | [0m[35m        if not (ugp_player := self.mass.players.get(ugp_player_id)):[0m
[30;1m940 | [0m[35m            raise web.HTTPNotFound(reason=f"Unknown UGP player: {ugp_player_id}")[0m
[30;1m941 | [0m[35m[0m
[30;1m942 | [0m[35m        if not (stream := self.ugp_streams.get(ugp_player_id, None)) or stream.done:[0m

[31m--[ [0m[34mMatch #[0m[33m641[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m923 | [0m[35m        child_player_id = request.query.get("player_id")  # optional![0m
[30;1m924 | [0m[35m        output_format_str = request.path.rsplit(".")[-1][0m
[30;1m925 | [0m[35m[0m
[30;1m926 | [0m[35m        if child_player_id and (child_player := self.mass.players.get(child_player_id)):[0m
[30;1m927 | [0m[35m            # Use the preferred output format of the child player[0m
[30;1m928 | [0m[35m            output_format = await self.mass.streams.get_output_format([0m
[30;1m929 | [0m[35m                output_format_str=output_format_str,[0m

[31m--[ [0m[34mMatch #[0m[33m642[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m920 | [0m[35m    async def _serve_ugp_stream(self, request: web.Request) -> web.Response:[0m
[30;1m921 | [0m[35m        """Serve the UGP (multi-client) flow stream audio to a player."""[0m
[30;1m922 | [0m[35m        ugp_player_id = request.path.rsplit(".")[0].rsplit("/")[-1][0m
[30;1m923 | [0m[35m        child_player_id = request.query.get("player_id")  # optional![0m
[30;1m924 | [0m[35m        output_format_str = request.path.rsplit(".")[-1][0m
[30;1m925 | [0m[35m[0m
[30;1m926 | [0m[35m        if child_player_id and (child_player := self.mass.players.get(child_player_id)):[0m

[31m--[ [0m[34mMatch #[0m[33m643[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m896 | [0m[35m        changed = False[0m
[30;1m897 | [0m[35m        # Verify that no player is part of a separate group[0m
[30;1m898 | [0m[35m        for child_player_id in player.group_childs:[0m
[30;1m899 | [0m[35m            child_player = self.mass.players.get(child_player_id)[0m
[30;1m900 | [0m[35m            if child_player is None:[0m
[30;1m901 | [0m[35m                continue[0m
[30;1m902 | [0m[35m            if PlayerFeature.SET_MEMBERS not in child_player.supported_features:[0m

[31m--[ [0m[34mMatch #[0m[33m644[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m719 | [0m[35m            PlayerFeature.VOLUME_SET,[0m
[30;1m720 | [0m[35m        }[0m
[30;1m721 | [0m[35m[0m
[30;1m722 | [0m[35m        if not (self.mass.players.get(x) for x in members):[0m
[30;1m723 | [0m[35m            raise PlayerUnavailableError("One or more members are not available!")[0m
[30;1m724 | [0m[35m[0m
[30;1m725 | [0m[35m        if group_type == GROUP_TYPE_UNIVERSAL:[0m

[31m--[ [0m[34mMatch #[0m[33m645[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m698 | [0m[35m            self.instance_id, include_values=True[0m
[30;1m699 | [0m[35m        )[0m
[30;1m700 | [0m[35m        for player_config in player_configs:[0m
[30;1m701 | [0m[35m            if self.mass.players.get(player_config.player_id):[0m
[30;1m702 | [0m[35m                continue  # already registered[0m
[30;1m703 | [0m[35m            members = player_config.get_value(CONF_GROUP_MEMBERS)[0m
[30;1m704 | [0m[35m            group_type = player_config.get_value(CONF_GROUP_TYPE)[0m

[31m--[ [0m[34mMatch #[0m[33m646[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m640 | [0m[35m            - target_player: player_id of the group player.[0m
[30;1m641 | [0m[35m        """[0m
[30;1m642 | [0m[35m        group_player = self.mass.players.get(target_player, raise_unavailable=True)[0m
[30;1m643 | [0m[35m        child_player = self.mass.players.get(player_id, raise_unavailable=True)[0m
[30;1m644 | [0m[35m        if TYPE_CHECKING:[0m
[30;1m645 | [0m[35m            group_player = cast("Player", group_player)[0m
[30;1m646 | [0m[35m            child_player = cast("Player", child_player)[0m

[31m--[ [0m[34mMatch #[0m[33m647[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m639 | [0m[35m            - player_id: player_id of the (child) player to ungroup from the group.[0m
[30;1m640 | [0m[35m            - target_player: player_id of the group player.[0m
[30;1m641 | [0m[35m        """[0m
[30;1m642 | [0m[35m        group_player = self.mass.players.get(target_player, raise_unavailable=True)[0m
[30;1m643 | [0m[35m        child_player = self.mass.players.get(player_id, raise_unavailable=True)[0m
[30;1m644 | [0m[35m        if TYPE_CHECKING:[0m
[30;1m645 | [0m[35m            group_player = cast("Player", group_player)[0m

[31m--[ [0m[34mMatch #[0m[33m648[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m602 | [0m[35m            raise UnsupportedFeaturedException([0m
[30;1m603 | [0m[35m                f"Adjusting group members is not allowed for group {group_player.display_name}"[0m
[30;1m604 | [0m[35m            )[0m
[30;1m605 | [0m[35m        child_player = self.mass.players.get(player_id, raise_unavailable=True)[0m
[30;1m606 | [0m[35m        if TYPE_CHECKING:[0m
[30;1m607 | [0m[35m            group_player = cast("Player", group_player)[0m
[30;1m608 | [0m[35m        if child_player.active_group and child_player.active_group != group_player.player_id:[0m

[31m--[ [0m[34mMatch #[0m[33m649[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m587 | [0m[35m            - player_id: player_id of the player to handle the command.[0m
[30;1m588 | [0m[35m            - target_player: player_id of the sync leader.[0m
[30;1m589 | [0m[35m        """[0m
[30;1m590 | [0m[35m        group_player = self.mass.players.get(target_player, raise_unavailable=True)[0m
[30;1m591 | [0m[35m        if TYPE_CHECKING:[0m
[30;1m592 | [0m[35m            group_player = cast("Player", group_player)[0m
[30;1m593 | [0m[35m        dynamic_members_enabled = self.mass.config.get_raw_player_config_value([0m

[31m--[ [0m[34mMatch #[0m[33m650[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m572 | [0m[35m[0m
[30;1m573 | [0m[35m    async def remove_player(self, player_id: str) -> None:[0m
[30;1m574 | [0m[35m        """Remove a group player."""[0m
[30;1m575 | [0m[35m        if not (group_player := self.mass.players.get(player_id)):[0m
[30;1m576 | [0m[35m            return[0m
[30;1m577 | [0m[35m        if group_player.powered:[0m
[30;1m578 | [0m[35m            # edge case: the group player is powered and being removed[0m

[31m--[ [0m[34mMatch #[0m[33m651[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m529 | [0m[35m        This is called by the Player Manager;[0m
[30;1m530 | [0m[35m        if 'needs_poll' is set to True in the player object.[0m
[30;1m531 | [0m[35m        """[0m
[30;1m532 | [0m[35m        if group_player := self.mass.players.get(player_id):[0m
[30;1m533 | [0m[35m            self._update_attributes(group_player)[0m
[30;1m534 | [0m[35m            if group_player.powered:[0m
[30;1m535 | [0m[35m                await self._ungroup_subgroups_if_found(group_player)[0m

[31m--[ [0m[34mMatch #[0m[33m652[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m513 | [0m[35m[0m
[30;1m514 | [0m[35m    async def enqueue_next_media(self, player_id: str, media: PlayerMedia) -> None:[0m
[30;1m515 | [0m[35m        """Handle enqueuing of a next media item on the player."""[0m
[30;1m516 | [0m[35m        group_player = self.mass.players.get(player_id, True)[0m
[30;1m517 | [0m[35m        if not player_id.startswith(SYNCGROUP_PREFIX):[0m
[30;1m518 | [0m[35m            # this shouldn't happen, but just in case[0m
[30;1m519 | [0m[35m            raise UnsupportedFeaturedException("Command is not supported for UGP players")[0m

[31m--[ [0m[34mMatch #[0m[33m653[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m464 | [0m[35m        elif media.queue_id and media.queue_item_id:[0m
[30;1m465 | [0m[35m            # regular queue stream request[0m
[30;1m466 | [0m[35m            audio_source = self.mass.streams.get_queue_flow_stream([0m
[30;1m467 | [0m[35m                queue=self.mass.player_queues.get(media.queue_id),[0m
[30;1m468 | [0m[35m                start_queue_item=self.mass.player_queues.get_item([0m
[30;1m469 | [0m[35m                    media.queue_id, media.queue_item_id[0m
[30;1m470 | [0m[35m                ),[0m

[31m--[ [0m[34mMatch #[0m[33m654[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m425 | [0m[35m        media: PlayerMedia,[0m
[30;1m426 | [0m[35m    ) -> None:[0m
[30;1m427 | [0m[35m        """Handle PLAY MEDIA on given player."""[0m
[30;1m428 | [0m[35m        group_player = self.mass.players.get(player_id)[0m
[30;1m429 | [0m[35m        # power on (which will also resync) if needed[0m
[30;1m430 | [0m[35m        await self.cmd_power(player_id, True)[0m
[30;1m431 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m655[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m349 | [0m[35m[0m
[30;1m350 | [0m[35m    async def cmd_power(self, player_id: str, powered: bool) -> None:[0m
[30;1m351 | [0m[35m        """Handle POWER command to group player."""[0m
[30;1m352 | [0m[35m        group_player = self.mass.players.get(player_id, raise_unavailable=True)[0m
[30;1m353 | [0m[35m        if TYPE_CHECKING:[0m
[30;1m354 | [0m[35m            group_player = cast("Player", group_player)[0m
[30;1m355 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m656[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m338 | [0m[35m[0m
[30;1m339 | [0m[35m    async def cmd_pause(self, player_id: str) -> None:[0m
[30;1m340 | [0m[35m        """Send PAUSE command to given player."""[0m
[30;1m341 | [0m[35m        group_player = self.mass.players.get(player_id)[0m
[30;1m342 | [0m[35m        if not player_id.startswith(SYNCGROUP_PREFIX):[0m
[30;1m343 | [0m[35m            # this shouldn't happen, but just in case[0m
[30;1m344 | [0m[35m            raise UnsupportedFeaturedException[0m

[31m--[ [0m[34mMatch #[0m[33m657[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m327 | [0m[35m[0m
[30;1m328 | [0m[35m    async def cmd_play(self, player_id: str) -> None:[0m
[30;1m329 | [0m[35m        """Send PLAY command to given player."""[0m
[30;1m330 | [0m[35m        group_player = self.mass.players.get(player_id)[0m
[30;1m331 | [0m[35m        if not player_id.startswith(SYNCGROUP_PREFIX):[0m
[30;1m332 | [0m[35m            # this shouldn't happen, but just in case[0m
[30;1m333 | [0m[35m            raise UnsupportedFeaturedException[0m

[31m--[ [0m[34mMatch #[0m[33m658[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m309 | [0m[35m[0m
[30;1m310 | [0m[35m    async def cmd_stop(self, player_id: str) -> None:[0m
[30;1m311 | [0m[35m        """Send STOP command to given player."""[0m
[30;1m312 | [0m[35m        group_player = self.mass.players.get(player_id)[0m
[30;1m313 | [0m[35m        # syncgroup: forward command to sync leader[0m
[30;1m314 | [0m[35m        if player_id.startswith(SYNCGROUP_PREFIX):[0m
[30;1m315 | [0m[35m            if sync_leader := self._get_sync_leader(group_player):[0m

[31m--[ [0m[34mMatch #[0m[33m659[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m298 | [0m[35m                    await self.cmd_power(group_player.player_id, True)[0m
[30;1m299 | [0m[35m        if f"values/{CONFIG_ENTRY_DYNAMIC_MEMBERS.key}" in changed_keys:[0m
[30;1m300 | [0m[35m            # dynamic members feature changed[0m
[30;1m301 | [0m[35m            if group_player := self.mass.players.get(config.player_id):[0m
[30;1m302 | [0m[35m                if PlayerFeature.SET_MEMBERS in group_player.supported_features:[0m
[30;1m303 | [0m[35m                    group_player.supported_features.remove(PlayerFeature.SET_MEMBERS)[0m
[30;1m304 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m660[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m291 | [0m[35m        if f"values/{CONF_GROUP_MEMBERS}" in changed_keys:[0m
[30;1m292 | [0m[35m            # ensure we filter invalid members[0m
[30;1m293 | [0m[35m            members = self._filter_members(config.get_value(CONF_GROUP_TYPE), members)[0m
[30;1m294 | [0m[35m            if group_player := self.mass.players.get(config.player_id):[0m
[30;1m295 | [0m[35m                group_player.group_childs.set(members)[0m
[30;1m296 | [0m[35m                if group_player.powered:[0m
[30;1m297 | [0m[35m                    # power on group player (which will also resync) if needed[0m

[31m--[ [0m[34mMatch #[0m[33m661[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m182 | [0m[35m                )[0m
[30;1m183 | [0m[35m                player_config.provider = self.instance_id[0m
[30;1m184 | [0m[35m            # migrate old syncgroup/UGP players to this provider[0m
[30;1m185 | [0m[35m            if player_config.values.get(CONF_GROUP_TYPE) is not None:[0m
[30;1m186 | [0m[35m                # already migrated[0m
[30;1m187 | [0m[35m                continue[0m
[30;1m188 | [0m[35m            if player_config.player_id.startswith(SYNCGROUP_PREFIX):[0m

[31m--[ [0m[34mMatch #[0m[33m662[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m774 | [0m[35m            type=PlayerType.GROUP,[0m
[30;1m775 | [0m[35m            name=name,[0m
[30;1m776 | [0m[35m            available=True,[0m
[30;1m777 | [0m[35m            # group players are always powered off by default at init/startup[0m
[30;1m778 | [0m[35m            powered=False,[0m
[30;1m779 | [0m[35m            device_info=DeviceInfo(model=model_name, manufacturer=manufacturer),[0m
[30;1m780 | [0m[35m            supported_features=player_features,[0m

[31m--[ [0m[34mMatch #[0m[33m663[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m353 | [0m[35m        if TYPE_CHECKING:[0m
[30;1m354 | [0m[35m            group_player = cast("Player", group_player)[0m
[30;1m355 | [0m[35m[0m
[30;1m356 | [0m[35m        # always stop at power off[0m
[30;1m357 | [0m[35m        if not powered and group_player.state in (PlayerState.PLAYING, PlayerState.PAUSED):[0m
[30;1m358 | [0m[35m            await self.cmd_stop(group_player.player_id)[0m
[30;1m359 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m664[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m304 | [0m[35m                else:[0m
[30;1m305 | [0m[35m                    group_player.supported_features.add(PlayerFeature.SET_MEMBERS)[0m
[30;1m306 | [0m[35m        if not members and not config.get_value(CONFIG_ENTRY_DYNAMIC_MEMBERS.key):[0m
[30;1m307 | [0m[35m            raise InvalidDataError("Group player must have at least one member")[0m
[30;1m308 | [0m[35m        await super().on_player_config_change(config, changed_keys)[0m
[30;1m309 | [0m[35m[0m
[30;1m310 | [0m[35m    async def cmd_stop(self, player_id: str) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m665[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m215 | [0m[35m[0m
[30;1m216 | [0m[35m        Called when provider is deregistered (e.g. MA exiting or config reloading).[0m
[30;1m217 | [0m[35m        """[0m
[30;1m218 | [0m[35m        # power off all group players at unload[0m
[30;1m219 | [0m[35m        for group_player in self.players:[0m
[30;1m220 | [0m[35m            if group_player.powered:[0m
[30;1m221 | [0m[35m                await self.cmd_power(group_player.player_id, False)[0m

[31m--[ [0m[34mMatch #[0m[33m666[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35mimport asyncio[0m
[30;1m11 | [0m[35mfrom collections.abc import Callable[0m
[30;1m12 | [0m[35mfrom contextlib import suppress[0m
[30;1m13 | [0m[35mfrom time import time[0m
[30;1m14 | [0m[35mfrom typing import TYPE_CHECKING, Final, cast[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35mimport shortuuid[0m
[30;1m17 | [0m[35mfrom aiohttp import web[0m

[31m--[ [0m[34mMatch #[0m[33m667[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35mimport asyncio[0m
[30;1m11 | [0m[35mfrom collections.abc import Callable[0m
[30;1m12 | [0m[35mfrom contextlib import suppress[0m
[30;1m13 | [0m[35mfrom time import time[0m
[30;1m14 | [0m[35mfrom typing import TYPE_CHECKING, Final, cast[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35mimport shortuuid[0m

[31m--[ [0m[34mMatch #[0m[33m668[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m488 | [0m[35m                else:[0m
[30;1m489 | [0m[35m                    player_control.volume_level = try_parse_int(attributes.get("value")) or 0[0m
[30;1m490 | [0m[35m            if player_control.supports_mute and entity_platform == "media_player":[0m
[30;1m491 | [0m[35m                player_control.volume_muted = attributes.get("volume_muted")[0m
[30;1m492 | [0m[35m        self.mass.players.update_player_control(entity_id)[0m

[31m--[ [0m[34mMatch #[0m[33m669[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m486 | [0m[35m                if entity_platform == "media_player":[0m
[30;1m487 | [0m[35m                    player_control.volume_level = int(attributes.get("volume_level", 0) * 100)[0m
[30;1m488 | [0m[35m                else:[0m
[30;1m489 | [0m[35m                    player_control.volume_level = try_parse_int(attributes.get("value")) or 0[0m
[30;1m490 | [0m[35m            if player_control.supports_mute and entity_platform == "media_player":[0m
[30;1m491 | [0m[35m                player_control.volume_muted = attributes.get("volume_muted")[0m
[30;1m492 | [0m[35m        self.mass.players.update_player_control(entity_id)[0m

[31m--[ [0m[34mMatch #[0m[33m670[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m484 | [0m[35m        if "a" in state and (attributes := state["a"]):[0m
[30;1m485 | [0m[35m            if player_control.supports_volume:[0m
[30;1m486 | [0m[35m                if entity_platform == "media_player":[0m
[30;1m487 | [0m[35m                    player_control.volume_level = int(attributes.get("volume_level", 0) * 100)[0m
[30;1m488 | [0m[35m                else:[0m
[30;1m489 | [0m[35m                    player_control.volume_level = try_parse_int(attributes.get("value")) or 0[0m
[30;1m490 | [0m[35m            if player_control.supports_mute and entity_platform == "media_player":[0m

[31m--[ [0m[34mMatch #[0m[33m671[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m470 | [0m[35m        """Update PlayerControl from state(update) message."""[0m
[30;1m471 | [0m[35m        if self._player_controls is None:[0m
[30;1m472 | [0m[35m            return[0m
[30;1m473 | [0m[35m        if not (player_control := self._player_controls.get(entity_id)):[0m
[30;1m474 | [0m[35m            return[0m
[30;1m475 | [0m[35m        entity_platform = entity_id.split(".")[0][0m
[30;1m476 | [0m[35m        if "s" in state:[0m

[31m--[ [0m[34mMatch #[0m[33m672[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m402 | [0m[35m                if not hass_state:[0m
[30;1m403 | [0m[35m                    control.volume_muted = False[0m
[30;1m404 | [0m[35m                elif entity_platform == "media_player":[0m
[30;1m405 | [0m[35m                    control.volume_muted = hass_state["attributes"].get("volume_muted")[0m
[30;1m406 | [0m[35m                elif hass_state:[0m
[30;1m407 | [0m[35m                    control.volume_muted = hass_state["state"] not in OFF_STATES[0m
[30;1m408 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m673[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m392 | [0m[35m                    control.volume_level = 0[0m
[30;1m393 | [0m[35m                elif entity_platform == "media_player":[0m
[30;1m394 | [0m[35m                    control.volume_level = int([0m
[30;1m395 | [0m[35m                        hass_state["attributes"].get("volume_level", 0) * 100[0m
[30;1m396 | [0m[35m                    )[0m
[30;1m397 | [0m[35m                else:[0m
[30;1m398 | [0m[35m                    control.volume_level = try_parse_int(hass_state["state"]) or 0[0m

[31m--[ [0m[34mMatch #[0m[33m674[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m371 | [0m[35m        assert self._player_controls is not None  # for type checking[0m
[30;1m372 | [0m[35m        for entity_id in control_entity_ids:[0m
[30;1m373 | [0m[35m            entity_platform = entity_id.split(".")[0][0m
[30;1m374 | [0m[35m            hass_state = hass_states.get(entity_id)[0m
[30;1m375 | [0m[35m            if hass_state:[0m
[30;1m376 | [0m[35m                name = f"{hass_state['attributes']['friendly_name']} ({entity_id})"[0m
[30;1m377 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m675[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m347 | [0m[35m        if entity_additions := event.get("a"):[0m
[30;1m348 | [0m[35m            for entity_id, state in entity_additions.items():[0m
[30;1m349 | [0m[35m                self._update_control_from_state_msg(entity_id, state)[0m
[30;1m350 | [0m[35m        if entity_changes := event.get("c"):[0m
[30;1m351 | [0m[35m            for entity_id, state_diff in entity_changes.items():[0m
[30;1m352 | [0m[35m                if "+" not in state_diff:[0m
[30;1m353 | [0m[35m                    continue[0m

[31m--[ [0m[34mMatch #[0m[33m676[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m344 | [0m[35m[0m
[30;1m345 | [0m[35m    def _on_entity_state_update(self, event: EntityStateEvent) -> None:[0m
[30;1m346 | [0m[35m        """Handle Entity State event."""[0m
[30;1m347 | [0m[35m        if entity_additions := event.get("a"):[0m
[30;1m348 | [0m[35m            for entity_id, state in entity_additions.items():[0m
[30;1m349 | [0m[35m                self._update_control_from_state_msg(entity_id, state)[0m
[30;1m350 | [0m[35m        if entity_changes := event.get("c"):[0m

[31m--[ [0m[34mMatch #[0m[33m677[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m162 | [0m[35m                description="You can either paste a Long Lived Token here manually or use the "[0m
[30;1m163 | [0m[35m                "'authenticate' button to generate a token for you with logging in.",[0m
[30;1m164 | [0m[35m                depends_on=CONF_URL,[0m
[30;1m165 | [0m[35m                value=cast("str", values.get(CONF_AUTH_TOKEN)) if values else None,[0m
[30;1m166 | [0m[35m                category="advanced",[0m
[30;1m167 | [0m[35m            ),[0m
[30;1m168 | [0m[35m            ConfigEntry([0m

[31m--[ [0m[34mMatch #[0m[33m678[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m143 | [0m[35m                label="URL",[0m
[30;1m144 | [0m[35m                required=True,[0m
[30;1m145 | [0m[35m                description="URL to your Home Assistant instance (e.g. http://192.168.1.1:8123)",[0m
[30;1m146 | [0m[35m                value=cast("str", values.get(CONF_URL)) if values else None,[0m
[30;1m147 | [0m[35m            ),[0m
[30;1m148 | [0m[35m            ConfigEntry([0m
[30;1m149 | [0m[35m                key=CONF_ACTION_AUTH,[0m

[31m--[ [0m[34mMatch #[0m[33m679[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m458 | [0m[35m            )[0m
[30;1m459 | [0m[35m            return[0m
[30;1m460 | [0m[35m[0m
[30;1m461 | [0m[35m        # At this point, `set_value` will work for both `number` or `input_number`[0m
[30;1m462 | [0m[35m        await self.hass.call_service([0m
[30;1m463 | [0m[35m            domain=domain,[0m
[30;1m464 | [0m[35m            service="set_value",[0m

[31m--[ [0m[34mMatch #[0m[33m680[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m408 | [0m[35m                else:[0m
[30;1m409 | [0m[35m                    control.volume_muted = False[0m
[30;1m410 | [0m[35m                control.mute_set = partial(self._handle_player_control_mute_set, entity_id)[0m
[30;1m411 | [0m[35m            self._player_controls[entity_id] = control[0m
[30;1m412 | [0m[35m            await self.mass.players.register_player_control(control)[0m
[30;1m413 | [0m[35m        # register for entity state updates[0m
[30;1m414 | [0m[35m        await self.hass.subscribe_entities(self._on_entity_state_update, list(control_entity_ids))[0m
[30;1m415 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m681[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m376 | [0m[35m                name = f"{hass_state['attributes']['friendly_name']} ({entity_id})"[0m
[30;1m377 | [0m[35m            else:[0m
[30;1m378 | [0m[35m                name = entity_id[0m
[30;1m379 | [0m[35m            control = PlayerControl([0m
[30;1m380 | [0m[35m                id=entity_id,[0m
[30;1m381 | [0m[35m                provider=self.instance_id,[0m
[30;1m382 | [0m[35m                name=name,[0m

[31m--[ [0m[34mMatch #[0m[33m682[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m280 | [0m[35m            key=CONF_MUTE_CONTROLS,[0m
[30;1m281 | [0m[35m            type=ConfigEntryType.STRING,[0m
[30;1m282 | [0m[35m            multi_value=True,[0m
[30;1m283 | [0m[35m            label="Player Mute Control entities",[0m
[30;1m284 | [0m[35m            required=True,[0m
[30;1m285 | [0m[35m            options=all_mute_entities,[0m
[30;1m286 | [0m[35m            default_value=[],[0m

[31m--[ [0m[34mMatch #[0m[33m683[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m268 | [0m[35m            key=CONF_VOLUME_CONTROLS,[0m
[30;1m269 | [0m[35m            type=ConfigEntryType.STRING,[0m
[30;1m270 | [0m[35m            multi_value=True,[0m
[30;1m271 | [0m[35m            label="Player Volume Control entities",[0m
[30;1m272 | [0m[35m            required=True,[0m
[30;1m273 | [0m[35m            options=all_volume_entities,[0m
[30;1m274 | [0m[35m            default_value=[],[0m

[31m--[ [0m[34mMatch #[0m[33m684[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m256 | [0m[35m            key=CONF_POWER_CONTROLS,[0m
[30;1m257 | [0m[35m            type=ConfigEntryType.STRING,[0m
[30;1m258 | [0m[35m            multi_value=True,[0m
[30;1m259 | [0m[35m            label="Player Power Control entities",[0m
[30;1m260 | [0m[35m            required=True,[0m
[30;1m261 | [0m[35m            options=all_power_entities,[0m
[30;1m262 | [0m[35m            default_value=[],[0m

[31m--[ [0m[34mMatch #[0m[33m685[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/hass/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m228 | [0m[35m            all_mute_entities.append(ConfigValueOption(name, state["entity_id"]))[0m
[30;1m229 | [0m[35m            continue[0m
[30;1m230 | [0m[35m        if entity_platform in ("number", "input_number"):[0m
[30;1m231 | [0m[35m            # number and input_number are very similar, both are suitable for volume control[0m
[30;1m232 | [0m[35m            all_volume_entities.append(ConfigValueOption(name, state["entity_id"]))[0m
[30;1m233 | [0m[35m            continue[0m
[30;1m234 | [0m[35m[0m
[30;1m235 | [0m[35m        # media player can be used as control, depending on features[0m

[31m--[ [0m[34mMatch #[0m[33m686[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/player_group/ugp_stream.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m        try:[0m
[30;1m74 | [0m[35m            self.subscribers.append(queue.put)[0m
[30;1m75 | [0m[35m            while True:[0m
[30;1m76 | [0m[35m                chunk = await queue.get()[0m
[30;1m77 | [0m[35m                if not chunk:[0m
[30;1m78 | [0m[35m                    break[0m
[30;1m79 | [0m[35m                yield chunk[0m

[31m--[ [0m[34mMatch #[0m[33m687[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/deezer/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m483 | [0m[35m        streamdetails.data["start_ts"] = utc_timestamp()[0m
[30;1m484 | [0m[35m        streamdetails.data["stream_id"] = uuid.uuid1()[0m
[30;1m485 | [0m[35m        self.mass.create_task(self.gw_client.log_listen(next_track=streamdetails.item_id))[0m
[30;1m486 | [0m[35m        async with self.mass.http_session.get([0m
[30;1m487 | [0m[35m            streamdetails.data["url"], headers=headers, timeout=timeout[0m
[30;1m488 | [0m[35m        ) as resp:[0m
[30;1m489 | [0m[35m            async for chunk in resp.content.iter_chunked(2048):[0m

[31m--[ [0m[34mMatch #[0m[33m688[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/deezer/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m154 | [0m[35m            label="Arl token",[0m
[30;1m155 | [0m[35m            required=True,[0m
[30;1m156 | [0m[35m            description="See https://www.dumpmedia.com/deezplus/deezer-arl.html",[0m
[30;1m157 | [0m[35m            value=values.get(CONF_ARL_TOKEN) if values else None,[0m
[30;1m158 | [0m[35m        ),[0m
[30;1m159 | [0m[35m    )[0m
[30;1m160 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m689[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/deezer/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m146 | [0m[35m            action=CONF_ACTION_AUTH,[0m
[30;1m147 | [0m[35m            description="You need to authenticate on Deezer.",[0m
[30;1m148 | [0m[35m            action_label="Authenticate with Deezer",[0m
[30;1m149 | [0m[35m            value=values.get(CONF_ACCESS_TOKEN) if values else None,[0m
[30;1m150 | [0m[35m        ),[0m
[30;1m151 | [0m[35m        ConfigEntry([0m
[30;1m152 | [0m[35m            key=CONF_ARL_TOKEN,[0m

[31m--[ [0m[34mMatch #[0m[33m690[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/deezer/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m96 | [0m[35m    app_id: str, app_secret: str, code: str, http_session: ClientSession[0m
[30;1m97 | [0m[35m) -> str:[0m
[30;1m98 | [0m[35m    """Update the access_token."""[0m
[30;1m99 | [0m[35m    response = await http_session.post([0m
[30;1m100 | [0m[35m        "https://connect.deezer.com/oauth/access_token.php",[0m
[30;1m101 | [0m[35m        params={"code": code, "app_id": app_id, "secret": app_secret},[0m
[30;1m102 | [0m[35m        ssl=False,[0m

[31m--[ [0m[34mMatch #[0m[33m691[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/deezer/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m315 | [0m[35m        """Get playlist tracks."""[0m
[30;1m316 | [0m[35m        result: list[Track] = [][0m
[30;1m317 | [0m[35m        if page > 0:[0m
[30;1m318 | [0m[35m            # paging not supported, we always return the whole list at once[0m
[30;1m319 | [0m[35m            return [][0m
[30;1m320 | [0m[35m        # TODO: access the underlying paging on the deezer api (if possible))[0m
[30;1m321 | [0m[35m        playlist = await self.client.get_playlist(int(prov_playlist_id))[0m

[31m--[ [0m[34mMatch #[0m[33m692[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/deezer/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m462 | [0m[35m        """Return the audio stream for the provider item."""[0m
[30;1m463 | [0m[35m        blowfish_key = self.get_blowfish_key(streamdetails.data["track_id"])[0m
[30;1m464 | [0m[35m        chunk_index = 0[0m
[30;1m465 | [0m[35m        timeout = ClientTimeout(total=0, connect=30, sock_read=600)[0m
[30;1m466 | [0m[35m        headers = {}[0m
[30;1m467 | [0m[35m        # if seek_position and streamdetails.size:[0m
[30;1m468 | [0m[35m        #     chunk_count = ceil(streamdetails.size / 2048)[0m

[31m--[ [0m[34mMatch #[0m[33m693[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/deezer/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m336 | [0m[35m        return [self.parse_album(album=album) async for album in await artist.get_albums()][0m
[30;1m337 | [0m[35m[0m
[30;1m338 | [0m[35m    async def get_artist_toptracks(self, prov_artist_id: str) -> list[Track]:[0m
[30;1m339 | [0m[35m        """Get top 50 tracks of an artist."""[0m
[30;1m340 | [0m[35m        artist = await self.client.get_artist(artist_id=int(prov_artist_id))[0m
[30;1m341 | [0m[35m        return [[0m
[30;1m342 | [0m[35m            self.parse_track(track=track, user_country=self.gw_client.user_country)[0m

[31m--[ [0m[34mMatch #[0m[33m694[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m938 | [0m[35m        """Parse and YTM thumbnails to MediaItemImage."""[0m
[30;1m939 | [0m[35m        result: list[MediaItemImage] = [][0m
[30;1m940 | [0m[35m        processed_images = set()[0m
[30;1m941 | [0m[35m        for img in sorted(thumbnails_obj, key=lambda w: w.get("width", 0), reverse=True):[0m
[30;1m942 | [0m[35m            url: str = img["url"][0m
[30;1m943 | [0m[35m            url_base = url.split("=w")[0][0m
[30;1m944 | [0m[35m            width: int = img["width"][0m

[31m--[ [0m[34mMatch #[0m[33m695[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m921 | [0m[35m        """Ping the PO Token server and verify the response."""[0m
[30;1m922 | [0m[35m        url = f"{self._po_token_server_url}/ping"[0m
[30;1m923 | [0m[35m        try:[0m
[30;1m924 | [0m[35m            async with self.mass.http_session.get(url) as response:[0m
[30;1m925 | [0m[35m                response.raise_for_status()[0m
[30;1m926 | [0m[35m                self.logger.debug("PO Token server responded with %s", response.status)[0m
[30;1m927 | [0m[35m                return response.status == 200[0m

[31m--[ [0m[34mMatch #[0m[33m696[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m915 | [0m[35m        artist_id = artist_obj.get("id") or artist_obj.get("channelId")[0m
[30;1m916 | [0m[35m        if not artist_id and artist_obj["name"] == "Various Artists":[0m
[30;1m917 | [0m[35m            artist_id = VARIOUS_ARTISTS_YTM_ID[0m
[30;1m918 | [0m[35m        return self._get_item_mapping(MediaType.ARTIST, artist_id, artist_obj.get("name"))[0m
[30;1m919 | [0m[35m[0m
[30;1m920 | [0m[35m    async def _verify_po_token_url(self) -> bool:[0m
[30;1m921 | [0m[35m        """Ping the PO Token server and verify the response."""[0m

[31m--[ [0m[34mMatch #[0m[33m697[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m912 | [0m[35m        )[0m
[30;1m913 | [0m[35m[0m
[30;1m914 | [0m[35m    def _get_artist_item_mapping(self, artist_obj: dict) -> ItemMapping:[0m
[30;1m915 | [0m[35m        artist_id = artist_obj.get("id") or artist_obj.get("channelId")[0m
[30;1m916 | [0m[35m        if not artist_id and artist_obj["name"] == "Various Artists":[0m
[30;1m917 | [0m[35m            artist_id = VARIOUS_ARTISTS_YTM_ID[0m
[30;1m918 | [0m[35m        return self._get_item_mapping(MediaType.ARTIST, artist_id, artist_obj.get("name"))[0m

[31m--[ [0m[34mMatch #[0m[33m698[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m912 | [0m[35m        )[0m
[30;1m913 | [0m[35m[0m
[30;1m914 | [0m[35m    def _get_artist_item_mapping(self, artist_obj: dict) -> ItemMapping:[0m
[30;1m915 | [0m[35m        artist_id = artist_obj.get("id") or artist_obj.get("channelId")[0m
[30;1m916 | [0m[35m        if not artist_id and artist_obj["name"] == "Various Artists":[0m
[30;1m917 | [0m[35m            artist_id = VARIOUS_ARTISTS_YTM_ID[0m
[30;1m918 | [0m[35m        return self._get_item_mapping(MediaType.ARTIST, artist_id, artist_obj.get("name"))[0m

[31m--[ [0m[34mMatch #[0m[33m699[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m867 | [0m[35m            episode.metadata.description = description[0m
[30;1m868 | [0m[35m        if thumbnails := episode_obj.get("thumbnails"):[0m
[30;1m869 | [0m[35m            episode.metadata.images = self._parse_thumbnails(thumbnails)[0m
[30;1m870 | [0m[35m        if release_date := episode_obj.get("date"):[0m
[30;1m871 | [0m[35m            with suppress(ValueError):[0m
[30;1m872 | [0m[35m                episode.metadata.release_date = datetime.fromisoformat(release_date)[0m
[30;1m873 | [0m[35m        return episode[0m

[31m--[ [0m[34mMatch #[0m[33m700[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m865 | [0m[35m            episode.duration = duration_sec[0m
[30;1m866 | [0m[35m        if description := episode_obj.get("description"):[0m
[30;1m867 | [0m[35m            episode.metadata.description = description[0m
[30;1m868 | [0m[35m        if thumbnails := episode_obj.get("thumbnails"):[0m
[30;1m869 | [0m[35m            episode.metadata.images = self._parse_thumbnails(thumbnails)[0m
[30;1m870 | [0m[35m        if release_date := episode_obj.get("date"):[0m
[30;1m871 | [0m[35m            with suppress(ValueError):[0m

[31m--[ [0m[34mMatch #[0m[33m701[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m863 | [0m[35m        if duration := episode_obj.get("duration"):[0m
[30;1m864 | [0m[35m            duration_sec = parse_str_duration(duration)[0m
[30;1m865 | [0m[35m            episode.duration = duration_sec[0m
[30;1m866 | [0m[35m        if description := episode_obj.get("description"):[0m
[30;1m867 | [0m[35m            episode.metadata.description = description[0m
[30;1m868 | [0m[35m        if thumbnails := episode_obj.get("thumbnails"):[0m
[30;1m869 | [0m[35m            episode.metadata.images = self._parse_thumbnails(thumbnails)[0m

[31m--[ [0m[34mMatch #[0m[33m702[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m860 | [0m[35m                )[0m
[30;1m861 | [0m[35m            },[0m
[30;1m862 | [0m[35m        )[0m
[30;1m863 | [0m[35m        if duration := episode_obj.get("duration"):[0m
[30;1m864 | [0m[35m            duration_sec = parse_str_duration(duration)[0m
[30;1m865 | [0m[35m            episode.duration = duration_sec[0m
[30;1m866 | [0m[35m        if description := episode_obj.get("description"):[0m

[31m--[ [0m[34mMatch #[0m[33m703[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m846 | [0m[35m        episode = PodcastEpisode([0m
[30;1m847 | [0m[35m            item_id=item_id,[0m
[30;1m848 | [0m[35m            provider=self.lookup_key,[0m
[30;1m849 | [0m[35m            name=episode_obj.get("title"),[0m
[30;1m850 | [0m[35m            podcast=podcast,[0m
[30;1m851 | [0m[35m            provider_mappings={[0m
[30;1m852 | [0m[35m                ProviderMapping([0m

[31m--[ [0m[34mMatch #[0m[33m704[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m838 | [0m[35m[0m
[30;1m839 | [0m[35m    def _parse_podcast_episode(self, episode_obj: dict, podcast: Podcast | None) -> PodcastEpisode:[0m
[30;1m840 | [0m[35m        """Parse a raw episode into a PodcastEpisode."""[0m
[30;1m841 | [0m[35m        episode_id = episode_obj.get("videoId")[0m
[30;1m842 | [0m[35m        if not episode_id:[0m
[30;1m843 | [0m[35m            msg = "Podcast episode is missing videoId"[0m
[30;1m844 | [0m[35m            raise InvalidDataError(msg)[0m

[31m--[ [0m[34mMatch #[0m[33m705[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m832 | [0m[35m            podcast.metadata.description = description[0m
[30;1m833 | [0m[35m        if author := podcast_obj.get("author"):[0m
[30;1m834 | [0m[35m            podcast.publisher = author["name"][0m
[30;1m835 | [0m[35m        if thumbnails := podcast_obj.get("thumbnails"):[0m
[30;1m836 | [0m[35m            podcast.metadata.images = self._parse_thumbnails(thumbnails)[0m
[30;1m837 | [0m[35m        return podcast[0m
[30;1m838 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m706[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m830 | [0m[35m        )[0m
[30;1m831 | [0m[35m        if description := podcast_obj.get("description"):[0m
[30;1m832 | [0m[35m            podcast.metadata.description = description[0m
[30;1m833 | [0m[35m        if author := podcast_obj.get("author"):[0m
[30;1m834 | [0m[35m            podcast.publisher = author["name"][0m
[30;1m835 | [0m[35m        if thumbnails := podcast_obj.get("thumbnails"):[0m
[30;1m836 | [0m[35m            podcast.metadata.images = self._parse_thumbnails(thumbnails)[0m

[31m--[ [0m[34mMatch #[0m[33m707[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m828 | [0m[35m                )[0m
[30;1m829 | [0m[35m            },[0m
[30;1m830 | [0m[35m        )[0m
[30;1m831 | [0m[35m        if description := podcast_obj.get("description"):[0m
[30;1m832 | [0m[35m            podcast.metadata.description = description[0m
[30;1m833 | [0m[35m        if author := podcast_obj.get("author"):[0m
[30;1m834 | [0m[35m            podcast.publisher = author["name"][0m

[31m--[ [0m[34mMatch #[0m[33m708[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m802 | [0m[35m        if ([0m
[30;1m803 | [0m[35m            track_obj.get("album")[0m
[30;1m804 | [0m[35m            and isinstance(track_obj.get("album"), dict)[0m
[30;1m805 | [0m[35m            and track_obj["album"].get("id")[0m
[30;1m806 | [0m[35m        ):[0m
[30;1m807 | [0m[35m            album = track_obj["album"][0m
[30;1m808 | [0m[35m            track.album = self._get_item_mapping(MediaType.ALBUM, album["id"], album["name"])[0m

[31m--[ [0m[34mMatch #[0m[33m709[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m801 | [0m[35m            track.metadata.images = self._parse_thumbnails(track_obj["thumbnails"])[0m
[30;1m802 | [0m[35m        if ([0m
[30;1m803 | [0m[35m            track_obj.get("album")[0m
[30;1m804 | [0m[35m            and isinstance(track_obj.get("album"), dict)[0m
[30;1m805 | [0m[35m            and track_obj["album"].get("id")[0m
[30;1m806 | [0m[35m        ):[0m
[30;1m807 | [0m[35m            album = track_obj["album"][0m

[31m--[ [0m[34mMatch #[0m[33m710[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m800 | [0m[35m        if track_obj.get("thumbnails"):[0m
[30;1m801 | [0m[35m            track.metadata.images = self._parse_thumbnails(track_obj["thumbnails"])[0m
[30;1m802 | [0m[35m        if ([0m
[30;1m803 | [0m[35m            track_obj.get("album")[0m
[30;1m804 | [0m[35m            and isinstance(track_obj.get("album"), dict)[0m
[30;1m805 | [0m[35m            and track_obj["album"].get("id")[0m
[30;1m806 | [0m[35m        ):[0m

[31m--[ [0m[34mMatch #[0m[33m711[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m797 | [0m[35m        if not track.artists:[0m
[30;1m798 | [0m[35m            msg = "Track is missing artists"[0m
[30;1m799 | [0m[35m            raise InvalidDataError(msg)[0m
[30;1m800 | [0m[35m        if track_obj.get("thumbnails"):[0m
[30;1m801 | [0m[35m            track.metadata.images = self._parse_thumbnails(track_obj["thumbnails"])[0m
[30;1m802 | [0m[35m        if ([0m
[30;1m803 | [0m[35m            track_obj.get("album")[0m

[31m--[ [0m[34mMatch #[0m[33m712[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m791 | [0m[35m                for artist in track_obj["artists"][0m
[30;1m792 | [0m[35m                if artist.get("id")[0m
[30;1m793 | [0m[35m                or artist.get("channelId")[0m
[30;1m794 | [0m[35m                or artist.get("name") == "Various Artists"[0m
[30;1m795 | [0m[35m            ][0m
[30;1m796 | [0m[35m        # guard that track has valid artists[0m
[30;1m797 | [0m[35m        if not track.artists:[0m

[31m--[ [0m[34mMatch #[0m[33m713[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m790 | [0m[35m                self._get_artist_item_mapping(artist)[0m
[30;1m791 | [0m[35m                for artist in track_obj["artists"][0m
[30;1m792 | [0m[35m                if artist.get("id")[0m
[30;1m793 | [0m[35m                or artist.get("channelId")[0m
[30;1m794 | [0m[35m                or artist.get("name") == "Various Artists"[0m
[30;1m795 | [0m[35m            ][0m
[30;1m796 | [0m[35m        # guard that track has valid artists[0m

[31m--[ [0m[34mMatch #[0m[33m714[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m789 | [0m[35m            track.artists = [[0m
[30;1m790 | [0m[35m                self._get_artist_item_mapping(artist)[0m
[30;1m791 | [0m[35m                for artist in track_obj["artists"][0m
[30;1m792 | [0m[35m                if artist.get("id")[0m
[30;1m793 | [0m[35m                or artist.get("channelId")[0m
[30;1m794 | [0m[35m                or artist.get("name") == "Various Artists"[0m
[30;1m795 | [0m[35m            ][0m

[31m--[ [0m[34mMatch #[0m[33m715[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m785 | [0m[35m            track_number=track_obj.get("trackNumber", 0),[0m
[30;1m786 | [0m[35m        )[0m
[30;1m787 | [0m[35m[0m
[30;1m788 | [0m[35m        if track_obj.get("artists"):[0m
[30;1m789 | [0m[35m            track.artists = [[0m
[30;1m790 | [0m[35m                self._get_artist_item_mapping(artist)[0m
[30;1m791 | [0m[35m                for artist in track_obj["artists"][0m

[31m--[ [0m[34mMatch #[0m[33m716[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m782 | [0m[35m                )[0m
[30;1m783 | [0m[35m            },[0m
[30;1m784 | [0m[35m            disc_number=0,  # not supported on YTM?[0m
[30;1m785 | [0m[35m            track_number=track_obj.get("trackNumber", 0),[0m
[30;1m786 | [0m[35m        )[0m
[30;1m787 | [0m[35m[0m
[30;1m788 | [0m[35m        if track_obj.get("artists"):[0m

[31m--[ [0m[34mMatch #[0m[33m717[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m774 | [0m[35m                    item_id=track_id,[0m
[30;1m775 | [0m[35m                    provider_domain=self.domain,[0m
[30;1m776 | [0m[35m                    provider_instance=self.instance_id,[0m
[30;1m777 | [0m[35m                    available=track_obj.get("isAvailable", True),[0m
[30;1m778 | [0m[35m                    url=f"{YTM_DOMAIN}/watch?v={track_id}",[0m
[30;1m779 | [0m[35m                    audio_format=AudioFormat([0m
[30;1m780 | [0m[35m                        content_type=ContentType.M4A,[0m

[31m--[ [0m[34mMatch #[0m[33m718[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m761 | [0m[35m[0m
[30;1m762 | [0m[35m    def _parse_track(self, track_obj: dict) -> Track:[0m
[30;1m763 | [0m[35m        """Parse a YT Track response to a Track model object."""[0m
[30;1m764 | [0m[35m        if not track_obj.get("videoId"):[0m
[30;1m765 | [0m[35m            msg = "Track is missing videoId"[0m
[30;1m766 | [0m[35m            raise InvalidDataError(msg)[0m
[30;1m767 | [0m[35m        track_id = str(track_obj["videoId"])[0m

[31m--[ [0m[34mMatch #[0m[33m719[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m756 | [0m[35m                playlist.owner = authors["name"][0m
[30;1m757 | [0m[35m        else:[0m
[30;1m758 | [0m[35m            playlist.owner = self.name[0m
[30;1m759 | [0m[35m        playlist.cache_checksum = playlist_obj.get("checksum")[0m
[30;1m760 | [0m[35m        return playlist[0m
[30;1m761 | [0m[35m[0m
[30;1m762 | [0m[35m    def _parse_track(self, track_obj: dict) -> Track:[0m

[31m--[ [0m[34mMatch #[0m[33m720[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m747 | [0m[35m        if playlist_obj.get("thumbnails"):[0m
[30;1m748 | [0m[35m            playlist.metadata.images = self._parse_thumbnails(playlist_obj["thumbnails"])[0m
[30;1m749 | [0m[35m[0m
[30;1m750 | [0m[35m        if authors := playlist_obj.get("author"):[0m
[30;1m751 | [0m[35m            if isinstance(authors, str):[0m
[30;1m752 | [0m[35m                playlist.owner = authors[0m
[30;1m753 | [0m[35m            elif isinstance(authors, list):[0m

[31m--[ [0m[34mMatch #[0m[33m721[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m744 | [0m[35m        )[0m
[30;1m745 | [0m[35m        if "description" in playlist_obj:[0m
[30;1m746 | [0m[35m            playlist.metadata.description = playlist_obj["description"][0m
[30;1m747 | [0m[35m        if playlist_obj.get("thumbnails"):[0m
[30;1m748 | [0m[35m            playlist.metadata.images = self._parse_thumbnails(playlist_obj["thumbnails"])[0m
[30;1m749 | [0m[35m[0m
[30;1m750 | [0m[35m        if authors := playlist_obj.get("author"):[0m

[31m--[ [0m[34mMatch #[0m[33m722[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m722 | [0m[35m        """Parse a YT Playlist response to a Playlist object."""[0m
[30;1m723 | [0m[35m        playlist_id = playlist_obj["id"][0m
[30;1m724 | [0m[35m        playlist_name = playlist_obj["title"][0m
[30;1m725 | [0m[35m        is_editable = playlist_obj.get("privacy", "") == "PRIVATE"[0m
[30;1m726 | [0m[35m        # Playlist ID's are not unique across instances for lists like 'Likes', 'Supermix', etc.[0m
[30;1m727 | [0m[35m        # So suffix with the instance id to make them unique[0m
[30;1m728 | [0m[35m        if playlist_id in YT_PERSONAL_PLAYLISTS:[0m

[31m--[ [0m[34mMatch #[0m[33m723[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m714 | [0m[35m        )[0m
[30;1m715 | [0m[35m        if "description" in artist_obj:[0m
[30;1m716 | [0m[35m            artist.metadata.description = artist_obj["description"][0m
[30;1m717 | [0m[35m        if artist_obj.get("thumbnails"):[0m
[30;1m718 | [0m[35m            artist.metadata.images = self._parse_thumbnails(artist_obj["thumbnails"])[0m
[30;1m719 | [0m[35m        return artist[0m
[30;1m720 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m724[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m692 | [0m[35m        artist_id = None[0m
[30;1m693 | [0m[35m        if "channelId" in artist_obj:[0m
[30;1m694 | [0m[35m            artist_id = artist_obj["channelId"][0m
[30;1m695 | [0m[35m        elif artist_obj.get("id"):[0m
[30;1m696 | [0m[35m            artist_id = artist_obj["id"][0m
[30;1m697 | [0m[35m        elif artist_obj["name"] == "Various Artists":[0m
[30;1m698 | [0m[35m            artist_id = VARIOUS_ARTISTS_YTM_ID[0m

[31m--[ [0m[34mMatch #[0m[33m725[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m673 | [0m[35m                for artist in album_obj["artists"][0m
[30;1m674 | [0m[35m                if artist.get("id")[0m
[30;1m675 | [0m[35m                or artist.get("channelId")[0m
[30;1m676 | [0m[35m                or artist.get("name") == "Various Artists"[0m
[30;1m677 | [0m[35m            ][0m
[30;1m678 | [0m[35m        if "type" in album_obj:[0m
[30;1m679 | [0m[35m            if album_obj["type"] == "Single":[0m

[31m--[ [0m[34mMatch #[0m[33m726[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m672 | [0m[35m                self._get_artist_item_mapping(artist)[0m
[30;1m673 | [0m[35m                for artist in album_obj["artists"][0m
[30;1m674 | [0m[35m                if artist.get("id")[0m
[30;1m675 | [0m[35m                or artist.get("channelId")[0m
[30;1m676 | [0m[35m                or artist.get("name") == "Various Artists"[0m
[30;1m677 | [0m[35m            ][0m
[30;1m678 | [0m[35m        if "type" in album_obj:[0m

[31m--[ [0m[34mMatch #[0m[33m727[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m671 | [0m[35m            album.artists = [[0m
[30;1m672 | [0m[35m                self._get_artist_item_mapping(artist)[0m
[30;1m673 | [0m[35m                for artist in album_obj["artists"][0m
[30;1m674 | [0m[35m                if artist.get("id")[0m
[30;1m675 | [0m[35m                or artist.get("channelId")[0m
[30;1m676 | [0m[35m                or artist.get("name") == "Various Artists"[0m
[30;1m677 | [0m[35m            ][0m

[31m--[ [0m[34mMatch #[0m[33m728[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m663 | [0m[35m            album.year = album_obj["year"][0m
[30;1m664 | [0m[35m        if "thumbnails" in album_obj:[0m
[30;1m665 | [0m[35m            album.metadata.images = self._parse_thumbnails(album_obj["thumbnails"])[0m
[30;1m666 | [0m[35m        if description := album_obj.get("description"):[0m
[30;1m667 | [0m[35m            album.metadata.description = unquote(description)[0m
[30;1m668 | [0m[35m        if "isExplicit" in album_obj:[0m
[30;1m669 | [0m[35m            album.metadata.explicit = album_obj["isExplicit"][0m

[31m--[ [0m[34mMatch #[0m[33m729[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m659 | [0m[35m                )[0m
[30;1m660 | [0m[35m            },[0m
[30;1m661 | [0m[35m        )[0m
[30;1m662 | [0m[35m        if album_obj.get("year") and album_obj["year"].isdigit():[0m
[30;1m663 | [0m[35m            album.year = album_obj["year"][0m
[30;1m664 | [0m[35m        if "thumbnails" in album_obj:[0m
[30;1m665 | [0m[35m            album.metadata.images = self._parse_thumbnails(album_obj["thumbnails"])[0m

[31m--[ [0m[34mMatch #[0m[33m730[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m641 | [0m[35m[0m
[30;1m642 | [0m[35m    def _parse_album(self, album_obj: dict, album_id: str | None = None) -> Album:[0m
[30;1m643 | [0m[35m        """Parse a YT Album response to an Album model object."""[0m
[30;1m644 | [0m[35m        album_id = album_id or album_obj.get("id") or album_obj.get("browseId")[0m
[30;1m645 | [0m[35m        if "title" in album_obj:[0m
[30;1m646 | [0m[35m            name = album_obj["title"][0m
[30;1m647 | [0m[35m        elif "name" in album_obj:[0m

[31m--[ [0m[34mMatch #[0m[33m731[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m641 | [0m[35m[0m
[30;1m642 | [0m[35m    def _parse_album(self, album_obj: dict, album_id: str | None = None) -> Album:[0m
[30;1m643 | [0m[35m        """Parse a YT Album response to an Album model object."""[0m
[30;1m644 | [0m[35m        album_id = album_id or album_obj.get("id") or album_obj.get("browseId")[0m
[30;1m645 | [0m[35m        if "title" in album_obj:[0m
[30;1m646 | [0m[35m            name = album_obj["title"][0m
[30;1m647 | [0m[35m        elif "name" in album_obj:[0m

[31m--[ [0m[34mMatch #[0m[33m732[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m603 | [0m[35m[0m
[30;1m604 | [0m[35m    async def _get_data(self, url: str, params: dict | None = None):[0m
[30;1m605 | [0m[35m        """Get data from the given URL."""[0m
[30;1m606 | [0m[35m        async with self.mass.http_session.get([0m
[30;1m607 | [0m[35m            url, headers=self._headers, params=params, cookies=self._cookies[0m
[30;1m608 | [0m[35m        ) as response:[0m
[30;1m609 | [0m[35m            return await response.text()[0m

[31m--[ [0m[34mMatch #[0m[33m733[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m592 | [0m[35m        """Post data to the given endpoint."""[0m
[30;1m593 | [0m[35m        url = f"{YTM_BASE_URL}{endpoint}"[0m
[30;1m594 | [0m[35m        data.update(self._context)[0m
[30;1m595 | [0m[35m        async with self.mass.http_session.post([0m
[30;1m596 | [0m[35m            url,[0m
[30;1m597 | [0m[35m            headers=self._headers,[0m
[30;1m598 | [0m[35m            json=data,[0m

[31m--[ [0m[34mMatch #[0m[33m734[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m585 | [0m[35m        ):[0m
[30;1m586 | [0m[35m            stream_details.audio_format.channels = int(stream_format.get("audio_channels"))[0m
[30;1m587 | [0m[35m        if stream_format.get("asr"):[0m
[30;1m588 | [0m[35m            stream_details.audio_format.sample_rate = int(stream_format.get("asr"))[0m
[30;1m589 | [0m[35m        return stream_details[0m
[30;1m590 | [0m[35m[0m
[30;1m591 | [0m[35m    async def _post_data(self, endpoint: str, data: dict[str, str], **kwargs):[0m

[31m--[ [0m[34mMatch #[0m[33m735[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m584 | [0m[35m            and str(stream_format.get("audio_channels")).isdigit()[0m
[30;1m585 | [0m[35m        ):[0m
[30;1m586 | [0m[35m            stream_details.audio_format.channels = int(stream_format.get("audio_channels"))[0m
[30;1m587 | [0m[35m        if stream_format.get("asr"):[0m
[30;1m588 | [0m[35m            stream_details.audio_format.sample_rate = int(stream_format.get("asr"))[0m
[30;1m589 | [0m[35m        return stream_details[0m
[30;1m590 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m736[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m583 | [0m[35m            stream_format.get("audio_channels")[0m
[30;1m584 | [0m[35m            and str(stream_format.get("audio_channels")).isdigit()[0m
[30;1m585 | [0m[35m        ):[0m
[30;1m586 | [0m[35m            stream_details.audio_format.channels = int(stream_format.get("audio_channels"))[0m
[30;1m587 | [0m[35m        if stream_format.get("asr"):[0m
[30;1m588 | [0m[35m            stream_details.audio_format.sample_rate = int(stream_format.get("asr"))[0m
[30;1m589 | [0m[35m        return stream_details[0m

[31m--[ [0m[34mMatch #[0m[33m737[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m581 | [0m[35m        )[0m
[30;1m582 | [0m[35m        if ([0m
[30;1m583 | [0m[35m            stream_format.get("audio_channels")[0m
[30;1m584 | [0m[35m            and str(stream_format.get("audio_channels")).isdigit()[0m
[30;1m585 | [0m[35m        ):[0m
[30;1m586 | [0m[35m            stream_details.audio_format.channels = int(stream_format.get("audio_channels"))[0m
[30;1m587 | [0m[35m        if stream_format.get("asr"):[0m

[31m--[ [0m[34mMatch #[0m[33m738[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m580 | [0m[35m            allow_seek=True,[0m
[30;1m581 | [0m[35m        )[0m
[30;1m582 | [0m[35m        if ([0m
[30;1m583 | [0m[35m            stream_format.get("audio_channels")[0m
[30;1m584 | [0m[35m            and str(stream_format.get("audio_channels")).isdigit()[0m
[30;1m585 | [0m[35m        ):[0m
[30;1m586 | [0m[35m            stream_details.audio_format.channels = int(stream_format.get("audio_channels"))[0m

[31m--[ [0m[34mMatch #[0m[33m739[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m442 | [0m[35m        podcast = self._parse_podcast(podcast_obj)[0m
[30;1m443 | [0m[35m        for index, episode_obj in enumerate(podcast_obj.get("episodes", []), start=1):[0m
[30;1m444 | [0m[35m            episode = self._parse_podcast_episode(episode_obj, podcast)[0m
[30;1m445 | [0m[35m            ep_index = episode_obj.get("index") or index[0m
[30;1m446 | [0m[35m            episode.position = ep_index[0m
[30;1m447 | [0m[35m            yield episode[0m
[30;1m448 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m740[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m440 | [0m[35m        podcast_obj = await get_podcast(prov_podcast_id, headers=self._headers)[0m
[30;1m441 | [0m[35m        podcast_obj["podcastId"] = prov_podcast_id[0m
[30;1m442 | [0m[35m        podcast = self._parse_podcast(podcast_obj)[0m
[30;1m443 | [0m[35m        for index, episode_obj in enumerate(podcast_obj.get("episodes", []), start=1):[0m
[30;1m444 | [0m[35m            episode = self._parse_podcast_episode(episode_obj, podcast)[0m
[30;1m445 | [0m[35m            ep_index = episode_obj.get("index") or index[0m
[30;1m446 | [0m[35m            episode.position = ep_index[0m

[31m--[ [0m[34mMatch #[0m[33m741[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m422 | [0m[35m    async def get_artist_toptracks(self, prov_artist_id) -> list[Track]:[0m
[30;1m423 | [0m[35m        """Get a list of 25 most popular tracks for the given artist."""[0m
[30;1m424 | [0m[35m        artist_obj = await get_artist(prov_artist_id=prov_artist_id, headers=self._headers)[0m
[30;1m425 | [0m[35m        if artist_obj.get("songs") and artist_obj["songs"].get("browseId"):[0m
[30;1m426 | [0m[35m            prov_playlist_id = artist_obj["songs"]["browseId"][0m
[30;1m427 | [0m[35m            playlist_tracks = await self.get_playlist_tracks(prov_playlist_id)[0m
[30;1m428 | [0m[35m            return playlist_tracks[:25][0m

[31m--[ [0m[34mMatch #[0m[33m742[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m422 | [0m[35m    async def get_artist_toptracks(self, prov_artist_id) -> list[Track]:[0m
[30;1m423 | [0m[35m        """Get a list of 25 most popular tracks for the given artist."""[0m
[30;1m424 | [0m[35m        artist_obj = await get_artist(prov_artist_id=prov_artist_id, headers=self._headers)[0m
[30;1m425 | [0m[35m        if artist_obj.get("songs") and artist_obj["songs"].get("browseId"):[0m
[30;1m426 | [0m[35m            prov_playlist_id = artist_obj["songs"]["browseId"][0m
[30;1m427 | [0m[35m            playlist_tracks = await self.get_playlist_tracks(prov_playlist_id)[0m
[30;1m428 | [0m[35m            return playlist_tracks[:25][0m

[31m--[ [0m[34mMatch #[0m[33m743[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m324 | [0m[35m    async def get_album_tracks(self, prov_album_id: str) -> list[Track]:[0m
[30;1m325 | [0m[35m        """Get album tracks for given album id."""[0m
[30;1m326 | [0m[35m        album_obj = await get_album(prov_album_id=prov_album_id, language=self.language)[0m
[30;1m327 | [0m[35m        if not album_obj.get("tracks"):[0m
[30;1m328 | [0m[35m            return [][0m
[30;1m329 | [0m[35m        tracks = [][0m
[30;1m330 | [0m[35m        for track_obj in album_obj["tracks"]:[0m

[31m--[ [0m[34mMatch #[0m[33m744[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m373 | [0m[35m    async def get_playlist_tracks(self, prov_playlist_id: str, page: int = 0) -> list[Track]:[0m
[30;1m374 | [0m[35m        """Return playlist tracks for the given provider playlist id."""[0m
[30;1m375 | [0m[35m        if page > 0:[0m
[30;1m376 | [0m[35m            # paging not supported, we always return the whole list at once[0m
[30;1m377 | [0m[35m            return [][0m
[30;1m378 | [0m[35m        # Grab the playlist id from the full url in case of personal playlists[0m
[30;1m379 | [0m[35m        if YT_PLAYLIST_ID_DELIMITER in prov_playlist_id:[0m

[31m--[ [0m[34mMatch #[0m[33m745[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/radiobrowser/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m75 | [0m[35m    # ruff: noqa: ARG001 D205[0m
[30;1m76 | [0m[35m    return ([0m
[30;1m77 | [0m[35m        ConfigEntry([0m
[30;1m78 | [0m[35m            # RadioBrowser doesn't support a library feature at all[0m
[30;1m79 | [0m[35m            # but MA users like to favorite their radio stations and[0m
[30;1m80 | [0m[35m            # have that included in backups so we store it in the config.[0m
[30;1m81 | [0m[35m            key=CONF_STORED_RADIOS,[0m

[31m--[ [0m[34mMatch #[0m[33m746[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/radiobrowser/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m36 | [0m[35mSUPPORTED_FEATURES = {[0m
[30;1m37 | [0m[35m    ProviderFeature.SEARCH,[0m
[30;1m38 | [0m[35m    ProviderFeature.BROWSE,[0m
[30;1m39 | [0m[35m    # RadioBrowser doesn't support a library feature at all[0m
[30;1m40 | [0m[35m    # but MA users like to favorite their radio stations and[0m
[30;1m41 | [0m[35m    # have that included in backups so we store it in the config.[0m
[30;1m42 | [0m[35m    ProviderFeature.LIBRARY_RADIOS,[0m

[31m--[ [0m[34mMatch #[0m[33m747[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m282 | [0m[35m            if track.get("thumbnail"):[0m
[30;1m283 | [0m[35m                track["thumbnails"] = track["thumbnail"][0m
[30;1m284 | [0m[35m                del track["thumbnail"][0m
[30;1m285 | [0m[35m            if track.get("length"):[0m
[30;1m286 | [0m[35m                track["duration"] = get_sec(track["length"])[0m
[30;1m287 | [0m[35m        return result[0m
[30;1m288 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m748[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m279 | [0m[35m        )[0m
[30;1m280 | [0m[35m        # Replace inconsistensies for easier parsing[0m
[30;1m281 | [0m[35m        for track in result["tracks"]:[0m
[30;1m282 | [0m[35m            if track.get("thumbnail"):[0m
[30;1m283 | [0m[35m                track["thumbnails"] = track["thumbnail"][0m
[30;1m284 | [0m[35m                del track["thumbnail"][0m
[30;1m285 | [0m[35m            if track.get("length"):[0m

[31m--[ [0m[34mMatch #[0m[33m749[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m            "thumbnails"[0m
[30;1m87 | [0m[35m        ][0m
[30;1m88 | [0m[35m        if track_thumbs := track_obj["videoDetails"].get("thumbnail", {}).get("thumbnails"):[0m
[30;1m89 | [0m[35m            track["thumbnails"] = track.get("thumbnails", []) + track_thumbs[0m
[30;1m90 | [0m[35m        track["isAvailable"] = track_obj["playabilityStatus"]["status"] == "OK"[0m
[30;1m91 | [0m[35m        return track[0m
[30;1m92 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m750[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m        track["thumbnails"] = track_obj["microformat"]["microformatDataRenderer"]["thumbnail"][[0m
[30;1m86 | [0m[35m            "thumbnails"[0m
[30;1m87 | [0m[35m        ][0m
[30;1m88 | [0m[35m        if track_thumbs := track_obj["videoDetails"].get("thumbnail", {}).get("thumbnails"):[0m
[30;1m89 | [0m[35m            track["thumbnails"] = track.get("thumbnails", []) + track_thumbs[0m
[30;1m90 | [0m[35m        track["isAvailable"] = track_obj["playabilityStatus"]["status"] == "OK"[0m
[30;1m91 | [0m[35m        return track[0m

[31m--[ [0m[34mMatch #[0m[33m751[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m        track["thumbnails"] = track_obj["microformat"]["microformatDataRenderer"]["thumbnail"][[0m
[30;1m86 | [0m[35m            "thumbnails"[0m
[30;1m87 | [0m[35m        ][0m
[30;1m88 | [0m[35m        if track_thumbs := track_obj["videoDetails"].get("thumbnail", {}).get("thumbnails"):[0m
[30;1m89 | [0m[35m            track["thumbnails"] = track.get("thumbnails", []) + track_thumbs[0m
[30;1m90 | [0m[35m        track["isAvailable"] = track_obj["playabilityStatus"]["status"] == "OK"[0m
[30;1m91 | [0m[35m        return track[0m

[31m--[ [0m[34mMatch #[0m[33m752[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m        playlist = ytm.get_playlist(playlistId=prov_playlist_id, limit=None)[0m
[30;1m56 | [0m[35m        playlist["checksum"] = get_playlist_checksum(playlist)[0m
[30;1m57 | [0m[35m        # Fix missing playlist id in some edge cases[0m
[30;1m58 | [0m[35m        playlist["id"] = prov_playlist_id if not playlist.get("id") else playlist["id"][0m
[30;1m59 | [0m[35m        return playlist[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m    return await asyncio.to_thread(_get_playlist)[0m

[31m--[ [0m[34mMatch #[0m[33m753[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/helpers.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m"""Helper module for parsing the Youtube Music API.[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mThis helpers file is an async wrapper around the excellent ytmusicapi package.[0m
[30;1m4 | [0m[35mWhile the ytmusicapi package does an excellent job at parsing the Youtube Music results,[0m
[30;1m5 | [0m[35mit is unfortunately not async, which is required for Music Assistant to run smoothly.[0m
[30;1m6 | [0m[35mThis also nicely separates the parsing logic from the Youtube Music provider logic.[0m
[30;1m7 | [0m[35m"""[0m

[31m--[ [0m[34mMatch #[0m[33m754[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mimport asyncio[0m
[30;1m10 | [0m[35mfrom http.cookies import SimpleCookie[0m
[30;1m11 | [0m[35mfrom time import time[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mimport ytmusicapi[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m755[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/ytmusic/helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mimport asyncio[0m
[30;1m10 | [0m[35mfrom http.cookies import SimpleCookie[0m
[30;1m11 | [0m[35mfrom time import time[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mimport ytmusicapi[0m
[30;1m14 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m756[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/chromecast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m561 | [0m[35m        # so we need to update the group child(s) manually[0m
[30;1m562 | [0m[35m        if castplayer.player.type == PlayerType.GROUP and castplayer.player.powered:[0m
[30;1m563 | [0m[35m            for child_id in castplayer.player.group_childs:[0m
[30;1m564 | [0m[35m                if child := self.castplayers.get(child_id):[0m
[30;1m565 | [0m[35m                    if not child.cast_info.is_multichannel_group:[0m
[30;1m566 | [0m[35m                        continue[0m
[30;1m567 | [0m[35m                    child.player.state = castplayer.player.state[0m

[31m--[ [0m[34mMatch #[0m[33m757[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/chromecast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m505 | [0m[35m        # handle castplayer playing from a group[0m
[30;1m506 | [0m[35m        group_player: CastPlayer | None = None[0m
[30;1m507 | [0m[35m        if castplayer.active_group is not None:[0m
[30;1m508 | [0m[35m            if not (group_player := self.castplayers.get(castplayer.active_group)):[0m
[30;1m509 | [0m[35m                return[0m
[30;1m510 | [0m[35m            status = group_player.cc.media_controller.status[0m
[30;1m511 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m758[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/chromecast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m486 | [0m[35m        ):[0m
[30;1m487 | [0m[35m            # group is being powered off, update group childs[0m
[30;1m488 | [0m[35m            for child_id in castplayer.player.group_childs:[0m
[30;1m489 | [0m[35m                if child := self.castplayers.get(child_id):[0m
[30;1m490 | [0m[35m                    child.player.powered = False[0m
[30;1m491 | [0m[35m                    child.player.active_group = None[0m
[30;1m492 | [0m[35m                    child.player.active_source = None[0m

[31m--[ [0m[34mMatch #[0m[33m759[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/chromecast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m359 | [0m[35m[0m
[30;1m360 | [0m[35m            self.logger.debug("Discovered new or updated chromecast %s", disc_info)[0m
[30;1m361 | [0m[35m[0m
[30;1m362 | [0m[35m            castplayer = self.castplayers.get(player_id)[0m
[30;1m363 | [0m[35m            if castplayer:[0m
[30;1m364 | [0m[35m                # if player was already added, the player will take care of reconnects itself.[0m
[30;1m365 | [0m[35m                castplayer.cast_info.update(disc_info)[0m

[31m--[ [0m[34mMatch #[0m[33m760[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/chromecast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m352 | [0m[35m[0m
[30;1m353 | [0m[35m            player_id = str(disc_info.uuid)[0m
[30;1m354 | [0m[35m[0m
[30;1m355 | [0m[35m            enabled = self.mass.config.get(f"{CONF_PLAYERS}/{player_id}/enabled", True)[0m
[30;1m356 | [0m[35m            if not enabled:[0m
[30;1m357 | [0m[35m                self.logger.debug("Ignoring disabled player: %s", player_id)[0m
[30;1m358 | [0m[35m                return[0m

[31m--[ [0m[34mMatch #[0m[33m761[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/chromecast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m301 | [0m[35m                continue[0m
[30;1m302 | [0m[35m            next_item_id = item["itemId"][0m
[30;1m303 | [0m[35m            # check if the next queue item isn't already queued[0m
[30;1m304 | [0m[35m            if item.get("media", {}).get("customData", {}).get("uri") == media.uri:[0m
[30;1m305 | [0m[35m                return[0m
[30;1m306 | [0m[35m        queuedata = {[0m
[30;1m307 | [0m[35m            "type": "QUEUE_INSERT",[0m

[31m--[ [0m[34mMatch #[0m[33m762[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/chromecast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m301 | [0m[35m                continue[0m
[30;1m302 | [0m[35m            next_item_id = item["itemId"][0m
[30;1m303 | [0m[35m            # check if the next queue item isn't already queued[0m
[30;1m304 | [0m[35m            if item.get("media", {}).get("customData", {}).get("uri") == media.uri:[0m
[30;1m305 | [0m[35m                return[0m
[30;1m306 | [0m[35m        queuedata = {[0m
[30;1m307 | [0m[35m            "type": "QUEUE_INSERT",[0m

[31m--[ [0m[34mMatch #[0m[33m763[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/chromecast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m301 | [0m[35m                continue[0m
[30;1m302 | [0m[35m            next_item_id = item["itemId"][0m
[30;1m303 | [0m[35m            # check if the next queue item isn't already queued[0m
[30;1m304 | [0m[35m            if item.get("media", {}).get("customData", {}).get("uri") == media.uri:[0m
[30;1m305 | [0m[35m                return[0m
[30;1m306 | [0m[35m        queuedata = {[0m
[30;1m307 | [0m[35m            "type": "QUEUE_INSERT",[0m

[31m--[ [0m[34mMatch #[0m[33m764[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/chromecast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m253 | [0m[35m        if castplayer.player.type == PlayerType.GROUP:[0m
[30;1m254 | [0m[35m            active_group = castplayer.player.active_group or castplayer.player.player_id[0m
[30;1m255 | [0m[35m            for child_id in castplayer.player.group_childs:[0m
[30;1m256 | [0m[35m                if child := self.castplayers.get(child_id):[0m
[30;1m257 | [0m[35m                    child.player.powered = powered[0m
[30;1m258 | [0m[35m                    child.player.active_group = active_group if powered else None[0m
[30;1m259 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m765[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/chromecast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m204 | [0m[35m[0m
[30;1m205 | [0m[35m    async def get_player_config_entries(self, player_id: str) -> tuple[ConfigEntry, ...]:[0m
[30;1m206 | [0m[35m        """Return all (provider/player specific) Config Entries for the given player (if any)."""[0m
[30;1m207 | [0m[35m        cast_player = self.castplayers.get(player_id)[0m
[30;1m208 | [0m[35m        base_entries = await super().get_player_config_entries(player_id)[0m
[30;1m209 | [0m[35m        if cast_player and cast_player.player.type == PlayerType.GROUP:[0m
[30;1m210 | [0m[35m            return ([0m

[31m--[ [0m[34mMatch #[0m[33m766[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/chromecast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m99 | [0m[35m    _patched_process_media_status_org(self, data)[0m
[30;1m100 | [0m[35m    for status_msg in data.get("status", []):[0m
[30;1m101 | [0m[35m        if items := status_msg.get("items"):[0m
[30;1m102 | [0m[35m            self.status.current_item_id = status_msg.get("currentItemId", 0)[0m
[30;1m103 | [0m[35m            self.status.items = items[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m767[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/chromecast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m98 | [0m[35m    """Process STATUS message(s) of the media controller."""[0m
[30;1m99 | [0m[35m    _patched_process_media_status_org(self, data)[0m
[30;1m100 | [0m[35m    for status_msg in data.get("status", []):[0m
[30;1m101 | [0m[35m        if items := status_msg.get("items"):[0m
[30;1m102 | [0m[35m            self.status.current_item_id = status_msg.get("currentItemId", 0)[0m
[30;1m103 | [0m[35m            self.status.items = items[0m
[30;1m104 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m768[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/chromecast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m97 | [0m[35mdef _patched_process_media_status(self, data) -> None:[0m
[30;1m98 | [0m[35m    """Process STATUS message(s) of the media controller."""[0m
[30;1m99 | [0m[35m    _patched_process_media_status_org(self, data)[0m
[30;1m100 | [0m[35m    for status_msg in data.get("status", []):[0m
[30;1m101 | [0m[35m        if items := status_msg.get("items"):[0m
[30;1m102 | [0m[35m            self.status.current_item_id = status_msg.get("currentItemId", 0)[0m
[30;1m103 | [0m[35m            self.status.items = items[0m

[31m--[ [0m[34mMatch #[0m[33m769[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/chromecast/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m700 | [0m[35m            return[0m
[30;1m701 | [0m[35m        castplayer.player.poll_interval = 10[0m
[30;1m702 | [0m[35m        media_controller = castplayer.cc.media_controller[0m
[30;1m703 | [0m[35m        # update metadata of current item chromecast[0m
[30;1m704 | [0m[35m        if media_controller.status.media_custom_data["queue_item_id"] != current_item.queue_item_id:[0m
[30;1m705 | [0m[35m            image_url = ([0m
[30;1m706 | [0m[35m                self.mass.metadata.get_image_url(current_item.image, size=512)[0m

[31m--[ [0m[34mMatch #[0m[33m770[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/chromecast/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m579 | [0m[35m        """Handle updated ConnectionStatus."""[0m
[30;1m580 | [0m[35m        self.logger.log([0m
[30;1m581 | [0m[35m            VERBOSE_LOG_LEVEL,[0m
[30;1m582 | [0m[35m            "Received connection status update for %s - status: %s",[0m
[30;1m583 | [0m[35m            castplayer.player.display_name,[0m
[30;1m584 | [0m[35m            status.status,[0m
[30;1m585 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m771[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/chromecast/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m558 | [0m[35m        # weird workaround which is needed for multichannel group childs[0m
[30;1m559 | [0m[35m        # (e.g. a stereo pair within a cast group)[0m
[30;1m560 | [0m[35m        # where it does not receive updates from the group,[0m
[30;1m561 | [0m[35m        # so we need to update the group child(s) manually[0m
[30;1m562 | [0m[35m        if castplayer.player.type == PlayerType.GROUP and castplayer.player.powered:[0m
[30;1m563 | [0m[35m            for child_id in castplayer.player.group_childs:[0m
[30;1m564 | [0m[35m                if child := self.castplayers.get(child_id):[0m

[31m--[ [0m[34mMatch #[0m[33m772[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/chromecast/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m491 | [0m[35m                    child.player.active_group = None[0m
[30;1m492 | [0m[35m                    child.player.active_source = None[0m
[30;1m493 | [0m[35m        castplayer.player.powered = new_powered[0m
[30;1m494 | [0m[35m        # send update to player manager[0m
[30;1m495 | [0m[35m        self.mass.loop.call_soon_threadsafe(self.mass.players.update, castplayer.player_id)[0m
[30;1m496 | [0m[35m[0m
[30;1m497 | [0m[35m    def on_new_media_status(self, castplayer: CastPlayer, status: MediaStatus) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m773[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/chromecast/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m484 | [0m[35m            and not new_powered[0m
[30;1m485 | [0m[35m            and castplayer.player.type == PlayerType.GROUP[0m
[30;1m486 | [0m[35m        ):[0m
[30;1m487 | [0m[35m            # group is being powered off, update group childs[0m
[30;1m488 | [0m[35m            for child_id in castplayer.player.group_childs:[0m
[30;1m489 | [0m[35m                if child := self.castplayers.get(child_id):[0m
[30;1m490 | [0m[35m                    child.player.powered = False[0m

[31m--[ [0m[34mMatch #[0m[33m774[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/chromecast/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m472 | [0m[35m                PlayerFeature.ENQUEUE,[0m
[30;1m473 | [0m[35m            }[0m
[30;1m474 | [0m[35m[0m
[30;1m475 | [0m[35m        # update player status[0m
[30;1m476 | [0m[35m        castplayer.player.name = castplayer.cast_info.friendly_name[0m
[30;1m477 | [0m[35m        castplayer.player.volume_level = int(status.volume_level * 100)[0m
[30;1m478 | [0m[35m        castplayer.player.volume_muted = status.volume_muted[0m

[31m--[ [0m[34mMatch #[0m[33m775[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/chromecast/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m322 | [0m[35m    async def poll_player(self, player_id: str) -> None:[0m
[30;1m323 | [0m[35m        """Poll player for state updates."""[0m
[30;1m324 | [0m[35m        castplayer = self.castplayers[player_id][0m
[30;1m325 | [0m[35m        # only update status of media controller if player is on[0m
[30;1m326 | [0m[35m        if not castplayer.player.powered:[0m
[30;1m327 | [0m[35m            return[0m
[30;1m328 | [0m[35m        if not castplayer.cc.media_controller.is_active:[0m

[31m--[ [0m[34mMatch #[0m[33m776[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/chromecast/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m249 | [0m[35m            castplayer.player.active_group = None[0m
[30;1m250 | [0m[35m            castplayer.player.active_source = None[0m
[30;1m251 | [0m[35m            await asyncio.to_thread(castplayer.cc.quit_app)[0m
[30;1m252 | [0m[35m        # optimistically update the group childs[0m
[30;1m253 | [0m[35m        if castplayer.player.type == PlayerType.GROUP:[0m
[30;1m254 | [0m[35m            active_group = castplayer.player.active_group or castplayer.player.player_id[0m
[30;1m255 | [0m[35m            for child_id in castplayer.player.group_childs:[0m

[31m--[ [0m[34mMatch #[0m[33m777[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/chromecast/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m74 | [0m[35m)[0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m# originally/officially cast supports 96k sample rate (even for groups)[0m
[30;1m77 | [0m[35m# but it seems a (recent?) update broke this ?![0m
[30;1m78 | [0m[35m# For now only set safe default values and let the user try out higher values[0m
[30;1m79 | [0m[35mCONF_ENTRY_SAMPLE_RATES_CAST = create_sample_rates_config_entry([0m
[30;1m80 | [0m[35m    max_sample_rate=192000,[0m

[31m--[ [0m[34mMatch #[0m[33m778[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/chromecast/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m630 | [0m[35m            self.mass.loop.call_soon_threadsafe(event.set)[0m
[30;1m631 | [0m[35m[0m
[30;1m632 | [0m[35m        def launch() -> None:[0m
[30;1m633 | [0m[35m            # Quit the previous app before starting splash screen or media player[0m
[30;1m634 | [0m[35m            if castplayer.cc.app_id is not None:[0m
[30;1m635 | [0m[35m                castplayer.cc.quit_app()[0m
[30;1m636 | [0m[35m            self.logger.debug("Launching App %s.", app_id)[0m

[31m--[ [0m[34mMatch #[0m[33m779[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/chromecast/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m521 | [0m[35m            castplayer.player.state = PlayerState.IDLE[0m
[30;1m522 | [0m[35m            castplayer.player.current_item_id = None[0m
[30;1m523 | [0m[35m[0m
[30;1m524 | [0m[35m        # elapsed time[0m
[30;1m525 | [0m[35m        castplayer.player.elapsed_time_last_updated = time.time()[0m
[30;1m526 | [0m[35m        castplayer.player.elapsed_time = status.adjusted_current_time[0m
[30;1m527 | [0m[35m        if status.player_is_playing:[0m
[30;1m528 | [0m[35m            castplayer.player.elapsed_time = status.adjusted_current_time[0m

[31m--[ [0m[34mMatch #[0m[33m780[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/chromecast/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35mimport contextlib[0m
[30;1m7 | [0m[35mimport logging[0m
[30;1m8 | [0m[35mimport threading[0m
[30;1m9 | [0m[35mimport time[0m
[30;1m10 | [0m[35mfrom dataclasses import dataclass[0m
[30;1m11 | [0m[35mfrom typing import TYPE_CHECKING, Any[0m
[30;1m12 | [0m[35mfrom uuid import UUID[0m
[30;1m13 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m781[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/lastfm_scrobble/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m289 | [0m[35m    if not key or not secret:[0m
[30;1m290 | [0m[35m        raise SetupFailedError("API Key and Secret need to be set")[0m
[30;1m291 | [0m[35m[0m
[30;1m292 | [0m[35m    provider: str = str(config.get(CONF_PROVIDER))[0m
[30;1m293 | [0m[35m[0m
[30;1m294 | [0m[35m    if TYPE_CHECKING:[0m
[30;1m295 | [0m[35m        key = cast("str", key)[0m

[31m--[ [0m[34mMatch #[0m[33m782[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/lastfm_scrobble/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m279 | [0m[35m    key = config.get(CONF_API_KEY)[0m
[30;1m280 | [0m[35m    secret = config.get(CONF_API_SECRET)[0m
[30;1m281 | [0m[35m    session_key = config.get(CONF_SESSION_KEY)[0m
[30;1m282 | [0m[35m    username = config.get(CONF_USERNAME)[0m
[30;1m283 | [0m[35m[0m
[30;1m284 | [0m[35m    assert key[0m
[30;1m285 | [0m[35m    assert key != SECURE_STRING_SUBSTITUTE[0m

[31m--[ [0m[34mMatch #[0m[33m783[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/lastfm_scrobble/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m278 | [0m[35m    """Create a network instance."""[0m
[30;1m279 | [0m[35m    key = config.get(CONF_API_KEY)[0m
[30;1m280 | [0m[35m    secret = config.get(CONF_API_SECRET)[0m
[30;1m281 | [0m[35m    session_key = config.get(CONF_SESSION_KEY)[0m
[30;1m282 | [0m[35m    username = config.get(CONF_USERNAME)[0m
[30;1m283 | [0m[35m[0m
[30;1m284 | [0m[35m    assert key[0m

[31m--[ [0m[34mMatch #[0m[33m784[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/lastfm_scrobble/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m277 | [0m[35mdef get_network(config: dict[str, ConfigValueType]) -> pylast._Network:[0m
[30;1m278 | [0m[35m    """Create a network instance."""[0m
[30;1m279 | [0m[35m    key = config.get(CONF_API_KEY)[0m
[30;1m280 | [0m[35m    secret = config.get(CONF_API_SECRET)[0m
[30;1m281 | [0m[35m    session_key = config.get(CONF_SESSION_KEY)[0m
[30;1m282 | [0m[35m    username = config.get(CONF_USERNAME)[0m
[30;1m283 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m785[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/lastfm_scrobble/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m276 | [0m[35m[0m
[30;1m277 | [0m[35mdef get_network(config: dict[str, ConfigValueType]) -> pylast._Network:[0m
[30;1m278 | [0m[35m    """Create a network instance."""[0m
[30;1m279 | [0m[35m    key = config.get(CONF_API_KEY)[0m
[30;1m280 | [0m[35m    secret = config.get(CONF_API_SECRET)[0m
[30;1m281 | [0m[35m    session_key = config.get(CONF_SESSION_KEY)[0m
[30;1m282 | [0m[35m    username = config.get(CONF_USERNAME)[0m

[31m--[ [0m[34mMatch #[0m[33m786[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/lastfm_scrobble/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m267 | [0m[35m            label="Session key",[0m
[30;1m268 | [0m[35m            hidden=True,[0m
[30;1m269 | [0m[35m            required=False,[0m
[30;1m270 | [0m[35m            value=values.get(CONF_SESSION_KEY) if values else None,[0m
[30;1m271 | [0m[35m        ),[0m
[30;1m272 | [0m[35m    ][0m
[30;1m273 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m787[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/lastfm_scrobble/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m259 | [0m[35m            type=ConfigEntryType.STRING,[0m
[30;1m260 | [0m[35m            label="Logged in user",[0m
[30;1m261 | [0m[35m            hidden=True,[0m
[30;1m262 | [0m[35m            value=values.get(CONF_USERNAME) if values else None,[0m
[30;1m263 | [0m[35m        ),[0m
[30;1m264 | [0m[35m        ConfigEntry([0m
[30;1m265 | [0m[35m            key=CONF_SESSION_KEY,[0m

[31m--[ [0m[34mMatch #[0m[33m788[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/lastfm_scrobble/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m239 | [0m[35m                ),[0m
[30;1m240 | [0m[35m            ][0m
[30;1m241 | [0m[35m[0m
[30;1m242 | [0m[35m    if values is None or not values.get(CONF_SESSION_KEY):[0m
[30;1m243 | [0m[35m        # unable to use the encrypted values during an action[0m
[30;1m244 | [0m[35m        # so we make sure fresh credentials need to be entered[0m
[30;1m245 | [0m[35m        values[CONF_API_KEY] = None[0m

[31m--[ [0m[34mMatch #[0m[33m789[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/lastfm_scrobble/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m223 | [0m[35m                raise LoginFailed(f"no token available in {provider} response")[0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35m            session_key, username = skg.get_web_auth_session_key_username([0m
[30;1m226 | [0m[35m                url, str(response.get("token"))[0m
[30;1m227 | [0m[35m            )[0m
[30;1m228 | [0m[35m            values[CONF_USERNAME] = username[0m
[30;1m229 | [0m[35m            values[CONF_SESSION_KEY] = session_key[0m

[31m--[ [0m[34mMatch #[0m[33m790[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/lastfm_scrobble/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m219 | [0m[35m[0m
[30;1m220 | [0m[35m            logger.info("authenticating on %s", url)[0m
[30;1m221 | [0m[35m            response = await auth_helper.authenticate(url)[0m
[30;1m222 | [0m[35m            if response.get("token") is None:[0m
[30;1m223 | [0m[35m                raise LoginFailed(f"no token available in {provider} response")[0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35m            session_key, username = skg.get_web_auth_session_key_username([0m

[31m--[ [0m[34mMatch #[0m[33m791[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/lastfm_scrobble/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m202 | [0m[35m        return tuple(entries)[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m    if action == CONF_ACTION_AUTH and values.get("session_id") is not None:[0m
[30;1m205 | [0m[35m        session_id = str(values.get("session_id"))[0m
[30;1m206 | [0m[35m[0m
[30;1m207 | [0m[35m        async with AuthenticationHelper(mass, session_id) as auth_helper:[0m
[30;1m208 | [0m[35m            network = get_network(values)[0m

[31m--[ [0m[34mMatch #[0m[33m792[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/lastfm_scrobble/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m201 | [0m[35m    if values is None:[0m
[30;1m202 | [0m[35m        return tuple(entries)[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m    if action == CONF_ACTION_AUTH and values.get("session_id") is not None:[0m
[30;1m205 | [0m[35m        session_id = str(values.get("session_id"))[0m
[30;1m206 | [0m[35m[0m
[30;1m207 | [0m[35m        async with AuthenticationHelper(mass, session_id) as auth_helper:[0m

[31m--[ [0m[34mMatch #[0m[33m793[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/lastfm_scrobble/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m193 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m194 | [0m[35m            label="Shared secret",[0m
[30;1m195 | [0m[35m            required=True,[0m
[30;1m196 | [0m[35m            value=values.get(CONF_API_SECRET) if values else None,[0m
[30;1m197 | [0m[35m        ),[0m
[30;1m198 | [0m[35m    ][0m
[30;1m199 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m794[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/lastfm_scrobble/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m186 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m187 | [0m[35m            label="API Key",[0m
[30;1m188 | [0m[35m            required=True,[0m
[30;1m189 | [0m[35m            value=values.get(CONF_API_KEY) if values else None,[0m
[30;1m190 | [0m[35m        ),[0m
[30;1m191 | [0m[35m        ConfigEntry([0m
[30;1m192 | [0m[35m            key=CONF_API_SECRET,[0m

[31m--[ [0m[34mMatch #[0m[33m795[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/lastfm_scrobble/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35m    provider: str = CONF_OPTION_LASTFM[0m
[30;1m166 | [0m[35m    if values is not None and values.get(CONF_PROVIDER) is not None:[0m
[30;1m167 | [0m[35m        provider = str(values.get(CONF_PROVIDER))[0m
[30;1m168 | [0m[35m[0m
[30;1m169 | [0m[35m    # collect all config entries to show[0m
[30;1m170 | [0m[35m    entries: list[ConfigEntry] = [[0m

[31m--[ [0m[34mMatch #[0m[33m796[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/lastfm_scrobble/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m163 | [0m[35m    logger = logging.getLogger(MASS_LOGGER_NAME).getChild("lastfm")[0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35m    provider: str = CONF_OPTION_LASTFM[0m
[30;1m166 | [0m[35m    if values is not None and values.get(CONF_PROVIDER) is not None:[0m
[30;1m167 | [0m[35m        provider = str(values.get(CONF_PROVIDER))[0m
[30;1m168 | [0m[35m[0m
[30;1m169 | [0m[35m    # collect all config entries to show[0m

[31m--[ [0m[34mMatch #[0m[33m797[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/lastfm_scrobble/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m34 | [0m[35m    provider = LastFMScrobbleProvider(mass, manifest, config)[0m
[30;1m35 | [0m[35m    pylast.logger.setLevel(provider.logger.level)[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    # httpcore is very spammy on debug without providing useful information 99% of the time[0m
[30;1m38 | [0m[35m    if provider.logger.level == logging.DEBUG:[0m
[30;1m39 | [0m[35m        logging.getLogger("httpcore").setLevel(logging.INFO)[0m
[30;1m40 | [0m[35m    else:[0m
[30;1m41 | [0m[35m        logging.getLogger("httpcore").setLevel(logging.WARNING)[0m

[31m--[ [0m[34mMatch #[0m[33m798[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/lastfm_scrobble/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport asyncio[0m
[30;1m4 | [0m[35mimport logging[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35mfrom collections.abc import Callable[0m
[30;1m7 | [0m[35mfrom typing import TYPE_CHECKING, cast[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mimport pylast[0m

[31m--[ [0m[34mMatch #[0m[33m799[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify_connect/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m307 | [0m[35m            self._source_details.metadata.album = album[0m
[30;1m308 | [0m[35m            self._source_details.metadata.image_url = image_url[0m
[30;1m309 | [0m[35m[0m
[30;1m310 | [0m[35m        if event_name == "volume_changed" and (volume := json_data.get("volume")):[0m
[30;1m311 | [0m[35m            # Spotify Connect volume is 0-65535[0m
[30;1m312 | [0m[35m            volume = int(int(volume) / 65535 * 100)[0m
[30;1m313 | [0m[35m            try:[0m

[31m--[ [0m[34mMatch #[0m[33m800[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify_connect/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m295 | [0m[35m            else:[0m
[30;1m296 | [0m[35m                artist = "Unknown"[0m
[30;1m297 | [0m[35m            album = json_data["common_metadata_fields"].get("album", "Unknown")[0m
[30;1m298 | [0m[35m            if images := json_data["common_metadata_fields"].get("covers"):[0m
[30;1m299 | [0m[35m                image_url = images[0][0m
[30;1m300 | [0m[35m            else:[0m
[30;1m301 | [0m[35m                image_url = None[0m

[31m--[ [0m[34mMatch #[0m[33m801[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify_connect/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m294 | [0m[35m                artist = artists[0][0m
[30;1m295 | [0m[35m            else:[0m
[30;1m296 | [0m[35m                artist = "Unknown"[0m
[30;1m297 | [0m[35m            album = json_data["common_metadata_fields"].get("album", "Unknown")[0m
[30;1m298 | [0m[35m            if images := json_data["common_metadata_fields"].get("covers"):[0m
[30;1m299 | [0m[35m                image_url = images[0][0m
[30;1m300 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m802[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify_connect/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m290 | [0m[35m        if "common_metadata_fields" in json_data:[0m
[30;1m291 | [0m[35m            uri = json_data["common_metadata_fields"].get("uri", "Unknown")[0m
[30;1m292 | [0m[35m            title = json_data["common_metadata_fields"].get("name", "Unknown")[0m
[30;1m293 | [0m[35m            if artists := json_data.get("track_metadata_fields", {}).get("artists"):[0m
[30;1m294 | [0m[35m                artist = artists[0][0m
[30;1m295 | [0m[35m            else:[0m
[30;1m296 | [0m[35m                artist = "Unknown"[0m

[31m--[ [0m[34mMatch #[0m[33m803[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify_connect/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m290 | [0m[35m        if "common_metadata_fields" in json_data:[0m
[30;1m291 | [0m[35m            uri = json_data["common_metadata_fields"].get("uri", "Unknown")[0m
[30;1m292 | [0m[35m            title = json_data["common_metadata_fields"].get("name", "Unknown")[0m
[30;1m293 | [0m[35m            if artists := json_data.get("track_metadata_fields", {}).get("artists"):[0m
[30;1m294 | [0m[35m                artist = artists[0][0m
[30;1m295 | [0m[35m            else:[0m
[30;1m296 | [0m[35m                artist = "Unknown"[0m

[31m--[ [0m[34mMatch #[0m[33m804[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify_connect/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m289 | [0m[35m        # parse metadata fields[0m
[30;1m290 | [0m[35m        if "common_metadata_fields" in json_data:[0m
[30;1m291 | [0m[35m            uri = json_data["common_metadata_fields"].get("uri", "Unknown")[0m
[30;1m292 | [0m[35m            title = json_data["common_metadata_fields"].get("name", "Unknown")[0m
[30;1m293 | [0m[35m            if artists := json_data.get("track_metadata_fields", {}).get("artists"):[0m
[30;1m294 | [0m[35m                artist = artists[0][0m
[30;1m295 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m805[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify_connect/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m288 | [0m[35m[0m
[30;1m289 | [0m[35m        # parse metadata fields[0m
[30;1m290 | [0m[35m        if "common_metadata_fields" in json_data:[0m
[30;1m291 | [0m[35m            uri = json_data["common_metadata_fields"].get("uri", "Unknown")[0m
[30;1m292 | [0m[35m            title = json_data["common_metadata_fields"].get("name", "Unknown")[0m
[30;1m293 | [0m[35m            if artists := json_data.get("track_metadata_fields", {}).get("artists"):[0m
[30;1m294 | [0m[35m                artist = artists[0][0m

[31m--[ [0m[34mMatch #[0m[33m806[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify_connect/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m273 | [0m[35m        json_data = await request.json()[0m
[30;1m274 | [0m[35m        self.logger.debug("Received metadata on webservice: \n%s", json_data)[0m
[30;1m275 | [0m[35m[0m
[30;1m276 | [0m[35m        event_name = json_data.get("event")[0m
[30;1m277 | [0m[35m[0m
[30;1m278 | [0m[35m        # handle session connected event[0m
[30;1m279 | [0m[35m        # this player has become the active spotify connect player[0m

[31m--[ [0m[34mMatch #[0m[33m807[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify_connect/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m166 | [0m[35m    async def handle_async_init(self) -> None:[0m
[30;1m167 | [0m[35m        """Handle async initialization of the provider."""[0m
[30;1m168 | [0m[35m        self._librespot_bin = await get_librespot_binary()[0m
[30;1m169 | [0m[35m        self.player = self.mass.players.get(self.mass_player_id)[0m
[30;1m170 | [0m[35m        if self.player:[0m
[30;1m171 | [0m[35m            self._setup_player_daemon()[0m
[30;1m172 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m808[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify_connect/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m209 | [0m[35m                self.named_pipe,[0m
[30;1m210 | [0m[35m                "--dither",[0m
[30;1m211 | [0m[35m                "none",[0m
[30;1m212 | [0m[35m                # disable volume control[0m
[30;1m213 | [0m[35m                "--mixer",[0m
[30;1m214 | [0m[35m                "softvol",[0m
[30;1m215 | [0m[35m                "--volume-ctrl",[0m
[30;1m216 | [0m[35m                "fixed",[0m

[31m--[ [0m[34mMatch #[0m[33m809[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify_connect/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m217 | [0m[35m                "--initial-volume",[0m
[30;1m218 | [0m[35m                f"{self.player.volume_level if self.player and self.player.volume_level else 100}",[0m
[30;1m219 | [0m[35m                "--enable-volume-normalisation",[0m
[30;1m220 | [0m[35m                # forward events to the events script[0m
[30;1m221 | [0m[35m                "--onevent",[0m
[30;1m222 | [0m[35m                str(EVENTS_SCRIPT),[0m
[30;1m223 | [0m[35m                "--emit-sink-events",[0m
[30;1m224 | [0m[35m            ][0m

[31m--[ [0m[34mMatch #[0m[33m810[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m400 | [0m[35m        url = f"https://theaudiodb.com/api/v1/json/{app_var(3)}/{endpoint}"[0m
[30;1m401 | [0m[35m        async with ([0m
[30;1m402 | [0m[35m            self.throttler,[0m
[30;1m403 | [0m[35m            self.mass.http_session.get(url, params=kwargs, ssl=False) as response,[0m
[30;1m404 | [0m[35m        ):[0m
[30;1m405 | [0m[35m            try:[0m
[30;1m406 | [0m[35m                result = cast("dict[str, Any]", await response.json())[0m

[31m--[ [0m[34mMatch #[0m[33m811[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m358 | [0m[35m        metadata.images = UniqueList([])[0m
[30;1m359 | [0m[35m        for key, img_type in IMG_MAPPING.items():[0m
[30;1m360 | [0m[35m            for postfix in ("", "2", "3", "4", "5", "6", "7", "8", "9", "10"):[0m
[30;1m361 | [0m[35m                if img := adb_track.get(f"{key}{postfix}"):[0m
[30;1m362 | [0m[35m                    metadata.images.append([0m
[30;1m363 | [0m[35m                        MediaItemImage([0m
[30;1m364 | [0m[35m                            type=img_type,[0m

[31m--[ [0m[34mMatch #[0m[33m812[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m351 | [0m[35m        ):[0m
[30;1m352 | [0m[35m            metadata.description = desc[0m
[30;1m353 | [0m[35m        else:[0m
[30;1m354 | [0m[35m            metadata.description = adb_track.get("strDescriptionEN")[0m
[30;1m355 | [0m[35m        # images[0m
[30;1m356 | [0m[35m        if not self.config.get_value(CONF_ENABLE_IMAGES):[0m
[30;1m357 | [0m[35m            return metadata[0m

[31m--[ [0m[34mMatch #[0m[33m813[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m347 | [0m[35m        # description[0m
[30;1m348 | [0m[35m        lang_code, lang_country = self.mass.metadata.locale.split("_")[0m
[30;1m349 | [0m[35m        if desc := adb_track.get(f"strDescription{lang_country}") or ([0m
[30;1m350 | [0m[35m            desc := adb_track.get(f"strDescription{lang_code.upper()}")[0m
[30;1m351 | [0m[35m        ):[0m
[30;1m352 | [0m[35m            metadata.description = desc[0m
[30;1m353 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m814[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m346 | [0m[35m        metadata.mood = adb_track.get("strMood")[0m
[30;1m347 | [0m[35m        # description[0m
[30;1m348 | [0m[35m        lang_code, lang_country = self.mass.metadata.locale.split("_")[0m
[30;1m349 | [0m[35m        if desc := adb_track.get(f"strDescription{lang_country}") or ([0m
[30;1m350 | [0m[35m            desc := adb_track.get(f"strDescription{lang_code.upper()}")[0m
[30;1m351 | [0m[35m        ):[0m
[30;1m352 | [0m[35m            metadata.description = desc[0m

[31m--[ [0m[34mMatch #[0m[33m815[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m343 | [0m[35m        metadata.style = adb_track.get("strStyle")[0m
[30;1m344 | [0m[35m        if genre := adb_track.get("strGenre"):[0m
[30;1m345 | [0m[35m            metadata.genres = {genre}[0m
[30;1m346 | [0m[35m        metadata.mood = adb_track.get("strMood")[0m
[30;1m347 | [0m[35m        # description[0m
[30;1m348 | [0m[35m        lang_code, lang_country = self.mass.metadata.locale.split("_")[0m
[30;1m349 | [0m[35m        if desc := adb_track.get(f"strDescription{lang_country}") or ([0m

[31m--[ [0m[34mMatch #[0m[33m816[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m341 | [0m[35m        # generic data[0m
[30;1m342 | [0m[35m        metadata.lyrics = adb_track.get("strTrackLyrics")[0m
[30;1m343 | [0m[35m        metadata.style = adb_track.get("strStyle")[0m
[30;1m344 | [0m[35m        if genre := adb_track.get("strGenre"):[0m
[30;1m345 | [0m[35m            metadata.genres = {genre}[0m
[30;1m346 | [0m[35m        metadata.mood = adb_track.get("strMood")[0m
[30;1m347 | [0m[35m        # description[0m

[31m--[ [0m[34mMatch #[0m[33m817[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m340 | [0m[35m        metadata = MediaItemMetadata()[0m
[30;1m341 | [0m[35m        # generic data[0m
[30;1m342 | [0m[35m        metadata.lyrics = adb_track.get("strTrackLyrics")[0m
[30;1m343 | [0m[35m        metadata.style = adb_track.get("strStyle")[0m
[30;1m344 | [0m[35m        if genre := adb_track.get("strGenre"):[0m
[30;1m345 | [0m[35m            metadata.genres = {genre}[0m
[30;1m346 | [0m[35m        metadata.mood = adb_track.get("strMood")[0m

[31m--[ [0m[34mMatch #[0m[33m818[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m339 | [0m[35m        """Parse audiodb track object to MediaItemMetadata."""[0m
[30;1m340 | [0m[35m        metadata = MediaItemMetadata()[0m
[30;1m341 | [0m[35m        # generic data[0m
[30;1m342 | [0m[35m        metadata.lyrics = adb_track.get("strTrackLyrics")[0m
[30;1m343 | [0m[35m        metadata.style = adb_track.get("strStyle")[0m
[30;1m344 | [0m[35m        if genre := adb_track.get("strGenre"):[0m
[30;1m345 | [0m[35m            metadata.genres = {genre}[0m

[31m--[ [0m[34mMatch #[0m[33m819[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m320 | [0m[35m            album.year = int(adb_album.get("intYearReleased", "0"))[0m
[30;1m321 | [0m[35m        if album.album_type == AlbumType.UNKNOWN and adb_album.get("strReleaseFormat"):[0m
[30;1m322 | [0m[35m            releaseformat = cast("str", adb_album.get("strReleaseFormat"))[0m
[30;1m323 | [0m[35m            album.album_type = ALBUMTYPE_MAPPING.get(releaseformat, AlbumType.UNKNOWN)[0m
[30;1m324 | [0m[35m        # update the artist mbid while at it[0m
[30;1m325 | [0m[35m        for album_artist in album.artists:[0m
[30;1m326 | [0m[35m            if not compare_strings(album_artist.name, adb_album["strArtist"]):[0m

[31m--[ [0m[34mMatch #[0m[33m820[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m319 | [0m[35m        if not album.year:[0m
[30;1m320 | [0m[35m            album.year = int(adb_album.get("intYearReleased", "0"))[0m
[30;1m321 | [0m[35m        if album.album_type == AlbumType.UNKNOWN and adb_album.get("strReleaseFormat"):[0m
[30;1m322 | [0m[35m            releaseformat = cast("str", adb_album.get("strReleaseFormat"))[0m
[30;1m323 | [0m[35m            album.album_type = ALBUMTYPE_MAPPING.get(releaseformat, AlbumType.UNKNOWN)[0m
[30;1m324 | [0m[35m        # update the artist mbid while at it[0m
[30;1m325 | [0m[35m        for album_artist in album.artists:[0m

[31m--[ [0m[34mMatch #[0m[33m821[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m318 | [0m[35m        # fill in some missing album info if needed[0m
[30;1m319 | [0m[35m        if not album.year:[0m
[30;1m320 | [0m[35m            album.year = int(adb_album.get("intYearReleased", "0"))[0m
[30;1m321 | [0m[35m        if album.album_type == AlbumType.UNKNOWN and adb_album.get("strReleaseFormat"):[0m
[30;1m322 | [0m[35m            releaseformat = cast("str", adb_album.get("strReleaseFormat"))[0m
[30;1m323 | [0m[35m            album.album_type = ALBUMTYPE_MAPPING.get(releaseformat, AlbumType.UNKNOWN)[0m
[30;1m324 | [0m[35m        # update the artist mbid while at it[0m

[31m--[ [0m[34mMatch #[0m[33m822[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m317 | [0m[35m                    break[0m
[30;1m318 | [0m[35m        # fill in some missing album info if needed[0m
[30;1m319 | [0m[35m        if not album.year:[0m
[30;1m320 | [0m[35m            album.year = int(adb_album.get("intYearReleased", "0"))[0m
[30;1m321 | [0m[35m        if album.album_type == AlbumType.UNKNOWN and adb_album.get("strReleaseFormat"):[0m
[30;1m322 | [0m[35m            releaseformat = cast("str", adb_album.get("strReleaseFormat"))[0m
[30;1m323 | [0m[35m            album.album_type = ALBUMTYPE_MAPPING.get(releaseformat, AlbumType.UNKNOWN)[0m

[31m--[ [0m[34mMatch #[0m[33m823[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m304 | [0m[35m        metadata.images = UniqueList()[0m
[30;1m305 | [0m[35m        for key, img_type in IMG_MAPPING.items():[0m
[30;1m306 | [0m[35m            for postfix in ("", "2", "3", "4", "5", "6", "7", "8", "9", "10"):[0m
[30;1m307 | [0m[35m                if img := adb_album.get(f"{key}{postfix}"):[0m
[30;1m308 | [0m[35m                    metadata.images.append([0m
[30;1m309 | [0m[35m                        MediaItemImage([0m
[30;1m310 | [0m[35m                            type=img_type,[0m

[31m--[ [0m[34mMatch #[0m[33m824[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m297 | [0m[35m            metadata.description = desc[0m
[30;1m298 | [0m[35m        else:[0m
[30;1m299 | [0m[35m            metadata.description = adb_album.get("strDescriptionEN")[0m
[30;1m300 | [0m[35m        metadata.review = adb_album.get("strReview")[0m
[30;1m301 | [0m[35m        # images[0m
[30;1m302 | [0m[35m        if not self.config.get_value(CONF_ENABLE_IMAGES):[0m
[30;1m303 | [0m[35m            return metadata[0m

[31m--[ [0m[34mMatch #[0m[33m825[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m296 | [0m[35m        ):[0m
[30;1m297 | [0m[35m            metadata.description = desc[0m
[30;1m298 | [0m[35m        else:[0m
[30;1m299 | [0m[35m            metadata.description = adb_album.get("strDescriptionEN")[0m
[30;1m300 | [0m[35m        metadata.review = adb_album.get("strReview")[0m
[30;1m301 | [0m[35m        # images[0m
[30;1m302 | [0m[35m        if not self.config.get_value(CONF_ENABLE_IMAGES):[0m

[31m--[ [0m[34mMatch #[0m[33m826[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m292 | [0m[35m        # description[0m
[30;1m293 | [0m[35m        lang_code, lang_country = self.mass.metadata.locale.split("_")[0m
[30;1m294 | [0m[35m        if desc := adb_album.get(f"strDescription{lang_country}") or ([0m
[30;1m295 | [0m[35m            desc := adb_album.get(f"strDescription{lang_code.upper()}")[0m
[30;1m296 | [0m[35m        ):[0m
[30;1m297 | [0m[35m            metadata.description = desc[0m
[30;1m298 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m827[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m291 | [0m[35m[0m
[30;1m292 | [0m[35m        # description[0m
[30;1m293 | [0m[35m        lang_code, lang_country = self.mass.metadata.locale.split("_")[0m
[30;1m294 | [0m[35m        if desc := adb_album.get(f"strDescription{lang_country}") or ([0m
[30;1m295 | [0m[35m            desc := adb_album.get(f"strDescription{lang_code.upper()}")[0m
[30;1m296 | [0m[35m        ):[0m
[30;1m297 | [0m[35m            metadata.description = desc[0m

[31m--[ [0m[34mMatch #[0m[33m828[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m284 | [0m[35m            metadata.links.add([0m
[30;1m285 | [0m[35m                MediaItemLink(type=LinkType.WIKIPEDIA, url=f"https://wikipedia.org/wiki/{link}")[0m
[30;1m286 | [0m[35m            )[0m
[30;1m287 | [0m[35m        if link := adb_album.get("strAllMusicID"):[0m
[30;1m288 | [0m[35m            metadata.links.add([0m
[30;1m289 | [0m[35m                MediaItemLink(type=LinkType.ALLMUSIC, url=f"https://www.allmusic.com/album/{link}")[0m
[30;1m290 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m829[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m280 | [0m[35m        metadata.mood = adb_album.get("strMood")[0m
[30;1m281 | [0m[35m        # links[0m
[30;1m282 | [0m[35m        metadata.links = set()[0m
[30;1m283 | [0m[35m        if link := adb_album.get("strWikipediaID"):[0m
[30;1m284 | [0m[35m            metadata.links.add([0m
[30;1m285 | [0m[35m                MediaItemLink(type=LinkType.WIKIPEDIA, url=f"https://wikipedia.org/wiki/{link}")[0m
[30;1m286 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m830[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m277 | [0m[35m        metadata.style = adb_album.get("strStyle")[0m
[30;1m278 | [0m[35m        if genre := adb_album.get("strGenre"):[0m
[30;1m279 | [0m[35m            metadata.genres = {genre}[0m
[30;1m280 | [0m[35m        metadata.mood = adb_album.get("strMood")[0m
[30;1m281 | [0m[35m        # links[0m
[30;1m282 | [0m[35m        metadata.links = set()[0m
[30;1m283 | [0m[35m        if link := adb_album.get("strWikipediaID"):[0m

[31m--[ [0m[34mMatch #[0m[33m831[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m275 | [0m[35m        # generic data[0m
[30;1m276 | [0m[35m        metadata.label = adb_album.get("strLabel")[0m
[30;1m277 | [0m[35m        metadata.style = adb_album.get("strStyle")[0m
[30;1m278 | [0m[35m        if genre := adb_album.get("strGenre"):[0m
[30;1m279 | [0m[35m            metadata.genres = {genre}[0m
[30;1m280 | [0m[35m        metadata.mood = adb_album.get("strMood")[0m
[30;1m281 | [0m[35m        # links[0m

[31m--[ [0m[34mMatch #[0m[33m832[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m274 | [0m[35m        metadata = MediaItemMetadata()[0m
[30;1m275 | [0m[35m        # generic data[0m
[30;1m276 | [0m[35m        metadata.label = adb_album.get("strLabel")[0m
[30;1m277 | [0m[35m        metadata.style = adb_album.get("strStyle")[0m
[30;1m278 | [0m[35m        if genre := adb_album.get("strGenre"):[0m
[30;1m279 | [0m[35m            metadata.genres = {genre}[0m
[30;1m280 | [0m[35m        metadata.mood = adb_album.get("strMood")[0m

[31m--[ [0m[34mMatch #[0m[33m833[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m273 | [0m[35m        """Parse audiodb album object to MediaItemMetadata."""[0m
[30;1m274 | [0m[35m        metadata = MediaItemMetadata()[0m
[30;1m275 | [0m[35m        # generic data[0m
[30;1m276 | [0m[35m        metadata.label = adb_album.get("strLabel")[0m
[30;1m277 | [0m[35m        metadata.style = adb_album.get("strStyle")[0m
[30;1m278 | [0m[35m        if genre := adb_album.get("strGenre"):[0m
[30;1m279 | [0m[35m            metadata.genres = {genre}[0m

[31m--[ [0m[34mMatch #[0m[33m834[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m256 | [0m[35m        metadata.images = UniqueList()[0m
[30;1m257 | [0m[35m        for key, img_type in IMG_MAPPING.items():[0m
[30;1m258 | [0m[35m            for postfix in ("", "2", "3", "4", "5", "6", "7", "8", "9", "10"):[0m
[30;1m259 | [0m[35m                if img := artist_obj.get(f"{key}{postfix}"):[0m
[30;1m260 | [0m[35m                    metadata.images.append([0m
[30;1m261 | [0m[35m                        MediaItemImage([0m
[30;1m262 | [0m[35m                            type=img_type,[0m

[31m--[ [0m[34mMatch #[0m[33m835[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m249 | [0m[35m        ):[0m
[30;1m250 | [0m[35m            metadata.description = desc[0m
[30;1m251 | [0m[35m        else:[0m
[30;1m252 | [0m[35m            metadata.description = artist_obj.get("strBiographyEN")[0m
[30;1m253 | [0m[35m        # images[0m
[30;1m254 | [0m[35m        if not self.config.get_value(CONF_ENABLE_IMAGES):[0m
[30;1m255 | [0m[35m            return metadata[0m

[31m--[ [0m[34mMatch #[0m[33m836[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m245 | [0m[35m        # description/biography[0m
[30;1m246 | [0m[35m        lang_code, lang_country = self.mass.metadata.locale.split("_")[0m
[30;1m247 | [0m[35m        if desc := artist_obj.get(f"strBiography{lang_country}") or ([0m
[30;1m248 | [0m[35m            desc := artist_obj.get(f"strBiography{lang_code.upper()}")[0m
[30;1m249 | [0m[35m        ):[0m
[30;1m250 | [0m[35m            metadata.description = desc[0m
[30;1m251 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m837[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m244 | [0m[35m                metadata.links.add(MediaItemLink(type=link_type, url=link))[0m
[30;1m245 | [0m[35m        # description/biography[0m
[30;1m246 | [0m[35m        lang_code, lang_country = self.mass.metadata.locale.split("_")[0m
[30;1m247 | [0m[35m        if desc := artist_obj.get(f"strBiography{lang_country}") or ([0m
[30;1m248 | [0m[35m            desc := artist_obj.get(f"strBiography{lang_code.upper()}")[0m
[30;1m249 | [0m[35m        ):[0m
[30;1m250 | [0m[35m            metadata.description = desc[0m

[31m--[ [0m[34mMatch #[0m[33m838[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m240 | [0m[35m        # links[0m
[30;1m241 | [0m[35m        metadata.links = set()[0m
[30;1m242 | [0m[35m        for key, link_type in LINK_MAPPING.items():[0m
[30;1m243 | [0m[35m            if link := artist_obj.get(key):[0m
[30;1m244 | [0m[35m                metadata.links.add(MediaItemLink(type=link_type, url=link))[0m
[30;1m245 | [0m[35m        # description/biography[0m
[30;1m246 | [0m[35m        lang_code, lang_country = self.mass.metadata.locale.split("_")[0m

[31m--[ [0m[34mMatch #[0m[33m839[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m236 | [0m[35m        metadata.style = artist_obj.get("strStyle")[0m
[30;1m237 | [0m[35m        if genre := artist_obj.get("strGenre"):[0m
[30;1m238 | [0m[35m            metadata.genres = {genre}[0m
[30;1m239 | [0m[35m        metadata.mood = artist_obj.get("strMood")[0m
[30;1m240 | [0m[35m        # links[0m
[30;1m241 | [0m[35m        metadata.links = set()[0m
[30;1m242 | [0m[35m        for key, link_type in LINK_MAPPING.items():[0m

[31m--[ [0m[34mMatch #[0m[33m840[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m234 | [0m[35m        # generic data[0m
[30;1m235 | [0m[35m        metadata.label = artist_obj.get("strLabel")[0m
[30;1m236 | [0m[35m        metadata.style = artist_obj.get("strStyle")[0m
[30;1m237 | [0m[35m        if genre := artist_obj.get("strGenre"):[0m
[30;1m238 | [0m[35m            metadata.genres = {genre}[0m
[30;1m239 | [0m[35m        metadata.mood = artist_obj.get("strMood")[0m
[30;1m240 | [0m[35m        # links[0m

[31m--[ [0m[34mMatch #[0m[33m841[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m233 | [0m[35m        metadata = MediaItemMetadata()[0m
[30;1m234 | [0m[35m        # generic data[0m
[30;1m235 | [0m[35m        metadata.label = artist_obj.get("strLabel")[0m
[30;1m236 | [0m[35m        metadata.style = artist_obj.get("strStyle")[0m
[30;1m237 | [0m[35m        if genre := artist_obj.get("strGenre"):[0m
[30;1m238 | [0m[35m            metadata.genres = {genre}[0m
[30;1m239 | [0m[35m        metadata.mood = artist_obj.get("strMood")[0m

[31m--[ [0m[34mMatch #[0m[33m842[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m232 | [0m[35m        """Parse audiodb artist object to MediaItemMetadata."""[0m
[30;1m233 | [0m[35m        metadata = MediaItemMetadata()[0m
[30;1m234 | [0m[35m        # generic data[0m
[30;1m235 | [0m[35m        metadata.label = artist_obj.get("strLabel")[0m
[30;1m236 | [0m[35m        metadata.style = artist_obj.get("strStyle")[0m
[30;1m237 | [0m[35m        if genre := artist_obj.get("strGenre"):[0m
[30;1m238 | [0m[35m            metadata.genres = {genre}[0m

[31m--[ [0m[34mMatch #[0m[33m843[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m204 | [0m[35m            # make sure to include the version in the album name[0m
[30;1m205 | [0m[35m            track_name = f"{track.name} {track.version}" if track.version else track.name[0m
[30;1m206 | [0m[35m            result = await self._get_data("searchtrack.php?", s=track_artist.name, t=track_name)[0m
[30;1m207 | [0m[35m            if result and result.get("track"):[0m
[30;1m208 | [0m[35m                for item in result["track"]:[0m
[30;1m209 | [0m[35m                    # some safety checks[0m
[30;1m210 | [0m[35m                    if track_artist.mbid:[0m

[31m--[ [0m[34mMatch #[0m[33m844[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m195 | [0m[35m            return None[0m
[30;1m196 | [0m[35m        if track.mbid:[0m
[30;1m197 | [0m[35m            result = await self._get_data("track-mb.php", i=track.mbid)[0m
[30;1m198 | [0m[35m            if result and result.get("track"):[0m
[30;1m199 | [0m[35m                return await self.__parse_track(track, result["track"][0])[0m
[30;1m200 | [0m[35m            # if there was no match on mbid, there will certainly be no match by name[0m
[30;1m201 | [0m[35m            return None[0m

[31m--[ [0m[34mMatch #[0m[33m845[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m176 | [0m[35m            # make sure to include the version in the album name[0m
[30;1m177 | [0m[35m            album_name = f"{album.name} {album.version}" if album.version else album.name[0m
[30;1m178 | [0m[35m            result = await self._get_data("searchalbum.php?", s=album_artist.name, a=album_name)[0m
[30;1m179 | [0m[35m            if result and result.get("album"):[0m
[30;1m180 | [0m[35m                for item in result["album"]:[0m
[30;1m181 | [0m[35m                    # some safety checks[0m
[30;1m182 | [0m[35m                    if album_artist.mbid:[0m

[31m--[ [0m[34mMatch #[0m[33m846[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m166 | [0m[35m            return None[0m
[30;1m167 | [0m[35m        if mbid := album.get_external_id(ExternalID.MB_RELEASEGROUP):[0m
[30;1m168 | [0m[35m            result = await self._get_data("album-mb.php", i=mbid)[0m
[30;1m169 | [0m[35m            if result and result.get("album"):[0m
[30;1m170 | [0m[35m                adb_album = result["album"][0][0m
[30;1m171 | [0m[35m                return await self.__parse_album(album, adb_album)[0m
[30;1m172 | [0m[35m            # if there was no match on mbid, there will certainly be no match by name[0m

[31m--[ [0m[34mMatch #[0m[33m847[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m156 | [0m[35m            # for 100% accuracy we require the musicbrainz id for all lookups[0m
[30;1m157 | [0m[35m            return None[0m
[30;1m158 | [0m[35m        if data := await self._get_data("artist-mb.php", i=artist.mbid):[0m
[30;1m159 | [0m[35m            if data.get("artists"):[0m
[30;1m160 | [0m[35m                return self.__parse_artist(data["artists"][0])[0m
[30;1m161 | [0m[35m        return None[0m
[30;1m162 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m848[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m381 | [0m[35m                    album_artist.item_id,[0m
[30;1m382 | [0m[35m                    album_artist,[0m
[30;1m383 | [0m[35m                )[0m
[30;1m384 | [0m[35m        # update the album mbid while at it[0m
[30;1m385 | [0m[35m        if ([0m
[30;1m386 | [0m[35m            track.album[0m
[30;1m387 | [0m[35m            and not track.album.get_external_id(ExternalID.MB_RELEASEGROUP)[0m

[31m--[ [0m[34mMatch #[0m[33m849[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m381 | [0m[35m                    album_artist.item_id,[0m
[30;1m382 | [0m[35m                    album_artist,[0m
[30;1m383 | [0m[35m                )[0m
[30;1m384 | [0m[35m        # update the album mbid while at it[0m
[30;1m385 | [0m[35m        if ([0m
[30;1m386 | [0m[35m            track.album[0m
[30;1m387 | [0m[35m            and not track.album.get_external_id(ExternalID.MB_RELEASEGROUP)[0m

[31m--[ [0m[34mMatch #[0m[33m850[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m369 | [0m[35m                    )[0m
[30;1m370 | [0m[35m                else:[0m
[30;1m371 | [0m[35m                    break[0m
[30;1m372 | [0m[35m        # update the artist mbid while at it[0m
[30;1m373 | [0m[35m        for album_artist in track.artists:[0m
[30;1m374 | [0m[35m            if not compare_strings(album_artist.name, adb_track["strArtist"]):[0m
[30;1m375 | [0m[35m                continue[0m

[31m--[ [0m[34mMatch #[0m[33m851[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m369 | [0m[35m                    )[0m
[30;1m370 | [0m[35m                else:[0m
[30;1m371 | [0m[35m                    break[0m
[30;1m372 | [0m[35m        # update the artist mbid while at it[0m
[30;1m373 | [0m[35m        for album_artist in track.artists:[0m
[30;1m374 | [0m[35m            if not compare_strings(album_artist.name, adb_track["strArtist"]):[0m
[30;1m375 | [0m[35m                continue[0m

[31m--[ [0m[34mMatch #[0m[33m852[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m321 | [0m[35m        if album.album_type == AlbumType.UNKNOWN and adb_album.get("strReleaseFormat"):[0m
[30;1m322 | [0m[35m            releaseformat = cast("str", adb_album.get("strReleaseFormat"))[0m
[30;1m323 | [0m[35m            album.album_type = ALBUMTYPE_MAPPING.get(releaseformat, AlbumType.UNKNOWN)[0m
[30;1m324 | [0m[35m        # update the artist mbid while at it[0m
[30;1m325 | [0m[35m        for album_artist in album.artists:[0m
[30;1m326 | [0m[35m            if not compare_strings(album_artist.name, adb_album["strArtist"]):[0m
[30;1m327 | [0m[35m                continue[0m

[31m--[ [0m[34mMatch #[0m[33m853[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m321 | [0m[35m        if album.album_type == AlbumType.UNKNOWN and adb_album.get("strReleaseFormat"):[0m
[30;1m322 | [0m[35m            releaseformat = cast("str", adb_album.get("strReleaseFormat"))[0m
[30;1m323 | [0m[35m            album.album_type = ALBUMTYPE_MAPPING.get(releaseformat, AlbumType.UNKNOWN)[0m
[30;1m324 | [0m[35m        # update the artist mbid while at it[0m
[30;1m325 | [0m[35m        for album_artist in album.artists:[0m
[30;1m326 | [0m[35m            if not compare_strings(album_artist.name, adb_album["strArtist"]):[0m
[30;1m327 | [0m[35m                continue[0m

[31m--[ [0m[34mMatch #[0m[33m854[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m830 | [0m[35m        ) as response:[0m
[30;1m831 | [0m[35m            response.raise_for_status()[0m
[30;1m832 | [0m[35m            content = await response.json(loads=json_loads)[0m
[30;1m833 | [0m[35m            track_license = content.get("license")[0m
[30;1m834 | [0m[35m            if not track_license:[0m
[30;1m835 | [0m[35m                raise MediaNotFoundError("No license found for song %s.", item_id)[0m
[30;1m836 | [0m[35m            return track_license[0m

[31m--[ [0m[34mMatch #[0m[33m855[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m825 | [0m[35m            "isLibrary": False,[0m
[30;1m826 | [0m[35m            "user-initiated": True,[0m
[30;1m827 | [0m[35m        }[0m
[30;1m828 | [0m[35m        async with self.mass.http_session.post([0m
[30;1m829 | [0m[35m            license_url, data=json.dumps(data), headers=self._get_decryption_headers(), ssl=False[0m
[30;1m830 | [0m[35m        ) as response:[0m
[30;1m831 | [0m[35m            response.raise_for_status()[0m

[31m--[ [0m[34mMatch #[0m[33m856[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m778 | [0m[35m    ) -> str:[0m
[30;1m779 | [0m[35m        """Get the decryption key for a song."""[0m
[30;1m780 | [0m[35m        cache_key = f"decryption_key.{item_id}"[0m
[30;1m781 | [0m[35m        if decryption_key := await self.mass.cache.get(cache_key, base_key=self.instance_id):[0m
[30;1m782 | [0m[35m            self.logger.debug("Decryption key for %s found in cache.", item_id)[0m
[30;1m783 | [0m[35m            return decryption_key[0m
[30;1m784 | [0m[35m        pssh = self._get_pssh(key_id)[0m

[31m--[ [0m[34mMatch #[0m[33m857[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m730 | [0m[35m                    response.raise_for_status()[0m
[30;1m731 | [0m[35m                    content = await response.json(loads=json_loads)[0m
[30;1m732 | [0m[35m                    if content.get("failureType"):[0m
[30;1m733 | [0m[35m                        message = content.get("failureMessage")[0m
[30;1m734 | [0m[35m                        raise MediaNotFoundError(f"Failed to get song stream metadata: {message}")[0m
[30;1m735 | [0m[35m                    return content["songList"][0][0m
[30;1m736 | [0m[35m            except (MediaNotFoundError, ClientError) as exc:[0m

[31m--[ [0m[34mMatch #[0m[33m858[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m729 | [0m[35m                ) as response:[0m
[30;1m730 | [0m[35m                    response.raise_for_status()[0m
[30;1m731 | [0m[35m                    content = await response.json(loads=json_loads)[0m
[30;1m732 | [0m[35m                    if content.get("failureType"):[0m
[30;1m733 | [0m[35m                        message = content.get("failureMessage")[0m
[30;1m734 | [0m[35m                        raise MediaNotFoundError(f"Failed to get song stream metadata: {message}")[0m
[30;1m735 | [0m[35m                    return content["songList"][0][0m

[31m--[ [0m[34mMatch #[0m[33m859[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m724 | [0m[35m        }[0m
[30;1m725 | [0m[35m        for retry in (True, False):[0m
[30;1m726 | [0m[35m            try:[0m
[30;1m727 | [0m[35m                async with self.mass.http_session.post([0m
[30;1m728 | [0m[35m                    playback_url, headers=self._get_decryption_headers(), json=data, ssl=True[0m
[30;1m729 | [0m[35m                ) as response:[0m
[30;1m730 | [0m[35m                    response.raise_for_status()[0m

[31m--[ [0m[34mMatch #[0m[33m860[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m690 | [0m[35m        headers = {"Authorization": f"Bearer {DEVELOPER_TOKEN}"}[0m
[30;1m691 | [0m[35m        headers["Music-User-Token"] = self._music_user_token[0m
[30;1m692 | [0m[35m        async with ([0m
[30;1m693 | [0m[35m            self.mass.http_session.post([0m
[30;1m694 | [0m[35m                url, headers=headers, params=kwargs, json=data, ssl=True, timeout=120[0m
[30;1m695 | [0m[35m            ) as response,[0m
[30;1m696 | [0m[35m        ):[0m

[31m--[ [0m[34mMatch #[0m[33m861[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m647 | [0m[35m        headers = {"Authorization": f"Bearer {DEVELOPER_TOKEN}"}[0m
[30;1m648 | [0m[35m        headers["Music-User-Token"] = self._music_user_token[0m
[30;1m649 | [0m[35m        async with ([0m
[30;1m650 | [0m[35m            self.mass.http_session.get([0m
[30;1m651 | [0m[35m                url, headers=headers, params=kwargs, ssl=True, timeout=120[0m
[30;1m652 | [0m[35m            ) as response,[0m
[30;1m653 | [0m[35m        ):[0m

[31m--[ [0m[34mMatch #[0m[33m862[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m635 | [0m[35m            if key not in result:[0m
[30;1m636 | [0m[35m                break[0m
[30;1m637 | [0m[35m            all_items += result[key][0m
[30;1m638 | [0m[35m            if not result.get("next"):[0m
[30;1m639 | [0m[35m                break[0m
[30;1m640 | [0m[35m            offset += limit[0m
[30;1m641 | [0m[35m        return all_items[0m

[31m--[ [0m[34mMatch #[0m[33m863[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m619 | [0m[35m            ][0m
[30;1m620 | [0m[35m        if description := attributes.get("description"):[0m
[30;1m621 | [0m[35m            playlist.metadata.description = description.get("standard")[0m
[30;1m622 | [0m[35m        if checksum := attributes.get("lastModifiedDate"):[0m
[30;1m623 | [0m[35m            playlist.cache_checksum = checksum[0m
[30;1m624 | [0m[35m        return playlist[0m
[30;1m625 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m864[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m618 | [0m[35m                )[0m
[30;1m619 | [0m[35m            ][0m
[30;1m620 | [0m[35m        if description := attributes.get("description"):[0m
[30;1m621 | [0m[35m            playlist.metadata.description = description.get("standard")[0m
[30;1m622 | [0m[35m        if checksum := attributes.get("lastModifiedDate"):[0m
[30;1m623 | [0m[35m            playlist.cache_checksum = checksum[0m
[30;1m624 | [0m[35m        return playlist[0m

[31m--[ [0m[34mMatch #[0m[33m865[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m617 | [0m[35m                    remotely_accessible=True,[0m
[30;1m618 | [0m[35m                )[0m
[30;1m619 | [0m[35m            ][0m
[30;1m620 | [0m[35m        if description := attributes.get("description"):[0m
[30;1m621 | [0m[35m            playlist.metadata.description = description.get("standard")[0m
[30;1m622 | [0m[35m        if checksum := attributes.get("lastModifiedDate"):[0m
[30;1m623 | [0m[35m            playlist.cache_checksum = checksum[0m

[31m--[ [0m[34mMatch #[0m[33m866[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m605 | [0m[35m            },[0m
[30;1m606 | [0m[35m            is_editable=is_editable,[0m
[30;1m607 | [0m[35m        )[0m
[30;1m608 | [0m[35m        if artwork := attributes.get("artwork"):[0m
[30;1m609 | [0m[35m            url = artwork["url"][0m
[30;1m610 | [0m[35m            if artwork["width"] and artwork["height"]:[0m
[30;1m611 | [0m[35m                url = url.format(w=artwork["width"], h=artwork["height"])[0m

[31m--[ [0m[34mMatch #[0m[33m867[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m600 | [0m[35m                    item_id=playlist_id,[0m
[30;1m601 | [0m[35m                    provider_domain=self.domain,[0m
[30;1m602 | [0m[35m                    provider_instance=self.instance_id,[0m
[30;1m603 | [0m[35m                    url=attributes.get("url"),[0m
[30;1m604 | [0m[35m                )[0m
[30;1m605 | [0m[35m            },[0m
[30;1m606 | [0m[35m            is_editable=is_editable,[0m

[31m--[ [0m[34mMatch #[0m[33m868[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m594 | [0m[35m            item_id=playlist_id,[0m
[30;1m595 | [0m[35m            provider=self.instance_id if is_editable else self.lookup_key,[0m
[30;1m596 | [0m[35m            name=attributes.get("name", UNKNOWN_PLAYLIST_NAME),[0m
[30;1m597 | [0m[35m            owner=attributes.get("curatorName", "me"),[0m
[30;1m598 | [0m[35m            provider_mappings={[0m
[30;1m599 | [0m[35m                ProviderMapping([0m
[30;1m600 | [0m[35m                    item_id=playlist_id,[0m

[31m--[ [0m[34mMatch #[0m[33m869[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m593 | [0m[35m        playlist = Playlist([0m
[30;1m594 | [0m[35m            item_id=playlist_id,[0m
[30;1m595 | [0m[35m            provider=self.instance_id if is_editable else self.lookup_key,[0m
[30;1m596 | [0m[35m            name=attributes.get("name", UNKNOWN_PLAYLIST_NAME),[0m
[30;1m597 | [0m[35m            owner=attributes.get("curatorName", "me"),[0m
[30;1m598 | [0m[35m            provider_mappings={[0m
[30;1m599 | [0m[35m                ProviderMapping([0m

[31m--[ [0m[34mMatch #[0m[33m870[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m589 | [0m[35m        """Parse Apple Music playlist object to generic layout."""[0m
[30;1m590 | [0m[35m        attributes = playlist_obj["attributes"][0m
[30;1m591 | [0m[35m        playlist_id = attributes["playParams"].get("globalId") or playlist_obj["id"][0m
[30;1m592 | [0m[35m        is_editable = attributes.get("canEdit", False)[0m
[30;1m593 | [0m[35m        playlist = Playlist([0m
[30;1m594 | [0m[35m            item_id=playlist_id,[0m
[30;1m595 | [0m[35m            provider=self.instance_id if is_editable else self.lookup_key,[0m

[31m--[ [0m[34mMatch #[0m[33m871[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m588 | [0m[35m    def _parse_playlist(self, playlist_obj) -> Playlist:[0m
[30;1m589 | [0m[35m        """Parse Apple Music playlist object to generic layout."""[0m
[30;1m590 | [0m[35m        attributes = playlist_obj["attributes"][0m
[30;1m591 | [0m[35m        playlist_id = attributes["playParams"].get("globalId") or playlist_obj["id"][0m
[30;1m592 | [0m[35m        is_editable = attributes.get("canEdit", False)[0m
[30;1m593 | [0m[35m        playlist = Playlist([0m
[30;1m594 | [0m[35m            item_id=playlist_id,[0m

[31m--[ [0m[34mMatch #[0m[33m872[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m581 | [0m[35m            track.metadata.genres = set(genres)[0m
[30;1m582 | [0m[35m        if composers := attributes.get("composerName"):[0m
[30;1m583 | [0m[35m            track.metadata.performers = set(composers.split(", "))[0m
[30;1m584 | [0m[35m        if isrc := attributes.get("isrc"):[0m
[30;1m585 | [0m[35m            track.external_ids.add((ExternalID.ISRC, isrc))[0m
[30;1m586 | [0m[35m        return track[0m
[30;1m587 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m873[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m579 | [0m[35m            ][0m
[30;1m580 | [0m[35m        if genres := attributes.get("genreNames"):[0m
[30;1m581 | [0m[35m            track.metadata.genres = set(genres)[0m
[30;1m582 | [0m[35m        if composers := attributes.get("composerName"):[0m
[30;1m583 | [0m[35m            track.metadata.performers = set(composers.split(", "))[0m
[30;1m584 | [0m[35m        if isrc := attributes.get("isrc"):[0m
[30;1m585 | [0m[35m            track.external_ids.add((ExternalID.ISRC, isrc))[0m

[31m--[ [0m[34mMatch #[0m[33m874[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m577 | [0m[35m                    remotely_accessible=True,[0m
[30;1m578 | [0m[35m                )[0m
[30;1m579 | [0m[35m            ][0m
[30;1m580 | [0m[35m        if genres := attributes.get("genreNames"):[0m
[30;1m581 | [0m[35m            track.metadata.genres = set(genres)[0m
[30;1m582 | [0m[35m        if composers := attributes.get("composerName"):[0m
[30;1m583 | [0m[35m            track.metadata.performers = set(composers.split(", "))[0m

[31m--[ [0m[34mMatch #[0m[33m875[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m568 | [0m[35m        if albums := relationships.get("albums"):[0m
[30;1m569 | [0m[35m            if "data" in albums and len(albums["data"]) > 0:[0m
[30;1m570 | [0m[35m                track.album = self._parse_album(albums["data"][0])[0m
[30;1m571 | [0m[35m        if artwork := attributes.get("artwork"):[0m
[30;1m572 | [0m[35m            track.metadata.images = [[0m
[30;1m573 | [0m[35m                MediaItemImage([0m
[30;1m574 | [0m[35m                    type=ImageType.THUMB,[0m

[31m--[ [0m[34mMatch #[0m[33m876[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m565 | [0m[35m                    name=artist_name,[0m
[30;1m566 | [0m[35m                )[0m
[30;1m567 | [0m[35m            ][0m
[30;1m568 | [0m[35m        if albums := relationships.get("albums"):[0m
[30;1m569 | [0m[35m            if "data" in albums and len(albums["data"]) > 0:[0m
[30;1m570 | [0m[35m                track.album = self._parse_album(albums["data"][0])[0m
[30;1m571 | [0m[35m        if artwork := attributes.get("artwork"):[0m

[31m--[ [0m[34mMatch #[0m[33m877[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m556 | [0m[35m            artists = relationships["artists"][0m
[30;1m557 | [0m[35m            track.artists = [self._parse_artist(artist) for artist in artists["data"]][0m
[30;1m558 | [0m[35m        # 'Similar tracks' do not provide full artist details[0m
[30;1m559 | [0m[35m        elif artist_name := attributes.get("artistName"):[0m
[30;1m560 | [0m[35m            track.artists = [[0m
[30;1m561 | [0m[35m                ItemMapping([0m
[30;1m562 | [0m[35m                    media_type=MediaType.ARTIST,[0m

[31m--[ [0m[34mMatch #[0m[33m878[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m548 | [0m[35m        )[0m
[30;1m549 | [0m[35m        if disc_number := attributes.get("discNumber"):[0m
[30;1m550 | [0m[35m            track.disc_number = disc_number[0m
[30;1m551 | [0m[35m        if track_number := attributes.get("trackNumber"):[0m
[30;1m552 | [0m[35m            track.track_number = track_number[0m
[30;1m553 | [0m[35m        # Prefer catalog information over library information for artists.[0m
[30;1m554 | [0m[35m        # For compilations it picks the wrong artists[0m

[31m--[ [0m[34mMatch #[0m[33m879[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m546 | [0m[35m                )[0m
[30;1m547 | [0m[35m            },[0m
[30;1m548 | [0m[35m        )[0m
[30;1m549 | [0m[35m        if disc_number := attributes.get("discNumber"):[0m
[30;1m550 | [0m[35m            track.disc_number = disc_number[0m
[30;1m551 | [0m[35m        if track_number := attributes.get("trackNumber"):[0m
[30;1m552 | [0m[35m            track.track_number = track_number[0m

[31m--[ [0m[34mMatch #[0m[33m880[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m542 | [0m[35m                    provider_instance=self.instance_id,[0m
[30;1m543 | [0m[35m                    audio_format=AudioFormat(content_type=ContentType.AAC),[0m
[30;1m544 | [0m[35m                    url=attributes.get("url"),[0m
[30;1m545 | [0m[35m                    available=attributes.get("playParams", {}).get("id") is not None,[0m
[30;1m546 | [0m[35m                )[0m
[30;1m547 | [0m[35m            },[0m
[30;1m548 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m881[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m542 | [0m[35m                    provider_instance=self.instance_id,[0m
[30;1m543 | [0m[35m                    audio_format=AudioFormat(content_type=ContentType.AAC),[0m
[30;1m544 | [0m[35m                    url=attributes.get("url"),[0m
[30;1m545 | [0m[35m                    available=attributes.get("playParams", {}).get("id") is not None,[0m
[30;1m546 | [0m[35m                )[0m
[30;1m547 | [0m[35m            },[0m
[30;1m548 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m882[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m541 | [0m[35m                    provider_domain=self.domain,[0m
[30;1m542 | [0m[35m                    provider_instance=self.instance_id,[0m
[30;1m543 | [0m[35m                    audio_format=AudioFormat(content_type=ContentType.AAC),[0m
[30;1m544 | [0m[35m                    url=attributes.get("url"),[0m
[30;1m545 | [0m[35m                    available=attributes.get("playParams", {}).get("id") is not None,[0m
[30;1m546 | [0m[35m                )[0m
[30;1m547 | [0m[35m            },[0m

[31m--[ [0m[34mMatch #[0m[33m883[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m534 | [0m[35m            item_id=track_id,[0m
[30;1m535 | [0m[35m            provider=self.domain,[0m
[30;1m536 | [0m[35m            name=attributes.get("name"),[0m
[30;1m537 | [0m[35m            duration=attributes.get("durationInMillis", 0) / 1000,[0m
[30;1m538 | [0m[35m            provider_mappings={[0m
[30;1m539 | [0m[35m                ProviderMapping([0m
[30;1m540 | [0m[35m                    item_id=track_id,[0m

[31m--[ [0m[34mMatch #[0m[33m884[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m533 | [0m[35m        track = Track([0m
[30;1m534 | [0m[35m            item_id=track_id,[0m
[30;1m535 | [0m[35m            provider=self.domain,[0m
[30;1m536 | [0m[35m            name=attributes.get("name"),[0m
[30;1m537 | [0m[35m            duration=attributes.get("durationInMillis", 0) / 1000,[0m
[30;1m538 | [0m[35m            provider_mappings={[0m
[30;1m539 | [0m[35m                ProviderMapping([0m

[31m--[ [0m[34mMatch #[0m[33m885[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m523 | [0m[35m        relationships = track_obj.get("relationships", {})[0m
[30;1m524 | [0m[35m        if track_obj.get("type") == "library-songs" and relationships["catalog"]["data"] != []:[0m
[30;1m525 | [0m[35m            track_id = relationships.get("catalog", {})["data"][0]["id"][0m
[30;1m526 | [0m[35m            attributes = relationships.get("catalog", {})["data"][0]["attributes"][0m
[30;1m527 | [0m[35m        elif "attributes" in track_obj:[0m
[30;1m528 | [0m[35m            track_id = track_obj["id"][0m
[30;1m529 | [0m[35m            attributes = track_obj["attributes"][0m

[31m--[ [0m[34mMatch #[0m[33m886[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m522 | [0m[35m        """Parse track object to generic layout."""[0m
[30;1m523 | [0m[35m        relationships = track_obj.get("relationships", {})[0m
[30;1m524 | [0m[35m        if track_obj.get("type") == "library-songs" and relationships["catalog"]["data"] != []:[0m
[30;1m525 | [0m[35m            track_id = relationships.get("catalog", {})["data"][0]["id"][0m
[30;1m526 | [0m[35m            attributes = relationships.get("catalog", {})["data"][0]["attributes"][0m
[30;1m527 | [0m[35m        elif "attributes" in track_obj:[0m
[30;1m528 | [0m[35m            track_id = track_obj["id"][0m

[31m--[ [0m[34mMatch #[0m[33m887[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m521 | [0m[35m    ) -> Track:[0m
[30;1m522 | [0m[35m        """Parse track object to generic layout."""[0m
[30;1m523 | [0m[35m        relationships = track_obj.get("relationships", {})[0m
[30;1m524 | [0m[35m        if track_obj.get("type") == "library-songs" and relationships["catalog"]["data"] != []:[0m
[30;1m525 | [0m[35m            track_id = relationships.get("catalog", {})["data"][0]["id"][0m
[30;1m526 | [0m[35m            attributes = relationships.get("catalog", {})["data"][0]["attributes"][0m
[30;1m527 | [0m[35m        elif "attributes" in track_obj:[0m

[31m--[ [0m[34mMatch #[0m[33m888[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m520 | [0m[35m        track_obj: dict[str, Any],[0m
[30;1m521 | [0m[35m    ) -> Track:[0m
[30;1m522 | [0m[35m        """Parse track object to generic layout."""[0m
[30;1m523 | [0m[35m        relationships = track_obj.get("relationships", {})[0m
[30;1m524 | [0m[35m        if track_obj.get("type") == "library-songs" and relationships["catalog"]["data"] != []:[0m
[30;1m525 | [0m[35m            track_id = relationships.get("catalog", {})["data"][0]["id"][0m
[30;1m526 | [0m[35m            attributes = relationships.get("catalog", {})["data"][0]["attributes"][0m

[31m--[ [0m[34mMatch #[0m[33m889[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m510 | [0m[35m        album_type = AlbumType.ALBUM[0m
[30;1m511 | [0m[35m        if attributes.get("isSingle"):[0m
[30;1m512 | [0m[35m            album_type = AlbumType.SINGLE[0m
[30;1m513 | [0m[35m        elif attributes.get("isCompilation"):[0m
[30;1m514 | [0m[35m            album_type = AlbumType.COMPILATION[0m
[30;1m515 | [0m[35m        album.album_type = album_type[0m
[30;1m516 | [0m[35m        return album[0m

[31m--[ [0m[34mMatch #[0m[33m890[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m508 | [0m[35m        if content_rating := attributes.get("contentRating"):[0m
[30;1m509 | [0m[35m            album.metadata.explicit = content_rating == "explicit"[0m
[30;1m510 | [0m[35m        album_type = AlbumType.ALBUM[0m
[30;1m511 | [0m[35m        if attributes.get("isSingle"):[0m
[30;1m512 | [0m[35m            album_type = AlbumType.SINGLE[0m
[30;1m513 | [0m[35m        elif attributes.get("isCompilation"):[0m
[30;1m514 | [0m[35m            album_type = AlbumType.COMPILATION[0m

[31m--[ [0m[34mMatch #[0m[33m891[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m505 | [0m[35m            album.external_ids.add((ExternalID.BARCODE, "0" + upc))[0m
[30;1m506 | [0m[35m        if notes := attributes.get("editorialNotes"):[0m
[30;1m507 | [0m[35m            album.metadata.description = notes.get("standard") or notes.get("short")[0m
[30;1m508 | [0m[35m        if content_rating := attributes.get("contentRating"):[0m
[30;1m509 | [0m[35m            album.metadata.explicit = content_rating == "explicit"[0m
[30;1m510 | [0m[35m        album_type = AlbumType.ALBUM[0m
[30;1m511 | [0m[35m        if attributes.get("isSingle"):[0m

[31m--[ [0m[34mMatch #[0m[33m892[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m504 | [0m[35m        if upc := attributes.get("upc"):[0m
[30;1m505 | [0m[35m            album.external_ids.add((ExternalID.BARCODE, "0" + upc))[0m
[30;1m506 | [0m[35m        if notes := attributes.get("editorialNotes"):[0m
[30;1m507 | [0m[35m            album.metadata.description = notes.get("standard") or notes.get("short")[0m
[30;1m508 | [0m[35m        if content_rating := attributes.get("contentRating"):[0m
[30;1m509 | [0m[35m            album.metadata.explicit = content_rating == "explicit"[0m
[30;1m510 | [0m[35m        album_type = AlbumType.ALBUM[0m

[31m--[ [0m[34mMatch #[0m[33m893[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m504 | [0m[35m        if upc := attributes.get("upc"):[0m
[30;1m505 | [0m[35m            album.external_ids.add((ExternalID.BARCODE, "0" + upc))[0m
[30;1m506 | [0m[35m        if notes := attributes.get("editorialNotes"):[0m
[30;1m507 | [0m[35m            album.metadata.description = notes.get("standard") or notes.get("short")[0m
[30;1m508 | [0m[35m        if content_rating := attributes.get("contentRating"):[0m
[30;1m509 | [0m[35m            album.metadata.explicit = content_rating == "explicit"[0m
[30;1m510 | [0m[35m        album_type = AlbumType.ALBUM[0m

[31m--[ [0m[34mMatch #[0m[33m894[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m503 | [0m[35m            album.metadata.label = record_label[0m
[30;1m504 | [0m[35m        if upc := attributes.get("upc"):[0m
[30;1m505 | [0m[35m            album.external_ids.add((ExternalID.BARCODE, "0" + upc))[0m
[30;1m506 | [0m[35m        if notes := attributes.get("editorialNotes"):[0m
[30;1m507 | [0m[35m            album.metadata.description = notes.get("standard") or notes.get("short")[0m
[30;1m508 | [0m[35m        if content_rating := attributes.get("contentRating"):[0m
[30;1m509 | [0m[35m            album.metadata.explicit = content_rating == "explicit"[0m

[31m--[ [0m[34mMatch #[0m[33m895[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m501 | [0m[35m            album.metadata.copyright = album_copyright[0m
[30;1m502 | [0m[35m        if record_label := attributes.get("recordLabel"):[0m
[30;1m503 | [0m[35m            album.metadata.label = record_label[0m
[30;1m504 | [0m[35m        if upc := attributes.get("upc"):[0m
[30;1m505 | [0m[35m            album.external_ids.add((ExternalID.BARCODE, "0" + upc))[0m
[30;1m506 | [0m[35m        if notes := attributes.get("editorialNotes"):[0m
[30;1m507 | [0m[35m            album.metadata.description = notes.get("standard") or notes.get("short")[0m

[31m--[ [0m[34mMatch #[0m[33m896[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m499 | [0m[35m            ][0m
[30;1m500 | [0m[35m        if album_copyright := attributes.get("copyright"):[0m
[30;1m501 | [0m[35m            album.metadata.copyright = album_copyright[0m
[30;1m502 | [0m[35m        if record_label := attributes.get("recordLabel"):[0m
[30;1m503 | [0m[35m            album.metadata.label = record_label[0m
[30;1m504 | [0m[35m        if upc := attributes.get("upc"):[0m
[30;1m505 | [0m[35m            album.external_ids.add((ExternalID.BARCODE, "0" + upc))[0m

[31m--[ [0m[34mMatch #[0m[33m897[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m497 | [0m[35m                    remotely_accessible=True,[0m
[30;1m498 | [0m[35m                )[0m
[30;1m499 | [0m[35m            ][0m
[30;1m500 | [0m[35m        if album_copyright := attributes.get("copyright"):[0m
[30;1m501 | [0m[35m            album.metadata.copyright = album_copyright[0m
[30;1m502 | [0m[35m        if record_label := attributes.get("recordLabel"):[0m
[30;1m503 | [0m[35m            album.metadata.label = record_label[0m

[31m--[ [0m[34mMatch #[0m[33m898[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m488 | [0m[35m            album.year = int(release_date.split("-")[0])[0m
[30;1m489 | [0m[35m        if genres := attributes.get("genreNames"):[0m
[30;1m490 | [0m[35m            album.metadata.genres = set(genres)[0m
[30;1m491 | [0m[35m        if artwork := attributes.get("artwork"):[0m
[30;1m492 | [0m[35m            album.metadata.images = [[0m
[30;1m493 | [0m[35m                MediaItemImage([0m
[30;1m494 | [0m[35m                    type=ImageType.THUMB,[0m

[31m--[ [0m[34mMatch #[0m[33m899[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m486 | [0m[35m            ][0m
[30;1m487 | [0m[35m        if release_date := attributes.get("releaseDate"):[0m
[30;1m488 | [0m[35m            album.year = int(release_date.split("-")[0])[0m
[30;1m489 | [0m[35m        if genres := attributes.get("genreNames"):[0m
[30;1m490 | [0m[35m            album.metadata.genres = set(genres)[0m
[30;1m491 | [0m[35m        if artwork := attributes.get("artwork"):[0m
[30;1m492 | [0m[35m            album.metadata.images = [[0m

[31m--[ [0m[34mMatch #[0m[33m900[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m484 | [0m[35m                    name=artist_name,[0m
[30;1m485 | [0m[35m                )[0m
[30;1m486 | [0m[35m            ][0m
[30;1m487 | [0m[35m        if release_date := attributes.get("releaseDate"):[0m
[30;1m488 | [0m[35m            album.year = int(release_date.split("-")[0])[0m
[30;1m489 | [0m[35m        if genres := attributes.get("genreNames"):[0m
[30;1m490 | [0m[35m            album.metadata.genres = set(genres)[0m

[31m--[ [0m[34mMatch #[0m[33m901[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m475 | [0m[35m        )[0m
[30;1m476 | [0m[35m        if artists := relationships.get("artists"):[0m
[30;1m477 | [0m[35m            album.artists = [self._parse_artist(artist) for artist in artists["data"]][0m
[30;1m478 | [0m[35m        elif artist_name := attributes.get("artistName"):[0m
[30;1m479 | [0m[35m            album.artists = [[0m
[30;1m480 | [0m[35m                ItemMapping([0m
[30;1m481 | [0m[35m                    media_type=MediaType.ARTIST,[0m

[31m--[ [0m[34mMatch #[0m[33m902[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m473 | [0m[35m                )[0m
[30;1m474 | [0m[35m            },[0m
[30;1m475 | [0m[35m        )[0m
[30;1m476 | [0m[35m        if artists := relationships.get("artists"):[0m
[30;1m477 | [0m[35m            album.artists = [self._parse_artist(artist) for artist in artists["data"]][0m
[30;1m478 | [0m[35m        elif artist_name := attributes.get("artistName"):[0m
[30;1m479 | [0m[35m            album.artists = [[0m

[31m--[ [0m[34mMatch #[0m[33m903[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m469 | [0m[35m                    provider_domain=self.domain,[0m
[30;1m470 | [0m[35m                    provider_instance=self.instance_id,[0m
[30;1m471 | [0m[35m                    url=attributes.get("url"),[0m
[30;1m472 | [0m[35m                    available=attributes.get("playParams", {}).get("id") is not None,[0m
[30;1m473 | [0m[35m                )[0m
[30;1m474 | [0m[35m            },[0m
[30;1m475 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m904[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m469 | [0m[35m                    provider_domain=self.domain,[0m
[30;1m470 | [0m[35m                    provider_instance=self.instance_id,[0m
[30;1m471 | [0m[35m                    url=attributes.get("url"),[0m
[30;1m472 | [0m[35m                    available=attributes.get("playParams", {}).get("id") is not None,[0m
[30;1m473 | [0m[35m                )[0m
[30;1m474 | [0m[35m            },[0m
[30;1m475 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m905[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m468 | [0m[35m                    item_id=album_id,[0m
[30;1m469 | [0m[35m                    provider_domain=self.domain,[0m
[30;1m470 | [0m[35m                    provider_instance=self.instance_id,[0m
[30;1m471 | [0m[35m                    url=attributes.get("url"),[0m
[30;1m472 | [0m[35m                    available=attributes.get("playParams", {}).get("id") is not None,[0m
[30;1m473 | [0m[35m                )[0m
[30;1m474 | [0m[35m            },[0m

[31m--[ [0m[34mMatch #[0m[33m906[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m462 | [0m[35m        album = Album([0m
[30;1m463 | [0m[35m            item_id=album_id,[0m
[30;1m464 | [0m[35m            provider=self.domain,[0m
[30;1m465 | [0m[35m            name=attributes.get("name"),[0m
[30;1m466 | [0m[35m            provider_mappings={[0m
[30;1m467 | [0m[35m                ProviderMapping([0m
[30;1m468 | [0m[35m                    item_id=album_id,[0m

[31m--[ [0m[34mMatch #[0m[33m907[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m456 | [0m[35m        if not is_available_in_catalog:[0m
[30;1m457 | [0m[35m            self.logger.debug([0m
[30;1m458 | [0m[35m                "Skipping album %s. Album is not available in the Apple Music catalog.",[0m
[30;1m459 | [0m[35m                attributes.get("name"),[0m
[30;1m460 | [0m[35m            )[0m
[30;1m461 | [0m[35m            return None[0m
[30;1m462 | [0m[35m        album = Album([0m

[31m--[ [0m[34mMatch #[0m[33m908[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m452 | [0m[35m                item_id=album_id,[0m
[30;1m453 | [0m[35m                name=album_id,[0m
[30;1m454 | [0m[35m            )[0m
[30;1m455 | [0m[35m        is_available_in_catalog = attributes.get("url") is not None[0m
[30;1m456 | [0m[35m        if not is_available_in_catalog:[0m
[30;1m457 | [0m[35m            self.logger.debug([0m
[30;1m458 | [0m[35m                "Skipping album %s. Album is not available in the Apple Music catalog.",[0m

[31m--[ [0m[34mMatch #[0m[33m909[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m439 | [0m[35m            and "attributes" in relationships["catalog"]["data"][0][0m
[30;1m440 | [0m[35m        ):[0m
[30;1m441 | [0m[35m            album_id = relationships.get("catalog", {})["data"][0]["id"][0m
[30;1m442 | [0m[35m            attributes = relationships.get("catalog", {})["data"][0]["attributes"][0m
[30;1m443 | [0m[35m        elif "attributes" in album_obj:[0m
[30;1m444 | [0m[35m            album_id = album_obj["id"][0m
[30;1m445 | [0m[35m            attributes = album_obj["attributes"][0m

[31m--[ [0m[34mMatch #[0m[33m910[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m438 | [0m[35m            and relationships["catalog"]["data"] != [][0m
[30;1m439 | [0m[35m            and "attributes" in relationships["catalog"]["data"][0][0m
[30;1m440 | [0m[35m        ):[0m
[30;1m441 | [0m[35m            album_id = relationships.get("catalog", {})["data"][0]["id"][0m
[30;1m442 | [0m[35m            attributes = relationships.get("catalog", {})["data"][0]["attributes"][0m
[30;1m443 | [0m[35m        elif "attributes" in album_obj:[0m
[30;1m444 | [0m[35m            album_id = album_obj["id"][0m

[31m--[ [0m[34mMatch #[0m[33m911[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m432 | [0m[35m    def _parse_album(self, album_obj: dict) -> Album | ItemMapping | None:[0m
[30;1m433 | [0m[35m        """Parse album object to generic layout."""[0m
[30;1m434 | [0m[35m        relationships = album_obj.get("relationships", {})[0m
[30;1m435 | [0m[35m        response_type = album_obj.get("type")[0m
[30;1m436 | [0m[35m        if ([0m
[30;1m437 | [0m[35m            response_type == "library-albums"[0m
[30;1m438 | [0m[35m            and relationships["catalog"]["data"] != [][0m

[31m--[ [0m[34mMatch #[0m[33m912[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m431 | [0m[35m[0m
[30;1m432 | [0m[35m    def _parse_album(self, album_obj: dict) -> Album | ItemMapping | None:[0m
[30;1m433 | [0m[35m        """Parse album object to generic layout."""[0m
[30;1m434 | [0m[35m        relationships = album_obj.get("relationships", {})[0m
[30;1m435 | [0m[35m        response_type = album_obj.get("type")[0m
[30;1m436 | [0m[35m        if ([0m
[30;1m437 | [0m[35m            response_type == "library-albums"[0m

[31m--[ [0m[34mMatch #[0m[33m913[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m426 | [0m[35m        if genres := attributes.get("genreNames"):[0m
[30;1m427 | [0m[35m            artist.metadata.genres = set(genres)[0m
[30;1m428 | [0m[35m        if notes := attributes.get("editorialNotes"):[0m
[30;1m429 | [0m[35m            artist.metadata.description = notes.get("standard") or notes.get("short")[0m
[30;1m430 | [0m[35m        return artist[0m
[30;1m431 | [0m[35m[0m
[30;1m432 | [0m[35m    def _parse_album(self, album_obj: dict) -> Album | ItemMapping | None:[0m

[31m--[ [0m[34mMatch #[0m[33m914[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m426 | [0m[35m        if genres := attributes.get("genreNames"):[0m
[30;1m427 | [0m[35m            artist.metadata.genres = set(genres)[0m
[30;1m428 | [0m[35m        if notes := attributes.get("editorialNotes"):[0m
[30;1m429 | [0m[35m            artist.metadata.description = notes.get("standard") or notes.get("short")[0m
[30;1m430 | [0m[35m        return artist[0m
[30;1m431 | [0m[35m[0m
[30;1m432 | [0m[35m    def _parse_album(self, album_obj: dict) -> Album | ItemMapping | None:[0m

[31m--[ [0m[34mMatch #[0m[33m915[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m425 | [0m[35m            ][0m
[30;1m426 | [0m[35m        if genres := attributes.get("genreNames"):[0m
[30;1m427 | [0m[35m            artist.metadata.genres = set(genres)[0m
[30;1m428 | [0m[35m        if notes := attributes.get("editorialNotes"):[0m
[30;1m429 | [0m[35m            artist.metadata.description = notes.get("standard") or notes.get("short")[0m
[30;1m430 | [0m[35m        return artist[0m
[30;1m431 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m916[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m423 | [0m[35m                    remotely_accessible=True,[0m
[30;1m424 | [0m[35m                )[0m
[30;1m425 | [0m[35m            ][0m
[30;1m426 | [0m[35m        if genres := attributes.get("genreNames"):[0m
[30;1m427 | [0m[35m            artist.metadata.genres = set(genres)[0m
[30;1m428 | [0m[35m        if notes := attributes.get("editorialNotes"):[0m
[30;1m429 | [0m[35m            artist.metadata.description = notes.get("standard") or notes.get("short")[0m

[31m--[ [0m[34mMatch #[0m[33m917[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m414 | [0m[35m                )[0m
[30;1m415 | [0m[35m            },[0m
[30;1m416 | [0m[35m        )[0m
[30;1m417 | [0m[35m        if artwork := attributes.get("artwork"):[0m
[30;1m418 | [0m[35m            artist.metadata.images = [[0m
[30;1m419 | [0m[35m                MediaItemImage([0m
[30;1m420 | [0m[35m                    type=ImageType.THUMB,[0m

[31m--[ [0m[34mMatch #[0m[33m918[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m410 | [0m[35m                    item_id=artist_id,[0m
[30;1m411 | [0m[35m                    provider_domain=self.domain,[0m
[30;1m412 | [0m[35m                    provider_instance=self.instance_id,[0m
[30;1m413 | [0m[35m                    url=attributes.get("url"),[0m
[30;1m414 | [0m[35m                )[0m
[30;1m415 | [0m[35m            },[0m
[30;1m416 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m919[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m403 | [0m[35m            )[0m
[30;1m404 | [0m[35m        artist = Artist([0m
[30;1m405 | [0m[35m            item_id=artist_id,[0m
[30;1m406 | [0m[35m            name=attributes.get("name"),[0m
[30;1m407 | [0m[35m            provider=self.domain,[0m
[30;1m408 | [0m[35m            provider_mappings={[0m
[30;1m409 | [0m[35m                ProviderMapping([0m

[31m--[ [0m[34mMatch #[0m[33m920[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m384 | [0m[35m        relationships = artist_obj.get("relationships", {})[0m
[30;1m385 | [0m[35m        if ([0m
[30;1m386 | [0m[35m            artist_obj.get("type") == "library-artists"[0m
[30;1m387 | [0m[35m            and relationships.get("catalog", {}).get("data", []) != [][0m
[30;1m388 | [0m[35m        ):[0m
[30;1m389 | [0m[35m            artist_id = relationships["catalog"]["data"][0]["id"][0m
[30;1m390 | [0m[35m            attributes = relationships["catalog"]["data"][0]["attributes"][0m

[31m--[ [0m[34mMatch #[0m[33m921[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m384 | [0m[35m        relationships = artist_obj.get("relationships", {})[0m
[30;1m385 | [0m[35m        if ([0m
[30;1m386 | [0m[35m            artist_obj.get("type") == "library-artists"[0m
[30;1m387 | [0m[35m            and relationships.get("catalog", {}).get("data", []) != [][0m
[30;1m388 | [0m[35m        ):[0m
[30;1m389 | [0m[35m            artist_id = relationships["catalog"]["data"][0]["id"][0m
[30;1m390 | [0m[35m            attributes = relationships["catalog"]["data"][0]["attributes"][0m

[31m--[ [0m[34mMatch #[0m[33m922[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m383 | [0m[35m        """Parse artist object to generic layout."""[0m
[30;1m384 | [0m[35m        relationships = artist_obj.get("relationships", {})[0m
[30;1m385 | [0m[35m        if ([0m
[30;1m386 | [0m[35m            artist_obj.get("type") == "library-artists"[0m
[30;1m387 | [0m[35m            and relationships.get("catalog", {}).get("data", []) != [][0m
[30;1m388 | [0m[35m        ):[0m
[30;1m389 | [0m[35m            artist_id = relationships["catalog"]["data"][0]["id"][0m

[31m--[ [0m[34mMatch #[0m[33m923[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m381 | [0m[35m[0m
[30;1m382 | [0m[35m    def _parse_artist(self, artist_obj):[0m
[30;1m383 | [0m[35m        """Parse artist object to generic layout."""[0m
[30;1m384 | [0m[35m        relationships = artist_obj.get("relationships", {})[0m
[30;1m385 | [0m[35m        if ([0m
[30;1m386 | [0m[35m            artist_obj.get("type") == "library-artists"[0m
[30;1m387 | [0m[35m            and relationships.get("catalog", {}).get("data", []) != [][0m

[31m--[ [0m[34mMatch #[0m[33m924[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m210 | [0m[35m                self.logger.debug([0m
[30;1m211 | [0m[35m                    "Skipping track. No catalog version found for %s - %s",[0m
[30;1m212 | [0m[35m                    item["attributes"].get("artistName", ""),[0m
[30;1m213 | [0m[35m                    item["attributes"].get("name", ""),[0m
[30;1m214 | [0m[35m                )[0m
[30;1m215 | [0m[35m                continue[0m
[30;1m216 | [0m[35m            song_catalog_ids.append(catalog_id)[0m

[31m--[ [0m[34mMatch #[0m[33m925[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m209 | [0m[35m            if not catalog_id:[0m
[30;1m210 | [0m[35m                self.logger.debug([0m
[30;1m211 | [0m[35m                    "Skipping track. No catalog version found for %s - %s",[0m
[30;1m212 | [0m[35m                    item["attributes"].get("artistName", ""),[0m
[30;1m213 | [0m[35m                    item["attributes"].get("name", ""),[0m
[30;1m214 | [0m[35m                )[0m
[30;1m215 | [0m[35m                continue[0m

[31m--[ [0m[34mMatch #[0m[33m926[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m205 | [0m[35m        endpoint = "me/library/songs"[0m
[30;1m206 | [0m[35m        song_catalog_ids = [][0m
[30;1m207 | [0m[35m        for item in await self._get_all_items(endpoint):[0m
[30;1m208 | [0m[35m            catalog_id = item.get("attributes", {}).get("playParams", {}).get("catalogId")[0m
[30;1m209 | [0m[35m            if not catalog_id:[0m
[30;1m210 | [0m[35m                self.logger.debug([0m
[30;1m211 | [0m[35m                    "Skipping track. No catalog version found for %s - %s",[0m

[31m--[ [0m[34mMatch #[0m[33m927[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m205 | [0m[35m        endpoint = "me/library/songs"[0m
[30;1m206 | [0m[35m        song_catalog_ids = [][0m
[30;1m207 | [0m[35m        for item in await self._get_all_items(endpoint):[0m
[30;1m208 | [0m[35m            catalog_id = item.get("attributes", {}).get("playParams", {}).get("catalogId")[0m
[30;1m209 | [0m[35m            if not catalog_id:[0m
[30;1m210 | [0m[35m                self.logger.debug([0m
[30;1m211 | [0m[35m                    "Skipping track. No catalog version found for %s - %s",[0m

[31m--[ [0m[34mMatch #[0m[33m928[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m205 | [0m[35m        endpoint = "me/library/songs"[0m
[30;1m206 | [0m[35m        song_catalog_ids = [][0m
[30;1m207 | [0m[35m        for item in await self._get_all_items(endpoint):[0m
[30;1m208 | [0m[35m            catalog_id = item.get("attributes", {}).get("playParams", {}).get("catalogId")[0m
[30;1m209 | [0m[35m            if not catalog_id:[0m
[30;1m210 | [0m[35m                self.logger.debug([0m
[30;1m211 | [0m[35m                    "Skipping track. No catalog version found for %s - %s",[0m

[31m--[ [0m[34mMatch #[0m[33m929[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m375 | [0m[35m            path=stream_url,[0m
[30;1m376 | [0m[35m            can_seek=True,[0m
[30;1m377 | [0m[35m            allow_seek=True,[0m
[30;1m378 | [0m[35m            # enforce caching because the apple streams are mp4 files with moov atom at the end[0m
[30;1m379 | [0m[35m            enable_cache=True,[0m
[30;1m380 | [0m[35m        )[0m
[30;1m381 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m930[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m343 | [0m[35m        """Retrieve a dynamic list of tracks based on the provided item."""[0m
[30;1m344 | [0m[35m        # Note, Apple music does not have an official endpoint for similar tracks.[0m
[30;1m345 | [0m[35m        # We will use the next-tracks endpoint to get a list of tracks that are similar to the[0m
[30;1m346 | [0m[35m        # provided track. However, Apple music only provides 2 tracks at a time, so we will[0m
[30;1m347 | [0m[35m        # need to call the endpoint multiple times. Therefore, set a limit to 6 to prevent[0m
[30;1m348 | [0m[35m        # flooding the apple music api.[0m
[30;1m349 | [0m[35m        limit = 6[0m

[31m--[ [0m[34mMatch #[0m[33m931[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m317 | [0m[35m            response = await self._get_data(endpoint)[0m
[30;1m318 | [0m[35m        except MediaNotFoundError:[0m
[30;1m319 | [0m[35m            # Some artists do not have top tracks, return empty list[0m
[30;1m320 | [0m[35m            self.logger.info("No top tracks found for artist %s", prov_artist_id)[0m
[30;1m321 | [0m[35m            return [][0m
[30;1m322 | [0m[35m        return [self._parse_track(track) for track in response["data"] if track["id"]][0m
[30;1m323 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m932[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m316 | [0m[35m        try:[0m
[30;1m317 | [0m[35m            response = await self._get_data(endpoint)[0m
[30;1m318 | [0m[35m        except MediaNotFoundError:[0m
[30;1m319 | [0m[35m            # Some artists do not have top tracks, return empty list[0m
[30;1m320 | [0m[35m            self.logger.info("No top tracks found for artist %s", prov_artist_id)[0m
[30;1m321 | [0m[35m            return [][0m
[30;1m322 | [0m[35m        return [self._parse_track(track) for track in response["data"] if track["id"]][0m

[31m--[ [0m[34mMatch #[0m[33m933[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m214 | [0m[35m                )[0m
[30;1m215 | [0m[35m                continue[0m
[30;1m216 | [0m[35m            song_catalog_ids.append(catalog_id)[0m
[30;1m217 | [0m[35m        # Obtain catalog info per 200 songs, the documented limit of 300 results in a 504 timeout[0m
[30;1m218 | [0m[35m        max_limit = 200[0m
[30;1m219 | [0m[35m        for i in range(0, len(song_catalog_ids), max_limit):[0m
[30;1m220 | [0m[35m            catalog_ids = song_catalog_ids[i : i + max_limit][0m
[30;1m221 | [0m[35m            catalog_endpoint = f"catalog/{self._storefront}/songs"[0m

[31m--[ [0m[34mMatch #[0m[33m934[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom __future__ import annotations[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mimport base64[0m
[30;1m6 | [0m[35mimport json[0m
[30;1m7 | [0m[35mimport os[0m
[30;1m8 | [0m[35mfrom typing import TYPE_CHECKING, Any[0m
[30;1m9 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m935[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/chromecast/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m189 | [0m[35m[0m
[30;1m190 | [0m[35m    def multizone_new_cast_status(self, group_uuid, cast_status) -> None:[0m
[30;1m191 | [0m[35m        """Handle reception of a new CastStatus for a group."""[0m
[30;1m192 | [0m[35m        if group_player := self.prov.castplayers.get(group_uuid):[0m
[30;1m193 | [0m[35m            if group_player.cc.media_controller.is_active:[0m
[30;1m194 | [0m[35m                self.castplayer.active_group = group_uuid[0m
[30;1m195 | [0m[35m            elif group_uuid == self.castplayer.active_group:[0m

[31m--[ [0m[34mMatch #[0m[33m936[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/chromecast/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m109 | [0m[35m            for group in status["multizone"]["groups"]:[0m
[30;1m110 | [0m[35m                if "multichannel_group" not in group:[0m
[30;1m111 | [0m[35m                    continue[0m
[30;1m112 | [0m[35m                if group["multichannel_group"] and (udn := group.get("uuid")):[0m
[30;1m113 | [0m[35m                    uuid = UUID(udn.replace("-", ""))[0m
[30;1m114 | [0m[35m                    multichannel_groups.add(uuid)[0m
[30;1m115 | [0m[35m    except (urllib.error.HTTPError, urllib.error.URLError, OSError, KeyError, ValueError):[0m

[31m--[ [0m[34mMatch #[0m[33m937[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/chromecast/helpers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m101 | [0m[35m        )[0m
[30;1m102 | [0m[35m        if "multizone" in status and "dynamic_groups" in status["multizone"]:[0m
[30;1m103 | [0m[35m            for group in status["multizone"]["dynamic_groups"]:[0m
[30;1m104 | [0m[35m                if udn := group.get("uuid"):[0m
[30;1m105 | [0m[35m                    uuid = UUID(udn.replace("-", ""))[0m
[30;1m106 | [0m[35m                    dynamic_groups.add(uuid)[0m
[30;1m107 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m938[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/audio.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1425 | [0m[35m            # - But only contains a single player (since nothing is preventing DSP)[0m
[30;1m1426 | [0m[35m            # We can still apply the DSP of that single player.[0m
[30;1m1427 | [0m[35m            if player.group_childs:[0m
[30;1m1428 | [0m[35m                child_player = mass.players.get(player.group_childs[0])[0m
[30;1m1429 | [0m[35m                dsp = mass.config.get_player_dsp_config(child_player)[0m
[30;1m1430 | [0m[35m            else:[0m
[30;1m1431 | [0m[35m                # This should normally never happen, but if it does, we disable DSP.[0m

[31m--[ [0m[34mMatch #[0m[33m939[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/audio.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1412 | [0m[35m    dsp = mass.config.get_player_dsp_config(player_id)[0m
[30;1m1413 | [0m[35m    limiter_enabled = True[0m
[30;1m1414 | [0m[35m[0m
[30;1m1415 | [0m[35m    if player := mass.players.get(player_id):[0m
[30;1m1416 | [0m[35m        if is_grouping_preventing_dsp(player):[0m
[30;1m1417 | [0m[35m            # We can not correctly apply DSP to a grouped player without multi-device DSP support,[0m
[30;1m1418 | [0m[35m            # so we disable it.[0m

[31m--[ [0m[34mMatch #[0m[33m940[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/audio.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1174 | [0m[35m[0m
[30;1m1175 | [0m[35m    # start the streaming from http[0m
[30;1m1176 | [0m[35m    bytes_received = 0[0m
[30;1m1177 | [0m[35m    async with mass.http_session.get([0m
[30;1m1178 | [0m[35m        url, allow_redirects=True, headers=headers, timeout=timeout[0m
[30;1m1179 | [0m[35m    ) as resp:[0m
[30;1m1180 | [0m[35m        is_partial = resp.status == 206[0m

[31m--[ [0m[34mMatch #[0m[33m941[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/audio.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1145 | [0m[35m            resp.raise_for_status()[0m
[30;1m1146 | [0m[35m            if size := resp.headers.get("Content-Length"):[0m
[30;1m1147 | [0m[35m                streamdetails.size = int(size)[0m
[30;1m1148 | [0m[35m            seek_supported = resp.headers.get("Accept-Ranges") == "bytes"[0m
[30;1m1149 | [0m[35m    # headers[0m
[30;1m1150 | [0m[35m    headers = {**HTTP_HEADERS}[0m
[30;1m1151 | [0m[35m    timeout = ClientTimeout(total=0, connect=30, sock_read=5 * 60)[0m

[31m--[ [0m[34mMatch #[0m[33m942[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/audio.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1143 | [0m[35m    if seek_position or not streamdetails.size:[0m
[30;1m1144 | [0m[35m        async with mass.http_session.head(url, allow_redirects=True, headers=HTTP_HEADERS) as resp:[0m
[30;1m1145 | [0m[35m            resp.raise_for_status()[0m
[30;1m1146 | [0m[35m            if size := resp.headers.get("Content-Length"):[0m
[30;1m1147 | [0m[35m                streamdetails.size = int(size)[0m
[30;1m1148 | [0m[35m            seek_supported = resp.headers.get("Accept-Ranges") == "bytes"[0m
[30;1m1149 | [0m[35m    # headers[0m

[31m--[ [0m[34mMatch #[0m[33m943[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/audio.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1119 | [0m[35m        return PlaylistItem(path=url, key=substreams[0].key)[0m
[30;1m1120 | [0m[35m    # sort substreams on best quality (highest bandwidth) when available[0m
[30;1m1121 | [0m[35m    if any(x for x in substreams if x.stream_info):[0m
[30;1m1122 | [0m[35m        substreams.sort(key=lambda x: int(x.stream_info.get("BANDWIDTH", "0")), reverse=True)[0m
[30;1m1123 | [0m[35m    substream = substreams[0][0m
[30;1m1124 | [0m[35m    if not substream.path.startswith("http"):[0m
[30;1m1125 | [0m[35m        # path is relative, stitch it together[0m

[31m--[ [0m[34mMatch #[0m[33m944[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/audio.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1098 | [0m[35m    timeout = ClientTimeout(total=0, connect=30, sock_read=5 * 60)[0m
[30;1m1099 | [0m[35m    # fetch master playlist and select (best) child playlist[0m
[30;1m1100 | [0m[35m    # https://datatracker.ietf.org/doc/html/draft-pantos-http-live-streaming-19#section-10[0m
[30;1m1101 | [0m[35m    async with mass.http_session.get([0m
[30;1m1102 | [0m[35m        url, allow_redirects=True, headers=HTTP_HEADERS, timeout=timeout[0m
[30;1m1103 | [0m[35m    ) as resp:[0m
[30;1m1104 | [0m[35m        resp.raise_for_status()[0m

[31m--[ [0m[34mMatch #[0m[33m945[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/audio.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1048 | [0m[35m    """Get (radio) audio stream from HTTP, including ICY metadata retrieval."""[0m
[30;1m1049 | [0m[35m    timeout = ClientTimeout(total=0, connect=30, sock_read=5 * 60)[0m
[30;1m1050 | [0m[35m    LOGGER.debug("Start streaming radio with ICY metadata from url %s", url)[0m
[30;1m1051 | [0m[35m    async with mass.http_session.get([0m
[30;1m1052 | [0m[35m        url, allow_redirects=True, headers=HTTP_HEADERS_ICY, timeout=timeout[0m
[30;1m1053 | [0m[35m    ) as resp:[0m
[30;1m1054 | [0m[35m        headers = resp.headers[0m

[31m--[ [0m[34mMatch #[0m[33m946[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/audio.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1017 | [0m[35m            or ".m3u8?" in url[0m
[30;1m1018 | [0m[35m            or ".pls?" in url[0m
[30;1m1019 | [0m[35m            or "audio/x-mpegurl" in headers.get("content-type")[0m
[30;1m1020 | [0m[35m            or "audio/x-scpls" in headers.get("content-type", "")[0m
[30;1m1021 | [0m[35m        ):[0m
[30;1m1022 | [0m[35m            # url is playlist, we need to unfold it[0m
[30;1m1023 | [0m[35m            try:[0m

[31m--[ [0m[34mMatch #[0m[33m947[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/audio.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1016 | [0m[35m            or ".m3u?" in url[0m
[30;1m1017 | [0m[35m            or ".m3u8?" in url[0m
[30;1m1018 | [0m[35m            or ".pls?" in url[0m
[30;1m1019 | [0m[35m            or "audio/x-mpegurl" in headers.get("content-type")[0m
[30;1m1020 | [0m[35m            or "audio/x-scpls" in headers.get("content-type", "")[0m
[30;1m1021 | [0m[35m        ):[0m
[30;1m1022 | [0m[35m            # url is playlist, we need to unfold it[0m

[31m--[ [0m[34mMatch #[0m[33m948[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/audio.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1009 | [0m[35m            resp.raise_for_status()[0m
[30;1m1010 | [0m[35m            if not resp.headers:[0m
[30;1m1011 | [0m[35m                raise InvalidDataError("no headers found")[0m
[30;1m1012 | [0m[35m        if headers.get("icy-metaint") is not None:[0m
[30;1m1013 | [0m[35m            stream_type = StreamType.ICY[0m
[30;1m1014 | [0m[35m        if ([0m
[30;1m1015 | [0m[35m            url.endswith((".m3u", ".m3u8", ".pls"))[0m

[31m--[ [0m[34mMatch #[0m[33m949[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/audio.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1002 | [0m[35m    resolved_url = url[0m
[30;1m1003 | [0m[35m    timeout = ClientTimeout(total=0, connect=10, sock_read=5)[0m
[30;1m1004 | [0m[35m    try:[0m
[30;1m1005 | [0m[35m        async with mass.http_session.get([0m
[30;1m1006 | [0m[35m            url, headers=HTTP_HEADERS_ICY, allow_redirects=True, timeout=timeout[0m
[30;1m1007 | [0m[35m        ) as resp:[0m
[30;1m1008 | [0m[35m            headers = resp.headers[0m

[31m--[ [0m[34mMatch #[0m[33m950[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/audio.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m996 | [0m[35m    - StreamType to determine ICY (radio) or HLS stream.[0m
[30;1m997 | [0m[35m    """[0m
[30;1m998 | [0m[35m    cache_base_key = "resolved_radio_info"[0m
[30;1m999 | [0m[35m    if cache := await mass.cache.get(url, base_key=cache_base_key):[0m
[30;1m1000 | [0m[35m        return cache[0m
[30;1m1001 | [0m[35m    stream_type = StreamType.HTTP[0m
[30;1m1002 | [0m[35m    resolved_url = url[0m

[31m--[ [0m[34mMatch #[0m[33m951[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/audio.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m504 | [0m[35m            # skip if we already have the details (so if it's the group leader)[0m
[30;1m505 | [0m[35m            if child_id in dsp:[0m
[30;1m506 | [0m[35m                continue[0m
[30;1m507 | [0m[35m            if child_player := mass.players.get(child_id):[0m
[30;1m508 | [0m[35m                dsp[child_id] = get_player_dsp_details([0m
[30;1m509 | [0m[35m                    mass, child_player, group_preventing_dsp=group_preventing_dsp[0m
[30;1m510 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m952[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/audio.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m469 | [0m[35m    queue_id: str,[0m
[30;1m470 | [0m[35m) -> dict[str, DSPDetails]:[0m
[30;1m471 | [0m[35m    """Return DSP details of all players playing this queue, keyed by player_id."""[0m
[30;1m472 | [0m[35m    player = mass.players.get(queue_id)[0m
[30;1m473 | [0m[35m    dsp: dict[str, DSPDetails] = {}[0m
[30;1m474 | [0m[35m    group_preventing_dsp = is_grouping_preventing_dsp(player)[0m
[30;1m475 | [0m[35m    output_format = None[0m

[31m--[ [0m[34mMatch #[0m[33m953[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/audio.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m88 | [0m[35m    async def create(self) -> None:[0m
[30;1m89 | [0m[35m        """Create the cache file (if needed)."""[0m
[30;1m90 | [0m[35m        if self._cache_file is None:[0m
[30;1m91 | [0m[35m            if cached_cache_path := await self.mass.cache.get([0m
[30;1m92 | [0m[35m                self.streamdetails.uri, base_key=CACHE_BASE_KEY[0m
[30;1m93 | [0m[35m            ):[0m
[30;1m94 | [0m[35m                # we have a mapping stored for this uri, prefer that[0m

[31m--[ [0m[34mMatch #[0m[33m954[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/audio.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1465 | [0m[35m    elif conf_channels == "right":[0m
[30;1m1466 | [0m[35m        filter_params.append("pan=mono|c0=FR")[0m
[30;1m1467 | [0m[35m[0m
[30;1m1468 | [0m[35m    # Add safety limiter at the end[0m
[30;1m1469 | [0m[35m    if limiter_enabled:[0m
[30;1m1470 | [0m[35m        filter_params.append("alimiter=limit=-2dB:level=false:asc=true")[0m
[30;1m1471 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m955[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/audio.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m953 | [0m[35m    data_chunk_spec = b"<4sL"[0m
[30;1m954 | [0m[35m    if duration is None:[0m
[30;1m955 | [0m[35m        # use max value possible[0m
[30;1m956 | [0m[35m        datasize = 4254768000  # = 6,7 hours at 44100/16[0m
[30;1m957 | [0m[35m    else:[0m
[30;1m958 | [0m[35m        # calculate from duration[0m
[30;1m959 | [0m[35m        numsamples = samplerate * duration[0m

[31m--[ [0m[34mMatch #[0m[33m956[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/audio.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m782 | [0m[35m        chunk_size = pcm_format.pcm_sample_size[0m
[30;1m783 | [0m[35m        async for chunk in ffmpeg_proc.iter_chunked(chunk_size):[0m
[30;1m784 | [0m[35m            if chunk_number == 1:[0m
[30;1m785 | [0m[35m                # At this point ffmpeg has started and should now know the codec used[0m
[30;1m786 | [0m[35m                # for encoding the audio.[0m
[30;1m787 | [0m[35m                streamdetails.audio_format.codec_type = ffmpeg_proc.input_format.codec_type[0m
[30;1m788 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m957[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/audio.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m194 | [0m[35m        # this may feel a bit redundant, but it's the most reliable way to fetch the audio[0m
[30;1m195 | [0m[35m        # because ffmpeg has all logic to handle different audio formats, codecs, etc.[0m
[30;1m196 | [0m[35m        # and it also accounts for complicated cases such as encrypted streams or[0m
[30;1m197 | [0m[35m        # m4a/mp4 streams with the moov atom at the end of the file.[0m
[30;1m198 | [0m[35m        # ffmpeg will produce a lossless copy of the original codec.[0m
[30;1m199 | [0m[35m        try:[0m
[30;1m200 | [0m[35m            ffmpeg_proc = FFMpeg([0m

[31m--[ [0m[34mMatch #[0m[33m958[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/audio.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m160 | [0m[35m                # cache file was created recently but ready[0m
[30;1m161 | [0m[35m                return self._cache_file[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m        # cache file does not exist at all (or is still being written)[0m
[30;1m164 | [0m[35m        await self.create()[0m
[30;1m165 | [0m[35m        return _stream_from_cache()[0m
[30;1m166 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m959[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/audio.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1148 | [0m[35m            seek_supported = resp.headers.get("Accept-Ranges") == "bytes"[0m
[30;1m1149 | [0m[35m    # headers[0m
[30;1m1150 | [0m[35m    headers = {**HTTP_HEADERS}[0m
[30;1m1151 | [0m[35m    timeout = ClientTimeout(total=0, connect=30, sock_read=5 * 60)[0m
[30;1m1152 | [0m[35m    skip_bytes = 0[0m
[30;1m1153 | [0m[35m    if seek_position and streamdetails.size:[0m
[30;1m1154 | [0m[35m        skip_bytes = int(streamdetails.size / streamdetails.duration * seek_position)[0m

[31m--[ [0m[34mMatch #[0m[33m960[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/audio.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1138 | [0m[35m    LOGGER.debug("Start HTTP stream for %s (seek_position %s)", streamdetails.uri, seek_position)[0m
[30;1m1139 | [0m[35m    if seek_position:[0m
[30;1m1140 | [0m[35m        assert streamdetails.duration, "Duration required for seek requests"[0m
[30;1m1141 | [0m[35m    # try to get filesize with a head request[0m
[30;1m1142 | [0m[35m    seek_supported = streamdetails.can_seek[0m
[30;1m1143 | [0m[35m    if seek_position or not streamdetails.size:[0m
[30;1m1144 | [0m[35m        async with mass.http_session.head(url, allow_redirects=True, headers=HTTP_HEADERS) as resp:[0m

[31m--[ [0m[34mMatch #[0m[33m961[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/audio.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1117 | [0m[35m        and not x.path.endswith((".m3u", ".m3u8"))[0m
[30;1m1118 | [0m[35m    ):[0m
[30;1m1119 | [0m[35m        return PlaylistItem(path=url, key=substreams[0].key)[0m
[30;1m1120 | [0m[35m    # sort substreams on best quality (highest bandwidth) when available[0m
[30;1m1121 | [0m[35m    if any(x for x in substreams if x.stream_info):[0m
[30;1m1122 | [0m[35m        substreams.sort(key=lambda x: int(x.stream_info.get("BANDWIDTH", "0")), reverse=True)[0m
[30;1m1123 | [0m[35m    substream = substreams[0][0m

[31m--[ [0m[34mMatch #[0m[33m962[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/audio.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1095 | [0m[35m    url: str,[0m
[30;1m1096 | [0m[35m) -> PlaylistItem:[0m
[30;1m1097 | [0m[35m    """Select the (highest quality) HLS substream for given HLS playlist/URL."""[0m
[30;1m1098 | [0m[35m    timeout = ClientTimeout(total=0, connect=30, sock_read=5 * 60)[0m
[30;1m1099 | [0m[35m    # fetch master playlist and select (best) child playlist[0m
[30;1m1100 | [0m[35m    # https://datatracker.ietf.org/doc/html/draft-pantos-http-live-streaming-19#section-10[0m
[30;1m1101 | [0m[35m    async with mass.http_session.get([0m

[31m--[ [0m[34mMatch #[0m[33m963[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/audio.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1046 | [0m[35m    mass: MusicAssistant, url: str, streamdetails: StreamDetails[0m
[30;1m1047 | [0m[35m) -> AsyncGenerator[bytes, None]:[0m
[30;1m1048 | [0m[35m    """Get (radio) audio stream from HTTP, including ICY metadata retrieval."""[0m
[30;1m1049 | [0m[35m    timeout = ClientTimeout(total=0, connect=30, sock_read=5 * 60)[0m
[30;1m1050 | [0m[35m    LOGGER.debug("Start streaming radio with ICY metadata from url %s", url)[0m
[30;1m1051 | [0m[35m    async with mass.http_session.get([0m
[30;1m1052 | [0m[35m        url, allow_redirects=True, headers=HTTP_HEADERS_ICY, timeout=timeout[0m

[31m--[ [0m[34mMatch #[0m[33m964[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/audio.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1000 | [0m[35m        return cache[0m
[30;1m1001 | [0m[35m    stream_type = StreamType.HTTP[0m
[30;1m1002 | [0m[35m    resolved_url = url[0m
[30;1m1003 | [0m[35m    timeout = ClientTimeout(total=0, connect=10, sock_read=5)[0m
[30;1m1004 | [0m[35m    try:[0m
[30;1m1005 | [0m[35m        async with mass.http_session.get([0m
[30;1m1006 | [0m[35m            url, headers=HTTP_HEADERS_ICY, allow_redirects=True, timeout=timeout[0m

[31m--[ [0m[34mMatch #[0m[33m965[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/audio.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m549 | [0m[35m    else:[0m
[30;1m550 | [0m[35m        # retrieve streamdetails from provider[0m
[30;1m551 | [0m[35m        media_item = queue_item.media_item[0m
[30;1m552 | [0m[35m        # sort by quality and check item's availability[0m
[30;1m553 | [0m[35m        for prov_media in sorted([0m
[30;1m554 | [0m[35m            media_item.provider_mappings, key=lambda x: x.quality or 0, reverse=True[0m
[30;1m555 | [0m[35m        ):[0m

[31m--[ [0m[34mMatch #[0m[33m966[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/audio.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mimport os[0m
[30;1m8 | [0m[35mimport re[0m
[30;1m9 | [0m[35mimport struct[0m
[30;1m10 | [0m[35mimport time[0m
[30;1m11 | [0m[35mfrom collections.abc import AsyncGenerator[0m
[30;1m12 | [0m[35mfrom io import BytesIO[0m
[30;1m13 | [0m[35mfrom typing import TYPE_CHECKING, Final, cast[0m
[30;1m14 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m967[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/helpers.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m97 | [0m[35m        )[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m    def guard_ok_mass(self, item_id: str, episode_id: str | None = None) -> bool:[0m
[30;1m100 | [0m[35m        """Check, if we may update against a mass internal item.[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m        Here, we use the current time and compare it against the stored time.[0m
[30;1m103 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m968[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/helpers.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m80 | [0m[35m        self._progresses.append(progress)[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m    def guard_ok_abs(self, abs_progress: MediaProgress) -> bool:[0m
[30;1m83 | [0m[35m        """Check, if we may update against an abs media progress.[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m        The abs media progress has a property last_update_ms, which also reflects non[0m
[30;1m86 | [0m[35m        mass external updates. Here, we compare this property against a potential[0m

[31m--[ [0m[34mMatch #[0m[33m969[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/helpers.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m70 | [0m[35m            self._progresses.remove(progress)[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m    def add_progress(self, item_id: str, episode_id: str | None = None) -> None:[0m
[30;1m73 | [0m[35m        """Store a timestamp for the last update of an audiobook or podcast episode, mass ids."""[0m
[30;1m74 | [0m[35m        if len(self._progresses) > self._max_progresses:[0m
[30;1m75 | [0m[35m            self._remove_oldest()[0m
[30;1m76 | [0m[35m        self.remove_progress(item_id=item_id, episode_id=episode_id)[0m

[31m--[ [0m[34mMatch #[0m[33m970[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/helpers.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m46 | [0m[35m        """Init."""[0m
[30;1m47 | [0m[35m        self._progresses: list[_ProgressHelper] = [][0m
[30;1m48 | [0m[35m        self._max_progresses = 100[0m
[30;1m49 | [0m[35m        # 12s have to have passed before we accept an external progress update[0m
[30;1m50 | [0m[35m        # abs updates every 15 s[0m
[30;1m51 | [0m[35m        self._min_time_between_updates_ms = 12000[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m    def _get_progress(self, item_id: str, episode_id: str | None = None) -> _ProgressHelper | None:[0m

[31m--[ [0m[34mMatch #[0m[33m971[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/helpers.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m36 | [0m[35mclass ProgressGuard:[0m
[30;1m37 | [0m[35m    """Class used to avoid ping pong between abs and mass.[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m    We continuously update the progress from mass to abs with the provider's on_played function.[0m
[30;1m40 | [0m[35m    We also register callbacks for progress reports from abs to mass. This is not only triggered[0m
[30;1m41 | [0m[35m    on external updates, but also on our own update. To avoid messages going back and forth, this[0m
[30;1m42 | [0m[35m    class is used.[0m

[31m--[ [0m[34mMatch #[0m[33m972[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/helpers.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m30 | [0m[35mclass _ProgressHelper:[0m
[30;1m31 | [0m[35m    id_: str  # audiobook or podcast id[0m
[30;1m32 | [0m[35m    episode_id: str | None = None[0m
[30;1m33 | [0m[35m    last_update_ms: int  # last update in ms epoch (same as last_update in abs)[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35mclass ProgressGuard:[0m

[31m--[ [0m[34mMatch #[0m[33m973[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m99 | [0m[35m    def guard_ok_mass(self, item_id: str, episode_id: str | None = None) -> bool:[0m
[30;1m100 | [0m[35m        """Check, if we may update against a mass internal item.[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m        Here, we use the current time and compare it against the stored time.[0m
[30;1m103 | [0m[35m        """[0m
[30;1m104 | [0m[35m        stored_progress = self._get_progress(item_id=item_id, episode_id=episode_id)[0m
[30;1m105 | [0m[35m        if stored_progress is None:[0m

[31m--[ [0m[34mMatch #[0m[33m974[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m"""Helpers for Audiobookshelf provider."""[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mfrom dataclasses import dataclass, field[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom aioaudiobookshelf.schema.media_progress import MediaProgress[0m
[30;1m7 | [0m[35mfrom mashumaro.mixins.dict import DataClassDictMixin[0m

[31m--[ [0m[34mMatch #[0m[33m975[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/_template_player_provider/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m175 | [0m[35m        # check if we have an existing player in the player manager[0m
[30;1m176 | [0m[35m        # note that you can use this point to update the player connection info[0m
[30;1m177 | [0m[35m        # if that changed (e.g. ip address)[0m
[30;1m178 | [0m[35m        if mass_player := self.mass.players.get(player_id):[0m
[30;1m179 | [0m[35m            # existing player found in the player manager,[0m
[30;1m180 | [0m[35m            # this is an existing player that has been updated/reconnected[0m
[30;1m181 | [0m[35m            # or simply a re-announcement on mdns.[0m

[31m--[ [0m[34mMatch #[0m[33m976[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/_template_player_provider/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m164 | [0m[35m        # handle removed player[0m
[30;1m165 | [0m[35m        if state_change == ServiceStateChange.Removed:[0m
[30;1m166 | [0m[35m            # check if the player manager has an existing entry for this player[0m
[30;1m167 | [0m[35m            if mass_player := self.mass.players.get(player_id):[0m
[30;1m168 | [0m[35m                # the player has become unavailable[0m
[30;1m169 | [0m[35m                self.logger.debug("Player offline: %s", mass_player.display_name)[0m
[30;1m170 | [0m[35m                mass_player.available = False[0m

[31m--[ [0m[34mMatch #[0m[33m977[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/_template_player_provider/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m388 | [0m[35m        # This method is optional and should be implemented if you specified 'needs_poll'[0m
[30;1m389 | [0m[35m        # on the Player object. This method should poll the player for state changes[0m
[30;1m390 | [0m[35m        # and update the player object in the player manager if needed.[0m
[30;1m391 | [0m[35m        # This method will be called at the interval specified in the poll_interval attribute.[0m

[31m--[ [0m[34mMatch #[0m[33m978[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/_template_player_provider/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m387 | [0m[35m        # OPTIONAL[0m
[30;1m388 | [0m[35m        # This method is optional and should be implemented if you specified 'needs_poll'[0m
[30;1m389 | [0m[35m        # on the Player object. This method should poll the player for state changes[0m
[30;1m390 | [0m[35m        # and update the player object in the player manager if needed.[0m
[30;1m391 | [0m[35m        # This method will be called at the interval specified in the poll_interval attribute.[0m

[31m--[ [0m[34mMatch #[0m[33m979[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/_template_player_provider/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m235 | [0m[35m        # once the player is registered, you can either instruct the player manager to[0m
[30;1m236 | [0m[35m        # poll the player for state changes or you can implement your own logic to[0m
[30;1m237 | [0m[35m        # listen for state changes from the player and update the player object accordingly.[0m
[30;1m238 | [0m[35m        # in any case, you need to call the update method on the player manager:[0m
[30;1m239 | [0m[35m        self.mass.players.update(player_id)[0m
[30;1m240 | [0m[35m[0m
[30;1m241 | [0m[35m    async def get_player_config_entries(self, player_id: str) -> tuple[ConfigEntry, ...]:[0m

[31m--[ [0m[34mMatch #[0m[33m980[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/_template_player_provider/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m234 | [0m[35m[0m
[30;1m235 | [0m[35m        # once the player is registered, you can either instruct the player manager to[0m
[30;1m236 | [0m[35m        # poll the player for state changes or you can implement your own logic to[0m
[30;1m237 | [0m[35m        # listen for state changes from the player and update the player object accordingly.[0m
[30;1m238 | [0m[35m        # in any case, you need to call the update method on the player manager:[0m
[30;1m239 | [0m[35m        self.mass.players.update(player_id)[0m
[30;1m240 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m981[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/_template_player_provider/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m190 | [0m[35m                    ip_address=str(cur_address),[0m
[30;1m191 | [0m[35m                )[0m
[30;1m192 | [0m[35m            if not mass_player.available:[0m
[30;1m193 | [0m[35m                # if the player was marked offline and you now receive an mdns update[0m
[30;1m194 | [0m[35m                # it means the player is back online and we should try to connect to it[0m
[30;1m195 | [0m[35m                self.logger.debug("Player back online: %s", mass_player.display_name)[0m
[30;1m196 | [0m[35m                # you can try to connect to the player here if needed[0m
[30;1m197 | [0m[35m                mass_player.available = True[0m

[31m--[ [0m[34mMatch #[0m[33m982[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/_template_player_provider/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m173 | [0m[35m        # handle update for existing device[0m
[30;1m174 | [0m[35m        # (state change is either updated or added)[0m
[30;1m175 | [0m[35m        # check if we have an existing player in the player manager[0m
[30;1m176 | [0m[35m        # note that you can use this point to update the player connection info[0m
[30;1m177 | [0m[35m        # if that changed (e.g. ip address)[0m
[30;1m178 | [0m[35m        if mass_player := self.mass.players.get(player_id):[0m
[30;1m179 | [0m[35m            # existing player found in the player manager,[0m

[31m--[ [0m[34mMatch #[0m[33m983[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/_template_player_provider/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m170 | [0m[35m                mass_player.available = False[0m
[30;1m171 | [0m[35m                self.mass.players.update(player_id)[0m
[30;1m172 | [0m[35m            return[0m
[30;1m173 | [0m[35m        # handle update for existing device[0m
[30;1m174 | [0m[35m        # (state change is either updated or added)[0m
[30;1m175 | [0m[35m        # check if we have an existing player in the player manager[0m
[30;1m176 | [0m[35m        # note that you can use this point to update the player connection info[0m

[31m--[ [0m[34mMatch #[0m[33m984[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/_template_player_provider/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m153 | [0m[35m        # NOTE: If you do not use mdns for discovery of players on the network,[0m
[30;1m154 | [0m[35m        # you must implement your own discovery mechanism and logic to add new players[0m
[30;1m155 | [0m[35m        # and update them on state changes when needed.[0m
[30;1m156 | [0m[35m        # Below is a bit of example implementation but we advise to look at existing[0m
[30;1m157 | [0m[35m        # player providers for more inspiration.[0m
[30;1m158 | [0m[35m        name = name.split("@", 1)[1] if "@" in name else name[0m
[30;1m159 | [0m[35m        player_id = info.decoded_properties["uuid"]  # this is just an example![0m

[31m--[ [0m[34mMatch #[0m[33m985[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/_template_player_provider/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m        # NOTE: If you do not use mdns for discovery of players on the network,[0m
[30;1m154 | [0m[35m        # you must implement your own discovery mechanism and logic to add new players[0m
[30;1m155 | [0m[35m        # and update them on state changes when needed.[0m
[30;1m156 | [0m[35m        # Below is a bit of example implementation but we advise to look at existing[0m
[30;1m157 | [0m[35m        # player providers for more inspiration.[0m
[30;1m158 | [0m[35m        name = name.split("@", 1)[1] if "@" in name else name[0m

[31m--[ [0m[34mMatch #[0m[33m986[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/_template_player_provider/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m95 | [0m[35m    which in turn is a subclass of the generic Provider model.[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m    The base implementation already takes care of some convenience methods,[0m
[30;1m98 | [0m[35m    such as the mass object and the logger. Take a look at the base class[0m
[30;1m99 | [0m[35m    for more information on what is available.[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m    Just like with any other subclass, make sure that if you override[0m

[31m--[ [0m[34mMatch #[0m[33m987[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/_template_player_provider/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m5 | [0m[35mIts meant to get started developing a new player provider for Music Assistant.[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mUse it as a reference to discover what methods exists and what they should return.[0m
[30;1m8 | [0m[35mAlso it is good to look at existing player providers to get a better understanding,[0m
[30;1m9 | [0m[35mdue to the fact that providers may be flexible and support different features and/or[0m
[30;1m10 | [0m[35mways to discover players on the network.[0m
[30;1m11 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m988[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/_template_player_provider/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m174 | [0m[35m        # (state change is either updated or added)[0m
[30;1m175 | [0m[35m        # check if we have an existing player in the player manager[0m
[30;1m176 | [0m[35m        # note that you can use this point to update the player connection info[0m
[30;1m177 | [0m[35m        # if that changed (e.g. ip address)[0m
[30;1m178 | [0m[35m        if mass_player := self.mass.players.get(player_id):[0m
[30;1m179 | [0m[35m            # existing player found in the player manager,[0m
[30;1m180 | [0m[35m            # this is an existing player that has been updated/reconnected[0m

[31m--[ [0m[34mMatch #[0m[33m989[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/_template_player_provider/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m144 | [0m[35m        # If you specify a mdns service type in the manifest.json, this method will be called[0m
[30;1m145 | [0m[35m        # automatically on mdns changes for the specified service type.[0m
[30;1m146 | [0m[35m[0m
[30;1m147 | [0m[35m        # If no mdns service type is specified, this method is omitted and you[0m
[30;1m148 | [0m[35m        # can completely remove it from your provider implementation.[0m
[30;1m149 | [0m[35m[0m
[30;1m150 | [0m[35m        if not info:[0m

[31m--[ [0m[34mMatch #[0m[33m990[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/_template_player_provider/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m142 | [0m[35m        # MANDATORY IF YOU WANT TO USE MDNS DISCOVERY[0m
[30;1m143 | [0m[35m        # OPTIONAL if you dont use mdns for discovery of players[0m
[30;1m144 | [0m[35m        # If you specify a mdns service type in the manifest.json, this method will be called[0m
[30;1m145 | [0m[35m        # automatically on mdns changes for the specified service type.[0m
[30;1m146 | [0m[35m[0m
[30;1m147 | [0m[35m        # If no mdns service type is specified, this method is omitted and you[0m
[30;1m148 | [0m[35m        # can completely remove it from your provider implementation.[0m

[31m--[ [0m[34mMatch #[0m[33m991[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/_template_player_provider/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m141 | [0m[35m        """Handle MDNS service state callback."""[0m
[30;1m142 | [0m[35m        # MANDATORY IF YOU WANT TO USE MDNS DISCOVERY[0m
[30;1m143 | [0m[35m        # OPTIONAL if you dont use mdns for discovery of players[0m
[30;1m144 | [0m[35m        # If you specify a mdns service type in the manifest.json, this method will be called[0m
[30;1m145 | [0m[35m        # automatically on mdns changes for the specified service type.[0m
[30;1m146 | [0m[35m[0m
[30;1m147 | [0m[35m        # If no mdns service type is specified, this method is omitted and you[0m

[31m--[ [0m[34mMatch #[0m[33m992[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/_template_player_provider/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m138 | [0m[35m    async def on_mdns_service_state_change([0m
[30;1m139 | [0m[35m        self, name: str, state_change: ServiceStateChange, info: AsyncServiceInfo | None[0m
[30;1m140 | [0m[35m    ) -> None:[0m
[30;1m141 | [0m[35m        """Handle MDNS service state callback."""[0m
[30;1m142 | [0m[35m        # MANDATORY IF YOU WANT TO USE MDNS DISCOVERY[0m
[30;1m143 | [0m[35m        # OPTIONAL if you dont use mdns for discovery of players[0m
[30;1m144 | [0m[35m        # If you specify a mdns service type in the manifest.json, this method will be called[0m

[31m--[ [0m[34mMatch #[0m[33m993[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/parsers.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m108 | [0m[35m    """Translate ABSPodcastEpisode to MassPodcastEpisode.[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m    For an episode the id is set to f"{podcast_id} {episode_id}".[0m
[30;1m111 | [0m[35m    ABS ids have no spaces, so we can split at a space to retrieve both[0m
[30;1m112 | [0m[35m    in other functions.[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m    NOTE: We should always use a PodcastEpisodeExpanded when possible.[0m

[31m--[ [0m[34mMatch #[0m[33m994[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/util.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m565 | [0m[35m            final_dict[key] = merge_tuples(final_dict[key], value)[0m
[30;1m566 | [0m[35m        if final_dict.get(key) and isinstance(value, list):[0m
[30;1m567 | [0m[35m            final_dict[key] = merge_lists(final_dict[key], value)[0m
[30;1m568 | [0m[35m        elif not final_dict.get(key) or allow_overwite:[0m
[30;1m569 | [0m[35m            final_dict[key] = value[0m
[30;1m570 | [0m[35m    return final_dict[0m
[30;1m571 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m995[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/util.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m563 | [0m[35m            final_dict[key] = merge_dict(final_dict[key], value)[0m
[30;1m564 | [0m[35m        if final_dict.get(key) and isinstance(value, tuple):[0m
[30;1m565 | [0m[35m            final_dict[key] = merge_tuples(final_dict[key], value)[0m
[30;1m566 | [0m[35m        if final_dict.get(key) and isinstance(value, list):[0m
[30;1m567 | [0m[35m            final_dict[key] = merge_lists(final_dict[key], value)[0m
[30;1m568 | [0m[35m        elif not final_dict.get(key) or allow_overwite:[0m
[30;1m569 | [0m[35m            final_dict[key] = value[0m

[31m--[ [0m[34mMatch #[0m[33m996[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/util.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m561 | [0m[35m    for key, value in new_dict.items():[0m
[30;1m562 | [0m[35m        if final_dict.get(key) and isinstance(value, dict):[0m
[30;1m563 | [0m[35m            final_dict[key] = merge_dict(final_dict[key], value)[0m
[30;1m564 | [0m[35m        if final_dict.get(key) and isinstance(value, tuple):[0m
[30;1m565 | [0m[35m            final_dict[key] = merge_tuples(final_dict[key], value)[0m
[30;1m566 | [0m[35m        if final_dict.get(key) and isinstance(value, list):[0m
[30;1m567 | [0m[35m            final_dict[key] = merge_lists(final_dict[key], value)[0m

[31m--[ [0m[34mMatch #[0m[33m997[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/util.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m559 | [0m[35m    """Merge dict without overwriting existing values."""[0m
[30;1m560 | [0m[35m    final_dict = base_dict.copy()[0m
[30;1m561 | [0m[35m    for key, value in new_dict.items():[0m
[30;1m562 | [0m[35m        if final_dict.get(key) and isinstance(value, dict):[0m
[30;1m563 | [0m[35m            final_dict[key] = merge_dict(final_dict[key], value)[0m
[30;1m564 | [0m[35m        if final_dict.get(key) and isinstance(value, tuple):[0m
[30;1m565 | [0m[35m            final_dict[key] = merge_tuples(final_dict[key], value)[0m

[31m--[ [0m[34mMatch #[0m[33m998[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/util.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m587 | [0m[35m[0m
[30;1m588 | [0m[35mclass TaskManager:[0m
[30;1m589 | [0m[35m    """[0m
[30;1m590 | [0m[35m    Helper class to run many tasks at once.[0m
[30;1m591 | [0m[35m[0m
[30;1m592 | [0m[35m    This is basically an alternative to asyncio.TaskGroup but this will not[0m
[30;1m593 | [0m[35m    cancel all operations when one of the tasks fails.[0m

[31m--[ [0m[34mMatch #[0m[33m999[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/util.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m668 | [0m[35m[0m
[30;1m669 | [0m[35m        Args:[0m
[30;1m670 | [0m[35m            iterable: The async iterable to wrap.[0m
[30;1m671 | [0m[35m            timeout: The timeout in seconds for each iteration.[0m
[30;1m672 | [0m[35m        """[0m
[30;1m673 | [0m[35m[0m
[30;1m674 | [0m[35m        class AsyncTimedIterator:[0m

[31m--[ [0m[34mMatch #[0m[33m1000[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/util.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m527 | [0m[35m[0m
[30;1m528 | [0m[35m[0m
[30;1m529 | [0m[35mdef get_port_from_zeroconf(discovery_info: AsyncServiceInfo) -> str | None:[0m
[30;1m530 | [0m[35m    """Get primary IP address from zeroconf discovery info."""[0m
[30;1m531 | [0m[35m    return discovery_info.port[0m
[30;1m532 | [0m[35m[0m
[30;1m533 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1001[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/util.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m514 | [0m[35m[0m
[30;1m515 | [0m[35m[0m
[30;1m516 | [0m[35mdef get_primary_ip_address_from_zeroconf(discovery_info: AsyncServiceInfo) -> str | None:[0m
[30;1m517 | [0m[35m    """Get primary IP address from zeroconf discovery info."""[0m
[30;1m518 | [0m[35m    for address in discovery_info.parsed_addresses(IPVersion.V4Only):[0m
[30;1m519 | [0m[35m        if address.startswith("127"):[0m
[30;1m520 | [0m[35m            # filter out loopback address[0m

[31m--[ [0m[34mMatch #[0m[33m1002[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/util.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m372 | [0m[35m[0m
[30;1m373 | [0m[35m    if return_code != 0 and "Permission denied" in output.decode():[0m
[30;1m374 | [0m[35m        # try again with regular pip[0m
[30;1m375 | [0m[35m        # uv pip seems to have issues with permissions on docker installs[0m
[30;1m376 | [0m[35m        args = [[0m
[30;1m377 | [0m[35m            "pip",[0m
[30;1m378 | [0m[35m            "install",[0m

[31m--[ [0m[34mMatch #[0m[33m1003[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/util.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m372 | [0m[35m[0m
[30;1m373 | [0m[35m    if return_code != 0 and "Permission denied" in output.decode():[0m
[30;1m374 | [0m[35m        # try again with regular pip[0m
[30;1m375 | [0m[35m        # uv pip seems to have issues with permissions on docker installs[0m
[30;1m376 | [0m[35m        args = [[0m
[30;1m377 | [0m[35m            "pip",[0m
[30;1m378 | [0m[35m            "install",[0m

[31m--[ [0m[34mMatch #[0m[33m1004[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/util.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m371 | [0m[35m    return_code, output = await check_output(*args)[0m
[30;1m372 | [0m[35m[0m
[30;1m373 | [0m[35m    if return_code != 0 and "Permission denied" in output.decode():[0m
[30;1m374 | [0m[35m        # try again with regular pip[0m
[30;1m375 | [0m[35m        # uv pip seems to have issues with permissions on docker installs[0m
[30;1m376 | [0m[35m        args = [[0m
[30;1m377 | [0m[35m            "pip",[0m
[30;1m378 | [0m[35m            "install",[0m

[31m--[ [0m[34mMatch #[0m[33m1005[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/util.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m267 | [0m[35m[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35masync def select_free_port(range_start: int, range_end: int) -> int:[0m
[30;1m270 | [0m[35m    """Automatically find available port within range."""[0m
[30;1m271 | [0m[35m    for port in range(range_start, range_end):[0m
[30;1m272 | [0m[35m        if not await is_port_in_use(port):[0m
[30;1m273 | [0m[35m            return port[0m

[31m--[ [0m[34mMatch #[0m[33m1006[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/util.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m247 | [0m[35m                    score = 0[0m
[30;1m248 | [0m[35m                result.append((score, ip.ip))[0m
[30;1m249 | [0m[35m        result.sort(key=lambda x: x[0], reverse=True)[0m
[30;1m250 | [0m[35m        return tuple(ip[1] for ip in result)[0m
[30;1m251 | [0m[35m[0m
[30;1m252 | [0m[35m    return await asyncio.to_thread(call)[0m
[30;1m253 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1007[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/util.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m241 | [0m[35m                    score = 2[0m
[30;1m242 | [0m[35m                elif ip.ip.startswith("172."):[0m
[30;1m243 | [0m[35m                    # we rank the 172 range a bit lower as its most[0m
[30;1m244 | [0m[35m                    # often used as the private docker network[0m
[30;1m245 | [0m[35m                    score = 1[0m
[30;1m246 | [0m[35m                else:[0m
[30;1m247 | [0m[35m                    score = 0[0m

[31m--[ [0m[34mMatch #[0m[33m1008[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/util.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m228 | [0m[35m        result: list[tuple[int, str]] = [][0m
[30;1m229 | [0m[35m        adapters = ifaddr.get_adapters()[0m
[30;1m230 | [0m[35m        for adapter in adapters:[0m
[30;1m231 | [0m[35m            for ip in adapter.ips:[0m
[30;1m232 | [0m[35m                if ip.is_IPv6 and not include_ipv6:[0m
[30;1m233 | [0m[35m                    continue[0m
[30;1m234 | [0m[35m                if ip.ip.startswith(("127", "169.254")):[0m

[31m--[ [0m[34mMatch #[0m[33m1009[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1308 | [0m[35m                queue_item.streamdetails.audio_format.sample_rate[0m
[30;1m1309 | [0m[35m                != next_item.streamdetails.audio_format.sample_rate[0m
[30;1m1310 | [0m[35m            )[0m
[30;1m1311 | [0m[35m            and (queue_player := self.mass.players.get(queue_item.queue_id))[0m
[30;1m1312 | [0m[35m            and PlayerFeature.GAPLESS_DIFFERENT_SAMPLERATE not in queue_player.supported_features[0m
[30;1m1313 | [0m[35m        ):[0m
[30;1m1314 | [0m[35m            self.logger.debug("Skipping crossfade: sample rate mismatch")[0m

[31m--[ [0m[34mMatch #[0m[33m1010[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1270 | [0m[35m[0m
[30;1m1271 | [0m[35m    def _crossfade_allowed(self, queue_item: QueueItem, flow_mode: bool = False) -> bool:[0m
[30;1m1272 | [0m[35m        """Get the crossfade config for a queue item."""[0m
[30;1m1273 | [0m[35m        if not (queue_player := self.mass.players.get(queue_item.queue_id)):[0m
[30;1m1274 | [0m[35m            return False  # just a guard[0m
[30;1m1275 | [0m[35m        if queue_item.media_type != MediaType.TRACK:[0m
[30;1m1276 | [0m[35m            self.logger.debug("Skipping crossfade: current item is not a track")[0m

[31m--[ [0m[34mMatch #[0m[33m1011[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1056 | [0m[35m        session_id: str | None = None,[0m
[30;1m1057 | [0m[35m    ) -> AsyncGenerator[bytes, None]:[0m
[30;1m1058 | [0m[35m        """Get the audio stream for a single queue item with crossfade to the next item."""[0m
[30;1m1059 | [0m[35m        queue = self.mass.player_queues.get(queue_item.queue_id)[0m
[30;1m1060 | [0m[35m        streamdetails = queue_item.streamdetails[0m
[30;1m1061 | [0m[35m        assert streamdetails[0m
[30;1m1062 | [0m[35m        crossfade_duration = self.mass.config.get_raw_player_config_value([0m

[31m--[ [0m[34mMatch #[0m[33m1012[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m949 | [0m[35m        player_filter_params: list[str] | None = None,[0m
[30;1m950 | [0m[35m    ) -> AsyncGenerator[bytes, None]:[0m
[30;1m951 | [0m[35m        """Get the special plugin source stream."""[0m
[30;1m952 | [0m[35m        player = self.mass.players.get(player_id)[0m
[30;1m953 | [0m[35m        plugin_prov: PluginProvider = self.mass.get_provider(plugin_source_id)[0m
[30;1m954 | [0m[35m        plugin_source = plugin_prov.get_source()[0m
[30;1m955 | [0m[35m        if plugin_source.in_use_by and plugin_source.in_use_by != player_id:[0m

[31m--[ [0m[34mMatch #[0m[33m1013[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m681 | [0m[35m            raise web.HTTPNotFound(reason=f"Unknown PluginSource: {plugin_source_id}")[0m
[30;1m682 | [0m[35m        # work out output format/details[0m
[30;1m683 | [0m[35m        player_id = request.match_info["player_id"][0m
[30;1m684 | [0m[35m        player = self.mass.players.get(player_id)[0m
[30;1m685 | [0m[35m        if not player:[0m
[30;1m686 | [0m[35m            raise web.HTTPNotFound(reason=f"Unknown Player: {player_id}")[0m
[30;1m687 | [0m[35m        plugin_source = provider.get_source()[0m

[31m--[ [0m[34mMatch #[0m[33m1014[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m611 | [0m[35m        use_pre_announce = try_parse_bool(request.query.get("pre_announce"))[0m
[30;1m612 | [0m[35m[0m
[30;1m613 | [0m[35m        # work out output format/details[0m
[30;1m614 | [0m[35m        fmt = request.match_info.get("fmt", announcement_url.rsplit(".")[-1])[0m
[30;1m615 | [0m[35m        audio_format = AudioFormat(content_type=ContentType.try_parse(fmt))[0m
[30;1m616 | [0m[35m[0m
[30;1m617 | [0m[35m        http_profile: str = await self.mass.config.get_player_config_value([0m

[31m--[ [0m[34mMatch #[0m[33m1015[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m608 | [0m[35m        if player_id not in self.announcements:[0m
[30;1m609 | [0m[35m            raise web.HTTPNotFound(reason=f"No pending announcements for Player: {player_id}")[0m
[30;1m610 | [0m[35m        announcement_url = self.announcements[player_id][0m
[30;1m611 | [0m[35m        use_pre_announce = try_parse_bool(request.query.get("pre_announce"))[0m
[30;1m612 | [0m[35m[0m
[30;1m613 | [0m[35m        # work out output format/details[0m
[30;1m614 | [0m[35m        fmt = request.match_info.get("fmt", announcement_url.rsplit(".")[-1])[0m

[31m--[ [0m[34mMatch #[0m[33m1016[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m602 | [0m[35m        """Stream announcement audio to a player."""[0m
[30;1m603 | [0m[35m        self._log_request(request)[0m
[30;1m604 | [0m[35m        player_id = request.match_info["player_id"][0m
[30;1m605 | [0m[35m        player = self.mass.player_queues.get(player_id)[0m
[30;1m606 | [0m[35m        if not player:[0m
[30;1m607 | [0m[35m            raise web.HTTPNotFound(reason=f"Unknown Player: {player_id}")[0m
[30;1m608 | [0m[35m        if player_id not in self.announcements:[0m

[31m--[ [0m[34mMatch #[0m[33m1017[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m507 | [0m[35m            CONF_ENTRY_ENABLE_ICY_METADATA.key,[0m
[30;1m508 | [0m[35m            CONF_ENTRY_ENABLE_ICY_METADATA.default_value,[0m
[30;1m509 | [0m[35m        )[0m
[30;1m510 | [0m[35m        enable_icy = request.headers.get("Icy-MetaData", "") == "1" and icy_preference != "disabled"[0m
[30;1m511 | [0m[35m        icy_meta_interval = 256000 if icy_preference == "full" else 16384[0m
[30;1m512 | [0m[35m[0m
[30;1m513 | [0m[35m        # prepare request, add some DLNA/UPNP compatible headers[0m

[31m--[ [0m[34mMatch #[0m[33m1018[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m484 | [0m[35m        session_id = request.match_info["session_id"][0m
[30;1m485 | [0m[35m        if session_id != queue.session_id:[0m
[30;1m486 | [0m[35m            raise web.HTTPNotFound(reason=f"Unknown (or invalid) session: {session_id}")[0m
[30;1m487 | [0m[35m        if not (queue_player := self.mass.players.get(queue_id)):[0m
[30;1m488 | [0m[35m            raise web.HTTPNotFound(reason=f"Unknown Player: {queue_id}")[0m
[30;1m489 | [0m[35m        start_queue_item_id = request.match_info["queue_item_id"][0m
[30;1m490 | [0m[35m        start_queue_item = self.mass.player_queues.get_item(queue_id, start_queue_item_id)[0m

[31m--[ [0m[34mMatch #[0m[33m1019[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m478 | [0m[35m        """Stream Queue Flow audio to player."""[0m
[30;1m479 | [0m[35m        self._log_request(request)[0m
[30;1m480 | [0m[35m        queue_id = request.match_info["queue_id"][0m
[30;1m481 | [0m[35m        queue = self.mass.player_queues.get(queue_id)[0m
[30;1m482 | [0m[35m        if not queue:[0m
[30;1m483 | [0m[35m            raise web.HTTPNotFound(reason=f"Unknown Queue: {queue_id}")[0m
[30;1m484 | [0m[35m        session_id = request.match_info["session_id"][0m

[31m--[ [0m[34mMatch #[0m[33m1020[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m358 | [0m[35m        session_id = request.match_info["session_id"][0m
[30;1m359 | [0m[35m        if session_id != queue.session_id:[0m
[30;1m360 | [0m[35m            raise web.HTTPNotFound(reason=f"Unknown (or invalid) session: {session_id}")[0m
[30;1m361 | [0m[35m        queue_player = self.mass.players.get(queue_id)[0m
[30;1m362 | [0m[35m        queue_item_id = request.match_info["queue_item_id"][0m
[30;1m363 | [0m[35m        queue_item = self.mass.player_queues.get_item(queue_id, queue_item_id)[0m
[30;1m364 | [0m[35m        if not queue_item:[0m

[31m--[ [0m[34mMatch #[0m[33m1021[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m352 | [0m[35m        """Stream single queueitem audio to a player."""[0m
[30;1m353 | [0m[35m        self._log_request(request)[0m
[30;1m354 | [0m[35m        queue_id = request.match_info["queue_id"][0m
[30;1m355 | [0m[35m        queue = self.mass.player_queues.get(queue_id)[0m
[30;1m356 | [0m[35m        if not queue:[0m
[30;1m357 | [0m[35m            raise web.HTTPNotFound(reason=f"Unknown Queue: {queue_id}")[0m
[30;1m358 | [0m[35m        session_id = request.match_info["session_id"][0m

[31m--[ [0m[34mMatch #[0m[33m1022[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m95 | [0m[35m    )[0m
[30;1m96 | [0m[35m    sample_rate = int(params.get("rate", 44100))[0m
[30;1m97 | [0m[35m    sample_size = int(params.get("bitrate", 16))[0m
[30;1m98 | [0m[35m    channels = int(params.get("channels", 2))[0m
[30;1m99 | [0m[35m    return (sample_rate, sample_size, channels)[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1023[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m94 | [0m[35m        dict(urllib.parse.parse_qsl(content_type.replace(";", "&"))) if ";" in content_type else {}[0m
[30;1m95 | [0m[35m    )[0m
[30;1m96 | [0m[35m    sample_rate = int(params.get("rate", 44100))[0m
[30;1m97 | [0m[35m    sample_size = int(params.get("bitrate", 16))[0m
[30;1m98 | [0m[35m    channels = int(params.get("channels", 2))[0m
[30;1m99 | [0m[35m    return (sample_rate, sample_size, channels)[0m
[30;1m100 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1024[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m93 | [0m[35m    params = ([0m
[30;1m94 | [0m[35m        dict(urllib.parse.parse_qsl(content_type.replace(";", "&"))) if ";" in content_type else {}[0m
[30;1m95 | [0m[35m    )[0m
[30;1m96 | [0m[35m    sample_rate = int(params.get("rate", 44100))[0m
[30;1m97 | [0m[35m    sample_size = int(params.get("bitrate", 16))[0m
[30;1m98 | [0m[35m    channels = int(params.get("channels", 2))[0m
[30;1m99 | [0m[35m    return (sample_rate, sample_size, channels)[0m

[31m--[ [0m[34mMatch #[0m[33m1025[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1149 | [0m[35m        # make sure the buffer gets cleaned up[0m
[30;1m1150 | [0m[35m        del buffer[0m
[30;1m1151 | [0m[35m[0m
[30;1m1152 | [0m[35m        # update duration details based on the actual pcm data we sent[0m
[30;1m1153 | [0m[35m        # this also accounts for crossfade and silence stripping[0m
[30;1m1154 | [0m[35m        seconds_streamed = bytes_written / pcm_sample_size[0m
[30;1m1155 | [0m[35m        streamdetails.seconds_streamed = seconds_streamed[0m

[31m--[ [0m[34mMatch #[0m[33m1026[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1129 | [0m[35m            if crossfade_data.pcm_format == pcm_format:[0m
[30;1m1130 | [0m[35m                yield crossfade_data.fadeout_part[0m
[30;1m1131 | [0m[35m                bytes_written += len(crossfade_data.fadeout_part)[0m
[30;1m1132 | [0m[35m        # always reset fadeout part at this point[0m
[30;1m1133 | [0m[35m        crossfade_data.fadeout_part = b""[0m
[30;1m1134 | [0m[35m        if self._crossfade_allowed(queue_item, flow_mode=False):[0m
[30;1m1135 | [0m[35m            # if crossfade is enabled, save fadeout part to pickup for next track[0m

[31m--[ [0m[34mMatch #[0m[33m1027[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m884 | [0m[35m            # make sure the buffer gets cleaned up[0m
[30;1m885 | [0m[35m            del buffer[0m
[30;1m886 | [0m[35m[0m
[30;1m887 | [0m[35m            # update duration details based on the actual pcm data we sent[0m
[30;1m888 | [0m[35m            # this also accounts for crossfade and silence stripping[0m
[30;1m889 | [0m[35m            seconds_streamed = bytes_written / pcm_sample_size[0m
[30;1m890 | [0m[35m            queue_track.streamdetails.seconds_streamed = seconds_streamed[0m

[31m--[ [0m[34mMatch #[0m[33m1028[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m619 | [0m[35m        )[0m
[30;1m620 | [0m[35m        if http_profile == "forced_content_length":[0m
[30;1m621 | [0m[35m            # given the fact that an announcement is just a short audio clip,[0m
[30;1m622 | [0m[35m            # just send it over completely at once so we have a fixed content length[0m
[30;1m623 | [0m[35m            data = b""[0m
[30;1m624 | [0m[35m            async for chunk in self.get_announcement_stream([0m
[30;1m625 | [0m[35m                announcement_url=announcement_url,[0m

[31m--[ [0m[34mMatch #[0m[33m1029[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m240 | [0m[35m                "Music Assistant can cache audio streams on disk. \n"[0m
[30;1m241 | [0m[35m                "On systems with limited diskspace, this can be disabled, "[0m
[30;1m242 | [0m[35m                "but may result in less smooth playback or slower seeking.\n\n"[0m
[30;1m243 | [0m[35m                "**Always:** Enforce caching of audio streams at all times "[0m
[30;1m244 | [0m[35m                "(as long as there is enough free space).\n"[0m
[30;1m245 | [0m[35m                "**Disabled:** Never cache audio streams.\n"[0m
[30;1m246 | [0m[35m                "**Auto:** Let Music Assistant decide if caching "[0m

[31m--[ [0m[34mMatch #[0m[33m1030[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2 | [0m[35mController to stream audio to players.[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mThe streams controller hosts a basic, unprotected HTTP-only webserver[0m
[30;1m5 | [0m[35mpurely to stream audio packets to players and some control endpoints such as[0m
[30;1m6 | [0m[35mthe upnp callbacks and json rpc api for slimproto clients.[0m
[30;1m7 | [0m[35m"""[0m
[30;1m8 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1031[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m920 | [0m[35m    ) -> AsyncGenerator[bytes, None]:[0m
[30;1m921 | [0m[35m        """Get the special announcement stream."""[0m
[30;1m922 | [0m[35m        # work out output format/details[0m
[30;1m923 | [0m[35m        fmt = announcement_url.rsplit(".")[-1][0m
[30;1m924 | [0m[35m        audio_format = AudioFormat(content_type=ContentType.try_parse(fmt))[0m
[30;1m925 | [0m[35m        extra_args = [][0m
[30;1m926 | [0m[35m        filter_params = ["loudnorm=I=-10:LRA=11:TP=-2"][0m

[31m--[ [0m[34mMatch #[0m[33m1032[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m611 | [0m[35m        use_pre_announce = try_parse_bool(request.query.get("pre_announce"))[0m
[30;1m612 | [0m[35m[0m
[30;1m613 | [0m[35m        # work out output format/details[0m
[30;1m614 | [0m[35m        fmt = request.match_info.get("fmt", announcement_url.rsplit(".")[-1])[0m
[30;1m615 | [0m[35m        audio_format = AudioFormat(content_type=ContentType.try_parse(fmt))[0m
[30;1m616 | [0m[35m[0m
[30;1m617 | [0m[35m        http_profile: str = await self.mass.config.get_player_config_value([0m

[31m--[ [0m[34mMatch #[0m[33m1033[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m345 | [0m[35m        fmt = output_codec.value[0m
[30;1m346 | [0m[35m        # handle raw pcm without exact format specifiers[0m
[30;1m347 | [0m[35m        if output_codec.is_pcm() and ";" not in fmt:[0m
[30;1m348 | [0m[35m            fmt += f";codec=pcm;rate={44100};bitrate={16};channels={2}"[0m
[30;1m349 | [0m[35m        return f"{self._server.base_url}/pluginsource/{plugin_source}/{player_id}.{fmt}"[0m
[30;1m350 | [0m[35m[0m
[30;1m351 | [0m[35m    async def serve_queue_item_stream(self, request: web.Request) -> web.Response:[0m

[31m--[ [0m[34mMatch #[0m[33m1034[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m342 | [0m[35m        output_codec = ContentType.try_parse([0m
[30;1m343 | [0m[35m            await self.mass.config.get_player_config_value(player_id, CONF_OUTPUT_CODEC)[0m
[30;1m344 | [0m[35m        )[0m
[30;1m345 | [0m[35m        fmt = output_codec.value[0m
[30;1m346 | [0m[35m        # handle raw pcm without exact format specifiers[0m
[30;1m347 | [0m[35m        if output_codec.is_pcm() and ";" not in fmt:[0m
[30;1m348 | [0m[35m            fmt += f";codec=pcm;rate={44100};bitrate={16};channels={2}"[0m

[31m--[ [0m[34mMatch #[0m[33m1035[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m329 | [0m[35m        fmt = output_codec.value[0m
[30;1m330 | [0m[35m        # handle raw pcm without exact format specifiers[0m
[30;1m331 | [0m[35m        if output_codec.is_pcm() and ";" not in fmt:[0m
[30;1m332 | [0m[35m            fmt += f";codec=pcm;rate={44100};bitrate={16};channels={2}"[0m
[30;1m333 | [0m[35m        base_path = "flow" if flow_mode else "single"[0m
[30;1m334 | [0m[35m        return f"{self._server.base_url}/{base_path}/{session_id}/{queue_item.queue_id}/{queue_item.[0m
[30;1m335 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1036[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m326 | [0m[35m        except KeyError:[0m
[30;1m327 | [0m[35m            conf_output_codec = "flac"[0m
[30;1m328 | [0m[35m        output_codec = ContentType.try_parse(conf_output_codec)[0m
[30;1m329 | [0m[35m        fmt = output_codec.value[0m
[30;1m330 | [0m[35m        # handle raw pcm without exact format specifiers[0m
[30;1m331 | [0m[35m        if output_codec.is_pcm() and ";" not in fmt:[0m
[30;1m332 | [0m[35m            fmt += f";codec=pcm;rate={44100};bitrate={16};channels={2}"[0m

[31m--[ [0m[34mMatch #[0m[33m1037[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m173 | [0m[35m                label="TCP Port",[0m
[30;1m174 | [0m[35m                description="The TCP port to run the server. "[0m
[30;1m175 | [0m[35m                "Make sure that this server can be reached "[0m
[30;1m176 | [0m[35m                "on the given IP and TCP port by players on the local network.",[0m
[30;1m177 | [0m[35m            ),[0m
[30;1m178 | [0m[35m            ConfigEntry([0m
[30;1m179 | [0m[35m                key=CONF_VOLUME_NORMALIZATION_RADIO,[0m

[31m--[ [0m[34mMatch #[0m[33m1038[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m162 | [0m[35m                default_value=ip_addresses[0],[0m
[30;1m163 | [0m[35m                label="Published IP address",[0m
[30;1m164 | [0m[35m                description="This IP address is communicated to players where to find this server."[0m
[30;1m165 | [0m[35m                "\nMake sure that this IP can be reached by players on the local network, "[0m
[30;1m166 | [0m[35m                "otherwise audio streaming will not work.",[0m
[30;1m167 | [0m[35m                required=False,[0m
[30;1m168 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m1039[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m161 | [0m[35m                type=ConfigEntryType.STRING,[0m
[30;1m162 | [0m[35m                default_value=ip_addresses[0],[0m
[30;1m163 | [0m[35m                label="Published IP address",[0m
[30;1m164 | [0m[35m                description="This IP address is communicated to players where to find this server."[0m
[30;1m165 | [0m[35m                "\nMake sure that this IP can be reached by players on the local network, "[0m
[30;1m166 | [0m[35m                "otherwise audio streaming will not work.",[0m
[30;1m167 | [0m[35m                required=False,[0m

[31m--[ [0m[34mMatch #[0m[33m1040[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m161 | [0m[35m                type=ConfigEntryType.STRING,[0m
[30;1m162 | [0m[35m                default_value=ip_addresses[0],[0m
[30;1m163 | [0m[35m                label="Published IP address",[0m
[30;1m164 | [0m[35m                description="This IP address is communicated to players where to find this server."[0m
[30;1m165 | [0m[35m                "\nMake sure that this IP can be reached by players on the local network, "[0m
[30;1m166 | [0m[35m                "otherwise audio streaming will not work.",[0m
[30;1m167 | [0m[35m                required=False,[0m

[31m--[ [0m[34mMatch #[0m[33m1041[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/streams.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m160 | [0m[35m                key=CONF_PUBLISH_IP,[0m
[30;1m161 | [0m[35m                type=ConfigEntryType.STRING,[0m
[30;1m162 | [0m[35m                default_value=ip_addresses[0],[0m
[30;1m163 | [0m[35m                label="Published IP address",[0m
[30;1m164 | [0m[35m                description="This IP address is communicated to players where to find this server."[0m
[30;1m165 | [0m[35m                "\nMake sure that this IP can be reached by players on the local network, "[0m
[30;1m166 | [0m[35m                "otherwise audio streaming will not work.",[0m

[31m--[ [0m[34mMatch #[0m[33m1042[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1230 | [0m[35m                        mass_podcast,[0m
[30;1m1231 | [0m[35m                        overwrite_existing=True,[0m
[30;1m1232 | [0m[35m                    )[0m
[30;1m1233 | [0m[35m                    lib = self.libraries.podcasts.get(abs_item.library_id, None)[0m
[30;1m1234 | [0m[35m                    if lib is not None:[0m
[30;1m1235 | [0m[35m                        lib.item_ids.add(abs_item.id_)[0m
[30;1m1236 | [0m[35m        await self._cache_set_helper_libraries()[0m

[31m--[ [0m[34mMatch #[0m[33m1043[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1207 | [0m[35m                    ),[0m
[30;1m1208 | [0m[35m                    overwrite_existing=True,[0m
[30;1m1209 | [0m[35m                )[0m
[30;1m1210 | [0m[35m                lib = self.libraries.audiobooks.get(abs_item.library_id, None)[0m
[30;1m1211 | [0m[35m                if lib is not None:[0m
[30;1m1212 | [0m[35m                    lib.item_ids.add(abs_item.id_)[0m
[30;1m1213 | [0m[35m            elif isinstance(abs_item, LibraryItemExpandedPodcast):[0m

[31m--[ [0m[34mMatch #[0m[33m1044[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m783 | [0m[35m[0m
[30;1m784 | [0m[35m            # add collected items[0m
[30;1m785 | [0m[35m            assert isinstance(shelf.id_, AbsShelfId)[0m
[30;1m786 | [0m[35m            items_collected = items_by_shelf_id.get(shelf.id_, [])[0m
[30;1m787 | [0m[35m            items_collected.append(items)[0m
[30;1m788 | [0m[35m            items_by_shelf_id[shelf.id_] = items_collected[0m
[30;1m789 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1045[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m618 | [0m[35m                RecommendationFolder([0m
[30;1m619 | [0m[35m                    item_id=f"{shelf_id}",[0m
[30;1m620 | [0m[35m                    name=name,[0m
[30;1m621 | [0m[35m                    icon=ABS_SHELF_ID_ICONS.get(shelf_id),[0m
[30;1m622 | [0m[35m                    # translation_key=shelf.id_,[0m
[30;1m623 | [0m[35m                    items=UniqueList(recommendation_items),[0m
[30;1m624 | [0m[35m                    provider=self.lookup_key,[0m

[31m--[ [0m[34mMatch #[0m[33m1046[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m365 | [0m[35m            if x.episode_id is not None and x.library_item_id == prov_podcast_id[0m
[30;1m366 | [0m[35m        }[0m
[30;1m367 | [0m[35m        for abs_episode in abs_podcast.media.episodes:[0m
[30;1m368 | [0m[35m            progress = abs_progresses.get(abs_episode.id_, None)[0m
[30;1m369 | [0m[35m            mass_episode = parse_podcast_episode([0m
[30;1m370 | [0m[35m                episode=abs_episode,[0m
[30;1m371 | [0m[35m                prov_podcast_id=prov_podcast_id,[0m

[31m--[ [0m[34mMatch #[0m[33m1047[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m        self.cache_base_key = self.instance_id[0m
[30;1m219 | [0m[35m[0m
[30;1m220 | [0m[35m        cached_libraries = await self.mass.cache.get([0m
[30;1m221 | [0m[35m            key=CACHE_KEY_LIBRARIES,[0m
[30;1m222 | [0m[35m            base_key=self.cache_base_key,[0m
[30;1m223 | [0m[35m            category=CACHE_CATEGORY_LIBRARIES,[0m

[31m--[ [0m[34mMatch #[0m[33m1048[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1320 | [0m[35m            # Guard. Also makes sure, that we don't write to db again if no state change happened.[0m
[30;1m1321 | [0m[35m            # This is achieved by adding a Helper Progress in the update playlog functions, which[0m
[30;1m1322 | [0m[35m            # then has the most recent timestamp. If a subsequent progress sent by abs has an older[0m
[30;1m1323 | [0m[35m            # timestamp, we do not update again.[0m
[30;1m1324 | [0m[35m            if not self.progress_guard.guard_ok_abs(progress):[0m
[30;1m1325 | [0m[35m                continue[0m
[30;1m1326 | [0m[35m            if progress.current_time is not None and not progress.current_time >= 30:[0m

[31m--[ [0m[34mMatch #[0m[33m1049[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1318 | [0m[35m[0m
[30;1m1319 | [0m[35m        for progress in progresses:[0m
[30;1m1320 | [0m[35m            # Guard. Also makes sure, that we don't write to db again if no state change happened.[0m
[30;1m1321 | [0m[35m            # This is achieved by adding a Helper Progress in the update playlog functions, which[0m
[30;1m1322 | [0m[35m            # then has the most recent timestamp. If a subsequent progress sent by abs has an older[0m
[30;1m1323 | [0m[35m            # timestamp, we do not update again.[0m
[30;1m1324 | [0m[35m            if not self.progress_guard.guard_ok_abs(progress):[0m

[31m--[ [0m[34mMatch #[0m[33m1050[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1304 | [0m[35m        User holds also all media progresses specific to that user.[0m
[30;1m1305 | [0m[35m[0m
[30;1m1306 | [0m[35m        The function 'guard_ok_abs' uses the timestamp of the last update in abs, thus after an[0m
[30;1m1307 | [0m[35m        initial progress update, an unchanged update will not trigger a (useless) playlog update.[0m
[30;1m1308 | [0m[35m[0m
[30;1m1309 | [0m[35m        We do not sync removed progresses for the sake of simplicity.[0m
[30;1m1310 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1051[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1303 | [0m[35m[0m
[30;1m1304 | [0m[35m        User holds also all media progresses specific to that user.[0m
[30;1m1305 | [0m[35m[0m
[30;1m1306 | [0m[35m        The function 'guard_ok_abs' uses the timestamp of the last update in abs, thus after an[0m
[30;1m1307 | [0m[35m        initial progress update, an unchanged update will not trigger a (useless) playlog update.[0m
[30;1m1308 | [0m[35m[0m
[30;1m1309 | [0m[35m        We do not sync removed progresses for the sake of simplicity.[0m

[31m--[ [0m[34mMatch #[0m[33m1052[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1266 | [0m[35m    async def _socket_abs_user_item_progress_updated([0m
[30;1m1267 | [0m[35m        self, id_: str, progress: MediaProgress[0m
[30;1m1268 | [0m[35m    ) -> None:[0m
[30;1m1269 | [0m[35m        """To update continue listening.[0m
[30;1m1270 | [0m[35m[0m
[30;1m1271 | [0m[35m        ABS reports every 15s and immediately on play state change.[0m
[30;1m1272 | [0m[35m        This callback is called per item if a progress is changed:[0m

[31m--[ [0m[34mMatch #[0m[33m1053[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m643 | [0m[35m                browse_names.append("Podcasts")[0m
[30;1m644 | [0m[35m            browse_name = " & ".join(browse_names)[0m
[30;1m645 | [0m[35m[0m
[30;1m646 | [0m[35m            # audiobooklibs are first, and we have at max 1 audiobook lib[0m
[30;1m647 | [0m[35m            _browse_root = self._browse_root(append_mediatype_suffix=False)[0m
[30;1m648 | [0m[35m            if len(self.libraries.audiobooks) == 0:[0m
[30;1m649 | [0m[35m                browse_items.extend(_browse_root)[0m

[31m--[ [0m[34mMatch #[0m[33m1054[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m291 | [0m[35m        await super().sync_library(media_type=media_type)[0m
[30;1m292 | [0m[35m        await self._cache_set_helper_libraries()[0m
[30;1m293 | [0m[35m[0m
[30;1m294 | [0m[35m        # update playlog[0m
[30;1m295 | [0m[35m        user = await self._client.get_my_user()[0m
[30;1m296 | [0m[35m        await self._set_playlog_from_user(user)[0m
[30;1m297 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1055[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m255 | [0m[35m        # progress guard[0m
[30;1m256 | [0m[35m        self.progress_guard = ProgressGuard()[0m
[30;1m257 | [0m[35m[0m
[30;1m258 | [0m[35m        # update playlog information if just started[0m
[30;1m259 | [0m[35m        user = await self._client.get_my_user()[0m
[30;1m260 | [0m[35m        await self._set_playlog_from_user(user)[0m
[30;1m261 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1056[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audiobookshelf/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m213 | [0m[35m                )[0m
[30;1m214 | [0m[35m            await self._client_socket.init_client()[0m
[30;1m215 | [0m[35m        except AbsLoginError as exc:[0m
[30;1m216 | [0m[35m            raise LoginFailed(f"Login to abs instance at {base_url} failed.") from exc[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m        self.cache_base_key = self.instance_id[0m
[30;1m219 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1057[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify_connect/events.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m83 | [0m[35m        json_dict["episode_metadata_fields"] = episode_metadata_fields[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35mURL = os.environ["MASS_CALLBACK"][0m
[30;1m86 | [0m[35mreq = urllib.request.Request(URL)  # noqa: S310[0m
[30;1m87 | [0m[35mreq.add_header("Content-Type", "application/json; charset=utf-8")[0m
[30;1m88 | [0m[35mjsondata = json.dumps(json_dict)[0m
[30;1m89 | [0m[35mjsondataasbytes = jsondata.encode("utf-8")[0m

[31m--[ [0m[34mMatch #[0m[33m1058[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m372 | [0m[35m[0m
[30;1m373 | [0m[35m    def get(self, key: str, default: Any = None) -> Any:[0m
[30;1m374 | [0m[35m        """Return item or default."""[0m
[30;1m375 | [0m[35m        return self.d.get(key, default)[0m
[30;1m376 | [0m[35m[0m
[30;1m377 | [0m[35m    def pop(self, key: str, default: Any = None) -> Any:[0m
[30;1m378 | [0m[35m        """Pop item from collection."""[0m

[31m--[ [0m[34mMatch #[0m[33m1059[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m333 | [0m[35m                cache_sub_key_parts.append(f"{key}{kwargs[key]}")[0m
[30;1m334 | [0m[35m            cache_sub_key = ".".join(cache_sub_key_parts)[0m
[30;1m335 | [0m[35m[0m
[30;1m336 | [0m[35m            cachedata = await method_class.cache.get([0m
[30;1m337 | [0m[35m                cache_sub_key, checksum=cache_checksum, category=category, base_key=cache_base_key[0m
[30;1m338 | [0m[35m            )[0m
[30;1m339 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1060[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m        # try memory cache first[0m
[30;1m104 | [0m[35m        memory_key = f"{category}/{base_key}/{key}"[0m
[30;1m105 | [0m[35m        cache_data = self._mem_cache.get(memory_key)[0m
[30;1m106 | [0m[35m        if cache_data and (not checksum or cache_data[1] == checksum) and cache_data[2] >= cur_time:[0m
[30;1m107 | [0m[35m            return cache_data[0][0m
[30;1m108 | [0m[35m        # fall back to db cache[0m

[31m--[ [0m[34mMatch #[0m[33m1061[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/cache.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m245 | [0m[35m            {"key": "version", "value": str(DB_SCHEMA_VERSION), "type": "str"},[0m
[30;1m246 | [0m[35m        )[0m
[30;1m247 | [0m[35m        await self.__create_database_indexes()[0m
[30;1m248 | [0m[35m        # compact db (vacuum) at startup[0m
[30;1m249 | [0m[35m        self.logger.debug("Compacting database...")[0m
[30;1m250 | [0m[35m        try:[0m
[30;1m251 | [0m[35m            await self.database.vacuum()[0m

[31m--[ [0m[34mMatch #[0m[33m1062[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/cache.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35mimport functools[0m
[30;1m7 | [0m[35mimport logging[0m
[30;1m8 | [0m[35mimport os[0m
[30;1m9 | [0m[35mimport time[0m
[30;1m10 | [0m[35mfrom collections import OrderedDict[0m
[30;1m11 | [0m[35mfrom collections.abc import Callable, Iterator, MutableMapping[0m
[30;1m12 | [0m[35mfrom typing import TYPE_CHECKING, Any, ParamSpec, TypeVar[0m
[30;1m13 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1063[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/const.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m33 | [0m[35m)[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35mBROKEN_RAOP_MODELS = ([0m
[30;1m36 | [0m[35m    # A recent fw update of newer gen Sonos speakers block RAOP (airplay 1) support,[0m
[30;1m37 | [0m[35m    # basically rendering our airplay implementation useless on these devices.[0m
[30;1m38 | [0m[35m    # This list contains the models that are known to have this issue.[0m
[30;1m39 | [0m[35m    # Hopefully the issue won't spread to other models.[0m

[31m--[ [0m[34mMatch #[0m[33m1064[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1004 | [0m[35m        url = f"https://api.spotify.com/v1/{endpoint}"[0m
[30;1m1005 | [0m[35m        auth_info = kwargs.pop("auth_info", await self.login())[0m
[30;1m1006 | [0m[35m        headers = {"Authorization": f"Bearer {auth_info['access_token']}"}[0m
[30;1m1007 | [0m[35m        async with self.mass.http_session.post([0m
[30;1m1008 | [0m[35m            url, headers=headers, params=kwargs, json=data, ssl=False[0m
[30;1m1009 | [0m[35m        ) as response:[0m
[30;1m1010 | [0m[35m            # handle spotify rate limiter[0m

[31m--[ [0m[34mMatch #[0m[33m1065[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m921 | [0m[35m        language = locale.split("-")[0][0m
[30;1m922 | [0m[35m        headers["Accept-Language"] = f"{locale}, {language};q=0.9, *;q=0.5"[0m
[30;1m923 | [0m[35m        async with ([0m
[30;1m924 | [0m[35m            self.mass.http_session.get([0m
[30;1m925 | [0m[35m                url, headers=headers, params=kwargs, ssl=True, timeout=120[0m
[30;1m926 | [0m[35m            ) as response,[0m
[30;1m927 | [0m[35m        ):[0m

[31m--[ [0m[34mMatch #[0m[33m1066[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m832 | [0m[35m            "client_id": client_id,[0m
[30;1m833 | [0m[35m        }[0m
[30;1m834 | [0m[35m        for _ in range(2):[0m
[30;1m835 | [0m[35m            async with self.mass.http_session.post([0m
[30;1m836 | [0m[35m                "https://accounts.spotify.com/api/token", data=params[0m
[30;1m837 | [0m[35m            ) as response:[0m
[30;1m838 | [0m[35m                if response.status != 200:[0m

[31m--[ [0m[34mMatch #[0m[33m1067[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m797 | [0m[35m            },[0m
[30;1m798 | [0m[35m            is_editable=is_editable,[0m
[30;1m799 | [0m[35m        )[0m
[30;1m800 | [0m[35m        if playlist_obj.get("images"):[0m
[30;1m801 | [0m[35m            playlist.metadata.images = [[0m
[30;1m802 | [0m[35m                MediaItemImage([0m
[30;1m803 | [0m[35m                    type=ImageType.THUMB,[0m

[31m--[ [0m[34mMatch #[0m[33m1068[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m773 | [0m[35m            track.metadata.copyright = track_obj["copyright"][0m
[30;1m774 | [0m[35m        if track_obj.get("explicit"):[0m
[30;1m775 | [0m[35m            track.metadata.explicit = True[0m
[30;1m776 | [0m[35m        if track_obj.get("popularity"):[0m
[30;1m777 | [0m[35m            track.metadata.popularity = track_obj["popularity"][0m
[30;1m778 | [0m[35m        return track[0m
[30;1m779 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1069[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m771 | [0m[35m                ][0m
[30;1m772 | [0m[35m        if track_obj.get("copyright"):[0m
[30;1m773 | [0m[35m            track.metadata.copyright = track_obj["copyright"][0m
[30;1m774 | [0m[35m        if track_obj.get("explicit"):[0m
[30;1m775 | [0m[35m            track.metadata.explicit = True[0m
[30;1m776 | [0m[35m        if track_obj.get("popularity"):[0m
[30;1m777 | [0m[35m            track.metadata.popularity = track_obj["popularity"][0m

[31m--[ [0m[34mMatch #[0m[33m1070[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m769 | [0m[35m                        remotely_accessible=True,[0m
[30;1m770 | [0m[35m                    )[0m
[30;1m771 | [0m[35m                ][0m
[30;1m772 | [0m[35m        if track_obj.get("copyright"):[0m
[30;1m773 | [0m[35m            track.metadata.copyright = track_obj["copyright"][0m
[30;1m774 | [0m[35m        if track_obj.get("explicit"):[0m
[30;1m775 | [0m[35m            track.metadata.explicit = True[0m

[31m--[ [0m[34mMatch #[0m[33m1071[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m760 | [0m[35m            track.metadata.preview = track_obj["preview_url"][0m
[30;1m761 | [0m[35m        if "album" in track_obj:[0m
[30;1m762 | [0m[35m            track.album = self._parse_album(track_obj["album"])[0m
[30;1m763 | [0m[35m            if track_obj["album"].get("images"):[0m
[30;1m764 | [0m[35m                track.metadata.images = [[0m
[30;1m765 | [0m[35m                    MediaItemImage([0m
[30;1m766 | [0m[35m                        type=ImageType.THUMB,[0m

[31m--[ [0m[34mMatch #[0m[33m1072[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m749 | [0m[35m        if artist:[0m
[30;1m750 | [0m[35m            track.artists.append(artist)[0m
[30;1m751 | [0m[35m        for track_artist in track_obj.get("artists", []):[0m
[30;1m752 | [0m[35m            if not track_artist.get("name") or not track_artist.get("id"):[0m
[30;1m753 | [0m[35m                continue[0m
[30;1m754 | [0m[35m            artist = self._parse_artist(track_artist)[0m
[30;1m755 | [0m[35m            if artist and artist.item_id not in {x.item_id for x in track.artists}:[0m

[31m--[ [0m[34mMatch #[0m[33m1073[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m749 | [0m[35m        if artist:[0m
[30;1m750 | [0m[35m            track.artists.append(artist)[0m
[30;1m751 | [0m[35m        for track_artist in track_obj.get("artists", []):[0m
[30;1m752 | [0m[35m            if not track_artist.get("name") or not track_artist.get("id"):[0m
[30;1m753 | [0m[35m                continue[0m
[30;1m754 | [0m[35m            artist = self._parse_artist(track_artist)[0m
[30;1m755 | [0m[35m            if artist and artist.item_id not in {x.item_id for x in track.artists}:[0m

[31m--[ [0m[34mMatch #[0m[33m1074[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m748 | [0m[35m[0m
[30;1m749 | [0m[35m        if artist:[0m
[30;1m750 | [0m[35m            track.artists.append(artist)[0m
[30;1m751 | [0m[35m        for track_artist in track_obj.get("artists", []):[0m
[30;1m752 | [0m[35m            if not track_artist.get("name") or not track_artist.get("id"):[0m
[30;1m753 | [0m[35m                continue[0m
[30;1m754 | [0m[35m            artist = self._parse_artist(track_artist)[0m

[31m--[ [0m[34mMatch #[0m[33m1075[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m743 | [0m[35m            disc_number=track_obj.get("disc_number", 0),[0m
[30;1m744 | [0m[35m            track_number=track_obj.get("track_number", 0),[0m
[30;1m745 | [0m[35m        )[0m
[30;1m746 | [0m[35m        if isrc := track_obj.get("external_ids", {}).get("isrc"):[0m
[30;1m747 | [0m[35m            track.external_ids.add((ExternalID.ISRC, isrc))[0m
[30;1m748 | [0m[35m[0m
[30;1m749 | [0m[35m        if artist:[0m

[31m--[ [0m[34mMatch #[0m[33m1076[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m743 | [0m[35m            disc_number=track_obj.get("disc_number", 0),[0m
[30;1m744 | [0m[35m            track_number=track_obj.get("track_number", 0),[0m
[30;1m745 | [0m[35m        )[0m
[30;1m746 | [0m[35m        if isrc := track_obj.get("external_ids", {}).get("isrc"):[0m
[30;1m747 | [0m[35m            track.external_ids.add((ExternalID.ISRC, isrc))[0m
[30;1m748 | [0m[35m[0m
[30;1m749 | [0m[35m        if artist:[0m

[31m--[ [0m[34mMatch #[0m[33m1077[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m741 | [0m[35m                )[0m
[30;1m742 | [0m[35m            },[0m
[30;1m743 | [0m[35m            disc_number=track_obj.get("disc_number", 0),[0m
[30;1m744 | [0m[35m            track_number=track_obj.get("track_number", 0),[0m
[30;1m745 | [0m[35m        )[0m
[30;1m746 | [0m[35m        if isrc := track_obj.get("external_ids", {}).get("isrc"):[0m
[30;1m747 | [0m[35m            track.external_ids.add((ExternalID.ISRC, isrc))[0m

[31m--[ [0m[34mMatch #[0m[33m1078[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m740 | [0m[35m                    available=not track_obj["is_local"] and track_obj["is_playable"],[0m
[30;1m741 | [0m[35m                )[0m
[30;1m742 | [0m[35m            },[0m
[30;1m743 | [0m[35m            disc_number=track_obj.get("disc_number", 0),[0m
[30;1m744 | [0m[35m            track_number=track_obj.get("track_number", 0),[0m
[30;1m745 | [0m[35m        )[0m
[30;1m746 | [0m[35m        if isrc := track_obj.get("external_ids", {}).get("isrc"):[0m

[31m--[ [0m[34mMatch #[0m[33m1079[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m710 | [0m[35m            album.year = int(album_obj["release_date"].split("-")[0])[0m
[30;1m711 | [0m[35m        if album_obj.get("copyrights"):[0m
[30;1m712 | [0m[35m            album.metadata.copyright = album_obj["copyrights"][0]["text"][0m
[30;1m713 | [0m[35m        if album_obj.get("explicit"):[0m
[30;1m714 | [0m[35m            album.metadata.explicit = album_obj["explicit"][0m
[30;1m715 | [0m[35m        return album[0m
[30;1m716 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1080[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m708 | [0m[35m            album.metadata.label = album_obj["label"][0m
[30;1m709 | [0m[35m        if album_obj.get("release_date"):[0m
[30;1m710 | [0m[35m            album.year = int(album_obj["release_date"].split("-")[0])[0m
[30;1m711 | [0m[35m        if album_obj.get("copyrights"):[0m
[30;1m712 | [0m[35m            album.metadata.copyright = album_obj["copyrights"][0]["text"][0m
[30;1m713 | [0m[35m        if album_obj.get("explicit"):[0m
[30;1m714 | [0m[35m            album.metadata.explicit = album_obj["explicit"][0m

[31m--[ [0m[34mMatch #[0m[33m1081[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m706 | [0m[35m            ][0m
[30;1m707 | [0m[35m        if "label" in album_obj:[0m
[30;1m708 | [0m[35m            album.metadata.label = album_obj["label"][0m
[30;1m709 | [0m[35m        if album_obj.get("release_date"):[0m
[30;1m710 | [0m[35m            album.year = int(album_obj["release_date"].split("-")[0])[0m
[30;1m711 | [0m[35m        if album_obj.get("copyrights"):[0m
[30;1m712 | [0m[35m            album.metadata.copyright = album_obj["copyrights"][0]["text"][0m

[31m--[ [0m[34mMatch #[0m[33m1082[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m695 | [0m[35m[0m
[30;1m696 | [0m[35m        if "genres" in album_obj:[0m
[30;1m697 | [0m[35m            album.metadata.genre = set(album_obj["genres"])[0m
[30;1m698 | [0m[35m        if album_obj.get("images"):[0m
[30;1m699 | [0m[35m            album.metadata.images = [[0m
[30;1m700 | [0m[35m                MediaItemImage([0m
[30;1m701 | [0m[35m                    type=ImageType.THUMB,[0m

[31m--[ [0m[34mMatch #[0m[33m1083[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m686 | [0m[35m            album.external_ids.add((ExternalID.BARCODE, album_obj["external_ids"]["ean"]))[0m
[30;1m687 | [0m[35m[0m
[30;1m688 | [0m[35m        for artist_obj in album_obj["artists"]:[0m
[30;1m689 | [0m[35m            if not artist_obj.get("name") or not artist_obj.get("id"):[0m
[30;1m690 | [0m[35m                continue[0m
[30;1m691 | [0m[35m            album.artists.append(self._parse_artist(artist_obj))[0m
[30;1m692 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1084[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m686 | [0m[35m            album.external_ids.add((ExternalID.BARCODE, album_obj["external_ids"]["ean"]))[0m
[30;1m687 | [0m[35m[0m
[30;1m688 | [0m[35m        for artist_obj in album_obj["artists"]:[0m
[30;1m689 | [0m[35m            if not artist_obj.get("name") or not artist_obj.get("id"):[0m
[30;1m690 | [0m[35m                continue[0m
[30;1m691 | [0m[35m            album.artists.append(self._parse_artist(artist_obj))[0m
[30;1m692 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1085[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m682 | [0m[35m        )[0m
[30;1m683 | [0m[35m        if "external_ids" in album_obj and album_obj["external_ids"].get("upc"):[0m
[30;1m684 | [0m[35m            album.external_ids.add((ExternalID.BARCODE, "0" + album_obj["external_ids"]["upc"]))[0m
[30;1m685 | [0m[35m        if "external_ids" in album_obj and album_obj["external_ids"].get("ean"):[0m
[30;1m686 | [0m[35m            album.external_ids.add((ExternalID.BARCODE, album_obj["external_ids"]["ean"]))[0m
[30;1m687 | [0m[35m[0m
[30;1m688 | [0m[35m        for artist_obj in album_obj["artists"]:[0m

[31m--[ [0m[34mMatch #[0m[33m1086[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m680 | [0m[35m                )[0m
[30;1m681 | [0m[35m            },[0m
[30;1m682 | [0m[35m        )[0m
[30;1m683 | [0m[35m        if "external_ids" in album_obj and album_obj["external_ids"].get("upc"):[0m
[30;1m684 | [0m[35m            album.external_ids.add((ExternalID.BARCODE, "0" + album_obj["external_ids"]["upc"]))[0m
[30;1m685 | [0m[35m        if "external_ids" in album_obj and album_obj["external_ids"].get("ean"):[0m
[30;1m686 | [0m[35m            album.external_ids.add((ExternalID.BARCODE, album_obj["external_ids"]["ean"]))[0m

[31m--[ [0m[34mMatch #[0m[33m1087[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m647 | [0m[35m        )[0m
[30;1m648 | [0m[35m        if "genres" in artist_obj:[0m
[30;1m649 | [0m[35m            artist.metadata.genres = set(artist_obj["genres"])[0m
[30;1m650 | [0m[35m        if artist_obj.get("images"):[0m
[30;1m651 | [0m[35m            for img in artist_obj["images"]:[0m
[30;1m652 | [0m[35m                img_url = img["url"][0m
[30;1m653 | [0m[35m                if "2a96cbd8b46e442fc41c2b86b821562f" not in img_url:[0m

[31m--[ [0m[34mMatch #[0m[33m1088[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m213 | [0m[35m            "will not work with a custom client ID. \n\n"[0m
[30;1m214 | [0m[35m            f"Use {CALLBACK_REDIRECT_URL} as callback URL.",[0m
[30;1m215 | [0m[35m            required=False,[0m
[30;1m216 | [0m[35m            value=values.get(CONF_CLIENT_ID) if values else None,[0m
[30;1m217 | [0m[35m            hidden=not auth_required,[0m
[30;1m218 | [0m[35m        ),[0m
[30;1m219 | [0m[35m        ConfigEntry([0m

[31m--[ [0m[34mMatch #[0m[33m1089[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m200 | [0m[35m            label=CONF_REFRESH_TOKEN,[0m
[30;1m201 | [0m[35m            hidden=True,[0m
[30;1m202 | [0m[35m            required=True,[0m
[30;1m203 | [0m[35m            value=values.get(CONF_REFRESH_TOKEN) if values else None,[0m
[30;1m204 | [0m[35m        ),[0m
[30;1m205 | [0m[35m        ConfigEntry([0m
[30;1m206 | [0m[35m            key=CONF_CLIENT_ID,[0m

[31m--[ [0m[34mMatch #[0m[33m1090[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m173 | [0m[35m        assert values[0m
[30;1m174 | [0m[35m        values[CONF_REFRESH_TOKEN] = None[0m
[30;1m175 | [0m[35m[0m
[30;1m176 | [0m[35m    auth_required = values.get(CONF_REFRESH_TOKEN) in (None, "")[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35m    if auth_required:[0m
[30;1m179 | [0m[35m        values[CONF_CLIENT_ID] = None[0m

[31m--[ [0m[34mMatch #[0m[33m1091[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m162 | [0m[35m            "client_id": values.get(CONF_CLIENT_ID) or app_var(2),[0m
[30;1m163 | [0m[35m            "code_verifier": code_verifier,[0m
[30;1m164 | [0m[35m        }[0m
[30;1m165 | [0m[35m        async with mass.http_session.post([0m
[30;1m166 | [0m[35m            "https://accounts.spotify.com/api/token", data=params[0m
[30;1m167 | [0m[35m        ) as response:[0m
[30;1m168 | [0m[35m            result = await response.json()[0m

[31m--[ [0m[34mMatch #[0m[33m1092[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m159 | [0m[35m            "grant_type": "authorization_code",[0m
[30;1m160 | [0m[35m            "code": authorization_code,[0m
[30;1m161 | [0m[35m            "redirect_uri": CALLBACK_REDIRECT_URL,[0m
[30;1m162 | [0m[35m            "client_id": values.get(CONF_CLIENT_ID) or app_var(2),[0m
[30;1m163 | [0m[35m            "code_verifier": code_verifier,[0m
[30;1m164 | [0m[35m        }[0m
[30;1m165 | [0m[35m        async with mass.http_session.post([0m

[31m--[ [0m[34mMatch #[0m[33m1093[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m143 | [0m[35m        async with AuthenticationHelper(mass, cast("str", values["session_id"])) as auth_helper:[0m
[30;1m144 | [0m[35m            params = {[0m
[30;1m145 | [0m[35m                "response_type": "code",[0m
[30;1m146 | [0m[35m                "client_id": values.get(CONF_CLIENT_ID) or app_var(2),[0m
[30;1m147 | [0m[35m                "scope": " ".join(SCOPE),[0m
[30;1m148 | [0m[35m                "code_challenge_method": "S256",[0m
[30;1m149 | [0m[35m                "code_challenge": code_challenge,[0m

[31m--[ [0m[34mMatch #[0m[33m1094[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m208 | [0m[35m            label="Client ID (optional)",[0m
[30;1m209 | [0m[35m            description="By default, a generic client ID is used which is (heavy) rate limited. "[0m
[30;1m210 | [0m[35m            "To speedup performance, it is advised that you create your own Spotify Developer "[0m
[30;1m211 | [0m[35m            "account and use that client ID here, but this comes at the cost of some features "[0m
[30;1m212 | [0m[35m            "due to Spotify policies. For example Radio mode/recommendations and featured playlists"[0m
[30;1m213 | [0m[35m            "will not work with a custom client ID. \n\n"[0m
[30;1m214 | [0m[35m            f"Use {CALLBACK_REDIRECT_URL} as callback URL.",[0m

[31m--[ [0m[34mMatch #[0m[33m1095[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m608 | [0m[35m                await librespot_proc.start()[0m
[30;1m609 | [0m[35m[0m
[30;1m610 | [0m[35m                # get first chunk with timeout, to catch the issue where librespot is not starting[0m
[30;1m611 | [0m[35m                # which seems to happen from time to time (but rarely)[0m
[30;1m612 | [0m[35m                try:[0m
[30;1m613 | [0m[35m                    chunk = await asyncio.wait_for(librespot_proc.read(64000), timeout=5)[0m
[30;1m614 | [0m[35m                    yield chunk[0m

[31m--[ [0m[34mMatch #[0m[33m1096[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m608 | [0m[35m                await librespot_proc.start()[0m
[30;1m609 | [0m[35m[0m
[30;1m610 | [0m[35m                # get first chunk with timeout, to catch the issue where librespot is not starting[0m
[30;1m611 | [0m[35m                # which seems to happen from time to time (but rarely)[0m
[30;1m612 | [0m[35m                try:[0m
[30;1m613 | [0m[35m                    chunk = await asyncio.wait_for(librespot_proc.read(64000), timeout=5)[0m
[30;1m614 | [0m[35m                    yield chunk[0m

[31m--[ [0m[34mMatch #[0m[33m1097[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35mimport asyncio[0m
[30;1m6 | [0m[35mimport contextlib[0m
[30;1m7 | [0m[35mimport os[0m
[30;1m8 | [0m[35mimport time[0m
[30;1m9 | [0m[35mfrom typing import TYPE_CHECKING, Any, cast[0m
[30;1m10 | [0m[35mfrom urllib.parse import urlencode[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mfrom music_assistant_models.config_entries import ConfigEntry, ConfigValueType[0m

[31m--[ [0m[34mMatch #[0m[33m1098[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m877 | [0m[35m[0m
[30;1m878 | [0m[35m        # migrate "hide_player" -->  "hide_player_in_ui"[0m
[30;1m879 | [0m[35m        for player_id, player_config in list(self._data.get(CONF_PLAYERS, {}).items()):[0m
[30;1m880 | [0m[35m            if not (values := player_config.get("values")):[0m
[30;1m881 | [0m[35m                continue[0m
[30;1m882 | [0m[35m            if values.pop("hide_player", None):[0m
[30;1m883 | [0m[35m                player_config["values"]["hide_player_in_ui"] = ["always"][0m

[31m--[ [0m[34mMatch #[0m[33m1099[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m876 | [0m[35m                changed = True[0m
[30;1m877 | [0m[35m[0m
[30;1m878 | [0m[35m        # migrate "hide_player" -->  "hide_player_in_ui"[0m
[30;1m879 | [0m[35m        for player_id, player_config in list(self._data.get(CONF_PLAYERS, {}).items()):[0m
[30;1m880 | [0m[35m            if not (values := player_config.get("values")):[0m
[30;1m881 | [0m[35m                continue[0m
[30;1m882 | [0m[35m            if values.pop("hide_player", None):[0m

[31m--[ [0m[34mMatch #[0m[33m1100[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m867 | [0m[35m                    break[0m
[30;1m868 | [0m[35m        # migrate slimproto --> squeezelite[0m
[30;1m869 | [0m[35m        for instance_id, provider_config in list(self._data.get(CONF_PROVIDERS, {}).items()):[0m
[30;1m870 | [0m[35m            if provider_config.get("domain") == "slimproto":[0m
[30;1m871 | [0m[35m                del self._data[CONF_PROVIDERS][instance_id][0m
[30;1m872 | [0m[35m                new_instance_id = instance_id.replace("slimproto", "squeezelite")[0m
[30;1m873 | [0m[35m                provider_config["instance_id"] = new_instance_id[0m

[31m--[ [0m[34mMatch #[0m[33m1101[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m866 | [0m[35m                    changed = True[0m
[30;1m867 | [0m[35m                    break[0m
[30;1m868 | [0m[35m        # migrate slimproto --> squeezelite[0m
[30;1m869 | [0m[35m        for instance_id, provider_config in list(self._data.get(CONF_PROVIDERS, {}).items()):[0m
[30;1m870 | [0m[35m            if provider_config.get("domain") == "slimproto":[0m
[30;1m871 | [0m[35m                del self._data[CONF_PROVIDERS][instance_id][0m
[30;1m872 | [0m[35m                new_instance_id = instance_id.replace("slimproto", "squeezelite")[0m

[31m--[ [0m[34mMatch #[0m[33m1102[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m860 | [0m[35m        # set 'onboard_done' flag if we have any (non default) provider configs[0m
[30;1m861 | [0m[35m        if self._data.get(CONF_ONBOARD_DONE) is None:[0m
[30;1m862 | [0m[35m            default_providers = {x.domain for x in self.mass.get_provider_manifests() if x.builtin}[0m
[30;1m863 | [0m[35m            for provider_config in self._data.get(CONF_PROVIDERS, {}).values():[0m
[30;1m864 | [0m[35m                if provider_config["domain"] not in default_providers:[0m
[30;1m865 | [0m[35m                    self._data[CONF_ONBOARD_DONE] = True[0m
[30;1m866 | [0m[35m                    changed = True[0m

[31m--[ [0m[34mMatch #[0m[33m1103[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m858 | [0m[35m            changed = True[0m
[30;1m859 | [0m[35m[0m
[30;1m860 | [0m[35m        # set 'onboard_done' flag if we have any (non default) provider configs[0m
[30;1m861 | [0m[35m        if self._data.get(CONF_ONBOARD_DONE) is None:[0m
[30;1m862 | [0m[35m            default_providers = {x.domain for x in self.mass.get_provider_manifests() if x.builtin}[0m
[30;1m863 | [0m[35m            for provider_config in self._data.get(CONF_PROVIDERS, {}).values():[0m
[30;1m864 | [0m[35m                if provider_config["domain"] not in default_providers:[0m

[31m--[ [0m[34mMatch #[0m[33m1104[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m849 | [0m[35m                # The DSP is enabled, and the user disabled the output limiter in a prior version[0m
[30;1m850 | [0m[35m                # Migrate the output limiter option to the player config[0m
[30;1m851 | [0m[35m                if (players := self._data.get(f"{CONF_PLAYERS}")) and ([0m
[30;1m852 | [0m[35m                    player := players.get(player_id)[0m
[30;1m853 | [0m[35m                ):[0m
[30;1m854 | [0m[35m                    player["values"][CONF_OUTPUT_LIMITER] = False[0m
[30;1m855 | [0m[35m            # Delete the old option, so this migration logic will never be called[0m

[31m--[ [0m[34mMatch #[0m[33m1105[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m848 | [0m[35m            if enabled:[0m
[30;1m849 | [0m[35m                # The DSP is enabled, and the user disabled the output limiter in a prior version[0m
[30;1m850 | [0m[35m                # Migrate the output limiter option to the player config[0m
[30;1m851 | [0m[35m                if (players := self._data.get(f"{CONF_PLAYERS}")) and ([0m
[30;1m852 | [0m[35m                    player := players.get(player_id)[0m
[30;1m853 | [0m[35m                ):[0m
[30;1m854 | [0m[35m                    player["values"][CONF_OUTPUT_LIMITER] = False[0m

[31m--[ [0m[34mMatch #[0m[33m1106[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m841 | [0m[35m        # migrate DSPConfig.output_limiter[0m
[30;1m842 | [0m[35m        for player_id, dsp_config in list(self._data.get(CONF_PLAYER_DSP, {}).items()):[0m
[30;1m843 | [0m[35m            output_limiter = dsp_config.get("output_limiter")[0m
[30;1m844 | [0m[35m            enabled = dsp_config.get("enabled")[0m
[30;1m845 | [0m[35m            if output_limiter is None or enabled is None or output_limiter:[0m
[30;1m846 | [0m[35m                continue[0m
[30;1m847 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1107[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m840 | [0m[35m            changed = True[0m
[30;1m841 | [0m[35m        # migrate DSPConfig.output_limiter[0m
[30;1m842 | [0m[35m        for player_id, dsp_config in list(self._data.get(CONF_PLAYER_DSP, {}).items()):[0m
[30;1m843 | [0m[35m            output_limiter = dsp_config.get("output_limiter")[0m
[30;1m844 | [0m[35m            enabled = dsp_config.get("enabled")[0m
[30;1m845 | [0m[35m            if output_limiter is None or enabled is None or output_limiter:[0m
[30;1m846 | [0m[35m                continue[0m

[31m--[ [0m[34mMatch #[0m[33m1108[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m839 | [0m[35m            ][0m
[30;1m840 | [0m[35m            changed = True[0m
[30;1m841 | [0m[35m        # migrate DSPConfig.output_limiter[0m
[30;1m842 | [0m[35m        for player_id, dsp_config in list(self._data.get(CONF_PLAYER_DSP, {}).items()):[0m
[30;1m843 | [0m[35m            output_limiter = dsp_config.get("output_limiter")[0m
[30;1m844 | [0m[35m            enabled = dsp_config.get("enabled")[0m
[30;1m845 | [0m[35m            if output_limiter is None or enabled is None or output_limiter:[0m

[31m--[ [0m[34mMatch #[0m[33m1109[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m827 | [0m[35m        for player_id, player_config in list(self._data.get(CONF_PLAYERS, {}).items()):[0m
[30;1m828 | [0m[35m            if not (values := player_config.get("values")):[0m
[30;1m829 | [0m[35m                continue[0m
[30;1m830 | [0m[35m            if not (sample_rates := values.get("sample_rates")):[0m
[30;1m831 | [0m[35m                continue[0m
[30;1m832 | [0m[35m            if not isinstance(sample_rates, list):[0m
[30;1m833 | [0m[35m                del player_config["values"]["sample_rates"][0m

[31m--[ [0m[34mMatch #[0m[33m1110[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m825 | [0m[35m            changed = True[0m
[30;1m826 | [0m[35m        # migrate sample_rates config entry[0m
[30;1m827 | [0m[35m        for player_id, player_config in list(self._data.get(CONF_PLAYERS, {}).items()):[0m
[30;1m828 | [0m[35m            if not (values := player_config.get("values")):[0m
[30;1m829 | [0m[35m                continue[0m
[30;1m830 | [0m[35m            if not (sample_rates := values.get("sample_rates")):[0m
[30;1m831 | [0m[35m                continue[0m

[31m--[ [0m[34mMatch #[0m[33m1111[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m824 | [0m[35m            del values["ips"][0m
[30;1m825 | [0m[35m            changed = True[0m
[30;1m826 | [0m[35m        # migrate sample_rates config entry[0m
[30;1m827 | [0m[35m        for player_id, player_config in list(self._data.get(CONF_PLAYERS, {}).items()):[0m
[30;1m828 | [0m[35m            if not (values := player_config.get("values")):[0m
[30;1m829 | [0m[35m                continue[0m
[30;1m830 | [0m[35m            if not (sample_rates := values.get("sample_rates")):[0m

[31m--[ [0m[34mMatch #[0m[33m1112[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m818 | [0m[35m        for instance_id, provider_config in list(self._data.get(CONF_PROVIDERS, {}).items()):[0m
[30;1m819 | [0m[35m            if not (values := provider_config.get("values")):[0m
[30;1m820 | [0m[35m                continue[0m
[30;1m821 | [0m[35m            if not (ips := values.get("ips")):[0m
[30;1m822 | [0m[35m                continue[0m
[30;1m823 | [0m[35m            values["manual_discovery_ip_addresses"] = ips.split(",")[0m
[30;1m824 | [0m[35m            del values["ips"][0m

[31m--[ [0m[34mMatch #[0m[33m1113[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m816 | [0m[35m                changed = True[0m
[30;1m817 | [0m[35m        # migrate manual_ips to new format[0m
[30;1m818 | [0m[35m        for instance_id, provider_config in list(self._data.get(CONF_PROVIDERS, {}).items()):[0m
[30;1m819 | [0m[35m            if not (values := provider_config.get("values")):[0m
[30;1m820 | [0m[35m                continue[0m
[30;1m821 | [0m[35m            if not (ips := values.get("ips")):[0m
[30;1m822 | [0m[35m                continue[0m

[31m--[ [0m[34mMatch #[0m[33m1114[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m815 | [0m[35m                LOGGER.warning("Removed corrupt provider configuration: %s", instance_id)[0m
[30;1m816 | [0m[35m                changed = True[0m
[30;1m817 | [0m[35m        # migrate manual_ips to new format[0m
[30;1m818 | [0m[35m        for instance_id, provider_config in list(self._data.get(CONF_PROVIDERS, {}).items()):[0m
[30;1m819 | [0m[35m            if not (values := provider_config.get("values")):[0m
[30;1m820 | [0m[35m                continue[0m
[30;1m821 | [0m[35m            if not (ips := values.get("ips")):[0m

[31m--[ [0m[34mMatch #[0m[33m1115[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m809 | [0m[35m[0m
[30;1m810 | [0m[35m        # Older versions of MA can create corrupt entries with no domain if retrying[0m
[30;1m811 | [0m[35m        # logic runs after a provider has been removed. Remove those corrupt entries.[0m
[30;1m812 | [0m[35m        for instance_id, provider_config in list(self._data.get(CONF_PROVIDERS, {}).items()):[0m
[30;1m813 | [0m[35m            if "domain" not in provider_config:[0m
[30;1m814 | [0m[35m                self._data[CONF_PROVIDERS].pop(instance_id, None)[0m
[30;1m815 | [0m[35m                LOGGER.warning("Removed corrupt provider configuration: %s", instance_id)[0m

[31m--[ [0m[34mMatch #[0m[33m1116[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m745 | [0m[35m[0m
[30;1m746 | [0m[35m        Note that this only stores the (raw) value without any validation or default.[0m
[30;1m747 | [0m[35m        """[0m
[30;1m748 | [0m[35m        if not self.get(f"{CONF_PLAYERS}/{player_id}"):[0m
[30;1m749 | [0m[35m            # only allow setting raw values if main entry exists[0m
[30;1m750 | [0m[35m            msg = f"Invalid player_id: {player_id}"[0m
[30;1m751 | [0m[35m            raise KeyError(msg)[0m

[31m--[ [0m[34mMatch #[0m[33m1117[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m734 | [0m[35m[0m
[30;1m735 | [0m[35m        Note that this only stores the (raw) value without any validation or default.[0m
[30;1m736 | [0m[35m        """[0m
[30;1m737 | [0m[35m        if not self.get(f"{CONF_CORE}/{core_module}"):[0m
[30;1m738 | [0m[35m            # create base object first if needed[0m
[30;1m739 | [0m[35m            self.set(f"{CONF_CORE}/{core_module}", CoreConfig({}, core_module).to_raw())[0m
[30;1m740 | [0m[35m        self.set(f"{CONF_CORE}/{core_module}/values/{key}", value)[0m

[31m--[ [0m[34mMatch #[0m[33m1118[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m717 | [0m[35m[0m
[30;1m718 | [0m[35m        Note that this only stores the (raw) value without any validation or default.[0m
[30;1m719 | [0m[35m        """[0m
[30;1m720 | [0m[35m        if not self.get(f"{CONF_PROVIDERS}/{provider_instance}"):[0m
[30;1m721 | [0m[35m            # only allow setting raw values if main entry exists[0m
[30;1m722 | [0m[35m            msg = f"Invalid provider_instance: {provider_instance}"[0m
[30;1m723 | [0m[35m            raise KeyError(msg)[0m

[31m--[ [0m[34mMatch #[0m[33m1119[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m702 | [0m[35m        """[0m
[30;1m703 | [0m[35m        return self.get([0m
[30;1m704 | [0m[35m            f"{CONF_PROVIDERS}/{provider_instance}/values/{key}",[0m
[30;1m705 | [0m[35m            self.get(f"{CONF_PROVIDERS}/{provider_instance}/{key}", default),[0m
[30;1m706 | [0m[35m        )[0m
[30;1m707 | [0m[35m[0m
[30;1m708 | [0m[35m    def set_raw_provider_config_value([0m

[31m--[ [0m[34mMatch #[0m[33m1120[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m700 | [0m[35m[0m
[30;1m701 | [0m[35m        Note that this only returns the stored value without any validation or default.[0m
[30;1m702 | [0m[35m        """[0m
[30;1m703 | [0m[35m        return self.get([0m
[30;1m704 | [0m[35m            f"{CONF_PROVIDERS}/{provider_instance}/values/{key}",[0m
[30;1m705 | [0m[35m            self.get(f"{CONF_PROVIDERS}/{provider_instance}/{key}", default),[0m
[30;1m706 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1121[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m689 | [0m[35m        """[0m
[30;1m690 | [0m[35m        return self.get([0m
[30;1m691 | [0m[35m            f"{CONF_CORE}/{core_module}/values/{key}",[0m
[30;1m692 | [0m[35m            self.get(f"{CONF_CORE}/{core_module}/{key}", default),[0m
[30;1m693 | [0m[35m        )[0m
[30;1m694 | [0m[35m[0m
[30;1m695 | [0m[35m    def get_raw_provider_config_value([0m

[31m--[ [0m[34mMatch #[0m[33m1122[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m687 | [0m[35m[0m
[30;1m688 | [0m[35m        Note that this only returns the stored value without any validation or default.[0m
[30;1m689 | [0m[35m        """[0m
[30;1m690 | [0m[35m        return self.get([0m
[30;1m691 | [0m[35m            f"{CONF_CORE}/{core_module}/values/{key}",[0m
[30;1m692 | [0m[35m            self.get(f"{CONF_CORE}/{core_module}/{key}", default),[0m
[30;1m693 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1123[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m648 | [0m[35m        values: the (intermediate) raw values for config entries sent with the action.[0m
[30;1m649 | [0m[35m        """[0m
[30;1m650 | [0m[35m        if values is None:[0m
[30;1m651 | [0m[35m            values = self.get(f"{CONF_CORE}/{domain}/values", {})[0m
[30;1m652 | [0m[35m        controller: CoreController = getattr(self.mass, domain)[0m
[30;1m653 | [0m[35m        return ([0m
[30;1m654 | [0m[35m            await controller.get_config_entries(action=action, values=values)[0m

[31m--[ [0m[34mMatch #[0m[33m1124[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m619 | [0m[35m    @api_command("config/core/get")[0m
[30;1m620 | [0m[35m    async def get_core_config(self, domain: str) -> CoreConfig:[0m
[30;1m621 | [0m[35m        """Return configuration for a single core controller."""[0m
[30;1m622 | [0m[35m        raw_conf = self.get(f"{CONF_CORE}/{domain}", {"domain": domain})[0m
[30;1m623 | [0m[35m        config_entries = await self.get_core_config_entries(domain)[0m
[30;1m624 | [0m[35m        return CoreConfig.parse(config_entries, raw_conf)[0m
[30;1m625 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1125[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m611 | [0m[35m            if include_values[0m
[30;1m612 | [0m[35m            else CoreConfig.parse([0m
[30;1m613 | [0m[35m                [],[0m
[30;1m614 | [0m[35m                self.get(f"{CONF_CORE}/{core_controller}", {"domain": core_controller}),[0m
[30;1m615 | [0m[35m            )[0m
[30;1m616 | [0m[35m            for core_controller in CONFIGURABLE_CORE_CONTROLLERS[0m
[30;1m617 | [0m[35m        ][0m

[31m--[ [0m[34mMatch #[0m[33m1126[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m543 | [0m[35m        Called by the player manager on player register.[0m
[30;1m544 | [0m[35m        """[0m
[30;1m545 | [0m[35m        # return early if the config already exists[0m
[30;1m546 | [0m[35m        if self.get(f"{CONF_PLAYERS}/{player_id}"):[0m
[30;1m547 | [0m[35m            # update default name if needed[0m
[30;1m548 | [0m[35m            if name:[0m
[30;1m549 | [0m[35m                self.set(f"{CONF_PLAYERS}/{player_id}/default_name", name)[0m

[31m--[ [0m[34mMatch #[0m[33m1127[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m461 | [0m[35m[0m
[30;1m462 | [0m[35m        In case the player does not have a DSP configuration, a default one is returned.[0m
[30;1m463 | [0m[35m        """[0m
[30;1m464 | [0m[35m        if raw_conf := self.get(f"{CONF_PLAYER_DSP}/{player_id}"):[0m
[30;1m465 | [0m[35m            return DSPConfig.from_dict(raw_conf)[0m
[30;1m466 | [0m[35m        else:[0m
[30;1m467 | [0m[35m            # return default DSP config[0m

[31m--[ [0m[34mMatch #[0m[33m1128[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m440 | [0m[35m        # check for group memberships that need to be updated[0m
[30;1m441 | [0m[35m        if player and player.active_group and player_provider:[0m
[30;1m442 | [0m[35m            # try to remove from the group[0m
[30;1m443 | [0m[35m            group_player = self.mass.players.get(player.active_group)[0m
[30;1m444 | [0m[35m            with suppress(UnsupportedFeaturedException, PlayerCommandFailed):[0m
[30;1m445 | [0m[35m                await player_provider.set_members([0m
[30;1m446 | [0m[35m                    player.active_group,[0m

[31m--[ [0m[34mMatch #[0m[33m1129[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m427 | [0m[35m        if not existing:[0m
[30;1m428 | [0m[35m            msg = f"Player configuration for {player_id} does not exist"[0m
[30;1m429 | [0m[35m            raise KeyError(msg)[0m
[30;1m430 | [0m[35m        player = self.mass.players.get(player_id)[0m
[30;1m431 | [0m[35m        player_prov = player.provider if player else existing["provider"][0m
[30;1m432 | [0m[35m        player_provider = self.mass.get_provider(player_prov)[0m
[30;1m433 | [0m[35m        if player_provider and ProviderFeature.REMOVE_PLAYER in player_provider.supported_features:[0m

[31m--[ [0m[34mMatch #[0m[33m1130[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m423 | [0m[35m        """Remove PlayerConfig."""[0m
[30;1m424 | [0m[35m        conf_key = f"{CONF_PLAYERS}/{player_id}"[0m
[30;1m425 | [0m[35m        dsp_conf_key = f"{CONF_PLAYER_DSP}/{player_id}"[0m
[30;1m426 | [0m[35m        existing = self.get(conf_key)[0m
[30;1m427 | [0m[35m        if not existing:[0m
[30;1m428 | [0m[35m            msg = f"Player configuration for {player_id} does not exist"[0m
[30;1m429 | [0m[35m            raise KeyError(msg)[0m

[31m--[ [0m[34mMatch #[0m[33m1131[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m388 | [0m[35m        """[0m
[30;1m389 | [0m[35m        return self.get([0m
[30;1m390 | [0m[35m            f"{CONF_PLAYERS}/{player_id}/values/{key}",[0m
[30;1m391 | [0m[35m            self.get(f"{CONF_PLAYERS}/{player_id}/{key}", default),[0m
[30;1m392 | [0m[35m        )[0m
[30;1m393 | [0m[35m[0m
[30;1m394 | [0m[35m    @api_command("config/players/save")[0m

[31m--[ [0m[34mMatch #[0m[33m1132[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m386 | [0m[35m[0m
[30;1m387 | [0m[35m        Note that this only returns the stored value without any validation or default.[0m
[30;1m388 | [0m[35m        """[0m
[30;1m389 | [0m[35m        return self.get([0m
[30;1m390 | [0m[35m            f"{CONF_PLAYERS}/{player_id}/values/{key}",[0m
[30;1m391 | [0m[35m            self.get(f"{CONF_PLAYERS}/{player_id}/{key}", default),[0m
[30;1m392 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1133[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m356 | [0m[35m                    conf_entries = ()[0m
[30;1m357 | [0m[35m                raw_conf["available"] = False[0m
[30;1m358 | [0m[35m                raw_conf["name"] = raw_conf.get("name")[0m
[30;1m359 | [0m[35m                raw_conf["default_name"] = raw_conf.get("default_name") or raw_conf["player_id"][0m
[30;1m360 | [0m[35m            return PlayerConfig.parse(conf_entries, raw_conf)[0m
[30;1m361 | [0m[35m        msg = f"No config found for player id {player_id}"[0m
[30;1m362 | [0m[35m        raise KeyError(msg)[0m

[31m--[ [0m[34mMatch #[0m[33m1134[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m355 | [0m[35m                else:[0m
[30;1m356 | [0m[35m                    conf_entries = ()[0m
[30;1m357 | [0m[35m                raw_conf["available"] = False[0m
[30;1m358 | [0m[35m                raw_conf["name"] = raw_conf.get("name")[0m
[30;1m359 | [0m[35m                raw_conf["default_name"] = raw_conf.get("default_name") or raw_conf["player_id"][0m
[30;1m360 | [0m[35m            return PlayerConfig.parse(conf_entries, raw_conf)[0m
[30;1m361 | [0m[35m        msg = f"No config found for player id {player_id}"[0m

[31m--[ [0m[34mMatch #[0m[33m1135[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m343 | [0m[35m    async def get_player_config(self, player_id: str) -> PlayerConfig:[0m
[30;1m344 | [0m[35m        """Return (full) configuration for a single player."""[0m
[30;1m345 | [0m[35m        if raw_conf := self.get(f"{CONF_PLAYERS}/{player_id}"):[0m
[30;1m346 | [0m[35m            if player := self.mass.players.get(player_id, False):[0m
[30;1m347 | [0m[35m                raw_conf["default_name"] = player.display_name[0m
[30;1m348 | [0m[35m                raw_conf["provider"] = player.provider[0m
[30;1m349 | [0m[35m                prov = self.mass.get_provider(player.provider)[0m

[31m--[ [0m[34mMatch #[0m[33m1136[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m342 | [0m[35m    @api_command("config/players/get")[0m
[30;1m343 | [0m[35m    async def get_player_config(self, player_id: str) -> PlayerConfig:[0m
[30;1m344 | [0m[35m        """Return (full) configuration for a single player."""[0m
[30;1m345 | [0m[35m        if raw_conf := self.get(f"{CONF_PLAYERS}/{player_id}"):[0m
[30;1m346 | [0m[35m            if player := self.mass.players.get(player_id, False):[0m
[30;1m347 | [0m[35m                raw_conf["default_name"] = player.display_name[0m
[30;1m348 | [0m[35m                raw_conf["provider"] = player.provider[0m

[31m--[ [0m[34mMatch #[0m[33m1137[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m329 | [0m[35m            await self.get_player_config(raw_conf["player_id"])[0m
[30;1m330 | [0m[35m            if include_values[0m
[30;1m331 | [0m[35m            else PlayerConfig.parse([], raw_conf)[0m
[30;1m332 | [0m[35m            for raw_conf in list(self.get(CONF_PLAYERS, {}).values())[0m
[30;1m333 | [0m[35m            # filter out unavailable providers (only if we requested the full info)[0m
[30;1m334 | [0m[35m            if ([0m
[30;1m335 | [0m[35m                not include_values[0m

[31m--[ [0m[34mMatch #[0m[33m1138[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m315 | [0m[35m    async def remove_provider_config_value(self, instance_id: str, key: str) -> None:[0m
[30;1m316 | [0m[35m        """Remove/reset single Provider config value."""[0m
[30;1m317 | [0m[35m        conf_key = f"{CONF_PROVIDERS}/{instance_id}/values/{key}"[0m
[30;1m318 | [0m[35m        existing = self.get(conf_key)[0m
[30;1m319 | [0m[35m        if not existing:[0m
[30;1m320 | [0m[35m            return[0m
[30;1m321 | [0m[35m        self.remove(conf_key)[0m

[31m--[ [0m[34mMatch #[0m[33m1139[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m308 | [0m[35m                    continue[0m
[30;1m309 | [0m[35m                self.mass.players.remove(player.player_id, cleanup_config=True)[0m
[30;1m310 | [0m[35m            # cleanup remaining player configs[0m
[30;1m311 | [0m[35m            for player_conf in list(self.get(CONF_PLAYERS, {}).values()):[0m
[30;1m312 | [0m[35m                if player_conf["provider"] == instance_id:[0m
[30;1m313 | [0m[35m                    self.remove(f"{CONF_PLAYERS}/{player_conf['player_id']}")[0m
[30;1m314 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1140[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m288 | [0m[35m    async def remove_provider_config(self, instance_id: str) -> None:[0m
[30;1m289 | [0m[35m        """Remove ProviderConfig."""[0m
[30;1m290 | [0m[35m        conf_key = f"{CONF_PROVIDERS}/{instance_id}"[0m
[30;1m291 | [0m[35m        existing = self.get(conf_key)[0m
[30;1m292 | [0m[35m        if not existing:[0m
[30;1m293 | [0m[35m            msg = f"Provider {instance_id} does not exist"[0m
[30;1m294 | [0m[35m            raise KeyError(msg)[0m

[31m--[ [0m[34mMatch #[0m[33m1141[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m251 | [0m[35m            msg = f"Unknown provider domain: {provider_domain}"[0m
[30;1m252 | [0m[35m            raise KeyError(msg)[0m
[30;1m253 | [0m[35m        if values is None:[0m
[30;1m254 | [0m[35m            values = self.get(f"{CONF_PROVIDERS}/{instance_id}/values", {}) if instance_id else {}[0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35m        return ([0m
[30;1m257 | [0m[35m            await prov_mod.get_config_entries([0m

[31m--[ [0m[34mMatch #[0m[33m1142[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m214 | [0m[35m    async def get_provider_config_value(self, instance_id: str, key: str) -> ConfigValueType:[0m
[30;1m215 | [0m[35m        """Return single configentry value for a provider."""[0m
[30;1m216 | [0m[35m        cache_key = f"prov_conf_value_{instance_id}.{key}"[0m
[30;1m217 | [0m[35m        if (cached_value := self._value_cache.get(cache_key)) is not None:[0m
[30;1m218 | [0m[35m            return cached_value[0m
[30;1m219 | [0m[35m        conf = await self.get_provider_config(instance_id)[0m
[30;1m220 | [0m[35m        val = ([0m

[31m--[ [0m[34mMatch #[0m[33m1143[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m198 | [0m[35m            config_entries = await self.get_provider_config_entries([0m
[30;1m199 | [0m[35m                raw_conf["domain"],[0m
[30;1m200 | [0m[35m                instance_id=instance_id,[0m
[30;1m201 | [0m[35m                values=raw_conf.get("values"),[0m
[30;1m202 | [0m[35m            )[0m
[30;1m203 | [0m[35m            for prov in self.mass.get_provider_manifests():[0m
[30;1m204 | [0m[35m                if prov.domain == raw_conf["domain"]:[0m

[31m--[ [0m[34mMatch #[0m[33m1144[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m194 | [0m[35m    @api_command("config/providers/get")[0m
[30;1m195 | [0m[35m    async def get_provider_config(self, instance_id: str) -> ProviderConfig:[0m
[30;1m196 | [0m[35m        """Return configuration for a single provider."""[0m
[30;1m197 | [0m[35m        if raw_conf := self.get(f"{CONF_PROVIDERS}/{instance_id}", {}):[0m
[30;1m198 | [0m[35m            config_entries = await self.get_provider_config_entries([0m
[30;1m199 | [0m[35m                raw_conf["domain"],[0m
[30;1m200 | [0m[35m                instance_id=instance_id,[0m

[31m--[ [0m[34mMatch #[0m[33m1145[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m178 | [0m[35m        include_values: bool = False,[0m
[30;1m179 | [0m[35m    ) -> list[ProviderConfig]:[0m
[30;1m180 | [0m[35m        """Return all known provider configurations, optionally filtered by ProviderType."""[0m
[30;1m181 | [0m[35m        raw_values: dict[str, dict] = self.get(CONF_PROVIDERS, {})[0m
[30;1m182 | [0m[35m        prov_entries = {x.domain for x in self.mass.get_provider_manifests()}[0m
[30;1m183 | [0m[35m        return [[0m
[30;1m184 | [0m[35m            await self.get_provider_config(prov_conf["instance_id"])[0m

[31m--[ [0m[34mMatch #[0m[33m1146[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m147 | [0m[35m    def set_default(self, key: str, default_value: Any) -> None:[0m
[30;1m148 | [0m[35m        """Set default value(s) for a specific key/path in persistent storage."""[0m
[30;1m149 | [0m[35m        assert self.initialized, "Not yet (async) initialized"[0m
[30;1m150 | [0m[35m        cur_value = self.get(key, "__MISSING__")[0m
[30;1m151 | [0m[35m        if cur_value == "__MISSING__":[0m
[30;1m152 | [0m[35m            self.set(key, default_value)[0m
[30;1m153 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1147[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m        subkeys = key.split("/")[0m
[30;1m119 | [0m[35m        for index, subkey in enumerate(subkeys):[0m
[30;1m120 | [0m[35m            if index == (len(subkeys) - 1):[0m
[30;1m121 | [0m[35m                value = parent.get(subkey, default)[0m
[30;1m122 | [0m[35m                if value is None:[0m
[30;1m123 | [0m[35m                    # replace None with default[0m
[30;1m124 | [0m[35m                    return default[0m

[31m--[ [0m[34mMatch #[0m[33m1148[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m99 | [0m[35m    @property[0m
[30;1m100 | [0m[35m    def onboard_done(self) -> bool:[0m
[30;1m101 | [0m[35m        """Return True if onboarding is done."""[0m
[30;1m102 | [0m[35m        return self.get(CONF_ONBOARD_DONE, False)[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m    async def close(self) -> None:[0m
[30;1m105 | [0m[35m        """Handle logic on server stop."""[0m

[31m--[ [0m[34mMatch #[0m[33m1149[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m88 | [0m[35m        self.initialized = True[0m
[30;1m89 | [0m[35m        # create default server ID if needed (also used for encrypting passwords)[0m
[30;1m90 | [0m[35m        self.set_default(CONF_SERVER_ID, uuid4().hex)[0m
[30;1m91 | [0m[35m        server_id: str = self.get(CONF_SERVER_ID)[0m
[30;1m92 | [0m[35m        assert server_id[0m
[30;1m93 | [0m[35m        fernet_key = base64.urlsafe_b64encode(server_id.encode()[:32])[0m
[30;1m94 | [0m[35m        self._fernet = Fernet(fernet_key)[0m

[31m--[ [0m[34mMatch #[0m[33m1150[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m570 | [0m[35m        Create builtin ProviderConfig.[0m
[30;1m571 | [0m[35m[0m
[30;1m572 | [0m[35m        This is meant as helper to create default configs for builtin providers.[0m
[30;1m573 | [0m[35m        Called by the server initialization code which load all providers at startup.[0m
[30;1m574 | [0m[35m        """[0m
[30;1m575 | [0m[35m        for _ in await self.get_provider_configs(provider_domain=provider_domain):[0m
[30;1m576 | [0m[35m            # return if there is already any config[0m

[31m--[ [0m[34mMatch #[0m[33m1151[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m544 | [0m[35m        """[0m
[30;1m545 | [0m[35m        # return early if the config already exists[0m
[30;1m546 | [0m[35m        if self.get(f"{CONF_PLAYERS}/{player_id}"):[0m
[30;1m547 | [0m[35m            # update default name if needed[0m
[30;1m548 | [0m[35m            if name:[0m
[30;1m549 | [0m[35m                self.set(f"{CONF_PLAYERS}/{player_id}/default_name", name)[0m
[30;1m550 | [0m[35m            return[0m

[31m--[ [0m[34mMatch #[0m[33m1152[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m478 | [0m[35m            )[0m
[30;1m479 | [0m[35m            if deprecated_eq_bass != 0 or deprecated_eq_mid != 0 or deprecated_eq_treble != 0:[0m
[30;1m480 | [0m[35m                # the user previously used the now deprecated EQ settings:[0m
[30;1m481 | [0m[35m                # add a tone control filter with the old values, reset the deprecated values and[0m
[30;1m482 | [0m[35m                # save this as the new DSP config[0m
[30;1m483 | [0m[35m                # TODO: remove this in a future release[0m
[30;1m484 | [0m[35m                dsp_config.enabled = True[0m

[31m--[ [0m[34mMatch #[0m[33m1153[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m406 | [0m[35m        # actually store changes (if the above did not raise)[0m
[30;1m407 | [0m[35m        conf_key = f"{CONF_PLAYERS}/{player_id}"[0m
[30;1m408 | [0m[35m        self.set(conf_key, config.to_raw())[0m
[30;1m409 | [0m[35m        # always update player attributes to calculate e.g. player controls etc.[0m
[30;1m410 | [0m[35m        self.mass.players.update(config.player_id, force_update=True)[0m
[30;1m411 | [0m[35m        # send config updated event[0m
[30;1m412 | [0m[35m        self.mass.signal_event([0m

[31m--[ [0m[34mMatch #[0m[33m1154[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m401 | [0m[35m        if not changed_keys:[0m
[30;1m402 | [0m[35m            # no changes[0m
[30;1m403 | [0m[35m            return None[0m
[30;1m404 | [0m[35m        # validate/handle the update in the player manager[0m
[30;1m405 | [0m[35m        await self.mass.players.on_player_config_change(config, changed_keys)[0m
[30;1m406 | [0m[35m        # actually store changes (if the above did not raise)[0m
[30;1m407 | [0m[35m        conf_key = f"{CONF_PLAYERS}/{player_id}"[0m

[31m--[ [0m[34mMatch #[0m[33m1155[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m113 | [0m[35m        """Get value(s) for a specific key/path in persistent storage."""[0m
[30;1m114 | [0m[35m        assert self.initialized, "Not yet (async) initialized"[0m
[30;1m115 | [0m[35m        # we support a multi level hierarchy by providing the key as path,[0m
[30;1m116 | [0m[35m        # with a slash (/) as splitter. Sort that out here.[0m
[30;1m117 | [0m[35m        parent = self._data[0m
[30;1m118 | [0m[35m        subkeys = key.split("/")[0m
[30;1m119 | [0m[35m        for index, subkey in enumerate(subkeys):[0m

[31m--[ [0m[34mMatch #[0m[33m1156[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom __future__ import annotations[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mimport base64[0m
[30;1m6 | [0m[35mimport logging[0m
[30;1m7 | [0m[35mimport os[0m
[30;1m8 | [0m[35mfrom contextlib import suppress[0m
[30;1m9 | [0m[35mfrom typing import TYPE_CHECKING, Any[0m

[31m--[ [0m[34mMatch #[0m[33m1157[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/metadata.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m745 | [0m[35m        # postpone the lookup for a while to allow the system to start up and providers initialized[0m
[30;1m746 | [0m[35m        await asyncio.sleep(60)[0m
[30;1m747 | [0m[35m        while True:[0m
[30;1m748 | [0m[35m            item_uri = await self._lookup_jobs.get()[0m
[30;1m749 | [0m[35m            try:[0m
[30;1m750 | [0m[35m                item = await self.mass.music.get_item_by_uri(item_uri)[0m
[30;1m751 | [0m[35m                await self.update_metadata(item)[0m

[31m--[ [0m[34mMatch #[0m[33m1158[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/metadata.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m384 | [0m[35m            # temporary for backwards compatibility[0m
[30;1m385 | [0m[35m            provider = "builtin"[0m
[30;1m386 | [0m[35m        size = int(request.query.get("size", "0"))[0m
[30;1m387 | [0m[35m        image_format = request.query.get("fmt", "png")[0m
[30;1m388 | [0m[35m        if not self.mass.get_provider(provider) and not path.startswith("http"):[0m
[30;1m389 | [0m[35m            return web.Response(status=404)[0m
[30;1m390 | [0m[35m        if "%" in path:[0m

[31m--[ [0m[34mMatch #[0m[33m1159[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/metadata.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m383 | [0m[35m        if provider in ("url", "file", "http"):[0m
[30;1m384 | [0m[35m            # temporary for backwards compatibility[0m
[30;1m385 | [0m[35m            provider = "builtin"[0m
[30;1m386 | [0m[35m        size = int(request.query.get("size", "0"))[0m
[30;1m387 | [0m[35m        image_format = request.query.get("fmt", "png")[0m
[30;1m388 | [0m[35m        if not self.mass.get_provider(provider) and not path.startswith("http"):[0m
[30;1m389 | [0m[35m            return web.Response(status=404)[0m

[31m--[ [0m[34mMatch #[0m[33m1160[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/metadata.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m379 | [0m[35m    async def handle_imageproxy(self, request: web.Request) -> web.Response:[0m
[30;1m380 | [0m[35m        """Handle request for image proxy."""[0m
[30;1m381 | [0m[35m        path = request.query["path"][0m
[30;1m382 | [0m[35m        provider = request.query.get("provider", "builtin")[0m
[30;1m383 | [0m[35m        if provider in ("url", "file", "http"):[0m
[30;1m384 | [0m[35m            # temporary for backwards compatibility[0m
[30;1m385 | [0m[35m            provider = "builtin"[0m

[31m--[ [0m[34mMatch #[0m[33m1161[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/metadata.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m786 | [0m[35m            self.schedule_update_metadata(album.uri)[0m
[30;1m787 | [0m[35m[0m
[30;1m788 | [0m[35m        # Force refresh playlist metadata every refresh interval[0m
[30;1m789 | [0m[35m        # this will e.g. update the playlist image and genres if the tracks have changed[0m
[30;1m790 | [0m[35m        timestamp = int(time() - REFRESH_INTERVAL_PLAYLISTS)[0m
[30;1m791 | [0m[35m        query = ([0m
[30;1m792 | [0m[35m            f"json_extract({DB_TABLE_PLAYLISTS}.metadata,'$.last_refresh') ISNULL "[0m

[31m--[ [0m[34mMatch #[0m[33m1162[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/metadata.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m679 | [0m[35m        playlist.metadata.images = new_images[0m
[30;1m680 | [0m[35m        # set timestamp, used to determine when this function was last called[0m
[30;1m681 | [0m[35m        playlist.metadata.last_refresh = int(time())[0m
[30;1m682 | [0m[35m        # update final item in library database[0m
[30;1m683 | [0m[35m        await self.mass.music.playlists.update_item_in_library(playlist.item_id, playlist)[0m
[30;1m684 | [0m[35m[0m
[30;1m685 | [0m[35m    async def _get_artist_mbid(self, artist: Artist) -> str | None:[0m

[31m--[ [0m[34mMatch #[0m[33m1163[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/metadata.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m606 | [0m[35m                    )[0m
[30;1m607 | [0m[35m        # set timestamp, used to determine when this function was last called[0m
[30;1m608 | [0m[35m        track.metadata.last_refresh = int(time())[0m
[30;1m609 | [0m[35m        # update final item in library database[0m
[30;1m610 | [0m[35m        await self.mass.music.tracks.update_item_in_library(track.item_id, track)[0m
[30;1m611 | [0m[35m[0m
[30;1m612 | [0m[35m    async def _update_playlist_metadata([0m

[31m--[ [0m[34mMatch #[0m[33m1164[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/metadata.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m553 | [0m[35m                        album.name,[0m
[30;1m554 | [0m[35m                        provider.name,[0m
[30;1m555 | [0m[35m                    )[0m
[30;1m556 | [0m[35m        # update final item in library database[0m
[30;1m557 | [0m[35m        # set timestamp, used to determine when this function was last called[0m
[30;1m558 | [0m[35m        album.metadata.last_refresh = int(time())[0m
[30;1m559 | [0m[35m        await self.mass.music.albums.update_item_in_library(album.item_id, album)[0m

[31m--[ [0m[34mMatch #[0m[33m1165[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/metadata.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m498 | [0m[35m                        artist.name,[0m
[30;1m499 | [0m[35m                        provider.name,[0m
[30;1m500 | [0m[35m                    )[0m
[30;1m501 | [0m[35m        # update final item in library database[0m
[30;1m502 | [0m[35m        # set timestamp, used to determine when this function was last called[0m
[30;1m503 | [0m[35m        artist.metadata.last_refresh = int(time())[0m
[30;1m504 | [0m[35m        await self.mass.music.artists.update_item_in_library(artist.item_id, artist)[0m

[31m--[ [0m[34mMatch #[0m[33m1166[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/metadata.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m411 | [0m[35m    ) -> MediaItemImage | None:[0m
[30;1m412 | [0m[35m        """Create collage thumb/fanart image for (in-library) playlist."""[0m
[30;1m413 | [0m[35m        if (len(images) < 8 and fanart) or len(images) < 3:[0m
[30;1m414 | [0m[35m            # require at least some images otherwise this does not make a lot of sense[0m
[30;1m415 | [0m[35m            return None[0m
[30;1m416 | [0m[35m        # limit to 50 images to prevent we're going OOM[0m
[30;1m417 | [0m[35m        if len(images) > 50:[0m

[31m--[ [0m[34mMatch #[0m[33m1167[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/metadata.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m279 | [0m[35m        return item[0m
[30;1m280 | [0m[35m[0m
[30;1m281 | [0m[35m    def schedule_update_metadata(self, uri: str) -> None:[0m
[30;1m282 | [0m[35m        """Schedule metadata update for given MediaItem uri."""[0m
[30;1m283 | [0m[35m        if "library" not in uri:[0m
[30;1m284 | [0m[35m            return[0m
[30;1m285 | [0m[35m        with suppress(asyncio.QueueFull):[0m

[31m--[ [0m[34mMatch #[0m[33m1168[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/metadata.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m178 | [0m[35m        self.mass.streams.register_dynamic_route("/imageproxy", self.handle_imageproxy)[0m
[30;1m179 | [0m[35m        # the lookup task is used to process metadata lookup jobs[0m
[30;1m180 | [0m[35m        self._lookup_task = self.mass.create_task(self._process_metadata_lookup_jobs())[0m
[30;1m181 | [0m[35m        # just tun the scan for missing metadata once at startup[0m
[30;1m182 | [0m[35m        # TODO: allows to enable/disable this in the UI and configure interval/time[0m
[30;1m183 | [0m[35m        self._missing_metadata_scan_task = self.mass.create_task(self._scan_missing_metadata())[0m
[30;1m184 | [0m[35m        # migrate old image path for collage images from absolute to relative[0m

[31m--[ [0m[34mMatch #[0m[33m1169[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m572 | [0m[35m        await self.mass.music.tracks.match_providers(track)[0m
[30;1m573 | [0m[35m[0m
[30;1m574 | [0m[35m        # collect metadata from all [music] providers[0m
[30;1m575 | [0m[35m        # note that we sort the providers by priority so that we always[0m
[30;1m576 | [0m[35m        # prefer local providers over online providers[0m
[30;1m577 | [0m[35m        unique_keys: set[str] = set()[0m
[30;1m578 | [0m[35m        local_provs = get_global_cache_value("non_streaming_providers")[0m

[31m--[ [0m[34mMatch #[0m[33m1170[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m517 | [0m[35m        await self.mass.music.albums.match_providers(album)[0m
[30;1m518 | [0m[35m[0m
[30;1m519 | [0m[35m        # collect metadata from all [music] providers[0m
[30;1m520 | [0m[35m        # note that we sort the providers by priority so that we always[0m
[30;1m521 | [0m[35m        # prefer local providers over online providers[0m
[30;1m522 | [0m[35m        unique_keys: set[str] = set()[0m
[30;1m523 | [0m[35m        local_provs = get_global_cache_value("non_streaming_providers")[0m

[31m--[ [0m[34mMatch #[0m[33m1171[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m462 | [0m[35m        await self.mass.music.artists.match_providers(artist)[0m
[30;1m463 | [0m[35m[0m
[30;1m464 | [0m[35m        # collect metadata from all [music] providers[0m
[30;1m465 | [0m[35m        # note that we sort the providers by priority so that we always[0m
[30;1m466 | [0m[35m        # prefer local providers over online providers[0m
[30;1m467 | [0m[35m        for prov_mapping in sorted([0m
[30;1m468 | [0m[35m            artist.provider_mappings, key=lambda x: x.priority, reverse=True[0m

[31m--[ [0m[34mMatch #[0m[33m1172[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35mimport urllib.parse[0m
[30;1m11 | [0m[35mfrom base64 import b64encode[0m
[30;1m12 | [0m[35mfrom contextlib import suppress[0m
[30;1m13 | [0m[35mfrom time import time[0m
[30;1m14 | [0m[35mfrom typing import TYPE_CHECKING, cast[0m
[30;1m15 | [0m[35mfrom uuid import uuid4[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mimport aiofiles[0m

[31m--[ [0m[34mMatch #[0m[33m1173[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35mimport urllib.parse[0m
[30;1m11 | [0m[35mfrom base64 import b64encode[0m
[30;1m12 | [0m[35mfrom contextlib import suppress[0m
[30;1m13 | [0m[35mfrom time import time[0m
[30;1m14 | [0m[35mfrom typing import TYPE_CHECKING, cast[0m
[30;1m15 | [0m[35mfrom uuid import uuid4[0m
[30;1m16 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1174[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35mimport os[0m
[30;1m9 | [0m[35mimport random[0m
[30;1m10 | [0m[35mimport urllib.parse[0m
[30;1m11 | [0m[35mfrom base64 import b64encode[0m
[30;1m12 | [0m[35mfrom contextlib import suppress[0m
[30;1m13 | [0m[35mfrom time import time[0m
[30;1m14 | [0m[35mfrom typing import TYPE_CHECKING, cast[0m

[31m--[ [0m[34mMatch #[0m[33m1175[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m36 | [0m[35m        if self.raop_stream:[0m
[30;1m37 | [0m[35m            # forward stop to the entire stream session[0m
[30;1m38 | [0m[35m            await self.raop_stream.session.stop()[0m
[30;1m39 | [0m[35m        if update_state and (mass_player := self.mass.players.get(self.player_id)):[0m
[30;1m40 | [0m[35m            mass_player.state = PlayerState.IDLE[0m
[30;1m41 | [0m[35m            self.mass.players.update(mass_player.player_id)[0m
[30;1m42 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1176[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/models/music_provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m687 | [0m[35m        cache_base_key = self.instance_id[0m
[30;1m688 | [0m[35m[0m
[30;1m689 | [0m[35m        prev_library_items: list[int] | None[0m
[30;1m690 | [0m[35m        if prev_library_items := await self.mass.cache.get([0m
[30;1m691 | [0m[35m            media_type.value, category=cache_category, base_key=cache_base_key[0m
[30;1m692 | [0m[35m        ):[0m
[30;1m693 | [0m[35m            for db_id in prev_library_items:[0m

[31m--[ [0m[34mMatch #[0m[33m1177[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/models/music_provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m510 | [0m[35m                extra_query=query, extra_query_params=query_params[0m
[30;1m511 | [0m[35m            )[0m
[30;1m512 | [0m[35m        if subpath == "podcasts":[0m
[30;1m513 | [0m[35m            library_item_ids = await self.mass.cache.get([0m
[30;1m514 | [0m[35m                "podcast",[0m
[30;1m515 | [0m[35m                category=CACHE_CATEGORY_LIBRARY_ITEMS,[0m
[30;1m516 | [0m[35m                base_key=self.instance_id,[0m

[31m--[ [0m[34mMatch #[0m[33m1178[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/models/music_provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m496 | [0m[35m                extra_query=query, extra_query_params=query_params[0m
[30;1m497 | [0m[35m            )[0m
[30;1m498 | [0m[35m        if subpath == "audiobooks":[0m
[30;1m499 | [0m[35m            library_item_ids = await self.mass.cache.get([0m
[30;1m500 | [0m[35m                "audiobook",[0m
[30;1m501 | [0m[35m                category=CACHE_CATEGORY_LIBRARY_ITEMS,[0m
[30;1m502 | [0m[35m                base_key=self.instance_id,[0m

[31m--[ [0m[34mMatch #[0m[33m1179[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/models/music_provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m482 | [0m[35m                extra_query=query, extra_query_params=query_params[0m
[30;1m483 | [0m[35m            )[0m
[30;1m484 | [0m[35m        if subpath == "playlists":[0m
[30;1m485 | [0m[35m            library_item_ids = await self.mass.cache.get([0m
[30;1m486 | [0m[35m                "playlist",[0m
[30;1m487 | [0m[35m                category=CACHE_CATEGORY_LIBRARY_ITEMS,[0m
[30;1m488 | [0m[35m                base_key=self.instance_id,[0m

[31m--[ [0m[34mMatch #[0m[33m1180[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/models/music_provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m468 | [0m[35m                extra_query=query, extra_query_params=query_params[0m
[30;1m469 | [0m[35m            )[0m
[30;1m470 | [0m[35m        if subpath == "radios":[0m
[30;1m471 | [0m[35m            library_item_ids = await self.mass.cache.get([0m
[30;1m472 | [0m[35m                "radio",[0m
[30;1m473 | [0m[35m                category=CACHE_CATEGORY_LIBRARY_ITEMS,[0m
[30;1m474 | [0m[35m                base_key=self.instance_id,[0m

[31m--[ [0m[34mMatch #[0m[33m1181[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/models/music_provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m454 | [0m[35m                extra_query=query, extra_query_params=query_params[0m
[30;1m455 | [0m[35m            )[0m
[30;1m456 | [0m[35m        if subpath == "tracks":[0m
[30;1m457 | [0m[35m            library_item_ids = await self.mass.cache.get([0m
[30;1m458 | [0m[35m                "track",[0m
[30;1m459 | [0m[35m                category=CACHE_CATEGORY_LIBRARY_ITEMS,[0m
[30;1m460 | [0m[35m                base_key=self.instance_id,[0m

[31m--[ [0m[34mMatch #[0m[33m1182[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/models/music_provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m440 | [0m[35m                extra_query_params=query_params,[0m
[30;1m441 | [0m[35m            )[0m
[30;1m442 | [0m[35m        if subpath == "albums":[0m
[30;1m443 | [0m[35m            library_item_ids = await self.mass.cache.get([0m
[30;1m444 | [0m[35m                "album",[0m
[30;1m445 | [0m[35m                category=CACHE_CATEGORY_LIBRARY_ITEMS,[0m
[30;1m446 | [0m[35m                base_key=self.instance_id,[0m

[31m--[ [0m[34mMatch #[0m[33m1183[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/models/music_provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m424 | [0m[35m        subpath = path.split("://", 1)[1][0m
[30;1m425 | [0m[35m        # this reference implementation can be overridden with a provider specific approach[0m
[30;1m426 | [0m[35m        if subpath == "artists":[0m
[30;1m427 | [0m[35m            library_item_ids = await self.mass.cache.get([0m
[30;1m428 | [0m[35m                "artist",[0m
[30;1m429 | [0m[35m                category=CACHE_CATEGORY_LIBRARY_ITEMS,[0m
[30;1m430 | [0m[35m                base_key=self.instance_id,[0m

[31m--[ [0m[34mMatch #[0m[33m1184[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/ffmpeg.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m358 | [0m[35m    else:[0m
[30;1m359 | [0m[35m        raise RuntimeError("Invalid/unsupported output format specified")[0m
[30;1m360 | [0m[35m[0m
[30;1m361 | [0m[35m    # append (final) output path at the end of the args[0m
[30;1m362 | [0m[35m    output_args.append(output_path)[0m
[30;1m363 | [0m[35m[0m
[30;1m364 | [0m[35m    # edge case: source file is not stereo - downmix to stereo[0m

[31m--[ [0m[34mMatch #[0m[33m1185[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/ffmpeg.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m293 | [0m[35m        if input_format.codec_type != ContentType.UNKNOWN:[0m
[30;1m294 | [0m[35m            input_args += ["-acodec", input_format.codec_type.name.lower()][0m
[30;1m295 | [0m[35m[0m
[30;1m296 | [0m[35m        # add input path at the end[0m
[30;1m297 | [0m[35m        input_args += ["-i", input_path][0m
[30;1m298 | [0m[35m[0m
[30;1m299 | [0m[35m    # collect output args[0m

[31m--[ [0m[34mMatch #[0m[33m1186[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/ffmpeg.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mimport asyncio[0m
[30;1m6 | [0m[35mimport logging[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35mfrom collections import deque[0m
[30;1m9 | [0m[35mfrom collections.abc import AsyncGenerator[0m
[30;1m10 | [0m[35mfrom contextlib import suppress[0m
[30;1m11 | [0m[35mfrom typing import TYPE_CHECKING, Final[0m

[31m--[ [0m[34mMatch #[0m[33m1187[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/raop.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m396 | [0m[35m    async def _stderr_reader(self) -> None:[0m
[30;1m397 | [0m[35m        """Monitor stderr for the running CLIRaop process."""[0m
[30;1m398 | [0m[35m        airplay_player = self.airplay_player[0m
[30;1m399 | [0m[35m        mass_player = self.mass.players.get(airplay_player.player_id)[0m
[30;1m400 | [0m[35m        if not mass_player or not mass_player.active_source:[0m
[30;1m401 | [0m[35m            return[0m
[30;1m402 | [0m[35m        queue = self.mass.player_queues.get_active_queue(mass_player.active_source)[0m

[31m--[ [0m[34mMatch #[0m[33m1188[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/raop.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m370 | [0m[35m            ),[0m
[30;1m371 | [0m[35m        )[0m
[30;1m372 | [0m[35m        self._stream_bytes_sent = 0[0m
[30;1m373 | [0m[35m        mass_player = self.mass.players.get(self.airplay_player.player_id)[0m
[30;1m374 | [0m[35m        assert mass_player  # for type checker[0m
[30;1m375 | [0m[35m        await self._ffmpeg_proc.start()[0m
[30;1m376 | [0m[35m        chunksize = get_chunksize(AIRPLAY_PCM_FORMAT)[0m

[31m--[ [0m[34mMatch #[0m[33m1189[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/raop.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m230 | [0m[35m        if self.mass.config.get_raw_player_config_value(player_id, CONF_ALAC_ENCODE, True):[0m
[30;1m231 | [0m[35m            extra_args += ["-alac"][0m
[30;1m232 | [0m[35m        for prop in ("et", "md", "am", "pk", "pw"):[0m
[30;1m233 | [0m[35m            if prop_value := self.airplay_player.discovery_info.decoded_properties.get(prop):[0m
[30;1m234 | [0m[35m                extra_args += [f"-{prop}", prop_value][0m
[30;1m235 | [0m[35m        sync_adjust = self.mass.config.get_raw_player_config_value(player_id, CONF_SYNC_ADJUST, 0)[0m
[30;1m236 | [0m[35m        assert isinstance(sync_adjust, int)[0m

[31m--[ [0m[34mMatch #[0m[33m1190[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/raop.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m216 | [0m[35m        assert self.prov.cliraop_bin[0m
[30;1m217 | [0m[35m        extra_args: list[str] = [][0m
[30;1m218 | [0m[35m        player_id = self.airplay_player.player_id[0m
[30;1m219 | [0m[35m        mass_player = self.mass.players.get(player_id)[0m
[30;1m220 | [0m[35m        if not mass_player:[0m
[30;1m221 | [0m[35m            return[0m
[30;1m222 | [0m[35m        bind_ip = str([0m

[31m--[ [0m[34mMatch #[0m[33m1191[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/raop.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m489 | [0m[35m                album = _album.name[0m
[30;1m490 | [0m[35m[0m
[30;1m491 | [0m[35m        cmd = f"TITLE={title or 'Music Assistant'}\nARTIST={artist}\nALBUM={album}\n"[0m
[30;1m492 | [0m[35m        cmd += f"DURATION={duration}\nPROGRESS=0\nACTION=SENDMETA\n"[0m
[30;1m493 | [0m[35m[0m
[30;1m494 | [0m[35m        await self.send_cli_command(cmd)[0m
[30;1m495 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1192[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/raop.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m488 | [0m[35m            if _album := getattr(media_item, "album", None):[0m
[30;1m489 | [0m[35m                album = _album.name[0m
[30;1m490 | [0m[35m[0m
[30;1m491 | [0m[35m        cmd = f"TITLE={title or 'Music Assistant'}\nARTIST={artist}\nALBUM={album}\n"[0m
[30;1m492 | [0m[35m        cmd += f"DURATION={duration}\nPROGRESS=0\nACTION=SENDMETA\n"[0m
[30;1m493 | [0m[35m[0m
[30;1m494 | [0m[35m        await self.send_cli_command(cmd)[0m

[31m--[ [0m[34mMatch #[0m[33m1193[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/raop.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m385 | [0m[35m            self._stream_bytes_sent += len(chunk)[0m
[30;1m386 | [0m[35m            self._total_bytes_sent += len(chunk)[0m
[30;1m387 | [0m[35m            del chunk[0m
[30;1m388 | [0m[35m            # we base elapsed time on the amount of bytes sent[0m
[30;1m389 | [0m[35m            # so we can account for reusing the same session for multiple streams[0m
[30;1m390 | [0m[35m            mass_player.elapsed_time = self._stream_bytes_sent / chunksize[0m
[30;1m391 | [0m[35m            mass_player.elapsed_time_last_updated = time.time()[0m

[31m--[ [0m[34mMatch #[0m[33m1194[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/raop.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m293 | [0m[35m                    self._ffmpeg_reader_task.cancel()[0m
[30;1m294 | [0m[35m                raise PlayerCommandFailed("Cannot connect to AirPlay device")[0m
[30;1m295 | [0m[35m        # repeat sending the volume level to the player because some players seem[0m
[30;1m296 | [0m[35m        # to ignore it the first time[0m
[30;1m297 | [0m[35m        # https://github.com/music-assistant/support/issues/3330[0m
[30;1m298 | [0m[35m        await self.send_cli_command(f"VOLUME={mass_player.volume_level}\n")[0m
[30;1m299 | [0m[35m        # start reading the stderr of the cliraop process from another task[0m
[30;1m300 | [0m[35m        self._stderr_reader_task = self.mass.create_task(self._stderr_reader())[0m

[31m--[ [0m[34mMatch #[0m[33m1195[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/raop.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m254 | [0m[35m        # https://github.com/music-assistant/libraop[0m
[30;1m255 | [0m[35m        # we use this intermediate binary to do the actual streaming because attempts to do[0m
[30;1m256 | [0m[35m        # so using pure python (e.g. pyatv) were not successful due to the realtime nature[0m
[30;1m257 | [0m[35m        # TODO: Either enhance libraop with airplay 2 support or find a better alternative[0m
[30;1m258 | [0m[35m        cliraop_args = [[0m
[30;1m259 | [0m[35m            self.prov.cliraop_bin,[0m
[30;1m260 | [0m[35m            "-ntpstart",[0m

[31m--[ [0m[34mMatch #[0m[33m1196[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/airplay/raop.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35mimport logging[0m
[30;1m7 | [0m[35mimport os[0m
[30;1m8 | [0m[35mimport platform[0m
[30;1m9 | [0m[35mimport time[0m
[30;1m10 | [0m[35mfrom collections.abc import AsyncGenerator[0m
[30;1m11 | [0m[35mfrom contextlib import suppress[0m
[30;1m12 | [0m[35mfrom random import randint[0m
[30;1m13 | [0m[35mfrom typing import TYPE_CHECKING[0m

[31m--[ [0m[34mMatch #[0m[33m1197[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/models/player_provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m165 | [0m[35m        if ([0m
[30;1m166 | [0m[35m            "enabled" in changed_keys[0m
[30;1m167 | [0m[35m            and config.enabled[0m
[30;1m168 | [0m[35m            and not self.mass.players.get(config.player_id)[0m
[30;1m169 | [0m[35m        ):[0m
[30;1m170 | [0m[35m            # if a player gets enabled, trigger discovery[0m
[30;1m171 | [0m[35m            task_id = f"discover_players_{self.instance_id}"[0m

[31m--[ [0m[34mMatch #[0m[33m1198[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/models/player_provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m            CONF_ENTRY_VOLUME_NORMALIZATION_TARGET,[0m
[30;1m78 | [0m[35m            CONF_ENTRY_TTS_PRE_ANNOUNCE,[0m
[30;1m79 | [0m[35m        )[0m
[30;1m80 | [0m[35m        if not (player := self.mass.players.get(player_id)):[0m
[30;1m81 | [0m[35m            return base_entries[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m        if PlayerFeature.GAPLESS_PLAYBACK not in player.supported_features:[0m

[31m--[ [0m[34mMatch #[0m[33m1199[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/models/player_provider.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m434 | [0m[35m                ],[0m
[30;1m435 | [0m[35m                category="player_controls",[0m
[30;1m436 | [0m[35m            ),[0m
[30;1m437 | [0m[35m            # Mute control config entry[0m
[30;1m438 | [0m[35m            ConfigEntry([0m
[30;1m439 | [0m[35m                key=CONF_MUTE_CONTROL,[0m
[30;1m440 | [0m[35m                type=ConfigEntryType.STRING,[0m

[31m--[ [0m[34mMatch #[0m[33m1200[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/models/player_provider.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m421 | [0m[35m                ],[0m
[30;1m422 | [0m[35m                category="player_controls",[0m
[30;1m423 | [0m[35m            ),[0m
[30;1m424 | [0m[35m            # Volume control config entry[0m
[30;1m425 | [0m[35m            ConfigEntry([0m
[30;1m426 | [0m[35m                key=CONF_VOLUME_CONTROL,[0m
[30;1m427 | [0m[35m                type=ConfigEntryType.STRING,[0m

[31m--[ [0m[34mMatch #[0m[33m1201[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/models/player_provider.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m408 | [0m[35m            )[0m
[30;1m409 | [0m[35m        # return final config entries for all options[0m
[30;1m410 | [0m[35m        return ([0m
[30;1m411 | [0m[35m            # Power control config entry[0m
[30;1m412 | [0m[35m            ConfigEntry([0m
[30;1m413 | [0m[35m                key=CONF_POWER_CONTROL,[0m
[30;1m414 | [0m[35m                type=ConfigEntryType.STRING,[0m

[31m--[ [0m[34mMatch #[0m[33m1202[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/models/player_provider.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m382 | [0m[35m        supports_power = PlayerFeature.POWER in player.supported_features if player else False[0m
[30;1m383 | [0m[35m        supports_volume = PlayerFeature.VOLUME_SET in player.supported_features if player else False[0m
[30;1m384 | [0m[35m        supports_mute = PlayerFeature.VOLUME_MUTE in player.supported_features if player else False[0m
[30;1m385 | [0m[35m        # create base options per control type (and add defaults like native and fake)[0m
[30;1m386 | [0m[35m        base_power_options: list[ConfigValueOption] = [[0m
[30;1m387 | [0m[35m            ConfigValueOption(title="None", value=PLAYER_CONTROL_NONE),[0m
[30;1m388 | [0m[35m            ConfigValueOption(title="Fake power control", value=PLAYER_CONTROL_FAKE),[0m

[31m--[ [0m[34mMatch #[0m[33m1203[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/models/player_provider.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m154 | [0m[35m                if player and player.expose_to_ha_by_default[0m
[30;1m155 | [0m[35m                else CONF_ENTRY_EXPOSE_PLAYER_TO_HA_DEFAULT_DISABLED[0m
[30;1m156 | [0m[35m            ),[0m
[30;1m157 | [0m[35m            # add player control entries[0m
[30;1m158 | [0m[35m            *self._create_player_control_config_entries(player),[0m
[30;1m159 | [0m[35m            CONF_ENTRY_AUTO_PLAY,[0m
[30;1m160 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1204[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/models/player_provider.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m133 | [0m[35m                if player and player.expose_to_ha_by_default[0m
[30;1m134 | [0m[35m                else CONF_ENTRY_EXPOSE_PLAYER_TO_HA_DEFAULT_DISABLED[0m
[30;1m135 | [0m[35m            ),[0m
[30;1m136 | [0m[35m            # add player control entries[0m
[30;1m137 | [0m[35m            *self._create_player_control_config_entries(player),[0m
[30;1m138 | [0m[35m            CONF_ENTRY_AUTO_PLAY,[0m
[30;1m139 | [0m[35m            CONF_ENTRY_SAMPLE_RATES,[0m

[31m--[ [0m[34mMatch #[0m[33m1205[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/models/player_provider.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m109 | [0m[35m                    type=ConfigEntryType.STRING,[0m
[30;1m110 | [0m[35m                    label=CONF_MUTE_CONTROL,[0m
[30;1m111 | [0m[35m                    # disable mute control for group players for now[0m
[30;1m112 | [0m[35m                    # TODO: work out if all child players support mute control[0m
[30;1m113 | [0m[35m                    default_value=PLAYER_CONTROL_NONE,[0m
[30;1m114 | [0m[35m                    hidden=True,[0m
[30;1m115 | [0m[35m                ),[0m
[30;1m116 | [0m[35m                CONF_ENTRY_AUTO_PLAY,[0m

[31m--[ [0m[34mMatch #[0m[33m1206[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/models/player_provider.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m108 | [0m[35m                    key=CONF_MUTE_CONTROL,[0m
[30;1m109 | [0m[35m                    type=ConfigEntryType.STRING,[0m
[30;1m110 | [0m[35m                    label=CONF_MUTE_CONTROL,[0m
[30;1m111 | [0m[35m                    # disable mute control for group players for now[0m
[30;1m112 | [0m[35m                    # TODO: work out if all child players support mute control[0m
[30;1m113 | [0m[35m                    default_value=PLAYER_CONTROL_NONE,[0m
[30;1m114 | [0m[35m                    hidden=True,[0m

[31m--[ [0m[34mMatch #[0m[33m1207[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/models/player_provider.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m89 | [0m[35m                *base_entries,[0m
[30;1m90 | [0m[35m                CONF_ENTRY_PLAYER_ICON_GROUP,[0m
[30;1m91 | [0m[35m                CONF_ENTRY_HIDE_PLAYER_IN_UI_GROUP_PLAYER,[0m
[30;1m92 | [0m[35m                # add player control entries as hidden entries[0m
[30;1m93 | [0m[35m                ConfigEntry([0m
[30;1m94 | [0m[35m                    key=CONF_POWER_CONTROL,[0m
[30;1m95 | [0m[35m                    type=ConfigEntryType.STRING,[0m

[31m--[ [0m[34mMatch #[0m[33m1208[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/webserver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m408 | [0m[35m        # Exceptions if Socket disconnected or cancelled by connection handler[0m
[30;1m409 | [0m[35m        with suppress(RuntimeError, ConnectionResetError, *CANCELLATION_ERRORS):[0m
[30;1m410 | [0m[35m            while not self.wsock.closed:[0m
[30;1m411 | [0m[35m                if (process := await self._to_write.get()) is None:[0m
[30;1m412 | [0m[35m                    break[0m
[30;1m413 | [0m[35m[0m
[30;1m414 | [0m[35m                if not isinstance(process, str):[0m

[31m--[ [0m[34mMatch #[0m[33m1209[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/webserver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m359 | [0m[35m        self._logger.debug("Handling command %s", msg.command)[0m
[30;1m360 | [0m[35m[0m
[30;1m361 | [0m[35m        # work out handler for the given path/command[0m
[30;1m362 | [0m[35m        handler = self.mass.command_handlers.get(msg.command)[0m
[30;1m363 | [0m[35m[0m
[30;1m364 | [0m[35m        if handler is None:[0m
[30;1m365 | [0m[35m            self._send_message([0m

[31m--[ [0m[34mMatch #[0m[33m1210[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/webserver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m241 | [0m[35m            return web.Response(status=400, text=error)[0m
[30;1m242 | [0m[35m[0m
[30;1m243 | [0m[35m        # work out handler for the given path/command[0m
[30;1m244 | [0m[35m        handler = self.mass.command_handlers.get(command_msg.command)[0m
[30;1m245 | [0m[35m        if handler is None:[0m
[30;1m246 | [0m[35m            error = f"Invalid Command: {command_msg.command}"[0m
[30;1m247 | [0m[35m            self.logger.error("Unhandled JSONRPC API error: %s", error)[0m

[31m--[ [0m[34mMatch #[0m[33m1211[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/webserver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m219 | [0m[35m[0m
[30;1m220 | [0m[35m    async def _handle_ws_client(self, request: web.Request) -> web.WebSocketResponse:[0m
[30;1m221 | [0m[35m        connection = WebsocketClientHandler(self, request)[0m
[30;1m222 | [0m[35m        if lang := request.headers.get("Accept-Language"):[0m
[30;1m223 | [0m[35m            self.mass.metadata.set_default_preferred_language(lang.split(",")[0])[0m
[30;1m224 | [0m[35m        try:[0m
[30;1m225 | [0m[35m            self.clients.add(connection)[0m

[31m--[ [0m[34mMatch #[0m[33m1212[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/webserver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m178 | [0m[35m                bind_ip = "0.0.0.0"[0m
[30;1m179 | [0m[35m                self.publish_ip = default_publish_ip[0m
[30;1m180 | [0m[35m            else:[0m
[30;1m181 | [0m[35m                # use internal ("172.30.32.) IP[0m
[30;1m182 | [0m[35m                self.publish_ip = bind_ip = next([0m
[30;1m183 | [0m[35m                    (x for x in all_ip_addresses if x.startswith("172.30.32.")), default_publish_ip[0m
[30;1m184 | [0m[35m                )[0m
[30;1m185 | [0m[35m            base_url = f"http://{self.publish_ip}:{self.publish_port}"[0m

[31m--[ [0m[34mMatch #[0m[33m1213[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/webserver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m169 | [0m[35m        default_publish_ip = all_ip_addresses[0][0m
[30;1m170 | [0m[35m        if self.mass.running_as_hass_addon:[0m
[30;1m171 | [0m[35m            # if we're running on the HA supervisor the webserver is secured by HA ingress[0m
[30;1m172 | [0m[35m            # we only start the webserver on the internal docker network and ingress connects[0m
[30;1m173 | [0m[35m            # to that internally and exposes the webUI securely[0m
[30;1m174 | [0m[35m            # if a user also wants to expose a the webserver non securely on his internal[0m
[30;1m175 | [0m[35m            # network he/she should explicitly do so (and know the risks)[0m

[31m--[ [0m[34mMatch #[0m[33m1214[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/webserver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m160 | [0m[35m        routes.append(("GET", "/ws", self._handle_ws_client))[0m
[30;1m161 | [0m[35m        # also host the image proxy on the webserver[0m
[30;1m162 | [0m[35m        routes.append(("GET", "/imageproxy", self.mass.metadata.handle_imageproxy))[0m
[30;1m163 | [0m[35m        # also host the audio preview service[0m
[30;1m164 | [0m[35m        routes.append(("GET", "/preview", self.serve_preview_stream))[0m
[30;1m165 | [0m[35m        # add jsonrpc api[0m
[30;1m166 | [0m[35m        routes.append(("POST", "/api", self._handle_jsonrpc_api_command))[0m
[30;1m167 | [0m[35m        # start the webserver[0m

[31m--[ [0m[34mMatch #[0m[33m1215[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/webserver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m91 | [0m[35m                    description="By default the Music Assistant webserver "[0m
[30;1m92 | [0m[35m                    "(serving the API and frontend), runs on a protected internal network only "[0m
[30;1m93 | [0m[35m                    "and you can securely access the webinterface using "[0m
[30;1m94 | [0m[35m                    "Home Assistant's ingress service from the sidebar menu.\n\n"[0m
[30;1m95 | [0m[35m                    "By enabling this option you also allow direct access to the webserver "[0m
[30;1m96 | [0m[35m                    "from your local network, meaning you can navigate to "[0m
[30;1m97 | [0m[35m                    f"http://{default_publish_ip}:8095 to access the webinterface. \n\n"[0m

[31m--[ [0m[34mMatch #[0m[33m1216[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/json.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m"""Helpers to work with (de)serializing of json."""[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport asyncio[0m
[30;1m4 | [0m[35mimport base64[0m
[30;1m5 | [0m[35mfrom _collections_abc import dict_keys, dict_values[0m
[30;1m6 | [0m[35mfrom types import MethodType[0m
[30;1m7 | [0m[35mfrom typing import Any, TypeVar[0m
[30;1m8 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1217[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m575 | [0m[35m            result["albumartistsort"] = tags["TSO2"].text[0m
[30;1m576 | [0m[35m        if tags.get("TSOT"):[0m
[30;1m577 | [0m[35m            result["titlesort"] = tags["TSOT"].text[0][0m
[30;1m578 | [0m[35m        if tags.get("TSOA"):[0m
[30;1m579 | [0m[35m            result["albumsort"] = tags["TSOA"].text[0][0m
[30;1m580 | [0m[35m[0m
[30;1m581 | [0m[35m        del tags[0m

[31m--[ [0m[34mMatch #[0m[33m1218[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m573 | [0m[35m            result["artistsort"] = tags["TSOP"].text[0m
[30;1m574 | [0m[35m        if "TSO2" in tags:[0m
[30;1m575 | [0m[35m            result["albumartistsort"] = tags["TSO2"].text[0m
[30;1m576 | [0m[35m        if tags.get("TSOT"):[0m
[30;1m577 | [0m[35m            result["titlesort"] = tags["TSOT"].text[0][0m
[30;1m578 | [0m[35m        if tags.get("TSOA"):[0m
[30;1m579 | [0m[35m            result["albumsort"] = tags["TSOA"].text[0][0m

[31m--[ [0m[34mMatch #[0m[33m1219[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m471 | [0m[35m        if not tags.duration and file_size and tags.bit_rate:[0m
[30;1m472 | [0m[35m            # estimate duration from filesize/bitrate[0m
[30;1m473 | [0m[35m            tags.duration = int((file_size * 8) / tags.bit_rate)[0m
[30;1m474 | [0m[35m        if not tags.duration and tags.raw.get("format", {}).get("duration"):[0m
[30;1m475 | [0m[35m            tags.duration = float(tags.raw["format"]["duration"])[0m
[30;1m476 | [0m[35m[0m
[30;1m477 | [0m[35m        if not tags.duration and require_duration:[0m

[31m--[ [0m[34mMatch #[0m[33m1220[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m471 | [0m[35m        if not tags.duration and file_size and tags.bit_rate:[0m
[30;1m472 | [0m[35m            # estimate duration from filesize/bitrate[0m
[30;1m473 | [0m[35m            tags.duration = int((file_size * 8) / tags.bit_rate)[0m
[30;1m474 | [0m[35m        if not tags.duration and tags.raw.get("format", {}).get("duration"):[0m
[30;1m475 | [0m[35m            tags.duration = float(tags.raw["format"]["duration"])[0m
[30;1m476 | [0m[35m[0m
[30;1m477 | [0m[35m        if not tags.duration and require_duration:[0m

[31m--[ [0m[34mMatch #[0m[33m1221[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m462 | [0m[35m        data = json.loads(res)[0m
[30;1m463 | [0m[35m        if error := data.get("error"):[0m
[30;1m464 | [0m[35m            raise InvalidDataError(error["string"])[0m
[30;1m465 | [0m[35m        if not data.get("streams"):[0m
[30;1m466 | [0m[35m            msg = "Not an audio file"[0m
[30;1m467 | [0m[35m            raise InvalidDataError(msg)[0m
[30;1m468 | [0m[35m        tags = AudioTags.parse(data)[0m

[31m--[ [0m[34mMatch #[0m[33m1222[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m460 | [0m[35m    try:[0m
[30;1m461 | [0m[35m        res = subprocess.check_output(args)  # noqa: S603[0m
[30;1m462 | [0m[35m        data = json.loads(res)[0m
[30;1m463 | [0m[35m        if error := data.get("error"):[0m
[30;1m464 | [0m[35m            raise InvalidDataError(error["string"])[0m
[30;1m465 | [0m[35m        if not data.get("streams"):[0m
[30;1m466 | [0m[35m            msg = "Not an audio file"[0m

[31m--[ [0m[34mMatch #[0m[33m1223[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m423 | [0m[35m[0m
[30;1m424 | [0m[35m    def get(self, key: str, default=None) -> Any:[0m
[30;1m425 | [0m[35m        """Get tag by key."""[0m
[30;1m426 | [0m[35m        return self.tags.get(key, default)[0m
[30;1m427 | [0m[35m[0m
[30;1m428 | [0m[35m[0m
[30;1m429 | [0m[35masync def async_parse_tags([0m

[31m--[ [0m[34mMatch #[0m[33m1224[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m415 | [0m[35m            ),[0m
[30;1m416 | [0m[35m            format=raw["format"]["format_name"],[0m
[30;1m417 | [0m[35m            bit_rate=int(raw["format"].get("bit_rate", 0)) or None,[0m
[30;1m418 | [0m[35m            duration=float(raw["format"].get("duration", 0)) or None,[0m
[30;1m419 | [0m[35m            tags=tags,[0m
[30;1m420 | [0m[35m            has_cover_image=has_cover_image,[0m
[30;1m421 | [0m[35m            filename=raw["format"]["filename"],[0m

[31m--[ [0m[34mMatch #[0m[33m1225[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m414 | [0m[35m                audio_stream.get("bits_per_raw_sample", audio_stream.get("bits_per_sample")) or 16[0m
[30;1m415 | [0m[35m            ),[0m
[30;1m416 | [0m[35m            format=raw["format"]["format_name"],[0m
[30;1m417 | [0m[35m            bit_rate=int(raw["format"].get("bit_rate", 0)) or None,[0m
[30;1m418 | [0m[35m            duration=float(raw["format"].get("duration", 0)) or None,[0m
[30;1m419 | [0m[35m            tags=tags,[0m
[30;1m420 | [0m[35m            has_cover_image=has_cover_image,[0m

[31m--[ [0m[34mMatch #[0m[33m1226[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m411 | [0m[35m            sample_rate=int(audio_stream.get("sample_rate", 44100)),[0m
[30;1m412 | [0m[35m            channels=audio_stream.get("channels", 2),[0m
[30;1m413 | [0m[35m            bits_per_sample=int([0m
[30;1m414 | [0m[35m                audio_stream.get("bits_per_raw_sample", audio_stream.get("bits_per_sample")) or 16[0m
[30;1m415 | [0m[35m            ),[0m
[30;1m416 | [0m[35m            format=raw["format"]["format_name"],[0m
[30;1m417 | [0m[35m            bit_rate=int(raw["format"].get("bit_rate", 0)) or None,[0m

[31m--[ [0m[34mMatch #[0m[33m1227[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m411 | [0m[35m            sample_rate=int(audio_stream.get("sample_rate", 44100)),[0m
[30;1m412 | [0m[35m            channels=audio_stream.get("channels", 2),[0m
[30;1m413 | [0m[35m            bits_per_sample=int([0m
[30;1m414 | [0m[35m                audio_stream.get("bits_per_raw_sample", audio_stream.get("bits_per_sample")) or 16[0m
[30;1m415 | [0m[35m            ),[0m
[30;1m416 | [0m[35m            format=raw["format"]["format_name"],[0m
[30;1m417 | [0m[35m            bit_rate=int(raw["format"].get("bit_rate", 0)) or None,[0m

[31m--[ [0m[34mMatch #[0m[33m1228[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m409 | [0m[35m        return AudioTags([0m
[30;1m410 | [0m[35m            raw=raw,[0m
[30;1m411 | [0m[35m            sample_rate=int(audio_stream.get("sample_rate", 44100)),[0m
[30;1m412 | [0m[35m            channels=audio_stream.get("channels", 2),[0m
[30;1m413 | [0m[35m            bits_per_sample=int([0m
[30;1m414 | [0m[35m                audio_stream.get("bits_per_raw_sample", audio_stream.get("bits_per_sample")) or 16[0m
[30;1m415 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m1229[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m408 | [0m[35m[0m
[30;1m409 | [0m[35m        return AudioTags([0m
[30;1m410 | [0m[35m            raw=raw,[0m
[30;1m411 | [0m[35m            sample_rate=int(audio_stream.get("sample_rate", 44100)),[0m
[30;1m412 | [0m[35m            channels=audio_stream.get("channels", 2),[0m
[30;1m413 | [0m[35m            bits_per_sample=int([0m
[30;1m414 | [0m[35m                audio_stream.get("bits_per_raw_sample", audio_stream.get("bits_per_sample")) or 16[0m

[31m--[ [0m[34mMatch #[0m[33m1230[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m400 | [0m[35m        for stream in [raw["format"]] + raw["streams"]:[0m
[30;1m401 | [0m[35m            if stream.get("codec_type") == "video":[0m
[30;1m402 | [0m[35m                continue[0m
[30;1m403 | [0m[35m            for key, value in stream.get("tags", {}).items():[0m
[30;1m404 | [0m[35m                alt_key = key.lower().replace(" ", "").replace("_", "").replace("-", "")[0m
[30;1m405 | [0m[35m                if alt_key in tags:[0m
[30;1m406 | [0m[35m                    continue[0m

[31m--[ [0m[34mMatch #[0m[33m1231[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m398 | [0m[35m        # append any tags found in streams (but don't overwrite format tags)[0m
[30;1m399 | [0m[35m        tags = {}[0m
[30;1m400 | [0m[35m        for stream in [raw["format"]] + raw["streams"]:[0m
[30;1m401 | [0m[35m            if stream.get("codec_type") == "video":[0m
[30;1m402 | [0m[35m                continue[0m
[30;1m403 | [0m[35m            for key, value in stream.get("tags", {}).items():[0m
[30;1m404 | [0m[35m                alt_key = key.lower().replace(" ", "").replace("_", "").replace("-", "")[0m

[31m--[ [0m[34mMatch #[0m[33m1232[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m391 | [0m[35m            msg = "No audio stream found"[0m
[30;1m392 | [0m[35m            raise InvalidDataError(msg)[0m
[30;1m393 | [0m[35m        has_cover_image = any([0m
[30;1m394 | [0m[35m            x for x in raw["streams"] if x.get("codec_name", "") in ("mjpeg", "png")[0m
[30;1m395 | [0m[35m        )[0m
[30;1m396 | [0m[35m        # convert all tag-keys (gathered from all streams) to lowercase without spaces[0m
[30;1m397 | [0m[35m        # prefer format as that contains the actual ID3 tags[0m

[31m--[ [0m[34mMatch #[0m[33m1233[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m379 | [0m[35m        """Try to read/calculate the integrated loudness from the tags (album level)."""[0m
[30;1m380 | [0m[35m        if tag := self.tags.get("r128albumgain"):[0m
[30;1m381 | [0m[35m            return -23 - float(int(tag.split(" ")[0]) / 256)[0m
[30;1m382 | [0m[35m        if (tag := self.tags.get("replaygainalbumgain")) is not None:[0m
[30;1m383 | [0m[35m            return -18 - float(tag.split(" ")[0])[0m
[30;1m384 | [0m[35m        return None[0m
[30;1m385 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1234[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m377 | [0m[35m    @property[0m
[30;1m378 | [0m[35m    def track_album_loudness(self) -> float | None:[0m
[30;1m379 | [0m[35m        """Try to read/calculate the integrated loudness from the tags (album level)."""[0m
[30;1m380 | [0m[35m        if tag := self.tags.get("r128albumgain"):[0m
[30;1m381 | [0m[35m            return -23 - float(int(tag.split(" ")[0]) / 256)[0m
[30;1m382 | [0m[35m        if (tag := self.tags.get("replaygainalbumgain")) is not None:[0m
[30;1m383 | [0m[35m            return -18 - float(tag.split(" ")[0])[0m

[31m--[ [0m[34mMatch #[0m[33m1235[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m370 | [0m[35m        """Try to read/calculate the integrated loudness from the tags."""[0m
[30;1m371 | [0m[35m        if (tag := self.tags.get("r128trackgain")) is not None:[0m
[30;1m372 | [0m[35m            return -23 - float(int(tag.split(" ")[0]) / 256)[0m
[30;1m373 | [0m[35m        if (tag := self.tags.get("replaygaintrackgain")) is not None:[0m
[30;1m374 | [0m[35m            return -18 - float(tag.split(" ")[0])[0m
[30;1m375 | [0m[35m        return None[0m
[30;1m376 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1236[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m368 | [0m[35m    @property[0m
[30;1m369 | [0m[35m    def track_loudness(self) -> float | None:[0m
[30;1m370 | [0m[35m        """Try to read/calculate the integrated loudness from the tags."""[0m
[30;1m371 | [0m[35m        if (tag := self.tags.get("r128trackgain")) is not None:[0m
[30;1m372 | [0m[35m            return -23 - float(int(tag.split(" ")[0]) / 256)[0m
[30;1m373 | [0m[35m        if (tag := self.tags.get("replaygaintrackgain")) is not None:[0m
[30;1m374 | [0m[35m            return -18 - float(tag.split(" ")[0])[0m

[31m--[ [0m[34mMatch #[0m[33m1237[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m352 | [0m[35m                        chapter_id=chapter_data["id"],[0m
[30;1m353 | [0m[35m                        position_start=chapter_data["start_time"],[0m
[30;1m354 | [0m[35m                        position_end=chapter_data["end_time"],[0m
[30;1m355 | [0m[35m                        title=chapter_data.get("tags", {}).get("title"),[0m
[30;1m356 | [0m[35m                    )[0m
[30;1m357 | [0m[35m                )[0m
[30;1m358 | [0m[35m        return chapters[0m

[31m--[ [0m[34mMatch #[0m[33m1238[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m352 | [0m[35m                        chapter_id=chapter_data["id"],[0m
[30;1m353 | [0m[35m                        position_start=chapter_data["start_time"],[0m
[30;1m354 | [0m[35m                        position_end=chapter_data["end_time"],[0m
[30;1m355 | [0m[35m                        title=chapter_data.get("tags", {}).get("title"),[0m
[30;1m356 | [0m[35m                    )[0m
[30;1m357 | [0m[35m                )[0m
[30;1m358 | [0m[35m        return chapters[0m

[31m--[ [0m[34mMatch #[0m[33m1239[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m345 | [0m[35m    def chapters(self) -> list[AudioTagsChapter]:[0m
[30;1m346 | [0m[35m        """Return chapters in MediaItem (if any)."""[0m
[30;1m347 | [0m[35m        chapters: list[AudioTagsChapter] = [][0m
[30;1m348 | [0m[35m        if raw_chapters := self.raw.get("chapters"):[0m
[30;1m349 | [0m[35m            for chapter_data in raw_chapters:[0m
[30;1m350 | [0m[35m                chapters.append([0m
[30;1m351 | [0m[35m                    AudioTagsChapter([0m

[31m--[ [0m[34mMatch #[0m[33m1240[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m331 | [0m[35m    def barcode(self) -> str | None:[0m
[30;1m332 | [0m[35m        """Return barcode (upc/ean) tag(s)."""[0m
[30;1m333 | [0m[35m        for tag_name in ("barcode", "upc", "ean"):[0m
[30;1m334 | [0m[35m            if tag := self.tags.get(tag_name):[0m
[30;1m335 | [0m[35m                # sometimes the field contains multiple values[0m
[30;1m336 | [0m[35m                # we only need one[0m
[30;1m337 | [0m[35m                for item in split_items(tag, True):[0m

[31m--[ [0m[34mMatch #[0m[33m1241[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m322 | [0m[35m    def isrc(self) -> tuple[str]:[0m
[30;1m323 | [0m[35m        """Return isrc tag(s)."""[0m
[30;1m324 | [0m[35m        for tag_name in ("isrc", "tsrc"):[0m
[30;1m325 | [0m[35m            if tag := self.tags.get(tag_name):[0m
[30;1m326 | [0m[35m                # sometimes the field contains multiple values[0m
[30;1m327 | [0m[35m                return split_items(tag, True)[0m
[30;1m328 | [0m[35m        return ()[0m

[31m--[ [0m[34mMatch #[0m[33m1242[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m301 | [0m[35m        tag = ([0m
[30;1m302 | [0m[35m            self.tags.get("musicbrainzalbumtype")[0m
[30;1m303 | [0m[35m            or self.tags.get("albumtype")[0m
[30;1m304 | [0m[35m            or self.tags.get("releasetype")[0m
[30;1m305 | [0m[35m        )[0m
[30;1m306 | [0m[35m        if tag is None:[0m
[30;1m307 | [0m[35m            return AlbumType.UNKNOWN[0m

[31m--[ [0m[34mMatch #[0m[33m1243[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m300 | [0m[35m            return AlbumType.COMPILATION[0m
[30;1m301 | [0m[35m        tag = ([0m
[30;1m302 | [0m[35m            self.tags.get("musicbrainzalbumtype")[0m
[30;1m303 | [0m[35m            or self.tags.get("albumtype")[0m
[30;1m304 | [0m[35m            or self.tags.get("releasetype")[0m
[30;1m305 | [0m[35m        )[0m
[30;1m306 | [0m[35m        if tag is None:[0m

[31m--[ [0m[34mMatch #[0m[33m1244[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m299 | [0m[35m        if self.tags.get("compilation", "") == "1":[0m
[30;1m300 | [0m[35m            return AlbumType.COMPILATION[0m
[30;1m301 | [0m[35m        tag = ([0m
[30;1m302 | [0m[35m            self.tags.get("musicbrainzalbumtype")[0m
[30;1m303 | [0m[35m            or self.tags.get("albumtype")[0m
[30;1m304 | [0m[35m            or self.tags.get("releasetype")[0m
[30;1m305 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1245[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m296 | [0m[35m    @property[0m
[30;1m297 | [0m[35m    def album_type(self) -> AlbumType:[0m
[30;1m298 | [0m[35m        """Return albumtype tag if present."""[0m
[30;1m299 | [0m[35m        if self.tags.get("compilation", "") == "1":[0m
[30;1m300 | [0m[35m            return AlbumType.COMPILATION[0m
[30;1m301 | [0m[35m        tag = ([0m
[30;1m302 | [0m[35m            self.tags.get("musicbrainzalbumtype")[0m

[31m--[ [0m[34mMatch #[0m[33m1246[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m291 | [0m[35m    @property[0m
[30;1m292 | [0m[35m    def album_artist_sort_names(self) -> tuple[str, ...]:[0m
[30;1m293 | [0m[35m        """Return artist sort name tag(s) if present."""[0m
[30;1m294 | [0m[35m        return split_items(self.tags.get("albumartistsort"), False)[0m
[30;1m295 | [0m[35m[0m
[30;1m296 | [0m[35m    @property[0m
[30;1m297 | [0m[35m    def album_type(self) -> AlbumType:[0m

[31m--[ [0m[34mMatch #[0m[33m1247[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m286 | [0m[35m    @property[0m
[30;1m287 | [0m[35m    def artist_sort_names(self) -> tuple[str, ...]:[0m
[30;1m288 | [0m[35m        """Return artist sort name tag(s) if present."""[0m
[30;1m289 | [0m[35m        return split_items(self.tags.get("artistsort"), False)[0m
[30;1m290 | [0m[35m[0m
[30;1m291 | [0m[35m    @property[0m
[30;1m292 | [0m[35m    def album_artist_sort_names(self) -> tuple[str, ...]:[0m

[31m--[ [0m[34mMatch #[0m[33m1248[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m279 | [0m[35m    @property[0m
[30;1m280 | [0m[35m    def album_sort(self) -> str | None:[0m
[30;1m281 | [0m[35m        """Return album sort title tag (if exists)."""[0m
[30;1m282 | [0m[35m        if tag := self.tags.get("albumsort"):[0m
[30;1m283 | [0m[35m            return tag[0m
[30;1m284 | [0m[35m        return None[0m
[30;1m285 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1249[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m272 | [0m[35m    @property[0m
[30;1m273 | [0m[35m    def title_sort(self) -> str | None:[0m
[30;1m274 | [0m[35m        """Return sort title tag (if exists)."""[0m
[30;1m275 | [0m[35m        if tag := self.tags.get("titlesort"):[0m
[30;1m276 | [0m[35m            return tag[0m
[30;1m277 | [0m[35m        return None[0m
[30;1m278 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1250[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m267 | [0m[35m            return tag[0m
[30;1m268 | [0m[35m        if tag := self.tags.get("musicbrainzrecordingid"):[0m
[30;1m269 | [0m[35m            return tag[0m
[30;1m270 | [0m[35m        return self.tags.get("musicbrainztrackid")[0m
[30;1m271 | [0m[35m[0m
[30;1m272 | [0m[35m    @property[0m
[30;1m273 | [0m[35m    def title_sort(self) -> str | None:[0m

[31m--[ [0m[34mMatch #[0m[33m1251[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m265 | [0m[35m            return tag[0m
[30;1m266 | [0m[35m        if tag := self.tags.get("musicbrainz.org"):[0m
[30;1m267 | [0m[35m            return tag[0m
[30;1m268 | [0m[35m        if tag := self.tags.get("musicbrainzrecordingid"):[0m
[30;1m269 | [0m[35m            return tag[0m
[30;1m270 | [0m[35m        return self.tags.get("musicbrainztrackid")[0m
[30;1m271 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1252[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m263 | [0m[35m        """Return musicbrainz_recordingid tag if present."""[0m
[30;1m264 | [0m[35m        if tag := self.tags.get("UFID:http://musicbrainz.org"):[0m
[30;1m265 | [0m[35m            return tag[0m
[30;1m266 | [0m[35m        if tag := self.tags.get("musicbrainz.org"):[0m
[30;1m267 | [0m[35m            return tag[0m
[30;1m268 | [0m[35m        if tag := self.tags.get("musicbrainzrecordingid"):[0m
[30;1m269 | [0m[35m            return tag[0m

[31m--[ [0m[34mMatch #[0m[33m1253[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m261 | [0m[35m    @property[0m
[30;1m262 | [0m[35m    def musicbrainz_recordingid(self) -> str | None:[0m
[30;1m263 | [0m[35m        """Return musicbrainz_recordingid tag if present."""[0m
[30;1m264 | [0m[35m        if tag := self.tags.get("UFID:http://musicbrainz.org"):[0m
[30;1m265 | [0m[35m            return tag[0m
[30;1m266 | [0m[35m        if tag := self.tags.get("musicbrainz.org"):[0m
[30;1m267 | [0m[35m            return tag[0m

[31m--[ [0m[34mMatch #[0m[33m1254[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m256 | [0m[35m    @property[0m
[30;1m257 | [0m[35m    def musicbrainz_albumid(self) -> str | None:[0m
[30;1m258 | [0m[35m        """Return musicbrainz_albumid tag if present."""[0m
[30;1m259 | [0m[35m        return self.tags.get("musicbrainzreleaseid", self.tags.get("musicbrainzalbumid"))[0m
[30;1m260 | [0m[35m[0m
[30;1m261 | [0m[35m    @property[0m
[30;1m262 | [0m[35m    def musicbrainz_recordingid(self) -> str | None:[0m

[31m--[ [0m[34mMatch #[0m[33m1255[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m256 | [0m[35m    @property[0m
[30;1m257 | [0m[35m    def musicbrainz_albumid(self) -> str | None:[0m
[30;1m258 | [0m[35m        """Return musicbrainz_albumid tag if present."""[0m
[30;1m259 | [0m[35m        return self.tags.get("musicbrainzreleaseid", self.tags.get("musicbrainzalbumid"))[0m
[30;1m260 | [0m[35m[0m
[30;1m261 | [0m[35m    @property[0m
[30;1m262 | [0m[35m    def musicbrainz_recordingid(self) -> str | None:[0m

[31m--[ [0m[34mMatch #[0m[33m1256[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m251 | [0m[35m    @property[0m
[30;1m252 | [0m[35m    def musicbrainz_releasegroupid(self) -> str | None:[0m
[30;1m253 | [0m[35m        """Return musicbrainz_releasegroupid tag if present."""[0m
[30;1m254 | [0m[35m        return self.tags.get("musicbrainzreleasegroupid")[0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35m    @property[0m
[30;1m257 | [0m[35m    def musicbrainz_albumid(self) -> str | None:[0m

[31m--[ [0m[34mMatch #[0m[33m1257[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m246 | [0m[35m        """Return musicbrainz_albumartistid tag if present."""[0m
[30;1m247 | [0m[35m        if tag := self.tags.get("musicbrainzalbumartistid"):[0m
[30;1m248 | [0m[35m            return split_items(tag, True)[0m
[30;1m249 | [0m[35m        return split_items(self.tags.get("musicbrainzreleaseartistid"), True)[0m
[30;1m250 | [0m[35m[0m
[30;1m251 | [0m[35m    @property[0m
[30;1m252 | [0m[35m    def musicbrainz_releasegroupid(self) -> str | None:[0m

[31m--[ [0m[34mMatch #[0m[33m1258[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m244 | [0m[35m    @property[0m
[30;1m245 | [0m[35m    def musicbrainz_albumartistids(self) -> tuple[str, ...]:[0m
[30;1m246 | [0m[35m        """Return musicbrainz_albumartistid tag if present."""[0m
[30;1m247 | [0m[35m        if tag := self.tags.get("musicbrainzalbumartistid"):[0m
[30;1m248 | [0m[35m            return split_items(tag, True)[0m
[30;1m249 | [0m[35m        return split_items(self.tags.get("musicbrainzreleaseartistid"), True)[0m
[30;1m250 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1259[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m239 | [0m[35m    @property[0m
[30;1m240 | [0m[35m    def musicbrainz_artistids(self) -> tuple[str, ...]:[0m
[30;1m241 | [0m[35m        """Return musicbrainz_artistid tag(s) if present."""[0m
[30;1m242 | [0m[35m        return split_items(self.tags.get("musicbrainzartistid"), True)[0m
[30;1m243 | [0m[35m[0m
[30;1m244 | [0m[35m    @property[0m
[30;1m245 | [0m[35m    def musicbrainz_albumartistids(self) -> tuple[str, ...]:[0m

[31m--[ [0m[34mMatch #[0m[33m1260[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m232 | [0m[35m            return try_parse_int(tag.split("-")[0], None)[0m
[30;1m233 | [0m[35m        if tag := self.tags.get("originaldate"):[0m
[30;1m234 | [0m[35m            return try_parse_int(tag.split("-")[0], None)[0m
[30;1m235 | [0m[35m        if tag := self.tags.get("date"):[0m
[30;1m236 | [0m[35m            return try_parse_int(tag.split("-")[0], None)[0m
[30;1m237 | [0m[35m        return None[0m
[30;1m238 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1261[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m230 | [0m[35m        """Return album's year if present, parsed from date."""[0m
[30;1m231 | [0m[35m        if tag := self.tags.get("originalyear"):[0m
[30;1m232 | [0m[35m            return try_parse_int(tag.split("-")[0], None)[0m
[30;1m233 | [0m[35m        if tag := self.tags.get("originaldate"):[0m
[30;1m234 | [0m[35m            return try_parse_int(tag.split("-")[0], None)[0m
[30;1m235 | [0m[35m        if tag := self.tags.get("date"):[0m
[30;1m236 | [0m[35m            return try_parse_int(tag.split("-")[0], None)[0m

[31m--[ [0m[34mMatch #[0m[33m1262[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m228 | [0m[35m    @property[0m
[30;1m229 | [0m[35m    def year(self) -> int | None:[0m
[30;1m230 | [0m[35m        """Return album's year if present, parsed from date."""[0m
[30;1m231 | [0m[35m        if tag := self.tags.get("originalyear"):[0m
[30;1m232 | [0m[35m            return try_parse_int(tag.split("-")[0], None)[0m
[30;1m233 | [0m[35m        if tag := self.tags.get("originaldate"):[0m
[30;1m234 | [0m[35m            return try_parse_int(tag.split("-")[0], None)[0m

[31m--[ [0m[34mMatch #[0m[33m1263[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m205 | [0m[35m    @property[0m
[30;1m206 | [0m[35m    def track(self) -> int | None:[0m
[30;1m207 | [0m[35m        """Return track tag if present."""[0m
[30;1m208 | [0m[35m        if tag := self.tags.get("track"):[0m
[30;1m209 | [0m[35m            return try_parse_int(tag.split("/")[0], None)[0m
[30;1m210 | [0m[35m        # fallback to parsing from filename (if present)[0m
[30;1m211 | [0m[35m        # this can be in the form of 01 - title.mp3[0m

[31m--[ [0m[34mMatch #[0m[33m1264[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m198 | [0m[35m    @property[0m
[30;1m199 | [0m[35m    def disc(self) -> int | None:[0m
[30;1m200 | [0m[35m        """Return disc tag if present."""[0m
[30;1m201 | [0m[35m        if tag := self.tags.get("disc"):[0m
[30;1m202 | [0m[35m            return try_parse_int(tag.split("/")[0], None)[0m
[30;1m203 | [0m[35m        return None[0m
[30;1m204 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1265[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m193 | [0m[35m    @property[0m
[30;1m194 | [0m[35m    def genres(self) -> tuple[str, ...]:[0m
[30;1m195 | [0m[35m        """Return (all) genres, if any."""[0m
[30;1m196 | [0m[35m        return split_items(self.tags.get("genre"))[0m
[30;1m197 | [0m[35m[0m
[30;1m198 | [0m[35m    @property[0m
[30;1m199 | [0m[35m    def disc(self) -> int | None:[0m

[31m--[ [0m[34mMatch #[0m[33m1266[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m179 | [0m[35m        if tag := self.tags.get("albumartists"):[0m
[30;1m180 | [0m[35m            return split_items(tag)[0m
[30;1m181 | [0m[35m        # fallback to regular artist string[0m
[30;1m182 | [0m[35m        if tag := self.tags.get("albumartist"):[0m
[30;1m183 | [0m[35m            if TAG_SPLITTER in tag:[0m
[30;1m184 | [0m[35m                return split_items(tag)[0m
[30;1m185 | [0m[35m            if len(self.musicbrainz_albumartistids) > 1:[0m

[31m--[ [0m[34mMatch #[0m[33m1267[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m176 | [0m[35m    def album_artists(self) -> tuple[str, ...]:[0m
[30;1m177 | [0m[35m        """Return (all) album artists (if any)."""[0m
[30;1m178 | [0m[35m        # prefer multi-artist tag[0m
[30;1m179 | [0m[35m        if tag := self.tags.get("albumartists"):[0m
[30;1m180 | [0m[35m            return split_items(tag)[0m
[30;1m181 | [0m[35m        # fallback to regular artist string[0m
[30;1m182 | [0m[35m        if tag := self.tags.get("albumartist"):[0m

[31m--[ [0m[34mMatch #[0m[33m1268[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m166 | [0m[35m        if tag := self.tags.get("writers"):[0m
[30;1m167 | [0m[35m            return split_items(tag)[0m
[30;1m168 | [0m[35m        # fallback to regular writer string[0m
[30;1m169 | [0m[35m        if tag := self.tags.get("writer"):[0m
[30;1m170 | [0m[35m            if TAG_SPLITTER in tag:[0m
[30;1m171 | [0m[35m                return split_items(tag)[0m
[30;1m172 | [0m[35m            return split_artists(tag)[0m

[31m--[ [0m[34mMatch #[0m[33m1269[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m163 | [0m[35m    def writers(self) -> tuple[str, ...]:[0m
[30;1m164 | [0m[35m        """Return writer(s)."""[0m
[30;1m165 | [0m[35m        # prefer multi-item tag[0m
[30;1m166 | [0m[35m        if tag := self.tags.get("writers"):[0m
[30;1m167 | [0m[35m            return split_items(tag)[0m
[30;1m168 | [0m[35m        # fallback to regular writer string[0m
[30;1m169 | [0m[35m        if tag := self.tags.get("writer"):[0m

[31m--[ [0m[34mMatch #[0m[33m1270[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m147 | [0m[35m        if tag := self.tags.get("artists"):[0m
[30;1m148 | [0m[35m            return split_items(tag)[0m
[30;1m149 | [0m[35m        # fallback to regular artist string[0m
[30;1m150 | [0m[35m        if tag := self.tags.get("artist"):[0m
[30;1m151 | [0m[35m            if TAG_SPLITTER in tag:[0m
[30;1m152 | [0m[35m                return split_items(tag)[0m
[30;1m153 | [0m[35m            return split_artists(tag)[0m

[31m--[ [0m[34mMatch #[0m[33m1271[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m144 | [0m[35m    def artists(self) -> tuple[str, ...]:[0m
[30;1m145 | [0m[35m        """Return track artists."""[0m
[30;1m146 | [0m[35m        # prefer multi-artist tag[0m
[30;1m147 | [0m[35m        if tag := self.tags.get("artists"):[0m
[30;1m148 | [0m[35m            return split_items(tag)[0m
[30;1m149 | [0m[35m        # fallback to regular artist string[0m
[30;1m150 | [0m[35m        if tag := self.tags.get("artist"):[0m

[31m--[ [0m[34mMatch #[0m[33m1272[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m138 | [0m[35m    @property[0m
[30;1m139 | [0m[35m    def album(self) -> str | None:[0m
[30;1m140 | [0m[35m        """Return album tag (as-is) if present."""[0m
[30;1m141 | [0m[35m        return self.tags.get("album")[0m
[30;1m142 | [0m[35m[0m
[30;1m143 | [0m[35m    @property[0m
[30;1m144 | [0m[35m    def artists(self) -> tuple[str, ...]:[0m

[31m--[ [0m[34mMatch #[0m[33m1273[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m128 | [0m[35m        album_type_tag = ([0m
[30;1m129 | [0m[35m            self.tags.get("musicbrainzalbumtype")[0m
[30;1m130 | [0m[35m            or self.tags.get("albumtype")[0m
[30;1m131 | [0m[35m            or self.tags.get("releasetype")[0m
[30;1m132 | [0m[35m        )[0m
[30;1m133 | [0m[35m        if album_type_tag and "live" in album_type_tag.lower():[0m
[30;1m134 | [0m[35m            # yes, this can happen[0m

[31m--[ [0m[34mMatch #[0m[33m1274[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m127 | [0m[35m            return tag[0m
[30;1m128 | [0m[35m        album_type_tag = ([0m
[30;1m129 | [0m[35m            self.tags.get("musicbrainzalbumtype")[0m
[30;1m130 | [0m[35m            or self.tags.get("albumtype")[0m
[30;1m131 | [0m[35m            or self.tags.get("releasetype")[0m
[30;1m132 | [0m[35m        )[0m
[30;1m133 | [0m[35m        if album_type_tag and "live" in album_type_tag.lower():[0m

[31m--[ [0m[34mMatch #[0m[33m1275[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m126 | [0m[35m        if tag := self.tags.get("version"):[0m
[30;1m127 | [0m[35m            return tag[0m
[30;1m128 | [0m[35m        album_type_tag = ([0m
[30;1m129 | [0m[35m            self.tags.get("musicbrainzalbumtype")[0m
[30;1m130 | [0m[35m            or self.tags.get("albumtype")[0m
[30;1m131 | [0m[35m            or self.tags.get("releasetype")[0m
[30;1m132 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1276[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m123 | [0m[35m    @property[0m
[30;1m124 | [0m[35m    def version(self) -> str:[0m
[30;1m125 | [0m[35m        """Return version tag (as-is)."""[0m
[30;1m126 | [0m[35m        if tag := self.tags.get("version"):[0m
[30;1m127 | [0m[35m            return tag[0m
[30;1m128 | [0m[35m        album_type_tag = ([0m
[30;1m129 | [0m[35m            self.tags.get("musicbrainzalbumtype")[0m

[31m--[ [0m[34mMatch #[0m[33m1277[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m110 | [0m[35m    @property[0m
[30;1m111 | [0m[35m    def title(self) -> str:[0m
[30;1m112 | [0m[35m        """Return title tag (as-is)."""[0m
[30;1m113 | [0m[35m        if tag := self.tags.get("title"):[0m
[30;1m114 | [0m[35m            return tag[0m
[30;1m115 | [0m[35m        # fallback to parsing from filename[0m
[30;1m116 | [0m[35m        title = self.filename.rsplit(os.sep, 1)[-1].split(".")[0][0m

[31m--[ [0m[34mMatch #[0m[33m1278[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m290 | [0m[35m[0m
[30;1m291 | [0m[35m    @property[0m
[30;1m292 | [0m[35m    def album_artist_sort_names(self) -> tuple[str, ...]:[0m
[30;1m293 | [0m[35m        """Return artist sort name tag(s) if present."""[0m
[30;1m294 | [0m[35m        return split_items(self.tags.get("albumartistsort"), False)[0m
[30;1m295 | [0m[35m[0m
[30;1m296 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m1279[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m285 | [0m[35m[0m
[30;1m286 | [0m[35m    @property[0m
[30;1m287 | [0m[35m    def artist_sort_names(self) -> tuple[str, ...]:[0m
[30;1m288 | [0m[35m        """Return artist sort name tag(s) if present."""[0m
[30;1m289 | [0m[35m        return split_items(self.tags.get("artistsort"), False)[0m
[30;1m290 | [0m[35m[0m
[30;1m291 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m1280[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m278 | [0m[35m[0m
[30;1m279 | [0m[35m    @property[0m
[30;1m280 | [0m[35m    def album_sort(self) -> str | None:[0m
[30;1m281 | [0m[35m        """Return album sort title tag (if exists)."""[0m
[30;1m282 | [0m[35m        if tag := self.tags.get("albumsort"):[0m
[30;1m283 | [0m[35m            return tag[0m
[30;1m284 | [0m[35m        return None[0m

[31m--[ [0m[34mMatch #[0m[33m1281[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/tags.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m271 | [0m[35m[0m
[30;1m272 | [0m[35m    @property[0m
[30;1m273 | [0m[35m    def title_sort(self) -> str | None:[0m
[30;1m274 | [0m[35m        """Return sort title tag (if exists)."""[0m
[30;1m275 | [0m[35m        if tag := self.tags.get("titlesort"):[0m
[30;1m276 | [0m[35m            return tag[0m
[30;1m277 | [0m[35m        return None[0m

[31m--[ [0m[34mMatch #[0m[33m1282[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/podcast_parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m154 | [0m[35m            if not isinstance(chapter, dict):[0m
[30;1m155 | [0m[35m                continue[0m
[30;1m156 | [0m[35m            title = chapter.get("title")[0m
[30;1m157 | [0m[35m            start = chapter.get("start")[0m
[30;1m158 | [0m[35m            if title and start:[0m
[30;1m159 | [0m[35m                _chapters.append(MediaItemChapter(position=cnt + 1, name=title, start=start))[0m
[30;1m160 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1283[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/podcast_parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m153 | [0m[35m        for cnt, chapter in enumerate(chapters):[0m
[30;1m154 | [0m[35m            if not isinstance(chapter, dict):[0m
[30;1m155 | [0m[35m                continue[0m
[30;1m156 | [0m[35m            title = chapter.get("title")[0m
[30;1m157 | [0m[35m            start = chapter.get("start")[0m
[30;1m158 | [0m[35m            if title and start:[0m
[30;1m159 | [0m[35m                _chapters.append(MediaItemChapter(position=cnt + 1, name=title, start=start))[0m

[31m--[ [0m[34mMatch #[0m[33m1284[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/podcast_parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m148 | [0m[35m        mass_episode.metadata.release_date = datetime.fromtimestamp(episode_published)[0m
[30;1m149 | [0m[35m[0m
[30;1m150 | [0m[35m    # chapter[0m
[30;1m151 | [0m[35m    if chapters := episode.get("chapters"):[0m
[30;1m152 | [0m[35m        _chapters = [][0m
[30;1m153 | [0m[35m        for cnt, chapter in enumerate(chapters):[0m
[30;1m154 | [0m[35m            if not isinstance(chapter, dict):[0m

[31m--[ [0m[34mMatch #[0m[33m1285[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/podcast_parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m109 | [0m[35m    episode_cover = episode.get("episode_art_url", podcast_cover)[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m    # this is unix epoch in s, and 0 if unknown[0m
[30;1m112 | [0m[35m    episode_published: int | None = episode.get("published")[0m
[30;1m113 | [0m[35m    if episode_published == 0:[0m
[30;1m114 | [0m[35m        episode_published = None[0m
[30;1m115 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1286[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/podcast_parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m106 | [0m[35m    """[0m
[30;1m107 | [0m[35m    episode_duration = episode.get("total_time", 0.0)[0m
[30;1m108 | [0m[35m    episode_title = episode.get("title", "NO_EPISODE_TITLE")[0m
[30;1m109 | [0m[35m    episode_cover = episode.get("episode_art_url", podcast_cover)[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m    # this is unix epoch in s, and 0 if unknown[0m
[30;1m112 | [0m[35m    episode_published: int | None = episode.get("published")[0m

[31m--[ [0m[34mMatch #[0m[33m1287[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/podcast_parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m105 | [0m[35m    instead. The podcast_cover is used, if the episode should not have its own cover.[0m
[30;1m106 | [0m[35m    """[0m
[30;1m107 | [0m[35m    episode_duration = episode.get("total_time", 0.0)[0m
[30;1m108 | [0m[35m    episode_title = episode.get("title", "NO_EPISODE_TITLE")[0m
[30;1m109 | [0m[35m    episode_cover = episode.get("episode_art_url", podcast_cover)[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m    # this is unix epoch in s, and 0 if unknown[0m

[31m--[ [0m[34mMatch #[0m[33m1288[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/podcast_parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m104 | [0m[35m    The item_id is {prov_podcast_id} {guid_or_stream_url} by default, or the optional mass_item_id[0m
[30;1m105 | [0m[35m    instead. The podcast_cover is used, if the episode should not have its own cover.[0m
[30;1m106 | [0m[35m    """[0m
[30;1m107 | [0m[35m    episode_duration = episode.get("total_time", 0.0)[0m
[30;1m108 | [0m[35m    episode_title = episode.get("title", "NO_EPISODE_TITLE")[0m
[30;1m109 | [0m[35m    episode_cover = episode.get("episode_art_url", podcast_cover)[0m
[30;1m110 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1289[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/podcast_parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m84 | [0m[35m    if len(episode_enclosures) < 1:[0m
[30;1m85 | [0m[35m        raise RuntimeError[0m
[30;1m86 | [0m[35m    stream_url = episode_enclosures[0].get("url", None)[0m
[30;1m87 | [0m[35m    guid = episode.get("guid")[0m
[30;1m88 | [0m[35m    return stream_url, guid[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1290[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/podcast_parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m83 | [0m[35m    episode_enclosures = episode.get("enclosures", [])[0m
[30;1m84 | [0m[35m    if len(episode_enclosures) < 1:[0m
[30;1m85 | [0m[35m        raise RuntimeError[0m
[30;1m86 | [0m[35m    stream_url = episode_enclosures[0].get("url", None)[0m
[30;1m87 | [0m[35m    guid = episode.get("guid")[0m
[30;1m88 | [0m[35m    return stream_url, guid[0m
[30;1m89 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1291[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/podcast_parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m80 | [0m[35m    *, episode: dict[str, Any][0m
[30;1m81 | [0m[35m) -> tuple[str | None, str | None]:[0m
[30;1m82 | [0m[35m    """Give episode's stream url and guid, if it exists."""[0m
[30;1m83 | [0m[35m    episode_enclosures = episode.get("enclosures", [])[0m
[30;1m84 | [0m[35m    if len(episode_enclosures) < 1:[0m
[30;1m85 | [0m[35m        raise RuntimeError[0m
[30;1m86 | [0m[35m    stream_url = episode_enclosures[0].get("url", None)[0m

[31m--[ [0m[34mMatch #[0m[33m1292[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/podcast_parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m        mass_podcast.metadata.languages = UniqueList([language])[0m
[30;1m62 | [0m[35m    episodes = parsed_feed.get("episodes", [])[0m
[30;1m63 | [0m[35m    mass_podcast.total_episodes = len(episodes)[0m
[30;1m64 | [0m[35m    podcast_cover = parsed_feed.get("cover_url")[0m
[30;1m65 | [0m[35m    if podcast_cover is not None:[0m
[30;1m66 | [0m[35m        mass_podcast.metadata.images = UniqueList([0m
[30;1m67 | [0m[35m            [[0m

[31m--[ [0m[34mMatch #[0m[33m1293[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/podcast_parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m    language = parsed_feed.get("language")[0m
[30;1m60 | [0m[35m    if language is not None:[0m
[30;1m61 | [0m[35m        mass_podcast.metadata.languages = UniqueList([language])[0m
[30;1m62 | [0m[35m    episodes = parsed_feed.get("episodes", [])[0m
[30;1m63 | [0m[35m    mass_podcast.total_episodes = len(episodes)[0m
[30;1m64 | [0m[35m    podcast_cover = parsed_feed.get("cover_url")[0m
[30;1m65 | [0m[35m    if podcast_cover is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m1294[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/podcast_parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m    mass_podcast.metadata.genres = set(genres)[0m
[30;1m57 | [0m[35m    mass_podcast.metadata.description = parsed_feed.get("description", "")[0m
[30;1m58 | [0m[35m    mass_podcast.metadata.explicit = parsed_feed.get("explicit", False)[0m
[30;1m59 | [0m[35m    language = parsed_feed.get("language")[0m
[30;1m60 | [0m[35m    if language is not None:[0m
[30;1m61 | [0m[35m        mass_podcast.metadata.languages = UniqueList([language])[0m
[30;1m62 | [0m[35m    episodes = parsed_feed.get("episodes", [])[0m

[31m--[ [0m[34mMatch #[0m[33m1295[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/podcast_parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m    mass_podcast.metadata.genres = set(genres)[0m
[30;1m57 | [0m[35m    mass_podcast.metadata.description = parsed_feed.get("description", "")[0m
[30;1m58 | [0m[35m    mass_podcast.metadata.explicit = parsed_feed.get("explicit", False)[0m
[30;1m59 | [0m[35m    language = parsed_feed.get("language")[0m
[30;1m60 | [0m[35m    if language is not None:[0m
[30;1m61 | [0m[35m        mass_podcast.metadata.languages = UniqueList([language])[0m

[31m--[ [0m[34mMatch #[0m[33m1296[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/podcast_parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m                genres.append(_sub_genre)[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m    mass_podcast.metadata.genres = set(genres)[0m
[30;1m57 | [0m[35m    mass_podcast.metadata.description = parsed_feed.get("description", "")[0m
[30;1m58 | [0m[35m    mass_podcast.metadata.explicit = parsed_feed.get("explicit", False)[0m
[30;1m59 | [0m[35m    language = parsed_feed.get("language")[0m
[30;1m60 | [0m[35m    if language is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m1297[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/podcast_parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m        },[0m
[30;1m47 | [0m[35m    )[0m
[30;1m48 | [0m[35m    genres: list[str] = [][0m
[30;1m49 | [0m[35m    if _genres := parsed_feed.get("itunes_categories"):[0m
[30;1m50 | [0m[35m        for _sub_genre in _genres:[0m
[30;1m51 | [0m[35m            if isinstance(_sub_genre, list):[0m
[30;1m52 | [0m[35m                genres.extend(x for x in _sub_genre if isinstance(x, str))[0m

[31m--[ [0m[34mMatch #[0m[33m1298[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/podcast_parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m36 | [0m[35m        name=parsed_feed.get("title", "NO_TITLE"),[0m
[30;1m37 | [0m[35m        publisher=publisher,[0m
[30;1m38 | [0m[35m        provider=lookup_key,[0m
[30;1m39 | [0m[35m        uri=parsed_feed.get("link"),[0m
[30;1m40 | [0m[35m        provider_mappings={[0m
[30;1m41 | [0m[35m            ProviderMapping([0m
[30;1m42 | [0m[35m                item_id=item_id,[0m

[31m--[ [0m[34mMatch #[0m[33m1299[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/podcast_parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m33 | [0m[35m    item_id = feed_url if mass_item_id is None else mass_item_id[0m
[30;1m34 | [0m[35m    mass_podcast = Podcast([0m
[30;1m35 | [0m[35m        item_id=item_id,[0m
[30;1m36 | [0m[35m        name=parsed_feed.get("title", "NO_TITLE"),[0m
[30;1m37 | [0m[35m        publisher=publisher,[0m
[30;1m38 | [0m[35m        provider=lookup_key,[0m
[30;1m39 | [0m[35m        uri=parsed_feed.get("link"),[0m

[31m--[ [0m[34mMatch #[0m[33m1300[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/podcast_parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m    The item_id is the feed url by default, or the optional mass_item_id instead.[0m
[30;1m31 | [0m[35m    """[0m
[30;1m32 | [0m[35m    publisher = parsed_feed.get("author") or parsed_feed.get("itunes_author", "NO_AUTHOR")[0m
[30;1m33 | [0m[35m    item_id = feed_url if mass_item_id is None else mass_item_id[0m
[30;1m34 | [0m[35m    mass_podcast = Podcast([0m
[30;1m35 | [0m[35m        item_id=item_id,[0m

[31m--[ [0m[34mMatch #[0m[33m1301[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/podcast_parsers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m    The item_id is the feed url by default, or the optional mass_item_id instead.[0m
[30;1m31 | [0m[35m    """[0m
[30;1m32 | [0m[35m    publisher = parsed_feed.get("author") or parsed_feed.get("itunes_author", "NO_AUTHOR")[0m
[30;1m33 | [0m[35m    item_id = feed_url if mass_item_id is None else mass_item_id[0m
[30;1m34 | [0m[35m    mass_podcast = Podcast([0m
[30;1m35 | [0m[35m        item_id=item_id,[0m

[31m--[ [0m[34mMatch #[0m[33m1302[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35mLOGGER = logging.getLogger(f"{MASS_LOGGER_NAME}.database")[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mENABLE_DEBUG = os.environ.get("PYTHONDEVMODE") == "1"[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m@asynccontextmanager[0m

[31m--[ [0m[34mMatch #[0m[33m1303[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/database.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m@asynccontextmanager[0m
[30;1m26 | [0m[35masync def debug_query(sql_query: str, query_params: dict | None = None):[0m
[30;1m27 | [0m[35m    """Time the processing time of an sql query."""[0m
[30;1m28 | [0m[35m    if not ENABLE_DEBUG:[0m
[30;1m29 | [0m[35m        yield[0m
[30;1m30 | [0m[35m        return[0m

[31m--[ [0m[34mMatch #[0m[33m1304[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/database.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mimport os[0m
[30;1m8 | [0m[35mimport time[0m
[30;1m9 | [0m[35mfrom contextlib import asynccontextmanager[0m
[30;1m10 | [0m[35mfrom sqlite3 import OperationalError[0m
[30;1m11 | [0m[35mfrom typing import TYPE_CHECKING, Any[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mimport aiosqlite[0m

[31m--[ [0m[34mMatch #[0m[33m1305[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/database.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35mimport asyncio[0m
[30;1m6 | [0m[35mimport logging[0m
[30;1m7 | [0m[35mimport os[0m
[30;1m8 | [0m[35mimport time[0m
[30;1m9 | [0m[35mfrom contextlib import asynccontextmanager[0m
[30;1m10 | [0m[35mfrom sqlite3 import OperationalError[0m
[30;1m11 | [0m[35mfrom typing import TYPE_CHECKING, Any[0m
[30;1m12 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1306[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m929 | [0m[35m        if not (child_player := self.mass.players.get(child_player_id)):[0m
[30;1m930 | [0m[35m            raise web.HTTPNotFound(reason=f"Unknown player: {child_player_id}")[0m
[30;1m931 | [0m[35m[0m
[30;1m932 | [0m[35m        if not (stream := self._multi_streams.get(player_id, None)) or stream.done:[0m
[30;1m933 | [0m[35m            raise web.HTTPNotFound(f"There is no active stream for {player_id}!")[0m
[30;1m934 | [0m[35m[0m
[30;1m935 | [0m[35m        resp = web.StreamResponse([0m

[31m--[ [0m[34mMatch #[0m[33m1307[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m926 | [0m[35m        if not self.mass.players.get(player_id):[0m
[30;1m927 | [0m[35m            raise web.HTTPNotFound(reason=f"Unknown player: {player_id}")[0m
[30;1m928 | [0m[35m[0m
[30;1m929 | [0m[35m        if not (child_player := self.mass.players.get(child_player_id)):[0m
[30;1m930 | [0m[35m            raise web.HTTPNotFound(reason=f"Unknown player: {child_player_id}")[0m
[30;1m931 | [0m[35m[0m
[30;1m932 | [0m[35m        if not (stream := self._multi_streams.get(player_id, None)) or stream.done:[0m

[31m--[ [0m[34mMatch #[0m[33m1308[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m923 | [0m[35m        fmt = request.query.get("fmt")[0m
[30;1m924 | [0m[35m        child_player_id = request.query.get("child_player_id")[0m
[30;1m925 | [0m[35m[0m
[30;1m926 | [0m[35m        if not self.mass.players.get(player_id):[0m
[30;1m927 | [0m[35m            raise web.HTTPNotFound(reason=f"Unknown player: {player_id}")[0m
[30;1m928 | [0m[35m[0m
[30;1m929 | [0m[35m        if not (child_player := self.mass.players.get(child_player_id)):[0m

[31m--[ [0m[34mMatch #[0m[33m1309[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m921 | [0m[35m        """Serve the multi-client flow stream audio to a player."""[0m
[30;1m922 | [0m[35m        player_id = request.query.get("player_id")[0m
[30;1m923 | [0m[35m        fmt = request.query.get("fmt")[0m
[30;1m924 | [0m[35m        child_player_id = request.query.get("child_player_id")[0m
[30;1m925 | [0m[35m[0m
[30;1m926 | [0m[35m        if not self.mass.players.get(player_id):[0m
[30;1m927 | [0m[35m            raise web.HTTPNotFound(reason=f"Unknown player: {player_id}")[0m

[31m--[ [0m[34mMatch #[0m[33m1310[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m920 | [0m[35m    async def _serve_multi_client_stream(self, request: web.Request) -> web.Response:[0m
[30;1m921 | [0m[35m        """Serve the multi-client flow stream audio to a player."""[0m
[30;1m922 | [0m[35m        player_id = request.query.get("player_id")[0m
[30;1m923 | [0m[35m        fmt = request.query.get("fmt")[0m
[30;1m924 | [0m[35m        child_player_id = request.query.get("child_player_id")[0m
[30;1m925 | [0m[35m[0m
[30;1m926 | [0m[35m        if not self.mass.players.get(player_id):[0m

[31m--[ [0m[34mMatch #[0m[33m1311[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m919 | [0m[35m[0m
[30;1m920 | [0m[35m    async def _serve_multi_client_stream(self, request: web.Request) -> web.Response:[0m
[30;1m921 | [0m[35m        """Serve the multi-client flow stream audio to a player."""[0m
[30;1m922 | [0m[35m        player_id = request.query.get("player_id")[0m
[30;1m923 | [0m[35m        fmt = request.query.get("fmt")[0m
[30;1m924 | [0m[35m        child_player_id = request.query.get("child_player_id")[0m
[30;1m925 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1312[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m857 | [0m[35m[0m
[30;1m858 | [0m[35m    def _get_sync_clients(self, player_id: str) -> Iterator[SlimClient]:[0m
[30;1m859 | [0m[35m        """Get all sync clients for a player."""[0m
[30;1m860 | [0m[35m        player = self.mass.players.get(player_id)[0m
[30;1m861 | [0m[35m        # we need to return the player itself too[0m
[30;1m862 | [0m[35m        group_child_ids = {player_id}[0m
[30;1m863 | [0m[35m        group_child_ids.update(player.group_childs)[0m

[31m--[ [0m[34mMatch #[0m[33m1313[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m845 | [0m[35m        # update all attributes[0m
[30;1m846 | [0m[35m        await self._handle_player_update(slimplayer)[0m
[30;1m847 | [0m[35m        # restore volume and power state[0m
[30;1m848 | [0m[35m        if last_state := await self.mass.cache.get(player_id, base_key=CACHE_KEY_PREV_STATE):[0m
[30;1m849 | [0m[35m            init_power = last_state[0][0m
[30;1m850 | [0m[35m            init_volume = last_state[1][0m
[30;1m851 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m1314[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m802 | [0m[35m[0m
[30;1m803 | [0m[35m        Only used when autoplay=0 for coordinated start of synced players.[0m
[30;1m804 | [0m[35m        """[0m
[30;1m805 | [0m[35m        player = self.mass.players.get(slimplayer.player_id)[0m
[30;1m806 | [0m[35m        if player.synced_to:[0m
[30;1m807 | [0m[35m            # unpause of sync child is handled by sync master[0m
[30;1m808 | [0m[35m            return[0m

[31m--[ [0m[34mMatch #[0m[33m1315[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m723 | [0m[35m[0m
[30;1m724 | [0m[35m    def _handle_client_sync(self, slimplayer: SlimClient) -> None:[0m
[30;1m725 | [0m[35m        """Synchronize audio of a sync slimplayer."""[0m
[30;1m726 | [0m[35m        player = self.mass.players.get(slimplayer.player_id)[0m
[30;1m727 | [0m[35m        sync_master_id = player.synced_to[0m
[30;1m728 | [0m[35m        if not sync_master_id:[0m
[30;1m729 | [0m[35m            # we only correct sync members, not the sync master itself[0m

[31m--[ [0m[34mMatch #[0m[33m1316[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m675 | [0m[35m[0m
[30;1m676 | [0m[35m        # elapsed time change on the player will be auto picked up[0m
[30;1m677 | [0m[35m        # by the player manager.[0m
[30;1m678 | [0m[35m        if not (player := self.mass.players.get(slimplayer.player_id)):[0m
[30;1m679 | [0m[35m            # race condition?![0m
[30;1m680 | [0m[35m            return[0m
[30;1m681 | [0m[35m        player.elapsed_time = slimplayer.elapsed_seconds[0m

[31m--[ [0m[34mMatch #[0m[33m1317[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m655 | [0m[35m                image_url=metadata.get("image_url"),[0m
[30;1m656 | [0m[35m                duration=metadata.get("duration"),[0m
[30;1m657 | [0m[35m                queue_id=metadata.get("queue_id"),[0m
[30;1m658 | [0m[35m                queue_item_id=metadata.get("queue_item_id"),[0m
[30;1m659 | [0m[35m            )[0m
[30;1m660 | [0m[35m        else:[0m
[30;1m661 | [0m[35m            player.current_media = None[0m

[31m--[ [0m[34mMatch #[0m[33m1318[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m654 | [0m[35m                artist=metadata.get("artist"),[0m
[30;1m655 | [0m[35m                image_url=metadata.get("image_url"),[0m
[30;1m656 | [0m[35m                duration=metadata.get("duration"),[0m
[30;1m657 | [0m[35m                queue_id=metadata.get("queue_id"),[0m
[30;1m658 | [0m[35m                queue_item_id=metadata.get("queue_item_id"),[0m
[30;1m659 | [0m[35m            )[0m
[30;1m660 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m1319[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m653 | [0m[35m                album=metadata.get("album"),[0m
[30;1m654 | [0m[35m                artist=metadata.get("artist"),[0m
[30;1m655 | [0m[35m                image_url=metadata.get("image_url"),[0m
[30;1m656 | [0m[35m                duration=metadata.get("duration"),[0m
[30;1m657 | [0m[35m                queue_id=metadata.get("queue_id"),[0m
[30;1m658 | [0m[35m                queue_item_id=metadata.get("queue_item_id"),[0m
[30;1m659 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m1320[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m652 | [0m[35m                title=metadata.get("title"),[0m
[30;1m653 | [0m[35m                album=metadata.get("album"),[0m
[30;1m654 | [0m[35m                artist=metadata.get("artist"),[0m
[30;1m655 | [0m[35m                image_url=metadata.get("image_url"),[0m
[30;1m656 | [0m[35m                duration=metadata.get("duration"),[0m
[30;1m657 | [0m[35m                queue_id=metadata.get("queue_id"),[0m
[30;1m658 | [0m[35m                queue_item_id=metadata.get("queue_item_id"),[0m

[31m--[ [0m[34mMatch #[0m[33m1321[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m651 | [0m[35m                uri=metadata.get("item_id"),[0m
[30;1m652 | [0m[35m                title=metadata.get("title"),[0m
[30;1m653 | [0m[35m                album=metadata.get("album"),[0m
[30;1m654 | [0m[35m                artist=metadata.get("artist"),[0m
[30;1m655 | [0m[35m                image_url=metadata.get("image_url"),[0m
[30;1m656 | [0m[35m                duration=metadata.get("duration"),[0m
[30;1m657 | [0m[35m                queue_id=metadata.get("queue_id"),[0m

[31m--[ [0m[34mMatch #[0m[33m1322[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m650 | [0m[35m            player.current_media = PlayerMedia([0m
[30;1m651 | [0m[35m                uri=metadata.get("item_id"),[0m
[30;1m652 | [0m[35m                title=metadata.get("title"),[0m
[30;1m653 | [0m[35m                album=metadata.get("album"),[0m
[30;1m654 | [0m[35m                artist=metadata.get("artist"),[0m
[30;1m655 | [0m[35m                image_url=metadata.get("image_url"),[0m
[30;1m656 | [0m[35m                duration=metadata.get("duration"),[0m

[31m--[ [0m[34mMatch #[0m[33m1323[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m649 | [0m[35m        if slimplayer.current_media and (metadata := slimplayer.current_media.metadata):[0m
[30;1m650 | [0m[35m            player.current_media = PlayerMedia([0m
[30;1m651 | [0m[35m                uri=metadata.get("item_id"),[0m
[30;1m652 | [0m[35m                title=metadata.get("title"),[0m
[30;1m653 | [0m[35m                album=metadata.get("album"),[0m
[30;1m654 | [0m[35m                artist=metadata.get("artist"),[0m
[30;1m655 | [0m[35m                image_url=metadata.get("image_url"),[0m

[31m--[ [0m[34mMatch #[0m[33m1324[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m648 | [0m[35m        player.available = True[0m
[30;1m649 | [0m[35m        if slimplayer.current_media and (metadata := slimplayer.current_media.metadata):[0m
[30;1m650 | [0m[35m            player.current_media = PlayerMedia([0m
[30;1m651 | [0m[35m                uri=metadata.get("item_id"),[0m
[30;1m652 | [0m[35m                title=metadata.get("title"),[0m
[30;1m653 | [0m[35m                album=metadata.get("album"),[0m
[30;1m654 | [0m[35m                artist=metadata.get("artist"),[0m

[31m--[ [0m[34mMatch #[0m[33m1325[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m615 | [0m[35m    async def _handle_player_update(self, slimplayer: SlimClient) -> None:[0m
[30;1m616 | [0m[35m        """Process SlimClient update/add to Player controller."""[0m
[30;1m617 | [0m[35m        player_id = slimplayer.player_id[0m
[30;1m618 | [0m[35m        player = self.mass.players.get(player_id, raise_unavailable=False)[0m
[30;1m619 | [0m[35m        if not player:[0m
[30;1m620 | [0m[35m            # player does not yet exist, create it[0m
[30;1m621 | [0m[35m            player = Player([0m

[31m--[ [0m[34mMatch #[0m[33m1326[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m585 | [0m[35m            return[0m
[30;1m586 | [0m[35m[0m
[30;1m587 | [0m[35m        if event.type == SlimEventType.PLAYER_DISCONNECTED:[0m
[30;1m588 | [0m[35m            if mass_player := self.mass.players.get(event.player_id):[0m
[30;1m589 | [0m[35m                mass_player.available = False[0m
[30;1m590 | [0m[35m                self.mass.players.update(mass_player.player_id)[0m
[30;1m591 | [0m[35m            return[0m

[31m--[ [0m[34mMatch #[0m[33m1327[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m567 | [0m[35m        """[0m
[30;1m568 | [0m[35m        player = self.mass.players.get(player_id, raise_unavailable=True)[0m
[30;1m569 | [0m[35m        if player.synced_to:[0m
[30;1m570 | [0m[35m            group_leader = self.mass.players.get(player.synced_to, raise_unavailable=True)[0m
[30;1m571 | [0m[35m            if player_id in group_leader.group_childs:[0m
[30;1m572 | [0m[35m                group_leader.group_childs.remove(player_id)[0m
[30;1m573 | [0m[35m            player.synced_to = None[0m

[31m--[ [0m[34mMatch #[0m[33m1328[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m565 | [0m[35m[0m
[30;1m566 | [0m[35m            - player_id: player_id of the player to handle the command.[0m
[30;1m567 | [0m[35m        """[0m
[30;1m568 | [0m[35m        player = self.mass.players.get(player_id, raise_unavailable=True)[0m
[30;1m569 | [0m[35m        if player.synced_to:[0m
[30;1m570 | [0m[35m            group_leader = self.mass.players.get(player.synced_to, raise_unavailable=True)[0m
[30;1m571 | [0m[35m            if player_id in group_leader.group_childs:[0m

[31m--[ [0m[34mMatch #[0m[33m1329[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m528 | [0m[35m        """Handle GROUP command for given player."""[0m
[30;1m529 | [0m[35m        child_player = self.mass.players.get(player_id)[0m
[30;1m530 | [0m[35m        assert child_player  # guard[0m
[30;1m531 | [0m[35m        parent_player = self.mass.players.get(target_player)[0m
[30;1m532 | [0m[35m        assert parent_player  # guard[0m
[30;1m533 | [0m[35m        if parent_player.synced_to:[0m
[30;1m534 | [0m[35m            raise RuntimeError("Parent player is already synced!")[0m

[31m--[ [0m[34mMatch #[0m[33m1330[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m526 | [0m[35m[0m
[30;1m527 | [0m[35m    async def cmd_group(self, player_id: str, target_player: str) -> None:[0m
[30;1m528 | [0m[35m        """Handle GROUP command for given player."""[0m
[30;1m529 | [0m[35m        child_player = self.mass.players.get(player_id)[0m
[30;1m530 | [0m[35m        assert child_player  # guard[0m
[30;1m531 | [0m[35m        parent_player = self.mass.players.get(target_player)[0m
[30;1m532 | [0m[35m        assert parent_player  # guard[0m

[31m--[ [0m[34mMatch #[0m[33m1331[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m463 | [0m[35m            "queue_id": media.queue_id,[0m
[30;1m464 | [0m[35m            "queue_item_id": media.queue_item_id,[0m
[30;1m465 | [0m[35m        }[0m
[30;1m466 | [0m[35m        if queue := self.mass.player_queues.get(media.queue_id):[0m
[30;1m467 | [0m[35m            slimplayer.extra_data["playlist repeat"] = REPEATMODE_MAP[queue.repeat_mode][0m
[30;1m468 | [0m[35m            slimplayer.extra_data["playlist shuffle"] = int(queue.shuffle_enabled)[0m
[30;1m469 | [0m[35m        await slimplayer.play_url([0m

[31m--[ [0m[34mMatch #[0m[33m1332[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m395 | [0m[35m        elif media.queue_id and media.queue_item_id:[0m
[30;1m396 | [0m[35m            # regular queue stream request[0m
[30;1m397 | [0m[35m            audio_source = self.mass.streams.get_queue_flow_stream([0m
[30;1m398 | [0m[35m                queue=self.mass.player_queues.get(media.queue_id),[0m
[30;1m399 | [0m[35m                start_queue_item=self.mass.player_queues.get_item([0m
[30;1m400 | [0m[35m                    media.queue_id, media.queue_item_id[0m
[30;1m401 | [0m[35m                ),[0m

[31m--[ [0m[34mMatch #[0m[33m1333[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m347 | [0m[35m        media: PlayerMedia,[0m
[30;1m348 | [0m[35m    ) -> None:[0m
[30;1m349 | [0m[35m        """Handle PLAY MEDIA on given player."""[0m
[30;1m350 | [0m[35m        player = self.mass.players.get(player_id)[0m
[30;1m351 | [0m[35m        if player.synced_to:[0m
[30;1m352 | [0m[35m            msg = "A synced player cannot receive play commands directly"[0m
[30;1m353 | [0m[35m            raise RuntimeError(msg)[0m

[31m--[ [0m[34mMatch #[0m[33m1334[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m842 | [0m[35m        # set presets and display[0m
[30;1m843 | [0m[35m        await self._set_preset_items(slimplayer)[0m
[30;1m844 | [0m[35m        await self._set_display(slimplayer)[0m
[30;1m845 | [0m[35m        # update all attributes[0m
[30;1m846 | [0m[35m        await self._handle_player_update(slimplayer)[0m
[30;1m847 | [0m[35m        # restore volume and power state[0m
[30;1m848 | [0m[35m        if last_state := await self.mass.cache.get(player_id, base_key=CACHE_KEY_PREV_STATE):[0m

[31m--[ [0m[34mMatch #[0m[33m1335[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m644 | [0m[35m            )[0m
[30;1m645 | [0m[35m            await self.mass.players.register_or_update(player)[0m
[30;1m646 | [0m[35m[0m
[30;1m647 | [0m[35m        # update player state on player events[0m
[30;1m648 | [0m[35m        player.available = True[0m
[30;1m649 | [0m[35m        if slimplayer.current_media and (metadata := slimplayer.current_media.metadata):[0m
[30;1m650 | [0m[35m            player.current_media = PlayerMedia([0m

[31m--[ [0m[34mMatch #[0m[33m1336[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m609 | [0m[35m            self.mass.create_task(self._handle_player_cli_event(slimplayer, event))[0m
[30;1m610 | [0m[35m            return[0m
[30;1m611 | [0m[35m[0m
[30;1m612 | [0m[35m        # forward player update to MA player controller[0m
[30;1m613 | [0m[35m        self.mass.create_task(self._handle_player_update(slimplayer))[0m
[30;1m614 | [0m[35m[0m
[30;1m615 | [0m[35m    async def _handle_player_update(self, slimplayer: SlimClient) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m1337[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m573 | [0m[35m            player.synced_to = None[0m
[30;1m574 | [0m[35m            if slimclient := self.slimproto.get_player(player_id):[0m
[30;1m575 | [0m[35m                await slimclient.stop()[0m
[30;1m576 | [0m[35m            # make sure that the player manager gets an update[0m
[30;1m577 | [0m[35m            self.mass.players.update(player.player_id, skip_forward=True)[0m
[30;1m578 | [0m[35m            self.mass.players.update(group_leader.player_id, skip_forward=True)[0m
[30;1m579 | [0m[35m[0m
[30;1m580 | [0m[35m    def _client_callback([0m

[31m--[ [0m[34mMatch #[0m[33m1338[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m554 | [0m[35m                task_id=f"resume_{active_queue.queue_id}",[0m
[30;1m555 | [0m[35m            )[0m
[30;1m556 | [0m[35m        else:[0m
[30;1m557 | [0m[35m            # make sure that the player manager gets an update[0m
[30;1m558 | [0m[35m            self.mass.players.update(child_player.player_id, skip_forward=True)[0m
[30;1m559 | [0m[35m            self.mass.players.update(parent_player.player_id, skip_forward=True)[0m
[30;1m560 | [0m[35m[0m
[30;1m561 | [0m[35m    async def cmd_ungroup(self, player_id: str) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m1339[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m544 | [0m[35m        active_queue = self.mass.player_queues.get_active_queue(parent_player.player_id)[0m
[30;1m545 | [0m[35m        if active_queue.state == PlayerState.PLAYING:[0m
[30;1m546 | [0m[35m            # playback needs to be restarted to form a new multi client stream session[0m
[30;1m547 | [0m[35m            # this could potentially be called by multiple players at the exact same time[0m
[30;1m548 | [0m[35m            # so we debounce the resync a bit here with a timer[0m
[30;1m549 | [0m[35m            self.mass.call_later([0m
[30;1m550 | [0m[35m                1,[0m

[31m--[ [0m[34mMatch #[0m[33m1340[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m# sync constants[0m
[30;1m83 | [0m[35mMIN_DEVIATION_ADJUST = 8  # 5 milliseconds[0m
[30;1m84 | [0m[35mMIN_REQ_PLAYPOINTS = 8  # we need at least 8 measurements[0m
[30;1m85 | [0m[35mDEVIATION_JUMP_IGNORE = 500  # ignore a sudden unrealistic jump[0m
[30;1m86 | [0m[35mMAX_SKIP_AHEAD_MS = 800  # 0.8 seconds[0m
[30;1m87 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1341[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m920 | [0m[35m    async def _serve_multi_client_stream(self, request: web.Request) -> web.Response:[0m
[30;1m921 | [0m[35m        """Serve the multi-client flow stream audio to a player."""[0m
[30;1m922 | [0m[35m        player_id = request.query.get("player_id")[0m
[30;1m923 | [0m[35m        fmt = request.query.get("fmt")[0m
[30;1m924 | [0m[35m        child_player_id = request.query.get("child_player_id")[0m
[30;1m925 | [0m[35m[0m
[30;1m926 | [0m[35m        if not self.mass.players.get(player_id):[0m

[31m--[ [0m[34mMatch #[0m[33m1342[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m773 | [0m[35m        if len(sync_playpoints) < min_req_playpoints:[0m
[30;1m774 | [0m[35m            return[0m
[30;1m775 | [0m[35m[0m
[30;1m776 | [0m[35m        # get the average diff[0m
[30;1m777 | [0m[35m        avg_diff = statistics.fmean(x.diff for x in sync_playpoints)[0m
[30;1m778 | [0m[35m        delta = int(abs(avg_diff))[0m
[30;1m779 | [0m[35m[0m
[30;1m780 | [0m[35m        if delta < MIN_DEVIATION_ADJUST:[0m

[31m--[ [0m[34mMatch #[0m[33m1343[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m754 | [0m[35m            # this should not happen, but just in case[0m
[30;1m755 | [0m[35m            sync_playpoints.clear()[0m
[30;1m756 | [0m[35m[0m
[30;1m757 | [0m[35m        diff = int([0m
[30;1m758 | [0m[35m            self._get_corrected_elapsed_milliseconds(sync_master)[0m
[30;1m759 | [0m[35m            - self._get_corrected_elapsed_milliseconds(slimplayer)[0m
[30;1m760 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1344[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m673 | [0m[35m            # ignore server heartbeats when stopped[0m
[30;1m674 | [0m[35m            return[0m
[30;1m675 | [0m[35m[0m
[30;1m676 | [0m[35m        # elapsed time change on the player will be auto picked up[0m
[30;1m677 | [0m[35m        # by the player manager.[0m
[30;1m678 | [0m[35m        if not (player := self.mass.players.get(slimplayer.player_id)):[0m
[30;1m679 | [0m[35m            # race condition?![0m

[31m--[ [0m[34mMatch #[0m[33m1345[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m544 | [0m[35m        active_queue = self.mass.player_queues.get_active_queue(parent_player.player_id)[0m
[30;1m545 | [0m[35m        if active_queue.state == PlayerState.PLAYING:[0m
[30;1m546 | [0m[35m            # playback needs to be restarted to form a new multi client stream session[0m
[30;1m547 | [0m[35m            # this could potentially be called by multiple players at the exact same time[0m
[30;1m548 | [0m[35m            # so we debounce the resync a bit here with a timer[0m
[30;1m549 | [0m[35m            self.mass.call_later([0m
[30;1m550 | [0m[35m                1,[0m
[30;1m551 | [0m[35m                self.mass.player_queues.resume,[0m

[31m--[ [0m[34mMatch #[0m[33m1346[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m159 | [0m[35m            type=ConfigEntryType.INTEGER,[0m
[30;1m160 | [0m[35m            default_value=9090,[0m
[30;1m161 | [0m[35m            label="Classic Squeezebox CLI Port",[0m
[30;1m162 | [0m[35m            description="Some slimproto based players require the presence of the telnet CLI "[0m
[30;1m163 | [0m[35m            " to request more information. \n\n"[0m
[30;1m164 | [0m[35m            "By default this CLI is hosted on port 9090 but some players also accept "[0m
[30;1m165 | [0m[35m            "a different port. Set to 0 to disable this functionality.\n\n"[0m

[31m--[ [0m[34mMatch #[0m[33m1347[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35mimport asyncio[0m
[30;1m6 | [0m[35mimport logging[0m
[30;1m7 | [0m[35mimport statistics[0m
[30;1m8 | [0m[35mimport time[0m
[30;1m9 | [0m[35mfrom collections import deque[0m
[30;1m10 | [0m[35mfrom collections.abc import Iterator[0m
[30;1m11 | [0m[35mfrom dataclasses import dataclass[0m
[30;1m12 | [0m[35mfrom typing import TYPE_CHECKING[0m

[31m--[ [0m[34mMatch #[0m[33m1348[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/models/provider.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m122 | [0m[35m    def update_config_value(self, key: str, value: Any, encrypted: bool = False) -> None:[0m
[30;1m123 | [0m[35m        """Update a config value."""[0m
[30;1m124 | [0m[35m        self.mass.config.set_raw_provider_config_value(self.instance_id, key, value, encrypted)[0m
[30;1m125 | [0m[35m        # also update the cached copy within the provider instance[0m
[30;1m126 | [0m[35m        self.config.values[key].value = value[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    def unload_with_error(self, error: str) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m1349[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/models/provider.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m105 | [0m[35m        # create default name based on instance count[0m
[30;1m106 | [0m[35m        instances = [x.instance_id for x in self.mass.music.providers if x.domain == self.domain][0m
[30;1m107 | [0m[35m        if len(instances) <= 1:[0m
[30;1m108 | [0m[35m            # only one instance (or no instances yet at all) - return provider name[0m
[30;1m109 | [0m[35m            return self.manifest.name[0m
[30;1m110 | [0m[35m        instance_name_postfix = self.instance_name_postfix[0m
[30;1m111 | [0m[35m        if not instance_name_postfix:[0m

[31m--[ [0m[34mMatch #[0m[33m1350[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/models/provider.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m69 | [0m[35m    async def on_mdns_service_state_change([0m
[30;1m70 | [0m[35m        self, name: str, state_change: ServiceStateChange, info: AsyncServiceInfo | None[0m
[30;1m71 | [0m[35m    ) -> None:[0m
[30;1m72 | [0m[35m        """Handle MDNS service state callback."""[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m    @property[0m
[30;1m75 | [0m[35m    @final[0m

[31m--[ [0m[34mMatch #[0m[33m1351[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/process.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m129 | [0m[35m        """Read up to n bytes from the stdout stream.[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m        If n is positive, this function try to read n bytes,[0m
[30;1m132 | [0m[35m        and may return less or equal bytes than requested, but at least one byte.[0m
[30;1m133 | [0m[35m        If EOF was received before any byte is read, this function returns empty byte object.[0m
[30;1m134 | [0m[35m        """[0m
[30;1m135 | [0m[35m        if self._close_called:[0m

[31m--[ [0m[34mMatch #[0m[33m1352[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/images.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m38 | [0m[35m    # handle HTTP location[0m
[30;1m39 | [0m[35m    if path_or_url.startswith("http"):[0m
[30;1m40 | [0m[35m        try:[0m
[30;1m41 | [0m[35m            async with mass.http_session.get(path_or_url, raise_for_status=True) as resp:[0m
[30;1m42 | [0m[35m                return await resp.read()[0m
[30;1m43 | [0m[35m        except ClientError as err:[0m
[30;1m44 | [0m[35m            raise FileNotFoundError from err[0m

[31m--[ [0m[34mMatch #[0m[33m1353[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/images.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m42 | [0m[35m                return await resp.read()[0m
[30;1m43 | [0m[35m        except ClientError as err:[0m
[30;1m44 | [0m[35m            raise FileNotFoundError from err[0m
[30;1m45 | [0m[35m    # handle base64 embedded images[0m
[30;1m46 | [0m[35m    if path_or_url.startswith("data:image"):[0m
[30;1m47 | [0m[35m        return b64decode(path_or_url.split(",")[-1])[0m
[30;1m48 | [0m[35m    # handle FILE location (of type image)[0m

[31m--[ [0m[34mMatch #[0m[33m1354[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/images.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35mimport itertools[0m
[30;1m7 | [0m[35mimport os[0m
[30;1m8 | [0m[35mimport random[0m
[30;1m9 | [0m[35mfrom base64 import b64decode[0m
[30;1m10 | [0m[35mfrom collections.abc import Iterable[0m
[30;1m11 | [0m[35mfrom io import BytesIO[0m
[30;1m12 | [0m[35mfrom typing import TYPE_CHECKING[0m

[31m--[ [0m[34mMatch #[0m[33m1355[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m        """Wait for the external party to call the callback and return any query strings."""[0m
[30;1m65 | [0m[35m        try:[0m
[30;1m66 | [0m[35m            async with asyncio.timeout(timeout):[0m
[30;1m67 | [0m[35m                return await self._callback_response.get()[0m
[30;1m68 | [0m[35m        except TimeoutError as err:[0m
[30;1m69 | [0m[35m            raise LoginFailed("Timeout while waiting for authentication callback") from err[0m
[30;1m70 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1356[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/dsp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m36 | [0m[35m            all_channels = [AudioChannel.FL, AudioChannel.FR][0m
[30;1m37 | [0m[35m            for channel_id in all_channels:[0m
[30;1m38 | [0m[35m                # Get gain for this channel, default to 0 if not specified[0m
[30;1m39 | [0m[35m                gain_db = dsp_filter.per_channel_preamp.get(channel_id, 0)[0m
[30;1m40 | [0m[35m                # Apply both the overall preamp and the per-channel preamp[0m
[30;1m41 | [0m[35m                total_gain_db = dsp_filter.preamp + gain_db[0m
[30;1m42 | [0m[35m                if total_gain_db != 0:[0m

[31m--[ [0m[34mMatch #[0m[33m1357[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/_template_music_provider/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m118 | [0m[35m    which in turn is a subclass of the generic Provider model.[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m    The base implementation already takes care of some convenience methods,[0m
[30;1m121 | [0m[35m    such as the mass object and the logger. Take a look at the base class[0m
[30;1m122 | [0m[35m    for more information on what is available.[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m    Just like with any other subclass, make sure that if you override[0m

[31m--[ [0m[34mMatch #[0m[33m1358[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/_template_music_provider/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m5 | [0m[35mIts meant to get started developing a new music provider for Music Assistant.[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mUse it as a reference to discover what methods exists and what they should return.[0m
[30;1m8 | [0m[35mAlso it is good to look at existing music providers to get a better understanding,[0m
[30;1m9 | [0m[35mdue to the fact that providers may be flexible and support different features.[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mIf you are relying on a third-party library to interact with the music source,[0m

[31m--[ [0m[34mMatch #[0m[33m1359[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/_template_music_provider/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m170 | [0m[35m        # This is an optional method that you can implement if[0m
[30;1m171 | [0m[35m        # relevant or leave out completely if not needed.[0m
[30;1m172 | [0m[35m        # It will be called when the provider is unloaded from Music Assistant.[0m
[30;1m173 | [0m[35m        # for example to disconnect from a service or clean up resources.[0m
[30;1m174 | [0m[35m[0m
[30;1m175 | [0m[35m    @property[0m
[30;1m176 | [0m[35m    def is_streaming_provider(self) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m1360[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/_template_music_provider/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35mIMPORTANT NOTE:[0m
[30;1m31 | [0m[35mWe strongly recommend developing on either MacOS or Linux and start your development[0m
[30;1m32 | [0m[35menvironment by running the setup.sh script in the scripts folder of the repository.[0m
[30;1m33 | [0m[35mThis will create a virtual environment and install all dependencies needed for development.[0m
[30;1m34 | [0m[35mSee also our general DEVELOPMENT.md guide in the repository for more information.[0m
[30;1m35 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1361[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/listenbrainz_scrobble/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m142 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m143 | [0m[35m            label="User Token",[0m
[30;1m144 | [0m[35m            required=True,[0m
[30;1m145 | [0m[35m            value=values.get(CONF_USER_TOKEN) if values else None,[0m
[30;1m146 | [0m[35m        ),[0m
[30;1m147 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m1362[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/listenbrainz_scrobble/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mimport asyncio[0m
[30;1m8 | [0m[35mimport logging[0m
[30;1m9 | [0m[35mimport time[0m
[30;1m10 | [0m[35mfrom collections.abc import Callable[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mfrom liblistenbrainz import Listen, ListenBrainz[0m
[30;1m13 | [0m[35mfrom music_assistant_models.config_entries import ConfigEntry, ConfigValueType, ProviderConfig[0m

[31m--[ [0m[34mMatch #[0m[33m1363[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/constants.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m371 | [0m[35m    "the FLAC codec because it offers some compression while still remaining lossless \n\n"[0m
[30;1m372 | [0m[35m    "Some players however do not support FLAC and require the stream to be packed "[0m
[30;1m373 | [0m[35m    "into e.g. a lossy mp3 codec or you like to save some network bandwidth. \n\n "[0m
[30;1m374 | [0m[35m    "Choosing a lossy codec saves some bandwidth at the cost of audio quality.",[0m
[30;1m375 | [0m[35m    category="advanced",[0m
[30;1m376 | [0m[35m)[0m
[30;1m377 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1364[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/constants.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m603 | [0m[35m    "Music Assistant will automatically discover all players on the network. "[0m
[30;1m604 | [0m[35m    "using multicast discovery on the (L2) local network, such as mDNS or UPNP.\n\n"[0m
[30;1m605 | [0m[35m    "In case of special network setups or when you run into issues where "[0m
[30;1m606 | [0m[35m    "one or more players are not discovered, you can manually add the IP "[0m
[30;1m607 | [0m[35m    "addresses of the players here. \n\n"[0m
[30;1m608 | [0m[35m    "Note that this setting is not recommended for normal use and should only be used "[0m
[30;1m609 | [0m[35m    "if you know what you are doing. Also, if players are not on the same subnet as"[0m

[31m--[ [0m[34mMatch #[0m[33m1365[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/constants.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m598 | [0m[35mCONF_ENTRY_MANUAL_DISCOVERY_IPS = ConfigEntry([0m
[30;1m599 | [0m[35m    key="manual_discovery_ip_addresses",[0m
[30;1m600 | [0m[35m    type=ConfigEntryType.STRING,[0m
[30;1m601 | [0m[35m    label="Manual IP addresses for discovery",[0m
[30;1m602 | [0m[35m    description="In normal circumstances, "[0m
[30;1m603 | [0m[35m    "Music Assistant will automatically discover all players on the network. "[0m
[30;1m604 | [0m[35m    "using multicast discovery on the (L2) local network, such as mDNS or UPNP.\n\n"[0m

[31m--[ [0m[34mMatch #[0m[33m1366[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/mass.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m650 | [0m[35m            raise SetupFailedError(msg) from err[0m
[30;1m651 | [0m[35m[0m
[30;1m652 | [0m[35m        domain = conf.domain[0m
[30;1m653 | [0m[35m        prov_manifest = self._provider_manifests.get(domain)[0m
[30;1m654 | [0m[35m        # check for other instances of this provider[0m
[30;1m655 | [0m[35m        existing = next((x for x in self.providers if x.domain == domain), None)[0m
[30;1m656 | [0m[35m        if existing and prov_manifest and not prov_manifest.multi_instance:[0m

[31m--[ [0m[34mMatch #[0m[33m1367[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/mass.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m563 | [0m[35m[0m
[30;1m564 | [0m[35m    async def unload_provider(self, instance_id: str, is_removed: bool = False) -> None:[0m
[30;1m565 | [0m[35m        """Unload a provider."""[0m
[30;1m566 | [0m[35m        if provider := self._providers.get(instance_id):[0m
[30;1m567 | [0m[35m            # remove mdns discovery if needed[0m
[30;1m568 | [0m[35m            if provider.manifest.mdns_discovery:[0m
[30;1m569 | [0m[35m                for mdns_type in provider.manifest.mdns_discovery:[0m

[31m--[ [0m[34mMatch #[0m[33m1368[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/mass.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m446 | [0m[35m[0m
[30;1m447 | [0m[35m    def get_task(self, task_id: str) -> asyncio.Task[Any]:[0m
[30;1m448 | [0m[35m        """Get existing scheduled task."""[0m
[30;1m449 | [0m[35m        if existing := self._tracked_tasks.get(task_id):[0m
[30;1m450 | [0m[35m            # prevent duplicate tasks if task_id is given and already present[0m
[30;1m451 | [0m[35m            return existing[0m
[30;1m452 | [0m[35m        msg = "Task does not exist"[0m

[31m--[ [0m[34mMatch #[0m[33m1369[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/mass.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m419 | [0m[35m        if not task_id:[0m
[30;1m420 | [0m[35m            task_id = uuid4().hex[0m
[30;1m421 | [0m[35m[0m
[30;1m422 | [0m[35m        if existing := self._tracked_timers.get(task_id):[0m
[30;1m423 | [0m[35m            existing.cancel()[0m
[30;1m424 | [0m[35m[0m
[30;1m425 | [0m[35m        if ENABLE_DEBUG and not isinstance(threading.current_thread(), threading._MainThread):  # ty[0m

[31m--[ [0m[34mMatch #[0m[33m1370[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/mass.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m357 | [0m[35m[0m
[30;1m358 | [0m[35m        Tasks created by this helper will be properly cancelled on stop.[0m
[30;1m359 | [0m[35m        """[0m
[30;1m360 | [0m[35m        if task_id and (existing := self._tracked_tasks.get(task_id)) and not existing.done():[0m
[30;1m361 | [0m[35m            # prevent duplicate tasks if task_id is given and already present[0m
[30;1m362 | [0m[35m            if abort_existing:[0m
[30;1m363 | [0m[35m                existing.cancel()[0m

[31m--[ [0m[34mMatch #[0m[33m1371[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/mass.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m271 | [0m[35m    ) -> ProviderInstanceType | None:[0m
[30;1m272 | [0m[35m        """Return provider by instance id or domain."""[0m
[30;1m273 | [0m[35m        # lookup by instance_id first[0m
[30;1m274 | [0m[35m        if prov := self._providers.get(provider_instance_or_domain):[0m
[30;1m275 | [0m[35m            if return_unavailable or prov.available:[0m
[30;1m276 | [0m[35m                return prov[0m
[30;1m277 | [0m[35m            if not getattr(prov, "is_streaming_provider", None):[0m

[31m--[ [0m[34mMatch #[0m[33m1372[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/mass.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m220 | [0m[35m        """Return unique ID of this server."""[0m
[30;1m221 | [0m[35m        if not self.config.initialized:[0m
[30;1m222 | [0m[35m            return ""[0m
[30;1m223 | [0m[35m        return self.config.get(CONF_SERVER_ID)  # type: ignore[no-any-return][0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35m    @api_command("info")[0m
[30;1m226 | [0m[35m    def get_server_info(self) -> ServerInfoMessage:[0m

[31m--[ [0m[34mMatch #[0m[33m1373[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/mass.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m    EventCallBackType, tuple[EventType, ...] | None, tuple[str, ...] | None[0m
[30;1m78 | [0m[35m][0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35mENABLE_DEBUG = os.environ.get("PYTHONDEVMODE") == "1"[0m
[30;1m81 | [0m[35mLOGGER = logging.getLogger(MASS_LOGGER_NAME)[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35mBASE_DIR = os.path.dirname(os.path.abspath(__file__))[0m

[31m--[ [0m[34mMatch #[0m[33m1374[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/mass.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m629 | [0m[35m        for prov_conf in prov_configs:[0m
[30;1m630 | [0m[35m            if not prov_conf.enabled:[0m
[30;1m631 | [0m[35m                continue[0m
[30;1m632 | [0m[35m            # Use a task so we can load multiple providers at once.[0m
[30;1m633 | [0m[35m            # If a provider fails, that will not block the loading of other providers.[0m
[30;1m634 | [0m[35m            self.create_task(self.load_provider(prov_conf.instance_id, allow_retry=True))[0m
[30;1m635 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1375[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/mass.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m792 | [0m[35m        name: str,[0m
[30;1m793 | [0m[35m        state_change: ServiceStateChange,[0m
[30;1m794 | [0m[35m    ) -> None:[0m
[30;1m795 | [0m[35m        """Handle MDNS service state callback."""[0m
[30;1m796 | [0m[35m[0m
[30;1m797 | [0m[35m        async def process_mdns_state_change(prov: ProviderInstanceType) -> None:[0m
[30;1m798 | [0m[35m            if state_change == ServiceStateChange.Removed:[0m

[31m--[ [0m[34mMatch #[0m[33m1376[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/mass.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m302 | [0m[35m            )[0m
[30;1m303 | [0m[35m[0m
[30;1m304 | [0m[35m        if LOGGER.isEnabledFor(VERBOSE_LOG_LEVEL):[0m
[30;1m305 | [0m[35m            # do not log queue time updated events because that is too chatty[0m
[30;1m306 | [0m[35m            LOGGER.getChild("event").log(VERBOSE_LOG_LEVEL, "%s %s", event.value, object_id or "")[0m
[30;1m307 | [0m[35m[0m
[30;1m308 | [0m[35m        event_obj = MassEvent(event=event, object_id=object_id, data=data)[0m

[31m--[ [0m[34mMatch #[0m[33m1377[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/helpers.py[0m
   Pattern: [32m.hostname[0m
[30;1m96 | [0m[35m    elif hostname.startswith("sonos"):[0m
[30;1m97 | [0m[35m        baseuid = hostname.removeprefix("sonos").replace(".local.", "")[0m
[30;1m98 | [0m[35m    else:[0m
[30;1m99 | [0m[35m        msg = f"{hostname} is not a sonos device."[0m
[30;1m100 | [0m[35m        raise ValueError(msg)[0m
[30;1m101 | [0m[35m    return f"{UID_PREFIX}{baseuid}{UID_POSTFIX}"[0m
[30;1m102 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1378[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/helpers.py[0m
   Pattern: [32m.hostname[0m
[30;1m94 | [0m[35m    if hostname.startswith("Sonos-"):[0m
[30;1m95 | [0m[35m        baseuid = hostname.removeprefix("Sonos-").replace(".local.", "")[0m
[30;1m96 | [0m[35m    elif hostname.startswith("sonos"):[0m
[30;1m97 | [0m[35m        baseuid = hostname.removeprefix("sonos").replace(".local.", "")[0m
[30;1m98 | [0m[35m    else:[0m
[30;1m99 | [0m[35m        msg = f"{hostname} is not a sonos device."[0m
[30;1m100 | [0m[35m        raise ValueError(msg)[0m

[31m--[ [0m[34mMatch #[0m[33m1379[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/helpers.py[0m
   Pattern: [32m.hostname[0m
[30;1m93 | [0m[35m    """Convert a Sonos hostname to a uid."""[0m
[30;1m94 | [0m[35m    if hostname.startswith("Sonos-"):[0m
[30;1m95 | [0m[35m        baseuid = hostname.removeprefix("Sonos-").replace(".local.", "")[0m
[30;1m96 | [0m[35m    elif hostname.startswith("sonos"):[0m
[30;1m97 | [0m[35m        baseuid = hostname.removeprefix("sonos").replace(".local.", "")[0m
[30;1m98 | [0m[35m    else:[0m
[30;1m99 | [0m[35m        msg = f"{hostname} is not a sonos device."[0m

[31m--[ [0m[34mMatch #[0m[33m1380[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/helpers.py[0m
   Pattern: [32m.hostname[0m
[30;1m92 | [0m[35mdef hostname_to_uid(hostname: str) -> str:[0m
[30;1m93 | [0m[35m    """Convert a Sonos hostname to a uid."""[0m
[30;1m94 | [0m[35m    if hostname.startswith("Sonos-"):[0m
[30;1m95 | [0m[35m        baseuid = hostname.removeprefix("Sonos-").replace(".local.", "")[0m
[30;1m96 | [0m[35m    elif hostname.startswith("sonos"):[0m
[30;1m97 | [0m[35m        baseuid = hostname.removeprefix("sonos").replace(".local.", "")[0m
[30;1m98 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m1381[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/helpers.py[0m
   Pattern: [32m.hostname[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35mdef hostname_to_uid(hostname: str) -> str:[0m
[30;1m93 | [0m[35m    """Convert a Sonos hostname to a uid."""[0m
[30;1m94 | [0m[35m    if hostname.startswith("Sonos-"):[0m
[30;1m95 | [0m[35m        baseuid = hostname.removeprefix("Sonos-").replace(".local.", "")[0m
[30;1m96 | [0m[35m    elif hostname.startswith("sonos"):[0m
[30;1m97 | [0m[35m        baseuid = hostname.removeprefix("sonos").replace(".local.", "")[0m

[31m--[ [0m[34mMatch #[0m[33m1382[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/helpers.py[0m
   Pattern: [32m.hostname[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35mdef hostname_to_uid(hostname: str) -> str:[0m
[30;1m93 | [0m[35m    """Convert a Sonos hostname to a uid."""[0m
[30;1m94 | [0m[35m    if hostname.startswith("Sonos-"):[0m
[30;1m95 | [0m[35m        baseuid = hostname.removeprefix("Sonos-").replace(".local.", "")[0m
[30;1m96 | [0m[35m    elif hostname.startswith("sonos"):[0m

[31m--[ [0m[34mMatch #[0m[33m1383[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/helpers.py[0m
   Pattern: [32m.hostname[0m
[30;1m89 | [0m[35m    return None[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35mdef hostname_to_uid(hostname: str) -> str:[0m
[30;1m93 | [0m[35m    """Convert a Sonos hostname to a uid."""[0m
[30;1m94 | [0m[35m    if hostname.startswith("Sonos-"):[0m
[30;1m95 | [0m[35m        baseuid = hostname.removeprefix("Sonos-").replace(".local.", "")[0m

[31m--[ [0m[34mMatch #[0m[33m1384[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/helpers.py[0m
   Pattern: [32m.hostname[0m
[30;1m89 | [0m[35m    return None[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35mdef hostname_to_uid(hostname: str) -> str:[0m
[30;1m93 | [0m[35m    """Convert a Sonos hostname to a uid."""[0m
[30;1m94 | [0m[35m    if hostname.startswith("Sonos-"):[0m
[30;1m95 | [0m[35m        baseuid = hostname.removeprefix("Sonos-").replace(".local.", "")[0m

[31m--[ [0m[34mMatch #[0m[33m1385[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35mdef soco_error([0m
[30;1m47 | [0m[35m    errorcodes: list[str] | None = None,[0m
[30;1m48 | [0m[35m) -> Callable[[_FuncType[_T, _P, _R]], _ReturnFuncType[_T, _P, _R]]:[0m
[30;1m49 | [0m[35m    """Filter out specified UPnP errors and raise exceptions for service calls."""[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    def decorator(funct: _FuncType[_T, _P, _R]) -> _ReturnFuncType[_T, _P, _R]:[0m
[30;1m52 | [0m[35m        """Decorate functions."""[0m

[31m--[ [0m[34mMatch #[0m[33m1386[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/__main__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m190 | [0m[35m    log_level = hass_options.get("log_level", args.log_level).upper()[0m
[30;1m191 | [0m[35m    dev_mode = os.environ.get("PYTHONDEVMODE", "0") == "1"[0m
[30;1m192 | [0m[35m    safe_mode = bool([0m
[30;1m193 | [0m[35m        args.safe_mode or hass_options.get("safe_mode") or os.environ.get("MASS_SAFE_MODE")[0m
[30;1m194 | [0m[35m    )[0m
[30;1m195 | [0m[35m[0m
[30;1m196 | [0m[35m    # setup logger[0m

[31m--[ [0m[34mMatch #[0m[33m1387[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/__main__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m190 | [0m[35m    log_level = hass_options.get("log_level", args.log_level).upper()[0m
[30;1m191 | [0m[35m    dev_mode = os.environ.get("PYTHONDEVMODE", "0") == "1"[0m
[30;1m192 | [0m[35m    safe_mode = bool([0m
[30;1m193 | [0m[35m        args.safe_mode or hass_options.get("safe_mode") or os.environ.get("MASS_SAFE_MODE")[0m
[30;1m194 | [0m[35m    )[0m
[30;1m195 | [0m[35m[0m
[30;1m196 | [0m[35m    # setup logger[0m

[31m--[ [0m[34mMatch #[0m[33m1388[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/__main__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m    # prefer value in hass_options[0m
[30;1m190 | [0m[35m    log_level = hass_options.get("log_level", args.log_level).upper()[0m
[30;1m191 | [0m[35m    dev_mode = os.environ.get("PYTHONDEVMODE", "0") == "1"[0m
[30;1m192 | [0m[35m    safe_mode = bool([0m
[30;1m193 | [0m[35m        args.safe_mode or hass_options.get("safe_mode") or os.environ.get("MASS_SAFE_MODE")[0m
[30;1m194 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m1389[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/__main__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m187 | [0m[35m        hass_options = {}[0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m    # prefer value in hass_options[0m
[30;1m190 | [0m[35m    log_level = hass_options.get("log_level", args.log_level).upper()[0m
[30;1m191 | [0m[35m    dev_mode = os.environ.get("PYTHONDEVMODE", "0") == "1"[0m
[30;1m192 | [0m[35m    safe_mode = bool([0m
[30;1m193 | [0m[35m        args.safe_mode or hass_options.get("safe_mode") or os.environ.get("MASS_SAFE_MODE")[0m

[31m--[ [0m[34mMatch #[0m[33m1390[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/__main__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m153 | [0m[35m        kwargs["exc_info"] = (type(exception), exception, exception.__traceback__)[0m
[30;1m154 | [0m[35m[0m
[30;1m155 | [0m[35m    logger = logging.getLogger(__package__)[0m
[30;1m156 | [0m[35m    if source_traceback := context.get("source_traceback"):[0m
[30;1m157 | [0m[35m        stack_summary = "".join(traceback.format_list(source_traceback))[0m
[30;1m158 | [0m[35m        logger.error([0m
[30;1m159 | [0m[35m            "Error doing job: %s: %s",[0m

[31m--[ [0m[34mMatch #[0m[33m1391[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/__main__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m149 | [0m[35mdef _global_loop_exception_handler(_: Any, context: dict[str, Any]) -> None:[0m
[30;1m150 | [0m[35m    """Handle all exception inside the core loop."""[0m
[30;1m151 | [0m[35m    kwargs = {}[0m
[30;1m152 | [0m[35m    if exception := context.get("exception"):[0m
[30;1m153 | [0m[35m        kwargs["exc_info"] = (type(exception), exception, exception.__traceback__)[0m
[30;1m154 | [0m[35m[0m
[30;1m155 | [0m[35m    logger = logging.getLogger(__package__)[0m

[31m--[ [0m[34mMatch #[0m[33m1392[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/__main__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m50 | [0m[35m    parser.add_argument([0m
[30;1m51 | [0m[35m        "--log-level",[0m
[30;1m52 | [0m[35m        type=str,[0m
[30;1m53 | [0m[35m        default=os.environ.get("LOG_LEVEL", "info"),[0m
[30;1m54 | [0m[35m        help="Provide logging level. Example --log-level debug, "[0m
[30;1m55 | [0m[35m        "default=info, possible=(critical, error, warning, info, debug, verbose)",[0m
[30;1m56 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m1393[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/__main__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m95 | [0m[35m    # setup file handler[0m
[30;1m96 | [0m[35m    log_filename = os.path.join(data_path, "musicassistant.log")[0m
[30;1m97 | [0m[35m    file_handler = RotatingFileHandler(log_filename, maxBytes=MAX_LOG_FILESIZE, backupCount=1)[0m
[30;1m98 | [0m[35m    # rotate log at each start[0m
[30;1m99 | [0m[35m    with suppress(OSError):[0m
[30;1m100 | [0m[35m        file_handler.doRollover()[0m
[30;1m101 | [0m[35m    file_handler.setFormatter(logging.Formatter(log_fmt, datefmt=FORMAT_DATETIME))[0m

[31m--[ [0m[34mMatch #[0m[33m1394[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/__main__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m    default_data_dir = os.getenv("APPDATA") if os.name == "nt" else os.path.expanduser("~")[0m
[30;1m39 | [0m[35m    if not default_data_dir:[0m
[30;1m40 | [0m[35m        parser.error("Unable to find default data dir")[0m
[30;1m41 | [0m[35m    default_data_dir = os.path.join(default_data_dir, ".musicassistant")[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m    parser.add_argument([0m

[31m--[ [0m[34mMatch #[0m[33m1395[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/playlists.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m148 | [0m[35m) -> list[PlaylistItem]:[0m
[30;1m149 | [0m[35m    """Parse an online m3u or pls playlist."""[0m
[30;1m150 | [0m[35m    try:[0m
[30;1m151 | [0m[35m        async with mass.http_session.get(url, allow_redirects=True, timeout=5) as resp:[0m
[30;1m152 | [0m[35m            try:[0m
[30;1m153 | [0m[35m                raw_data = await resp.content.read(64 * 1024)[0m
[30;1m154 | [0m[35m                # NOTE: using resp.charset is not reliable, we need to detect it ourselves[0m

[31m--[ [0m[34mMatch #[0m[33m1396[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/playlists.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m        playlist.append([0m
[30;1m137 | [0m[35m            PlaylistItem([0m
[30;1m138 | [0m[35m                length=length if length and length != "-1" else None,[0m
[30;1m139 | [0m[35m                title=playlist_section.get(f"Title{entry}"),[0m
[30;1m140 | [0m[35m                path=itempath,[0m
[30;1m141 | [0m[35m            )[0m
[30;1m142 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1397[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/playlists.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m132 | [0m[35m        if file_option not in playlist_section:[0m
[30;1m133 | [0m[35m            continue[0m
[30;1m134 | [0m[35m        itempath = playlist_section[file_option][0m
[30;1m135 | [0m[35m        length = playlist_section.get(f"Length{entry}")[0m
[30;1m136 | [0m[35m        playlist.append([0m
[30;1m137 | [0m[35m            PlaylistItem([0m
[30;1m138 | [0m[35m                length=length if length and length != "-1" else None,[0m

[31m--[ [0m[34mMatch #[0m[33m1398[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/playlists.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m    @property[0m
[30;1m44 | [0m[35m    def is_url(self) -> bool:[0m
[30;1m45 | [0m[35m        """Validate the URL can be parsed and at least has scheme + netloc."""[0m
[30;1m46 | [0m[35m        result = urlparse(self.path)[0m
[30;1m47 | [0m[35m        return all([result.scheme, result.netloc])[0m
[30;1m48 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1399[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m784 | [0m[35m        """[0m
[30;1m785 | [0m[35m        track_info: dict[str, Any] = self.soco.get_current_track_info()[0m
[30;1m786 | [0m[35m        track_info[DURATION_SECONDS] = _timespan_secs(track_info.get("duration"))[0m
[30;1m787 | [0m[35m        track_info[POSITION_SECONDS] = _timespan_secs(track_info.get("position"))[0m
[30;1m788 | [0m[35m        return track_info[0m
[30;1m789 | [0m[35m[0m
[30;1m790 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1400[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m783 | [0m[35m        Add converted position values (NOT async fiendly).[0m
[30;1m784 | [0m[35m        """[0m
[30;1m785 | [0m[35m        track_info: dict[str, Any] = self.soco.get_current_track_info()[0m
[30;1m786 | [0m[35m        track_info[DURATION_SECONDS] = _timespan_secs(track_info.get("duration"))[0m
[30;1m787 | [0m[35m        track_info[POSITION_SECONDS] = _timespan_secs(track_info.get("position"))[0m
[30;1m788 | [0m[35m        return track_info[0m
[30;1m789 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1401[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m698 | [0m[35m    ) -> None:[0m
[30;1m699 | [0m[35m        """Update state when playing music tracks."""[0m
[30;1m700 | [0m[35m        duration = position_info.get(DURATION_SECONDS)[0m
[30;1m701 | [0m[35m        current_position = position_info.get(POSITION_SECONDS)[0m
[30;1m702 | [0m[35m[0m
[30;1m703 | [0m[35m        if not (duration or current_position):[0m
[30;1m704 | [0m[35m            self.position = None[0m

[31m--[ [0m[34mMatch #[0m[33m1402[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m697 | [0m[35m        self, position_info: dict[str, int], force_update: bool = False[0m
[30;1m698 | [0m[35m    ) -> None:[0m
[30;1m699 | [0m[35m        """Update state when playing music tracks."""[0m
[30;1m700 | [0m[35m        duration = position_info.get(DURATION_SECONDS)[0m
[30;1m701 | [0m[35m        current_position = position_info.get(POSITION_SECONDS)[0m
[30;1m702 | [0m[35m[0m
[30;1m703 | [0m[35m        if not (duration or current_position):[0m

[31m--[ [0m[34mMatch #[0m[33m1403[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m687 | [0m[35m        self.title = track_info.get("title")[0m
[30;1m688 | [0m[35m        self.image_url = track_info.get("album_art")[0m
[30;1m689 | [0m[35m[0m
[30;1m690 | [0m[35m        playlist_position = int(track_info.get("playlist_position", -1))[0m
[30;1m691 | [0m[35m        if playlist_position > 0:[0m
[30;1m692 | [0m[35m            self.queue_position = playlist_position[0m
[30;1m693 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1404[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m685 | [0m[35m        self.artist = track_info.get("artist")[0m
[30;1m686 | [0m[35m        self.album_name = track_info.get("album")[0m
[30;1m687 | [0m[35m        self.title = track_info.get("title")[0m
[30;1m688 | [0m[35m        self.image_url = track_info.get("album_art")[0m
[30;1m689 | [0m[35m[0m
[30;1m690 | [0m[35m        playlist_position = int(track_info.get("playlist_position", -1))[0m
[30;1m691 | [0m[35m        if playlist_position > 0:[0m

[31m--[ [0m[34mMatch #[0m[33m1405[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m684 | [0m[35m[0m
[30;1m685 | [0m[35m        self.artist = track_info.get("artist")[0m
[30;1m686 | [0m[35m        self.album_name = track_info.get("album")[0m
[30;1m687 | [0m[35m        self.title = track_info.get("title")[0m
[30;1m688 | [0m[35m        self.image_url = track_info.get("album_art")[0m
[30;1m689 | [0m[35m[0m
[30;1m690 | [0m[35m        playlist_position = int(track_info.get("playlist_position", -1))[0m

[31m--[ [0m[34mMatch #[0m[33m1406[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m683 | [0m[35m                return[0m
[30;1m684 | [0m[35m[0m
[30;1m685 | [0m[35m        self.artist = track_info.get("artist")[0m
[30;1m686 | [0m[35m        self.album_name = track_info.get("album")[0m
[30;1m687 | [0m[35m        self.title = track_info.get("title")[0m
[30;1m688 | [0m[35m        self.image_url = track_info.get("album_art")[0m
[30;1m689 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1407[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m682 | [0m[35m                self.title = source[0m
[30;1m683 | [0m[35m                return[0m
[30;1m684 | [0m[35m[0m
[30;1m685 | [0m[35m        self.artist = track_info.get("artist")[0m
[30;1m686 | [0m[35m        self.album_name = track_info.get("album")[0m
[30;1m687 | [0m[35m        self.title = track_info.get("title")[0m
[30;1m688 | [0m[35m        self.image_url = track_info.get("album_art")[0m

[31m--[ [0m[34mMatch #[0m[33m1408[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m674 | [0m[35m        self.uri = track_info["uri"][0m
[30;1m675 | [0m[35m[0m
[30;1m676 | [0m[35m        audio_source = self.soco.music_source_from_uri(self.uri)[0m
[30;1m677 | [0m[35m        if source := SOURCE_MAPPING.get(audio_source):[0m
[30;1m678 | [0m[35m            self.source_name = source[0m
[30;1m679 | [0m[35m            if audio_source in LINEIN_SOURCES:[0m
[30;1m680 | [0m[35m                self.position = None[0m

[31m--[ [0m[34mMatch #[0m[33m1409[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m567 | [0m[35m            self.mass.loop.call_soon_threadsafe(self.mass.players.update, self.player_id)[0m
[30;1m568 | [0m[35m[0m
[30;1m569 | [0m[35m            for joined_uid in group[1:]:[0m
[30;1m570 | [0m[35m                joined_speaker = self.sonos_prov.sonosplayers.get(joined_uid)[0m
[30;1m571 | [0m[35m                if joined_speaker:[0m
[30;1m572 | [0m[35m                    joined_speaker.sync_coordinator = self[0m
[30;1m573 | [0m[35m                    joined_speaker.group_members = group_members[0m

[31m--[ [0m[34mMatch #[0m[33m1410[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m542 | [0m[35m            group_members_ids = [][0m
[30;1m543 | [0m[35m[0m
[30;1m544 | [0m[35m            for uid in group:[0m
[30;1m545 | [0m[35m                speaker = self.sonos_prov.sonosplayers.get(uid)[0m
[30;1m546 | [0m[35m                if speaker:[0m
[30;1m547 | [0m[35m                    self._group_members_missing.discard(uid)[0m
[30;1m548 | [0m[35m                    group_members.append(speaker)[0m

[31m--[ [0m[34mMatch #[0m[33m1411[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m475 | [0m[35m            volume = variables["volume"][0m
[30;1m476 | [0m[35m            self.mass_player.volume_level = int(volume["Master"])[0m
[30;1m477 | [0m[35m[0m
[30;1m478 | [0m[35m        if mute := variables.get("mute"):[0m
[30;1m479 | [0m[35m            self.mass_player.volume_muted = mute["Master"] == "1"[0m
[30;1m480 | [0m[35m[0m
[30;1m481 | [0m[35m        self.update_player()[0m

[31m--[ [0m[34mMatch #[0m[33m1412[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m450 | [0m[35m        if isinstance(et_uri_md, DidlPlaylistContainer):[0m
[30;1m451 | [0m[35m            self.playlist_name = et_uri_md.title[0m
[30;1m452 | [0m[35m[0m
[30;1m453 | [0m[35m        if queue_size := evars.get("number_of_tracks", 0):[0m
[30;1m454 | [0m[35m            self.queue_size = int(queue_size)[0m
[30;1m455 | [0m[35m[0m
[30;1m456 | [0m[35m        if audio_source == MUSIC_SRC_RADIO:[0m

[31m--[ [0m[34mMatch #[0m[33m1413[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m422 | [0m[35m            self.crossfade = bool(int(crossfade))[0m
[30;1m423 | [0m[35m[0m
[30;1m424 | [0m[35m        # Missing transport_state indicates a transient error[0m
[30;1m425 | [0m[35m        if (new_status := event.variables.get("transport_state")) is None:[0m
[30;1m426 | [0m[35m            return[0m
[30;1m427 | [0m[35m[0m
[30;1m428 | [0m[35m        # Ignore transitions, we should get the target state soon[0m

[31m--[ [0m[34mMatch #[0m[33m1414[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m418 | [0m[35m                )[0m
[30;1m419 | [0m[35m            return[0m
[30;1m420 | [0m[35m[0m
[30;1m421 | [0m[35m        if crossfade := event.variables.get("current_crossfade_mode"):[0m
[30;1m422 | [0m[35m            self.crossfade = bool(int(crossfade))[0m
[30;1m423 | [0m[35m[0m
[30;1m424 | [0m[35m        # Missing transport_state indicates a transient error[0m

[31m--[ [0m[34mMatch #[0m[33m1415[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m402 | [0m[35m        current_track_uri = event.variables.get("current_track_uri", "")[0m
[30;1m403 | [0m[35m        if av_transport_uri == current_track_uri and av_transport_uri.startswith("x-rincon:"):[0m
[30;1m404 | [0m[35m            new_coordinator_uid = av_transport_uri.split(":")[-1][0m
[30;1m405 | [0m[35m            if new_coordinator_speaker := self.sonos_prov.sonosplayers.get(new_coordinator_uid):[0m
[30;1m406 | [0m[35m                self.logger.log([0m
[30;1m407 | [0m[35m                    5,[0m
[30;1m408 | [0m[35m                    "Media update coordinator (%s) received for %s",[0m

[31m--[ [0m[34mMatch #[0m[33m1416[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m399 | [0m[35m        # new coordinator will use its media. The regrouping process will[0m
[30;1m400 | [0m[35m        # be completed during the next ZoneGroupState update.[0m
[30;1m401 | [0m[35m        av_transport_uri = event.variables.get("av_transport_uri", "")[0m
[30;1m402 | [0m[35m        current_track_uri = event.variables.get("current_track_uri", "")[0m
[30;1m403 | [0m[35m        if av_transport_uri == current_track_uri and av_transport_uri.startswith("x-rincon:"):[0m
[30;1m404 | [0m[35m            new_coordinator_uid = av_transport_uri.split(":")[-1][0m
[30;1m405 | [0m[35m            if new_coordinator_speaker := self.sonos_prov.sonosplayers.get(new_coordinator_uid):[0m

[31m--[ [0m[34mMatch #[0m[33m1417[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m398 | [0m[35m        # state will be incorrect and should be ignored. Switching to the[0m
[30;1m399 | [0m[35m        # new coordinator will use its media. The regrouping process will[0m
[30;1m400 | [0m[35m        # be completed during the next ZoneGroupState update.[0m
[30;1m401 | [0m[35m        av_transport_uri = event.variables.get("av_transport_uri", "")[0m
[30;1m402 | [0m[35m        current_track_uri = event.variables.get("current_track_uri", "")[0m
[30;1m403 | [0m[35m        if av_transport_uri == current_track_uri and av_transport_uri.startswith("x-rincon:"):[0m
[30;1m404 | [0m[35m            new_coordinator_uid = av_transport_uri.split(":")[-1][0m

[31m--[ [0m[34mMatch #[0m[33m1418[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m656 | [0m[35m            self.mass_player.group_childs.clear()[0m
[30;1m657 | [0m[35m[0m
[30;1m658 | [0m[35m    def _set_basic_track_info(self, update_position: bool = False) -> None:[0m
[30;1m659 | [0m[35m        """Query the speaker to update media metadata and position info."""[0m
[30;1m660 | [0m[35m        self.channel = None[0m
[30;1m661 | [0m[35m        self.duration = None[0m
[30;1m662 | [0m[35m        self.image_url = None[0m

[31m--[ [0m[34mMatch #[0m[33m1419[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m412 | [0m[35m                self.sync_coordinator = new_coordinator_speaker[0m
[30;1m413 | [0m[35m            else:[0m
[30;1m414 | [0m[35m                self.logger.debug([0m
[30;1m415 | [0m[35m                    "Media update coordinator (%s) for %s not yet available",[0m
[30;1m416 | [0m[35m                    new_coordinator_uid,[0m
[30;1m417 | [0m[35m                    self.zone_name,[0m
[30;1m418 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m1420[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m405 | [0m[35m            if new_coordinator_speaker := self.sonos_prov.sonosplayers.get(new_coordinator_uid):[0m
[30;1m406 | [0m[35m                self.logger.log([0m
[30;1m407 | [0m[35m                    5,[0m
[30;1m408 | [0m[35m                    "Media update coordinator (%s) received for %s",[0m
[30;1m409 | [0m[35m                    new_coordinator_speaker.zone_name,[0m
[30;1m410 | [0m[35m                    self.zone_name,[0m
[30;1m411 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m1421[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m393 | [0m[35m[0m
[30;1m394 | [0m[35m    def _handle_avtransport_event(self, event: SonosEvent) -> None:[0m
[30;1m395 | [0m[35m        """Update information about currently playing media from an event."""[0m
[30;1m396 | [0m[35m        # NOTE: The new coordinator can be provided in a media update event but[0m
[30;1m397 | [0m[35m        # before the ZoneGroupState updates. If this happens the playback[0m
[30;1m398 | [0m[35m        # state will be incorrect and should be ignored. Switching to the[0m
[30;1m399 | [0m[35m        # new coordinator will use its media. The regrouping process will[0m

[31m--[ [0m[34mMatch #[0m[33m1422[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m314 | [0m[35m        """Update Sonos Player."""[0m
[30;1m315 | [0m[35m        self._update_attributes()[0m
[30;1m316 | [0m[35m        if signal_update:[0m
[30;1m317 | [0m[35m            # send update to the player manager right away only if we are triggered from an event[0m
[30;1m318 | [0m[35m            # when we're just updating from a manual poll, the player manager[0m
[30;1m319 | [0m[35m            # will detect changes to the player object itself[0m
[30;1m320 | [0m[35m            self.mass.loop.call_soon_threadsafe(self.sonos_prov.mass.players.update, self.player_id)[0m

[31m--[ [0m[34mMatch #[0m[33m1423[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m271 | [0m[35m        return True[0m
[30;1m272 | [0m[35m[0m
[30;1m273 | [0m[35m    def update_ip(self, ip_address: str) -> None:[0m
[30;1m274 | [0m[35m        """Handle updated IP of a Sonos player (NOT async friendly)."""[0m
[30;1m275 | [0m[35m        if self.available:[0m
[30;1m276 | [0m[35m            return[0m
[30;1m277 | [0m[35m        self.logger.debug([0m

[31m--[ [0m[34mMatch #[0m[33m1424[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m223 | [0m[35m                # Create event subscriptions.[0m
[30;1m224 | [0m[35m                subscriptions = [[0m
[30;1m225 | [0m[35m                    self._subscribe_target(getattr(self.soco, service), self._handle_event)[0m
[30;1m226 | [0m[35m                    for service in self.missing_subscriptions[0m
[30;1m227 | [0m[35m                ][0m
[30;1m228 | [0m[35m                if not subscriptions:[0m
[30;1m229 | [0m[35m                    return[0m

[31m--[ [0m[34mMatch #[0m[33m1425[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35m    @property[0m
[30;1m152 | [0m[35m    def missing_subscriptions(self) -> set[str]:[0m
[30;1m153 | [0m[35m        """Return a list of missing service subscriptions."""[0m
[30;1m154 | [0m[35m        subscribed_services = {sub.service.service_type for sub in self._subscriptions}[0m
[30;1m155 | [0m[35m        return SUBSCRIPTION_SERVICES - subscribed_services[0m
[30;1m156 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1426[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35mimport contextlib[0m
[30;1m12 | [0m[35mimport datetime[0m
[30;1m13 | [0m[35mimport logging[0m
[30;1m14 | [0m[35mimport time[0m
[30;1m15 | [0m[35mfrom collections.abc import Callable, Coroutine[0m
[30;1m16 | [0m[35mfrom typing import TYPE_CHECKING, Any[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35mfrom music_assistant_models.enums import PlayerFeature, PlayerState[0m

[31m--[ [0m[34mMatch #[0m[33m1427[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/webserver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m142 | [0m[35m        """Redirect request to correct destination."""[0m
[30;1m143 | [0m[35m        # find handler for the request[0m
[30;1m144 | [0m[35m        for key in (f"{request.method}.{request.path}", f"*.{request.path}"):[0m
[30;1m145 | [0m[35m            if handler := self._dynamic_routes.get(key):[0m
[30;1m146 | [0m[35m                return await handler(request)[0m
[30;1m147 | [0m[35m        # deny all other requests[0m
[30;1m148 | [0m[35m        self.logger.warning([0m

[31m--[ [0m[34mMatch #[0m[33m1428[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/webserver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m140 | [0m[35m[0m
[30;1m141 | [0m[35m    async def _handle_catch_all(self, request: web.Request) -> web.Response:[0m
[30;1m142 | [0m[35m        """Redirect request to correct destination."""[0m
[30;1m143 | [0m[35m        # find handler for the request[0m
[30;1m144 | [0m[35m        for key in (f"{request.method}.{request.path}", f"*.{request.path}"):[0m
[30;1m145 | [0m[35m            if handler := self._dynamic_routes.get(key):[0m
[30;1m146 | [0m[35m                return await handler(request)[0m

[31m--[ [0m[34mMatch #[0m[33m1429[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/scrobbler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m79 | [0m[35m            self.logger.debug("skipped scrobbling due to duplicate event")[0m
[30;1m80 | [0m[35m            return False[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m        # ideally we want more precise control[0m
[30;1m83 | [0m[35m        # but because the event is triggered every 30s[0m
[30;1m84 | [0m[35m        # and we don't have full queue details to determine[0m
[30;1m85 | [0m[35m        # the exact context in which the event was fired[0m
[30;1m86 | [0m[35m        # we can only rely on fully_played for now[0m

[31m--[ [0m[34mMatch #[0m[33m1430[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/scrobbler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m64 | [0m[35m                # TODO: try to make this a more specific exception instead of a generic one[0m
[30;1m65 | [0m[35m                self.logger.exception(err)[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m        # update now playing if needed[0m
[30;1m68 | [0m[35m        if report.is_playing and ([0m
[30;1m69 | [0m[35m            self.currently_playing is None or self.currently_playing != report.uri[0m
[30;1m70 | [0m[35m        ):[0m

[31m--[ [0m[34mMatch #[0m[33m1431[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/scrobbler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m26 | [0m[35m        return True[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    async def _update_now_playing(self, report: MediaItemPlaybackProgressReport) -> None:[0m
[30;1m29 | [0m[35m        """Send a Now Playing update to the scrobbling service."""[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m    async def _scrobble(self, report: MediaItemPlaybackProgressReport) -> None:[0m
[30;1m32 | [0m[35m        """Scrobble."""[0m

[31m--[ [0m[34mMatch #[0m[33m1432[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m78 | [0m[35m                raise KeyError(f"Invalid parameter: '{key}'")[0m
[30;1m79 | [0m[35m    # parse arguments to correct type[0m
[30;1m80 | [0m[35m    for name, param in func_sig.parameters.items():[0m
[30;1m81 | [0m[35m        value = args.get(name)[0m
[30;1m82 | [0m[35m        default = MISSING if param.default is inspect.Parameter.empty else param.default[0m
[30;1m83 | [0m[35m        try:[0m
[30;1m84 | [0m[35m            final_args[name] = parse_value(name, value, func_types[name], default)[0m

[31m--[ [0m[34mMatch #[0m[33m1433[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m149 | [0m[35m            except (KeyError, TypeError, ValueError, MissingField):[0m
[30;1m150 | [0m[35m                pass[0m
[30;1m151 | [0m[35m        # if we get to this point, all possibilities failed[0m
[30;1m152 | [0m[35m        # find out if we should raise or log this[0m
[30;1m153 | [0m[35m        err = ([0m
[30;1m154 | [0m[35m            f"Value {value} of type {type(value)} is invalid for {name}, "[0m
[30;1m155 | [0m[35m            f"expected value of type {value_type}"[0m

[31m--[ [0m[34mMatch #[0m[33m1434[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m83 | [0m[35m        try:[0m
[30;1m84 | [0m[35m            final_args[name] = parse_value(name, value, func_types[name], default)[0m
[30;1m85 | [0m[35m        except TypeError:[0m
[30;1m86 | [0m[35m            # retry one more time with allow_value_convert=True[0m
[30;1m87 | [0m[35m            final_args[name] = parse_value([0m
[30;1m88 | [0m[35m                name, value, func_types[name], default, allow_value_convert=True[0m
[30;1m89 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m1435[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m36 | [0m[35m        """Parse APICommandHandler by providing a function."""[0m
[30;1m37 | [0m[35m        type_hints = get_type_hints(func)[0m
[30;1m38 | [0m[35m        # workaround for generic typevar ItemCls that needs to be resolved[0m
[30;1m39 | [0m[35m        # to the real media item type. TODO: find a better way to do this[0m
[30;1m40 | [0m[35m        # without this hack[0m
[30;1m41 | [0m[35m        for key, value in type_hints.items():[0m
[30;1m42 | [0m[35m            if not hasattr(value, "__name__"):[0m

[31m--[ [0m[34mMatch #[0m[33m1436[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/throttle_retry.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m83 | [0m[35m    @asynccontextmanager[0m
[30;1m84 | [0m[35m    async def acquire(self) -> AsyncGenerator[None, float]:[0m
[30;1m85 | [0m[35m        """Acquire a free slot from the Throttler, returns the throttled time."""[0m
[30;1m86 | [0m[35m        if BYPASS_THROTTLER.get():[0m
[30;1m87 | [0m[35m            yield 0[0m
[30;1m88 | [0m[35m        else:[0m
[30;1m89 | [0m[35m            yield await self.throttler.acquire()[0m

[31m--[ [0m[34mMatch #[0m[33m1437[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/throttle_retry.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m64 | [0m[35m        return cur_time - start_time  # exactly 0 if not throttled[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m    async def __aenter__(self) -> float:[0m
[30;1m67 | [0m[35m        """Wait until the lock is acquired, return the time delay."""[0m
[30;1m68 | [0m[35m        return await self.acquire()[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    async def __aexit__(self, exc_type, exc, tb):[0m

[31m--[ [0m[34mMatch #[0m[33m1438[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/throttle_retry.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m55 | [0m[35m            self._flush()[0m
[30;1m56 | [0m[35m            if len(self._task_logs) < self.rate_limit:[0m
[30;1m57 | [0m[35m                break[0m
[30;1m58 | [0m[35m            # sleep the exact amount of time until the oldest task can be flushed[0m
[30;1m59 | [0m[35m            time_to_release = self._task_logs[0] + self.period - cur_time[0m
[30;1m60 | [0m[35m            await asyncio.sleep(time_to_release)[0m
[30;1m61 | [0m[35m            cur_time = time.monotonic()[0m

[31m--[ [0m[34mMatch #[0m[33m1439[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/throttle_retry.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mimport asyncio[0m
[30;1m4 | [0m[35mimport functools[0m
[30;1m5 | [0m[35mimport logging[0m
[30;1m6 | [0m[35mimport time[0m
[30;1m7 | [0m[35mfrom collections import deque[0m
[30;1m8 | [0m[35mfrom collections.abc import AsyncGenerator, Awaitable, Callable, Coroutine[0m
[30;1m9 | [0m[35mfrom contextlib import asynccontextmanager[0m
[30;1m10 | [0m[35mfrom contextvars import ContextVar[0m

[31m--[ [0m[34mMatch #[0m[33m1440[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m830 | [0m[35m            return obj["images300"][0][0m
[30;1m831 | [0m[35m        if obj.get("album"):[0m
[30;1m832 | [0m[35m            return self.__get_image(obj["album"])[0m
[30;1m833 | [0m[35m        if obj.get("artist"):[0m
[30;1m834 | [0m[35m            return self.__get_image(obj["artist"])[0m
[30;1m835 | [0m[35m        return None[0m

[31m--[ [0m[34mMatch #[0m[33m1441[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m828 | [0m[35m        if obj.get("images300"):[0m
[30;1m829 | [0m[35m            # playlists seem to use this strange format[0m
[30;1m830 | [0m[35m            return obj["images300"][0][0m
[30;1m831 | [0m[35m        if obj.get("album"):[0m
[30;1m832 | [0m[35m            return self.__get_image(obj["album"])[0m
[30;1m833 | [0m[35m        if obj.get("artist"):[0m
[30;1m834 | [0m[35m            return self.__get_image(obj["artist"])[0m

[31m--[ [0m[34mMatch #[0m[33m1442[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m825 | [0m[35m                    if "2a96cbd8b46e442fc41c2b86b821562f" in obj["image"][key]:[0m
[30;1m826 | [0m[35m                        continue[0m
[30;1m827 | [0m[35m                    return obj["image"][key][0m
[30;1m828 | [0m[35m        if obj.get("images300"):[0m
[30;1m829 | [0m[35m            # playlists seem to use this strange format[0m
[30;1m830 | [0m[35m            return obj["images300"][0][0m
[30;1m831 | [0m[35m        if obj.get("album"):[0m

[31m--[ [0m[34mMatch #[0m[33m1443[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m821 | [0m[35m        """Try to parse image from Qobuz media object."""[0m
[30;1m822 | [0m[35m        if obj.get("image"):[0m
[30;1m823 | [0m[35m            for key in ["extralarge", "large", "medium", "small"]:[0m
[30;1m824 | [0m[35m                if obj["image"].get(key):[0m
[30;1m825 | [0m[35m                    if "2a96cbd8b46e442fc41c2b86b821562f" in obj["image"][key]:[0m
[30;1m826 | [0m[35m                        continue[0m
[30;1m827 | [0m[35m                    return obj["image"][key][0m

[31m--[ [0m[34mMatch #[0m[33m1444[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m819 | [0m[35m[0m
[30;1m820 | [0m[35m    def __get_image(self, obj: dict) -> str | None:[0m
[30;1m821 | [0m[35m        """Try to parse image from Qobuz media object."""[0m
[30;1m822 | [0m[35m        if obj.get("image"):[0m
[30;1m823 | [0m[35m            for key in ["extralarge", "large", "medium", "small"]:[0m
[30;1m824 | [0m[35m                if obj["image"].get(key):[0m
[30;1m825 | [0m[35m                    if "2a96cbd8b46e442fc41c2b86b821562f" in obj["image"][key]:[0m

[31m--[ [0m[34mMatch #[0m[33m1445[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m806 | [0m[35m        ) as response:[0m
[30;1m807 | [0m[35m            # handle rate limiter[0m
[30;1m808 | [0m[35m            if response.status == 429:[0m
[30;1m809 | [0m[35m                backoff_time = int(response.headers.get("Retry-After", 0))[0m
[30;1m810 | [0m[35m                raise ResourceTemporarilyUnavailable("Rate Limiter", backoff_time=backoff_time)[0m
[30;1m811 | [0m[35m            # handle temporary server error[0m
[30;1m812 | [0m[35m            if response.status in (502, 503):[0m

[31m--[ [0m[34mMatch #[0m[33m1446[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m801 | [0m[35m        url = f"http://www.qobuz.com/api.json/0.2/{endpoint}"[0m
[30;1m802 | [0m[35m        params["app_id"] = app_var(0)[0m
[30;1m803 | [0m[35m        params["user_auth_token"] = await self._auth_token()[0m
[30;1m804 | [0m[35m        async with self.mass.http_session.post([0m
[30;1m805 | [0m[35m            url, params=params, json=data, ssl=False[0m
[30;1m806 | [0m[35m        ) as response:[0m
[30;1m807 | [0m[35m            # handle rate limiter[0m

[31m--[ [0m[34mMatch #[0m[33m1447[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m774 | [0m[35m        ):[0m
[30;1m775 | [0m[35m            # handle rate limiter[0m
[30;1m776 | [0m[35m            if response.status == 429:[0m
[30;1m777 | [0m[35m                backoff_time = int(response.headers.get("Retry-After", 0))[0m
[30;1m778 | [0m[35m                raise ResourceTemporarilyUnavailable("Rate Limiter", backoff_time=backoff_time)[0m
[30;1m779 | [0m[35m            # handle temporary server error[0m
[30;1m780 | [0m[35m            if response.status in (502, 503):[0m

[31m--[ [0m[34mMatch #[0m[33m1448[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m770 | [0m[35m            kwargs["app_id"] = app_var(0)[0m
[30;1m771 | [0m[35m            kwargs["user_auth_token"] = await self._auth_token()[0m
[30;1m772 | [0m[35m        async with ([0m
[30;1m773 | [0m[35m            self.mass.http_session.get(url, headers=headers, params=kwargs) as response,[0m
[30;1m774 | [0m[35m        ):[0m
[30;1m775 | [0m[35m            # handle rate limiter[0m
[30;1m776 | [0m[35m            if response.status == 429:[0m

[31m--[ [0m[34mMatch #[0m[33m1449[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m733 | [0m[35m            offset += limit[0m
[30;1m734 | [0m[35m            if not result:[0m
[30;1m735 | [0m[35m                break[0m
[30;1m736 | [0m[35m            if not result.get(key) or not result[key].get("items"):[0m
[30;1m737 | [0m[35m                break[0m
[30;1m738 | [0m[35m            for item in result[key]["items"]:[0m
[30;1m739 | [0m[35m                all_items.append(item)[0m

[31m--[ [0m[34mMatch #[0m[33m1450[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m733 | [0m[35m            offset += limit[0m
[30;1m734 | [0m[35m            if not result:[0m
[30;1m735 | [0m[35m                break[0m
[30;1m736 | [0m[35m            if not result.get(key) or not result[key].get("items"):[0m
[30;1m737 | [0m[35m                break[0m
[30;1m738 | [0m[35m            for item in result[key]["items"]:[0m
[30;1m739 | [0m[35m                all_items.append(item)[0m

[31m--[ [0m[34mMatch #[0m[33m1451[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m654 | [0m[35m            track.metadata.performers = {x.strip() for x in track_obj["performers"].split("-")}[0m
[30;1m655 | [0m[35m        if track_obj.get("copyright"):[0m
[30;1m656 | [0m[35m            track.metadata.copyright = track_obj["copyright"][0m
[30;1m657 | [0m[35m        if track_obj.get("parental_warning"):[0m
[30;1m658 | [0m[35m            track.metadata.explicit = True[0m
[30;1m659 | [0m[35m        if img := self.__get_image(track_obj):[0m
[30;1m660 | [0m[35m            track.metadata.images = [[0m

[31m--[ [0m[34mMatch #[0m[33m1452[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m652 | [0m[35m                track.album = album[0m
[30;1m653 | [0m[35m        if track_obj.get("performers"):[0m
[30;1m654 | [0m[35m            track.metadata.performers = {x.strip() for x in track_obj["performers"].split("-")}[0m
[30;1m655 | [0m[35m        if track_obj.get("copyright"):[0m
[30;1m656 | [0m[35m            track.metadata.copyright = track_obj["copyright"][0m
[30;1m657 | [0m[35m        if track_obj.get("parental_warning"):[0m
[30;1m658 | [0m[35m            track.metadata.explicit = True[0m

[31m--[ [0m[34mMatch #[0m[33m1453[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m650 | [0m[35m            album = await self._parse_album(track_obj["album"])[0m
[30;1m651 | [0m[35m            if album:[0m
[30;1m652 | [0m[35m                track.album = album[0m
[30;1m653 | [0m[35m        if track_obj.get("performers"):[0m
[30;1m654 | [0m[35m            track.metadata.performers = {x.strip() for x in track_obj["performers"].split("-")}[0m
[30;1m655 | [0m[35m        if track_obj.get("copyright"):[0m
[30;1m656 | [0m[35m            track.metadata.copyright = track_obj["copyright"][0m

[31m--[ [0m[34mMatch #[0m[33m1454[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m619 | [0m[35m        # try to grab artist from album[0m
[30;1m620 | [0m[35m        if not track.artists and ([0m
[30;1m621 | [0m[35m            track_obj.get("album")[0m
[30;1m622 | [0m[35m            and track_obj["album"].get("artist")[0m
[30;1m623 | [0m[35m            and "Various " not in track_obj["album"]["artist"][0m
[30;1m624 | [0m[35m        ):[0m
[30;1m625 | [0m[35m            artist = self._parse_artist(track_obj["album"]["artist"])[0m

[31m--[ [0m[34mMatch #[0m[33m1455[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m618 | [0m[35m                track.artists.append(artist)[0m
[30;1m619 | [0m[35m        # try to grab artist from album[0m
[30;1m620 | [0m[35m        if not track.artists and ([0m
[30;1m621 | [0m[35m            track_obj.get("album")[0m
[30;1m622 | [0m[35m            and track_obj["album"].get("artist")[0m
[30;1m623 | [0m[35m            and "Various " not in track_obj["album"]["artist"][0m
[30;1m624 | [0m[35m        ):[0m

[31m--[ [0m[34mMatch #[0m[33m1456[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m612 | [0m[35m        )[0m
[30;1m613 | [0m[35m        if isrc := track_obj.get("isrc"):[0m
[30;1m614 | [0m[35m            track.external_ids.add((ExternalID.ISRC, isrc))[0m
[30;1m615 | [0m[35m        if track_obj.get("performer") and "Various " not in track_obj["performer"]:[0m
[30;1m616 | [0m[35m            artist = self._parse_artist(track_obj["performer"])[0m
[30;1m617 | [0m[35m            if artist:[0m
[30;1m618 | [0m[35m                track.artists.append(artist)[0m

[31m--[ [0m[34mMatch #[0m[33m1457[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m610 | [0m[35m            disc_number=track_obj.get("media_number", 0),[0m
[30;1m611 | [0m[35m            track_number=track_obj.get("track_number", 0),[0m
[30;1m612 | [0m[35m        )[0m
[30;1m613 | [0m[35m        if isrc := track_obj.get("isrc"):[0m
[30;1m614 | [0m[35m            track.external_ids.add((ExternalID.ISRC, isrc))[0m
[30;1m615 | [0m[35m        if track_obj.get("performer") and "Various " not in track_obj["performer"]:[0m
[30;1m616 | [0m[35m            artist = self._parse_artist(track_obj["performer"])[0m

[31m--[ [0m[34mMatch #[0m[33m1458[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m608 | [0m[35m                )[0m
[30;1m609 | [0m[35m            },[0m
[30;1m610 | [0m[35m            disc_number=track_obj.get("media_number", 0),[0m
[30;1m611 | [0m[35m            track_number=track_obj.get("track_number", 0),[0m
[30;1m612 | [0m[35m        )[0m
[30;1m613 | [0m[35m        if isrc := track_obj.get("isrc"):[0m
[30;1m614 | [0m[35m            track.external_ids.add((ExternalID.ISRC, isrc))[0m

[31m--[ [0m[34mMatch #[0m[33m1459[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m607 | [0m[35m                    url=f"https://open.qobuz.com/track/{track_obj['id']}",[0m
[30;1m608 | [0m[35m                )[0m
[30;1m609 | [0m[35m            },[0m
[30;1m610 | [0m[35m            disc_number=track_obj.get("media_number", 0),[0m
[30;1m611 | [0m[35m            track_number=track_obj.get("track_number", 0),[0m
[30;1m612 | [0m[35m        )[0m
[30;1m613 | [0m[35m        if isrc := track_obj.get("isrc"):[0m

[31m--[ [0m[34mMatch #[0m[33m1460[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m586 | [0m[35m[0m
[30;1m587 | [0m[35m    async def _parse_track(self, track_obj: dict) -> Track:[0m
[30;1m588 | [0m[35m        """Parse qobuz track object to generic layout."""[0m
[30;1m589 | [0m[35m        name, version = parse_title_and_version(track_obj["title"], track_obj.get("version"))[0m
[30;1m590 | [0m[35m        track = Track([0m
[30;1m591 | [0m[35m            item_id=str(track_obj["id"]),[0m
[30;1m592 | [0m[35m            provider=self.domain,[0m

[31m--[ [0m[34mMatch #[0m[33m1461[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m580 | [0m[35m            album.metadata.copyright = album_obj["copyright"][0m
[30;1m581 | [0m[35m        if album_obj.get("description"):[0m
[30;1m582 | [0m[35m            album.metadata.description = album_obj["description"][0m
[30;1m583 | [0m[35m        if album_obj.get("parental_warning"):[0m
[30;1m584 | [0m[35m            album.metadata.explicit = True[0m
[30;1m585 | [0m[35m        return album[0m
[30;1m586 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1462[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m578 | [0m[35m                album.year = datetime.datetime.fromtimestamp(released_at).year[0m
[30;1m579 | [0m[35m        if album_obj.get("copyright"):[0m
[30;1m580 | [0m[35m            album.metadata.copyright = album_obj["copyright"][0m
[30;1m581 | [0m[35m        if album_obj.get("description"):[0m
[30;1m582 | [0m[35m            album.metadata.description = album_obj["description"][0m
[30;1m583 | [0m[35m        if album_obj.get("parental_warning"):[0m
[30;1m584 | [0m[35m            album.metadata.explicit = True[0m

[31m--[ [0m[34mMatch #[0m[33m1463[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m576 | [0m[35m        if released_at := album_obj.get("released_at"):[0m
[30;1m577 | [0m[35m            with suppress(ValueError):[0m
[30;1m578 | [0m[35m                album.year = datetime.datetime.fromtimestamp(released_at).year[0m
[30;1m579 | [0m[35m        if album_obj.get("copyright"):[0m
[30;1m580 | [0m[35m            album.metadata.copyright = album_obj["copyright"][0m
[30;1m581 | [0m[35m        if album_obj.get("description"):[0m
[30;1m582 | [0m[35m            album.metadata.description = album_obj["description"][0m

[31m--[ [0m[34mMatch #[0m[33m1464[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m573 | [0m[35m            ][0m
[30;1m574 | [0m[35m        if "label" in album_obj:[0m
[30;1m575 | [0m[35m            album.metadata.label = album_obj["label"]["name"][0m
[30;1m576 | [0m[35m        if released_at := album_obj.get("released_at"):[0m
[30;1m577 | [0m[35m            with suppress(ValueError):[0m
[30;1m578 | [0m[35m                album.year = datetime.datetime.fromtimestamp(released_at).year[0m
[30;1m579 | [0m[35m        if album_obj.get("copyright"):[0m

[31m--[ [0m[34mMatch #[0m[33m1465[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m557 | [0m[35m            album.album_type = AlbumType.COMPILATION[0m
[30;1m558 | [0m[35m        elif ([0m
[30;1m559 | [0m[35m            album_obj.get("product_type", "") == "album"[0m
[30;1m560 | [0m[35m            or album_obj.get("release_type", "") == "album"[0m
[30;1m561 | [0m[35m        ):[0m
[30;1m562 | [0m[35m            album.album_type = AlbumType.ALBUM[0m
[30;1m563 | [0m[35m        if "genre" in album_obj:[0m

[31m--[ [0m[34mMatch #[0m[33m1466[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m556 | [0m[35m        ):[0m
[30;1m557 | [0m[35m            album.album_type = AlbumType.COMPILATION[0m
[30;1m558 | [0m[35m        elif ([0m
[30;1m559 | [0m[35m            album_obj.get("product_type", "") == "album"[0m
[30;1m560 | [0m[35m            or album_obj.get("release_type", "") == "album"[0m
[30;1m561 | [0m[35m        ):[0m
[30;1m562 | [0m[35m            album.album_type = AlbumType.ALBUM[0m

[31m--[ [0m[34mMatch #[0m[33m1467[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m552 | [0m[35m        ):[0m
[30;1m553 | [0m[35m            album.album_type = AlbumType.SINGLE[0m
[30;1m554 | [0m[35m        elif ([0m
[30;1m555 | [0m[35m            album_obj.get("product_type", "") == "compilation" or "Various" in album.artists[0].name[0m
[30;1m556 | [0m[35m        ):[0m
[30;1m557 | [0m[35m            album.album_type = AlbumType.COMPILATION[0m
[30;1m558 | [0m[35m        elif ([0m

[31m--[ [0m[34mMatch #[0m[33m1468[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m548 | [0m[35m        album.artists.append(self._parse_artist(artist_obj or album_obj["artist"]))[0m
[30;1m549 | [0m[35m        if ([0m
[30;1m550 | [0m[35m            album_obj.get("product_type", "") == "single"[0m
[30;1m551 | [0m[35m            or album_obj.get("release_type", "") == "single"[0m
[30;1m552 | [0m[35m        ):[0m
[30;1m553 | [0m[35m            album.album_type = AlbumType.SINGLE[0m
[30;1m554 | [0m[35m        elif ([0m

[31m--[ [0m[34mMatch #[0m[33m1469[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m547 | [0m[35m        album.external_ids.add((ExternalID.BARCODE, album_obj["upc"]))[0m
[30;1m548 | [0m[35m        album.artists.append(self._parse_artist(artist_obj or album_obj["artist"]))[0m
[30;1m549 | [0m[35m        if ([0m
[30;1m550 | [0m[35m            album_obj.get("product_type", "") == "single"[0m
[30;1m551 | [0m[35m            or album_obj.get("release_type", "") == "single"[0m
[30;1m552 | [0m[35m        ):[0m
[30;1m553 | [0m[35m            album.album_type = AlbumType.SINGLE[0m

[31m--[ [0m[34mMatch #[0m[33m1470[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m523 | [0m[35m        if not artist_obj and "artist" not in album_obj:[0m
[30;1m524 | [0m[35m            # artist missing in album info, return full abum instead[0m
[30;1m525 | [0m[35m            return await self.get_album(album_obj["id"])[0m
[30;1m526 | [0m[35m        name, version = parse_title_and_version(album_obj["title"], album_obj.get("version"))[0m
[30;1m527 | [0m[35m        album = Album([0m
[30;1m528 | [0m[35m            item_id=str(album_obj["id"]),[0m
[30;1m529 | [0m[35m            provider=self.domain,[0m

[31m--[ [0m[34mMatch #[0m[33m1471[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m515 | [0m[35m                )[0m
[30;1m516 | [0m[35m            ][0m
[30;1m517 | [0m[35m        if artist_obj.get("biography"):[0m
[30;1m518 | [0m[35m            artist.metadata.description = artist_obj["biography"].get("content")[0m
[30;1m519 | [0m[35m        return artist[0m
[30;1m520 | [0m[35m[0m
[30;1m521 | [0m[35m    async def _parse_album(self, album_obj: dict, artist_obj: dict | None = None):[0m

[31m--[ [0m[34mMatch #[0m[33m1472[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m514 | [0m[35m                    remotely_accessible=True,[0m
[30;1m515 | [0m[35m                )[0m
[30;1m516 | [0m[35m            ][0m
[30;1m517 | [0m[35m        if artist_obj.get("biography"):[0m
[30;1m518 | [0m[35m            artist.metadata.description = artist_obj["biography"].get("content")[0m
[30;1m519 | [0m[35m        return artist[0m
[30;1m520 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1473[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m414 | [0m[35m                track_id=item_id,[0m
[30;1m415 | [0m[35m                intent="stream",[0m
[30;1m416 | [0m[35m            )[0m
[30;1m417 | [0m[35m            if result and result.get("url"):[0m
[30;1m418 | [0m[35m                streamdata = result[0m
[30;1m419 | [0m[35m                break[0m
[30;1m420 | [0m[35m        if not streamdata:[0m

[31m--[ [0m[34mMatch #[0m[33m1474[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m406 | [0m[35m        streamdata = None[0m
[30;1m407 | [0m[35m        for format_id in [27, 7, 6, 5]:[0m
[30;1m408 | [0m[35m            # it seems that simply requesting for highest available quality does not work[0m
[30;1m409 | [0m[35m            # from time to time the api response is empty for this request ?![0m
[30;1m410 | [0m[35m            result = await self._get_data([0m
[30;1m411 | [0m[35m                "track/getFileUrl",[0m
[30;1m412 | [0m[35m                sign_request=True,[0m

[31m--[ [0m[34mMatch #[0m[33m1475[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m406 | [0m[35m        streamdata = None[0m
[30;1m407 | [0m[35m        for format_id in [27, 7, 6, 5]:[0m
[30;1m408 | [0m[35m            # it seems that simply requesting for highest available quality does not work[0m
[30;1m409 | [0m[35m            # from time to time the api response is empty for this request ?![0m
[30;1m410 | [0m[35m            result = await self._get_data([0m
[30;1m411 | [0m[35m                "track/getFileUrl",[0m
[30;1m412 | [0m[35m                sign_request=True,[0m

[31m--[ [0m[34mMatch #[0m[33m1476[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mimport datetime[0m
[30;1m6 | [0m[35mimport hashlib[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35mfrom contextlib import suppress[0m
[30;1m9 | [0m[35mfrom typing import TYPE_CHECKING[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mfrom aiohttp import client_exceptions[0m

[31m--[ [0m[34mMatch #[0m[33m1477[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/helpers/app_vars.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m  | [0m[35mp9UaBhVZwo0QMl2Yq1UevtWVyEFbUNTWqlkNJNkWwRXbJNXSp5UMJpXVGpUaPl2YHJGaKlXZacb2==QVnRlQFFHa5sEckJ1UEJkN[0m

[31m--[ [0m[34mMatch #[0m[33m1478[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/fanarttv/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m169 | [0m[35m            headers["client_key"] = client_key[0m
[30;1m170 | [0m[35m        async with ([0m
[30;1m171 | [0m[35m            self.throttler,[0m
[30;1m172 | [0m[35m            self.mass.http_session.get(url, params=kwargs, headers=headers, ssl=False) as response,[0m
[30;1m173 | [0m[35m        ):[0m
[30;1m174 | [0m[35m            try:[0m
[30;1m175 | [0m[35m                result = await response.json()[0m

[31m--[ [0m[34mMatch #[0m[33m1479[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/fanarttv/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m143 | [0m[35m                    metadata = MediaItemMetadata()[0m
[30;1m144 | [0m[35m                    metadata.images = UniqueList()[0m
[30;1m145 | [0m[35m                    for key, img_type in IMG_MAPPING.items():[0m
[30;1m146 | [0m[35m                        items = album.get(key)[0m
[30;1m147 | [0m[35m                        if not items:[0m
[30;1m148 | [0m[35m                            continue[0m
[30;1m149 | [0m[35m                        for item in items:[0m

[31m--[ [0m[34mMatch #[0m[33m1480[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/fanarttv/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m138 | [0m[35m            return None[0m
[30;1m139 | [0m[35m        self.logger.debug("Fetching metadata for Album %s on Fanart.tv", album.name)[0m
[30;1m140 | [0m[35m        if data := await self._get_data(f"music/albums/{mbid}"):[0m
[30;1m141 | [0m[35m            if data and data.get("albums"):[0m
[30;1m142 | [0m[35m                if album := data["albums"][mbid]:[0m
[30;1m143 | [0m[35m                    metadata = MediaItemMetadata()[0m
[30;1m144 | [0m[35m                    metadata.images = UniqueList()[0m

[31m--[ [0m[34mMatch #[0m[33m1481[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/fanarttv/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m115 | [0m[35m        if data := await self._get_data(f"music/{artist.mbid}"):[0m
[30;1m116 | [0m[35m            metadata = MediaItemMetadata()[0m
[30;1m117 | [0m[35m            for key, img_type in IMG_MAPPING.items():[0m
[30;1m118 | [0m[35m                items = data.get(key)[0m
[30;1m119 | [0m[35m                if not items:[0m
[30;1m120 | [0m[35m                    continue[0m
[30;1m121 | [0m[35m                for item in items:[0m

[31m--[ [0m[34mMatch #[0m[33m1482[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin_player/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m393 | [0m[35m        # bitrate = request.query.get("bitrate")[0m
[30;1m394 | [0m[35m        queue = self.mass.player_queues.get(player_id)[0m
[30;1m395 | [0m[35m[0m
[30;1m396 | [0m[35m        if not (player := self.mass.players.get(player_id)):[0m
[30;1m397 | [0m[35m            raise web.HTTPNotFound(reason=f"Unknown player: {player_id}")[0m
[30;1m398 | [0m[35m[0m
[30;1m399 | [0m[35m        headers = {[0m

[31m--[ [0m[34mMatch #[0m[33m1483[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin_player/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m391 | [0m[35m        player_id = request.path.rsplit(".")[0].rsplit("/")[-1][0m
[30;1m392 | [0m[35m        format_str = request.path.rsplit(".")[-1][0m
[30;1m393 | [0m[35m        # bitrate = request.query.get("bitrate")[0m
[30;1m394 | [0m[35m        queue = self.mass.player_queues.get(player_id)[0m
[30;1m395 | [0m[35m[0m
[30;1m396 | [0m[35m        if not (player := self.mass.players.get(player_id)):[0m
[30;1m397 | [0m[35m            raise web.HTTPNotFound(reason=f"Unknown player: {player_id}")[0m

[31m--[ [0m[34mMatch #[0m[33m1484[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin_player/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m390 | [0m[35m        """Serve the flow stream audio to a player."""[0m
[30;1m391 | [0m[35m        player_id = request.path.rsplit(".")[0].rsplit("/")[-1][0m
[30;1m392 | [0m[35m        format_str = request.path.rsplit(".")[-1][0m
[30;1m393 | [0m[35m        # bitrate = request.query.get("bitrate")[0m
[30;1m394 | [0m[35m        queue = self.mass.player_queues.get(player_id)[0m
[30;1m395 | [0m[35m[0m
[30;1m396 | [0m[35m        if not (player := self.mass.players.get(player_id)):[0m

[31m--[ [0m[34mMatch #[0m[33m1485[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin_player/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m353 | [0m[35m        Returns False in case the player already timed out or simply doesn't exist.[0m
[30;1m354 | [0m[35m        In that case, register the player first with `builtin_player/register`.[0m
[30;1m355 | [0m[35m        """[0m
[30;1m356 | [0m[35m        if not (player := self.mass.players.get(player_id)):[0m
[30;1m357 | [0m[35m            return False[0m
[30;1m358 | [0m[35m[0m
[30;1m359 | [0m[35m        if player_id not in self.instances:[0m

[31m--[ [0m[34mMatch #[0m[33m1486[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin_player/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m338 | [0m[35m            return[0m
[30;1m339 | [0m[35m        for cb in instance.unregister_cbs:[0m
[30;1m340 | [0m[35m            cb()[0m
[30;1m341 | [0m[35m        if player := self.mass.players.get(player_id):[0m
[30;1m342 | [0m[35m            player.available = False[0m
[30;1m343 | [0m[35m            player.state = PlayerState.IDLE[0m
[30;1m344 | [0m[35m            player.powered = False[0m

[31m--[ [0m[34mMatch #[0m[33m1487[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin_player/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m303 | [0m[35m                last_update=time(),[0m
[30;1m304 | [0m[35m            )[0m
[30;1m305 | [0m[35m[0m
[30;1m306 | [0m[35m        player = self.mass.players.get(player_id)[0m
[30;1m307 | [0m[35m[0m
[30;1m308 | [0m[35m        if player is None:[0m
[30;1m309 | [0m[35m            player = Player([0m

[31m--[ [0m[34mMatch #[0m[33m1488[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin_player/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m249 | [0m[35m        This is called by the Player Manager;[0m
[30;1m250 | [0m[35m        if 'needs_poll' is set to True in the player object.[0m
[30;1m251 | [0m[35m        """[0m
[30;1m252 | [0m[35m        if instance := self.instances.get(player_id, None):[0m
[30;1m253 | [0m[35m            last_updated = time() - instance.last_update[0m
[30;1m254 | [0m[35m            if last_updated > DURATION_UNTIL_TIMEOUT:[0m
[30;1m255 | [0m[35m                self.mass.signal_event([0m

[31m--[ [0m[34mMatch #[0m[33m1489[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin_player/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m240 | [0m[35m                else BuiltinPlayerEventType.POWER_OFF[0m
[30;1m241 | [0m[35m            ),[0m
[30;1m242 | [0m[35m        )[0m
[30;1m243 | [0m[35m        if (not powered) and (player := self.mass.players.get(player_id)):[0m
[30;1m244 | [0m[35m            player.powered = False[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m    async def poll_player(self, player_id: str) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m1490[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin_player/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m216 | [0m[35m    ) -> None:[0m
[30;1m217 | [0m[35m        """Handle PLAY MEDIA on given player."""[0m
[30;1m218 | [0m[35m        url = f"builtin_player/flow/{player_id}.mp3"[0m
[30;1m219 | [0m[35m        player = cast("Player", self.mass.players.get(player_id, raise_unavailable=True))[0m
[30;1m220 | [0m[35m        player.current_media = media[0m
[30;1m221 | [0m[35m[0m
[30;1m222 | [0m[35m        self.mass.signal_event([0m

[31m--[ [0m[34mMatch #[0m[33m1491[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin_player/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m347 | [0m[35m    async def update_player_state(self, player_id: str, state: BuiltinPlayerState) -> bool:[0m
[30;1m348 | [0m[35m        """Update current state of a player.[0m
[30;1m349 | [0m[35m[0m
[30;1m350 | [0m[35m        A player must periodically update the state of through this `builtin_player/update_state`[0m
[30;1m351 | [0m[35m        API command.[0m
[30;1m352 | [0m[35m[0m
[30;1m353 | [0m[35m        Returns False in case the player already timed out or simply doesn't exist.[0m

[31m--[ [0m[34mMatch #[0m[33m1492[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin_player/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m139 | [0m[35m        return ([0m
[30;1m140 | [0m[35m            *await super().get_player_config_entries(player_id),[0m
[30;1m141 | [0m[35m            CONF_ENTRY_FLOW_MODE_ENFORCED,[0m
[30;1m142 | [0m[35m            # Hide power/volume/mute control options since they are guaranteed to work[0m
[30;1m143 | [0m[35m            ConfigEntry([0m
[30;1m144 | [0m[35m                key=CONF_POWER_CONTROL,[0m
[30;1m145 | [0m[35m                type=ConfigEntryType.STRING,[0m

[31m--[ [0m[34mMatch #[0m[33m1493[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin_player/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m62 | [0m[35m    from music_assistant_models.provider import ProviderManifest[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m# If the player does not send an update within this time, it will be considered offline[0m
[30;1m66 | [0m[35mDURATION_UNTIL_TIMEOUT = 90  # 30 second extra headroom[0m
[30;1m67 | [0m[35mPOLL_INTERVAL = 30[0m
[30;1m68 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1494[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin_player/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mCommunication with the player occurs via events. The provider sends commands (play media url, pause,[0m
[30;1m13 | [0m[35mstop, volume changes, etc.) through the BUILTIN_PLAYER event type. Client implementations must[0m
[30;1m14 | [0m[35mlisten for these events and respond accordingly to control playback and handle media changes.[0m
[30;1m15 | [0m[35m"""[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mfrom __future__ import annotations[0m

[31m--[ [0m[34mMatch #[0m[33m1495[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin_player/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m5 | [0m[35mbrowser, or integrated with other plugins without requiring third-party protocols.[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mUsage requires registering a player through the 'builtin_player/register' API command.[0m
[30;1m8 | [0m[35mThe registered player must regularly update its state via 'builtin_player/update_state'[0m
[30;1m9 | [0m[35mto maintain the connection. Players can be manually disconnected with 'builtin_player/unregister'[0m
[30;1m10 | [0m[35mwhen no longer needed.[0m
[30;1m11 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1496[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin_player/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m273 | [0m[35m[0m
[30;1m274 | [0m[35m        Every player must first be registered through this `builtin_player/register` API command[0m
[30;1m275 | [0m[35m        before any playback can occur.[0m
[30;1m276 | [0m[35m        Since players queues can time out, this command either will create a new player queue,[0m
[30;1m277 | [0m[35m        or restore it from the last session.[0m
[30;1m278 | [0m[35m[0m
[30;1m279 | [0m[35m        - player_name: Human readable name of the player, will only be used in case this call[0m

[31m--[ [0m[34mMatch #[0m[33m1497[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin_player/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35mfrom collections.abc import Callable[0m
[30;1m20 | [0m[35mfrom dataclasses import dataclass[0m
[30;1m21 | [0m[35mfrom time import time[0m
[30;1m22 | [0m[35mfrom typing import TYPE_CHECKING, cast[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35mimport shortuuid[0m
[30;1m25 | [0m[35mfrom aiohttp import web[0m

[31m--[ [0m[34mMatch #[0m[33m1498[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/builtin_player/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35mfrom collections.abc import Callable[0m
[30;1m20 | [0m[35mfrom dataclasses import dataclass[0m
[30;1m21 | [0m[35mfrom time import time[0m
[30;1m22 | [0m[35mfrom typing import TYPE_CHECKING, cast[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35mimport shortuuid[0m

[31m--[ [0m[34mMatch #[0m[33m1499[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/soundcloud/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m446 | [0m[35m            track.metadata.description = track_obj["description"][0m
[30;1m447 | [0m[35m        if track_obj.get("genre"):[0m
[30;1m448 | [0m[35m            track.metadata.genres = {track_obj["genre"]}[0m
[30;1m449 | [0m[35m        if track_obj.get("tag_list"):[0m
[30;1m450 | [0m[35m            track.metadata.style = track_obj["tag_list"][0m
[30;1m451 | [0m[35m        return track[0m
[30;1m452 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1500[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/soundcloud/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m444 | [0m[35m[0m
[30;1m445 | [0m[35m        if track_obj.get("description"):[0m
[30;1m446 | [0m[35m            track.metadata.description = track_obj["description"][0m
[30;1m447 | [0m[35m        if track_obj.get("genre"):[0m
[30;1m448 | [0m[35m            track.metadata.genres = {track_obj["genre"]}[0m
[30;1m449 | [0m[35m        if track_obj.get("tag_list"):[0m
[30;1m450 | [0m[35m            track.metadata.style = track_obj["tag_list"][0m

[31m--[ [0m[34mMatch #[0m[33m1501[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/soundcloud/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m442 | [0m[35m                ][0m
[30;1m443 | [0m[35m            )[0m
[30;1m444 | [0m[35m[0m
[30;1m445 | [0m[35m        if track_obj.get("description"):[0m
[30;1m446 | [0m[35m            track.metadata.description = track_obj["description"][0m
[30;1m447 | [0m[35m        if track_obj.get("genre"):[0m
[30;1m448 | [0m[35m            track.metadata.genres = {track_obj["genre"]}[0m

[31m--[ [0m[34mMatch #[0m[33m1502[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/soundcloud/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m430 | [0m[35m        if artist and artist.item_id not in {x.item_id for x in track.artists}:[0m
[30;1m431 | [0m[35m            track.artists.append(artist)[0m
[30;1m432 | [0m[35m[0m
[30;1m433 | [0m[35m        if track_obj.get("artwork_url"):[0m
[30;1m434 | [0m[35m            track.metadata.images = UniqueList([0m
[30;1m435 | [0m[35m                [[0m
[30;1m436 | [0m[35m                    MediaItemImage([0m

[31m--[ [0m[34mMatch #[0m[33m1503[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/soundcloud/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m397 | [0m[35m            )[0m
[30;1m398 | [0m[35m        if playlist_obj.get("genre"):[0m
[30;1m399 | [0m[35m            playlist.metadata.genres = playlist_obj["genre"][0m
[30;1m400 | [0m[35m        if playlist_obj.get("tag_list"):[0m
[30;1m401 | [0m[35m            playlist.metadata.style = playlist_obj["tag_list"][0m
[30;1m402 | [0m[35m        return playlist[0m
[30;1m403 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1504[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/soundcloud/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m395 | [0m[35m                    )[0m
[30;1m396 | [0m[35m                ][0m
[30;1m397 | [0m[35m            )[0m
[30;1m398 | [0m[35m        if playlist_obj.get("genre"):[0m
[30;1m399 | [0m[35m            playlist.metadata.genres = playlist_obj["genre"][0m
[30;1m400 | [0m[35m        if playlist_obj.get("tag_list"):[0m
[30;1m401 | [0m[35m            playlist.metadata.style = playlist_obj["tag_list"][0m

[31m--[ [0m[34mMatch #[0m[33m1505[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/soundcloud/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m384 | [0m[35m        playlist.is_editable = False[0m
[30;1m385 | [0m[35m        if playlist_obj.get("description"):[0m
[30;1m386 | [0m[35m            playlist.metadata.description = playlist_obj["description"][0m
[30;1m387 | [0m[35m        if playlist_obj.get("artwork_url"):[0m
[30;1m388 | [0m[35m            playlist.metadata.images = UniqueList([0m
[30;1m389 | [0m[35m                [[0m
[30;1m390 | [0m[35m                    MediaItemImage([0m

[31m--[ [0m[34mMatch #[0m[33m1506[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/soundcloud/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m382 | [0m[35m            },[0m
[30;1m383 | [0m[35m        )[0m
[30;1m384 | [0m[35m        playlist.is_editable = False[0m
[30;1m385 | [0m[35m        if playlist_obj.get("description"):[0m
[30;1m386 | [0m[35m            playlist.metadata.description = playlist_obj["description"][0m
[30;1m387 | [0m[35m        if playlist_obj.get("artwork_url"):[0m
[30;1m388 | [0m[35m            playlist.metadata.images = UniqueList([0m

[31m--[ [0m[34mMatch #[0m[33m1507[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/soundcloud/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m352 | [0m[35m        )[0m
[30;1m353 | [0m[35m        if artist_obj.get("description"):[0m
[30;1m354 | [0m[35m            artist.metadata.description = artist_obj["description"][0m
[30;1m355 | [0m[35m        if artist_obj.get("avatar_url"):[0m
[30;1m356 | [0m[35m            img_url = self._transform_artwork_url(artist_obj["avatar_url"])[0m
[30;1m357 | [0m[35m            artist.metadata.images = UniqueList([0m
[30;1m358 | [0m[35m                [[0m

[31m--[ [0m[34mMatch #[0m[33m1508[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/soundcloud/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m350 | [0m[35m                )[0m
[30;1m351 | [0m[35m            },[0m
[30;1m352 | [0m[35m        )[0m
[30;1m353 | [0m[35m        if artist_obj.get("description"):[0m
[30;1m354 | [0m[35m            artist.metadata.description = artist_obj["description"][0m
[30;1m355 | [0m[35m        if artist_obj.get("avatar_url"):[0m
[30;1m356 | [0m[35m            img_url = self._transform_artwork_url(artist_obj["avatar_url"])[0m

[31m--[ [0m[34mMatch #[0m[33m1509[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/soundcloud/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m331 | [0m[35m        """Parse a Soundcloud user response to Artist model object."""[0m
[30;1m332 | [0m[35m        artist_id = None[0m
[30;1m333 | [0m[35m        permalink = artist_obj["permalink"][0m
[30;1m334 | [0m[35m        if artist_obj.get("id"):[0m
[30;1m335 | [0m[35m            artist_id = artist_obj["id"][0m
[30;1m336 | [0m[35m        if not artist_id:[0m
[30;1m337 | [0m[35m            msg = "Artist does not have a valid ID"[0m

[31m--[ [0m[34mMatch #[0m[33m1510[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/soundcloud/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m147 | [0m[35m            if media_type == "user" and MediaType.ARTIST in media_types:[0m
[30;1m148 | [0m[35m                result.artists = [*result.artists, await self._parse_artist(item)][0m
[30;1m149 | [0m[35m            elif media_type == "track" and MediaType.TRACK in media_types:[0m
[30;1m150 | [0m[35m                if item.get("duration") == item.get("full_duration"):[0m
[30;1m151 | [0m[35m                    # skip if it's a preview track (e.g. in case of free accounts)[0m
[30;1m152 | [0m[35m                    result.tracks = [*result.tracks, await self._parse_track(item)][0m
[30;1m153 | [0m[35m            elif media_type == "playlist" and MediaType.PLAYLIST in media_types:[0m

[31m--[ [0m[34mMatch #[0m[33m1511[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/soundcloud/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m147 | [0m[35m            if media_type == "user" and MediaType.ARTIST in media_types:[0m
[30;1m148 | [0m[35m                result.artists = [*result.artists, await self._parse_artist(item)][0m
[30;1m149 | [0m[35m            elif media_type == "track" and MediaType.TRACK in media_types:[0m
[30;1m150 | [0m[35m                if item.get("duration") == item.get("full_duration"):[0m
[30;1m151 | [0m[35m                    # skip if it's a preview track (e.g. in case of free accounts)[0m
[30;1m152 | [0m[35m                    result.tracks = [*result.tracks, await self._parse_track(item)][0m
[30;1m153 | [0m[35m            elif media_type == "playlist" and MediaType.PLAYLIST in media_types:[0m

[31m--[ [0m[34mMatch #[0m[33m1512[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/soundcloud/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom __future__ import annotations[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35mfrom typing import TYPE_CHECKING, Any[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mfrom music_assistant_models.config_entries import ConfigEntry, ConfigValueType[0m
[30;1m9 | [0m[35mfrom music_assistant_models.enums import ([0m

[31m--[ [0m[34mMatch #[0m[33m1513[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/control.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m244 | [0m[35m        if "message_id" in data:[0m
[30;1m245 | [0m[35m            message_id = data["message_id"][0m
[30;1m246 | [0m[35m            if callback := self._request_callbacks.pop(message_id, None):[0m
[30;1m247 | [0m[35m                if result := data.get("result"):[0m
[30;1m248 | [0m[35m                    callback(result)[0m
[30;1m249 | [0m[35m                # TODO: handle failed requests[0m
[30;1m250 | [0m[35m            return[0m

[31m--[ [0m[34mMatch #[0m[33m1514[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/control.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m203 | [0m[35m        }[0m
[30;1m204 | [0m[35m        if current_queue_item and (media_item := current_queue_item.get("media_item")):[0m
[30;1m205 | [0m[35m            image_url: str | None = None[0m
[30;1m206 | [0m[35m            if image_path := current_queue_item.get("image", {}).get("path"):[0m
[30;1m207 | [0m[35m                image_path_encoded = urllib.parse.quote_plus(image_path)[0m
[30;1m208 | [0m[35m                image_url = ([0m
[30;1m209 | [0m[35m                    # we prefer the streamserver for the imageproxy because it is enabled by default[0m

[31m--[ [0m[34mMatch #[0m[33m1515[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/control.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m203 | [0m[35m        }[0m
[30;1m204 | [0m[35m        if current_queue_item and (media_item := current_queue_item.get("media_item")):[0m
[30;1m205 | [0m[35m            image_url: str | None = None[0m
[30;1m206 | [0m[35m            if image_path := current_queue_item.get("image", {}).get("path"):[0m
[30;1m207 | [0m[35m                image_path_encoded = urllib.parse.quote_plus(image_path)[0m
[30;1m208 | [0m[35m                image_url = ([0m
[30;1m209 | [0m[35m                    # we prefer the streamserver for the imageproxy because it is enabled by default[0m

[31m--[ [0m[34mMatch #[0m[33m1516[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/control.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m201 | [0m[35m            "rate": 1.0,[0m
[30;1m202 | [0m[35m            "position": mass_queue_details["elapsed_time"],[0m
[30;1m203 | [0m[35m        }[0m
[30;1m204 | [0m[35m        if current_queue_item and (media_item := current_queue_item.get("media_item")):[0m
[30;1m205 | [0m[35m            image_url: str | None = None[0m
[30;1m206 | [0m[35m            if image_path := current_queue_item.get("image", {}).get("path"):[0m
[30;1m207 | [0m[35m                image_path_encoded = urllib.parse.quote_plus(image_path)[0m

[31m--[ [0m[34mMatch #[0m[33m1517[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/control.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m191 | [0m[35m            "canGoPrevious": mass_queue_details["current_index"] > 0,[0m
[30;1m192 | [0m[35m            "canPlay": current_queue_item is not None,[0m
[30;1m193 | [0m[35m            "canPause": current_queue_item is not None,[0m
[30;1m194 | [0m[35m            "canSeek": current_queue_item and current_queue_item.get("duration") is not None,[0m
[30;1m195 | [0m[35m            "canControl": True,[0m
[30;1m196 | [0m[35m            "playbackStatus": mass_queue_details["state"],[0m
[30;1m197 | [0m[35m            "loopStatus": LOOP_STATUS_MAP[mass_queue_details["repeat_mode"]],[0m

[31m--[ [0m[34mMatch #[0m[33m1518[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/control.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m185 | [0m[35m    def _create_properties(self, mass_queue_details: dict[str, Any]) -> dict[str, Any]:[0m
[30;1m186 | [0m[35m        """Create snapcast properties from Music Assistant queue details."""[0m
[30;1m187 | [0m[35m        current_queue_item: dict[str, Any] | None = mass_queue_details.get("current_item")[0m
[30;1m188 | [0m[35m        next_queue_item: dict[str, Any] | None = mass_queue_details.get("next_item")[0m
[30;1m189 | [0m[35m        properties: dict[str, Any] = {[0m
[30;1m190 | [0m[35m            "canGoNext": next_queue_item is not None,[0m
[30;1m191 | [0m[35m            "canGoPrevious": mass_queue_details["current_index"] > 0,[0m

[31m--[ [0m[34mMatch #[0m[33m1519[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/control.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m184 | [0m[35m[0m
[30;1m185 | [0m[35m    def _create_properties(self, mass_queue_details: dict[str, Any]) -> dict[str, Any]:[0m
[30;1m186 | [0m[35m        """Create snapcast properties from Music Assistant queue details."""[0m
[30;1m187 | [0m[35m        current_queue_item: dict[str, Any] | None = mass_queue_details.get("current_item")[0m
[30;1m188 | [0m[35m        next_queue_item: dict[str, Any] | None = mass_queue_details.get("next_item")[0m
[30;1m189 | [0m[35m        properties: dict[str, Any] = {[0m
[30;1m190 | [0m[35m            "canGoNext": next_queue_item is not None,[0m

[31m--[ [0m[34mMatch #[0m[33m1520[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/control.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m        if cmd == "Control":[0m
[30;1m94 | [0m[35m            command = request["params"]["command"][0m
[30;1m95 | [0m[35m            params = request["params"].get("params", {})[0m
[30;1m96 | [0m[35m            logger.debug(f"Control command: {command}, params: {params}")[0m
[30;1m97 | [0m[35m            if command == "next":[0m
[30;1m98 | [0m[35m                self.send_request("player_queues/next", queue_id=queue_id)[0m

[31m--[ [0m[34mMatch #[0m[33m1521[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m132 | [0m[35m            #     self.send_request("core.mixer.set_volume", {"volume": int(properties["volume"])})[0m
[30;1m133 | [0m[35m            # if "mute" in properties:[0m
[30;1m134 | [0m[35m            #     self.send_request("core.mixer.set_mute", {"mute": properties["mute"]})[0m
[30;1m135 | [0m[35m        elif cmd == "GetProperties":[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35m            def handle_result(result: dict[str, Any]):[0m
[30;1m138 | [0m[35m                send([0m

[31m--[ [0m[34mMatch #[0m[33m1522[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m112 | [0m[35m            elif command == "seek":[0m
[30;1m113 | [0m[35m                seek_offset = float(params["offset"])[0m
[30;1m114 | [0m[35m                self.send_request("player_queues/skip", queue_id=queue_id, seconds=seek_offset)[0m
[30;1m115 | [0m[35m        elif cmd == "SetProperty":[0m
[30;1m116 | [0m[35m            properties = request["params"][0m
[30;1m117 | [0m[35m            logger.debug(f"SetProperty: {property}")[0m
[30;1m118 | [0m[35m            if "shuffle" in property:[0m

[31m--[ [0m[34mMatch #[0m[33m1523[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m90 | [0m[35m                }[0m
[30;1m91 | [0m[35m            )[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m        if cmd == "Control":[0m
[30;1m94 | [0m[35m            command = request["params"]["command"][0m
[30;1m95 | [0m[35m            params = request["params"].get("params", {})[0m
[30;1m96 | [0m[35m            logger.debug(f"Control command: {command}, params: {params}")[0m

[31m--[ [0m[34mMatch #[0m[33m1524[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m77 | [0m[35m        queue_id = self.queue_id[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m        # deny invalid commands[0m
[30;1m80 | [0m[35m        if interface != "Plugin.Stream.Player" or cmd not in ([0m
[30;1m81 | [0m[35m            "Control",[0m
[30;1m82 | [0m[35m            "SetProperty",[0m
[30;1m83 | [0m[35m            "GetProperties",[0m

[31m--[ [0m[34mMatch #[0m[33m1525[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m72 | [0m[35m    def handle_snapcast_request(self, request: dict[str, Any]) -> None:[0m
[30;1m73 | [0m[35m        """Handle (JSON RPC) message from Snapcast."""[0m
[30;1m74 | [0m[35m        id: str = request["id"]  # noqa: A001[0m
[30;1m75 | [0m[35m        interface, cmd = request["method"].rsplit(".", 1)[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m        queue_id = self.queue_id[0m
[30;1m78 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1526[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35mclass MusicAssistantControl:[0m
[30;1m40 | [0m[35m    """Music Assistant websocket remote control Snapcast plugin."""[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m    def __init__([0m
[30;1m43 | [0m[35m        self, queue_id: str, streamserver_ip: str, streamserver_port: int, api_port: int[0m

[31m--[ [0m[34mMatch #[0m[33m1527[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/control.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m#!/usr/bin/env python3[0m
[30;1m2 | [0m[35m"""[0m
[30;1m3 | [0m[35mControl Music Assistant Snapcast plugin.[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mThis script is a bridge between Music Assistant and Snapcast[0m
[30;1m6 | [0m[35mIt listens to the MA websocket and sends metadata to Snapcast[0m

[31m--[ [0m[34mMatch #[0m[33m1528[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/control.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35mimport threading[0m
[30;1m14 | [0m[35mimport urllib.parse[0m
[30;1m15 | [0m[35mfrom collections.abc import Callable[0m
[30;1m16 | [0m[35mfrom time import sleep[0m
[30;1m17 | [0m[35mfrom typing import Any[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35mimport shortuuid[0m

[31m--[ [0m[34mMatch #[0m[33m1529[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/control.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35m"""[0m
[30;1m3 | [0m[35mControl Music Assistant Snapcast plugin.[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mThis script is a bridge between Music Assistant and Snapcast[0m
[30;1m6 | [0m[35mIt listens to the MA websocket and sends metadata to Snapcast[0m
[30;1m7 | [0m[35mand listens for player commands[0m
[30;1m8 | [0m[35m"""[0m

[31m--[ [0m[34mMatch #[0m[33m1530[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1764 | [0m[35m                output_formats.append("unknown")[0m
[30;1m1765 | [0m[35m[0m
[30;1m1766 | [0m[35m        # basic throttle: do not send state changed events if queue did not actually change[0m
[30;1m1767 | [0m[35m        prev_state: CompareState = self._prev_states.get([0m
[30;1m1768 | [0m[35m            queue_id,[0m
[30;1m1769 | [0m[35m            CompareState([0m
[30;1m1770 | [0m[35m                queue_id=queue_id,[0m

[31m--[ [0m[34mMatch #[0m[33m1531[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1758 | [0m[35m        if player.output_format:[0m
[30;1m1759 | [0m[35m            output_formats.append(str(player.output_format))[0m
[30;1m1760 | [0m[35m        for child_id in player.group_childs:[0m
[30;1m1761 | [0m[35m            if (child := self.mass.players.get(child_id)) and child.output_format:[0m
[30;1m1762 | [0m[35m                output_formats.append(str(child.output_format))[0m
[30;1m1763 | [0m[35m            else:[0m
[30;1m1764 | [0m[35m                output_formats.append("unknown")[0m

[31m--[ [0m[34mMatch #[0m[33m1532[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1710 | [0m[35m    ) -> None:[0m
[30;1m1711 | [0m[35m        """Update the Queue when the player state changed."""[0m
[30;1m1712 | [0m[35m        queue_id = player.player_id[0m
[30;1m1713 | [0m[35m        player = self.mass.players.get(queue_id)[0m
[30;1m1714 | [0m[35m        queue = self._queues[queue_id][0m
[30;1m1715 | [0m[35m[0m
[30;1m1716 | [0m[35m        # basic properties[0m

[31m--[ [0m[34mMatch #[0m[33m1533[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1146 | [0m[35m[0m
[30;1m1147 | [0m[35m    def track_loaded_in_buffer(self, queue_id: str, item_id: str) -> None:[0m
[30;1m1148 | [0m[35m        """Call when a player has (started) loading a track in the buffer."""[0m
[30;1m1149 | [0m[35m        queue = self.get(queue_id)[0m
[30;1m1150 | [0m[35m        if not queue:[0m
[30;1m1151 | [0m[35m            msg = f"PlayerQueue {queue_id} is not available"[0m
[30;1m1152 | [0m[35m            raise PlayerUnavailableError(msg)[0m

[31m--[ [0m[34mMatch #[0m[33m1534[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1002 | [0m[35m[0m
[30;1m1003 | [0m[35m        Raises QueueEmpty if there are no more tracks left.[0m
[30;1m1004 | [0m[35m        """[0m
[30;1m1005 | [0m[35m        queue = self.get(queue_id)[0m
[30;1m1006 | [0m[35m        if not queue:[0m
[30;1m1007 | [0m[35m            msg = f"PlayerQueue {queue_id} is not available"[0m
[30;1m1008 | [0m[35m            raise PlayerUnavailableError(msg)[0m

[31m--[ [0m[34mMatch #[0m[33m1535[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m965 | [0m[35m        NOTE: This is called every second if the player is playing.[0m
[30;1m966 | [0m[35m        """[0m
[30;1m967 | [0m[35m        queue_id = player.player_id[0m
[30;1m968 | [0m[35m        if (queue := self._queues.get(queue_id)) is None:[0m
[30;1m969 | [0m[35m            # race condition[0m
[30;1m970 | [0m[35m            return[0m
[30;1m971 | [0m[35m        if player.announcement_in_progress:[0m

[31m--[ [0m[34mMatch #[0m[33m1536[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m924 | [0m[35m        ):[0m
[30;1m925 | [0m[35m            try:[0m
[30;1m926 | [0m[35m                queue = PlayerQueue.from_cache(prev_state)[0m
[30;1m927 | [0m[35m                prev_items = await self.mass.cache.get([0m
[30;1m928 | [0m[35m                    "items",[0m
[30;1m929 | [0m[35m                    default=[],[0m
[30;1m930 | [0m[35m                    category=CACHE_CATEGORY_PLAYER_QUEUE_STATE,[0m

[31m--[ [0m[34mMatch #[0m[33m1537[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m919 | [0m[35m        queue_id = player.player_id[0m
[30;1m920 | [0m[35m        queue = None[0m
[30;1m921 | [0m[35m        # try to restore previous state[0m
[30;1m922 | [0m[35m        if prev_state := await self.mass.cache.get([0m
[30;1m923 | [0m[35m            "state", category=CACHE_CATEGORY_PLAYER_QUEUE_STATE, base_key=queue_id[0m
[30;1m924 | [0m[35m        ):[0m
[30;1m925 | [0m[35m            try:[0m

[31m--[ [0m[34mMatch #[0m[33m1538[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m882 | [0m[35m        if auto_play is None:[0m
[30;1m883 | [0m[35m            auto_play = source_queue.state == PlayerState.PLAYING[0m
[30;1m884 | [0m[35m[0m
[30;1m885 | [0m[35m        target_player = self.mass.players.get(target_queue_id)[0m
[30;1m886 | [0m[35m        if target_player.active_group or target_player.synced_to:[0m
[30;1m887 | [0m[35m            # edge case: the user wants to move playback from the group as a whole, to a single[0m
[30;1m888 | [0m[35m            # player in the group or it is grouped and the command targeted at the single player.[0m

[31m--[ [0m[34mMatch #[0m[33m1539[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m877 | [0m[35m        """Transfer queue to another queue."""[0m
[30;1m878 | [0m[35m        if not (source_queue := self.get(source_queue_id)):[0m
[30;1m879 | [0m[35m            raise PlayerUnavailableError(f"Queue {source_queue_id} is not available")[0m
[30;1m880 | [0m[35m        if not (target_queue := self.get(target_queue_id)):[0m
[30;1m881 | [0m[35m            raise PlayerUnavailableError(f"Queue {target_queue_id} is not available")[0m
[30;1m882 | [0m[35m        if auto_play is None:[0m
[30;1m883 | [0m[35m            auto_play = source_queue.state == PlayerState.PLAYING[0m

[31m--[ [0m[34mMatch #[0m[33m1540[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m875 | [0m[35m        auto_play: bool | None = None,[0m
[30;1m876 | [0m[35m    ) -> None:[0m
[30;1m877 | [0m[35m        """Transfer queue to another queue."""[0m
[30;1m878 | [0m[35m        if not (source_queue := self.get(source_queue_id)):[0m
[30;1m879 | [0m[35m            raise PlayerUnavailableError(f"Queue {source_queue_id} is not available")[0m
[30;1m880 | [0m[35m        if not (target_queue := self.get(target_queue_id)):[0m
[30;1m881 | [0m[35m            raise PlayerUnavailableError(f"Queue {target_queue_id} is not available")[0m

[31m--[ [0m[34mMatch #[0m[33m1541[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m776 | [0m[35m            resume_pos = 0[0m
[30;1m777 | [0m[35m[0m
[30;1m778 | [0m[35m        if resume_item is not None:[0m
[30;1m779 | [0m[35m            queue_player = self.mass.players.get(queue_id)[0m
[30;1m780 | [0m[35m            if ([0m
[30;1m781 | [0m[35m                fade_in is None[0m
[30;1m782 | [0m[35m                and queue_player.state == PlayerState.IDLE[0m

[31m--[ [0m[34mMatch #[0m[33m1542[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m740 | [0m[35m        """[0m
[30;1m741 | [0m[35m        if not (queue := self.get(queue_id)):[0m
[30;1m742 | [0m[35m            return[0m
[30;1m743 | [0m[35m        queue_player: Player = self.mass.players.get(queue_id, True)[0m
[30;1m744 | [0m[35m        if not queue.current_item:[0m
[30;1m745 | [0m[35m            raise InvalidCommand(f"Queue {queue_player.display_name} has no item(s) loaded.")[0m
[30;1m746 | [0m[35m        if not queue.current_item.duration:[0m

[31m--[ [0m[34mMatch #[0m[33m1543[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m738 | [0m[35m        - queue_id: queue_id of the queue to handle the command.[0m
[30;1m739 | [0m[35m        - position: position in seconds to seek to in the current playing item.[0m
[30;1m740 | [0m[35m        """[0m
[30;1m741 | [0m[35m        if not (queue := self.get(queue_id)):[0m
[30;1m742 | [0m[35m            return[0m
[30;1m743 | [0m[35m        queue_player: Player = self.mass.players.get(queue_id, True)[0m
[30;1m744 | [0m[35m        if not queue.current_item:[0m

[31m--[ [0m[34mMatch #[0m[33m1544[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m726 | [0m[35m        - queue_id: queue_id of the queue to handle the command.[0m
[30;1m727 | [0m[35m        - seconds: number of seconds to skip in track. Use negative value to skip back.[0m
[30;1m728 | [0m[35m        """[0m
[30;1m729 | [0m[35m        if (queue := self.get(queue_id)) is None or not queue.active:[0m
[30;1m730 | [0m[35m            # TODO: forward to underlying player if not active[0m
[30;1m731 | [0m[35m            return[0m
[30;1m732 | [0m[35m        await self.seek(queue_id, self._queues[queue_id].elapsed_time + seconds)[0m

[31m--[ [0m[34mMatch #[0m[33m1545[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m711 | [0m[35m[0m
[30;1m712 | [0m[35m        - queue_id: queue_id of the queue to handle the command.[0m
[30;1m713 | [0m[35m        """[0m
[30;1m714 | [0m[35m        if (queue := self.get(queue_id)) is None or not queue.active:[0m
[30;1m715 | [0m[35m            # TODO: forward to underlying player if not active[0m
[30;1m716 | [0m[35m            return[0m
[30;1m717 | [0m[35m        current_index = self._queues[queue_id].current_index[0m

[31m--[ [0m[34mMatch #[0m[33m1546[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m687 | [0m[35m[0m
[30;1m688 | [0m[35m        - queue_id: queue_id of the queue to handle the command.[0m
[30;1m689 | [0m[35m        """[0m
[30;1m690 | [0m[35m        if (queue := self.get(queue_id)) is None or not queue.active:[0m
[30;1m691 | [0m[35m            # TODO: forward to underlying player if not active[0m
[30;1m692 | [0m[35m            return[0m
[30;1m693 | [0m[35m        idx = self._queues[queue_id].current_index[0m

[31m--[ [0m[34mMatch #[0m[33m1547[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m676 | [0m[35m[0m
[30;1m677 | [0m[35m        - queue_id: queue_id of the queue to handle the command.[0m
[30;1m678 | [0m[35m        """[0m
[30;1m679 | [0m[35m        if (queue := self._queues.get(queue_id)) and queue.state == PlayerState.PLAYING:[0m
[30;1m680 | [0m[35m            await self.pause(queue_id)[0m
[30;1m681 | [0m[35m            return[0m
[30;1m682 | [0m[35m        await self.play(queue_id)[0m

[31m--[ [0m[34mMatch #[0m[33m1548[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m639 | [0m[35m            if queue.state == PlayerState.PLAYING:[0m
[30;1m640 | [0m[35m                queue.resume_pos = queue.corrected_elapsed_time[0m
[30;1m641 | [0m[35m        # forward the actual command to the player controller[0m
[30;1m642 | [0m[35m        queue_player = self.mass.players.get(queue_id)[0m
[30;1m643 | [0m[35m        if not (player_provider := self.mass.players.get_player_provider(queue.queue_id)):[0m
[30;1m644 | [0m[35m            return  # guard[0m
[30;1m645 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1549[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m635 | [0m[35m[0m
[30;1m636 | [0m[35m        - queue_id: queue_id of the playerqueue to handle the command.[0m
[30;1m637 | [0m[35m        """[0m
[30;1m638 | [0m[35m        if queue := self._queues.get(queue_id):[0m
[30;1m639 | [0m[35m            if queue.state == PlayerState.PLAYING:[0m
[30;1m640 | [0m[35m                queue.resume_pos = queue.corrected_elapsed_time[0m
[30;1m641 | [0m[35m        # forward the actual command to the player controller[0m

[31m--[ [0m[34mMatch #[0m[33m1550[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m618 | [0m[35m        """[0m
[30;1m619 | [0m[35m        queue_player: Player = self.mass.players.get(queue_id, True)[0m
[30;1m620 | [0m[35m        if ([0m
[30;1m621 | [0m[35m            (queue := self._queues.get(queue_id))[0m
[30;1m622 | [0m[35m            and queue.active[0m
[30;1m623 | [0m[35m            and queue_player.state == PlayerState.PAUSED[0m
[30;1m624 | [0m[35m        ):[0m

[31m--[ [0m[34mMatch #[0m[33m1551[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m616 | [0m[35m[0m
[30;1m617 | [0m[35m        - queue_id: queue_id of the playerqueue to handle the command.[0m
[30;1m618 | [0m[35m        """[0m
[30;1m619 | [0m[35m        queue_player: Player = self.mass.players.get(queue_id, True)[0m
[30;1m620 | [0m[35m        if ([0m
[30;1m621 | [0m[35m            (queue := self._queues.get(queue_id))[0m
[30;1m622 | [0m[35m            and queue.active[0m

[31m--[ [0m[34mMatch #[0m[33m1552[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m602 | [0m[35m[0m
[30;1m603 | [0m[35m        - queue_id: queue_id of the playerqueue to handle the command.[0m
[30;1m604 | [0m[35m        """[0m
[30;1m605 | [0m[35m        if (queue := self.get(queue_id)) and queue.active:[0m
[30;1m606 | [0m[35m            if queue.state == PlayerState.PLAYING:[0m
[30;1m607 | [0m[35m                queue.resume_pos = queue.corrected_elapsed_time[0m
[30;1m608 | [0m[35m        # forward the actual command to the player provider[0m

[31m--[ [0m[34mMatch #[0m[33m1553[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m388 | [0m[35m        if not (queue := self.get(queue_id)):[0m
[30;1m389 | [0m[35m            raise PlayerUnavailableError(f"Queue {queue_id} is not available")[0m
[30;1m390 | [0m[35m        # always fetch the underlying player so we can raise early if its not available[0m
[30;1m391 | [0m[35m        queue_player = self.mass.players.get(queue_id, True)[0m
[30;1m392 | [0m[35m        if queue_player.announcement_in_progress:[0m
[30;1m393 | [0m[35m            self.logger.warning("Ignore queue command: An announcement is in progress")[0m
[30;1m394 | [0m[35m            return[0m

[31m--[ [0m[34mMatch #[0m[33m1554[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m385 | [0m[35m        # this makes sure that playback has priority over other requests that may be[0m
[30;1m386 | [0m[35m        # happening in the background[0m
[30;1m387 | [0m[35m        BYPASS_THROTTLER.set(True)[0m
[30;1m388 | [0m[35m        if not (queue := self.get(queue_id)):[0m
[30;1m389 | [0m[35m            raise PlayerUnavailableError(f"Queue {queue_id} is not available")[0m
[30;1m390 | [0m[35m        # always fetch the underlying player so we can raise early if its not available[0m
[30;1m391 | [0m[35m        queue_player = self.mass.players.get(queue_id, True)[0m

[31m--[ [0m[34mMatch #[0m[33m1555[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m300 | [0m[35m                return self.get_active_queue(player.active_group)[0m
[30;1m301 | [0m[35m            # active_source may be filled with other queue id[0m
[30;1m302 | [0m[35m            return self.get(player.active_source) or self.get(player_id)[0m
[30;1m303 | [0m[35m        return self.get(player_id)[0m
[30;1m304 | [0m[35m[0m
[30;1m305 | [0m[35m    # Queue commands[0m
[30;1m306 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1556[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m299 | [0m[35m            if player.active_group and player.active_group != player.player_id:[0m
[30;1m300 | [0m[35m                return self.get_active_queue(player.active_group)[0m
[30;1m301 | [0m[35m            # active_source may be filled with other queue id[0m
[30;1m302 | [0m[35m            return self.get(player.active_source) or self.get(player_id)[0m
[30;1m303 | [0m[35m        return self.get(player_id)[0m
[30;1m304 | [0m[35m[0m
[30;1m305 | [0m[35m    # Queue commands[0m

[31m--[ [0m[34mMatch #[0m[33m1557[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m299 | [0m[35m            if player.active_group and player.active_group != player.player_id:[0m
[30;1m300 | [0m[35m                return self.get_active_queue(player.active_group)[0m
[30;1m301 | [0m[35m            # active_source may be filled with other queue id[0m
[30;1m302 | [0m[35m            return self.get(player.active_source) or self.get(player_id)[0m
[30;1m303 | [0m[35m        return self.get(player_id)[0m
[30;1m304 | [0m[35m[0m
[30;1m305 | [0m[35m    # Queue commands[0m

[31m--[ [0m[34mMatch #[0m[33m1558[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m291 | [0m[35m    @api_command("player_queues/get_active_queue")[0m
[30;1m292 | [0m[35m    def get_active_queue(self, player_id: str) -> PlayerQueue:[0m
[30;1m293 | [0m[35m        """Return the current active/synced queue for a player."""[0m
[30;1m294 | [0m[35m        if player := self.mass.players.get(player_id):[0m
[30;1m295 | [0m[35m            # account for player that is synced (sync child)[0m
[30;1m296 | [0m[35m            if player.synced_to and player.synced_to != player.player_id:[0m
[30;1m297 | [0m[35m                return self.get_active_queue(player.synced_to)[0m

[31m--[ [0m[34mMatch #[0m[33m1559[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m278 | [0m[35m    @api_command("player_queues/get")[0m
[30;1m279 | [0m[35m    def get(self, queue_id: str) -> PlayerQueue | None:[0m
[30;1m280 | [0m[35m        """Return PlayerQueue by queue_id or None if not found."""[0m
[30;1m281 | [0m[35m        return self._queues.get(queue_id)[0m
[30;1m282 | [0m[35m[0m
[30;1m283 | [0m[35m    @api_command("player_queues/items")[0m
[30;1m284 | [0m[35m    def items(self, queue_id: str, limit: int = 500, offset: int = 0) -> list[QueueItem]:[0m

[31m--[ [0m[34mMatch #[0m[33m1560[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1976 | [0m[35m            self.logger.info("End of queue reached, clearing items")[0m
[30;1m1977 | [0m[35m            self.clear(queue.queue_id)[0m
[30;1m1978 | [0m[35m[0m
[30;1m1979 | [0m[35m        # all checks passed, we stopped playback at the last (or single) of the queue[0m
[30;1m1980 | [0m[35m        # now determine if the item was fully played[0m
[30;1m1981 | [0m[35m        if streamdetails := queue.current_item.streamdetails:[0m
[30;1m1982 | [0m[35m            duration = streamdetails.duration or queue.current_item.duration or 24 * 3600[0m

[31m--[ [0m[34mMatch #[0m[33m1561[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1801 | [0m[35m        if len(changed_keys) == 0:[0m
[30;1m1802 | [0m[35m            return[0m
[30;1m1803 | [0m[35m[0m
[30;1m1804 | [0m[35m        # signal update and store state[0m
[30;1m1805 | [0m[35m        if changed_keys == {"elapsed_time"}:[0m
[30;1m1806 | [0m[35m            # do not send full updates if only time was updated[0m
[30;1m1807 | [0m[35m            self.mass.signal_event([0m

[31m--[ [0m[34mMatch #[0m[33m1562[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1721 | [0m[35m        queue.state = player.state or PlayerState.IDLE if queue.active else PlayerState.IDLE[0m
[30;1m1722 | [0m[35m        # update current item/index from player report[0m
[30;1m1723 | [0m[35m        if queue.active and queue.state in (PlayerState.PLAYING, PlayerState.PAUSED):[0m
[30;1m1724 | [0m[35m            # NOTE: If the queue is not playing (yet) we will not update the current index[0m
[30;1m1725 | [0m[35m            # to ensure we keep the previously known current index[0m
[30;1m1726 | [0m[35m            if queue.flow_mode:[0m
[30;1m1727 | [0m[35m                # flow mode active, the player is playing one long stream[0m

[31m--[ [0m[34mMatch #[0m[33m1563[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1719 | [0m[35m        queue.items = len(self._queue_items[queue_id])[0m
[30;1m1720 | [0m[35m[0m
[30;1m1721 | [0m[35m        queue.state = player.state or PlayerState.IDLE if queue.active else PlayerState.IDLE[0m
[30;1m1722 | [0m[35m        # update current item/index from player report[0m
[30;1m1723 | [0m[35m        if queue.active and queue.state in (PlayerState.PLAYING, PlayerState.PAUSED):[0m
[30;1m1724 | [0m[35m            # NOTE: If the queue is not playing (yet) we will not update the current index[0m
[30;1m1725 | [0m[35m            # to ensure we keep the previously known current index[0m

[31m--[ [0m[34mMatch #[0m[33m1564[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1447 | [0m[35m                episode.resume_position_ms = resume_position_ms[0m
[30;1m1448 | [0m[35m                break[0m
[30;1m1449 | [0m[35m            else:[0m
[30;1m1450 | [0m[35m                # no episodes found that are not fully played, so we start at the beginning[0m
[30;1m1451 | [0m[35m                episode = next((x for x in all_episodes), None)[0m
[30;1m1452 | [0m[35m        if episode is None:[0m
[30;1m1453 | [0m[35m            raise InvalidDataError(f"Unable to resolve episode to play for Podcast {podcast.name}")[0m

[31m--[ [0m[34mMatch #[0m[33m1565[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1173 | [0m[35m[0m
[30;1m1174 | [0m[35m        - queue_id: id of the queue to process this request.[0m
[30;1m1175 | [0m[35m        - queue_items: a list of QueueItems[0m
[30;1m1176 | [0m[35m        - insert_at_index: insert the item(s) at this index[0m
[30;1m1177 | [0m[35m        - keep_remaining: keep the remaining items after the insert[0m
[30;1m1178 | [0m[35m        - shuffle: (re)shuffle the items after insert index[0m
[30;1m1179 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1566[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1169 | [0m[35m        keep_played: bool = True,[0m
[30;1m1170 | [0m[35m        shuffle: bool = False,[0m
[30;1m1171 | [0m[35m    ) -> None:[0m
[30;1m1172 | [0m[35m        """Load new items at index.[0m
[30;1m1173 | [0m[35m[0m
[30;1m1174 | [0m[35m        - queue_id: id of the queue to process this request.[0m
[30;1m1175 | [0m[35m        - queue_items: a list of QueueItems[0m

[31m--[ [0m[34mMatch #[0m[33m1567[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1035 | [0m[35m                queue_item.available = False[0m
[30;1m1036 | [0m[35m                idx += 1[0m
[30;1m1037 | [0m[35m        if idx != 0:[0m
[30;1m1038 | [0m[35m            # we skipped some items, signal a queue items update[0m
[30;1m1039 | [0m[35m            self.update_items(queue_id, self._queue_items[queue_id])[0m
[30;1m1040 | [0m[35m        if next_item is None:[0m
[30;1m1041 | [0m[35m            raise QueueEmpty("No more (playable) tracks left in the queue.")[0m
[30;1m1042 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1568[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m982 | [0m[35m            # ignore updates from the player during this time[0m
[30;1m983 | [0m[35m            return[0m
[30;1m984 | [0m[35m[0m
[30;1m985 | [0m[35m        # queue is active and preflight checks passed, update the queue details[0m
[30;1m986 | [0m[35m        self._update_queue_from_player(player)[0m
[30;1m987 | [0m[35m[0m
[30;1m988 | [0m[35m    def on_player_remove(self, player_id: str) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m1569[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m950 | [0m[35m[0m
[30;1m951 | [0m[35m        self._queues[queue_id] = queue[0m
[30;1m952 | [0m[35m        self._queue_items[queue_id] = queue_items[0m
[30;1m953 | [0m[35m        # always call update to calculate state etc[0m
[30;1m954 | [0m[35m        self.on_player_update(player, {})[0m
[30;1m955 | [0m[35m        self.mass.signal_event(EventType.QUEUE_ADDED, object_id=queue_id, data=queue)[0m
[30;1m956 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1570[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m885 | [0m[35m        target_player = self.mass.players.get(target_queue_id)[0m
[30;1m886 | [0m[35m        if target_player.active_group or target_player.synced_to:[0m
[30;1m887 | [0m[35m            # edge case: the user wants to move playback from the group as a whole, to a single[0m
[30;1m888 | [0m[35m            # player in the group or it is grouped and the command targeted at the single player.[0m
[30;1m889 | [0m[35m            # We need to dissolve the group first.[0m
[30;1m890 | [0m[35m            await self.mass.players.cmd_ungroup([0m
[30;1m891 | [0m[35m                target_player.active_group or target_player.synced_to[0m

[31m--[ [0m[34mMatch #[0m[33m1571[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m858 | [0m[35m            await asyncio.sleep(2)[0m
[30;1m859 | [0m[35m            self._transitioning_players.discard(queue_id)[0m
[30;1m860 | [0m[35m[0m
[30;1m861 | [0m[35m        # we set a flag to notify the update logic that we're transitioning to a new track[0m
[30;1m862 | [0m[35m        self._transitioning_players.add(queue_id)[0m
[30;1m863 | [0m[35m        self.mass.call_later([0m
[30;1m864 | [0m[35m            1 if debounce else 0,[0m

[31m--[ [0m[34mMatch #[0m[33m1572[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m816 | [0m[35m        queue.flow_mode = await self.mass.config.get_player_config_value(queue_id, CONF_FLOW_MODE)[0m
[30;1m817 | [0m[35m        queue.current_item = queue_item[0m
[30;1m818 | [0m[35m        queue.next_item_id_enqueued = None[0m
[30;1m819 | [0m[35m        # always update session id when we start a new playback session[0m
[30;1m820 | [0m[35m        queue.session_id = shortuuid.random(length=8)[0m
[30;1m821 | [0m[35m[0m
[30;1m822 | [0m[35m        # handle resume point of audiobook(chapter) or podcast(episode)[0m

[31m--[ [0m[34mMatch #[0m[33m1573[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m801 | [0m[35m        fade_in: bool = False,[0m
[30;1m802 | [0m[35m        debounce: bool = False,[0m
[30;1m803 | [0m[35m    ) -> None:[0m
[30;1m804 | [0m[35m        """Play item at index (or item_id) X in queue."""[0m
[30;1m805 | [0m[35m        queue = self._queues[queue_id][0m
[30;1m806 | [0m[35m        queue.resume_pos = 0[0m
[30;1m807 | [0m[35m        if isinstance(index, str):[0m

[31m--[ [0m[34mMatch #[0m[33m1574[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m771 | [0m[35m            resume_item = self.get_item(queue_id, queue.current_index)[0m
[30;1m772 | [0m[35m            resume_pos = 0[0m
[30;1m773 | [0m[35m        elif not resume_item and queue.current_index is None and len(queue_items) > 0:[0m
[30;1m774 | [0m[35m            # items available in queue but no previous track, start at 0[0m
[30;1m775 | [0m[35m            resume_item = self.get_item(queue_id, 0)[0m
[30;1m776 | [0m[35m            resume_pos = 0[0m
[30;1m777 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1575[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1908 | [0m[35m                break[0m
[30;1m1909 | [0m[35m        if player.state != PlayerState.PLAYING:[0m
[30;1m1910 | [0m[35m            # if the player is not playing, we can't be sure that the elapsed time is correct[0m
[30;1m1911 | [0m[35m            # so we just return the queue index and the elapsed time[0m
[30;1m1912 | [0m[35m            return queue.current_index, queue.elapsed_time[0m
[30;1m1913 | [0m[35m        return queue_index, track_time[0m
[30;1m1914 | [0m[35m[0m
[30;1m1915 | [0m[35m    def _parse_player_current_item_id(self, queue_id: str, player: Player) -> str | None:[0m

[31m--[ [0m[34mMatch #[0m[33m1576[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1907 | [0m[35m                track_time = elapsed_time_queue_total + track_sec_skipped - played_time[0m
[30;1m1908 | [0m[35m                break[0m
[30;1m1909 | [0m[35m        if player.state != PlayerState.PLAYING:[0m
[30;1m1910 | [0m[35m            # if the player is not playing, we can't be sure that the elapsed time is correct[0m
[30;1m1911 | [0m[35m            # so we just return the queue index and the elapsed time[0m
[30;1m1912 | [0m[35m            return queue.current_index, queue.elapsed_time[0m
[30;1m1913 | [0m[35m        return queue_index, track_time[0m

[31m--[ [0m[34mMatch #[0m[33m1577[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1892 | [0m[35m                else play_log_entry.duration or 3600 * 24 * 7[0m
[30;1m1893 | [0m[35m            )[0m
[30;1m1894 | [0m[35m            if elapsed_time_queue_total > (queue_item_duration + played_time):[0m
[30;1m1895 | [0m[35m                # total elapsed time is more than (streamed) track duration[0m
[30;1m1896 | [0m[35m                # this track has been fully played, move on.[0m
[30;1m1897 | [0m[35m                played_time += queue_item_duration[0m
[30;1m1898 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m1578[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1870 | [0m[35m    def _get_flow_queue_stream_index([0m
[30;1m1871 | [0m[35m        self, queue: PlayerQueue, player: Player[0m
[30;1m1872 | [0m[35m    ) -> tuple[int | None, int]:[0m
[30;1m1873 | [0m[35m        """Calculate current queue index and current track elapsed time when flow mode is active."""[0m
[30;1m1874 | [0m[35m        elapsed_time_queue_total = player.corrected_elapsed_time or 0[0m
[30;1m1875 | [0m[35m        if queue.current_index is None and not queue.flow_mode_stream_log:[0m
[30;1m1876 | [0m[35m            return queue.current_index, queue.elapsed_time[0m

[31m--[ [0m[34mMatch #[0m[33m1579[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1838 | [0m[35m        if "state" in changed_keys and queue.state == PlayerState.IDLE:[0m
[30;1m1839 | [0m[35m            self._handle_end_of_queue(queue, prev_state, new_state)[0m
[30;1m1840 | [0m[35m[0m
[30;1m1841 | [0m[35m        # watch dynamic radio items refill if needed[0m
[30;1m1842 | [0m[35m        if "current_item_id" in changed_keys:[0m
[30;1m1843 | [0m[35m            # auto enable radio mode if dont stop the music is enabled[0m
[30;1m1844 | [0m[35m            if ([0m

[31m--[ [0m[34mMatch #[0m[33m1580[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1803 | [0m[35m[0m
[30;1m1804 | [0m[35m        # signal update and store state[0m
[30;1m1805 | [0m[35m        if changed_keys == {"elapsed_time"}:[0m
[30;1m1806 | [0m[35m            # do not send full updates if only time was updated[0m
[30;1m1807 | [0m[35m            self.mass.signal_event([0m
[30;1m1808 | [0m[35m                EventType.QUEUE_TIME_UPDATED,[0m
[30;1m1809 | [0m[35m                object_id=queue_id,[0m

[31m--[ [0m[34mMatch #[0m[33m1581[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1741 | [0m[35m            queue.current_item = current_item = self.get_item(queue_id, current_index)[0m
[30;1m1742 | [0m[35m            queue.next_item = self.get_next_item(queue_id, current_index) if current_item else None[0m
[30;1m1743 | [0m[35m[0m
[30;1m1744 | [0m[35m            # correct elapsed time when seeking[0m
[30;1m1745 | [0m[35m            if ([0m
[30;1m1746 | [0m[35m                not queue.flow_mode[0m
[30;1m1747 | [0m[35m                and current_item[0m

[31m--[ [0m[34mMatch #[0m[33m1582[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1725 | [0m[35m            # to ensure we keep the previously known current index[0m
[30;1m1726 | [0m[35m            if queue.flow_mode:[0m
[30;1m1727 | [0m[35m                # flow mode active, the player is playing one long stream[0m
[30;1m1728 | [0m[35m                # so we need to calculate the current index and elapsed time[0m
[30;1m1729 | [0m[35m                current_index, elapsed_time = self._get_flow_queue_stream_index(queue, player)[0m
[30;1m1730 | [0m[35m            elif item_id := self._parse_player_current_item_id(queue_id, player):[0m
[30;1m1731 | [0m[35m                # normal mode, the player itself will report the current item[0m
[30;1m1732 | [0m[35m                elapsed_time = int(player.corrected_elapsed_time or 0)[0m

[31m--[ [0m[34mMatch #[0m[33m1583[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1422 | [0m[35m        ][0m
[30;1m1423 | [0m[35m        all_episodes.sort(key=lambda x: x.position)[0m
[30;1m1424 | [0m[35m        # if a episode was provided, a user explicitly selected a episode to play[0m
[30;1m1425 | [0m[35m        # so we need to find the index of the episode in the list[0m
[30;1m1426 | [0m[35m        if isinstance(episode, PodcastEpisode):[0m
[30;1m1427 | [0m[35m            episode = next((x for x in all_episodes if x.uri == episode.uri), None)[0m
[30;1m1428 | [0m[35m            # ensure we have accurate resume info[0m

[31m--[ [0m[34mMatch #[0m[33m1584[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1361 | [0m[35m            "Fetching tracks to play for playlist %s",[0m
[30;1m1362 | [0m[35m            playlist.name,[0m
[30;1m1363 | [0m[35m        )[0m
[30;1m1364 | [0m[35m        # TODO: Handle other sort options etc.[0m
[30;1m1365 | [0m[35m        async for playlist_track in self.mass.music.playlists.tracks([0m
[30;1m1366 | [0m[35m            playlist.item_id, playlist.provider[0m
[30;1m1367 | [0m[35m        ):[0m

[31m--[ [0m[34mMatch #[0m[33m1585[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m979 | [0m[35m            return[0m
[30;1m980 | [0m[35m        if queue.queue_id in self._transitioning_players:[0m
[30;1m981 | [0m[35m            # we're currently transitioning to a new track,[0m
[30;1m982 | [0m[35m            # ignore updates from the player during this time[0m
[30;1m983 | [0m[35m            return[0m
[30;1m984 | [0m[35m[0m
[30;1m985 | [0m[35m        # queue is active and preflight checks passed, update the queue details[0m
[30;1m986 | [0m[35m        self._update_queue_from_player(player)[0m

[31m--[ [0m[34mMatch #[0m[33m1586[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m542 | [0m[35m        - queue_item_id: the item_id of the queueitem that needs to be moved.[0m
[30;1m543 | [0m[35m        - pos_shift: move item x positions down if positive value[0m
[30;1m544 | [0m[35m        - pos_shift: move item x positions up if negative value[0m
[30;1m545 | [0m[35m        - pos_shift:  move item to top of queue as next item if 0.[0m
[30;1m546 | [0m[35m        """[0m
[30;1m547 | [0m[35m        queue = self._queues[queue_id][0m
[30;1m548 | [0m[35m        item_index = self.index_by_id(queue_id, queue_item_id)[0m

[31m--[ [0m[34mMatch #[0m[33m1587[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m320 | [0m[35m            next_items = [][0m
[30;1m321 | [0m[35m            next_index = 0[0m
[30;1m322 | [0m[35m        if not shuffle_enabled:[0m
[30;1m323 | [0m[35m            # shuffle disabled, try to restore original sort order of the remaining items[0m
[30;1m324 | [0m[35m            next_items.sort(key=lambda x: x.sort_index, reverse=False)[0m
[30;1m325 | [0m[35m        self.load([0m
[30;1m326 | [0m[35m            queue_id=queue_id,[0m

[31m--[ [0m[34mMatch #[0m[33m1588[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/player_queues.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35mimport asyncio[0m
[30;1m17 | [0m[35mimport random[0m
[30;1m18 | [0m[35mimport time[0m
[30;1m19 | [0m[35mfrom types import NoneType[0m
[30;1m20 | [0m[35mfrom typing import TYPE_CHECKING, Any, TypedDict, cast[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mimport shortuuid[0m

[31m--[ [0m[34mMatch #[0m[33m1589[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1729 | [0m[35m    async def _get_podcast_metadata(self, podcast_folder: str) -> dict[str, Any]:[0m
[30;1m1730 | [0m[35m        """Return metadata for a podcast."""[0m
[30;1m1731 | [0m[35m        cache_base_key = f"{self.lookup_key}.podcastmetadata"[0m
[30;1m1732 | [0m[35m        if (cache := await self.cache.get(podcast_folder, base_key=cache_base_key)) is not None:[0m
[30;1m1733 | [0m[35m            return cast("dict[str, Any]", cache)[0m
[30;1m1734 | [0m[35m        data: dict[str, Any] = {}[0m
[30;1m1735 | [0m[35m        metadata_file = os.path.join(podcast_folder, "metadata.json")[0m

[31m--[ [0m[34mMatch #[0m[33m1590[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1693 | [0m[35m                if item.ext not in AUDIOBOOK_EXTENSIONS:[0m
[30;1m1694 | [0m[35m                    continue[0m
[30;1m1695 | [0m[35m                item_tags = await async_parse_tags(item.absolute_path, item.file_size)[0m
[30;1m1696 | [0m[35m                if not (tags.album == item_tags.album or (item_tags.tags.get("title") is None)):[0m
[30;1m1697 | [0m[35m                    continue[0m
[30;1m1698 | [0m[35m                if item_tags.track is None:[0m
[30;1m1699 | [0m[35m                    continue[0m

[31m--[ [0m[34mMatch #[0m[33m1591[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1627 | [0m[35m            # no cache available for this audiobook, we need to parse the chapters[0m
[30;1m1628 | [0m[35m            tags = await async_parse_tags(file_item.absolute_path, file_item.file_size)[0m
[30;1m1629 | [0m[35m            await self._parse_audiobook(file_item, tags)[0m
[30;1m1630 | [0m[35m            file_based_chapters = await self.cache.get([0m
[30;1m1631 | [0m[35m                file_item.relative_path,[0m
[30;1m1632 | [0m[35m                base_key=chapters_cache_key,[0m
[30;1m1633 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m1592[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1619 | [0m[35m        file_item = await self.resolve(item_id)[0m
[30;1m1620 | [0m[35m        duration = library_item.duration[0m
[30;1m1621 | [0m[35m        chapters_cache_key = f"{self.lookup_key}.audiobook.chapters"[0m
[30;1m1622 | [0m[35m        file_based_chapters: list[tuple[str, float]] | None = await self.cache.get([0m
[30;1m1623 | [0m[35m            file_item.relative_path,[0m
[30;1m1624 | [0m[35m            base_key=chapters_cache_key,[0m
[30;1m1625 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1593[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1451 | [0m[35m    ) -> UniqueList[MediaItemImage]:[0m
[30;1m1452 | [0m[35m        """Return local images found in a given folderpath."""[0m
[30;1m1453 | [0m[35m        cache_base_key = f"{self.lookup_key}.folderimages"[0m
[30;1m1454 | [0m[35m        if (cache := await self.cache.get(folder, base_key=cache_base_key)) is not None:[0m
[30;1m1455 | [0m[35m            return cast("UniqueList[MediaItemImage]", cache)[0m
[30;1m1456 | [0m[35m        if extra_thumb_names is None:[0m
[30;1m1457 | [0m[35m            extra_thumb_names = ()[0m

[31m--[ [0m[34mMatch #[0m[33m1594[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1433 | [0m[35m                    album.metadata.description = description[0m
[30;1m1434 | [0m[35m                if year := info.get("year"):[0m
[30;1m1435 | [0m[35m                    album.year = int(year)[0m
[30;1m1436 | [0m[35m                if genre := info.get("genre"):[0m
[30;1m1437 | [0m[35m                    album.metadata.genres = set(split_items(genre))[0m
[30;1m1438 | [0m[35m            # parse name/version[0m
[30;1m1439 | [0m[35m            album.name, album.version = parse_title_and_version(album.name)[0m

[31m--[ [0m[34mMatch #[0m[33m1595[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1431 | [0m[35m                        album.artists[0].mbid = mb_artist_id[0m
[30;1m1432 | [0m[35m                if description := info.get("review"):[0m
[30;1m1433 | [0m[35m                    album.metadata.description = description[0m
[30;1m1434 | [0m[35m                if year := info.get("year"):[0m
[30;1m1435 | [0m[35m                    album.year = int(year)[0m
[30;1m1436 | [0m[35m                if genre := info.get("genre"):[0m
[30;1m1437 | [0m[35m                    album.metadata.genres = set(split_items(genre))[0m

[31m--[ [0m[34mMatch #[0m[33m1596[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1429 | [0m[35m                if mb_artist_id := info.get("musicbrainzalbumartistid"):[0m
[30;1m1430 | [0m[35m                    if album.artists and not album.artists[0].mbid:[0m
[30;1m1431 | [0m[35m                        album.artists[0].mbid = mb_artist_id[0m
[30;1m1432 | [0m[35m                if description := info.get("review"):[0m
[30;1m1433 | [0m[35m                    album.metadata.description = description[0m
[30;1m1434 | [0m[35m                if year := info.get("year"):[0m
[30;1m1435 | [0m[35m                    album.year = int(year)[0m

[31m--[ [0m[34mMatch #[0m[33m1597[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1426 | [0m[35m                    album.add_external_id(ExternalID.MB_RELEASEGROUP, releasegroup_id)[0m
[30;1m1427 | [0m[35m                if album_id := info.get("musicbrainzalbumid"):[0m
[30;1m1428 | [0m[35m                    album.add_external_id(ExternalID.MB_ALBUM, album_id)[0m
[30;1m1429 | [0m[35m                if mb_artist_id := info.get("musicbrainzalbumartistid"):[0m
[30;1m1430 | [0m[35m                    if album.artists and not album.artists[0].mbid:[0m
[30;1m1431 | [0m[35m                        album.artists[0].mbid = mb_artist_id[0m
[30;1m1432 | [0m[35m                if description := info.get("review"):[0m

[31m--[ [0m[34mMatch #[0m[33m1598[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1424 | [0m[35m                    album.sort_name = sort_name[0m
[30;1m1425 | [0m[35m                if releasegroup_id := info.get("musicbrainzreleasegroupid"):[0m
[30;1m1426 | [0m[35m                    album.add_external_id(ExternalID.MB_RELEASEGROUP, releasegroup_id)[0m
[30;1m1427 | [0m[35m                if album_id := info.get("musicbrainzalbumid"):[0m
[30;1m1428 | [0m[35m                    album.add_external_id(ExternalID.MB_ALBUM, album_id)[0m
[30;1m1429 | [0m[35m                if mb_artist_id := info.get("musicbrainzalbumartistid"):[0m
[30;1m1430 | [0m[35m                    if album.artists and not album.artists[0].mbid:[0m

[31m--[ [0m[34mMatch #[0m[33m1599[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1422 | [0m[35m                album.name = info.get("title", info.get("name", name))[0m
[30;1m1423 | [0m[35m                if sort_name := info.get("sortname"):[0m
[30;1m1424 | [0m[35m                    album.sort_name = sort_name[0m
[30;1m1425 | [0m[35m                if releasegroup_id := info.get("musicbrainzreleasegroupid"):[0m
[30;1m1426 | [0m[35m                    album.add_external_id(ExternalID.MB_RELEASEGROUP, releasegroup_id)[0m
[30;1m1427 | [0m[35m                if album_id := info.get("musicbrainzalbumid"):[0m
[30;1m1428 | [0m[35m                    album.add_external_id(ExternalID.MB_ALBUM, album_id)[0m

[31m--[ [0m[34mMatch #[0m[33m1600[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1420 | [0m[35m                info = await asyncio.to_thread(xmltodict.parse, data)[0m
[30;1m1421 | [0m[35m                info = info["album"][0m
[30;1m1422 | [0m[35m                album.name = info.get("title", info.get("name", name))[0m
[30;1m1423 | [0m[35m                if sort_name := info.get("sortname"):[0m
[30;1m1424 | [0m[35m                    album.sort_name = sort_name[0m
[30;1m1425 | [0m[35m                if releasegroup_id := info.get("musicbrainzreleasegroupid"):[0m
[30;1m1426 | [0m[35m                    album.add_external_id(ExternalID.MB_RELEASEGROUP, releasegroup_id)[0m

[31m--[ [0m[34mMatch #[0m[33m1601[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1419 | [0m[35m                    data = await _file.read()[0m
[30;1m1420 | [0m[35m                info = await asyncio.to_thread(xmltodict.parse, data)[0m
[30;1m1421 | [0m[35m                info = info["album"][0m
[30;1m1422 | [0m[35m                album.name = info.get("title", info.get("name", name))[0m
[30;1m1423 | [0m[35m                if sort_name := info.get("sortname"):[0m
[30;1m1424 | [0m[35m                    album.sort_name = sort_name[0m
[30;1m1425 | [0m[35m                if releasegroup_id := info.get("musicbrainzreleasegroupid"):[0m

[31m--[ [0m[34mMatch #[0m[33m1602[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1419 | [0m[35m                    data = await _file.read()[0m
[30;1m1420 | [0m[35m                info = await asyncio.to_thread(xmltodict.parse, data)[0m
[30;1m1421 | [0m[35m                info = info["album"][0m
[30;1m1422 | [0m[35m                album.name = info.get("title", info.get("name", name))[0m
[30;1m1423 | [0m[35m                if sort_name := info.get("sortname"):[0m
[30;1m1424 | [0m[35m                    album.sort_name = sort_name[0m
[30;1m1425 | [0m[35m                if releasegroup_id := info.get("musicbrainzreleasegroupid"):[0m

[31m--[ [0m[34mMatch #[0m[33m1603[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1309 | [0m[35m        album_dir = get_album_dir(track_dir, track_tags.album)[0m
[30;1m1310 | [0m[35m[0m
[30;1m1311 | [0m[35m        cache_base_key = f"{self.instance_id}.album"[0m
[30;1m1312 | [0m[35m        if album_dir and (cache := await self.cache.get(album_dir, base_key=cache_base_key)):[0m
[30;1m1313 | [0m[35m            return cast("Album", cache)[0m
[30;1m1314 | [0m[35m[0m
[30;1m1315 | [0m[35m        # album artist(s)[0m

[31m--[ [0m[34mMatch #[0m[33m1604[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1270 | [0m[35m                episode.podcast.metadata.genres = set(genres)[0m
[30;1m1271 | [0m[35m            if publisher := metadata.get("publisher"):[0m
[30;1m1272 | [0m[35m                episode.podcast.publisher = publisher[0m
[30;1m1273 | [0m[35m            if image := metadata.get("imageURL"):[0m
[30;1m1274 | [0m[35m                episode.podcast.metadata.add_image([0m
[30;1m1275 | [0m[35m                    MediaItemImage([0m
[30;1m1276 | [0m[35m                        type=ImageType.THUMB,[0m

[31m--[ [0m[34mMatch #[0m[33m1605[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1268 | [0m[35m                episode.podcast.metadata.description = description[0m
[30;1m1269 | [0m[35m            if genres := metadata.get("genres"):[0m
[30;1m1270 | [0m[35m                episode.podcast.metadata.genres = set(genres)[0m
[30;1m1271 | [0m[35m            if publisher := metadata.get("publisher"):[0m
[30;1m1272 | [0m[35m                episode.podcast.publisher = publisher[0m
[30;1m1273 | [0m[35m            if image := metadata.get("imageURL"):[0m
[30;1m1274 | [0m[35m                episode.podcast.metadata.add_image([0m

[31m--[ [0m[34mMatch #[0m[33m1606[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1266 | [0m[35m                episode.podcast.sort_name = sort_name[0m
[30;1m1267 | [0m[35m            if description := metadata.get("description"):[0m
[30;1m1268 | [0m[35m                episode.podcast.metadata.description = description[0m
[30;1m1269 | [0m[35m            if genres := metadata.get("genres"):[0m
[30;1m1270 | [0m[35m                episode.podcast.metadata.genres = set(genres)[0m
[30;1m1271 | [0m[35m            if publisher := metadata.get("publisher"):[0m
[30;1m1272 | [0m[35m                episode.podcast.publisher = publisher[0m

[31m--[ [0m[34mMatch #[0m[33m1607[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1264 | [0m[35m                episode.podcast.name = title[0m
[30;1m1265 | [0m[35m            if sort_name := metadata.get("sorttitle"):[0m
[30;1m1266 | [0m[35m                episode.podcast.sort_name = sort_name[0m
[30;1m1267 | [0m[35m            if description := metadata.get("description"):[0m
[30;1m1268 | [0m[35m                episode.podcast.metadata.description = description[0m
[30;1m1269 | [0m[35m            if genres := metadata.get("genres"):[0m
[30;1m1270 | [0m[35m                episode.podcast.metadata.genres = set(genres)[0m

[31m--[ [0m[34mMatch #[0m[33m1608[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1262 | [0m[35m        if metadata := await self._get_podcast_metadata(file_item.parent_path):[0m
[30;1m1263 | [0m[35m            if title := metadata.get("title"):[0m
[30;1m1264 | [0m[35m                episode.podcast.name = title[0m
[30;1m1265 | [0m[35m            if sort_name := metadata.get("sorttitle"):[0m
[30;1m1266 | [0m[35m                episode.podcast.sort_name = sort_name[0m
[30;1m1267 | [0m[35m            if description := metadata.get("description"):[0m
[30;1m1268 | [0m[35m                episode.podcast.metadata.description = description[0m

[31m--[ [0m[34mMatch #[0m[33m1609[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1260 | [0m[35m        if images := await self._get_local_images(file_item.parent_path):[0m
[30;1m1261 | [0m[35m            episode.podcast.metadata.images = images[0m
[30;1m1262 | [0m[35m        if metadata := await self._get_podcast_metadata(file_item.parent_path):[0m
[30;1m1263 | [0m[35m            if title := metadata.get("title"):[0m
[30;1m1264 | [0m[35m                episode.podcast.name = title[0m
[30;1m1265 | [0m[35m            if sort_name := metadata.get("sorttitle"):[0m
[30;1m1266 | [0m[35m                episode.podcast.sort_name = sort_name[0m

[31m--[ [0m[34mMatch #[0m[33m1610[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1239 | [0m[35m        episode.metadata.copyright = tags.get("copyright")[0m
[30;1m1240 | [0m[35m        episode.metadata.lyrics = tags.lyrics[0m
[30;1m1241 | [0m[35m        episode.metadata.description = tags.get("comment")[0m
[30;1m1242 | [0m[35m        explicit_tag = tags.get("itunesadvisory")[0m
[30;1m1243 | [0m[35m        if explicit_tag is not None:[0m
[30;1m1244 | [0m[35m            episode.metadata.explicit = explicit_tag == "1"[0m
[30;1m1245 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1611[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1238 | [0m[35m        episode.metadata.genres = set(tags.genres)[0m
[30;1m1239 | [0m[35m        episode.metadata.copyright = tags.get("copyright")[0m
[30;1m1240 | [0m[35m        episode.metadata.lyrics = tags.lyrics[0m
[30;1m1241 | [0m[35m        episode.metadata.description = tags.get("comment")[0m
[30;1m1242 | [0m[35m        explicit_tag = tags.get("itunesadvisory")[0m
[30;1m1243 | [0m[35m        if explicit_tag is not None:[0m
[30;1m1244 | [0m[35m            episode.metadata.explicit = explicit_tag == "1"[0m

[31m--[ [0m[34mMatch #[0m[33m1612[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1236 | [0m[35m            )[0m
[30;1m1237 | [0m[35m        # parse other info[0m
[30;1m1238 | [0m[35m        episode.metadata.genres = set(tags.genres)[0m
[30;1m1239 | [0m[35m        episode.metadata.copyright = tags.get("copyright")[0m
[30;1m1240 | [0m[35m        episode.metadata.lyrics = tags.lyrics[0m
[30;1m1241 | [0m[35m        episode.metadata.description = tags.get("comment")[0m
[30;1m1242 | [0m[35m        explicit_tag = tags.get("itunesadvisory")[0m

[31m--[ [0m[34mMatch #[0m[33m1613[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1211 | [0m[35m                provider=self.instance_id,[0m
[30;1m1212 | [0m[35m                name=podcast_name,[0m
[30;1m1213 | [0m[35m                sort_name=tags.album_sort,[0m
[30;1m1214 | [0m[35m                publisher=tags.tags.get("publisher"),[0m
[30;1m1215 | [0m[35m                provider_mappings={[0m
[30;1m1216 | [0m[35m                    ProviderMapping([0m
[30;1m1217 | [0m[35m                        item_id=podcast_path,[0m

[31m--[ [0m[34mMatch #[0m[33m1614[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1129 | [0m[35m        audio_book.metadata.copyright = tags.get("copyright")[0m
[30;1m1130 | [0m[35m        audio_book.metadata.lyrics = tags.lyrics[0m
[30;1m1131 | [0m[35m        audio_book.metadata.description = tags.get("comment")[0m
[30;1m1132 | [0m[35m        explicit_tag = tags.get("itunesadvisory")[0m
[30;1m1133 | [0m[35m        if explicit_tag is not None:[0m
[30;1m1134 | [0m[35m            audio_book.metadata.explicit = explicit_tag == "1"[0m
[30;1m1135 | [0m[35m        if tags.musicbrainz_recordingid:[0m

[31m--[ [0m[34mMatch #[0m[33m1615[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1128 | [0m[35m        audio_book.metadata.genres = set(tags.genres)[0m
[30;1m1129 | [0m[35m        audio_book.metadata.copyright = tags.get("copyright")[0m
[30;1m1130 | [0m[35m        audio_book.metadata.lyrics = tags.lyrics[0m
[30;1m1131 | [0m[35m        audio_book.metadata.description = tags.get("comment")[0m
[30;1m1132 | [0m[35m        explicit_tag = tags.get("itunesadvisory")[0m
[30;1m1133 | [0m[35m        if explicit_tag is not None:[0m
[30;1m1134 | [0m[35m            audio_book.metadata.explicit = explicit_tag == "1"[0m

[31m--[ [0m[34mMatch #[0m[33m1616[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1126 | [0m[35m        # parse other info[0m
[30;1m1127 | [0m[35m        audio_book.authors.set(tags.writers or tags.album_artists or tags.artists)[0m
[30;1m1128 | [0m[35m        audio_book.metadata.genres = set(tags.genres)[0m
[30;1m1129 | [0m[35m        audio_book.metadata.copyright = tags.get("copyright")[0m
[30;1m1130 | [0m[35m        audio_book.metadata.lyrics = tags.lyrics[0m
[30;1m1131 | [0m[35m        audio_book.metadata.description = tags.get("comment")[0m
[30;1m1132 | [0m[35m        explicit_tag = tags.get("itunesadvisory")[0m

[31m--[ [0m[34mMatch #[0m[33m1617[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1073 | [0m[35m        if tags.album:[0m
[30;1m1074 | [0m[35m            book_name = tags.album[0m
[30;1m1075 | [0m[35m            sort_name = tags.album_sort[0m
[30;1m1076 | [0m[35m        elif (title := tags.tags.get("title")) and tags.track is None:[0m
[30;1m1077 | [0m[35m            book_name = title[0m
[30;1m1078 | [0m[35m            sort_name = tags.title_sort[0m
[30;1m1079 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m1618[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1050 | [0m[35m                artist.mbid = mbid[0m
[30;1m1051 | [0m[35m            if description := info.get("biography"):[0m
[30;1m1052 | [0m[35m                artist.metadata.description = description[0m
[30;1m1053 | [0m[35m            if genre := info.get("genre"):[0m
[30;1m1054 | [0m[35m                artist.metadata.genres = set(split_items(genre))[0m
[30;1m1055 | [0m[35m        # find local images[0m
[30;1m1056 | [0m[35m        if images := await self._get_local_images(artist_path, extra_thumb_names=("artist",)):[0m

[31m--[ [0m[34mMatch #[0m[33m1619[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1048 | [0m[35m                artist.sort_name = sort_name[0m
[30;1m1049 | [0m[35m            if mbid := info.get("musicbrainzartistid"):[0m
[30;1m1050 | [0m[35m                artist.mbid = mbid[0m
[30;1m1051 | [0m[35m            if description := info.get("biography"):[0m
[30;1m1052 | [0m[35m                artist.metadata.description = description[0m
[30;1m1053 | [0m[35m            if genre := info.get("genre"):[0m
[30;1m1054 | [0m[35m                artist.metadata.genres = set(split_items(genre))[0m

[31m--[ [0m[34mMatch #[0m[33m1620[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1046 | [0m[35m            artist.name = info.get("title", info.get("name", name))[0m
[30;1m1047 | [0m[35m            if sort_name := info.get("sortname"):[0m
[30;1m1048 | [0m[35m                artist.sort_name = sort_name[0m
[30;1m1049 | [0m[35m            if mbid := info.get("musicbrainzartistid"):[0m
[30;1m1050 | [0m[35m                artist.mbid = mbid[0m
[30;1m1051 | [0m[35m            if description := info.get("biography"):[0m
[30;1m1052 | [0m[35m                artist.metadata.description = description[0m

[31m--[ [0m[34mMatch #[0m[33m1621[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1044 | [0m[35m            info = await asyncio.to_thread(xmltodict.parse, data)[0m
[30;1m1045 | [0m[35m            info = info["artist"][0m
[30;1m1046 | [0m[35m            artist.name = info.get("title", info.get("name", name))[0m
[30;1m1047 | [0m[35m            if sort_name := info.get("sortname"):[0m
[30;1m1048 | [0m[35m                artist.sort_name = sort_name[0m
[30;1m1049 | [0m[35m            if mbid := info.get("musicbrainzartistid"):[0m
[30;1m1050 | [0m[35m                artist.mbid = mbid[0m

[31m--[ [0m[34mMatch #[0m[33m1622[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1043 | [0m[35m                data = await _file.read()[0m
[30;1m1044 | [0m[35m            info = await asyncio.to_thread(xmltodict.parse, data)[0m
[30;1m1045 | [0m[35m            info = info["artist"][0m
[30;1m1046 | [0m[35m            artist.name = info.get("title", info.get("name", name))[0m
[30;1m1047 | [0m[35m            if sort_name := info.get("sortname"):[0m
[30;1m1048 | [0m[35m                artist.sort_name = sort_name[0m
[30;1m1049 | [0m[35m            if mbid := info.get("musicbrainzartistid"):[0m

[31m--[ [0m[34mMatch #[0m[33m1623[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1043 | [0m[35m                data = await _file.read()[0m
[30;1m1044 | [0m[35m            info = await asyncio.to_thread(xmltodict.parse, data)[0m
[30;1m1045 | [0m[35m            info = info["artist"][0m
[30;1m1046 | [0m[35m            artist.name = info.get("title", info.get("name", name))[0m
[30;1m1047 | [0m[35m            if sort_name := info.get("sortname"):[0m
[30;1m1048 | [0m[35m                artist.sort_name = sort_name[0m
[30;1m1049 | [0m[35m            if mbid := info.get("musicbrainzartistid"):[0m

[31m--[ [0m[34mMatch #[0m[33m1624[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1010 | [0m[35m[0m
[30;1m1011 | [0m[35m        # prefer (short lived) cache for a bit more speed[0m
[30;1m1012 | [0m[35m        cache_base_key = f"{self.instance_id}.artist"[0m
[30;1m1013 | [0m[35m        if artist_path and (cache := await self.cache.get(artist_path, base_key=cache_base_key)):[0m
[30;1m1014 | [0m[35m            return cast("Artist", cache)[0m
[30;1m1015 | [0m[35m[0m
[30;1m1016 | [0m[35m        prov_artist_id = artist_path or name[0m

[31m--[ [0m[34mMatch #[0m[33m1625[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m955 | [0m[35m        track.metadata.copyright = tags.get("copyright")[0m
[30;1m956 | [0m[35m        track.metadata.lyrics = tags.lyrics[0m
[30;1m957 | [0m[35m        track.metadata.description = tags.get("comment")[0m
[30;1m958 | [0m[35m        explicit_tag = tags.get("itunesadvisory")[0m
[30;1m959 | [0m[35m        if explicit_tag is not None:[0m
[30;1m960 | [0m[35m            track.metadata.explicit = explicit_tag == "1"[0m
[30;1m961 | [0m[35m        if tags.musicbrainz_recordingid:[0m

[31m--[ [0m[34mMatch #[0m[33m1626[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m954 | [0m[35m            track.track_number = tags.track[0m
[30;1m955 | [0m[35m        track.metadata.copyright = tags.get("copyright")[0m
[30;1m956 | [0m[35m        track.metadata.lyrics = tags.lyrics[0m
[30;1m957 | [0m[35m        track.metadata.description = tags.get("comment")[0m
[30;1m958 | [0m[35m        explicit_tag = tags.get("itunesadvisory")[0m
[30;1m959 | [0m[35m        if explicit_tag is not None:[0m
[30;1m960 | [0m[35m            track.metadata.explicit = explicit_tag == "1"[0m

[31m--[ [0m[34mMatch #[0m[33m1627[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m952 | [0m[35m            track.disc_number = tags.disc[0m
[30;1m953 | [0m[35m        if tags.track:[0m
[30;1m954 | [0m[35m            track.track_number = tags.track[0m
[30;1m955 | [0m[35m        track.metadata.copyright = tags.get("copyright")[0m
[30;1m956 | [0m[35m        track.metadata.lyrics = tags.lyrics[0m
[30;1m957 | [0m[35m        track.metadata.description = tags.get("comment")[0m
[30;1m958 | [0m[35m        explicit_tag = tags.get("itunesadvisory")[0m

[31m--[ [0m[34mMatch #[0m[33m1628[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m892 | [0m[35m            for isrsc in isrc_tags:[0m
[30;1m893 | [0m[35m                track.external_ids.add((ExternalID.ISRC, isrsc))[0m
[30;1m894 | [0m[35m[0m
[30;1m895 | [0m[35m        if acoustid := tags.get("acoustid"):[0m
[30;1m896 | [0m[35m            track.external_ids.add((ExternalID.ACOUSTID, acoustid))[0m
[30;1m897 | [0m[35m[0m
[30;1m898 | [0m[35m        # album[0m

[31m--[ [0m[34mMatch #[0m[33m1629[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m361 | [0m[35m            self.sync_running = True[0m
[30;1m362 | [0m[35m            try:[0m
[30;1m363 | [0m[35m                for item in listdir(self.base_path):[0m
[30;1m364 | [0m[35m                    prev_checksum = file_checksums.get(item.relative_path)[0m
[30;1m365 | [0m[35m                    if self._process_item(item, prev_checksum):[0m
[30;1m366 | [0m[35m                        cur_filenames.add(item.relative_path)[0m
[30;1m367 | [0m[35m            finally:[0m

[31m--[ [0m[34mMatch #[0m[33m1630[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m985 | [0m[35m        if not artist_path:[0m
[30;1m986 | [0m[35m            # we need to hunt for the artist (metadata) path on disk[0m
[30;1m987 | [0m[35m            # this can either be relative to the album path or at root level[0m
[30;1m988 | [0m[35m            # check if we have an artist folder for this artist at root level[0m
[30;1m989 | [0m[35m            safe_artist_name = create_safe_string(name, lowercase=False, replace_space=False)[0m
[30;1m990 | [0m[35m            if await self.exists(name):[0m
[30;1m991 | [0m[35m                artist_path = name[0m

[31m--[ [0m[34mMatch #[0m[33m1631[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m984 | [0m[35m        """Parse full (album) Artist."""[0m
[30;1m985 | [0m[35m        if not artist_path:[0m
[30;1m986 | [0m[35m            # we need to hunt for the artist (metadata) path on disk[0m
[30;1m987 | [0m[35m            # this can either be relative to the album path or at root level[0m
[30;1m988 | [0m[35m            # check if we have an artist folder for this artist at root level[0m
[30;1m989 | [0m[35m            safe_artist_name = create_safe_string(name, lowercase=False, replace_space=False)[0m
[30;1m990 | [0m[35m            if await self.exists(name):[0m

[31m--[ [0m[34mMatch #[0m[33m1632[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1437 | [0m[35m                    album.metadata.genres = set(split_items(genre))[0m
[30;1m1438 | [0m[35m            # parse name/version[0m
[30;1m1439 | [0m[35m            album.name, album.version = parse_title_and_version(album.name)[0m
[30;1m1440 | [0m[35m            # find local images[0m
[30;1m1441 | [0m[35m            if images := await self._get_local_images(folder_path, extra_thumb_names=("album",)):[0m
[30;1m1442 | [0m[35m                if album.metadata.images is None:[0m
[30;1m1443 | [0m[35m                    album.metadata.images = UniqueList(images)[0m

[31m--[ [0m[34mMatch #[0m[33m1633[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1052 | [0m[35m                artist.metadata.description = description[0m
[30;1m1053 | [0m[35m            if genre := info.get("genre"):[0m
[30;1m1054 | [0m[35m                artist.metadata.genres = set(split_items(genre))[0m
[30;1m1055 | [0m[35m        # find local images[0m
[30;1m1056 | [0m[35m        if images := await self._get_local_images(artist_path, extra_thumb_names=("artist",)):[0m
[30;1m1057 | [0m[35m            artist.metadata.images = UniqueList(images)[0m
[30;1m1058 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1634[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m992 | [0m[35m            elif await self.exists(safe_artist_name):[0m
[30;1m993 | [0m[35m                artist_path = safe_artist_name[0m
[30;1m994 | [0m[35m            elif album_dir and (foldermatch := get_artist_dir(name, album_dir=album_dir)):[0m
[30;1m995 | [0m[35m                # try to find (album)artist folder based on album path[0m
[30;1m996 | [0m[35m                artist_path = foldermatch[0m
[30;1m997 | [0m[35m            else:[0m
[30;1m998 | [0m[35m                # check if we have an existing item to retrieve the artist path[0m

[31m--[ [0m[34mMatch #[0m[33m1635[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m331 | [0m[35m        )[0m
[30;1m332 | [0m[35m        for db_row in await self.mass.music.database.get_rows_from_query(query, limit=0):[0m
[30;1m333 | [0m[35m            file_checksums[db_row["provider_item_id"]] = str(db_row["details"])[0m
[30;1m334 | [0m[35m        # find all supported files in the base directory and all subfolders[0m
[30;1m335 | [0m[35m        # we work bottom up, as-in we derive all info from the tracks[0m
[30;1m336 | [0m[35m        cur_filenames = set()[0m
[30;1m337 | [0m[35m        prev_filenames = set(file_checksums.keys())[0m

[31m--[ [0m[34mMatch #[0m[33m1636[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mimport logging[0m
[30;1m8 | [0m[35mimport os[0m
[30;1m9 | [0m[35mimport os.path[0m
[30;1m10 | [0m[35mimport time[0m
[30;1m11 | [0m[35mimport urllib.parse[0m
[30;1m12 | [0m[35mfrom collections.abc import AsyncGenerator, Iterator, Sequence[0m
[30;1m13 | [0m[35mfrom pathlib import Path[0m
[30;1m14 | [0m[35mfrom typing import TYPE_CHECKING, Any, cast[0m

[31m--[ [0m[34mMatch #[0m[33m1637[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/opensubsonic/sonic_provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m869 | [0m[35m        try:[0m
[30;1m870 | [0m[35m            while True:[0m
[30;1m871 | [0m[35m                # keep reading from the audio buffer until there is no more data[0m
[30;1m872 | [0m[35m                chunk = await audio_buffer.get()[0m
[30;1m873 | [0m[35m                if chunk == b"EOF":[0m
[30;1m874 | [0m[35m                    break[0m
[30;1m875 | [0m[35m                yield chunk[0m

[31m--[ [0m[34mMatch #[0m[33m1638[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/opensubsonic/sonic_provider.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m659 | [0m[35m        """Get playlist tracks."""[0m
[30;1m660 | [0m[35m        result: list[Track] = [][0m
[30;1m661 | [0m[35m        if page > 0:[0m
[30;1m662 | [0m[35m            # paging not supported, we always return the whole list at once[0m
[30;1m663 | [0m[35m            return result[0m
[30;1m664 | [0m[35m        try:[0m
[30;1m665 | [0m[35m            sonic_playlist: SonicPlaylist = await self._run_async([0m

[31m--[ [0m[34mMatch #[0m[33m1639[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/opensubsonic/sonic_provider.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m704 | [0m[35m        except DataNotFoundError as e:[0m
[30;1m705 | [0m[35m            # Subsonic returns an error here instead of an empty list, I don't think this[0m
[30;1m706 | [0m[35m            # should be an exception but there we are. Return an empty list because this[0m
[30;1m707 | [0m[35m            # exception means we didn't find anything similar.[0m
[30;1m708 | [0m[35m            self.logger.info(e)[0m
[30;1m709 | [0m[35m            return [][0m
[30;1m710 | [0m[35m        return [self._parse_track(entry) for entry in songs][0m

[31m--[ [0m[34mMatch #[0m[33m1640[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/opensubsonic/sonic_provider.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m683 | [0m[35m[0m
[30;1m684 | [0m[35m    async def get_artist_toptracks(self, prov_artist_id: str) -> list[Track]:[0m
[30;1m685 | [0m[35m        """Get the top listed tracks for a specified artist."""[0m
[30;1m686 | [0m[35m        # We have seen top tracks requested for the UNKNOWN_ARTIST ID, protect against that[0m
[30;1m687 | [0m[35m        if prov_artist_id == UNKNOWN_ARTIST_ID or prov_artist_id.startswith(NAVI_VARIOUS_PREFIX):[0m
[30;1m688 | [0m[35m            return [][0m
[30;1m689 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1641[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/opensubsonic/sonic_provider.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m682 | [0m[35m        return result[0m
[30;1m683 | [0m[35m[0m
[30;1m684 | [0m[35m    async def get_artist_toptracks(self, prov_artist_id: str) -> list[Track]:[0m
[30;1m685 | [0m[35m        """Get the top listed tracks for a specified artist."""[0m
[30;1m686 | [0m[35m        # We have seen top tracks requested for the UNKNOWN_ARTIST ID, protect against that[0m
[30;1m687 | [0m[35m        if prov_artist_id == UNKNOWN_ARTIST_ID or prov_artist_id.startswith(NAVI_VARIOUS_PREFIX):[0m
[30;1m688 | [0m[35m            return [][0m

[31m--[ [0m[34mMatch #[0m[33m1642[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/opensubsonic/sonic_provider.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m673 | [0m[35m        for index, sonic_song in enumerate(sonic_playlist.songs, 1):[0m
[30;1m674 | [0m[35m            aid = sonic_song.album_id if sonic_song.album_id else sonic_song.parent[0m
[30;1m675 | [0m[35m            if not aid:[0m
[30;1m676 | [0m[35m                self.logger.warning("Unable to find albumd for track %s", sonic_song.id)[0m
[30;1m677 | [0m[35m            if not album or album.item_id != aid:[0m
[30;1m678 | [0m[35m                album = await self.get_album(prov_album_id=aid)[0m
[30;1m679 | [0m[35m            track = self._parse_track(sonic_song, album=album)[0m

[31m--[ [0m[34mMatch #[0m[33m1643[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/opensubsonic/sonic_provider.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m582 | [0m[35m            raise MediaNotFoundError(msg) from e[0m
[30;1m583 | [0m[35m        aid = sonic_song.album_id if sonic_song.album_id else sonic_song.parent[0m
[30;1m584 | [0m[35m        if not aid:[0m
[30;1m585 | [0m[35m            self.logger.warning("Unable to find album id for track %s", sonic_song.id)[0m
[30;1m586 | [0m[35m        album: Album = await self.get_album(prov_album_id=aid)[0m
[30;1m587 | [0m[35m        return self._parse_track(sonic_song, album=album)[0m
[30;1m588 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1644[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/opensubsonic/sonic_provider.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m376 | [0m[35m            if episode.id == ep_id:[0m
[30;1m377 | [0m[35m                return episode[0m
[30;1m378 | [0m[35m[0m
[30;1m379 | [0m[35m        msg = f"Can't find episode {ep_id} in podcast {chan_id}"[0m
[30;1m380 | [0m[35m        raise MediaNotFoundError(msg)[0m
[30;1m381 | [0m[35m[0m
[30;1m382 | [0m[35m    async def _run_async([0m

[31m--[ [0m[34mMatch #[0m[33m1645[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/opensubsonic/sonic_provider.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m255 | [0m[35m                )[0m
[30;1m256 | [0m[35m            else:[0m
[30;1m257 | [0m[35m                self.logger.info([0m
[30;1m258 | [0m[35m                    "Unable to find artist ID for track '%s' with ID '%s'.",[0m
[30;1m259 | [0m[35m                    sonic_song.title,[0m
[30;1m260 | [0m[35m                    sonic_song.id,[0m
[30;1m261 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m1646[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/opensubsonic/sonic_provider.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m214 | [0m[35m            track_number=getattr(sonic_song, "track", 0),[0m
[30;1m215 | [0m[35m        )[0m
[30;1m216 | [0m[35m[0m
[30;1m217 | [0m[35m        # We need to find an artist for this track but various implementations seem to disagree[0m
[30;1m218 | [0m[35m        # about where the artist with the valid ID needs to be found. We will add any artist with[0m
[30;1m219 | [0m[35m        # an ID and only use UNKNOWN if none are found.[0m
[30;1m220 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1647[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m715 | [0m[35m        for child_player_id in mass_player.group_childs:[0m
[30;1m716 | [0m[35m            if child_player_id == player_id:[0m
[30;1m717 | [0m[35m                continue[0m
[30;1m718 | [0m[35m            mass_child_player = self.mass.players.get(child_player_id)[0m
[30;1m719 | [0m[35m            mass_child_player.state = mass_player.state[0m
[30;1m720 | [0m[35m            self.mass.players.update(child_player_id)[0m
[30;1m721 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1648[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m711 | [0m[35m[0m
[30;1m712 | [0m[35m    def _set_childs_state(self, player_id: str) -> None:[0m
[30;1m713 | [0m[35m        """Set the state of the child`s of the player."""[0m
[30;1m714 | [0m[35m        mass_player = self.mass.players.get(player_id)[0m
[30;1m715 | [0m[35m        for child_player_id in mass_player.group_childs:[0m
[30;1m716 | [0m[35m            if child_player_id == player_id:[0m
[30;1m717 | [0m[35m                continue[0m

[31m--[ [0m[34mMatch #[0m[33m1649[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m667 | [0m[35m[0m
[30;1m668 | [0m[35m    async def _get_or_create_stream(self, player_id: str, queue_id: str) -> Snapstream:[0m
[30;1m669 | [0m[35m        """Create new stream on snapcast server (or return existing one)."""[0m
[30;1m670 | [0m[35m        mass_queue = self.mass.player_queues.get(queue_id)[0m
[30;1m671 | [0m[35m        safe_name = create_safe_string(mass_queue.display_name, replace_space=True)[0m
[30;1m672 | [0m[35m        stream_name = f"{MASS_STREAM_POSTFIX} - {safe_name}"[0m
[30;1m673 | [0m[35m        # cancel any existing clear stream task[0m

[31m--[ [0m[34mMatch #[0m[33m1650[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m652 | [0m[35m[0m
[30;1m653 | [0m[35m    def _group_childs(self, player_id: str) -> set[str]:[0m
[30;1m654 | [0m[35m        """Return player_ids of the players synced to this player."""[0m
[30;1m655 | [0m[35m        mass_player = self.mass.players.get(player_id, raise_unavailable=False)[0m
[30;1m656 | [0m[35m        snap_group = self._get_snapgroup(player_id)[0m
[30;1m657 | [0m[35m        mass_player.group_childs.clear()[0m
[30;1m658 | [0m[35m        if mass_player.synced_to is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m1651[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m567 | [0m[35m            # regular queue (flow) stream request[0m
[30;1m568 | [0m[35m            input_format = DEFAULT_SNAPCAST_PCM_FORMAT[0m
[30;1m569 | [0m[35m            audio_source = self.mass.streams.get_queue_flow_stream([0m
[30;1m570 | [0m[35m                queue=self.mass.player_queues.get(media.queue_id),[0m
[30;1m571 | [0m[35m                start_queue_item=self.mass.player_queues.get_item([0m
[30;1m572 | [0m[35m                    media.queue_id, media.queue_item_id[0m
[30;1m573 | [0m[35m                ),[0m

[31m--[ [0m[34mMatch #[0m[33m1652[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m520 | [0m[35m[0m
[30;1m521 | [0m[35m    async def play_media(self, player_id: str, media: PlayerMedia) -> None:  # noqa: PLR0915[0m
[30;1m522 | [0m[35m        """Handle PLAY MEDIA on given player."""[0m
[30;1m523 | [0m[35m        player = self.mass.players.get(player_id)[0m
[30;1m524 | [0m[35m        if player.synced_to:[0m
[30;1m525 | [0m[35m            msg = "A synced player cannot receive play commands directly"[0m
[30;1m526 | [0m[35m            raise RuntimeError(msg)[0m

[31m--[ [0m[34mMatch #[0m[33m1653[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m505 | [0m[35m                if mass_child_id != player_id:[0m
[30;1m506 | [0m[35m                    await self.cmd_ungroup(mass_child_id)[0m
[30;1m507 | [0m[35m            return[0m
[30;1m508 | [0m[35m        mass_sync_master_player = self.mass.players.get(mass_player.synced_to)[0m
[30;1m509 | [0m[35m        mass_sync_master_player.group_childs.remove(player_id)[0m
[30;1m510 | [0m[35m        mass_player.synced_to = None[0m
[30;1m511 | [0m[35m        snap_client_id = self._get_snapclient_id(player_id)[0m

[31m--[ [0m[34mMatch #[0m[33m1654[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m499 | [0m[35m[0m
[30;1m500 | [0m[35m    async def cmd_ungroup(self, player_id: str) -> None:[0m
[30;1m501 | [0m[35m        """Ungroup Snapcast player."""[0m
[30;1m502 | [0m[35m        mass_player = self.mass.players.get(player_id)[0m
[30;1m503 | [0m[35m        if mass_player.synced_to is None:[0m
[30;1m504 | [0m[35m            for mass_child_id in list(mass_player.group_childs):[0m
[30;1m505 | [0m[35m                if mass_child_id != player_id:[0m

[31m--[ [0m[34mMatch #[0m[33m1655[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m491 | [0m[35m        mass_target_player = self.mass.players.get(target_player)[0m
[30;1m492 | [0m[35m        if self._get_snapclient_id(player_id) not in group.clients:[0m
[30;1m493 | [0m[35m            await group.add_client(self._get_snapclient_id(player_id))[0m
[30;1m494 | [0m[35m            mass_player = self.mass.players.get(player_id)[0m
[30;1m495 | [0m[35m            mass_player.synced_to = target_player[0m
[30;1m496 | [0m[35m            mass_target_player.group_childs.append(player_id)[0m
[30;1m497 | [0m[35m            self.mass.players.update(player_id)[0m

[31m--[ [0m[34mMatch #[0m[33m1656[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m488 | [0m[35m    async def cmd_group(self, player_id: str, target_player: str) -> None:[0m
[30;1m489 | [0m[35m        """Sync Snapcast player."""[0m
[30;1m490 | [0m[35m        group = self._get_snapgroup(target_player)[0m
[30;1m491 | [0m[35m        mass_target_player = self.mass.players.get(target_player)[0m
[30;1m492 | [0m[35m        if self._get_snapclient_id(player_id) not in group.clients:[0m
[30;1m493 | [0m[35m            await group.add_client(self._get_snapclient_id(player_id))[0m
[30;1m494 | [0m[35m            mass_player = self.mass.players.get(player_id)[0m

[31m--[ [0m[34mMatch #[0m[33m1657[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m477 | [0m[35m[0m
[30;1m478 | [0m[35m    async def cmd_volume_mute(self, player_id: str, muted: bool) -> None:[0m
[30;1m479 | [0m[35m        """Send MUTE command to given player."""[0m
[30;1m480 | [0m[35m        ma_player = self.mass.players.get(player_id, raise_unavailable=False)[0m
[30;1m481 | [0m[35m        snap_client_id = self._get_snapclient_id(player_id)[0m
[30;1m482 | [0m[35m        snapclient = self._snapserver.client(snap_client_id)[0m
[30;1m483 | [0m[35m        # Using optimistic value because the library does not return the response from the api[0m

[31m--[ [0m[34mMatch #[0m[33m1658[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m459 | [0m[35m[0m
[30;1m460 | [0m[35m    async def cmd_stop(self, player_id: str) -> None:[0m
[30;1m461 | [0m[35m        """Send STOP command to given player."""[0m
[30;1m462 | [0m[35m        player = self.mass.players.get(player_id, raise_unavailable=False)[0m
[30;1m463 | [0m[35m[0m
[30;1m464 | [0m[35m        await self._get_snapgroup(player_id).set_stream("default")[0m
[30;1m465 | [0m[35m        await self._delete_current_snapstream(self._get_snapstream(player_id))[0m

[31m--[ [0m[34mMatch #[0m[33m1659[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m415 | [0m[35m    def _handle_player_update(self, snap_client: Snapclient) -> None:[0m
[30;1m416 | [0m[35m        """Process Snapcast update to Player controller."""[0m
[30;1m417 | [0m[35m        player_id = self._get_ma_id(snap_client.identifier)[0m
[30;1m418 | [0m[35m        player = self.mass.players.get(player_id)[0m
[30;1m419 | [0m[35m        if not player:[0m
[30;1m420 | [0m[35m            return[0m
[30;1m421 | [0m[35m        player.name = snap_client.friendly_name[0m

[31m--[ [0m[34mMatch #[0m[33m1660[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m398 | [0m[35m                device_info=DeviceInfo([0m
[30;1m399 | [0m[35m                    model=snap_client._client.get("host").get("os"),[0m
[30;1m400 | [0m[35m                    ip_address=snap_client._client.get("host").get("ip"),[0m
[30;1m401 | [0m[35m                    manufacturer=snap_client._client.get("host").get("arch"),[0m
[30;1m402 | [0m[35m                ),[0m
[30;1m403 | [0m[35m                supported_features={[0m
[30;1m404 | [0m[35m                    PlayerFeature.SET_MEMBERS,[0m

[31m--[ [0m[34mMatch #[0m[33m1661[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m398 | [0m[35m                device_info=DeviceInfo([0m
[30;1m399 | [0m[35m                    model=snap_client._client.get("host").get("os"),[0m
[30;1m400 | [0m[35m                    ip_address=snap_client._client.get("host").get("ip"),[0m
[30;1m401 | [0m[35m                    manufacturer=snap_client._client.get("host").get("arch"),[0m
[30;1m402 | [0m[35m                ),[0m
[30;1m403 | [0m[35m                supported_features={[0m
[30;1m404 | [0m[35m                    PlayerFeature.SET_MEMBERS,[0m

[31m--[ [0m[34mMatch #[0m[33m1662[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m397 | [0m[35m                available=snap_client.connected,[0m
[30;1m398 | [0m[35m                device_info=DeviceInfo([0m
[30;1m399 | [0m[35m                    model=snap_client._client.get("host").get("os"),[0m
[30;1m400 | [0m[35m                    ip_address=snap_client._client.get("host").get("ip"),[0m
[30;1m401 | [0m[35m                    manufacturer=snap_client._client.get("host").get("arch"),[0m
[30;1m402 | [0m[35m                ),[0m
[30;1m403 | [0m[35m                supported_features={[0m

[31m--[ [0m[34mMatch #[0m[33m1663[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m397 | [0m[35m                available=snap_client.connected,[0m
[30;1m398 | [0m[35m                device_info=DeviceInfo([0m
[30;1m399 | [0m[35m                    model=snap_client._client.get("host").get("os"),[0m
[30;1m400 | [0m[35m                    ip_address=snap_client._client.get("host").get("ip"),[0m
[30;1m401 | [0m[35m                    manufacturer=snap_client._client.get("host").get("arch"),[0m
[30;1m402 | [0m[35m                ),[0m
[30;1m403 | [0m[35m                supported_features={[0m

[31m--[ [0m[34mMatch #[0m[33m1664[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m396 | [0m[35m                name=snap_client.friendly_name,[0m
[30;1m397 | [0m[35m                available=snap_client.connected,[0m
[30;1m398 | [0m[35m                device_info=DeviceInfo([0m
[30;1m399 | [0m[35m                    model=snap_client._client.get("host").get("os"),[0m
[30;1m400 | [0m[35m                    ip_address=snap_client._client.get("host").get("ip"),[0m
[30;1m401 | [0m[35m                    manufacturer=snap_client._client.get("host").get("arch"),[0m
[30;1m402 | [0m[35m                ),[0m

[31m--[ [0m[34mMatch #[0m[33m1665[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m396 | [0m[35m                name=snap_client.friendly_name,[0m
[30;1m397 | [0m[35m                available=snap_client.connected,[0m
[30;1m398 | [0m[35m                device_info=DeviceInfo([0m
[30;1m399 | [0m[35m                    model=snap_client._client.get("host").get("os"),[0m
[30;1m400 | [0m[35m                    ip_address=snap_client._client.get("host").get("ip"),[0m
[30;1m401 | [0m[35m                    manufacturer=snap_client._client.get("host").get("arch"),[0m
[30;1m402 | [0m[35m                ),[0m

[31m--[ [0m[34mMatch #[0m[33m1666[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m384 | [0m[35m    def _handle_player_init(self, snap_client: Snapclient) -> None:[0m
[30;1m385 | [0m[35m        """Process Snapcast add to Player controller."""[0m
[30;1m386 | [0m[35m        player_id = self._generate_and_register_id(snap_client.identifier)[0m
[30;1m387 | [0m[35m        player = self.mass.players.get(player_id, raise_unavailable=False)[0m
[30;1m388 | [0m[35m        if not player:[0m
[30;1m389 | [0m[35m            snap_client = cast([0m
[30;1m390 | [0m[35m                "Snapclient", self._snapserver.client(self._get_snapclient_id(player_id))[0m

[31m--[ [0m[34mMatch #[0m[33m1667[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m353 | [0m[35m        self._stop_called = True[0m
[30;1m354 | [0m[35m        for snap_client_id in self._snapserver.clients:[0m
[30;1m355 | [0m[35m            player_id = self._get_ma_id(snap_client_id)[0m
[30;1m356 | [0m[35m            if not (player := self.mass.players.get(player_id, raise_unavailable=False)):[0m
[30;1m357 | [0m[35m                continue[0m
[30;1m358 | [0m[35m            if player.state != PlayerState.PLAYING:[0m
[30;1m359 | [0m[35m                continue[0m

[31m--[ [0m[34mMatch #[0m[33m1668[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m277 | [0m[35m[0m
[30;1m278 | [0m[35m    def _get_ma_id(self, snap_client_id: str) -> str:[0m
[30;1m279 | [0m[35m        search_dict = self._ids_map.inverse[0m
[30;1m280 | [0m[35m        return search_dict.get(snap_client_id)[0m
[30;1m281 | [0m[35m[0m
[30;1m282 | [0m[35m    def _generate_and_register_id(self, snap_client_id) -> str:[0m
[30;1m283 | [0m[35m        search_dict = self._ids_map.inverse[0m

[31m--[ [0m[34mMatch #[0m[33m1669[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m273 | [0m[35m[0m
[30;1m274 | [0m[35m    def _get_snapclient_id(self, player_id: str) -> str:[0m
[30;1m275 | [0m[35m        search_dict = self._ids_map[0m
[30;1m276 | [0m[35m        return search_dict.get(player_id)[0m
[30;1m277 | [0m[35m[0m
[30;1m278 | [0m[35m    def _get_ma_id(self, snap_client_id: str) -> str:[0m
[30;1m279 | [0m[35m        search_dict = self._ids_map.inverse[0m

[31m--[ [0m[34mMatch #[0m[33m1670[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m696 | [0m[35m            port = random.randint(4953, 4953 + 200)[0m
[30;1m697 | [0m[35m            result = await self._snapserver.stream_add_stream([0m
[30;1m698 | [0m[35m                # NOTE: setting the sampleformat to something else[0m
[30;1m699 | [0m[35m                # (like 24 bits bit depth) does not seem to work at all![0m
[30;1m700 | [0m[35m                f"tcp://0.0.0.0:{port}?sampleformat=48000:16:2"[0m
[30;1m701 | [0m[35m                f"&idle_threshold={self._snapcast_stream_idle_threshold}"[0m
[30;1m702 | [0m[35m                f"{extra_args}&name={stream_name}"[0m

[31m--[ [0m[34mMatch #[0m[33m1671[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m514 | [0m[35m        # assign default/empty stream to the player[0m
[30;1m515 | [0m[35m        await self._get_snapgroup(player_id).set_stream("default")[0m
[30;1m516 | [0m[35m        await self.cmd_stop(player_id=player_id)[0m
[30;1m517 | [0m[35m        # make sure that the player manager gets an update[0m
[30;1m518 | [0m[35m        self.mass.players.update(player_id, skip_forward=True)[0m
[30;1m519 | [0m[35m        self.mass.players.update(mass_player.synced_to, skip_forward=True)[0m
[30;1m520 | [0m[35m[0m
[30;1m521 | [0m[35m    async def play_media(self, player_id: str, media: PlayerMedia) -> None:  # noqa: PLR0915[0m

[31m--[ [0m[34mMatch #[0m[33m1672[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m413 | [0m[35m        )[0m
[30;1m414 | [0m[35m[0m
[30;1m415 | [0m[35m    def _handle_player_update(self, snap_client: Snapclient) -> None:[0m
[30;1m416 | [0m[35m        """Process Snapcast update to Player controller."""[0m
[30;1m417 | [0m[35m        player_id = self._get_ma_id(snap_client.identifier)[0m
[30;1m418 | [0m[35m        player = self.mass.players.get(player_id)[0m
[30;1m419 | [0m[35m        if not player:[0m

[31m--[ [0m[34mMatch #[0m[33m1673[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m240 | [0m[35m            key=CONF_SERVER_CONTROL_PORT,[0m
[30;1m241 | [0m[35m            type=ConfigEntryType.INTEGER,[0m
[30;1m242 | [0m[35m            default_value=DEFAULT_SNAPSERVER_PORT,[0m
[30;1m243 | [0m[35m            label="Snapcast control port",[0m
[30;1m244 | [0m[35m            required=False,[0m
[30;1m245 | [0m[35m            depends_on=CONF_USE_EXTERNAL_SERVER,[0m
[30;1m246 | [0m[35m            category=([0m

[31m--[ [0m[34mMatch #[0m[33m1674[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35mimport random[0m
[30;1m9 | [0m[35mimport re[0m
[30;1m10 | [0m[35mimport socket[0m
[30;1m11 | [0m[35mimport time[0m
[30;1m12 | [0m[35mimport urllib.parse[0m
[30;1m13 | [0m[35mfrom contextlib import suppress[0m
[30;1m14 | [0m[35mfrom typing import TYPE_CHECKING, cast[0m
[30;1m15 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1675[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m619 | [0m[35m        return podcastparser.parse(feed_url, feed_stream, max_episodes=self.max_episodes)  # type: i[0m
[30;1m620 | [0m[35m[0m
[30;1m621 | [0m[35m    async def _cache_get_podcast(self, prov_podcast_id: str) -> dict[str, Any]:[0m
[30;1m622 | [0m[35m        parsed_podcast = await self.mass.cache.get([0m
[30;1m623 | [0m[35m            key=prov_podcast_id,[0m
[30;1m624 | [0m[35m            base_key=self.lookup_key,[0m
[30;1m625 | [0m[35m            category=CACHE_CATEGORY_PODCAST_ITEMS,[0m

[31m--[ [0m[34mMatch #[0m[33m1676[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m611 | [0m[35m[0m
[30;1m612 | [0m[35m    async def _get_podcast(self, feed_url: str) -> dict[str, Any]:[0m
[30;1m613 | [0m[35m        # see music-assistant/server@6aae82e[0m
[30;1m614 | [0m[35m        response = await self.mass.http_session.get(feed_url, headers={"User-Agent": "Mozilla/5.0"})[0m
[30;1m615 | [0m[35m        if response.status != 200:[0m
[30;1m616 | [0m[35m            raise RuntimeError[0m
[30;1m617 | [0m[35m        feed_data = await response.read()[0m

[31m--[ [0m[34mMatch #[0m[33m1677[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m605 | [0m[35m            if len(episode_enclosures) < 1:[0m
[30;1m606 | [0m[35m                raise MediaNotFoundError[0m
[30;1m607 | [0m[35m            stream_url: str | None = episode_enclosures[0].get("url", None)[0m
[30;1m608 | [0m[35m            if guid_or_stream_url == episode.get("guid", stream_url):[0m
[30;1m609 | [0m[35m                return stream_url[0m
[30;1m610 | [0m[35m        return None[0m
[30;1m611 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1678[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m604 | [0m[35m            episode_enclosures = episode.get("enclosures", [])[0m
[30;1m605 | [0m[35m            if len(episode_enclosures) < 1:[0m
[30;1m606 | [0m[35m                raise MediaNotFoundError[0m
[30;1m607 | [0m[35m            stream_url: str | None = episode_enclosures[0].get("url", None)[0m
[30;1m608 | [0m[35m            if guid_or_stream_url == episode.get("guid", stream_url):[0m
[30;1m609 | [0m[35m                return stream_url[0m
[30;1m610 | [0m[35m        return None[0m

[31m--[ [0m[34mMatch #[0m[33m1679[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m601 | [0m[35m        podcast = await self._cache_get_podcast(podcast_id)[0m
[30;1m602 | [0m[35m        episodes = podcast.get("episodes", [])[0m
[30;1m603 | [0m[35m        for cnt, episode in enumerate(episodes):[0m
[30;1m604 | [0m[35m            episode_enclosures = episode.get("enclosures", [])[0m
[30;1m605 | [0m[35m            if len(episode_enclosures) < 1:[0m
[30;1m606 | [0m[35m                raise MediaNotFoundError[0m
[30;1m607 | [0m[35m            stream_url: str | None = episode_enclosures[0].get("url", None)[0m

[31m--[ [0m[34mMatch #[0m[33m1680[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m599 | [0m[35m[0m
[30;1m600 | [0m[35m    async def _get_episode_stream_url(self, podcast_id: str, guid_or_stream_url: str) -> str | None:[0m
[30;1m601 | [0m[35m        podcast = await self._cache_get_podcast(podcast_id)[0m
[30;1m602 | [0m[35m        episodes = podcast.get("episodes", [])[0m
[30;1m603 | [0m[35m        for cnt, episode in enumerate(episodes):[0m
[30;1m604 | [0m[35m            episode_enclosures = episode.get("enclosures", [])[0m
[30;1m605 | [0m[35m            if len(episode_enclosures) < 1:[0m

[31m--[ [0m[34mMatch #[0m[33m1681[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m450 | [0m[35m[0m
[30;1m451 | [0m[35m        podcast = await self._cache_get_podcast(prov_podcast_id)[0m
[30;1m452 | [0m[35m        podcast_cover = podcast.get("cover_url")[0m
[30;1m453 | [0m[35m        parsed_episodes = podcast.get("episodes", [])[0m
[30;1m454 | [0m[35m[0m
[30;1m455 | [0m[35m        if timestamp is not None:[0m
[30;1m456 | [0m[35m            self.timestamp_actions = timestamp[0m

[31m--[ [0m[34mMatch #[0m[33m1682[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m449 | [0m[35m            episode_actions, timestamp = [], None[0m
[30;1m450 | [0m[35m[0m
[30;1m451 | [0m[35m        podcast = await self._cache_get_podcast(prov_podcast_id)[0m
[30;1m452 | [0m[35m        podcast_cover = podcast.get("cover_url")[0m
[30;1m453 | [0m[35m        parsed_episodes = podcast.get("episodes", [])[0m
[30;1m454 | [0m[35m[0m
[30;1m455 | [0m[35m        if timestamp is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m1683[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m321 | [0m[35m            self.timestamp_actions,[0m
[30;1m322 | [0m[35m        )[0m
[30;1m323 | [0m[35m[0m
[30;1m324 | [0m[35m        feeds = await self.mass.cache.get([0m
[30;1m325 | [0m[35m            key=CACHE_KEY_FEEDS,[0m
[30;1m326 | [0m[35m            base_key=self.lookup_key,[0m
[30;1m327 | [0m[35m            category=CACHE_CATEGORY_OTHER,[0m

[31m--[ [0m[34mMatch #[0m[33m1684[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m303 | [0m[35m            except RuntimeError as exc:[0m
[30;1m304 | [0m[35m                raise LoginFailed("Login failed.") from exc[0m
[30;1m305 | [0m[35m[0m
[30;1m306 | [0m[35m        timestamps = await self.mass.cache.get([0m
[30;1m307 | [0m[35m            key=CACHE_KEY_TIMESTAMP,[0m
[30;1m308 | [0m[35m            base_key=self.lookup_key,[0m
[30;1m309 | [0m[35m            category=CACHE_CATEGORY_OTHER,[0m

[31m--[ [0m[34mMatch #[0m[33m1685[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m254 | [0m[35m            label="using_gpodder",[0m
[30;1m255 | [0m[35m            hidden=True,[0m
[30;1m256 | [0m[35m            required=False,[0m
[30;1m257 | [0m[35m            value=values.get(CONF_USING_GPODDER),[0m
[30;1m258 | [0m[35m        ),[0m
[30;1m259 | [0m[35m    )[0m
[30;1m260 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1686[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m246 | [0m[35m            label="token",[0m
[30;1m247 | [0m[35m            hidden=True,[0m
[30;1m248 | [0m[35m            required=False,[0m
[30;1m249 | [0m[35m            value=values.get(CONF_TOKEN_NC),[0m
[30;1m250 | [0m[35m        ),[0m
[30;1m251 | [0m[35m        ConfigEntry([0m
[30;1m252 | [0m[35m            key=CONF_USING_GPODDER,[0m

[31m--[ [0m[34mMatch #[0m[33m1687[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m238 | [0m[35m            description="Whether or not to verify the certificate of SSL/TLS connections.",[0m
[30;1m239 | [0m[35m            category="advanced",[0m
[30;1m240 | [0m[35m            default_value=True,[0m
[30;1m241 | [0m[35m            value=values.get(CONF_VERIFY_SSL),[0m
[30;1m242 | [0m[35m        ),[0m
[30;1m243 | [0m[35m        ConfigEntry([0m
[30;1m244 | [0m[35m            key=CONF_TOKEN_NC,[0m

[31m--[ [0m[34mMatch #[0m[33m1688[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m228 | [0m[35m            required=False,[0m
[30;1m229 | [0m[35m            description="Maximum amount of episodes to sync per feed. Use 0 for unlimited",[0m
[30;1m230 | [0m[35m            default_value=0,[0m
[30;1m231 | [0m[35m            value=values.get(CONF_MAX_NUM_EPISODES),[0m
[30;1m232 | [0m[35m        ),[0m
[30;1m233 | [0m[35m        ConfigEntry([0m
[30;1m234 | [0m[35m            key=CONF_VERIFY_SSL,[0m

[31m--[ [0m[34mMatch #[0m[33m1689[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m204 | [0m[35m            label="Nextcloud URL",[0m
[30;1m205 | [0m[35m            required=False,[0m
[30;1m206 | [0m[35m            description="URL of Nextcloud instance.",[0m
[30;1m207 | [0m[35m            value=values.get(CONF_URL_NC),[0m
[30;1m208 | [0m[35m            hidden=using_gpodder,[0m
[30;1m209 | [0m[35m        ),[0m
[30;1m210 | [0m[35m        ConfigEntry([0m

[31m--[ [0m[34mMatch #[0m[33m1690[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m190 | [0m[35m            required=False,[0m
[30;1m191 | [0m[35m            description="Device ID of user.",[0m
[30;1m192 | [0m[35m            hidden=authenticated_nc,[0m
[30;1m193 | [0m[35m            value=values.get(CONF_DEVICE_ID),[0m
[30;1m194 | [0m[35m        ),[0m
[30;1m195 | [0m[35m        ConfigEntry([0m
[30;1m196 | [0m[35m            key="label_nextcloud",[0m

[31m--[ [0m[34mMatch #[0m[33m1691[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m181 | [0m[35m            required=False,[0m
[30;1m182 | [0m[35m            description="Password for gPodder instance.",[0m
[30;1m183 | [0m[35m            hidden=authenticated_nc,[0m
[30;1m184 | [0m[35m            value=values.get(CONF_PASSWORD),[0m
[30;1m185 | [0m[35m        ),[0m
[30;1m186 | [0m[35m        ConfigEntry([0m
[30;1m187 | [0m[35m            key=CONF_DEVICE_ID,[0m

[31m--[ [0m[34mMatch #[0m[33m1692[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m172 | [0m[35m            required=False,[0m
[30;1m173 | [0m[35m            description="Username of gPodder instance.",[0m
[30;1m174 | [0m[35m            hidden=authenticated_nc,[0m
[30;1m175 | [0m[35m            value=values.get(CONF_USERNAME),[0m
[30;1m176 | [0m[35m        ),[0m
[30;1m177 | [0m[35m        ConfigEntry([0m
[30;1m178 | [0m[35m            key=CONF_PASSWORD,[0m

[31m--[ [0m[34mMatch #[0m[33m1693[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m162 | [0m[35m            label="gPodder Service URL",[0m
[30;1m163 | [0m[35m            required=False,[0m
[30;1m164 | [0m[35m            description="URL of gPodder instance.",[0m
[30;1m165 | [0m[35m            value=values.get(CONF_URL),[0m
[30;1m166 | [0m[35m            hidden=authenticated_nc,[0m
[30;1m167 | [0m[35m        ),[0m
[30;1m168 | [0m[35m        ConfigEntry([0m

[31m--[ [0m[34mMatch #[0m[33m1694[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m141 | [0m[35m    if values.get(CONF_TOKEN_NC, None) is None:[0m
[30;1m142 | [0m[35m        authenticated_nc = False[0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m    using_gpodder = bool(values.get(CONF_USING_GPODDER, False))[0m
[30;1m145 | [0m[35m[0m
[30;1m146 | [0m[35m    return ([0m
[30;1m147 | [0m[35m        ConfigEntry([0m

[31m--[ [0m[34mMatch #[0m[33m1695[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m138 | [0m[35m            await asyncio.sleep(1)[0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35m    authenticated_nc = True[0m
[30;1m141 | [0m[35m    if values.get(CONF_TOKEN_NC, None) is None:[0m
[30;1m142 | [0m[35m        authenticated_nc = False[0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m    using_gpodder = bool(values.get(CONF_USING_GPODDER, False))[0m

[31m--[ [0m[34mMatch #[0m[33m1696[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m128 | [0m[35m        session_id = str(values["session_id"])[0m
[30;1m129 | [0m[35m        mass.signal_event(EventType.AUTH_SESSION, session_id, login_url)[0m
[30;1m130 | [0m[35m        while True:[0m
[30;1m131 | [0m[35m            response = await session.post(poll_endpoint, data={"token": poll_token})[0m
[30;1m132 | [0m[35m            if response.status not in [200, 404]:[0m
[30;1m133 | [0m[35m                raise LoginFailed("The specified url seems not to belong to a nextcloud instance.")[0m
[30;1m134 | [0m[35m            if response.status == 200:[0m

[31m--[ [0m[34mMatch #[0m[33m1697[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m    if action == CONF_ACTION_AUTH_NC:[0m
[30;1m119 | [0m[35m        session = mass.http_session[0m
[30;1m120 | [0m[35m        response = await session.post([0m
[30;1m121 | [0m[35m            str(values[CONF_URL_NC]).rstrip("/") + "/index.php/login/v2",[0m
[30;1m122 | [0m[35m            headers={"User-Agent": "Music Assistant"},[0m
[30;1m123 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1698[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m576 | [0m[35m            self.logger.debug(f"Updated progress to {position / duration * 100:.2f}%")[0m
[30;1m577 | [0m[35m        except RuntimeError as exc:[0m
[30;1m578 | [0m[35m            self.logger.debug(exc)[0m
[30;1m579 | [0m[35m            self.logger.debug("Failed to update progress.")[0m
[30;1m580 | [0m[35m[0m
[30;1m581 | [0m[35m    async def get_stream_details(self, item_id: str, media_type: MediaType) -> StreamDetails:[0m
[30;1m582 | [0m[35m        """Get streamdetails for item."""[0m

[31m--[ [0m[34mMatch #[0m[33m1699[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m540 | [0m[35m                self.logger.debug("Found an updated external resume position.")[0m
[30;1m541 | [0m[35m                return action.position >= action.total, max(action.position * 1000, 0)[0m
[30;1m542 | [0m[35m        self.logger.debug("Did not find an updated resume position, falling back to stored.")[0m
[30;1m543 | [0m[35m        # If we did not find a resume position, nothing changed since our last timestamp[0m
[30;1m544 | [0m[35m        # we raise NotImplementedError, such that MA falls back to the already stored[0m
[30;1m545 | [0m[35m        # resume_position in its playlog.[0m
[30;1m546 | [0m[35m        raise NotImplementedError[0m

[31m--[ [0m[34mMatch #[0m[33m1700[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m539 | [0m[35m                _progress = (action.position >= action.total, max(action.position * 1000, 0))[0m
[30;1m540 | [0m[35m                self.logger.debug("Found an updated external resume position.")[0m
[30;1m541 | [0m[35m                return action.position >= action.total, max(action.position * 1000, 0)[0m
[30;1m542 | [0m[35m        self.logger.debug("Did not find an updated resume position, falling back to stored.")[0m
[30;1m543 | [0m[35m        # If we did not find a resume position, nothing changed since our last timestamp[0m
[30;1m544 | [0m[35m        # we raise NotImplementedError, such that MA falls back to the already stored[0m
[30;1m545 | [0m[35m        # resume_position in its playlog.[0m

[31m--[ [0m[34mMatch #[0m[33m1701[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m509 | [0m[35m            # this is enough, as internal[0m
[30;1m510 | [0m[35m            if guid_or_stream_url == _guid_or_stream_url:[0m
[30;1m511 | [0m[35m                return mass_episode[0m
[30;1m512 | [0m[35m        raise MediaNotFoundError("Did not find episode.")[0m
[30;1m513 | [0m[35m[0m
[30;1m514 | [0m[35m    async def get_resume_position(self, item_id: str, media_type: MediaType) -> tuple[bool, int]:[0m
[30;1m515 | [0m[35m        """Return: finished, position_ms."""[0m

[31m--[ [0m[34mMatch #[0m[33m1702[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m159 | [0m[35m        ConfigEntry([0m
[30;1m160 | [0m[35m            key=CONF_URL,[0m
[30;1m161 | [0m[35m            type=ConfigEntryType.STRING,[0m
[30;1m162 | [0m[35m            label="gPodder Service URL",[0m
[30;1m163 | [0m[35m            required=False,[0m
[30;1m164 | [0m[35m            description="URL of gPodder instance.",[0m
[30;1m165 | [0m[35m            value=values.get(CONF_URL),[0m

[31m--[ [0m[34mMatch #[0m[33m1703[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14 | [0m[35mfrom __future__ import annotations[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35mimport asyncio[0m
[30;1m17 | [0m[35mimport time[0m
[30;1m18 | [0m[35mfrom collections.abc import AsyncGenerator[0m
[30;1m19 | [0m[35mfrom io import BytesIO[0m
[30;1m20 | [0m[35mfrom typing import TYPE_CHECKING, Any[0m
[30;1m21 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1704[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35m    - it can happen, that we have the guid and use that for identification, but the sync state[0m
[30;1m9 | [0m[35m      provider, eg. opodsync might use only the stream url. So always make sure, to compare both[0m
[30;1m10 | [0m[35m      when relying on an external service[0m
[30;1m11 | [0m[35m    - The service calls have a timestamp (int, unix epoch s), which give the changes since then.[0m
[30;1m12 | [0m[35m"""[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mfrom __future__ import annotations[0m

[31m--[ [0m[34mMatch #[0m[33m1705[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mNote:[0m
[30;1m8 | [0m[35m    - it can happen, that we have the guid and use that for identification, but the sync state[0m
[30;1m9 | [0m[35m      provider, eg. opodsync might use only the stream url. So always make sure, to compare both[0m
[30;1m10 | [0m[35m      when relying on an external service[0m
[30;1m11 | [0m[35m    - The service calls have a timestamp (int, unix epoch s), which give the changes since then.[0m
[30;1m12 | [0m[35m"""[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mfrom __future__ import annotations[0m

[31m--[ [0m[34mMatch #[0m[33m1706[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m525 | [0m[35m[0m
[30;1m526 | [0m[35m    async def sync_play_modes(self, queue_id: str) -> None:[0m
[30;1m527 | [0m[35m        """Sync the play modes between MA and Sonos."""[0m
[30;1m528 | [0m[35m        queue = self.mass.player_queues.get(queue_id)[0m
[30;1m529 | [0m[35m        if not queue or queue.state not in (PlayerState.PLAYING, PlayerState.PAUSED):[0m
[30;1m530 | [0m[35m            return[0m
[30;1m531 | [0m[35m        repeat_single_enabled = queue.repeat_mode == RepeatMode.ONE[0m

[31m--[ [0m[34mMatch #[0m[33m1707[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m501 | [0m[35m            return[0m
[30;1m502 | [0m[35m        if not self.connected:[0m
[30;1m503 | [0m[35m            return[0m
[30;1m504 | [0m[35m        queue = self.mass.player_queues.get(event.object_id)[0m
[30;1m505 | [0m[35m        if not queue or queue.state not in (PlayerState.PLAYING, PlayerState.PAUSED):[0m
[30;1m506 | [0m[35m            return[0m
[30;1m507 | [0m[35m        if session_id := self.client.player.group.active_session_id:[0m

[31m--[ [0m[34mMatch #[0m[33m1708[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m423 | [0m[35m                current_media = PlayerMedia(container["id"]["objectId"])[0m
[30;1m424 | [0m[35m            if not current_media.image_url:[0m
[30;1m425 | [0m[35m                images = container.get("images", [])[0m
[30;1m426 | [0m[35m                current_media.image_url = images[0].get("url") if images else None[0m
[30;1m427 | [0m[35m            if not current_media.title:[0m
[30;1m428 | [0m[35m                current_media.title = container["name"][0m
[30;1m429 | [0m[35m            if not current_media.uri:[0m

[31m--[ [0m[34mMatch #[0m[33m1709[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m422 | [0m[35m            if not current_media:[0m
[30;1m423 | [0m[35m                current_media = PlayerMedia(container["id"]["objectId"])[0m
[30;1m424 | [0m[35m            if not current_media.image_url:[0m
[30;1m425 | [0m[35m                images = container.get("images", [])[0m
[30;1m426 | [0m[35m                current_media.image_url = images[0].get("url") if images else None[0m
[30;1m427 | [0m[35m            if not current_media.title:[0m
[30;1m428 | [0m[35m                current_media.title = container["name"][0m

[31m--[ [0m[34mMatch #[0m[33m1710[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m418 | [0m[35m                image_url=image_url,[0m
[30;1m419 | [0m[35m            )[0m
[30;1m420 | [0m[35m        # generic info from container (also when MA is playing!)[0m
[30;1m421 | [0m[35m        if container and container.get("name") and container.get("id"):[0m
[30;1m422 | [0m[35m            if not current_media:[0m
[30;1m423 | [0m[35m                current_media = PlayerMedia(container["id"]["objectId"])[0m
[30;1m424 | [0m[35m            if not current_media.image_url:[0m

[31m--[ [0m[34mMatch #[0m[33m1711[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m418 | [0m[35m                image_url=image_url,[0m
[30;1m419 | [0m[35m            )[0m
[30;1m420 | [0m[35m        # generic info from container (also when MA is playing!)[0m
[30;1m421 | [0m[35m        if container and container.get("name") and container.get("id"):[0m
[30;1m422 | [0m[35m            if not current_media:[0m
[30;1m423 | [0m[35m                current_media = PlayerMedia(container["id"]["objectId"])[0m
[30;1m424 | [0m[35m            if not current_media.image_url:[0m

[31m--[ [0m[34mMatch #[0m[33m1712[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m412 | [0m[35m            images = container.get("images", [])[0m
[30;1m413 | [0m[35m            image_url = images[0].get("url") if images else None[0m
[30;1m414 | [0m[35m            current_media = PlayerMedia([0m
[30;1m415 | [0m[35m                uri=container.get("id", {}).get("objectId"),[0m
[30;1m416 | [0m[35m                title=active_group.playback_metadata["streamInfo"],[0m
[30;1m417 | [0m[35m                album=container["name"],[0m
[30;1m418 | [0m[35m                image_url=image_url,[0m

[31m--[ [0m[34mMatch #[0m[33m1713[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m412 | [0m[35m            images = container.get("images", [])[0m
[30;1m413 | [0m[35m            image_url = images[0].get("url") if images else None[0m
[30;1m414 | [0m[35m            current_media = PlayerMedia([0m
[30;1m415 | [0m[35m                uri=container.get("id", {}).get("objectId"),[0m
[30;1m416 | [0m[35m                title=active_group.playback_metadata["streamInfo"],[0m
[30;1m417 | [0m[35m                album=container["name"],[0m
[30;1m418 | [0m[35m                image_url=image_url,[0m

[31m--[ [0m[34mMatch #[0m[33m1714[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m410 | [0m[35m        # radio stream info[0m
[30;1m411 | [0m[35m        if container and container.get("name") and active_group.playback_metadata.get("streamInfo"):[0m
[30;1m412 | [0m[35m            images = container.get("images", [])[0m
[30;1m413 | [0m[35m            image_url = images[0].get("url") if images else None[0m
[30;1m414 | [0m[35m            current_media = PlayerMedia([0m
[30;1m415 | [0m[35m                uri=container.get("id", {}).get("objectId"),[0m
[30;1m416 | [0m[35m                title=active_group.playback_metadata["streamInfo"],[0m

[31m--[ [0m[34mMatch #[0m[33m1715[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m409 | [0m[35m                current_media.queue_item_id = current_item["id"][0m
[30;1m410 | [0m[35m        # radio stream info[0m
[30;1m411 | [0m[35m        if container and container.get("name") and active_group.playback_metadata.get("streamInfo"):[0m
[30;1m412 | [0m[35m            images = container.get("images", [])[0m
[30;1m413 | [0m[35m            image_url = images[0].get("url") if images else None[0m
[30;1m414 | [0m[35m            current_media = PlayerMedia([0m
[30;1m415 | [0m[35m                uri=container.get("id", {}).get("objectId"),[0m

[31m--[ [0m[34mMatch #[0m[33m1716[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m408 | [0m[35m                current_media.queue_id = self.mass_player.active_source[0m
[30;1m409 | [0m[35m                current_media.queue_item_id = current_item["id"][0m
[30;1m410 | [0m[35m        # radio stream info[0m
[30;1m411 | [0m[35m        if container and container.get("name") and active_group.playback_metadata.get("streamInfo"):[0m
[30;1m412 | [0m[35m            images = container.get("images", [])[0m
[30;1m413 | [0m[35m            image_url = images[0].get("url") if images else None[0m
[30;1m414 | [0m[35m            current_media = PlayerMedia([0m

[31m--[ [0m[34mMatch #[0m[33m1717[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m408 | [0m[35m                current_media.queue_id = self.mass_player.active_source[0m
[30;1m409 | [0m[35m                current_media.queue_item_id = current_item["id"][0m
[30;1m410 | [0m[35m        # radio stream info[0m
[30;1m411 | [0m[35m        if container and container.get("name") and active_group.playback_metadata.get("streamInfo"):[0m
[30;1m412 | [0m[35m            images = container.get("images", [])[0m
[30;1m413 | [0m[35m            image_url = images[0].get("url") if images else None[0m
[30;1m414 | [0m[35m            current_media = PlayerMedia([0m

[31m--[ [0m[34mMatch #[0m[33m1718[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m400 | [0m[35m                uri=track.get("id", {}).get("objectId") or track.get("mediaUrl"),[0m
[30;1m401 | [0m[35m                title=track["name"],[0m
[30;1m402 | [0m[35m                artist=track.get("artist", {}).get("name"),[0m
[30;1m403 | [0m[35m                album=track.get("album", {}).get("name"),[0m
[30;1m404 | [0m[35m                duration=track_duration_millis / 1000 if track_duration_millis else None,[0m
[30;1m405 | [0m[35m                image_url=track_image_url,[0m
[30;1m406 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m1719[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m400 | [0m[35m                uri=track.get("id", {}).get("objectId") or track.get("mediaUrl"),[0m
[30;1m401 | [0m[35m                title=track["name"],[0m
[30;1m402 | [0m[35m                artist=track.get("artist", {}).get("name"),[0m
[30;1m403 | [0m[35m                album=track.get("album", {}).get("name"),[0m
[30;1m404 | [0m[35m                duration=track_duration_millis / 1000 if track_duration_millis else None,[0m
[30;1m405 | [0m[35m                image_url=track_image_url,[0m
[30;1m406 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m1720[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m399 | [0m[35m            current_media = PlayerMedia([0m
[30;1m400 | [0m[35m                uri=track.get("id", {}).get("objectId") or track.get("mediaUrl"),[0m
[30;1m401 | [0m[35m                title=track["name"],[0m
[30;1m402 | [0m[35m                artist=track.get("artist", {}).get("name"),[0m
[30;1m403 | [0m[35m                album=track.get("album", {}).get("name"),[0m
[30;1m404 | [0m[35m                duration=track_duration_millis / 1000 if track_duration_millis else None,[0m
[30;1m405 | [0m[35m                image_url=track_image_url,[0m

[31m--[ [0m[34mMatch #[0m[33m1721[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m399 | [0m[35m            current_media = PlayerMedia([0m
[30;1m400 | [0m[35m                uri=track.get("id", {}).get("objectId") or track.get("mediaUrl"),[0m
[30;1m401 | [0m[35m                title=track["name"],[0m
[30;1m402 | [0m[35m                artist=track.get("artist", {}).get("name"),[0m
[30;1m403 | [0m[35m                album=track.get("album", {}).get("name"),[0m
[30;1m404 | [0m[35m                duration=track_duration_millis / 1000 if track_duration_millis else None,[0m
[30;1m405 | [0m[35m                image_url=track_image_url,[0m

[31m--[ [0m[34mMatch #[0m[33m1722[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m397 | [0m[35m            track_image_url = track_images[0].get("url") if track_images else None[0m
[30;1m398 | [0m[35m            track_duration_millis = track.get("durationMillis")[0m
[30;1m399 | [0m[35m            current_media = PlayerMedia([0m
[30;1m400 | [0m[35m                uri=track.get("id", {}).get("objectId") or track.get("mediaUrl"),[0m
[30;1m401 | [0m[35m                title=track["name"],[0m
[30;1m402 | [0m[35m                artist=track.get("artist", {}).get("name"),[0m
[30;1m403 | [0m[35m                album=track.get("album", {}).get("name"),[0m

[31m--[ [0m[34mMatch #[0m[33m1723[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m397 | [0m[35m            track_image_url = track_images[0].get("url") if track_images else None[0m
[30;1m398 | [0m[35m            track_duration_millis = track.get("durationMillis")[0m
[30;1m399 | [0m[35m            current_media = PlayerMedia([0m
[30;1m400 | [0m[35m                uri=track.get("id", {}).get("objectId") or track.get("mediaUrl"),[0m
[30;1m401 | [0m[35m                title=track["name"],[0m
[30;1m402 | [0m[35m                artist=track.get("artist", {}).get("name"),[0m
[30;1m403 | [0m[35m                album=track.get("album", {}).get("name"),[0m

[31m--[ [0m[34mMatch #[0m[33m1724[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m397 | [0m[35m            track_image_url = track_images[0].get("url") if track_images else None[0m
[30;1m398 | [0m[35m            track_duration_millis = track.get("durationMillis")[0m
[30;1m399 | [0m[35m            current_media = PlayerMedia([0m
[30;1m400 | [0m[35m                uri=track.get("id", {}).get("objectId") or track.get("mediaUrl"),[0m
[30;1m401 | [0m[35m                title=track["name"],[0m
[30;1m402 | [0m[35m                artist=track.get("artist", {}).get("name"),[0m
[30;1m403 | [0m[35m                album=track.get("album", {}).get("name"),[0m

[31m--[ [0m[34mMatch #[0m[33m1725[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m395 | [0m[35m        ):[0m
[30;1m396 | [0m[35m            track_images = track.get("images", [])[0m
[30;1m397 | [0m[35m            track_image_url = track_images[0].get("url") if track_images else None[0m
[30;1m398 | [0m[35m            track_duration_millis = track.get("durationMillis")[0m
[30;1m399 | [0m[35m            current_media = PlayerMedia([0m
[30;1m400 | [0m[35m                uri=track.get("id", {}).get("objectId") or track.get("mediaUrl"),[0m
[30;1m401 | [0m[35m                title=track["name"],[0m

[31m--[ [0m[34mMatch #[0m[33m1726[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m394 | [0m[35m            (track := current_item.get("track")) and track.get("name")[0m
[30;1m395 | [0m[35m        ):[0m
[30;1m396 | [0m[35m            track_images = track.get("images", [])[0m
[30;1m397 | [0m[35m            track_image_url = track_images[0].get("url") if track_images else None[0m
[30;1m398 | [0m[35m            track_duration_millis = track.get("durationMillis")[0m
[30;1m399 | [0m[35m            current_media = PlayerMedia([0m
[30;1m400 | [0m[35m                uri=track.get("id", {}).get("objectId") or track.get("mediaUrl"),[0m

[31m--[ [0m[34mMatch #[0m[33m1727[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m393 | [0m[35m        if (current_item := active_group.playback_metadata.get("currentItem")) and ([0m
[30;1m394 | [0m[35m            (track := current_item.get("track")) and track.get("name")[0m
[30;1m395 | [0m[35m        ):[0m
[30;1m396 | [0m[35m            track_images = track.get("images", [])[0m
[30;1m397 | [0m[35m            track_image_url = track_images[0].get("url") if track_images else None[0m
[30;1m398 | [0m[35m            track_duration_millis = track.get("durationMillis")[0m
[30;1m399 | [0m[35m            current_media = PlayerMedia([0m

[31m--[ [0m[34mMatch #[0m[33m1728[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m391 | [0m[35m        self.mass_player.elapsed_time_last_updated = time.time()[0m
[30;1m392 | [0m[35m        current_media = None[0m
[30;1m393 | [0m[35m        if (current_item := active_group.playback_metadata.get("currentItem")) and ([0m
[30;1m394 | [0m[35m            (track := current_item.get("track")) and track.get("name")[0m
[30;1m395 | [0m[35m        ):[0m
[30;1m396 | [0m[35m            track_images = track.get("images", [])[0m
[30;1m397 | [0m[35m            track_image_url = track_images[0].get("url") if track_images else None[0m

[31m--[ [0m[34mMatch #[0m[33m1729[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m391 | [0m[35m        self.mass_player.elapsed_time_last_updated = time.time()[0m
[30;1m392 | [0m[35m        current_media = None[0m
[30;1m393 | [0m[35m        if (current_item := active_group.playback_metadata.get("currentItem")) and ([0m
[30;1m394 | [0m[35m            (track := current_item.get("track")) and track.get("name")[0m
[30;1m395 | [0m[35m        ):[0m
[30;1m396 | [0m[35m            track_images = track.get("images", [])[0m
[30;1m397 | [0m[35m            track_image_url = track_images[0].get("url") if track_images else None[0m

[31m--[ [0m[34mMatch #[0m[33m1730[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m390 | [0m[35m        self.mass_player.elapsed_time = self.client.player.group.position[0m
[30;1m391 | [0m[35m        self.mass_player.elapsed_time_last_updated = time.time()[0m
[30;1m392 | [0m[35m        current_media = None[0m
[30;1m393 | [0m[35m        if (current_item := active_group.playback_metadata.get("currentItem")) and ([0m
[30;1m394 | [0m[35m            (track := current_item.get("track")) and track.get("name")[0m
[30;1m395 | [0m[35m        ):[0m
[30;1m396 | [0m[35m            track_images = track.get("images", [])[0m

[31m--[ [0m[34mMatch #[0m[33m1731[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m376 | [0m[35m        # its playing some service we did not yet map[0m
[30;1m377 | [0m[35m        elif container and container.get("service", {}).get("name"):[0m
[30;1m378 | [0m[35m            self.mass_player.active_source = container["service"]["name"][0m
[30;1m379 | [0m[35m        elif container and container.get("name"):[0m
[30;1m380 | [0m[35m            self.mass_player.active_source = container["name"][0m
[30;1m381 | [0m[35m        elif active_service:[0m
[30;1m382 | [0m[35m            self.mass_player.active_source = active_service[0m

[31m--[ [0m[34mMatch #[0m[33m1732[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m374 | [0m[35m            else:[0m
[30;1m375 | [0m[35m                self.mass_player.active_source = None[0m
[30;1m376 | [0m[35m        # its playing some service we did not yet map[0m
[30;1m377 | [0m[35m        elif container and container.get("service", {}).get("name"):[0m
[30;1m378 | [0m[35m            self.mass_player.active_source = container["service"]["name"][0m
[30;1m379 | [0m[35m        elif container and container.get("name"):[0m
[30;1m380 | [0m[35m            self.mass_player.active_source = container["name"][0m

[31m--[ [0m[34mMatch #[0m[33m1733[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m374 | [0m[35m            else:[0m
[30;1m375 | [0m[35m                self.mass_player.active_source = None[0m
[30;1m376 | [0m[35m        # its playing some service we did not yet map[0m
[30;1m377 | [0m[35m        elif container and container.get("service", {}).get("name"):[0m
[30;1m378 | [0m[35m            self.mass_player.active_source = container["service"]["name"][0m
[30;1m379 | [0m[35m        elif container and container.get("name"):[0m
[30;1m380 | [0m[35m            self.mass_player.active_source = container["name"][0m

[31m--[ [0m[34mMatch #[0m[33m1734[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m369 | [0m[35m        elif active_service == MusicService.MUSIC_ASSISTANT:[0m
[30;1m370 | [0m[35m            if self.client.player.is_coordinator:[0m
[30;1m371 | [0m[35m                self.mass_player.active_source = self.mass_player.player_id[0m
[30;1m372 | [0m[35m            elif object_id := container.get("id", {}).get("objectId"):[0m
[30;1m373 | [0m[35m                self.mass_player.active_source = object_id.split(":")[-1][0m
[30;1m374 | [0m[35m            else:[0m
[30;1m375 | [0m[35m                self.mass_player.active_source = None[0m

[31m--[ [0m[34mMatch #[0m[33m1735[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m369 | [0m[35m        elif active_service == MusicService.MUSIC_ASSISTANT:[0m
[30;1m370 | [0m[35m            if self.client.player.is_coordinator:[0m
[30;1m371 | [0m[35m                self.mass_player.active_source = self.mass_player.player_id[0m
[30;1m372 | [0m[35m            elif object_id := container.get("id", {}).get("objectId"):[0m
[30;1m373 | [0m[35m                self.mass_player.active_source = object_id.split(":")[-1][0m
[30;1m374 | [0m[35m            else:[0m
[30;1m375 | [0m[35m                self.mass_player.active_source = None[0m

[31m--[ [0m[34mMatch #[0m[33m1736[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m334 | [0m[35m        # figure out the active source based on the container[0m
[30;1m335 | [0m[35m        container_type = active_group.container_type[0m
[30;1m336 | [0m[35m        active_service = active_group.active_service[0m
[30;1m337 | [0m[35m        container = active_group.playback_metadata.get("container")[0m
[30;1m338 | [0m[35m        if container_type == ContainerType.LINEIN:[0m
[30;1m339 | [0m[35m            self.mass_player.active_source = SOURCE_LINE_IN[0m
[30;1m340 | [0m[35m        elif container_type in (ContainerType.HOME_THEATER_HDMI, ContainerType.HOME_THEATER_SPDIF):[0m

[31m--[ [0m[34mMatch #[0m[33m1737[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m318 | [0m[35m            self.mass_player.synced_to = None[0m
[30;1m319 | [0m[35m        else:[0m
[30;1m320 | [0m[35m            # player is group child (synced to another player)[0m
[30;1m321 | [0m[35m            group_parent = self.prov.sonos_players.get(self.client.player.group.coordinator_id)[0m
[30;1m322 | [0m[35m            if not group_parent or not group_parent.client or not group_parent.client.player:[0m
[30;1m323 | [0m[35m                # handle race condition where the group parent is not yet discovered[0m
[30;1m324 | [0m[35m                return[0m

[31m--[ [0m[34mMatch #[0m[33m1738[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m233 | [0m[35m                await player_provider.cmd_pause(airplay.player_id)[0m
[30;1m234 | [0m[35m            return[0m
[30;1m235 | [0m[35m        active_source = self.mass_player.active_source[0m
[30;1m236 | [0m[35m        if self.mass.player_queues.get(active_source):[0m
[30;1m237 | [0m[35m            # Sonos seems to be bugged when playing our queue tracks and we send pause,[0m
[30;1m238 | [0m[35m            # it can't resume the current track and simply aborts/skips it[0m
[30;1m239 | [0m[35m            # so we stop the player instead.[0m

[31m--[ [0m[34mMatch #[0m[33m1739[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m99 | [0m[35m        """Return the linked airplay player if available/enabled."""[0m
[30;1m100 | [0m[35m        if enabled_only and not self.airplay_mode_enabled:[0m
[30;1m101 | [0m[35m            return None[0m
[30;1m102 | [0m[35m        if not (airplay_player := self.mass.players.get(self.airplay_player_id)):[0m
[30;1m103 | [0m[35m            return None[0m
[30;1m104 | [0m[35m        if not airplay_player.available:[0m
[30;1m105 | [0m[35m            return None[0m

[31m--[ [0m[34mMatch #[0m[33m1740[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m542 | [0m[35m                )[0m
[30;1m543 | [0m[35m            except FailedCommand as err:[0m
[30;1m544 | [0m[35m                if "groupCoordinatorChanged" not in str(err):[0m
[30;1m545 | [0m[35m                    # this may happen at race conditions[0m
[30;1m546 | [0m[35m                    raise[0m

[31m--[ [0m[34mMatch #[0m[33m1741[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m383 | [0m[35m        elif container_type:[0m
[30;1m384 | [0m[35m            self.mass_player.active_source = container_type[0m
[30;1m385 | [0m[35m        else:[0m
[30;1m386 | [0m[35m            # the player has nothing loaded at all (empty queue and no service active)[0m
[30;1m387 | [0m[35m            self.mass_player.active_source = None[0m
[30;1m388 | [0m[35m[0m
[30;1m389 | [0m[35m        # parse current media[0m

[31m--[ [0m[34mMatch #[0m[33m1742[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m383 | [0m[35m        elif container_type:[0m
[30;1m384 | [0m[35m            self.mass_player.active_source = container_type[0m
[30;1m385 | [0m[35m        else:[0m
[30;1m386 | [0m[35m            # the player has nothing loaded at all (empty queue and no service active)[0m
[30;1m387 | [0m[35m            self.mass_player.active_source = None[0m
[30;1m388 | [0m[35m[0m
[30;1m389 | [0m[35m        # parse current media[0m

[31m--[ [0m[34mMatch #[0m[33m1743[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m373 | [0m[35m                self.mass_player.active_source = object_id.split(":")[-1][0m
[30;1m374 | [0m[35m            else:[0m
[30;1m375 | [0m[35m                self.mass_player.active_source = None[0m
[30;1m376 | [0m[35m        # its playing some service we did not yet map[0m
[30;1m377 | [0m[35m        elif container and container.get("service", {}).get("name"):[0m
[30;1m378 | [0m[35m            self.mass_player.active_source = container["service"]["name"][0m
[30;1m379 | [0m[35m        elif container and container.get("name"):[0m

[31m--[ [0m[34mMatch #[0m[33m1744[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/player.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35mfrom __future__ import annotations[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mimport asyncio[0m
[30;1m13 | [0m[35mimport time[0m
[30;1m14 | [0m[35mfrom collections.abc import Callable[0m
[30;1m15 | [0m[35mfrom typing import TYPE_CHECKING[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mfrom aiohttp.client_exceptions import ClientConnectorError[0m

[31m--[ [0m[34mMatch #[0m[33m1745[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m.hostname[0m

[31m--[ [0m[34mMatch #[0m[33m1746[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m.hostname[0m

[31m--[ [0m[34mMatch #[0m[33m1747[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m.hostname[0m

[31m--[ [0m[34mMatch #[0m[33m1748[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m.hostname[0m

[31m--[ [0m[34mMatch #[0m[33m1749[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m

[31m--[ [0m[34mMatch #[0m[33m1750[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m

[31m--[ [0m[34mMatch #[0m[33m1751[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m

[31m--[ [0m[34mMatch #[0m[33m1752[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m

[31m--[ [0m[34mMatch #[0m[33m1753[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m

[31m--[ [0m[34mMatch #[0m[33m1754[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m

[31m--[ [0m[34mMatch #[0m[33m1755[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m

[31m--[ [0m[34mMatch #[0m[33m1756[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m

[31m--[ [0m[34mMatch #[0m[33m1757[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m  | [0m[35mw Error()}catch(_){u=_}t()}}catch(_){if(_&&u&&typeof _.stack=="string"){for(var p=_.stack.split(`[0m
[30;1m  | [0m[35m`),d=u.stack.split(`[0m
[30;1m  | [0m[35m`),b=p.length-1,k=d.length-1;1<=b&&0<=k&&p[b]!==d[k];)k--;for(;1<=b&&0<=k;b--,k--)if(p[b]!==d[k]){if[0m

[31m--[ [0m[34mMatch #[0m[33m1758[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m  | [0m[35mse{try{throw Error()}catch(_){u=_}t()}}catch(_){if(_&&u&&typeof _.stack=="string"){for(var p=_.stack[0m
[30;1m  | [0m[35m`),d=u.stack.split(`[0m
[30;1m  | [0m[35m`),b=p.length-1,k=d.length-1;1<=b&&0<=k&&p[b]!==d[k];)k--;for(;1<=b&&0<=k;b--,k--)if(p[b]!==d[k]){if[0m

[31m--[ [0m[34mMatch #[0m[33m1759[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m

[31m--[ [0m[34mMatch #[0m[33m1760[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1761[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1762[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1763[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1764[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1765[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1766[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1767[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1768[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1769[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1770[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1771[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1772[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1773[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1774[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1775[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1776[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1777[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1778[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1779[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1780[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1781[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1782[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1783[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1784[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1785[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1786[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1787[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1788[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1789[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1790[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1791[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1792[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1793[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1794[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m  | [0m[35m[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${X}[0m

[31m--[ [0m[34mMatch #[0m[33m1795[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m  | [0m[35ml||typeof t.prototype!="object")throw new TypeError("The given value for processorCtor should have a[0m

[31m--[ [0m[34mMatch #[0m[33m1796[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m  | [0m[35mstructor.");if(t.prototype===null||typeof t.prototype!="object")throw new TypeError("The given value[0m

[31m--[ [0m[34mMatch #[0m[33m1797[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1798[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1799[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1800[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1801[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1802[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1803[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1804[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1805[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1806[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1807[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1808[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1809[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1810[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1811[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1812[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/assets/index-BYMjFABP.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m1813[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/jellyfin/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m428 | [0m[35m            await self._client.albums.parent(prov_artist_id)[0m
[30;1m429 | [0m[35m            .fields(*ALBUM_FIELDS)[0m
[30;1m430 | [0m[35m            .enable_userdata()[0m
[30;1m431 | [0m[35m            .request()[0m
[30;1m432 | [0m[35m        )[0m
[30;1m433 | [0m[35m        return [[0m
[30;1m434 | [0m[35m            parse_album(self.logger, self.instance_id, self._client, album)[0m

[31m--[ [0m[34mMatch #[0m[33m1814[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/jellyfin/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m416 | [0m[35m                    result.append(track)[0m
[30;1m417 | [0m[35m            except (KeyError, ValueError) as err:[0m
[30;1m418 | [0m[35m                self.logger.error([0m
[30;1m419 | [0m[35m                    "Skipping track %s: %s", jellyfin_track.get(ITEM_KEY_NAME, index), str(err)[0m
[30;1m420 | [0m[35m                )[0m
[30;1m421 | [0m[35m        return result[0m
[30;1m422 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1815[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/jellyfin/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m404 | [0m[35m            .fields(*TRACK_FIELDS)[0m
[30;1m405 | [0m[35m            .limit(100)[0m
[30;1m406 | [0m[35m            .start_index(page * 100)[0m
[30;1m407 | [0m[35m            .request()[0m
[30;1m408 | [0m[35m        )[0m
[30;1m409 | [0m[35m        for index, jellyfin_track in enumerate(playlist_items["Items"], 1):[0m
[30;1m410 | [0m[35m            pos = (page * 100) + index[0m

[31m--[ [0m[34mMatch #[0m[33m1816[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/jellyfin/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m348 | [0m[35m            await self._client.tracks.parent(prov_album_id)[0m
[30;1m349 | [0m[35m            .enable_userdata()[0m
[30;1m350 | [0m[35m            .fields(*TRACK_FIELDS)[0m
[30;1m351 | [0m[35m            .request()[0m
[30;1m352 | [0m[35m        )[0m
[30;1m353 | [0m[35m        return [[0m
[30;1m354 | [0m[35m            parse_track(self.logger, self.instance_id, self._client, jellyfin_album_track)[0m

[31m--[ [0m[34mMatch #[0m[33m1817[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/jellyfin/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m227 | [0m[35m            await self._client.playlists.search_term(search_query)[0m
[30;1m228 | [0m[35m            .limit(limit)[0m
[30;1m229 | [0m[35m            .enable_userdata()[0m
[30;1m230 | [0m[35m            .request()[0m
[30;1m231 | [0m[35m        )[0m
[30;1m232 | [0m[35m        playlists = [][0m
[30;1m233 | [0m[35m        for item in resultset["Items"]:[0m

[31m--[ [0m[34mMatch #[0m[33m1818[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/jellyfin/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m215 | [0m[35m            .limit(limit)[0m
[30;1m216 | [0m[35m            .enable_userdata()[0m
[30;1m217 | [0m[35m            .fields(*ARTIST_FIELDS)[0m
[30;1m218 | [0m[35m            .request()[0m
[30;1m219 | [0m[35m        )[0m
[30;1m220 | [0m[35m        artists = [][0m
[30;1m221 | [0m[35m        for item in resultset["Items"]:[0m

[31m--[ [0m[34mMatch #[0m[33m1819[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/jellyfin/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m202 | [0m[35m            .limit(limit)[0m
[30;1m203 | [0m[35m            .enable_userdata()[0m
[30;1m204 | [0m[35m            .fields(*ALBUM_FIELDS)[0m
[30;1m205 | [0m[35m            .request()[0m
[30;1m206 | [0m[35m        )[0m
[30;1m207 | [0m[35m        albums = [][0m
[30;1m208 | [0m[35m        for item in resultset["Items"]:[0m

[31m--[ [0m[34mMatch #[0m[33m1820[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/jellyfin/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m184 | [0m[35m            .limit(limit)[0m
[30;1m185 | [0m[35m            .enable_userdata()[0m
[30;1m186 | [0m[35m            .fields(*TRACK_FIELDS)[0m
[30;1m187 | [0m[35m            .request()[0m
[30;1m188 | [0m[35m        )[0m
[30;1m189 | [0m[35m        tracks = [][0m
[30;1m190 | [0m[35m        for item in resultset["Items"]:[0m

[31m--[ [0m[34mMatch #[0m[33m1821[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/jellyfin/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m125 | [0m[35m        username = str(self.config.get_value(CONF_USERNAME))[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m        # Device ID should be stable between reboots[0m
[30;1m128 | [0m[35m        # Otherwise every time the provider starts we "leak" a new device[0m
[30;1m129 | [0m[35m        # entry in the Jellyfin backend, which creates devices and entities[0m
[30;1m130 | [0m[35m        # in HA if they also use the Jellyfin integration there.[0m
[30;1m131 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1822[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m659 | [0m[35m            </s:Envelope>[0m
[30;1m660 | [0m[35m            """[0m
[30;1m661 | [0m[35m        player_ip = sonos_player.mass_player.device_info.ip_address[0m
[30;1m662 | [0m[35m        async with self.mass.http_session.post([0m
[30;1m663 | [0m[35m            f"http://{player_ip}:1400/MediaRenderer/AVTransport/Control",[0m
[30;1m664 | [0m[35m            headers={[0m
[30;1m665 | [0m[35m                "SOAPACTION": "urn:schemas-upnp-org:service:AVTransport:1#SetNextAVTransportURI",[0m

[31m--[ [0m[34mMatch #[0m[33m1823[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m627 | [0m[35m            </s:Envelope>[0m
[30;1m628 | [0m[35m            """[0m
[30;1m629 | [0m[35m        player_ip = sonos_player.mass_player.device_info.ip_address[0m
[30;1m630 | [0m[35m        async with self.mass.http_session.post([0m
[30;1m631 | [0m[35m            f"http://{player_ip}:1400/MediaRenderer/AVTransport/Control",[0m
[30;1m632 | [0m[35m            headers={[0m
[30;1m633 | [0m[35m                "SOAPACTION": "urn:schemas-upnp-org:service:AVTransport:1#SetAVTransportURI",[0m

[31m--[ [0m[34mMatch #[0m[33m1824[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m552 | [0m[35m[0m
[30;1m553 | [0m[35m    async def _parse_sonos_queue_item(self, queue_item: QueueItem) -> dict[str, Any]:[0m
[30;1m554 | [0m[35m        """Parse a Sonos queue item to a PlayerMedia object."""[0m
[30;1m555 | [0m[35m        queue = self.mass.player_queues.get(queue_item.queue_id)[0m
[30;1m556 | [0m[35m        assert queue  # for type checking[0m
[30;1m557 | [0m[35m        stream_url = await self.mass.streams.resolve_stream_url(queue.session_id, queue_item)[0m
[30;1m558 | [0m[35m        if streamdetails := queue_item.streamdetails:[0m

[31m--[ [0m[34mMatch #[0m[33m1825[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m537 | [0m[35m        sonos_player_id = sonos_playback_id.split(":")[0][0m
[30;1m538 | [0m[35m        if not (mass_player := self.mass.players.get(sonos_player_id)):[0m
[30;1m539 | [0m[35m            return web.Response(status=501)[0m
[30;1m540 | [0m[35m        if not (self.sonos_players.get(sonos_player_id)):[0m
[30;1m541 | [0m[35m            return web.Response(status=501)[0m
[30;1m542 | [0m[35m        for item in json_body["items"]:[0m
[30;1m543 | [0m[35m            if item["type"] != "update":[0m

[31m--[ [0m[34mMatch #[0m[33m1826[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m535 | [0m[35m        json_body = await request.json()[0m
[30;1m536 | [0m[35m        sonos_playback_id = request.headers["X-Sonos-Playback-Id"][0m
[30;1m537 | [0m[35m        sonos_player_id = sonos_playback_id.split(":")[0][0m
[30;1m538 | [0m[35m        if not (mass_player := self.mass.players.get(sonos_player_id)):[0m
[30;1m539 | [0m[35m            return web.Response(status=501)[0m
[30;1m540 | [0m[35m        if not (self.sonos_players.get(sonos_player_id)):[0m
[30;1m541 | [0m[35m            return web.Response(status=501)[0m

[31m--[ [0m[34mMatch #[0m[33m1827[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m489 | [0m[35m        sonos_player_id = sonos_playback_id.split(":")[0][0m
[30;1m490 | [0m[35m        if not (mass_queue := self.mass.player_queues.get_active_queue(sonos_player_id)):[0m
[30;1m491 | [0m[35m            return web.Response(status=501)[0m
[30;1m492 | [0m[35m        if not (self.sonos_players.get(sonos_player_id)):[0m
[30;1m493 | [0m[35m            return web.Response(status=501)[0m
[30;1m494 | [0m[35m        result = {[0m
[30;1m495 | [0m[35m            "contextVersion": "1",[0m

[31m--[ [0m[34mMatch #[0m[33m1828[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m473 | [0m[35m        if not (self.sonos_players.get(sonos_player_id)):[0m
[30;1m474 | [0m[35m            return web.Response(status=501)[0m
[30;1m475 | [0m[35m        mass_queue = self.mass.player_queues.get_active_queue(sonos_player_id)[0m
[30;1m476 | [0m[35m        context_version = request.query.get("contextVersion") or "1"[0m
[30;1m477 | [0m[35m        queue_version = str(int(mass_queue.items_last_updated))[0m
[30;1m478 | [0m[35m        result = {"contextVersion": context_version, "queueVersion": queue_version}[0m
[30;1m479 | [0m[35m        return web.json_response(result)[0m

[31m--[ [0m[34mMatch #[0m[33m1829[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m470 | [0m[35m        self.logger.log(VERBOSE_LOG_LEVEL, "Cloud Queue Version request: %s", request.query)[0m
[30;1m471 | [0m[35m        sonos_playback_id = request.headers["X-Sonos-Playback-Id"][0m
[30;1m472 | [0m[35m        sonos_player_id = sonos_playback_id.split(":")[0][0m
[30;1m473 | [0m[35m        if not (self.sonos_players.get(sonos_player_id)):[0m
[30;1m474 | [0m[35m            return web.Response(status=501)[0m
[30;1m475 | [0m[35m        mass_queue = self.mass.player_queues.get_active_queue(sonos_player_id)[0m
[30;1m476 | [0m[35m        context_version = request.query.get("contextVersion") or "1"[0m

[31m--[ [0m[34mMatch #[0m[33m1830[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m439 | [0m[35m        context_version = request.query.get("contextVersion")[0m
[30;1m440 | [0m[35m        if not (mass_queue := self.mass.player_queues.get_active_queue(sonos_player_id)):[0m
[30;1m441 | [0m[35m            return web.Response(status=501)[0m
[30;1m442 | [0m[35m        if item_id := request.query.get("itemId"):[0m
[30;1m443 | [0m[35m            queue_index = self.mass.player_queues.index_by_id(mass_queue.queue_id, item_id)[0m
[30;1m444 | [0m[35m        else:[0m
[30;1m445 | [0m[35m            queue_index = mass_queue.current_index[0m

[31m--[ [0m[34mMatch #[0m[33m1831[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m436 | [0m[35m        upcoming_window_size = int(request.query.get("upcomingWindowSize") or 10)[0m
[30;1m437 | [0m[35m        previous_window_size = int(request.query.get("previousWindowSize") or 10)[0m
[30;1m438 | [0m[35m        queue_version = request.query.get("queueVersion")[0m
[30;1m439 | [0m[35m        context_version = request.query.get("contextVersion")[0m
[30;1m440 | [0m[35m        if not (mass_queue := self.mass.player_queues.get_active_queue(sonos_player_id)):[0m
[30;1m441 | [0m[35m            return web.Response(status=501)[0m
[30;1m442 | [0m[35m        if item_id := request.query.get("itemId"):[0m

[31m--[ [0m[34mMatch #[0m[33m1832[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m435 | [0m[35m        sonos_player_id = sonos_playback_id.split(":")[0][0m
[30;1m436 | [0m[35m        upcoming_window_size = int(request.query.get("upcomingWindowSize") or 10)[0m
[30;1m437 | [0m[35m        previous_window_size = int(request.query.get("previousWindowSize") or 10)[0m
[30;1m438 | [0m[35m        queue_version = request.query.get("queueVersion")[0m
[30;1m439 | [0m[35m        context_version = request.query.get("contextVersion")[0m
[30;1m440 | [0m[35m        if not (mass_queue := self.mass.player_queues.get_active_queue(sonos_player_id)):[0m
[30;1m441 | [0m[35m            return web.Response(status=501)[0m

[31m--[ [0m[34mMatch #[0m[33m1833[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m434 | [0m[35m        sonos_playback_id = request.headers["X-Sonos-Playback-Id"][0m
[30;1m435 | [0m[35m        sonos_player_id = sonos_playback_id.split(":")[0][0m
[30;1m436 | [0m[35m        upcoming_window_size = int(request.query.get("upcomingWindowSize") or 10)[0m
[30;1m437 | [0m[35m        previous_window_size = int(request.query.get("previousWindowSize") or 10)[0m
[30;1m438 | [0m[35m        queue_version = request.query.get("queueVersion")[0m
[30;1m439 | [0m[35m        context_version = request.query.get("contextVersion")[0m
[30;1m440 | [0m[35m        if not (mass_queue := self.mass.player_queues.get_active_queue(sonos_player_id)):[0m

[31m--[ [0m[34mMatch #[0m[33m1834[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m433 | [0m[35m        self.logger.log(VERBOSE_LOG_LEVEL, "Cloud Queue ItemWindow request: %s", request.query)[0m
[30;1m434 | [0m[35m        sonos_playback_id = request.headers["X-Sonos-Playback-Id"][0m
[30;1m435 | [0m[35m        sonos_player_id = sonos_playback_id.split(":")[0][0m
[30;1m436 | [0m[35m        upcoming_window_size = int(request.query.get("upcomingWindowSize") or 10)[0m
[30;1m437 | [0m[35m        previous_window_size = int(request.query.get("previousWindowSize") or 10)[0m
[30;1m438 | [0m[35m        queue_version = request.query.get("queueVersion")[0m
[30;1m439 | [0m[35m        context_version = request.query.get("contextVersion")[0m

[31m--[ [0m[34mMatch #[0m[33m1835[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m407 | [0m[35m        except ClientError as err:[0m
[30;1m408 | [0m[35m            self.logger.debug("Ignoring %s in discovery as it is not reachable: %s", name, str(err))[0m
[30;1m409 | [0m[35m            return[0m
[30;1m410 | [0m[35m        display_name = discovery_info["device"].get("name") or name[0m
[30;1m411 | [0m[35m        if SonosCapability.PLAYBACK not in discovery_info["device"]["capabilities"]:[0m
[30;1m412 | [0m[35m            # this will happen for satellite speakers in a surround/stereo setup[0m
[30;1m413 | [0m[35m            self.logger.debug([0m

[31m--[ [0m[34mMatch #[0m[33m1836[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m332 | [0m[35m            # Regular Queue item playback[0m
[30;1m333 | [0m[35m            # create a sonos cloud queue and load it[0m
[30;1m334 | [0m[35m            cloud_queue_url = f"{self.mass.streams.base_url}/sonos_queue/v2.3/"[0m
[30;1m335 | [0m[35m            mass_queue = self.mass.player_queues.get(media.queue_id)[0m
[30;1m336 | [0m[35m            await sonos_player.client.player.group.play_cloud_queue([0m
[30;1m337 | [0m[35m                cloud_queue_url,[0m
[30;1m338 | [0m[35m                http_authorization=media.queue_id,[0m

[31m--[ [0m[34mMatch #[0m[33m1837[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m289 | [0m[35m    ) -> None:[0m
[30;1m290 | [0m[35m        """Handle PLAY MEDIA on given player."""[0m
[30;1m291 | [0m[35m        sonos_player = self.sonos_players[player_id][0m
[30;1m292 | [0m[35m        mass_player = self.mass.players.get(player_id)[0m
[30;1m293 | [0m[35m        if sonos_player.client.player.is_passive:[0m
[30;1m294 | [0m[35m            # this should be already handled by the player manager, but just in case...[0m
[30;1m295 | [0m[35m            msg = ([0m

[31m--[ [0m[34mMatch #[0m[33m1838[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m196 | [0m[35m        """Call (by config manager) when the configuration of a player changes."""[0m
[30;1m197 | [0m[35m        await super().on_player_config_change(config, changed_keys)[0m
[30;1m198 | [0m[35m        if "values/airplay_mode" in changed_keys and ([0m
[30;1m199 | [0m[35m            (sonos_player := self.sonos_players.get(config.player_id))[0m
[30;1m200 | [0m[35m            and (airplay_player := sonos_player.get_linked_airplay_player(False))[0m
[30;1m201 | [0m[35m            and airplay_player.state in (PlayerState.PLAYING, PlayerState.PAUSED)[0m
[30;1m202 | [0m[35m        ):[0m

[31m--[ [0m[34mMatch #[0m[33m1839[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m157 | [0m[35m                hidden=False,[0m
[30;1m158 | [0m[35m            ),[0m
[30;1m159 | [0m[35m        )[0m
[30;1m160 | [0m[35m        if not (sonos_player := self.sonos_players.get(player_id)):[0m
[30;1m161 | [0m[35m            # most probably the player is not yet discovered[0m
[30;1m162 | [0m[35m            return base_entries[0m
[30;1m163 | [0m[35m        return ([0m

[31m--[ [0m[34mMatch #[0m[33m1840[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/provider.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m113 | [0m[35m        name = name.split("@", 1)[1] if "@" in name else name[0m
[30;1m114 | [0m[35m        player_id = info.decoded_properties["uuid"][0m
[30;1m115 | [0m[35m        # handle update for existing device[0m
[30;1m116 | [0m[35m        if sonos_player := self.sonos_players.get(player_id):[0m
[30;1m117 | [0m[35m            if mass_player := sonos_player.mass_player:[0m
[30;1m118 | [0m[35m                cur_address = get_primary_ip_address(info)[0m
[30;1m119 | [0m[35m                if cur_address and cur_address != sonos_player.ip_address:[0m

[31m--[ [0m[34mMatch #[0m[33m1841[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/provider.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m419 | [0m[35m            self, player_id, discovery_info=discovery_info, ip_address=address[0m
[30;1m420 | [0m[35m        )[0m
[30;1m421 | [0m[35m        await sonos_player.setup()[0m
[30;1m422 | [0m[35m        # trigger update on all existing players to update the group status[0m
[30;1m423 | [0m[35m        for _player in self.sonos_players.values():[0m
[30;1m424 | [0m[35m            if _player.player_id != player_id:[0m
[30;1m425 | [0m[35m                _player.on_player_event(None)[0m

[31m--[ [0m[34mMatch #[0m[33m1842[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/provider.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m419 | [0m[35m            self, player_id, discovery_info=discovery_info, ip_address=address[0m
[30;1m420 | [0m[35m        )[0m
[30;1m421 | [0m[35m        await sonos_player.setup()[0m
[30;1m422 | [0m[35m        # trigger update on all existing players to update the group status[0m
[30;1m423 | [0m[35m        for _player in self.sonos_players.values():[0m
[30;1m424 | [0m[35m            if _player.player_id != player_id:[0m
[30;1m425 | [0m[35m                _player.on_player_event(None)[0m

[31m--[ [0m[34mMatch #[0m[33m1843[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/provider.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m112 | [0m[35m            return[0m
[30;1m113 | [0m[35m        name = name.split("@", 1)[1] if "@" in name else name[0m
[30;1m114 | [0m[35m        player_id = info.decoded_properties["uuid"][0m
[30;1m115 | [0m[35m        # handle update for existing device[0m
[30;1m116 | [0m[35m        if sonos_player := self.sonos_players.get(player_id):[0m
[30;1m117 | [0m[35m            if mass_player := sonos_player.mass_player:[0m
[30;1m118 | [0m[35m                cur_address = get_primary_ip_address(info)[0m

[31m--[ [0m[34mMatch #[0m[33m1844[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/provider.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m102 | [0m[35m    async def on_mdns_service_state_change([0m
[30;1m103 | [0m[35m        self, name: str, state_change: ServiceStateChange, info: AsyncServiceInfo | None[0m
[30;1m104 | [0m[35m    ) -> None:[0m
[30;1m105 | [0m[35m        """Handle MDNS service state callback."""[0m
[30;1m106 | [0m[35m        if state_change == ServiceStateChange.Removed:[0m
[30;1m107 | [0m[35m            # we don't listen for removed players here.[0m
[30;1m108 | [0m[35m            # instead we just wait for the player connection to fail[0m

[31m--[ [0m[34mMatch #[0m[33m1845[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/provider.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35mfrom __future__ import annotations[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mimport asyncio[0m
[30;1m11 | [0m[35mimport time[0m
[30;1m12 | [0m[35mfrom typing import TYPE_CHECKING, Any[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mfrom aiohttp import web[0m
[30;1m15 | [0m[35mfrom aiohttp.client_exceptions import ClientError[0m

[31m--[ [0m[34mMatch #[0m[33m1846[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/music.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m593 | [0m[35m                name=item_id,[0m
[30;1m594 | [0m[35m            )[0m
[30;1m595 | [0m[35m        ctrl = self.get_controller(media_type)[0m
[30;1m596 | [0m[35m        return await ctrl.get([0m
[30;1m597 | [0m[35m            item_id=item_id,[0m
[30;1m598 | [0m[35m            provider_instance_id_or_domain=provider_instance_id_or_domain,[0m
[30;1m599 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1847[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/music.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m376 | [0m[35m        cache_key = f"{search_query}.{limit}.{media_types_str}"[0m
[30;1m377 | [0m[35m[0m
[30;1m378 | [0m[35m        if prov.is_streaming_provider and ([0m
[30;1m379 | [0m[35m            cache := await self.mass.cache.get([0m
[30;1m380 | [0m[35m                cache_key, category=cache_category, base_key=cache_base_key[0m
[30;1m381 | [0m[35m            )[0m
[30;1m382 | [0m[35m        ):[0m

[31m--[ [0m[34mMatch #[0m[33m1848[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/music.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1909 | [0m[35m                AFTER UPDATE ON {db_table} FOR EACH ROW[0m
[30;1m1910 | [0m[35m                WHEN NEW.timestamp_modified <= OLD.timestamp_modified[0m
[30;1m1911 | [0m[35m                BEGIN[0m
[30;1m1912 | [0m[35m                    UPDATE {db_table} set timestamp_modified=cast(strftime('%s','now') as int)[0m
[30;1m1913 | [0m[35m                    WHERE item_id=OLD.item_id;[0m
[30;1m1914 | [0m[35m                END;[0m
[30;1m1915 | [0m[35m                """[0m

[31m--[ [0m[34mMatch #[0m[33m1849[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/music.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1906 | [0m[35m            await self.database.execute([0m
[30;1m1907 | [0m[35m                f"""[0m
[30;1m1908 | [0m[35m                CREATE TRIGGER IF NOT EXISTS update_{db_table}_timestamp[0m
[30;1m1909 | [0m[35m                AFTER UPDATE ON {db_table} FOR EACH ROW[0m
[30;1m1910 | [0m[35m                WHEN NEW.timestamp_modified <= OLD.timestamp_modified[0m
[30;1m1911 | [0m[35m                BEGIN[0m
[30;1m1912 | [0m[35m                    UPDATE {db_table} set timestamp_modified=cast(strftime('%s','now') as int)[0m

[31m--[ [0m[34mMatch #[0m[33m1850[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/music.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1893 | [0m[35m[0m
[30;1m1894 | [0m[35m    async def __create_database_triggers(self) -> None:[0m
[30;1m1895 | [0m[35m        """Create database triggers."""[0m
[30;1m1896 | [0m[35m        # triggers to auto update timestamps[0m
[30;1m1897 | [0m[35m        for db_table in ([0m
[30;1m1898 | [0m[35m            "artists",[0m
[30;1m1899 | [0m[35m            "albums",[0m

[31m--[ [0m[34mMatch #[0m[33m1851[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/music.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1385 | [0m[35m                await self.__migrate_database(prev_version)[0m
[30;1m1386 | [0m[35m            except Exception as err:[0m
[30;1m1387 | [0m[35m                # if the migration fails completely we reset the db[0m
[30;1m1388 | [0m[35m                # so the user at least can have a working situation back[0m
[30;1m1389 | [0m[35m                # a backup file is made with the previous version[0m
[30;1m1390 | [0m[35m                self.logger.error([0m
[30;1m1391 | [0m[35m                    "Database migration failed - starting with a fresh library database, "[0m

[31m--[ [0m[34mMatch #[0m[33m1852[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/music.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1304 | [0m[35m        for item in items:[0m
[30;1m1305 | [0m[35m            score = 0[0m
[30;1m1306 | [0m[35m            if create_safe_string(item.name) not in (safe_title_str, safe_title_alt):[0m
[30;1m1307 | [0m[35m                # literal name match is mandatory to get a score at all[0m
[30;1m1308 | [0m[35m                continue[0m
[30;1m1309 | [0m[35m            # bonus point if artist provided and exact match[0m
[30;1m1310 | [0m[35m            if safe_artist_str:[0m

[31m--[ [0m[34mMatch #[0m[33m1853[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/music.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1230 | [0m[35m[0m
[30;1m1231 | [0m[35m        async def run_sync() -> None:[0m
[30;1m1232 | [0m[35m            # Wrap the provider sync into a lock to prevent[0m
[30;1m1233 | [0m[35m            # race conditions when multiple providers are syncing at the same time.[0m
[30;1m1234 | [0m[35m            async with self._sync_lock:[0m
[30;1m1235 | [0m[35m                await provider.sync_library(media_type)[0m
[30;1m1236 | [0m[35m            # precache playlist tracks[0m

[31m--[ [0m[34mMatch #[0m[33m1854[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/music.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1045 | [0m[35m        """Cleanup provider records from the database."""[0m
[30;1m1046 | [0m[35m        if provider_instance.startswith(("filesystem", "jellyfin", "plex", "opensubsonic")):[0m
[30;1m1047 | [0m[35m            # removal of a local provider can become messy very fast due to the relations[0m
[30;1m1048 | [0m[35m            # such as images pointing at the files etc. so we just reset the whole db[0m
[30;1m1049 | [0m[35m            # TODO: Handle this more gracefully in the future where we remove the provider[0m
[30;1m1050 | [0m[35m            # and traverse the database to also remove all related items.[0m
[30;1m1051 | [0m[35m            self.logger.warning([0m

[31m--[ [0m[34mMatch #[0m[33m1855[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/music.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m951 | [0m[35m                        media_item=media_item,[0m
[30;1m952 | [0m[35m                    )[0m
[30;1m953 | [0m[35m                )[0m
[30;1m954 | [0m[35m        # also update playcount in library table[0m
[30;1m955 | [0m[35m        ctrl = self.get_controller(media_item.media_type)[0m
[30;1m956 | [0m[35m        db_item = await ctrl.get_library_item_by_prov_id(media_item.item_id, media_item.provider)[0m
[30;1m957 | [0m[35m        if db_item:[0m

[31m--[ [0m[34mMatch #[0m[33m1856[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/music.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m930 | [0m[35m        media_item: MediaItemType,[0m
[30;1m931 | [0m[35m    ) -> None:[0m
[30;1m932 | [0m[35m        """Mark item as unplayed in playlog."""[0m
[30;1m933 | [0m[35m        # update generic playlog table[0m
[30;1m934 | [0m[35m        await self.database.delete([0m
[30;1m935 | [0m[35m            DB_TABLE_PLAYLOG,[0m
[30;1m936 | [0m[35m            {[0m

[31m--[ [0m[34mMatch #[0m[33m1857[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/music.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m902 | [0m[35m                    )[0m
[30;1m903 | [0m[35m                )[0m
[30;1m904 | [0m[35m[0m
[30;1m905 | [0m[35m        # also update playcount in library table (if fully played)[0m
[30;1m906 | [0m[35m        if not fully_played or is_playing:[0m
[30;1m907 | [0m[35m            return[0m
[30;1m908 | [0m[35m        if not (ctrl := self.get_controller(media_item.media_type)):[0m

[31m--[ [0m[34mMatch #[0m[33m1858[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/music.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m869 | [0m[35m            # one-off items like TTS or some sound effect etc.[0m
[30;1m870 | [0m[35m            return[0m
[30;1m871 | [0m[35m[0m
[30;1m872 | [0m[35m        # update generic playlog table (when not playing)[0m
[30;1m873 | [0m[35m        if not is_playing:[0m
[30;1m874 | [0m[35m            await self.database.insert([0m
[30;1m875 | [0m[35m                DB_TABLE_PLAYLOG,[0m

[31m--[ [0m[34mMatch #[0m[33m1859[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/music.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m782 | [0m[35m            return media_item[0m
[30;1m783 | [0m[35m        library_item = await ctrl.update_item_in_library(library_id, media_item, overwrite=True)[0m
[30;1m784 | [0m[35m        if library_item.media_type == MediaType.ALBUM:[0m
[30;1m785 | [0m[35m            # update (local) album tracks[0m
[30;1m786 | [0m[35m            for album_track in await self.albums.tracks([0m
[30;1m787 | [0m[35m                library_item.item_id, library_item.provider, True[0m
[30;1m788 | [0m[35m            ):[0m

[31m--[ [0m[34mMatch #[0m[33m1860[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/music.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m777 | [0m[35m                raise MediaNotFoundError(f"Could not find a substitute for {media_item.name}")[0m
[30;1m778 | [0m[35m        # fetch full (provider) item[0m
[30;1m779 | [0m[35m        media_item = await ctrl.get_provider_item(item_id, provider, force_refresh=True)[0m
[30;1m780 | [0m[35m        # update library item if needed (including refresh of the metadata etc.)[0m
[30;1m781 | [0m[35m        if library_id is None:[0m
[30;1m782 | [0m[35m            return media_item[0m
[30;1m783 | [0m[35m        library_item = await ctrl.update_item_in_library(library_id, media_item, overwrite=True)[0m

[31m--[ [0m[34mMatch #[0m[33m1861[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/music.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m671 | [0m[35m        for provider_mapping in item.provider_mappings:[0m
[30;1m672 | [0m[35m            if prov_controller := self.mass.get_provider(provider_mapping.provider_instance):[0m
[30;1m673 | [0m[35m                # we simply try to remove it on the provider library[0m
[30;1m674 | [0m[35m                # NOTE that the item may not be in the provider's library at all[0m
[30;1m675 | [0m[35m                # so we need to be a bit forgiving here[0m
[30;1m676 | [0m[35m                with suppress(NotImplementedError):[0m
[30;1m677 | [0m[35m                    await prov_controller.library_remove(provider_mapping.item_id, item.media_type)[0m

[31m--[ [0m[34mMatch #[0m[33m1862[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/music.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1292 | [0m[35m        scored_items: list[tuple[int, MediaItemTypeOrItemMapping]] = [][0m
[30;1m1293 | [0m[35m        # search results are already sorted by (streaming) providers on relevance[0m
[30;1m1294 | [0m[35m        # but we prefer exact name matches and library items so we simply put those[0m
[30;1m1295 | [0m[35m        # on top of the list.[0m
[30;1m1296 | [0m[35m        safe_title_str = create_safe_string(search_query)[0m
[30;1m1297 | [0m[35m        if " - " in search_query:[0m
[30;1m1298 | [0m[35m            artist, title_alt = search_query.split(" - ", 1)[0m

[31m--[ [0m[34mMatch #[0m[33m1863[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/music.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m774 | [0m[35m                    break[0m
[30;1m775 | [0m[35m            else:[0m
[30;1m776 | [0m[35m                # raise if we didn't find a substitute[0m
[30;1m777 | [0m[35m                raise MediaNotFoundError(f"Could not find a substitute for {media_item.name}")[0m
[30;1m778 | [0m[35m        # fetch full (provider) item[0m
[30;1m779 | [0m[35m        media_item = await ctrl.get_provider_item(item_id, provider, force_refresh=True)[0m
[30;1m780 | [0m[35m        # update library item if needed (including refresh of the metadata etc.)[0m

[31m--[ [0m[34mMatch #[0m[33m1864[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/music.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m773 | [0m[35m                    item_id = item.item_id[0m
[30;1m774 | [0m[35m                    break[0m
[30;1m775 | [0m[35m            else:[0m
[30;1m776 | [0m[35m                # raise if we didn't find a substitute[0m
[30;1m777 | [0m[35m                raise MediaNotFoundError(f"Could not find a substitute for {media_item.name}")[0m
[30;1m778 | [0m[35m        # fetch full (provider) item[0m
[30;1m779 | [0m[35m        media_item = await ctrl.get_provider_item(item_id, provider, force_refresh=True)[0m

[31m--[ [0m[34mMatch #[0m[33m1865[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/music.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m749 | [0m[35m                item_id = media_item.item_id[0m
[30;1m750 | [0m[35m                break[0m
[30;1m751 | [0m[35m        else:[0m
[30;1m752 | [0m[35m            # try to find a substitute using search[0m
[30;1m753 | [0m[35m            searchresult = await self.search(media_item.name, [media_item.media_type], 20)[0m
[30;1m754 | [0m[35m            if media_item.media_type == MediaType.ARTIST:[0m
[30;1m755 | [0m[35m                result = searchresult.artists[0m

[31m--[ [0m[34mMatch #[0m[33m1866[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35m    async def _get(self, endpoint: str, params: dict[str, str | int] | None = None) -> bytes:[0m
[30;1m184 | [0m[35m        """GET request."""[0m
[30;1m185 | [0m[35m        response = await self.session.get([0m
[30;1m186 | [0m[35m            f"{self.base_url}/{endpoint}",[0m
[30;1m187 | [0m[35m            params=params,[0m
[30;1m188 | [0m[35m            ssl=self.verify_ssl,[0m

[31m--[ [0m[34mMatch #[0m[33m1867[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m164 | [0m[35m    ) -> bytes:[0m
[30;1m165 | [0m[35m        """POST request."""[0m
[30;1m166 | [0m[35m        try:[0m
[30;1m167 | [0m[35m            response = await self.session.post([0m
[30;1m168 | [0m[35m                f"{self.base_url}/{endpoint}",[0m
[30;1m169 | [0m[35m                json=data,[0m
[30;1m170 | [0m[35m                ssl=self.verify_ssl,[0m

[31m--[ [0m[34mMatch #[0m[33m1868[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m300 | [0m[35m            )[0m
[30;1m301 | [0m[35m[0m
[30;1m302 | [0m[35m        # It is a bit unclear here, if other gpodder alternatives then nextcloud support the guid[0m
[30;1m303 | [0m[35m        # for episodes. I didn't see that in the source for opodsync at least...[0m
[30;1m304 | [0m[35m        if self.is_nextcloud:[0m
[30;1m305 | [0m[35m            episode_action.guid = guid[0m
[30;1m306 | [0m[35m            endpoint = f"{self._nextcloud_prefix}/episode_action/create"[0m

[31m--[ [0m[34mMatch #[0m[33m1869[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m200 | [0m[35m    async def get_subscriptions(self, since: int = 0) -> SubscriptionsGet | None:[0m
[30;1m201 | [0m[35m        """Get subscriptions.[0m
[30;1m202 | [0m[35m[0m
[30;1m203 | [0m[35m        since is unix time epoch - this may return none if there are no[0m
[30;1m204 | [0m[35m        subscriptions.[0m
[30;1m205 | [0m[35m        """[0m
[30;1m206 | [0m[35m        if self.is_nextcloud:[0m

[31m--[ [0m[34mMatch #[0m[33m1870[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/gpodder/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35mdef action_tagger(cls: "type[EpisodeAction]") -> list[str]:[0m
[30;1m39 | [0m[35m    """Use action field to distinguish classes.[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m    NC Gpodder uses upper case values, opodsync lower case.[0m
[30;1m42 | [0m[35m    This however does not work with a StrEnum, so plain string as action.[0m
[30;1m43 | [0m[35m    """[0m
[30;1m44 | [0m[35m    action = cls.__name__.replace("EpisodeAction", "")[0m

[31m--[ [0m[34mMatch #[0m[33m1871[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m618 | [0m[35m    response_url_parsed = urlparse(response_url)[0m
[30;1m619 | [0m[35m    parsed_qs = parse_qs(response_url_parsed.query)[0m
[30;1m620 | [0m[35m[0m
[30;1m621 | [0m[35m    authorization_codes = parsed_qs.get("openid.oa2.authorization_code")[0m
[30;1m622 | [0m[35m    if not authorization_codes:[0m
[30;1m623 | [0m[35m        raise LoginFailed("Authorization code not found in the provided URL.")[0m
[30;1m624 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1872[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m544 | [0m[35m        }[0m
[30;1m545 | [0m[35m[0m
[30;1m546 | [0m[35m        # Add images[0m
[30;1m547 | [0m[35m        image_path = audiobook_data.get("product_images", {}).get("500")[0m
[30;1m548 | [0m[35m        book.metadata.images = UniqueList(self._create_images(image_path))[0m
[30;1m549 | [0m[35m[0m
[30;1m550 | [0m[35m        # Parse chapters[0m

[31m--[ [0m[34mMatch #[0m[33m1873[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m544 | [0m[35m        }[0m
[30;1m545 | [0m[35m[0m
[30;1m546 | [0m[35m        # Add images[0m
[30;1m547 | [0m[35m        image_path = audiobook_data.get("product_images", {}).get("500")[0m
[30;1m548 | [0m[35m        book.metadata.images = UniqueList(self._create_images(image_path))[0m
[30;1m549 | [0m[35m[0m
[30;1m550 | [0m[35m        # Parse chapters[0m

[31m--[ [0m[34mMatch #[0m[33m1874[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m540 | [0m[35m[0m
[30;1m541 | [0m[35m        # Set genres[0m
[30;1m542 | [0m[35m        book.metadata.genres = {[0m
[30;1m543 | [0m[35m            genre.replace("_", " ") for genre in (audiobook_data.get("platinum_keywords") or [])[0m
[30;1m544 | [0m[35m        }[0m
[30;1m545 | [0m[35m[0m
[30;1m546 | [0m[35m        # Add images[0m

[31m--[ [0m[34mMatch #[0m[33m1875[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m534 | [0m[35m                book.metadata.release_date = datetime.fromisoformat(release_date)[0m
[30;1m535 | [0m[35m[0m
[30;1m536 | [0m[35m        # Set review if available[0m
[30;1m537 | [0m[35m        reviews = audiobook_data.get("editorial_reviews", [])[0m
[30;1m538 | [0m[35m        if reviews and reviews[0]:[0m
[30;1m539 | [0m[35m            book.metadata.review = _html_to_txt(str(reviews[0]))[0m
[30;1m540 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1876[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m529 | [0m[35m            str(audiobook_data.get("extended_product_description", ""))[0m
[30;1m530 | [0m[35m        )[0m
[30;1m531 | [0m[35m        book.metadata.languages = UniqueList([audiobook_data.get("language") or ""])[0m
[30;1m532 | [0m[35m        if release_date := audiobook_data.get("release_date"):[0m
[30;1m533 | [0m[35m            with suppress(ValueError):[0m
[30;1m534 | [0m[35m                book.metadata.release_date = datetime.fromisoformat(release_date)[0m
[30;1m535 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1877[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m528 | [0m[35m        book.metadata.description = _html_to_txt([0m
[30;1m529 | [0m[35m            str(audiobook_data.get("extended_product_description", ""))[0m
[30;1m530 | [0m[35m        )[0m
[30;1m531 | [0m[35m        book.metadata.languages = UniqueList([audiobook_data.get("language") or ""])[0m
[30;1m532 | [0m[35m        if release_date := audiobook_data.get("release_date"):[0m
[30;1m533 | [0m[35m            with suppress(ValueError):[0m
[30;1m534 | [0m[35m                book.metadata.release_date = datetime.fromisoformat(release_date)[0m

[31m--[ [0m[34mMatch #[0m[33m1878[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m526 | [0m[35m        # Set metadata[0m
[30;1m527 | [0m[35m        book.metadata.copyright = audiobook_data.get("copyright")[0m
[30;1m528 | [0m[35m        book.metadata.description = _html_to_txt([0m
[30;1m529 | [0m[35m            str(audiobook_data.get("extended_product_description", ""))[0m
[30;1m530 | [0m[35m        )[0m
[30;1m531 | [0m[35m        book.metadata.languages = UniqueList([audiobook_data.get("language") or ""])[0m
[30;1m532 | [0m[35m        if release_date := audiobook_data.get("release_date"):[0m

[31m--[ [0m[34mMatch #[0m[33m1879[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m524 | [0m[35m        )[0m
[30;1m525 | [0m[35m[0m
[30;1m526 | [0m[35m        # Set metadata[0m
[30;1m527 | [0m[35m        book.metadata.copyright = audiobook_data.get("copyright")[0m
[30;1m528 | [0m[35m        book.metadata.description = _html_to_txt([0m
[30;1m529 | [0m[35m            str(audiobook_data.get("extended_product_description", ""))[0m
[30;1m530 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1880[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m518 | [0m[35m                    provider_instance=self.provider_instance,[0m
[30;1m519 | [0m[35m                )[0m
[30;1m520 | [0m[35m            },[0m
[30;1m521 | [0m[35m            publisher=audiobook_data.get("publisher_name"),[0m
[30;1m522 | [0m[35m            authors=UniqueList(authors),[0m
[30;1m523 | [0m[35m            narrators=UniqueList(narrators),[0m
[30;1m524 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1881[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m500 | [0m[35m        # Get chapters and calculate duration[0m
[30;1m501 | [0m[35m        chapters_data = await self._fetch_chapters(asin=asin)[0m
[30;1m502 | [0m[35m        try:[0m
[30;1m503 | [0m[35m            duration = sum(chapter.get("length_ms", 0) for chapter in chapters_data) / 1000[0m
[30;1m504 | [0m[35m        except Exception as exc:[0m
[30;1m505 | [0m[35m            self.logger.warning(f"Error calculating duration for audiobook {asin}: {exc}")[0m
[30;1m506 | [0m[35m            duration = 0[0m

[31m--[ [0m[34mMatch #[0m[33m1882[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m495 | [0m[35m[0m
[30;1m496 | [0m[35m        # Parse authors and narrators[0m
[30;1m497 | [0m[35m        narrators = self._parse_contributors(audiobook_data.get("narrators"), "Unknown Narrator")[0m
[30;1m498 | [0m[35m        authors = self._parse_contributors(audiobook_data.get("authors"), "Unknown Author")[0m
[30;1m499 | [0m[35m[0m
[30;1m500 | [0m[35m        # Get chapters and calculate duration[0m
[30;1m501 | [0m[35m        chapters_data = await self._fetch_chapters(asin=asin)[0m

[31m--[ [0m[34mMatch #[0m[33m1883[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m494 | [0m[35m        title = audiobook_data.get("title", "")[0m
[30;1m495 | [0m[35m[0m
[30;1m496 | [0m[35m        # Parse authors and narrators[0m
[30;1m497 | [0m[35m        narrators = self._parse_contributors(audiobook_data.get("narrators"), "Unknown Narrator")[0m
[30;1m498 | [0m[35m        authors = self._parse_contributors(audiobook_data.get("authors"), "Unknown Author")[0m
[30;1m499 | [0m[35m[0m
[30;1m500 | [0m[35m        # Get chapters and calculate duration[0m

[31m--[ [0m[34mMatch #[0m[33m1884[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m491 | [0m[35m            raise MediaNotFoundError("Audiobook data not found")[0m
[30;1m492 | [0m[35m[0m
[30;1m493 | [0m[35m        asin = audiobook_data.get("asin", "")[0m
[30;1m494 | [0m[35m        title = audiobook_data.get("title", "")[0m
[30;1m495 | [0m[35m[0m
[30;1m496 | [0m[35m        # Parse authors and narrators[0m
[30;1m497 | [0m[35m        narrators = self._parse_contributors(audiobook_data.get("narrators"), "Unknown Narrator")[0m

[31m--[ [0m[34mMatch #[0m[33m1885[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m490 | [0m[35m            self.logger.error("Received None audiobook_data in _parse_audiobook")[0m
[30;1m491 | [0m[35m            raise MediaNotFoundError("Audiobook data not found")[0m
[30;1m492 | [0m[35m[0m
[30;1m493 | [0m[35m        asin = audiobook_data.get("asin", "")[0m
[30;1m494 | [0m[35m        title = audiobook_data.get("title", "")[0m
[30;1m495 | [0m[35m[0m
[30;1m496 | [0m[35m        # Parse authors and narrators[0m

[31m--[ [0m[34mMatch #[0m[33m1886[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m473 | [0m[35m        except (TypeError, ValueError):[0m
[30;1m474 | [0m[35m            length = 0[0m
[30;1m475 | [0m[35m[0m
[30;1m476 | [0m[35m        raw_title = chapter_data.get("title")[0m
[30;1m477 | [0m[35m        chapter_title: str[0m
[30;1m478 | [0m[35m        if raw_title is None:[0m
[30;1m479 | [0m[35m            chapter_title = f"Chapter {index + 1}"[0m

[31m--[ [0m[34mMatch #[0m[33m1887[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m469 | [0m[35m            start = 0[0m
[30;1m470 | [0m[35m[0m
[30;1m471 | [0m[35m        try:[0m
[30;1m472 | [0m[35m            length = int(chapter_data.get("length_ms", 0)) / 1000[0m
[30;1m473 | [0m[35m        except (TypeError, ValueError):[0m
[30;1m474 | [0m[35m            length = 0[0m
[30;1m475 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1888[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m464 | [0m[35m    def _parse_chapter_data(self, chapter_data: dict[str, Any], index: int) -> MediaItemChapter:[0m
[30;1m465 | [0m[35m        """Parse chapter data into MediaItemChapter object."""[0m
[30;1m466 | [0m[35m        try:[0m
[30;1m467 | [0m[35m            start = int(chapter_data.get("start_offset_sec", 0))[0m
[30;1m468 | [0m[35m        except (TypeError, ValueError):[0m
[30;1m469 | [0m[35m            start = 0[0m
[30;1m470 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1889[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m436 | [0m[35m        if isinstance(contributors, list):[0m
[30;1m437 | [0m[35m            for contributor in contributors:[0m
[30;1m438 | [0m[35m                if contributor and isinstance(contributor, dict):[0m
[30;1m439 | [0m[35m                    result.append(contributor.get("name", default_name))[0m
[30;1m440 | [0m[35m        return result[0m
[30;1m441 | [0m[35m[0m
[30;1m442 | [0m[35m    def _create_images(self, image_path: str | None) -> list[MediaItemImage]:[0m

[31m--[ [0m[34mMatch #[0m[33m1890[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m421 | [0m[35m                key=cache_key_with_params, base_key=CACHE_DOMAIN, category=CACHE_CATEGORY_API[0m
[30;1m422 | [0m[35m            )[0m
[30;1m423 | [0m[35m        if not response:[0m
[30;1m424 | [0m[35m            response = await self.client.get(path, **kwargs)[0m
[30;1m425 | [0m[35m            await self.mass.cache.set([0m
[30;1m426 | [0m[35m                key=cache_key_with_params, base_key=CACHE_DOMAIN, data=response[0m
[30;1m427 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m1891[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m417 | [0m[35m        params_hash = hashlib.md5(params_str.encode()).hexdigest()[0m
[30;1m418 | [0m[35m        cache_key_with_params = f"{path}:{params_hash}"[0m
[30;1m419 | [0m[35m        if use_cache:[0m
[30;1m420 | [0m[35m            response = await self.mass.cache.get([0m
[30;1m421 | [0m[35m                key=cache_key_with_params, base_key=CACHE_DOMAIN, category=CACHE_CATEGORY_API[0m
[30;1m422 | [0m[35m            )[0m
[30;1m423 | [0m[35m        if not response:[0m

[31m--[ [0m[34mMatch #[0m[33m1892[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m387 | [0m[35m            position_ms = pos * 1000[0m
[30;1m388 | [0m[35m[0m
[30;1m389 | [0m[35m            stream_details = await self.get_stream(asin=asin)[0m
[30;1m390 | [0m[35m            acr = stream_details.data.get("acr")[0m
[30;1m391 | [0m[35m[0m
[30;1m392 | [0m[35m            if not acr:[0m
[30;1m393 | [0m[35m                self.logger.warning(f"No ACR available for ASIN {asin}, cannot report position")[0m

[31m--[ [0m[34mMatch #[0m[33m1893[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m366 | [0m[35m                self.logger.debug(f"Invalid last_position for ASIN {asin}")[0m
[30;1m367 | [0m[35m                return 0[0m
[30;1m368 | [0m[35m[0m
[30;1m369 | [0m[35m            position_ms = last_position.get("position_ms", 0)[0m
[30;1m370 | [0m[35m            return int(position_ms)[0m
[30;1m371 | [0m[35m[0m
[30;1m372 | [0m[35m        except Exception as exc:[0m

[31m--[ [0m[34mMatch #[0m[33m1894[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m361 | [0m[35m                self.logger.debug(f"Invalid annotation for ASIN {asin}")[0m
[30;1m362 | [0m[35m                return 0[0m
[30;1m363 | [0m[35m[0m
[30;1m364 | [0m[35m            last_position = annotation.get("last_position_heard")[0m
[30;1m365 | [0m[35m            if not last_position or not isinstance(last_position, dict):[0m
[30;1m366 | [0m[35m                self.logger.debug(f"Invalid last_position for ASIN {asin}")[0m
[30;1m367 | [0m[35m                return 0[0m

[31m--[ [0m[34mMatch #[0m[33m1895[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m351 | [0m[35m                self.logger.debug(f"No last position data available for ASIN {asin}")[0m
[30;1m352 | [0m[35m                return 0[0m
[30;1m353 | [0m[35m[0m
[30;1m354 | [0m[35m            annotations = response.get("asin_last_position_heard_annots")[0m
[30;1m355 | [0m[35m            if not annotations or not isinstance(annotations, list) or len(annotations) == 0:[0m
[30;1m356 | [0m[35m                self.logger.debug(f"No annotations found for ASIN {asin}")[0m
[30;1m357 | [0m[35m                return 0[0m

[31m--[ [0m[34mMatch #[0m[33m1896[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m325 | [0m[35m                    self.logger.warning(f"No chapter_info for ASIN {asin}")[0m
[30;1m326 | [0m[35m                    return [][0m
[30;1m327 | [0m[35m[0m
[30;1m328 | [0m[35m                chapters_data = chapter_info.get("chapters") or [][0m
[30;1m329 | [0m[35m[0m
[30;1m330 | [0m[35m                await self.mass.cache.set([0m
[30;1m331 | [0m[35m                    base_key=CACHE_DOMAIN,[0m

[31m--[ [0m[34mMatch #[0m[33m1897[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m320 | [0m[35m                    self.logger.warning(f"No content_metadata for ASIN {asin}")[0m
[30;1m321 | [0m[35m                    return [][0m
[30;1m322 | [0m[35m[0m
[30;1m323 | [0m[35m                chapter_info = content_metadata.get("chapter_info")[0m
[30;1m324 | [0m[35m                if not chapter_info:[0m
[30;1m325 | [0m[35m                    self.logger.warning(f"No chapter_info for ASIN {asin}")[0m
[30;1m326 | [0m[35m                    return [][0m

[31m--[ [0m[34mMatch #[0m[33m1898[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m315 | [0m[35m                    self.logger.warning(f"Failed to get metadata for ASIN {asin}")[0m
[30;1m316 | [0m[35m                    return [][0m
[30;1m317 | [0m[35m[0m
[30;1m318 | [0m[35m                content_metadata = response.get("content_metadata")[0m
[30;1m319 | [0m[35m                if not content_metadata:[0m
[30;1m320 | [0m[35m                    self.logger.warning(f"No content_metadata for ASIN {asin}")[0m
[30;1m321 | [0m[35m                    return [][0m

[31m--[ [0m[34mMatch #[0m[33m1899[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m299 | [0m[35m            )[0m
[30;1m300 | [0m[35m            return [][0m
[30;1m301 | [0m[35m[0m
[30;1m302 | [0m[35m        chapters_data: list[Any] = await self.mass.cache.get([0m
[30;1m303 | [0m[35m            base_key=CACHE_DOMAIN, category=CACHE_CATEGORY_CHAPTERS, key=asin, default=[][0m
[30;1m304 | [0m[35m        )[0m
[30;1m305 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1900[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m273 | [0m[35m                self.logger.error(f"No license_response (stream URL) for ASIN {asin}")[0m
[30;1m274 | [0m[35m                raise ValueError(f"Missing stream URL for ASIN {asin}")[0m
[30;1m275 | [0m[35m[0m
[30;1m276 | [0m[35m            acr = content_license.get("acr", "")[0m
[30;1m277 | [0m[35m        except Exception as exc:[0m
[30;1m278 | [0m[35m            self.logger.error(f"Error getting stream details for ASIN {asin}: {exc}")[0m
[30;1m279 | [0m[35m            raise ValueError(f"Failed to get stream details: {exc}") from exc[0m

[31m--[ [0m[34mMatch #[0m[33m1901[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m268 | [0m[35m            content_reference = content_metadata.get("content_reference", {})[0m
[30;1m269 | [0m[35m            size = content_reference.get("content_size_in_bytes", 0)[0m
[30;1m270 | [0m[35m[0m
[30;1m271 | [0m[35m            m3u8_url = content_license.get("license_response")[0m
[30;1m272 | [0m[35m            if not m3u8_url:[0m
[30;1m273 | [0m[35m                self.logger.error(f"No license_response (stream URL) for ASIN {asin}")[0m
[30;1m274 | [0m[35m                raise ValueError(f"Missing stream URL for ASIN {asin}")[0m

[31m--[ [0m[34mMatch #[0m[33m1902[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m266 | [0m[35m[0m
[30;1m267 | [0m[35m            content_metadata = content_license.get("content_metadata", {})[0m
[30;1m268 | [0m[35m            content_reference = content_metadata.get("content_reference", {})[0m
[30;1m269 | [0m[35m            size = content_reference.get("content_size_in_bytes", 0)[0m
[30;1m270 | [0m[35m[0m
[30;1m271 | [0m[35m            m3u8_url = content_license.get("license_response")[0m
[30;1m272 | [0m[35m            if not m3u8_url:[0m

[31m--[ [0m[34mMatch #[0m[33m1903[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m265 | [0m[35m                raise ValueError(f"Missing content_license for ASIN {asin}")[0m
[30;1m266 | [0m[35m[0m
[30;1m267 | [0m[35m            content_metadata = content_license.get("content_metadata", {})[0m
[30;1m268 | [0m[35m            content_reference = content_metadata.get("content_reference", {})[0m
[30;1m269 | [0m[35m            size = content_reference.get("content_size_in_bytes", 0)[0m
[30;1m270 | [0m[35m[0m
[30;1m271 | [0m[35m            m3u8_url = content_license.get("license_response")[0m

[31m--[ [0m[34mMatch #[0m[33m1904[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m264 | [0m[35m                self.logger.error(f"No content_license in playback_info for ASIN {asin}")[0m
[30;1m265 | [0m[35m                raise ValueError(f"Missing content_license for ASIN {asin}")[0m
[30;1m266 | [0m[35m[0m
[30;1m267 | [0m[35m            content_metadata = content_license.get("content_metadata", {})[0m
[30;1m268 | [0m[35m            content_reference = content_metadata.get("content_reference", {})[0m
[30;1m269 | [0m[35m            size = content_reference.get("content_size_in_bytes", 0)[0m
[30;1m270 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1905[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m259 | [0m[35m                },[0m
[30;1m260 | [0m[35m            )[0m
[30;1m261 | [0m[35m[0m
[30;1m262 | [0m[35m            content_license = playback_info.get("content_license", {})[0m
[30;1m263 | [0m[35m            if not content_license:[0m
[30;1m264 | [0m[35m                self.logger.error(f"No content_license in playback_info for ASIN {asin}")[0m
[30;1m265 | [0m[35m                raise ValueError(f"Missing content_license for ASIN {asin}")[0m

[31m--[ [0m[34mMatch #[0m[33m1906[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m243 | [0m[35m                duration = 0[0m
[30;1m244 | [0m[35m[0m
[30;1m245 | [0m[35m        try:[0m
[30;1m246 | [0m[35m            playback_info = await self.client.post([0m
[30;1m247 | [0m[35m                f"content/{asin}/licenserequest",[0m
[30;1m248 | [0m[35m                body={[0m
[30;1m249 | [0m[35m                    "quality": "High",[0m

[31m--[ [0m[34mMatch #[0m[33m1907[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m237 | [0m[35m            duration = 0[0m
[30;1m238 | [0m[35m        else:[0m
[30;1m239 | [0m[35m            try:[0m
[30;1m240 | [0m[35m                duration = sum(chapter.get("length_ms", 0) for chapter in chapters) / 1000[0m
[30;1m241 | [0m[35m            except Exception as exc:[0m
[30;1m242 | [0m[35m                self.logger.warning(f"Error calculating duration for ASIN {asin}: {exc}")[0m
[30;1m243 | [0m[35m                duration = 0[0m

[31m--[ [0m[34mMatch #[0m[33m1908[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m213 | [0m[35m        if response is None:[0m
[30;1m214 | [0m[35m            raise MediaNotFoundError(f"Audiobook with ASIN {asin} not found")[0m
[30;1m215 | [0m[35m[0m
[30;1m216 | [0m[35m        item_data = response.get("item")[0m
[30;1m217 | [0m[35m        if item_data is None:[0m
[30;1m218 | [0m[35m            raise MediaNotFoundError(f"Audiobook data for ASIN {asin} is empty")[0m
[30;1m219 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1909[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m197 | [0m[35m    async def get_audiobook(self, asin: str, use_cache: bool = True) -> Audiobook:[0m
[30;1m198 | [0m[35m        """Fetch the audiobook by asin."""[0m
[30;1m199 | [0m[35m        if use_cache:[0m
[30;1m200 | [0m[35m            cached_book = await self.mass.cache.get([0m
[30;1m201 | [0m[35m                key=asin, base_key=CACHE_DOMAIN, category=CACHE_CATEGORY_AUDIOBOOK, default=None[0m
[30;1m202 | [0m[35m            )[0m
[30;1m203 | [0m[35m            if cached_book is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m1910[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m142 | [0m[35m            )[0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m            items = library.get("items", [])[0m
[30;1m145 | [0m[35m            total_items = library.get("total_results", 0)[0m
[30;1m146 | [0m[35m            self.logger.debug([0m
[30;1m147 | [0m[35m                "Audible: Got %s items (total reported by API: %s)", len(items), total_items[0m
[30;1m148 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m1911[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m141 | [0m[35m                num_results=page_size,[0m
[30;1m142 | [0m[35m            )[0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m            items = library.get("items", [])[0m
[30;1m145 | [0m[35m            total_items = library.get("total_results", 0)[0m
[30;1m146 | [0m[35m            self.logger.debug([0m
[30;1m147 | [0m[35m                "Audible: Got %s items (total reported by API: %s)", len(items), total_items[0m

[31m--[ [0m[34mMatch #[0m[33m1912[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m103 | [0m[35m            return None, total_processed + 1[0m
[30;1m104 | [0m[35m        except Exception as exc:[0m
[30;1m105 | [0m[35m            self.logger.warning([0m
[30;1m106 | [0m[35m                f"Error processing audiobook {audiobook_data.get('asin', 'unknown')}: {exc}"[0m
[30;1m107 | [0m[35m            )[0m
[30;1m108 | [0m[35m            return None, total_processed + 1[0m
[30;1m109 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1913[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m88 | [0m[35m        asin = str(audiobook_data.get("asin", ""))[0m
[30;1m89 | [0m[35m        cached_book = None[0m
[30;1m90 | [0m[35m        if asin:[0m
[30;1m91 | [0m[35m            cached_book = await self.mass.cache.get([0m
[30;1m92 | [0m[35m                key=asin, base_key=CACHE_DOMAIN, category=CACHE_CATEGORY_AUDIOBOOK, default=None[0m
[30;1m93 | [0m[35m            )[0m
[30;1m94 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1914[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m            return None, total_processed + 1[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m        # Ensure asin is a valid string[0m
[30;1m88 | [0m[35m        asin = str(audiobook_data.get("asin", ""))[0m
[30;1m89 | [0m[35m        cached_book = None[0m
[30;1m90 | [0m[35m        if asin:[0m
[30;1m91 | [0m[35m            cached_book = await self.mass.cache.get([0m

[31m--[ [0m[34mMatch #[0m[33m1915[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m79 | [0m[35m        if content_type not in ("SinglePartBook",):[0m
[30;1m80 | [0m[35m            self.logger.debug([0m
[30;1m81 | [0m[35m                "Skipping non-audiobook item: %s (%s)",[0m
[30;1m82 | [0m[35m                audiobook_data.get("title", "Unknown"),[0m
[30;1m83 | [0m[35m                content_type,[0m
[30;1m84 | [0m[35m            )[0m
[30;1m85 | [0m[35m            return None, total_processed + 1[0m

[31m--[ [0m[34mMatch #[0m[33m1916[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m75 | [0m[35m        self, audiobook_data: dict[str, Any], total_processed: int[0m
[30;1m76 | [0m[35m    ) -> tuple[Audiobook | None, int]:[0m
[30;1m77 | [0m[35m        """Process a single audiobook item from the library."""[0m
[30;1m78 | [0m[35m        content_type = audiobook_data.get("content_delivery_type", "")[0m
[30;1m79 | [0m[35m        if content_type not in ("SinglePartBook",):[0m
[30;1m80 | [0m[35m            self.logger.debug([0m
[30;1m81 | [0m[35m                "Skipping non-audiobook item: %s (%s)",[0m

[31m--[ [0m[34mMatch #[0m[33m1917[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1533 | [0m[35m        prev_volumes: dict[str, int] = {}[0m
[30;1m1534 | [0m[35m        async with TaskManager(self.mass) as tg:[0m
[30;1m1535 | [0m[35m            for volume_player_id in player.group_childs or (player.player_id,):[0m
[30;1m1536 | [0m[35m                if not (volume_player := self.get(volume_player_id)):[0m
[30;1m1537 | [0m[35m                    continue[0m
[30;1m1538 | [0m[35m                # catch any players that have a different source active[0m
[30;1m1539 | [0m[35m                if ([0m

[31m--[ [0m[34mMatch #[0m[33m1918[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1507 | [0m[35m        prev_state = player.state[0m
[30;1m1508 | [0m[35m        prev_synced_to = player.synced_to[0m
[30;1m1509 | [0m[35m        prev_active_source = player.active_source[0m
[30;1m1510 | [0m[35m        queue = self.mass.player_queues.get(player.active_source)[0m
[30;1m1511 | [0m[35m        prev_queue_active = queue and queue.active[0m
[30;1m1512 | [0m[35m        prev_media = player.current_media[0m
[30;1m1513 | [0m[35m        prev_media_name = prev_media.title or prev_media.uri if prev_media else None[0m

[31m--[ [0m[34mMatch #[0m[33m1919[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1474 | [0m[35m        player.icon = config.get_value(CONF_ENTRY_PLAYER_ICON.key)[0m
[30;1m1475 | [0m[35m        player.power_control = config.get_value(CONF_POWER_CONTROL)[0m
[30;1m1476 | [0m[35m        if player.power_control == PLAYER_CONTROL_FAKE:[0m
[30;1m1477 | [0m[35m            player.powered = await self.mass.cache.get([0m
[30;1m1478 | [0m[35m                player.player_id,[0m
[30;1m1479 | [0m[35m                default=False,[0m
[30;1m1480 | [0m[35m                category=CACHE_CATEGORY_PLAYERS,[0m

[31m--[ [0m[34mMatch #[0m[33m1920[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1460 | [0m[35m            player.group_childs.clear()[0m
[30;1m1461 | [0m[35m        if player.active_group and (group_player := self.get(player.active_group)):[0m
[30;1m1462 | [0m[35m            # remove player from group if its part of a group[0m
[30;1m1463 | [0m[35m            group_player = self.get(player.active_group)[0m
[30;1m1464 | [0m[35m            if player.player_id in group_player.group_childs:[0m
[30;1m1465 | [0m[35m                group_player.group_childs.remove(player.player_id)[0m
[30;1m1466 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1921[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1458 | [0m[35m                # also set this optimistically because the above command will most likely fail[0m
[30;1m1459 | [0m[35m                child_player.synced_to = None[0m
[30;1m1460 | [0m[35m            player.group_childs.clear()[0m
[30;1m1461 | [0m[35m        if player.active_group and (group_player := self.get(player.active_group)):[0m
[30;1m1462 | [0m[35m            # remove player from group if its part of a group[0m
[30;1m1463 | [0m[35m            group_player = self.get(player.active_group)[0m
[30;1m1464 | [0m[35m            if player.player_id in group_player.group_childs:[0m

[31m--[ [0m[34mMatch #[0m[33m1922[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1453 | [0m[35m        for group_child_id in player.group_childs:[0m
[30;1m1454 | [0m[35m            if group_child_id == player.player_id:[0m
[30;1m1455 | [0m[35m                continue[0m
[30;1m1456 | [0m[35m            if child_player := self.get(group_child_id):[0m
[30;1m1457 | [0m[35m                self.mass.create_task(self.cmd_power(group_child_id, False, True))[0m
[30;1m1458 | [0m[35m                # also set this optimistically because the above command will most likely fail[0m
[30;1m1459 | [0m[35m                child_player.synced_to = None[0m

[31m--[ [0m[34mMatch #[0m[33m1923[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1401 | [0m[35m        if player.synced_to and (parent_player := self.get(player.synced_to)):[0m
[30;1m1402 | [0m[35m            return parent_player.active_source[0m
[30;1m1403 | [0m[35m        # if player has group active, return those details[0m
[30;1m1404 | [0m[35m        if player.active_group and (group_player := self.get(player.active_group)):[0m
[30;1m1405 | [0m[35m            return self._get_active_source(group_player)[0m
[30;1m1406 | [0m[35m        # if player has plugin source active return that[0m
[30;1m1407 | [0m[35m        for plugin_source in self._get_plugin_sources():[0m

[31m--[ [0m[34mMatch #[0m[33m1924[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1398 | [0m[35m    def _get_active_source(self, player: Player) -> str:[0m
[30;1m1399 | [0m[35m        """Return the active_source id for given player."""[0m
[30;1m1400 | [0m[35m        # if player is synced, return group leader's active source[0m
[30;1m1401 | [0m[35m        if player.synced_to and (parent_player := self.get(player.synced_to)):[0m
[30;1m1402 | [0m[35m            return parent_player.active_source[0m
[30;1m1403 | [0m[35m        # if player has group active, return those details[0m
[30;1m1404 | [0m[35m        if player.active_group and (group_player := self.get(player.active_group)):[0m

[31m--[ [0m[34mMatch #[0m[33m1925[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1369 | [0m[35m                sync_leader.name,[0m
[30;1m1370 | [0m[35m            )[0m
[30;1m1371 | [0m[35m            return sync_leader[0m
[30;1m1372 | [0m[35m        if player.active_group and (active_group := self.get(player.active_group)):[0m
[30;1m1373 | [0m[35m            self.logger.info([0m
[30;1m1374 | [0m[35m                "Player %s is part of a playergroup and can not accept "[0m
[30;1m1375 | [0m[35m                "playback related commands itself, "[0m

[31m--[ [0m[34mMatch #[0m[33m1926[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1360 | [0m[35m    def _get_player_with_redirect(self, player_id: str) -> Player:[0m
[30;1m1361 | [0m[35m        """Get player with check if playback related command should be redirected."""[0m
[30;1m1362 | [0m[35m        player = self.get(player_id, True)[0m
[30;1m1363 | [0m[35m        if player.synced_to and (sync_leader := self.get(player.synced_to)):[0m
[30;1m1364 | [0m[35m            self.logger.info([0m
[30;1m1365 | [0m[35m                "Player %s is synced to %s and can not accept "[0m
[30;1m1366 | [0m[35m                "playback related commands itself, "[0m

[31m--[ [0m[34mMatch #[0m[33m1927[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1359 | [0m[35m[0m
[30;1m1360 | [0m[35m    def _get_player_with_redirect(self, player_id: str) -> Player:[0m
[30;1m1361 | [0m[35m        """Get player with check if playback related command should be redirected."""[0m
[30;1m1362 | [0m[35m        player = self.get(player_id, True)[0m
[30;1m1363 | [0m[35m        if player.synced_to and (sync_leader := self.get(player.synced_to)):[0m
[30;1m1364 | [0m[35m            self.logger.info([0m
[30;1m1365 | [0m[35m                "Player %s is synced to %s and can not accept "[0m

[31m--[ [0m[34mMatch #[0m[33m1928[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1350 | [0m[35m    async def on_player_dsp_change(self, player_id: str) -> None:[0m
[30;1m1351 | [0m[35m        """Call (by config manager) when the DSP settings of a player change."""[0m
[30;1m1352 | [0m[35m        # signal player provider that the config changed[0m
[30;1m1353 | [0m[35m        if not (player := self.get(player_id)):[0m
[30;1m1354 | [0m[35m            return[0m
[30;1m1355 | [0m[35m        if player.state == PlayerState.PLAYING:[0m
[30;1m1356 | [0m[35m            self.logger.info("Restarting playback of Player %s after DSP change", player_id)[0m

[31m--[ [0m[34mMatch #[0m[33m1929[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1339 | [0m[35m        # check for group memberships that need to be updated[0m
[30;1m1340 | [0m[35m        if player_disabled and player.active_group and player_provider:[0m
[30;1m1341 | [0m[35m            # try to remove from the group[0m
[30;1m1342 | [0m[35m            group_player = self.get(player.active_group)[0m
[30;1m1343 | [0m[35m            with suppress(UnsupportedFeaturedException, PlayerCommandFailed):[0m
[30;1m1344 | [0m[35m                await player_provider.set_members([0m
[30;1m1345 | [0m[35m                    player.active_group,[0m

[31m--[ [0m[34mMatch #[0m[33m1930[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1318 | [0m[35m            return[0m
[30;1m1319 | [0m[35m        # ensure player state gets updated with any updated config[0m
[30;1m1320 | [0m[35m        await self._set_player_state_from_config(player, config)[0m
[30;1m1321 | [0m[35m        resume_queue: PlayerQueue | None = self.mass.player_queues.get(player.active_source)[0m
[30;1m1322 | [0m[35m        # signal player provider that the config changed[0m
[30;1m1323 | [0m[35m        if player_provider := self.mass.get_provider(config.provider):[0m
[30;1m1324 | [0m[35m            with suppress(PlayerUnavailableError):[0m

[31m--[ [0m[34mMatch #[0m[33m1931[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1314 | [0m[35m    async def on_player_config_change(self, config: PlayerConfig, changed_keys: set[str]) -> None:[0m
[30;1m1315 | [0m[35m        """Call (by config manager) when the configuration of a player changes."""[0m
[30;1m1316 | [0m[35m        player_disabled = "enabled" in changed_keys and not config.enabled[0m
[30;1m1317 | [0m[35m        if not (player := self.get(config.player_id)):[0m
[30;1m1318 | [0m[35m            return[0m
[30;1m1319 | [0m[35m        # ensure player state gets updated with any updated config[0m
[30;1m1320 | [0m[35m        await self._set_player_state_from_config(player, config)[0m

[31m--[ [0m[34mMatch #[0m[33m1932[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1253 | [0m[35m    ) -> Iterator[Player]:[0m
[30;1m1254 | [0m[35m        """Get (child) players attached to a group player or syncgroup."""[0m
[30;1m1255 | [0m[35m        for child_id in list(group_player.group_childs):[0m
[30;1m1256 | [0m[35m            if child_player := self.get(child_id, False):[0m
[30;1m1257 | [0m[35m                if not child_player.available or not child_player.enabled:[0m
[30;1m1258 | [0m[35m                    continue[0m
[30;1m1259 | [0m[35m                if only_powered and child_player.powered is False:[0m

[31m--[ [0m[34mMatch #[0m[33m1933[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1227 | [0m[35m            player = self.get(player_id)[0m
[30;1m1228 | [0m[35m            volume_level = player.volume_level + volume_strategy_volume[0m
[30;1m1229 | [0m[35m        elif volume_level is None and volume_strategy == "percentual":[0m
[30;1m1230 | [0m[35m            player = self.get(player_id)[0m
[30;1m1231 | [0m[35m            percentual = (player.volume_level / 100) * volume_strategy_volume[0m
[30;1m1232 | [0m[35m            volume_level = player.volume_level + percentual[0m
[30;1m1233 | [0m[35m        if volume_level is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m1934[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1221 | [0m[35m        if volume_level is None and volume_strategy == "absolute":[0m
[30;1m1222 | [0m[35m            volume_level = volume_strategy_volume[0m
[30;1m1223 | [0m[35m        elif volume_level is None and volume_strategy == "relative":[0m
[30;1m1224 | [0m[35m            player = self.get(player_id)[0m
[30;1m1225 | [0m[35m            volume_level = player.volume_level + volume_strategy_volume[0m
[30;1m1226 | [0m[35m        elif volume_level is None and volume_strategy == "percentual":[0m
[30;1m1227 | [0m[35m            player = self.get(player_id)[0m

[31m--[ [0m[34mMatch #[0m[33m1935[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1110 | [0m[35m                        dsp_enabled = self.mass.config.get_player_dsp_config(childs[0]).enabled[0m
[30;1m1111 | [0m[35m                    else:[0m
[30;1m1112 | [0m[35m                        dsp_enabled = False[0m
[30;1m1113 | [0m[35m                elif childs := prev_state.get("group_childs"):[0m
[30;1m1114 | [0m[35m                    # We grew the group from a single player to multiple players,[0m
[30;1m1115 | [0m[35m                    # let's see if the previous single player had DSP enabled[0m
[30;1m1116 | [0m[35m                    dsp_enabled = self.mass.config.get_player_dsp_config(childs[0]).enabled[0m

[31m--[ [0m[34mMatch #[0m[33m1936[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1104 | [0m[35m                # Since player groups do not have leaders, we will use the only child[0m
[30;1m1105 | [0m[35m                # that was in the group before and after the change[0m
[30;1m1106 | [0m[35m                if prev_is_multiple_devices:[0m
[30;1m1107 | [0m[35m                    if childs := new_state.get("group_childs"):[0m
[30;1m1108 | [0m[35m                        # We shrank the group from multiple players to a single player[0m
[30;1m1109 | [0m[35m                        # So the now only child will control the DSP[0m
[30;1m1110 | [0m[35m                        dsp_enabled = self.mass.config.get_player_dsp_config(childs[0]).enabled[0m

[31m--[ [0m[34mMatch #[0m[33m1937[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1087 | [0m[35m[0m
[30;1m1088 | [0m[35m        # handle DSP reload of the leader when on grouping and ungrouping[0m
[30;1m1089 | [0m[35m        prev_child_count = len(prev_state.get("group_childs", []))[0m
[30;1m1090 | [0m[35m        new_child_count = len(new_state.get("group_childs", []))[0m
[30;1m1091 | [0m[35m        is_player_group = player.provider.startswith("player_group")[0m
[30;1m1092 | [0m[35m[0m
[30;1m1093 | [0m[35m        # handle special case for PlayerGroups: since there are no leaders,[0m

[31m--[ [0m[34mMatch #[0m[33m1938[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1086 | [0m[35m            return[0m
[30;1m1087 | [0m[35m[0m
[30;1m1088 | [0m[35m        # handle DSP reload of the leader when on grouping and ungrouping[0m
[30;1m1089 | [0m[35m        prev_child_count = len(prev_state.get("group_childs", []))[0m
[30;1m1090 | [0m[35m        new_child_count = len(new_state.get("group_childs", []))[0m
[30;1m1091 | [0m[35m        is_player_group = player.provider.startswith("player_group")[0m
[30;1m1092 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1939[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1044 | [0m[35m        # Auto correct player state if player is synced (or group child)[0m
[30;1m1045 | [0m[35m        # This is because some players/providers do not accurately update this info[0m
[30;1m1046 | [0m[35m        # for the sync child's.[0m
[30;1m1047 | [0m[35m        if player.synced_to and (sync_leader := self.get(player.synced_to)):[0m
[30;1m1048 | [0m[35m            player.state = sync_leader.state[0m
[30;1m1049 | [0m[35m            player.elapsed_time = sync_leader.elapsed_time[0m
[30;1m1050 | [0m[35m            player.elapsed_time_last_updated = sync_leader.elapsed_time_last_updated[0m

[31m--[ [0m[34mMatch #[0m[33m1940[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1028 | [0m[35m        if player.mute_control == PLAYER_CONTROL_NONE:[0m
[30;1m1029 | [0m[35m            player.volume_muted = None[0m
[30;1m1030 | [0m[35m        elif player.mute_control not in (PLAYER_CONTROL_NATIVE, PLAYER_CONTROL_FAKE):[0m
[30;1m1031 | [0m[35m            if player_control := self._controls.get(player.mute_control):[0m
[30;1m1032 | [0m[35m                player.volume_muted = player_control.volume_muted[0m
[30;1m1033 | [0m[35m        # correct group_members if needed[0m
[30;1m1034 | [0m[35m        if player.group_childs == [player.player_id]:[0m

[31m--[ [0m[34mMatch #[0m[33m1941[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1023 | [0m[35m        if player.volume_control == PLAYER_CONTROL_NONE:[0m
[30;1m1024 | [0m[35m            player.volume_level = None[0m
[30;1m1025 | [0m[35m        elif player.volume_control != PLAYER_CONTROL_NATIVE:[0m
[30;1m1026 | [0m[35m            if player_control := self._controls.get(player.volume_control):[0m
[30;1m1027 | [0m[35m                player.volume_level = player_control.volume_level[0m
[30;1m1028 | [0m[35m        if player.mute_control == PLAYER_CONTROL_NONE:[0m
[30;1m1029 | [0m[35m            player.volume_muted = None[0m

[31m--[ [0m[34mMatch #[0m[33m1942[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1018 | [0m[35m        elif player.power_control == PLAYER_CONTROL_FAKE:[0m
[30;1m1019 | [0m[35m            player.powered = False if player.powered is None else player.powered[0m
[30;1m1020 | [0m[35m        elif player.power_control != PLAYER_CONTROL_NATIVE:[0m
[30;1m1021 | [0m[35m            if player_control := self._controls.get(player.power_control):[0m
[30;1m1022 | [0m[35m                player.powered = player_control.power_state[0m
[30;1m1023 | [0m[35m        if player.volume_control == PLAYER_CONTROL_NONE:[0m
[30;1m1024 | [0m[35m            player.volume_level = None[0m

[31m--[ [0m[34mMatch #[0m[33m1943[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1001 | [0m[35m        if player_id not in self._players:[0m
[30;1m1002 | [0m[35m            return[0m
[30;1m1003 | [0m[35m        player = self._players[player_id][0m
[30;1m1004 | [0m[35m        prev_state = self._prev_states.get(player_id, {})[0m
[30;1m1005 | [0m[35m        player.active_source = self._get_active_source(player)[0m
[30;1m1006 | [0m[35m        # set player sources[0m
[30;1m1007 | [0m[35m        self._set_player_sources(player)[0m

[31m--[ [0m[34mMatch #[0m[33m1944[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m968 | [0m[35m        if self.mass.closing:[0m
[30;1m969 | [0m[35m            return[0m
[30;1m970 | [0m[35m[0m
[30;1m971 | [0m[35m        if (existing := self.get(player.player_id)) and not existing.available and player.available:[0m
[30;1m972 | [0m[35m            # player was previously unavailable, but is now available again[0m
[30;1m973 | [0m[35m            self.logger.info("Player %s is available again", player.name)[0m
[30;1m974 | [0m[35m            del self._players[player.player_id][0m

[31m--[ [0m[34mMatch #[0m[33m1945[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m936 | [0m[35m        # mark player as unavailable during the add process[0m
[30;1m937 | [0m[35m        player_available = player.available[0m
[30;1m938 | [0m[35m        player.available = False[0m
[30;1m939 | [0m[35m        player.enabled = self.mass.config.get(f"{CONF_PLAYERS}/{player_id}/enabled", True)[0m
[30;1m940 | [0m[35m[0m
[30;1m941 | [0m[35m        # ignore disabled players[0m
[30;1m942 | [0m[35m        if not player.enabled:[0m

[31m--[ [0m[34mMatch #[0m[33m1946[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m853 | [0m[35m[0m
[30;1m854 | [0m[35m        if ([0m
[30;1m855 | [0m[35m            player.active_group[0m
[30;1m856 | [0m[35m            and (group_player := self.get(player.active_group))[0m
[30;1m857 | [0m[35m            and ([0m
[30;1m858 | [0m[35m                PlayerFeature.SET_MEMBERS in group_player.supported_features[0m
[30;1m859 | [0m[35m                or group_player.provider.startswith("player_group")[0m

[31m--[ [0m[34mMatch #[0m[33m1947[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m847 | [0m[35m[0m
[30;1m848 | [0m[35m            - player_id: player_id of the player to handle the command.[0m
[30;1m849 | [0m[35m        """[0m
[30;1m850 | [0m[35m        if not (player := self.get(player_id)):[0m
[30;1m851 | [0m[35m            self.logger.warning("Player %s is not available", player_id)[0m
[30;1m852 | [0m[35m            return[0m
[30;1m853 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1948[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m790 | [0m[35m        for child_player_id in child_player_ids:[0m
[30;1m791 | [0m[35m            if child_player_id == target_player:[0m
[30;1m792 | [0m[35m                continue[0m
[30;1m793 | [0m[35m            if not (child_player := self.get(child_player_id)) or not child_player.available:[0m
[30;1m794 | [0m[35m                self.logger.warning("Player %s is not available", child_player_id)[0m
[30;1m795 | [0m[35m                continue[0m
[30;1m796 | [0m[35m            # check if player can be synced/grouped with the target player[0m

[31m--[ [0m[34mMatch #[0m[33m1949[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m772 | [0m[35m    @api_command("players/cmd/group_many")[0m
[30;1m773 | [0m[35m    async def cmd_group_many(self, target_player: str, child_player_ids: list[str]) -> None:[0m
[30;1m774 | [0m[35m        """Join given player(s) to target player."""[0m
[30;1m775 | [0m[35m        parent_player: Player = self.get(target_player, True)[0m
[30;1m776 | [0m[35m        prev_group_childs = parent_player.group_childs.copy()[0m
[30;1m777 | [0m[35m        if PlayerFeature.SET_MEMBERS not in parent_player.supported_features:[0m
[30;1m778 | [0m[35m            msg = f"Player {parent_player.name} does not support group commands"[0m

[31m--[ [0m[34mMatch #[0m[33m1950[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m746 | [0m[35m[0m
[30;1m747 | [0m[35m    async def enqueue_next_media(self, player_id: str, media: PlayerMedia) -> None:[0m
[30;1m748 | [0m[35m        """Handle enqueuing of a next media item on the player."""[0m
[30;1m749 | [0m[35m        player = self.get(player_id, raise_unavailable=True)[0m
[30;1m750 | [0m[35m        if PlayerFeature.ENQUEUE not in player.supported_features:[0m
[30;1m751 | [0m[35m            raise UnsupportedFeaturedException([0m
[30;1m752 | [0m[35m                f"Player {player.display_name} does not support enqueueing"[0m

[31m--[ [0m[34mMatch #[0m[33m1951[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m726 | [0m[35m            return[0m
[30;1m727 | [0m[35m        # check if source is a mass queue[0m
[30;1m728 | [0m[35m        # this can be used to restore the queue after a source switch[0m
[30;1m729 | [0m[35m        if mass_queue := self.mass.player_queues.get(source):[0m
[30;1m730 | [0m[35m            player.active_source = mass_queue.queue_id[0m
[30;1m731 | [0m[35m            self.update(player_id)[0m
[30;1m732 | [0m[35m            return[0m

[31m--[ [0m[34mMatch #[0m[33m1952[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m707 | [0m[35m        - player_id: player_id of the player to handle the command.[0m
[30;1m708 | [0m[35m        - source: The ID of the source that needs to be activated/selected.[0m
[30;1m709 | [0m[35m        """[0m
[30;1m710 | [0m[35m        player = self.get(player_id, True)[0m
[30;1m711 | [0m[35m        if player.synced_to or player.active_group:[0m
[30;1m712 | [0m[35m            raise PlayerCommandFailed(f"Player {player.display_name} is currently grouped")[0m
[30;1m713 | [0m[35m        # check if player is already playing and source is different[0m

[31m--[ [0m[34mMatch #[0m[33m1953[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m615 | [0m[35m        volume_level: int | None = None,[0m
[30;1m616 | [0m[35m    ) -> None:[0m
[30;1m617 | [0m[35m        """Handle playback of an announcement (url) on given player."""[0m
[30;1m618 | [0m[35m        player = self.get(player_id, True)[0m
[30;1m619 | [0m[35m        if not url.startswith("http"):[0m
[30;1m620 | [0m[35m            raise PlayerCommandFailed("Only URLs are supported for announcements")[0m
[30;1m621 | [0m[35m        # prevent multiple announcements at the same time to the same player with a lock[0m

[31m--[ [0m[34mMatch #[0m[33m1954[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m596 | [0m[35m                await self.cmd_volume_set(player_id, player.previous_volume_level)[0m
[30;1m597 | [0m[35m        else:[0m
[30;1m598 | [0m[35m            # handle external player control[0m
[30;1m599 | [0m[35m            player_control = self._controls.get(player.mute_control)[0m
[30;1m600 | [0m[35m            control_name = player_control.name if player_control else player.mute_control[0m
[30;1m601 | [0m[35m            self.logger.debug("Redirecting mute command to PlayerControl %s", control_name)[0m
[30;1m602 | [0m[35m            if not player_control or not player_control.supports_mute:[0m

[31m--[ [0m[34mMatch #[0m[33m1955[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m570 | [0m[35m        - player_id: player_id of the player to handle the command.[0m
[30;1m571 | [0m[35m        - muted: bool if player should be muted.[0m
[30;1m572 | [0m[35m        """[0m
[30;1m573 | [0m[35m        player = self.get(player_id, True)[0m
[30;1m574 | [0m[35m        assert player[0m
[30;1m575 | [0m[35m        if player.mute_control == PLAYER_CONTROL_NONE:[0m
[30;1m576 | [0m[35m            raise UnsupportedFeaturedException([0m

[31m--[ [0m[34mMatch #[0m[33m1956[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m550 | [0m[35m[0m
[30;1m551 | [0m[35m        - player_id: player_id of the player to handle the command.[0m
[30;1m552 | [0m[35m        """[0m
[30;1m553 | [0m[35m        group_player = self.get(player_id, True)[0m
[30;1m554 | [0m[35m        assert group_player[0m
[30;1m555 | [0m[35m        cur_volume = group_player.group_volume[0m
[30;1m556 | [0m[35m        if cur_volume < 5 or cur_volume > 95:[0m

[31m--[ [0m[34mMatch #[0m[33m1957[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m531 | [0m[35m[0m
[30;1m532 | [0m[35m        - player_id: player_id of the player to handle the command.[0m
[30;1m533 | [0m[35m        """[0m
[30;1m534 | [0m[35m        group_player = self.get(player_id, True)[0m
[30;1m535 | [0m[35m        assert group_player[0m
[30;1m536 | [0m[35m        cur_volume = group_player.group_volume[0m
[30;1m537 | [0m[35m        if cur_volume < 5 or cur_volume > 95:[0m

[31m--[ [0m[34mMatch #[0m[33m1958[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m505 | [0m[35m            - player_id: player_id of the playergroup to handle the command.[0m
[30;1m506 | [0m[35m            - volume_level: volume level (0..100) to set on the player.[0m
[30;1m507 | [0m[35m        """[0m
[30;1m508 | [0m[35m        group_player = self.get(player_id, True)[0m
[30;1m509 | [0m[35m        assert group_player[0m
[30;1m510 | [0m[35m        # handle group volume by only applying the volume to powered members[0m
[30;1m511 | [0m[35m        cur_volume = group_player.group_volume[0m

[31m--[ [0m[34mMatch #[0m[33m1959[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m485 | [0m[35m[0m
[30;1m486 | [0m[35m        - player_id: player_id of the player to handle the command.[0m
[30;1m487 | [0m[35m        """[0m
[30;1m488 | [0m[35m        if not (player := self.get(player_id)):[0m
[30;1m489 | [0m[35m            return[0m
[30;1m490 | [0m[35m        if player.volume_level < 5 or player.volume_level > 95:[0m
[30;1m491 | [0m[35m            step_size = 1[0m

[31m--[ [0m[34mMatch #[0m[33m1960[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m467 | [0m[35m[0m
[30;1m468 | [0m[35m        - player_id: player_id of the player to handle the command.[0m
[30;1m469 | [0m[35m        """[0m
[30;1m470 | [0m[35m        if not (player := self.get(player_id)):[0m
[30;1m471 | [0m[35m            return[0m
[30;1m472 | [0m[35m        if player.volume_level < 5 or player.volume_level > 95:[0m
[30;1m473 | [0m[35m            step_size = 1[0m

[31m--[ [0m[34mMatch #[0m[33m1961[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m450 | [0m[35m                await player_provider.cmd_volume_set(player_id, volume_level)[0m
[30;1m451 | [0m[35m        else:[0m
[30;1m452 | [0m[35m            # handle external player control[0m
[30;1m453 | [0m[35m            player_control = self._controls.get(player.volume_control)[0m
[30;1m454 | [0m[35m            control_name = player_control.name if player_control else player.volume_control[0m
[30;1m455 | [0m[35m            self.logger.debug("Redirecting volume command to PlayerControl %s", control_name)[0m
[30;1m456 | [0m[35m            if not player_control or not player_control.supports_volume:[0m

[31m--[ [0m[34mMatch #[0m[33m1962[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m433 | [0m[35m        - volume_level: volume level (0..100) to set on the player.[0m
[30;1m434 | [0m[35m        """[0m
[30;1m435 | [0m[35m        # TODO: Implement PlayerControl[0m
[30;1m436 | [0m[35m        player = self.get(player_id, True)[0m
[30;1m437 | [0m[35m        if player.type == PlayerType.GROUP:[0m
[30;1m438 | [0m[35m            # redirect to group volume control[0m
[30;1m439 | [0m[35m            await self.cmd_group_volume(player_id, volume_level)[0m

[31m--[ [0m[34mMatch #[0m[33m1963[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m392 | [0m[35m            await asyncio.sleep(0.2)[0m
[30;1m393 | [0m[35m        else:[0m
[30;1m394 | [0m[35m            # handle external player control[0m
[30;1m395 | [0m[35m            player_control = self._controls.get(player.power_control)[0m
[30;1m396 | [0m[35m            control_name = player_control.name if player_control else player.power_control[0m
[30;1m397 | [0m[35m            self.logger.debug("Redirecting power command to PlayerControl %s", control_name)[0m
[30;1m398 | [0m[35m            if not player_control or not player_control.supports_power:[0m

[31m--[ [0m[34mMatch #[0m[33m1964[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m344 | [0m[35m        - player_id: player_id of the player to handle the command.[0m
[30;1m345 | [0m[35m        - powered: bool if player should be powered on or off.[0m
[30;1m346 | [0m[35m        """[0m
[30;1m347 | [0m[35m        player = self.get(player_id, True)[0m
[30;1m348 | [0m[35m[0m
[30;1m349 | [0m[35m        if player.powered == powered:[0m
[30;1m350 | [0m[35m            return  # nothing to do[0m

[31m--[ [0m[34mMatch #[0m[33m1965[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m318 | [0m[35m        """Handle PREVIOUS TRACK command for given player."""[0m
[30;1m319 | [0m[35m        player = self._get_player_with_redirect(player_id)[0m
[30;1m320 | [0m[35m        active_source_id = player.active_source or player.player_id[0m
[30;1m321 | [0m[35m        if active_queue := self.mass.player_queues.get(active_source_id):[0m
[30;1m322 | [0m[35m            # active source is a MA queue[0m
[30;1m323 | [0m[35m            await self.mass.player_queues.previous(active_queue.queue_id)[0m
[30;1m324 | [0m[35m            return[0m

[31m--[ [0m[34mMatch #[0m[33m1966[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m295 | [0m[35m        player = self._get_player_with_redirect(player_id)[0m
[30;1m296 | [0m[35m        active_source_id = player.active_source or player.player_id[0m
[30;1m297 | [0m[35m[0m
[30;1m298 | [0m[35m        if active_queue := self.mass.player_queues.get(active_source_id):[0m
[30;1m299 | [0m[35m            # active source is a MA queue[0m
[30;1m300 | [0m[35m            await self.mass.player_queues.next(active_queue.queue_id)[0m
[30;1m301 | [0m[35m            return[0m

[31m--[ [0m[34mMatch #[0m[33m1967[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m280 | [0m[35m        player = self._get_player_with_redirect(player_id)[0m
[30;1m281 | [0m[35m        # Redirect to queue controller if it is active[0m
[30;1m282 | [0m[35m        active_source = player.active_source or player.player_id[0m
[30;1m283 | [0m[35m        if active_queue := self.mass.player_queues.get(active_source):[0m
[30;1m284 | [0m[35m            await self.mass.player_queues.seek(active_queue.queue_id, position)[0m
[30;1m285 | [0m[35m            return[0m
[30;1m286 | [0m[35m        if PlayerFeature.SEEK not in player.supported_features:[0m

[31m--[ [0m[34mMatch #[0m[33m1968[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m244 | [0m[35m        """[0m
[30;1m245 | [0m[35m        player = self._get_player_with_redirect(player_id)[0m
[30;1m246 | [0m[35m        # Redirect to queue controller if it is active[0m
[30;1m247 | [0m[35m        if active_queue := self.mass.player_queues.get(player.active_source):[0m
[30;1m248 | [0m[35m            await self.mass.player_queues.pause(active_queue.queue_id)[0m
[30;1m249 | [0m[35m            return[0m
[30;1m250 | [0m[35m        if PlayerFeature.PAUSE not in player.supported_features:[0m

[31m--[ [0m[34mMatch #[0m[33m1969[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m227 | [0m[35m            return[0m
[30;1m228 | [0m[35m        # Redirect to queue controller if it is active[0m
[30;1m229 | [0m[35m        active_source = player.active_source or player.player_id[0m
[30;1m230 | [0m[35m        if (active_queue := self.mass.player_queues.get(active_source)) and active_queue.items:[0m
[30;1m231 | [0m[35m            await self.mass.player_queues.play(active_queue.queue_id)[0m
[30;1m232 | [0m[35m            return[0m
[30;1m233 | [0m[35m        # send to player provider[0m

[31m--[ [0m[34mMatch #[0m[33m1970[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m204 | [0m[35m        """[0m
[30;1m205 | [0m[35m        player = self._get_player_with_redirect(player_id)[0m
[30;1m206 | [0m[35m        # Redirect to queue controller if it is active[0m
[30;1m207 | [0m[35m        if active_queue := self.mass.player_queues.get(player.active_source):[0m
[30;1m208 | [0m[35m            await self.mass.player_queues.stop(active_queue.queue_id)[0m
[30;1m209 | [0m[35m            return[0m
[30;1m210 | [0m[35m        # send to player provider[0m

[31m--[ [0m[34mMatch #[0m[33m1971[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m178 | [0m[35m        raise_unavailable: bool = False,[0m
[30;1m179 | [0m[35m    ) -> Player | None:[0m
[30;1m180 | [0m[35m        """Return Player by player_id."""[0m
[30;1m181 | [0m[35m        if player := self._players.get(player_id):[0m
[30;1m182 | [0m[35m            if (not player.available or not player.enabled) and raise_unavailable:[0m
[30;1m183 | [0m[35m                msg = f"Player {player_id} is not available"[0m
[30;1m184 | [0m[35m                raise PlayerUnavailableError(msg)[0m

[31m--[ [0m[34mMatch #[0m[33m1972[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m    async def wrapper(self: _PlayerControllerT, *args: _P.args, **kwargs: _P.kwargs) -> _R | None:[0m
[30;1m86 | [0m[35m        """Log and handle_player_command commands to players."""[0m
[30;1m87 | [0m[35m        player_id = kwargs["player_id"] if "player_id" in kwargs else args[0][0m
[30;1m88 | [0m[35m        if (player := self._players.get(player_id)) is None or not player.available:[0m
[30;1m89 | [0m[35m            # player not existent[0m
[30;1m90 | [0m[35m            self.logger.warning([0m
[30;1m91 | [0m[35m                "Ignoring command %s for unavailable player %s",[0m

[31m--[ [0m[34mMatch #[0m[33m1973[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1646 | [0m[35m                            exc_info=err if self.logger.isEnabledFor(10) else None,[0m
[30;1m1647 | [0m[35m                        )[0m
[30;1m1648 | [0m[35m                    finally:[0m
[30;1m1649 | [0m[35m                        # always update player state[0m
[30;1m1650 | [0m[35m                        self.mass.loop.call_soon(self.update, player_id)[0m
[30;1m1651 | [0m[35m            await asyncio.sleep(1)[0m
[30;1m1652 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1974[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1621 | [0m[35m        while True:[0m
[30;1m1622 | [0m[35m            for player in list(self._players.values()):[0m
[30;1m1623 | [0m[35m                player_id = player.player_id[0m
[30;1m1624 | [0m[35m                # if the player is playing, update elapsed time every tick[0m
[30;1m1625 | [0m[35m                # to ensure the queue has accurate details[0m
[30;1m1626 | [0m[35m                player_playing = player.state == PlayerState.PLAYING[0m
[30;1m1627 | [0m[35m                if player_playing:[0m

[31m--[ [0m[34mMatch #[0m[33m1975[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1192 | [0m[35m    def remove_player_control(self, control_id: str) -> None:[0m
[30;1m1193 | [0m[35m        """Remove a player_control from the player manager."""[0m
[30;1m1194 | [0m[35m        control = self._controls.pop(control_id, None)[0m
[30;1m1195 | [0m[35m        if control is None:[0m
[30;1m1196 | [0m[35m            return[0m
[30;1m1197 | [0m[35m        self._controls.pop(control_id, None)[0m
[30;1m1198 | [0m[35m        self.logger.info("PlayerControl removed: %s", control.name)[0m

[31m--[ [0m[34mMatch #[0m[33m1976[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1191 | [0m[35m[0m
[30;1m1192 | [0m[35m    def remove_player_control(self, control_id: str) -> None:[0m
[30;1m1193 | [0m[35m        """Remove a player_control from the player manager."""[0m
[30;1m1194 | [0m[35m        control = self._controls.pop(control_id, None)[0m
[30;1m1195 | [0m[35m        if control is None:[0m
[30;1m1196 | [0m[35m            return[0m
[30;1m1197 | [0m[35m        self._controls.pop(control_id, None)[0m

[31m--[ [0m[34mMatch #[0m[33m1977[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1184 | [0m[35m        """Update playercontrol state."""[0m
[30;1m1185 | [0m[35m        if self.mass.closing:[0m
[30;1m1186 | [0m[35m            return[0m
[30;1m1187 | [0m[35m        # update all players that are using this control[0m
[30;1m1188 | [0m[35m        for player in self._players.values():[0m
[30;1m1189 | [0m[35m            if control_id in (player.power_control, player.volume_control, player.mute_control):[0m
[30;1m1190 | [0m[35m                self.update(player.player_id)[0m
[30;1m1191 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1978[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1184 | [0m[35m        """Update playercontrol state."""[0m
[30;1m1185 | [0m[35m        if self.mass.closing:[0m
[30;1m1186 | [0m[35m            return[0m
[30;1m1187 | [0m[35m        # update all players that are using this control[0m
[30;1m1188 | [0m[35m        for player in self._players.values():[0m
[30;1m1189 | [0m[35m            if control_id in (player.power_control, player.volume_control, player.mute_control):[0m
[30;1m1190 | [0m[35m                self.update(player.player_id)[0m

[31m--[ [0m[34mMatch #[0m[33m1979[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1171 | [0m[35m        self.update_player_control(player_control.id)[0m
[30;1m1172 | [0m[35m[0m
[30;1m1173 | [0m[35m    async def register_or_update_player_control(self, player_control: PlayerControl) -> None:[0m
[30;1m1174 | [0m[35m        """Register a new playercontrol on the controller or update existing one."""[0m
[30;1m1175 | [0m[35m        if self.mass.closing:[0m
[30;1m1176 | [0m[35m            return[0m
[30;1m1177 | [0m[35m        if player_control.id in self._controls:[0m

[31m--[ [0m[34mMatch #[0m[33m1980[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1167 | [0m[35m            player_control.name,[0m
[30;1m1168 | [0m[35m        )[0m
[30;1m1169 | [0m[35m[0m
[30;1m1170 | [0m[35m        # always call update to update any attached players etc.[0m
[30;1m1171 | [0m[35m        self.update_player_control(player_control.id)[0m
[30;1m1172 | [0m[35m[0m
[30;1m1173 | [0m[35m    async def register_or_update_player_control(self, player_control: PlayerControl) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m1981[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1167 | [0m[35m            player_control.name,[0m
[30;1m1168 | [0m[35m        )[0m
[30;1m1169 | [0m[35m[0m
[30;1m1170 | [0m[35m        # always call update to update any attached players etc.[0m
[30;1m1171 | [0m[35m        self.update_player_control(player_control.id)[0m
[30;1m1172 | [0m[35m[0m
[30;1m1173 | [0m[35m    async def register_or_update_player_control(self, player_control: PlayerControl) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m1982[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1126 | [0m[35m                # - the leader has DSP enabled[0m
[30;1m1127 | [0m[35m                self.mass.create_task(self.mass.players.on_player_dsp_change(player_id))[0m
[30;1m1128 | [0m[35m[0m
[30;1m1129 | [0m[35m        # signal player update on the eventbus[0m
[30;1m1130 | [0m[35m        self.mass.signal_event(EventType.PLAYER_UPDATED, object_id=player_id, data=player)[0m
[30;1m1131 | [0m[35m[0m
[30;1m1132 | [0m[35m        # handle player becoming unavailable[0m

[31m--[ [0m[34mMatch #[0m[33m1983[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1106 | [0m[35m                if prev_is_multiple_devices:[0m
[30;1m1107 | [0m[35m                    if childs := new_state.get("group_childs"):[0m
[30;1m1108 | [0m[35m                        # We shrank the group from multiple players to a single player[0m
[30;1m1109 | [0m[35m                        # So the now only child will control the DSP[0m
[30;1m1110 | [0m[35m                        dsp_enabled = self.mass.config.get_player_dsp_config(childs[0]).enabled[0m
[30;1m1111 | [0m[35m                    else:[0m
[30;1m1112 | [0m[35m                        dsp_enabled = False[0m

[31m--[ [0m[34mMatch #[0m[33m1984[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1074 | [0m[35m            # ignore updates for disabled players[0m
[30;1m1075 | [0m[35m            return[0m
[30;1m1076 | [0m[35m[0m
[30;1m1077 | [0m[35m        # always signal update to the playerqueue (regardless of changes)[0m
[30;1m1078 | [0m[35m        self.mass.player_queues.on_player_update(player, changed_values)[0m
[30;1m1079 | [0m[35m[0m
[30;1m1080 | [0m[35m        if len(changed_values) == 0 and not force_update:[0m

[31m--[ [0m[34mMatch #[0m[33m1985[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1042 | [0m[35m        if player.active_group and player.active_group == player.player_id:[0m
[30;1m1043 | [0m[35m            player.active_group = None[0m
[30;1m1044 | [0m[35m        # Auto correct player state if player is synced (or group child)[0m
[30;1m1045 | [0m[35m        # This is because some players/providers do not accurately update this info[0m
[30;1m1046 | [0m[35m        # for the sync child's.[0m
[30;1m1047 | [0m[35m        if player.synced_to and (sync_leader := self.get(player.synced_to)):[0m
[30;1m1048 | [0m[35m            player.state = sync_leader.state[0m

[31m--[ [0m[34mMatch #[0m[33m1986[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m964 | [0m[35m        self.update(player.player_id)[0m
[30;1m965 | [0m[35m[0m
[30;1m966 | [0m[35m    async def register_or_update(self, player: Player) -> None:[0m
[30;1m967 | [0m[35m        """Register a new player on the controller or update existing one."""[0m
[30;1m968 | [0m[35m        if self.mass.closing:[0m
[30;1m969 | [0m[35m            return[0m
[30;1m970 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1987[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m960 | [0m[35m        )[0m
[30;1m961 | [0m[35m        player.available = player_available[0m
[30;1m962 | [0m[35m        self.mass.signal_event(EventType.PLAYER_ADDED, object_id=player.player_id, data=player)[0m
[30;1m963 | [0m[35m        # always call update to fix special attributes like display name, group volume etc.[0m
[30;1m964 | [0m[35m        self.update(player.player_id)[0m
[30;1m965 | [0m[35m[0m
[30;1m966 | [0m[35m    async def register_or_update(self, player: Player) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m1988[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m896 | [0m[35m        if player_provider := self.get_player_provider(player_id):[0m
[30;1m897 | [0m[35m            await player_provider.cmd_ungroup(player_id)[0m
[30;1m898 | [0m[35m        # if the command succeeded we optimistically reset the sync state[0m
[30;1m899 | [0m[35m        # this is to prevent race conditions and to update the UI as fast as possible[0m
[30;1m900 | [0m[35m        player.synced_to = None[0m
[30;1m901 | [0m[35m[0m
[30;1m902 | [0m[35m    @api_command("players/cmd/ungroup_many")[0m

[31m--[ [0m[34mMatch #[0m[33m1989[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m618 | [0m[35m        player = self.get(player_id, True)[0m
[30;1m619 | [0m[35m        if not url.startswith("http"):[0m
[30;1m620 | [0m[35m            raise PlayerCommandFailed("Only URLs are supported for announcements")[0m
[30;1m621 | [0m[35m        # prevent multiple announcements at the same time to the same player with a lock[0m
[30;1m622 | [0m[35m        if player_id not in self._announce_locks:[0m
[30;1m623 | [0m[35m            self._announce_locks[player_id] = lock = asyncio.Lock()[0m
[30;1m624 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m1990[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m601 | [0m[35m            self.logger.debug("Redirecting mute command to PlayerControl %s", control_name)[0m
[30;1m602 | [0m[35m            if not player_control or not player_control.supports_mute:[0m
[30;1m603 | [0m[35m                raise UnsupportedFeaturedException([0m
[30;1m604 | [0m[35m                    f"Player control {control_name} is not available"[0m
[30;1m605 | [0m[35m                )[0m
[30;1m606 | [0m[35m            async with self._player_throttlers[player_id]:[0m
[30;1m607 | [0m[35m                await player_control.mute_set(muted)[0m

[31m--[ [0m[34mMatch #[0m[33m1991[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m595 | [0m[35m                player.volume_muted = False[0m
[30;1m596 | [0m[35m                await self.cmd_volume_set(player_id, player.previous_volume_level)[0m
[30;1m597 | [0m[35m        else:[0m
[30;1m598 | [0m[35m            # handle external player control[0m
[30;1m599 | [0m[35m            player_control = self._controls.get(player.mute_control)[0m
[30;1m600 | [0m[35m            control_name = player_control.name if player_control else player.mute_control[0m
[30;1m601 | [0m[35m            self.logger.debug("Redirecting mute command to PlayerControl %s", control_name)[0m
[30;1m602 | [0m[35m            if not player_control or not player_control.supports_mute:[0m

[31m--[ [0m[34mMatch #[0m[33m1992[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m582 | [0m[35m            async with self._player_throttlers[player_id]:[0m
[30;1m583 | [0m[35m                await player_provider.cmd_volume_mute(player_id, muted)[0m
[30;1m584 | [0m[35m        elif player.power_control == PLAYER_CONTROL_FAKE:[0m
[30;1m585 | [0m[35m            # user wants to use fake mute control - so we use volume instead[0m
[30;1m586 | [0m[35m            self.logger.debug([0m
[30;1m587 | [0m[35m                "Using volume for muting for player %s",[0m
[30;1m588 | [0m[35m                player.display_name,[0m

[31m--[ [0m[34mMatch #[0m[33m1993[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m455 | [0m[35m            self.logger.debug("Redirecting volume command to PlayerControl %s", control_name)[0m
[30;1m456 | [0m[35m            if not player_control or not player_control.supports_volume:[0m
[30;1m457 | [0m[35m                raise UnsupportedFeaturedException([0m
[30;1m458 | [0m[35m                    f"Player control {control_name} is not available"[0m
[30;1m459 | [0m[35m                )[0m
[30;1m460 | [0m[35m            async with self._player_throttlers[player_id]:[0m
[30;1m461 | [0m[35m                await player_control.volume_set(volume_level)[0m

[31m--[ [0m[34mMatch #[0m[33m1994[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m449 | [0m[35m            async with self._player_throttlers[player_id]:[0m
[30;1m450 | [0m[35m                await player_provider.cmd_volume_set(player_id, volume_level)[0m
[30;1m451 | [0m[35m        else:[0m
[30;1m452 | [0m[35m            # handle external player control[0m
[30;1m453 | [0m[35m            player_control = self._controls.get(player.volume_control)[0m
[30;1m454 | [0m[35m            control_name = player_control.name if player_control else player.volume_control[0m
[30;1m455 | [0m[35m            self.logger.debug("Redirecting volume command to PlayerControl %s", control_name)[0m
[30;1m456 | [0m[35m            if not player_control or not player_control.supports_volume:[0m

[31m--[ [0m[34mMatch #[0m[33m1995[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m435 | [0m[35m        # TODO: Implement PlayerControl[0m
[30;1m436 | [0m[35m        player = self.get(player_id, True)[0m
[30;1m437 | [0m[35m        if player.type == PlayerType.GROUP:[0m
[30;1m438 | [0m[35m            # redirect to group volume control[0m
[30;1m439 | [0m[35m            await self.cmd_group_volume(player_id, volume_level)[0m
[30;1m440 | [0m[35m            return[0m
[30;1m441 | [0m[35m[0m
[30;1m442 | [0m[35m        if player.volume_control == PLAYER_CONTROL_NONE:[0m

[31m--[ [0m[34mMatch #[0m[33m1996[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m404 | [0m[35m            else:[0m
[30;1m405 | [0m[35m                await player_control.power_off()[0m
[30;1m406 | [0m[35m[0m
[30;1m407 | [0m[35m        # always optimistically set the power state to update the UI[0m
[30;1m408 | [0m[35m        # as fast as possible and prevent race conditions[0m
[30;1m409 | [0m[35m        player.powered = powered[0m
[30;1m410 | [0m[35m        # reset active source on power off[0m

[31m--[ [0m[34mMatch #[0m[33m1997[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m397 | [0m[35m            self.logger.debug("Redirecting power command to PlayerControl %s", control_name)[0m
[30;1m398 | [0m[35m            if not player_control or not player_control.supports_power:[0m
[30;1m399 | [0m[35m                raise UnsupportedFeaturedException([0m
[30;1m400 | [0m[35m                    f"Player control {control_name} is not available"[0m
[30;1m401 | [0m[35m                )[0m
[30;1m402 | [0m[35m            if powered:[0m
[30;1m403 | [0m[35m                await player_control.power_on()[0m

[31m--[ [0m[34mMatch #[0m[33m1998[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m391 | [0m[35m            # short sleep: allow the stop command to process and prevent race conditions[0m
[30;1m392 | [0m[35m            await asyncio.sleep(0.2)[0m
[30;1m393 | [0m[35m        else:[0m
[30;1m394 | [0m[35m            # handle external player control[0m
[30;1m395 | [0m[35m            player_control = self._controls.get(player.power_control)[0m
[30;1m396 | [0m[35m            control_name = player_control.name if player_control else player.power_control[0m
[30;1m397 | [0m[35m            self.logger.debug("Redirecting power command to PlayerControl %s", control_name)[0m
[30;1m398 | [0m[35m            if not player_control or not player_control.supports_power:[0m

[31m--[ [0m[34mMatch #[0m[33m1999[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m383 | [0m[35m            async with self._player_throttlers[player_id]:[0m
[30;1m384 | [0m[35m                await player_provider.cmd_power(player_id, powered)[0m
[30;1m385 | [0m[35m        elif player.power_control == PLAYER_CONTROL_FAKE:[0m
[30;1m386 | [0m[35m            # user wants to use fake power control - so we (optimistically) update the state[0m
[30;1m387 | [0m[35m            # and store the state in the cache[0m
[30;1m388 | [0m[35m            await self.mass.cache.set([0m
[30;1m389 | [0m[35m                player_id, powered, category=CACHE_CATEGORY_PLAYERS, base_key=CACHE_KEY_PLAYER_POWER[0m

[31m--[ [0m[34mMatch #[0m[33m2000[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m383 | [0m[35m            async with self._player_throttlers[player_id]:[0m
[30;1m384 | [0m[35m                await player_provider.cmd_power(player_id, powered)[0m
[30;1m385 | [0m[35m        elif player.power_control == PLAYER_CONTROL_FAKE:[0m
[30;1m386 | [0m[35m            # user wants to use fake power control - so we (optimistically) update the state[0m
[30;1m387 | [0m[35m            # and store the state in the cache[0m
[30;1m388 | [0m[35m            await self.mass.cache.set([0m
[30;1m389 | [0m[35m                player_id, powered, category=CACHE_CATEGORY_PLAYERS, base_key=CACHE_KEY_PLAYER_POWER[0m

[31m--[ [0m[34mMatch #[0m[33m2001[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m356 | [0m[35m            # NOTE: ungroup will be ignored if the player is not grouped or synced[0m
[30;1m357 | [0m[35m            await self.cmd_ungroup(player_id)[0m
[30;1m358 | [0m[35m[0m
[30;1m359 | [0m[35m        # always stop player at power off[0m
[30;1m360 | [0m[35m        if ([0m
[30;1m361 | [0m[35m            not powered[0m
[30;1m362 | [0m[35m            and not player_was_synced[0m

[31m--[ [0m[34mMatch #[0m[33m2002[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m349 | [0m[35m        if player.powered == powered:[0m
[30;1m350 | [0m[35m            return  # nothing to do[0m
[30;1m351 | [0m[35m[0m
[30;1m352 | [0m[35m        # ungroup player at power off[0m
[30;1m353 | [0m[35m        player_was_synced = player.synced_to is not None[0m
[30;1m354 | [0m[35m        if player.type == PlayerType.PLAYER and not powered:[0m
[30;1m355 | [0m[35m            # ungroup player if it is synced (or is a sync leader itself)[0m

[31m--[ [0m[34mMatch #[0m[33m2003[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m108 | [0m[35m[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35mclass PlayerController(CoreController):[0m
[30;1m111 | [0m[35m    """Controller holding all logic to control registered players."""[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m    domain: str = "players"[0m
[30;1m114 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2004[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m"""[0m
[30;1m2 | [0m[35mMusicAssistant Players Controller.[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mHandles all logic to control supported players,[0m
[30;1m5 | [0m[35mwhich are provided by Player Providers.[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35m"""[0m

[31m--[ [0m[34mMatch #[0m[33m2005[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1621 | [0m[35m        while True:[0m
[30;1m1622 | [0m[35m            for player in list(self._players.values()):[0m
[30;1m1623 | [0m[35m                player_id = player.player_id[0m
[30;1m1624 | [0m[35m                # if the player is playing, update elapsed time every tick[0m
[30;1m1625 | [0m[35m                # to ensure the queue has accurate details[0m
[30;1m1626 | [0m[35m                player_playing = player.state == PlayerState.PLAYING[0m
[30;1m1627 | [0m[35m                if player_playing:[0m

[31m--[ [0m[34mMatch #[0m[33m2006[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1288 | [0m[35m[0m
[30;1m1289 | [0m[35m        except TimeoutError:[0m
[30;1m1290 | [0m[35m            self.logger.debug([0m
[30;1m1291 | [0m[35m                "Player %s did not reach state %s within the timeout of %s seconds",[0m
[30;1m1292 | [0m[35m                player.display_name,[0m
[30;1m1293 | [0m[35m                wanted_state,[0m
[30;1m1294 | [0m[35m                timeout,[0m

[31m--[ [0m[34mMatch #[0m[33m2007[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m618 | [0m[35m        player = self.get(player_id, True)[0m
[30;1m619 | [0m[35m        if not url.startswith("http"):[0m
[30;1m620 | [0m[35m            raise PlayerCommandFailed("Only URLs are supported for announcements")[0m
[30;1m621 | [0m[35m        # prevent multiple announcements at the same time to the same player with a lock[0m
[30;1m622 | [0m[35m        if player_id not in self._announce_locks:[0m
[30;1m623 | [0m[35m            self._announce_locks[player_id] = lock = asyncio.Lock()[0m
[30;1m624 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m2008[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/players.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mimport asyncio[0m
[30;1m12 | [0m[35mimport functools[0m
[30;1m13 | [0m[35mimport time[0m
[30;1m14 | [0m[35mfrom contextlib import suppress[0m
[30;1m15 | [0m[35mfrom typing import TYPE_CHECKING, Any, Concatenate, ParamSpec, TypeVar, cast[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mfrom music_assistant_models.constants import ([0m

[31m--[ [0m[34mMatch #[0m[33m2009[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/sonos/helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mdef get_primary_ip_address(discovery_info: AsyncServiceInfo) -> str | None:[0m
[30;1m14 | [0m[35m    """Get primary IP address from zeroconf discovery info."""[0m
[30;1m15 | [0m[35m    for address in discovery_info.parsed_addresses(IPVersion.V4Only):[0m
[30;1m16 | [0m[35m        if address.startswith("127"):[0m
[30;1m17 | [0m[35m            # filter out loopback address[0m

[31m--[ [0m[34mMatch #[0m[33m2010[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m272 | [0m[35m        entries.append(conf_libraries)[0m
[30;1m273 | [0m[35m[0m
[30;1m274 | [0m[35m    # show authentication options[0m
[30;1m275 | [0m[35m    if values is None or not values.get(CONF_AUTH_TOKEN):[0m
[30;1m276 | [0m[35m        entries.append([0m
[30;1m277 | [0m[35m            ConfigEntry([0m
[30;1m278 | [0m[35m                key=CONF_ACTION_AUTH_MYPLEX,[0m

[31m--[ [0m[34mMatch #[0m[33m2011[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m244 | [0m[35m            server_http_ip = str(values.get(CONF_LOCAL_SERVER_IP))[0m
[30;1m245 | [0m[35m            server_http_port = str(values.get(CONF_LOCAL_SERVER_PORT))[0m
[30;1m246 | [0m[35m            server_http_ssl = bool(values.get(CONF_LOCAL_SERVER_SSL))[0m
[30;1m247 | [0m[35m            server_http_verify_cert = bool(values.get(CONF_LOCAL_SERVER_VERIFY_CERT))[0m
[30;1m248 | [0m[35m            if not ([0m
[30;1m249 | [0m[35m                libraries := await get_libraries([0m
[30;1m250 | [0m[35m                    mass,[0m

[31m--[ [0m[34mMatch #[0m[33m2012[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m243 | [0m[35m            token = mass.config.decrypt_string(str(values.get(CONF_AUTH_TOKEN)))[0m
[30;1m244 | [0m[35m            server_http_ip = str(values.get(CONF_LOCAL_SERVER_IP))[0m
[30;1m245 | [0m[35m            server_http_port = str(values.get(CONF_LOCAL_SERVER_PORT))[0m
[30;1m246 | [0m[35m            server_http_ssl = bool(values.get(CONF_LOCAL_SERVER_SSL))[0m
[30;1m247 | [0m[35m            server_http_verify_cert = bool(values.get(CONF_LOCAL_SERVER_VERIFY_CERT))[0m
[30;1m248 | [0m[35m            if not ([0m
[30;1m249 | [0m[35m                libraries := await get_libraries([0m

[31m--[ [0m[34mMatch #[0m[33m2013[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m242 | [0m[35m        ):[0m
[30;1m243 | [0m[35m            token = mass.config.decrypt_string(str(values.get(CONF_AUTH_TOKEN)))[0m
[30;1m244 | [0m[35m            server_http_ip = str(values.get(CONF_LOCAL_SERVER_IP))[0m
[30;1m245 | [0m[35m            server_http_port = str(values.get(CONF_LOCAL_SERVER_PORT))[0m
[30;1m246 | [0m[35m            server_http_ssl = bool(values.get(CONF_LOCAL_SERVER_SSL))[0m
[30;1m247 | [0m[35m            server_http_verify_cert = bool(values.get(CONF_LOCAL_SERVER_VERIFY_CERT))[0m
[30;1m248 | [0m[35m            if not ([0m

[31m--[ [0m[34mMatch #[0m[33m2014[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m241 | [0m[35m            CONF_ACTION_AUTH_LOCAL,[0m
[30;1m242 | [0m[35m        ):[0m
[30;1m243 | [0m[35m            token = mass.config.decrypt_string(str(values.get(CONF_AUTH_TOKEN)))[0m
[30;1m244 | [0m[35m            server_http_ip = str(values.get(CONF_LOCAL_SERVER_IP))[0m
[30;1m245 | [0m[35m            server_http_port = str(values.get(CONF_LOCAL_SERVER_PORT))[0m
[30;1m246 | [0m[35m            server_http_ssl = bool(values.get(CONF_LOCAL_SERVER_SSL))[0m
[30;1m247 | [0m[35m            server_http_verify_cert = bool(values.get(CONF_LOCAL_SERVER_VERIFY_CERT))[0m

[31m--[ [0m[34mMatch #[0m[33m2015[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m240 | [0m[35m            CONF_ACTION_AUTH_MYPLEX,[0m
[30;1m241 | [0m[35m            CONF_ACTION_AUTH_LOCAL,[0m
[30;1m242 | [0m[35m        ):[0m
[30;1m243 | [0m[35m            token = mass.config.decrypt_string(str(values.get(CONF_AUTH_TOKEN)))[0m
[30;1m244 | [0m[35m            server_http_ip = str(values.get(CONF_LOCAL_SERVER_IP))[0m
[30;1m245 | [0m[35m            server_http_port = str(values.get(CONF_LOCAL_SERVER_PORT))[0m
[30;1m246 | [0m[35m            server_http_ssl = bool(values.get(CONF_LOCAL_SERVER_SSL))[0m

[31m--[ [0m[34mMatch #[0m[33m2016[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m224 | [0m[35m    # config flow auth action/step to pick the library to use[0m
[30;1m225 | [0m[35m    # because this call is very slow, we only show/calculate the dropdown if we do[0m
[30;1m226 | [0m[35m    # not yet have this info or we/user invalidated it.[0m
[30;1m227 | [0m[35m    if values and values.get(CONF_AUTH_TOKEN):[0m
[30;1m228 | [0m[35m        conf_libraries = ConfigEntry([0m
[30;1m229 | [0m[35m            key=CONF_LIBRARY_ID,[0m
[30;1m230 | [0m[35m            type=ConfigEntryType.STRING,[0m

[31m--[ [0m[34mMatch #[0m[33m2017[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m216 | [0m[35m            type=ConfigEntryType.SECURE_STRING,[0m
[30;1m217 | [0m[35m            label=CONF_AUTH_TOKEN,[0m
[30;1m218 | [0m[35m            action=CONF_AUTH_TOKEN,[0m
[30;1m219 | [0m[35m            value=cast("str | None", values.get(CONF_AUTH_TOKEN)) if values else None,[0m
[30;1m220 | [0m[35m            hidden=True,[0m
[30;1m221 | [0m[35m        ),[0m
[30;1m222 | [0m[35m    ][0m

[31m--[ [0m[34mMatch #[0m[33m2018[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m191 | [0m[35m            description="The local server port (e.g. 32400)",[0m
[30;1m192 | [0m[35m            required=True,[0m
[30;1m193 | [0m[35m            default_value=32400,[0m
[30;1m194 | [0m[35m            value=cast("int", values.get(CONF_LOCAL_SERVER_PORT)) if values else None,[0m
[30;1m195 | [0m[35m        ),[0m
[30;1m196 | [0m[35m        ConfigEntry([0m
[30;1m197 | [0m[35m            key=CONF_LOCAL_SERVER_SSL,[0m

[31m--[ [0m[34mMatch #[0m[33m2019[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m182 | [0m[35m            label="Local server IP",[0m
[30;1m183 | [0m[35m            description="The local server IP (e.g. 192.168.1.77)",[0m
[30;1m184 | [0m[35m            required=True,[0m
[30;1m185 | [0m[35m            value=cast("str", values.get(CONF_LOCAL_SERVER_IP)) if values else None,[0m
[30;1m186 | [0m[35m        ),[0m
[30;1m187 | [0m[35m        ConfigEntry([0m
[30;1m188 | [0m[35m            key=CONF_LOCAL_SERVER_PORT,[0m

[31m--[ [0m[34mMatch #[0m[33m2020[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m162 | [0m[35m    entries: list[ConfigEntry] = [][0m
[30;1m163 | [0m[35m[0m
[30;1m164 | [0m[35m    # show GDM discovery (if we do not yet have any server details)[0m
[30;1m165 | [0m[35m    if values is None or not values.get(CONF_LOCAL_SERVER_IP):[0m
[30;1m166 | [0m[35m        entries.append([0m
[30;1m167 | [0m[35m            ConfigEntry([0m
[30;1m168 | [0m[35m                key=CONF_ACTION_GDM,[0m

[31m--[ [0m[34mMatch #[0m[33m2021[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m867 | [0m[35m        """Get playlist tracks."""[0m
[30;1m868 | [0m[35m        result: list[Track] = [][0m
[30;1m869 | [0m[35m        if page > 0:[0m
[30;1m870 | [0m[35m            # paging not supported, we always return the whole list at once[0m
[30;1m871 | [0m[35m            return [][0m
[30;1m872 | [0m[35m        plex_playlist: PlexPlaylist = await self._get_data(prov_playlist_id, PlexPlaylist)[0m
[30;1m873 | [0m[35m        if not (playlist_items := await self._run_async(plex_playlist.items)):[0m

[31m--[ [0m[34mMatch #[0m[33m2022[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m259 | [0m[35m                raise LoginFailed(msg)[0m
[30;1m260 | [0m[35m            conf_libraries.options = [[0m
[30;1m261 | [0m[35m                # use the same value for both the value and the title[0m
[30;1m262 | [0m[35m                # until we find out what plex uses as stable identifiers[0m
[30;1m263 | [0m[35m                ConfigValueOption([0m
[30;1m264 | [0m[35m                    title=x,[0m
[30;1m265 | [0m[35m                    value=x,[0m

[31m--[ [0m[34mMatch #[0m[33m2023[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m180 | [0m[35m            key=CONF_LOCAL_SERVER_IP,[0m
[30;1m181 | [0m[35m            type=ConfigEntryType.STRING,[0m
[30;1m182 | [0m[35m            label="Local server IP",[0m
[30;1m183 | [0m[35m            description="The local server IP (e.g. 192.168.1.77)",[0m
[30;1m184 | [0m[35m            required=True,[0m
[30;1m185 | [0m[35m            value=cast("str", values.get(CONF_LOCAL_SERVER_IP)) if values else None,[0m
[30;1m186 | [0m[35m        ),[0m

[31m--[ [0m[34mMatch #[0m[33m2024[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m125 | [0m[35m            values[CONF_LOCAL_SERVER_VERIFY_CERT] = False[0m
[30;1m126 | [0m[35m        else:[0m
[30;1m127 | [0m[35m            assert values[0m
[30;1m128 | [0m[35m            values[CONF_LOCAL_SERVER_IP] = "Discovery failed, please add IP manually"[0m
[30;1m129 | [0m[35m            values[CONF_LOCAL_SERVER_PORT] = 32400[0m
[30;1m130 | [0m[35m            values[CONF_LOCAL_SERVER_SSL] = False[0m
[30;1m131 | [0m[35m            values[CONF_LOCAL_SERVER_VERIFY_CERT] = True[0m

[31m--[ [0m[34mMatch #[0m[33m2025[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m816 | [0m[35m            ):[0m
[30;1m817 | [0m[35m                # copy album image to itemmapping single image[0m
[30;1m818 | [0m[35m                db_row_dict["image"] = album_thumb[0m
[30;1m819 | [0m[35m                if db_row_dict["metadata"].get("images"):[0m
[30;1m820 | [0m[35m                    # merge album image with existing images[0m
[30;1m821 | [0m[35m                    db_row_dict["metadata"]["images"] = [[0m
[30;1m822 | [0m[35m                        album_thumb,[0m

[31m--[ [0m[34mMatch #[0m[33m2026[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m811 | [0m[35m            db_row_dict["disc_number"] = track_album["disc_number"][0m
[30;1m812 | [0m[35m            db_row_dict["track_number"] = track_album["track_number"][0m
[30;1m813 | [0m[35m            # always prefer album image over track image[0m
[30;1m814 | [0m[35m            if (album_images := track_album.get("images")) and ([0m
[30;1m815 | [0m[35m                album_thumb := next((x for x in album_images if x["type"] == "thumb"), None)[0m
[30;1m816 | [0m[35m            ):[0m
[30;1m817 | [0m[35m                # copy album image to itemmapping single image[0m

[31m--[ [0m[34mMatch #[0m[33m2027[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m806 | [0m[35m            db_row_dict[key] = json_loads(raw_value)[0m
[30;1m807 | [0m[35m[0m
[30;1m808 | [0m[35m        # copy track_album --> album[0m
[30;1m809 | [0m[35m        if track_album := db_row_dict.get("track_album"):[0m
[30;1m810 | [0m[35m            db_row_dict["album"] = track_album[0m
[30;1m811 | [0m[35m            db_row_dict["disc_number"] = track_album["disc_number"][0m
[30;1m812 | [0m[35m            db_row_dict["track_number"] = track_album["track_number"][0m

[31m--[ [0m[34mMatch #[0m[33m2028[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m747 | [0m[35m        # build final query[0m
[30;1m748 | [0m[35m        sql_query += f" GROUP BY {self.db_table}.item_id"[0m
[30;1m749 | [0m[35m        if order_by:[0m
[30;1m750 | [0m[35m            if sort_key := SORT_KEYS.get(order_by):[0m
[30;1m751 | [0m[35m                sql_query += f" ORDER BY {sort_key}"[0m
[30;1m752 | [0m[35m        # return dbresult parsed to media item model[0m
[30;1m753 | [0m[35m        return [[0m

[31m--[ [0m[34mMatch #[0m[33m2029[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m540 | [0m[35m        cache_base_key = provider.lookup_key[0m
[30;1m541 | [0m[35m        cache_key = f"{self.media_type.value}.{item_id}"[0m
[30;1m542 | [0m[35m        if not force_refresh and ([0m
[30;1m543 | [0m[35m            cache := await self.mass.cache.get([0m
[30;1m544 | [0m[35m                cache_key, category=cache_category, base_key=cache_base_key[0m
[30;1m545 | [0m[35m            )[0m
[30;1m546 | [0m[35m        ):[0m

[31m--[ [0m[34mMatch #[0m[33m2030[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m321 | [0m[35m        cache_base_key = prov.lookup_key[0m
[30;1m322 | [0m[35m        cache_key = f"{search_query}.{limit}.{self.media_type.value}"[0m
[30;1m323 | [0m[35m        if ([0m
[30;1m324 | [0m[35m            cache := await self.mass.cache.get([0m
[30;1m325 | [0m[35m                cache_key, category=cache_category, base_key=cache_base_key[0m
[30;1m326 | [0m[35m            )[0m
[30;1m327 | [0m[35m        ) is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m2031[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/base.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m652 | [0m[35m        )[0m
[30;1m653 | [0m[35m        if library_item is None:[0m
[30;1m654 | [0m[35m            return[0m
[30;1m655 | [0m[35m        # update the item's provider mappings (and check if we still have any)[0m
[30;1m656 | [0m[35m        library_item.provider_mappings = {[0m
[30;1m657 | [0m[35m            x for x in library_item.provider_mappings if x.provider_instance != provider_instance_id[0m
[30;1m658 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m2032[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/base.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m641 | [0m[35m        except MediaNotFoundError:[0m
[30;1m642 | [0m[35m            # edge case: already deleted / race condition[0m
[30;1m643 | [0m[35m            library_item = None[0m
[30;1m644 | [0m[35m        # update provider_mappings table[0m
[30;1m645 | [0m[35m        await self.mass.music.database.delete([0m
[30;1m646 | [0m[35m            DB_TABLE_PROVIDER_MAPPINGS,[0m
[30;1m647 | [0m[35m            {[0m

[31m--[ [0m[34mMatch #[0m[33m2033[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/base.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m601 | [0m[35m            for x in library_item.provider_mappings[0m
[30;1m602 | [0m[35m            if x.provider_instance != provider_instance_id and x.item_id != provider_item_id[0m
[30;1m603 | [0m[35m        }[0m
[30;1m604 | [0m[35m        # update provider_mappings table[0m
[30;1m605 | [0m[35m        await self.mass.music.database.delete([0m
[30;1m606 | [0m[35m            DB_TABLE_PROVIDER_MAPPINGS,[0m
[30;1m607 | [0m[35m            {[0m

[31m--[ [0m[34mMatch #[0m[33m2034[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/base.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m558 | [0m[35m        # if we reach this point all possibilities failed and the item could not be found.[0m
[30;1m559 | [0m[35m        # There is a possibility that the (streaming) provider changed the id of the item[0m
[30;1m560 | [0m[35m        # so we return the previous details (if we have any) marked as unavailable, so[0m
[30;1m561 | [0m[35m        # at least we have the possibility to sort out the new id through matching logic.[0m
[30;1m562 | [0m[35m        fallback = fallback or await self.get_library_item_by_prov_id([0m
[30;1m563 | [0m[35m            item_id, provider_instance_id_or_domain[0m
[30;1m564 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m2035[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/base.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m188 | [0m[35m            self.db_table,[0m
[30;1m189 | [0m[35m            {"item_id": db_id},[0m
[30;1m190 | [0m[35m        )[0m
[30;1m191 | [0m[35m        # update provider_mappings table[0m
[30;1m192 | [0m[35m        await self.mass.music.database.delete([0m
[30;1m193 | [0m[35m            DB_TABLE_PROVIDER_MAPPINGS,[0m
[30;1m194 | [0m[35m            {"media_type": self.media_type.value, "item_id": db_id},[0m

[31m--[ [0m[34mMatch #[0m[33m2036[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/base.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m124 | [0m[35m        new_item = False[0m
[30;1m125 | [0m[35m        # check for existing item first[0m
[30;1m126 | [0m[35m        if library_id := await self._get_library_item_by_match(item):[0m
[30;1m127 | [0m[35m            # update existing item[0m
[30;1m128 | [0m[35m            await self._update_library_item(library_id, item, overwrite=overwrite_existing)[0m
[30;1m129 | [0m[35m        else:[0m
[30;1m130 | [0m[35m            # actually add a new item in the library db[0m

[31m--[ [0m[34mMatch #[0m[33m2037[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m684 | [0m[35m[0m
[30;1m685 | [0m[35m    async def match_providers(self, db_item: ItemCls) -> None:[0m
[30;1m686 | [0m[35m        """[0m
[30;1m687 | [0m[35m        Try to find match on all (streaming) providers for the provided (database) item.[0m
[30;1m688 | [0m[35m[0m
[30;1m689 | [0m[35m        This is used to link objects of different providers/qualities together.[0m
[30;1m690 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m2038[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m567 | [0m[35m            # NOTE: we only accept ItemMapping as fallback for flat items[0m
[30;1m568 | [0m[35m            # so not for tracks and albums (which rely on other objects)[0m
[30;1m569 | [0m[35m            return fallback[0m
[30;1m570 | [0m[35m        # all options exhausted, we really can not find this item[0m
[30;1m571 | [0m[35m        msg = ([0m
[30;1m572 | [0m[35m            f"{self.media_type.value}://{item_id} not "[0m
[30;1m573 | [0m[35m            f"found on provider {provider_instance_id_or_domain}"[0m

[31m--[ [0m[34mMatch #[0m[33m2039[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m558 | [0m[35m        # if we reach this point all possibilities failed and the item could not be found.[0m
[30;1m559 | [0m[35m        # There is a possibility that the (streaming) provider changed the id of the item[0m
[30;1m560 | [0m[35m        # so we return the previous details (if we have any) marked as unavailable, so[0m
[30;1m561 | [0m[35m        # at least we have the possibility to sort out the new id through matching logic.[0m
[30;1m562 | [0m[35m        fallback = fallback or await self.get_library_item_by_prov_id([0m
[30;1m563 | [0m[35m            item_id, provider_instance_id_or_domain[0m
[30;1m564 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m2040[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/artists.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m290 | [0m[35m        if ([0m
[30;1m291 | [0m[35m            prov.is_streaming_provider[0m
[30;1m292 | [0m[35m            and ([0m
[30;1m293 | [0m[35m                cache := await self.mass.cache.get([0m
[30;1m294 | [0m[35m                    cache_key, category=cache_category, base_key=cache_base_key[0m
[30;1m295 | [0m[35m                )[0m
[30;1m296 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m2041[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/artists.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m217 | [0m[35m        if ([0m
[30;1m218 | [0m[35m            prov.is_streaming_provider[0m
[30;1m219 | [0m[35m            and ([0m
[30;1m220 | [0m[35m                cache := await self.mass.cache.get([0m
[30;1m221 | [0m[35m                    cache_key, category=cache_category, base_key=cache_base_key[0m
[30;1m222 | [0m[35m                )[0m
[30;1m223 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m2042[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/artists.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m479 | [0m[35m                        search_item_artist.provider,[0m
[30;1m480 | [0m[35m                        fallback=search_result_item,[0m
[30;1m481 | [0m[35m                    )[0m
[30;1m482 | [0m[35m                    # 100% match, we update the db with the additional provider mapping(s)[0m
[30;1m483 | [0m[35m                    for provider_mapping in prov_artist.provider_mappings:[0m
[30;1m484 | [0m[35m                        await self.add_provider_mapping(db_artist.item_id, provider_mapping)[0m
[30;1m485 | [0m[35m                        db_artist.provider_mappings.add(provider_mapping)[0m

[31m--[ [0m[34mMatch #[0m[33m2043[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/artists.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m373 | [0m[35m        if isinstance(update, ItemMapping):[0m
[30;1m374 | [0m[35m            # NOTE that artist is the only mediatype where its accepted we[0m
[30;1m375 | [0m[35m            # receive an itemmapping from streaming providers[0m
[30;1m376 | [0m[35m            update = self.artist_from_item_mapping(update)[0m
[30;1m377 | [0m[35m            metadata = cur_item.metadata[0m
[30;1m378 | [0m[35m        else:[0m
[30;1m379 | [0m[35m            metadata = update.metadata if overwrite else cur_item.metadata.update(update.metadata)[0m

[31m--[ [0m[34mMatch #[0m[33m2044[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/artists.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m451 | [0m[35m                )[0m
[30;1m452 | [0m[35m[0m
[30;1m453 | [0m[35m    async def _match_provider(self, db_artist: Artist, provider: MusicProvider) -> bool:[0m
[30;1m454 | [0m[35m        """Try to find matching artists on given provider for the provided (database) artist."""[0m
[30;1m455 | [0m[35m        self.logger.debug("Trying to match artist %s on provider %s", db_artist.name, provider.name)[0m
[30;1m456 | [0m[35m        # try to get a match with some reference tracks of this artist[0m
[30;1m457 | [0m[35m        ref_tracks = await self.mass.music.artists.tracks(db_artist.item_id, db_artist.provider)[0m

[31m--[ [0m[34mMatch #[0m[33m2045[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/artists.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m445 | [0m[35m                cur_provider_domains.add(provider.domain)[0m
[30;1m446 | [0m[35m            else:[0m
[30;1m447 | [0m[35m                self.logger.debug([0m
[30;1m448 | [0m[35m                    "Could not find match for Artist %s on provider %s",[0m
[30;1m449 | [0m[35m                    db_artist.name,[0m
[30;1m450 | [0m[35m                    provider.name,[0m
[30;1m451 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m2046[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/artists.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m425 | [0m[35m        )[0m
[30;1m426 | [0m[35m[0m
[30;1m427 | [0m[35m    async def match_providers(self, db_artist: Artist) -> None:[0m
[30;1m428 | [0m[35m        """Try to find matching artists on all providers for the provided (database) item_id.[0m
[30;1m429 | [0m[35m[0m
[30;1m430 | [0m[35m        This is used to link objects of different providers together.[0m
[30;1m431 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m2047[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/artists.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m204 | [0m[35m        item_id: str,[0m
[30;1m205 | [0m[35m        provider_instance_id_or_domain: str,[0m
[30;1m206 | [0m[35m    ) -> list[Track]:[0m
[30;1m207 | [0m[35m        """Return top tracks for an artist on given provider."""[0m
[30;1m208 | [0m[35m        items = [][0m
[30;1m209 | [0m[35m        assert provider_instance_id_or_domain != "library"[0m
[30;1m210 | [0m[35m        prov = self.mass.get_provider(provider_instance_id_or_domain)[0m

[31m--[ [0m[34mMatch #[0m[33m2048[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/tracks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m427 | [0m[35m        provider_instance_id_or_domain: str,[0m
[30;1m428 | [0m[35m    ):[0m
[30;1m429 | [0m[35m        """Get the list of base tracks from the controller used to calculate the dynamic radio."""[0m
[30;1m430 | [0m[35m        return [await self.get(item_id, provider_instance_id_or_domain)][0m
[30;1m431 | [0m[35m[0m
[30;1m432 | [0m[35m    async def _add_library_item(self, item: Track) -> int:[0m
[30;1m433 | [0m[35m        """Add a new item record to the database."""[0m

[31m--[ [0m[34mMatch #[0m[33m2049[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/tracks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m291 | [0m[35m        allow_lookup: bool = False,[0m
[30;1m292 | [0m[35m    ):[0m
[30;1m293 | [0m[35m        """Get a list of similar tracks for the given track."""[0m
[30;1m294 | [0m[35m        ref_item = await self.get(item_id, provider_instance_id_or_domain)[0m
[30;1m295 | [0m[35m        for prov_mapping in ref_item.provider_mappings:[0m
[30;1m296 | [0m[35m            prov = self.mass.get_provider(prov_mapping.provider_instance)[0m
[30;1m297 | [0m[35m            if prov is None:[0m

[31m--[ [0m[34mMatch #[0m[33m2050[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/tracks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m251 | [0m[35m        in_library_only: bool = False,[0m
[30;1m252 | [0m[35m    ) -> UniqueList[Album]:[0m
[30;1m253 | [0m[35m        """Return all albums the track appears on."""[0m
[30;1m254 | [0m[35m        full_track = await self.get(item_id, provider_instance_id_or_domain)[0m
[30;1m255 | [0m[35m        db_items = ([0m
[30;1m256 | [0m[35m            await self.get_library_track_albums(full_track.item_id)[0m
[30;1m257 | [0m[35m            if full_track.provider == "library"[0m

[31m--[ [0m[34mMatch #[0m[33m2051[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/tracks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m225 | [0m[35m        provider_instance_id_or_domain: str,[0m
[30;1m226 | [0m[35m    ) -> UniqueList[Track]:[0m
[30;1m227 | [0m[35m        """Return all versions of a track we can find on all providers."""[0m
[30;1m228 | [0m[35m        track = await self.get(item_id, provider_instance_id_or_domain)[0m
[30;1m229 | [0m[35m        search_query = f"{track.artist_str} - {track.name}"[0m
[30;1m230 | [0m[35m        result: UniqueList[Track] = UniqueList()[0m
[30;1m231 | [0m[35m        for provider_id in self.mass.music.get_unique_providers():[0m

[31m--[ [0m[34mMatch #[0m[33m2052[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/tracks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m142 | [0m[35m                continue[0m
[30;1m143 | [0m[35m            try:[0m
[30;1m144 | [0m[35m                track_artists.append([0m
[30;1m145 | [0m[35m                    await self.mass.music.artists.get([0m
[30;1m146 | [0m[35m                        artist.item_id,[0m
[30;1m147 | [0m[35m                        artist.provider,[0m
[30;1m148 | [0m[35m                    )[0m

[31m--[ [0m[34mMatch #[0m[33m2053[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/tracks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m                        album_track_row["album_id"][0m
[30;1m125 | [0m[35m                    )[0m
[30;1m126 | [0m[35m            elif isinstance(track.album, ItemMapping) or (track.album and not track.album.image):[0m
[30;1m127 | [0m[35m                track.album = await self.mass.music.albums.get([0m
[30;1m128 | [0m[35m                    track.album.item_id, track.album.provider, recursive=False[0m
[30;1m129 | [0m[35m                )[0m
[30;1m130 | [0m[35m        except MusicAssistantError as err:[0m

[31m--[ [0m[34mMatch #[0m[33m2054[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/tracks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m103 | [0m[35m        album_uri: str | None = None,[0m
[30;1m104 | [0m[35m    ) -> Track:[0m
[30;1m105 | [0m[35m        """Return (full) details for a single media item."""[0m
[30;1m106 | [0m[35m        track = await super().get([0m
[30;1m107 | [0m[35m            item_id,[0m
[30;1m108 | [0m[35m            provider_instance_id_or_domain,[0m
[30;1m109 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m2055[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/tracks.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m528 | [0m[35m        albums and tracks which stores the relation between the two and it also[0m
[30;1m529 | [0m[35m        stores the track and disc number of the track within an album.[0m
[30;1m530 | [0m[35m        For digital releases, the discnumber will be just 0 or 1.[0m
[30;1m531 | [0m[35m        Track number should start counting at 1.[0m
[30;1m532 | [0m[35m        """[0m
[30;1m533 | [0m[35m        db_album: Album | ItemMapping = None[0m
[30;1m534 | [0m[35m        if album.provider == "library":[0m

[31m--[ [0m[34mMatch #[0m[33m2056[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/tracks.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m373 | [0m[35m                provider, ref_track, strict=True, ref_albums=track_albums[0m
[30;1m374 | [0m[35m            )[0m
[30;1m375 | [0m[35m            for provider_mapping in provider_matches:[0m
[30;1m376 | [0m[35m                # 100% match, we update the db with the additional provider mapping(s)[0m
[30;1m377 | [0m[35m                await self.add_provider_mapping(ref_track.item_id, provider_mapping)[0m
[30;1m378 | [0m[35m                ref_track.provider_mappings.add(provider_mapping)[0m
[30;1m379 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2057[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/tracks.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m415 | [0m[35m[0m
[30;1m416 | [0m[35m        if not matches:[0m
[30;1m417 | [0m[35m            self.logger.debug([0m
[30;1m418 | [0m[35m                "Could not find match for Track %s on provider %s",[0m
[30;1m419 | [0m[35m                ref_track.name,[0m
[30;1m420 | [0m[35m                provider.name,[0m
[30;1m421 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m2058[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/tracks.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m384 | [0m[35m        strict: bool = True,[0m
[30;1m385 | [0m[35m        ref_albums: list[Album] | None = None,[0m
[30;1m386 | [0m[35m    ) -> set[ProviderMapping]:[0m
[30;1m387 | [0m[35m        """Try to find matching track on given provider."""[0m
[30;1m388 | [0m[35m        if ref_albums is None:[0m
[30;1m389 | [0m[35m            ref_albums = await self.albums(ref_track.item_id, ref_track.provider)[0m
[30;1m390 | [0m[35m        if ProviderFeature.SEARCH not in provider.supported_features:[0m

[31m--[ [0m[34mMatch #[0m[33m2059[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/tracks.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m356 | [0m[35m        return await self.mass.music.albums._get_library_items_by_query(extra_query_parts=[query])[0m
[30;1m357 | [0m[35m[0m
[30;1m358 | [0m[35m    async def match_providers(self, ref_track: Track) -> None:[0m
[30;1m359 | [0m[35m        """Try to find matching track on all providers for the provided (database) track_id.[0m
[30;1m360 | [0m[35m[0m
[30;1m361 | [0m[35m        This is used to link objects of different providers/qualities together.[0m
[30;1m362 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m2060[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/tracks.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m224 | [0m[35m        item_id: str,[0m
[30;1m225 | [0m[35m        provider_instance_id_or_domain: str,[0m
[30;1m226 | [0m[35m    ) -> UniqueList[Track]:[0m
[30;1m227 | [0m[35m        """Return all versions of a track we can find on all providers."""[0m
[30;1m228 | [0m[35m        track = await self.get(item_id, provider_instance_id_or_domain)[0m
[30;1m229 | [0m[35m        search_query = f"{track.artist_str} - {track.name}"[0m
[30;1m230 | [0m[35m        result: UniqueList[Track] = UniqueList()[0m

[31m--[ [0m[34mMatch #[0m[33m2061[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tunein/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m291 | [0m[35m        headers = {"Accept-Language": f"{locale}, {language};q=0.9, *;q=0.5"}[0m
[30;1m292 | [0m[35m        async with ([0m
[30;1m293 | [0m[35m            self._throttler,[0m
[30;1m294 | [0m[35m            self.mass.http_session.get(url, params=kwargs, headers=headers, ssl=False) as response,[0m
[30;1m295 | [0m[35m        ):[0m
[30;1m296 | [0m[35m            result = await response.json()[0m
[30;1m297 | [0m[35m            if not result or "error" in result:[0m

[31m--[ [0m[34mMatch #[0m[33m2062[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tunein/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m232 | [0m[35m    async def _get_stream_info(self, preset_id: str) -> list[dict]:[0m
[30;1m233 | [0m[35m        """Get stream info for a radio station."""[0m
[30;1m234 | [0m[35m        cache_base_key = "tunein_stream"[0m
[30;1m235 | [0m[35m        if cache := await self.mass.cache.get(preset_id, base_key=cache_base_key):[0m
[30;1m236 | [0m[35m            return cache[0m
[30;1m237 | [0m[35m        result = (await self.__get_data("Tune.ashx", id=preset_id))["body"][0m
[30;1m238 | [0m[35m        await self.mass.cache.set(preset_id, result, base_key=cache_base_key)[0m

[31m--[ [0m[34mMatch #[0m[33m2063[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tunein/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m218 | [0m[35m        if "text" in details:[0m
[30;1m219 | [0m[35m            radio.metadata.description = details["text"][0m
[30;1m220 | [0m[35m        # image[0m
[30;1m221 | [0m[35m        if img := details.get("image") or details.get("logo"):[0m
[30;1m222 | [0m[35m            radio.metadata.images = [[0m
[30;1m223 | [0m[35m                MediaItemImage([0m
[30;1m224 | [0m[35m                    type=ImageType.THUMB,[0m

[31m--[ [0m[34mMatch #[0m[33m2064[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tunein/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m218 | [0m[35m        if "text" in details:[0m
[30;1m219 | [0m[35m            radio.metadata.description = details["text"][0m
[30;1m220 | [0m[35m        # image[0m
[30;1m221 | [0m[35m        if img := details.get("image") or details.get("logo"):[0m
[30;1m222 | [0m[35m            radio.metadata.images = [[0m
[30;1m223 | [0m[35m                MediaItemImage([0m
[30;1m224 | [0m[35m                    type=ImageType.THUMB,[0m

[31m--[ [0m[34mMatch #[0m[33m2065[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tunein/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m213 | [0m[35m            )[0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m        # preset number is used for sorting (not present at stream time)[0m
[30;1m216 | [0m[35m        preset_number = details.get("preset_number", 0)[0m
[30;1m217 | [0m[35m        radio.position = preset_number[0m
[30;1m218 | [0m[35m        if "text" in details:[0m
[30;1m219 | [0m[35m            radio.metadata.description = details["text"][0m

[31m--[ [0m[34mMatch #[0m[33m2066[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tunein/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m207 | [0m[35m                            content_type=ContentType.UNKNOWN,[0m
[30;1m208 | [0m[35m                        ),[0m
[30;1m209 | [0m[35m                        details=details["URL"],[0m
[30;1m210 | [0m[35m                        available=details.get("is_available", True),[0m
[30;1m211 | [0m[35m                    )[0m
[30;1m212 | [0m[35m                },[0m
[30;1m213 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m2067[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tunein/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m187 | [0m[35m                            bit_rate=stream.get("bitrate", 128),[0m
[30;1m188 | [0m[35m                        ),[0m
[30;1m189 | [0m[35m                        details=stream["url"],[0m
[30;1m190 | [0m[35m                        available=details.get("is_available", True),[0m
[30;1m191 | [0m[35m                    )[0m
[30;1m192 | [0m[35m                    for stream in stream_info[0m
[30;1m193 | [0m[35m                },[0m

[31m--[ [0m[34mMatch #[0m[33m2068[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tunein/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m184 | [0m[35m                        provider_instance=self.instance_id,[0m
[30;1m185 | [0m[35m                        audio_format=AudioFormat([0m
[30;1m186 | [0m[35m                            content_type=ContentType.try_parse(stream["media_type"]),[0m
[30;1m187 | [0m[35m                            bit_rate=stream.get("bitrate", 128),[0m
[30;1m188 | [0m[35m                        ),[0m
[30;1m189 | [0m[35m                        details=stream["url"],[0m
[30;1m190 | [0m[35m                        available=details.get("is_available", True),[0m

[31m--[ [0m[34mMatch #[0m[33m2069[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tunein/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m144 | [0m[35m                media_type = None[0m
[30;1m145 | [0m[35m            params = {"c": "composite", "detail": "listing", "id": prov_radio_id}[0m
[30;1m146 | [0m[35m            result = await self.__get_data("Describe.ashx", **params)[0m
[30;1m147 | [0m[35m            if result and result.get("body") and result["body"][0].get("children"):[0m
[30;1m148 | [0m[35m                item = result["body"][0]["children"][0][0m
[30;1m149 | [0m[35m                stream_info = await self._get_stream_info(prov_radio_id)[0m
[30;1m150 | [0m[35m                for stream in stream_info:[0m

[31m--[ [0m[34mMatch #[0m[33m2070[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tunein/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m144 | [0m[35m                media_type = None[0m
[30;1m145 | [0m[35m            params = {"c": "composite", "detail": "listing", "id": prov_radio_id}[0m
[30;1m146 | [0m[35m            result = await self.__get_data("Describe.ashx", **params)[0m
[30;1m147 | [0m[35m            if result and result.get("body") and result["body"][0].get("children"):[0m
[30;1m148 | [0m[35m                item = result["body"][0]["children"][0][0m
[30;1m149 | [0m[35m                stream_info = await self._get_stream_info(prov_radio_id)[0m
[30;1m150 | [0m[35m                for stream in stream_info:[0m

[31m--[ [0m[34mMatch #[0m[33m2071[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tunein/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m125 | [0m[35m                    if sublevel := await self.__get_data(item["URL"], render="json"):[0m
[30;1m126 | [0m[35m                        async for subitem in parse_items(sublevel["body"], item["text"]):[0m
[30;1m127 | [0m[35m                            yield subitem[0m
[30;1m128 | [0m[35m                elif item.get("children"):[0m
[30;1m129 | [0m[35m                    # stations are in sublevel (old style ?)[0m
[30;1m130 | [0m[35m                    async for subitem in parse_items(item["children"], item["text"]):[0m
[30;1m131 | [0m[35m                        yield subitem[0m

[31m--[ [0m[34mMatch #[0m[33m2072[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tunein/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m113 | [0m[35m                    # each radio station can have multiple streams add each one as different quality[0m
[30;1m114 | [0m[35m                    stream_info = await self._get_stream_info(item["preset_id"])[0m
[30;1m115 | [0m[35m                    yield self._parse_radio(item, stream_info, folder)[0m
[30;1m116 | [0m[35m                elif item_type == "link" and item.get("item") == "url":[0m
[30;1m117 | [0m[35m                    # custom url[0m
[30;1m118 | [0m[35m                    try:[0m
[30;1m119 | [0m[35m                        yield self._parse_radio(item)[0m

[31m--[ [0m[34mMatch #[0m[33m2073[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tunein/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m105 | [0m[35m                item_type = item.get("type", "")[0m
[30;1m106 | [0m[35m                if "unavailable" in item.get("key", ""):[0m
[30;1m107 | [0m[35m                    continue[0m
[30;1m108 | [0m[35m                if not item.get("is_available", True):[0m
[30;1m109 | [0m[35m                    continue[0m
[30;1m110 | [0m[35m                if item_type == "audio":[0m
[30;1m111 | [0m[35m                    if "preset_id" not in item:[0m

[31m--[ [0m[34mMatch #[0m[33m2074[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tunein/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m103 | [0m[35m        ) -> AsyncGenerator[Radio, None]:[0m
[30;1m104 | [0m[35m            for item in items:[0m
[30;1m105 | [0m[35m                item_type = item.get("type", "")[0m
[30;1m106 | [0m[35m                if "unavailable" in item.get("key", ""):[0m
[30;1m107 | [0m[35m                    continue[0m
[30;1m108 | [0m[35m                if not item.get("is_available", True):[0m
[30;1m109 | [0m[35m                    continue[0m

[31m--[ [0m[34mMatch #[0m[33m2075[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tunein/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m102 | [0m[35m            items: list[dict], folder: str | None = None[0m
[30;1m103 | [0m[35m        ) -> AsyncGenerator[Radio, None]:[0m
[30;1m104 | [0m[35m            for item in items:[0m
[30;1m105 | [0m[35m                item_type = item.get("type", "")[0m
[30;1m106 | [0m[35m                if "unavailable" in item.get("key", ""):[0m
[30;1m107 | [0m[35m                    continue[0m
[30;1m108 | [0m[35m                if not item.get("is_available", True):[0m

[31m--[ [0m[34mMatch #[0m[33m2076[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/tunein/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m212 | [0m[35m                },[0m
[30;1m213 | [0m[35m            )[0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m        # preset number is used for sorting (not present at stream time)[0m
[30;1m216 | [0m[35m        preset_number = details.get("preset_number", 0)[0m
[30;1m217 | [0m[35m        radio.position = preset_number[0m
[30;1m218 | [0m[35m        if "text" in details:[0m

[31m--[ [0m[34mMatch #[0m[33m2077[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/opensubsonic/parsers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m119 | [0m[35m        )[0m
[30;1m120 | [0m[35m    else:[0m
[30;1m121 | [0m[35m        logger.info([0m
[30;1m122 | [0m[35m            "Unable to find an artist ID for album '%s' with ID '%s'.",[0m
[30;1m123 | [0m[35m            sonic_album.name,[0m
[30;1m124 | [0m[35m            sonic_album.id,[0m
[30;1m125 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m2078[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m230 | [0m[35m    if sort:[0m
[30;1m231 | [0m[35m        return sorted([0m
[30;1m232 | [0m[35m            items,[0m
[30;1m233 | [0m[35m            # sort by (natural) name[0m
[30;1m234 | [0m[35m            key=lambda x: nat_key(x.name),[0m
[30;1m235 | [0m[35m        )[0m
[30;1m236 | [0m[35m    return items[0m

[31m--[ [0m[34mMatch #[0m[33m2079[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m117 | [0m[35m    checks if the album name is a substring of the directory name.[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m    First iteration considers the literal dash as one of the separators. The[0m
[30;1m120 | [0m[35m    second pass is to catch edge cases where the literal dash is part of the[0m
[30;1m121 | [0m[35m    album's name, not an actual separator. For example, an album like 'Aphex[0m
[30;1m122 | [0m[35m    Twin - Selected Ambient Works 85-92' would be correctly handled.[0m
[30;1m123 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2080[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/helpers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m116 | [0m[35m    This function tokenizes both input strings using different delimiters and[0m
[30;1m117 | [0m[35m    checks if the album name is a substring of the directory name.[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m    First iteration considers the literal dash as one of the separators. The[0m
[30;1m120 | [0m[35m    second pass is to catch edge cases where the literal dash is part of the[0m
[30;1m121 | [0m[35m    album's name, not an actual separator. For example, an album like 'Aphex[0m
[30;1m122 | [0m[35m    Twin - Selected Ambient Works 85-92' would be correctly handled.[0m

[31m--[ [0m[34mMatch #[0m[33m2081[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/albums.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m386 | [0m[35m        if ([0m
[30;1m387 | [0m[35m            prov.is_streaming_provider[0m
[30;1m388 | [0m[35m            and ([0m
[30;1m389 | [0m[35m                cache := await self.mass.cache.get([0m
[30;1m390 | [0m[35m                    cache_key, category=cache_category, base_key=cache_base_key[0m
[30;1m391 | [0m[35m                )[0m
[30;1m392 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m2082[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/albums.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m90 | [0m[35m                continue[0m
[30;1m91 | [0m[35m            with contextlib.suppress(MediaNotFoundError):[0m
[30;1m92 | [0m[35m                album_artists.append([0m
[30;1m93 | [0m[35m                    await self.mass.music.artists.get([0m
[30;1m94 | [0m[35m                        artist.item_id,[0m
[30;1m95 | [0m[35m                        artist.provider,[0m
[30;1m96 | [0m[35m                    )[0m

[31m--[ [0m[34mMatch #[0m[33m2083[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/albums.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m75 | [0m[35m        recursive: bool = True,[0m
[30;1m76 | [0m[35m    ) -> Album:[0m
[30;1m77 | [0m[35m        """Return (full) details for a single media item."""[0m
[30;1m78 | [0m[35m        album = await super().get([0m
[30;1m79 | [0m[35m            item_id,[0m
[30;1m80 | [0m[35m            provider_instance_id_or_domain,[0m
[30;1m81 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m2084[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/albums.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m499 | [0m[35m                    fallback=search_result_item,[0m
[30;1m500 | [0m[35m                )[0m
[30;1m501 | [0m[35m                if compare_album(db_album, prov_album):[0m
[30;1m502 | [0m[35m                    # 100% match, we update the db with the additional provider mapping(s)[0m
[30;1m503 | [0m[35m                    match_found = True[0m
[30;1m504 | [0m[35m                    for provider_mapping in search_result_item.provider_mappings:[0m
[30;1m505 | [0m[35m                        await self.add_provider_mapping(db_album.item_id, provider_mapping)[0m

[31m--[ [0m[34mMatch #[0m[33m2085[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/albums.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m262 | [0m[35m                provider_track.metadata.images = album_images + track_images[0m
[30;1m263 | [0m[35m                result.append(provider_track)[0m
[30;1m264 | [0m[35m        # NOTE: we need to return the results sorted on disc/track here[0m
[30;1m265 | [0m[35m        # to ensure the correct order at playback[0m
[30;1m266 | [0m[35m        return sorted(result, key=lambda x: (x.disc_number, x.track_number))[0m
[30;1m267 | [0m[35m[0m
[30;1m268 | [0m[35m    async def versions([0m

[31m--[ [0m[34mMatch #[0m[33m2086[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/albums.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m522 | [0m[35m                cur_provider_domains.add(provider.domain)[0m
[30;1m523 | [0m[35m            else:[0m
[30;1m524 | [0m[35m                self.logger.debug([0m
[30;1m525 | [0m[35m                    "Could not find match for Album %s on provider %s",[0m
[30;1m526 | [0m[35m                    db_album.name,[0m
[30;1m527 | [0m[35m                    provider.name,[0m
[30;1m528 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m2087[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/albums.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m506 | [0m[35m                        db_album.provider_mappings.add(provider_mapping)[0m
[30;1m507 | [0m[35m            return match_found[0m
[30;1m508 | [0m[35m[0m
[30;1m509 | [0m[35m        # try to find match on all providers[0m
[30;1m510 | [0m[35m        cur_provider_domains = {x.provider_domain for x in db_album.provider_mappings}[0m
[30;1m511 | [0m[35m        for provider in self.mass.music.providers:[0m
[30;1m512 | [0m[35m            if provider.domain in cur_provider_domains:[0m

[31m--[ [0m[34mMatch #[0m[33m2088[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/albums.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m470 | [0m[35m        return ItemMapping.from_item(db_artist)[0m
[30;1m471 | [0m[35m[0m
[30;1m472 | [0m[35m    async def match_providers(self, db_album: Album) -> None:[0m
[30;1m473 | [0m[35m        """Try to find match on all (streaming) providers for the provided (database) album.[0m
[30;1m474 | [0m[35m[0m
[30;1m475 | [0m[35m        This is used to link objects of different providers/qualities together.[0m
[30;1m476 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m2089[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/albums.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m270 | [0m[35m        item_id: str,[0m
[30;1m271 | [0m[35m        provider_instance_id_or_domain: str,[0m
[30;1m272 | [0m[35m    ) -> UniqueList[Album]:[0m
[30;1m273 | [0m[35m        """Return all versions of an album we can find on all providers."""[0m
[30;1m274 | [0m[35m        album = await self.get_provider_item(item_id, provider_instance_id_or_domain)[0m
[30;1m275 | [0m[35m        search_query = f"{album.artists[0].name} - {album.name}" if album.artists else album.name[0m
[30;1m276 | [0m[35m        result: UniqueList[Album] = UniqueList()[0m

[31m--[ [0m[34mMatch #[0m[33m2090[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/playlists.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m385 | [0m[35m        if ([0m
[30;1m386 | [0m[35m            not force_refresh[0m
[30;1m387 | [0m[35m            and ([0m
[30;1m388 | [0m[35m                cache := await self.mass.cache.get([0m
[30;1m389 | [0m[35m                    cache_key,[0m
[30;1m390 | [0m[35m                    checksum=cache_checksum,[0m
[30;1m391 | [0m[35m                    category=cache_category,[0m

[31m--[ [0m[34mMatch #[0m[33m2091[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/playlists.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m203 | [0m[35m                    continue[0m
[30;1m204 | [0m[35m[0m
[30;1m205 | [0m[35m            # ensure we have a full (library) track (including all provider mappings)[0m
[30;1m206 | [0m[35m            full_track = await self.mass.music.tracks.get([0m
[30;1m207 | [0m[35m                item_id,[0m
[30;1m208 | [0m[35m                provider_instance_id_or_domain,[0m
[30;1m209 | [0m[35m                recursive=provider_instance_id_or_domain != "library",[0m

[31m--[ [0m[34mMatch #[0m[33m2092[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/playlists.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m        force_refresh: bool = False,[0m
[30;1m56 | [0m[35m    ) -> AsyncGenerator[Track, None]:[0m
[30;1m57 | [0m[35m        """Return playlist tracks for the given provider playlist id."""[0m
[30;1m58 | [0m[35m        playlist = await self.get([0m
[30;1m59 | [0m[35m            item_id,[0m
[30;1m60 | [0m[35m            provider_instance_id_or_domain,[0m
[30;1m61 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m2093[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/playlists.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m220 | [0m[35m                )[0m
[30;1m221 | [0m[35m[0m
[30;1m222 | [0m[35m            # a track can contain multiple versions on the same provider[0m
[30;1m223 | [0m[35m            # simply sort by quality and just add the first available version[0m
[30;1m224 | [0m[35m            for track_version in sorted([0m
[30;1m225 | [0m[35m                full_track.provider_mappings, key=lambda x: x.quality, reverse=True[0m
[30;1m226 | [0m[35m            ):[0m

[31m--[ [0m[34mMatch #[0m[33m2094[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/playlists.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom __future__ import annotations[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35mfrom collections.abc import AsyncGenerator[0m
[30;1m7 | [0m[35mfrom typing import Any[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mfrom music_assistant_models.enums import MediaType, ProviderFeature[0m

[31m--[ [0m[34mMatch #[0m[33m2095[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/audiobooks.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m236 | [0m[35m                    fallback=search_result_item,[0m
[30;1m237 | [0m[35m                )[0m
[30;1m238 | [0m[35m                if compare_audiobook(db_audiobook, prov_audiobook):[0m
[30;1m239 | [0m[35m                    # 100% match, we update the db with the additional provider mapping(s)[0m
[30;1m240 | [0m[35m                    match_found = True[0m
[30;1m241 | [0m[35m                    for provider_mapping in search_result_item.provider_mappings:[0m
[30;1m242 | [0m[35m                        await self.add_provider_mapping(db_audiobook.item_id, provider_mapping)[0m

[31m--[ [0m[34mMatch #[0m[33m2096[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/audiobooks.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m259 | [0m[35m                cur_provider_domains.add(provider.domain)[0m
[30;1m260 | [0m[35m            else:[0m
[30;1m261 | [0m[35m                self.logger.debug([0m
[30;1m262 | [0m[35m                    "Could not find match for Audiobook %s on provider %s",[0m
[30;1m263 | [0m[35m                    db_audiobook.name,[0m
[30;1m264 | [0m[35m                    provider.name,[0m
[30;1m265 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m2097[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/audiobooks.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m243 | [0m[35m                        db_audiobook.provider_mappings.add(provider_mapping)[0m
[30;1m244 | [0m[35m            return match_found[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m        # try to find match on all providers[0m
[30;1m247 | [0m[35m        cur_provider_domains = {x.provider_domain for x in db_audiobook.provider_mappings}[0m
[30;1m248 | [0m[35m        for provider in self.mass.music.providers:[0m
[30;1m249 | [0m[35m            if provider.domain in cur_provider_domains:[0m

[31m--[ [0m[34mMatch #[0m[33m2098[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/audiobooks.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m205 | [0m[35m        raise NotImplementedError(msg)[0m
[30;1m206 | [0m[35m[0m
[30;1m207 | [0m[35m    async def match_providers(self, db_audiobook: Audiobook) -> None:[0m
[30;1m208 | [0m[35m        """Try to find match on all (streaming) providers for the provided (database) audiobook.[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m        This is used to link objects of different providers/qualities together.[0m
[30;1m211 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m2099[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/audiobooks.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m104 | [0m[35m        item_id: str,[0m
[30;1m105 | [0m[35m        provider_instance_id_or_domain: str,[0m
[30;1m106 | [0m[35m    ) -> UniqueList[Audiobook]:[0m
[30;1m107 | [0m[35m        """Return all versions of an audiobook we can find on all providers."""[0m
[30;1m108 | [0m[35m        audiobook = await self.get_provider_item(item_id, provider_instance_id_or_domain)[0m
[30;1m109 | [0m[35m        search_query = audiobook.name[0m
[30;1m110 | [0m[35m        result: UniqueList[Audiobook] = UniqueList()[0m

[31m--[ [0m[34mMatch #[0m[33m2100[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/podcasts.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m289 | [0m[35m                    fallback=search_result_item,[0m
[30;1m290 | [0m[35m                )[0m
[30;1m291 | [0m[35m                if compare_podcast(db_podcast, prov_podcast):[0m
[30;1m292 | [0m[35m                    # 100% match, we update the db with the additional provider mapping(s)[0m
[30;1m293 | [0m[35m                    match_found = True[0m
[30;1m294 | [0m[35m                    for provider_mapping in search_result_item.provider_mappings:[0m
[30;1m295 | [0m[35m                        await self.add_provider_mapping(db_podcast.item_id, provider_mapping)[0m

[31m--[ [0m[34mMatch #[0m[33m2101[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/podcasts.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m312 | [0m[35m                cur_provider_domains.add(provider.domain)[0m
[30;1m313 | [0m[35m            else:[0m
[30;1m314 | [0m[35m                self.logger.debug([0m
[30;1m315 | [0m[35m                    "Could not find match for Podcast %s on provider %s",[0m
[30;1m316 | [0m[35m                    db_podcast.name,[0m
[30;1m317 | [0m[35m                    provider.name,[0m
[30;1m318 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m2102[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/podcasts.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m296 | [0m[35m                        db_podcast.provider_mappings.add(provider_mapping)[0m
[30;1m297 | [0m[35m            return match_found[0m
[30;1m298 | [0m[35m[0m
[30;1m299 | [0m[35m        # try to find match on all providers[0m
[30;1m300 | [0m[35m        cur_provider_domains = {x.provider_domain for x in db_podcast.provider_mappings}[0m
[30;1m301 | [0m[35m        for provider in self.mass.music.providers:[0m
[30;1m302 | [0m[35m            if provider.domain in cur_provider_domains:[0m

[31m--[ [0m[34mMatch #[0m[33m2103[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/podcasts.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m261 | [0m[35m        raise NotImplementedError(msg)[0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m    async def match_providers(self, db_podcast: Podcast) -> None:[0m
[30;1m264 | [0m[35m        """Try to find match on all (streaming) providers for the provided (database) podcast.[0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35m        This is used to link objects of different providers/qualities together.[0m
[30;1m267 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m2104[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/podcasts.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m134 | [0m[35m        item_id: str,[0m
[30;1m135 | [0m[35m        provider_instance_id_or_domain: str,[0m
[30;1m136 | [0m[35m    ) -> UniqueList[Podcast]:[0m
[30;1m137 | [0m[35m        """Return all versions of an podcast we can find on all providers."""[0m
[30;1m138 | [0m[35m        podcast = await self.get_provider_item(item_id, provider_instance_id_or_domain)[0m
[30;1m139 | [0m[35m        search_query = podcast.name[0m
[30;1m140 | [0m[35m        result: UniqueList[Podcast] = UniqueList()[0m

[31m--[ [0m[34mMatch #[0m[33m2105[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/workbox-3e911b1d.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m2106[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/workbox-3e911b1d.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m2107[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/workbox-3e911b1d.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m2108[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/workbox-3e911b1d.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m2109[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/workbox-3e911b1d.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m2110[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/workbox-3e911b1d.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m2111[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/workbox-3e911b1d.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m2112[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/workbox-3e911b1d.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m2113[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/workbox-3e911b1d.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m2114[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/workbox-3e911b1d.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m2115[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/workbox-3e911b1d.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m2116[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/workbox-3e911b1d.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m2117[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/workbox-3e911b1d.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m2118[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/workbox-3e911b1d.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m2119[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/workbox-3e911b1d.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m

[31m--[ [0m[34mMatch #[0m[33m2120[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/styles.css[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m39 | [0m[35m    padding: 13px;[0m
[30;1m40 | [0m[35m    color: white;[0m
[30;1m41 | [0m[35m    position: fixed; /* Set the navbar to fixed position */[0m
[30;1m42 | [0m[35m    top: 0; /* Position the navbar at the top of the page */[0m
[30;1m43 | [0m[35m    width: 100%; /* Full width */[0m
[30;1m44 | [0m[35m    font-size: 21px;[0m
[30;1m45 | [0m[35m    font-weight: 500;[0m

[31m--[ [0m[34mMatch #[0m[33m2121[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/styles.css[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m278 | [0m[35m    margin: 15% auto; /* 15% from the top and centered */[0m
[30;1m279 | [0m[35m    padding: 20px;[0m
[30;1m280 | [0m[35m    border: 1px solid #888;[0m
[30;1m281 | [0m[35m    width: 80%; /* Could be more or less, depending on screen size */[0m
[30;1m282 | [0m[35m}[0m
[30;1m283 | [0m[35m[0m
[30;1m284 | [0m[35m.client-input {[0m

[31m--[ [0m[34mMatch #[0m[33m2122[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/styles.css[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m275 | [0m[35m.client-setting-content {[0m
[30;1m276 | [0m[35m    background-color: #fefefe;[0m
[30;1m277 | [0m[35m    color: #686868;[0m
[30;1m278 | [0m[35m    margin: 15% auto; /* 15% from the top and centered */[0m
[30;1m279 | [0m[35m    padding: 20px;[0m
[30;1m280 | [0m[35m    border: 1px solid #888;[0m
[30;1m281 | [0m[35m    width: 80%; /* Could be more or less, depending on screen size */[0m

[31m--[ [0m[34mMatch #[0m[33m2123[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/styles.css[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m262 | [0m[35m .client-settings {[0m
[30;1m263 | [0m[35m    display: none; /* Hidden by default */[0m
[30;1m264 | [0m[35m    position: fixed; /* Stay in place */[0m
[30;1m265 | [0m[35m    z-index: 1; /* Sit on top */[0m
[30;1m266 | [0m[35m    left: 0;[0m
[30;1m267 | [0m[35m    top: 0;[0m
[30;1m268 | [0m[35m    width: 100%; /* Full width */[0m

[31m--[ [0m[34mMatch #[0m[33m2124[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/styles.css[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35m    padding: 13px;[0m
[30;1m40 | [0m[35m    color: white;[0m
[30;1m41 | [0m[35m    position: fixed; /* Set the navbar to fixed position */[0m
[30;1m42 | [0m[35m    top: 0; /* Position the navbar at the top of the page */[0m
[30;1m43 | [0m[35m    width: 100%; /* Full width */[0m
[30;1m44 | [0m[35m    font-size: 21px;[0m
[30;1m45 | [0m[35m    font-weight: 500;[0m

[31m--[ [0m[34mMatch #[0m[33m2125[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/snapcast/snapweb/styles.css[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m.navbar {[0m
[30;1m36 | [0m[35m    overflow: hidden;[0m
[30;1m37 | [0m[35m    background-color: #607d8b;[0m
[30;1m38 | [0m[35m    z-index: 1; /* Sit on top */[0m
[30;1m39 | [0m[35m    padding: 13px;[0m
[30;1m40 | [0m[35m    color: white;[0m
[30;1m41 | [0m[35m    position: fixed; /* Set the navbar to fixed position */[0m

[31m--[ [0m[34mMatch #[0m[33m2126[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/fully_kiosk/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m184 | [0m[35m        media: PlayerMedia,[0m
[30;1m185 | [0m[35m    ) -> None:[0m
[30;1m186 | [0m[35m        """Handle PLAY MEDIA on given player."""[0m
[30;1m187 | [0m[35m        if not (player := self.mass.players.get(player_id)):[0m
[30;1m188 | [0m[35m            return[0m
[30;1m189 | [0m[35m        await self._fully.playSound(media.uri, AUDIOMANAGER_STREAM_MUSIC)[0m
[30;1m190 | [0m[35m        player.current_media = media[0m

[31m--[ [0m[34mMatch #[0m[33m2127[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/fully_kiosk/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m172 | [0m[35m[0m
[30;1m173 | [0m[35m    async def cmd_stop(self, player_id: str) -> None:[0m
[30;1m174 | [0m[35m        """Send STOP command to given player."""[0m
[30;1m175 | [0m[35m        if not (player := self.mass.players.get(player_id, raise_unavailable=False)):[0m
[30;1m176 | [0m[35m            return[0m
[30;1m177 | [0m[35m        await self._fully.stopSound()[0m
[30;1m178 | [0m[35m        player.state = PlayerState.IDLE[0m

[31m--[ [0m[34mMatch #[0m[33m2128[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/fully_kiosk/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m161 | [0m[35m[0m
[30;1m162 | [0m[35m    async def cmd_volume_set(self, player_id: str, volume_level: int) -> None:[0m
[30;1m163 | [0m[35m        """Send VOLUME_SET command to given player."""[0m
[30;1m164 | [0m[35m        if not (player := self.mass.players.get(player_id, raise_unavailable=False)):[0m
[30;1m165 | [0m[35m            return[0m
[30;1m166 | [0m[35m        await self._fully.setAudioVolume(volume_level, AUDIOMANAGER_STREAM_MUSIC)[0m
[30;1m167 | [0m[35m        player.volume_level = volume_level[0m

[31m--[ [0m[34mMatch #[0m[33m2129[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/fully_kiosk/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m142 | [0m[35m                volume = volume_dict[str(AUDIOMANAGER_STREAM_MUSIC)][0m
[30;1m143 | [0m[35m                player.volume_level = volume[0m
[30;1m144 | [0m[35m                break[0m
[30;1m145 | [0m[35m        current_url = self._fully.deviceInfo.get("soundUrlPlaying")[0m
[30;1m146 | [0m[35m        player.current_item_id = current_url[0m
[30;1m147 | [0m[35m        if not current_url:[0m
[30;1m148 | [0m[35m            player.state = PlayerState.IDLE[0m

[31m--[ [0m[34mMatch #[0m[33m2130[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/fully_kiosk/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m137 | [0m[35m        if not (player := self.mass.players.get(player_id)):[0m
[30;1m138 | [0m[35m            return[0m
[30;1m139 | [0m[35m        player.name = self._fully.deviceInfo["deviceName"][0m
[30;1m140 | [0m[35m        for volume_dict in self._fully.deviceInfo.get("audioVolumes", []):[0m
[30;1m141 | [0m[35m            if str(AUDIOMANAGER_STREAM_MUSIC) in volume_dict:[0m
[30;1m142 | [0m[35m                volume = volume_dict[str(AUDIOMANAGER_STREAM_MUSIC)][0m
[30;1m143 | [0m[35m                player.volume_level = volume[0m

[31m--[ [0m[34mMatch #[0m[33m2131[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/fully_kiosk/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m134 | [0m[35m    def _handle_player_update(self) -> None:[0m
[30;1m135 | [0m[35m        """Update FullyKiosk player attributes."""[0m
[30;1m136 | [0m[35m        player_id = self._fully.deviceInfo["deviceID"][0m
[30;1m137 | [0m[35m        if not (player := self.mass.players.get(player_id)):[0m
[30;1m138 | [0m[35m            return[0m
[30;1m139 | [0m[35m        player.name = self._fully.deviceInfo["deviceName"][0m
[30;1m140 | [0m[35m        for volume_dict in self._fully.deviceInfo.get("audioVolumes", []):[0m

[31m--[ [0m[34mMatch #[0m[33m2132[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/fully_kiosk/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m108 | [0m[35m        """Call after the provider has been loaded."""[0m
[30;1m109 | [0m[35m        # Add FullyKiosk device to Player controller.[0m
[30;1m110 | [0m[35m        player_id = self._fully.deviceInfo["deviceID"][0m
[30;1m111 | [0m[35m        player = self.mass.players.get(player_id, raise_unavailable=False)[0m
[30;1m112 | [0m[35m        address = ([0m
[30;1m113 | [0m[35m            f"http://{self.config.get_value(CONF_IP_ADDRESS)}:{self.config.get_value(CONF_PORT)}"[0m
[30;1m114 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m2133[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/fully_kiosk/__init__.py[0m
   Pattern: [32m.hostname[0m
[30;1m59 | [0m[35m        ConfigEntry([0m
[30;1m60 | [0m[35m            key=CONF_IP_ADDRESS,[0m
[30;1m61 | [0m[35m            type=ConfigEntryType.STRING,[0m
[30;1m62 | [0m[35m            label="IP-Address (or hostname) of the device running Fully Kiosk/app.",[0m
[30;1m63 | [0m[35m            required=True,[0m
[30;1m64 | [0m[35m        ),[0m
[30;1m65 | [0m[35m        ConfigEntry([0m

[31m--[ [0m[34mMatch #[0m[33m2134[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/fully_kiosk/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mimport asyncio[0m
[30;1m6 | [0m[35mimport logging[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35mfrom typing import TYPE_CHECKING[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mfrom fullykiosk import FullyKiosk[0m
[30;1m11 | [0m[35mfrom music_assistant_models.config_entries import ConfigEntry, ConfigValueType[0m

[31m--[ [0m[34mMatch #[0m[33m2135[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/filesystem_local/constants.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m37 | [0m[35m    type=ConfigEntryType.STRING,[0m
[30;1m38 | [0m[35m    label="Content type in media folder(s)",[0m
[30;1m39 | [0m[35m    default_value="music",[0m
[30;1m40 | [0m[35m    description="The type of content to expect in the media folder(s)",[0m
[30;1m41 | [0m[35m    required=False,[0m
[30;1m42 | [0m[35m    options=[[0m
[30;1m43 | [0m[35m        ConfigValueOption("Music", "music"),[0m

[31m--[ [0m[34mMatch #[0m[33m2136[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/deezer/gw_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m157 | [0m[35m        )[0m
[30;1m158 | [0m[35m        result_json = await url_response.json()[0m
[30;1m159 | [0m[35m[0m
[30;1m160 | [0m[35m        if error := result_json["data"][0].get("errors"):[0m
[30;1m161 | [0m[35m            msg = "Received an error from API"[0m
[30;1m162 | [0m[35m            raise DeezerGWError(msg, error)[0m
[30;1m163 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2137[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/deezer/gw_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m150 | [0m[35m            ],[0m
[30;1m151 | [0m[35m            "track_tokens": [track_token],[0m
[30;1m152 | [0m[35m        }[0m
[30;1m153 | [0m[35m        url_response = await self.session.post([0m
[30;1m154 | [0m[35m            "https://media.deezer.com/v1/get_url",[0m
[30;1m155 | [0m[35m            json=url_data,[0m
[30;1m156 | [0m[35m            headers={"User-Agent": USER_AGENT_HEADER},[0m

[31m--[ [0m[34mMatch #[0m[33m2138[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/providers/deezer/gw_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m100 | [0m[35m            params = {}[0m
[30;1m101 | [0m[35m        parameters = {"api_version": "1.0", "api_token": csrf_token, "input": "3", "method": method}[0m
[30;1m102 | [0m[35m        parameters |= params[0m
[30;1m103 | [0m[35m        result = await self.session.request([0m
[30;1m104 | [0m[35m            http_method,[0m
[30;1m105 | [0m[35m            GW_LIGHT_URL,[0m
[30;1m106 | [0m[35m            params=parameters,[0m

[31m--[ [0m[34mMatch #[0m[33m2139[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/radio.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m34 | [0m[35m        provider_instance_id_or_domain: str,[0m
[30;1m35 | [0m[35m    ) -> list[Radio]:[0m
[30;1m36 | [0m[35m        """Return all versions of a radio station we can find on all providers."""[0m
[30;1m37 | [0m[35m        radio = await self.get(item_id, provider_instance_id_or_domain)[0m
[30;1m38 | [0m[35m        # perform a search on all provider(types) to collect all versions/variants[0m
[30;1m39 | [0m[35m        all_versions = {[0m
[30;1m40 | [0m[35m            prov_item.item_id: prov_item[0m

[31m--[ [0m[34mMatch #[0m[33m2140[0m[34m of [0m[33m2140[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/music_assistant-2.5.1/music_assistant/controllers/media/radio.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m33 | [0m[35m        item_id: str,[0m
[30;1m34 | [0m[35m        provider_instance_id_or_domain: str,[0m
[30;1m35 | [0m[35m    ) -> list[Radio]:[0m
[30;1m36 | [0m[35m        """Return all versions of a radio station we can find on all providers."""[0m
[30;1m37 | [0m[35m        radio = await self.get(item_id, provider_instance_id_or_domain)[0m
[30;1m38 | [0m[35m        # perform a search on all provider(types) to collect all versions/variants[0m
[30;1m39 | [0m[35m        all_versions = {[0m

2140 matches found.
