[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/templates/trtllm-audio/packages/whisper_trt/tokenizer.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m135 | [0m[35m    else:[0m
[30;1m136 | [0m[35m        vocab_path = os.path.join(tokenizer_dir, f"{name}.tiktoken")[0m
[30;1m137 | [0m[35m    ranks = {[0m
[30;1m138 | [0m[35m        base64.b64decode(token): int(rank)[0m
[30;1m139 | [0m[35m        for token, rank in (line.split() for line in open(vocab_path) if line)[0m
[30;1m140 | [0m[35m    }[0m
[30;1m141 | [0m[35m    n_vocab = len(ranks)[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/templates/trtllm-audio/packages/whisper_trt/tokenizer.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m13 | [0m[35m# See the License for the specific language governing permissions and[0m
[30;1m14 | [0m[35m# limitations under the License.[0m
[30;1m15 | [0m[35m# Modified from https://github.com/openai/whisper/blob/main/whisper/tokenizer.py[0m
[30;1m16 | [0m[35mimport base64[0m
[30;1m17 | [0m[35mimport os[0m
[30;1m18 | [0m[35mfrom typing import Optional[0m
[30;1m19 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/helpers/inference_server_controller.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m40 | [0m[35m        self._lock = threading.Lock()[0m
[30;1m41 | [0m[35m        self._process_controller = process_controller[0m
[30;1m42 | [0m[35m        self._patch_applier = patch_applier[0m
[30;1m43 | [0m[35m        self._current_running_hash = os.environ.get("HASH_TRUSS", None)[0m
[30;1m44 | [0m[35m        self._app_logger = app_logger[0m
[30;1m45 | [0m[35m        self._has_partially_applied_patch = False[0m
[30;1m46 | [0m[35m        self._inf_env = ([0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/core/server/test_secrets_resolver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m25 | [0m[35m    with _secrets_mount_dir(tmp_path), _override_env_var([0m
[30;1m26 | [0m[35m        "TRUSS_SECRET_secret_key", "secret_value_from_env"[0m
[30;1m27 | [0m[35m    ):[0m
[30;1m28 | [0m[35m        assert secrets["secret_key"] == "secret_value_from_mounted_secrets"[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m@contextmanager[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/core/server/test_secrets_resolver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m23 | [0m[35m    with (tmp_path / "secret_key").open("w") as f:[0m
[30;1m24 | [0m[35m        f.write("secret_value_from_mounted_secrets")[0m
[30;1m25 | [0m[35m    with _secrets_mount_dir(tmp_path), _override_env_var([0m
[30;1m26 | [0m[35m        "TRUSS_SECRET_secret_key", "secret_value_from_env"[0m
[30;1m27 | [0m[35m    ):[0m
[30;1m28 | [0m[35m        assert secrets["secret_key"] == "secret_value_from_mounted_secrets"[0m
[30;1m29 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/core/server/test_secrets_resolver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35mdef test_resolve_mounted_secrets(tmp_path):[0m
[30;1m22 | [0m[35m    secrets = SecretsResolver.get_secrets(CONFIG)[0m
[30;1m23 | [0m[35m    with (tmp_path / "secret_key").open("w") as f:[0m
[30;1m24 | [0m[35m        f.write("secret_value_from_mounted_secrets")[0m
[30;1m25 | [0m[35m    with _secrets_mount_dir(tmp_path), _override_env_var([0m
[30;1m26 | [0m[35m        "TRUSS_SECRET_secret_key", "secret_value_from_env"[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/core/server/test_secrets_resolver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m15 | [0m[35mdef test_resolve_env_var():[0m
[30;1m16 | [0m[35m    secrets = SecretsResolver.get_secrets(CONFIG)[0m
[30;1m17 | [0m[35m    with _override_env_var("TRUSS_SECRET_secret_key", "secret_value_from_env"):[0m
[30;1m18 | [0m[35m        assert secrets["secret_key"] == "secret_value_from_env"[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35mdef test_resolve_mounted_secrets(tmp_path):[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/core/server/test_secrets_resolver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mdef test_resolve_env_var():[0m
[30;1m16 | [0m[35m    secrets = SecretsResolver.get_secrets(CONFIG)[0m
[30;1m17 | [0m[35m    with _override_env_var("TRUSS_SECRET_secret_key", "secret_value_from_env"):[0m
[30;1m18 | [0m[35m        assert secrets["secret_key"] == "secret_value_from_env"[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/core/server/test_secrets_resolver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mdef test_resolve_default_value():[0m
[30;1m11 | [0m[35m    secrets = SecretsResolver.get_secrets(CONFIG)[0m
[30;1m12 | [0m[35m    assert secrets["secret_key"] == "default_secret_value"[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mdef test_resolve_env_var():[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/core/server/test_secrets_resolver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mfrom truss.templates.shared.secrets_resolver import SecretsResolver[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mCONFIG = {"secrets": {"secret_key": "default_secret_value"}}[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mdef test_resolve_default_value():[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/core/server/test_secrets_resolver.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m@contextmanager[0m
[30;1m42 | [0m[35mdef _override_env_var(key: str, value: str):[0m
[30;1m43 | [0m[35m    orig_value = os.environ.get(key, None)[0m
[30;1m44 | [0m[35m    try:[0m
[30;1m45 | [0m[35m        os.environ[key] = value[0m
[30;1m46 | [0m[35m        yield[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_truss_handle.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m439 | [0m[35m[0m
[30;1m440 | [0m[35m[0m
[30;1m441 | [0m[35m@pytest.mark.integration[0m
[30;1m442 | [0m[35mdef test_add_environment_variable(custom_model_truss_dir_with_pre_and_post):[0m
[30;1m443 | [0m[35m    th = TrussHandle(custom_model_truss_dir_with_pre_and_post)[0m
[30;1m444 | [0m[35m    th.add_environment_variable("test_env", "test_value")[0m
[30;1m445 | [0m[35m    tag = "test-add-env-var-tag:0.0.1"[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/templates/server/model_wrapper.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m952 | [0m[35m        model_init_params["lazy_data_resolver"] = lazy_data_resolver.fetch()[0m
[30;1m953 | [0m[35m    if _signature_accepts_keyword_arg(signature, "environment"):[0m
[30;1m954 | [0m[35m        environment = None[0m
[30;1m955 | [0m[35m        environment_str = dynamic_config_resolver.get_dynamic_config_value_sync([0m
[30;1m956 | [0m[35m            dynamic_config_resolver.ENVIRONMENT_DYNAMIC_CONFIG_KEY[0m
[30;1m957 | [0m[35m        )[0m
[30;1m958 | [0m[35m        if environment_str:[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/templates/server/model_wrapper.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m547 | [0m[35m                try:[0m
[30;1m548 | [0m[35m                    current_mtime = os.path.getmtime(environment_config_filename)[0m
[30;1m549 | [0m[35m                    if not last_modified_time or last_modified_time != current_mtime:[0m
[30;1m550 | [0m[35m                        environment_str = await dynamic_config_resolver.get_dynamic_config_value_asy[0m
[30;1m551 | [0m[35m                            dynamic_config_resolver.ENVIRONMENT_DYNAMIC_CONFIG_KEY[0m
[30;1m552 | [0m[35m                        )[0m
[30;1m553 | [0m[35m                        if environment_str:[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/templates/server/model_wrapper.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m507 | [0m[35m            self._logger.info([0m
[30;1m508 | [0m[35m                f"Executing model.setup_environment with environment: {environment_json}"[0m
[30;1m509 | [0m[35m            )[0m
[30;1m510 | [0m[35m            # TODO: Support calling an async setup_environment() here once we support async load()[0m
[30;1m511 | [0m[35m            self._model.setup_environment(environment_json)[0m
[30;1m512 | [0m[35m            self._environment = environment_json[0m
[30;1m513 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/templates/server/model_wrapper.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m499 | [0m[35m        )[0m
[30;1m500 | [0m[35m[0m
[30;1m501 | [0m[35m    def _initialize_environment_before_load(self):[0m
[30;1m502 | [0m[35m        environment_str = dynamic_config_resolver.get_dynamic_config_value_sync([0m
[30;1m503 | [0m[35m            dynamic_config_resolver.ENVIRONMENT_DYNAMIC_CONFIG_KEY[0m
[30;1m504 | [0m[35m        )[0m
[30;1m505 | [0m[35m        if environment_str:[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/templates/server/model_wrapper.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m494 | [0m[35m            )[0m
[30;1m495 | [0m[35m[0m
[30;1m496 | [0m[35m    def setup_polling_for_environment_updates(self):[0m
[30;1m497 | [0m[35m        self._poll_for_environment_updates_task = asyncio.create_task([0m
[30;1m498 | [0m[35m            self.poll_for_environment_updates()[0m
[30;1m499 | [0m[35m        )[0m
[30;1m500 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/templates/server/model_wrapper.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m319 | [0m[35m    _logger: logging.Logger[0m
[30;1m320 | [0m[35m    _status: "ModelWrapper.Status"[0m
[30;1m321 | [0m[35m    _predict_semaphore: Semaphore[0m
[30;1m322 | [0m[35m    _poll_for_environment_updates_task: Optional[asyncio.Task][0m
[30;1m323 | [0m[35m    _environment: Optional[dict][0m
[30;1m324 | [0m[35m[0m
[30;1m325 | [0m[35m    class Status(enum.Enum):[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/templates/server/model_wrapper.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35mMODEL_BASENAME = "model"[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35mNUM_LOAD_RETRIES = int(os.environ.get("NUM_LOAD_RETRIES_TRUSS", "1"))[0m
[30;1m43 | [0m[35mSTREAMING_RESPONSE_QUEUE_READ_TIMEOUT_SECS = 60[0m
[30;1m44 | [0m[35mDEFAULT_PREDICT_CONCURRENCY = 1[0m
[30;1m45 | [0m[35mEXTENSIONS_DIR_NAME = "extensions"[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/utils/transfer.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mdef base64_encoded_json_str(obj):[0m
[30;1m16 | [0m[35m    return base64.b64encode(str.encode(json.dumps(obj))).decode("utf-8")[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35mdef multipart_upload_boto3([0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/utils/transfer.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mimport contextlib[0m
[30;1m3 | [0m[35mimport json[0m
[30;1m4 | [0m[35mimport os[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m908 | [0m[35m    class Model:[0m
[30;1m909 | [0m[35m        def setup_environment(self, environment: Optional[dict]):[0m
[30;1m910 | [0m[35m            print("setup_environment called with", environment)[0m
[30;1m911 | [0m[35m            self.environment_name = environment.get("name") if environment else None[0m
[30;1m912 | [0m[35m            print(f"in {self.environment_name} environment")[0m
[30;1m913 | [0m[35m[0m
[30;1m914 | [0m[35m        def load(self):[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m869 | [0m[35m    class Model:[0m
[30;1m870 | [0m[35m        def setup_environment(self, environment: Optional[dict]):[0m
[30;1m871 | [0m[35m            print("setup_environment called with", environment)[0m
[30;1m872 | [0m[35m            self.environment_name = environment.get("name") if environment else None[0m
[30;1m873 | [0m[35m            print(f"in {self.environment_name} environment")[0m
[30;1m874 | [0m[35m[0m
[30;1m875 | [0m[35m        def predict(self, model_input):[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m826 | [0m[35m        def __init__(self, **kwargs):[0m
[30;1m827 | [0m[35m            self._config = kwargs["config"][0m
[30;1m828 | [0m[35m            self._environment = kwargs["environment"][0m
[30;1m829 | [0m[35m            self.environment_name = self._environment.get("name") if self._environment else None[0m
[30;1m830 | [0m[35m[0m
[30;1m831 | [0m[35m        def load(self):[0m
[30;1m832 | [0m[35m            print(f"Executing model.load with environment: {self.environment_name}")[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/templates/shared/log_config.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mdef _disable_json_logging() -> bool:[0m
[30;1m12 | [0m[35m    return bool(os.environ.get("DISABLE_JSON_LOGGING"))[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mclass _HealthCheckFilter(logging.Filter):[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/pydantic_numpy.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m100 | [0m[35m    ):[0m
[30;1m101 | [0m[35m        if info.mode == "json":[0m
[30;1m102 | [0m[35m            return {[0m
[30;1m103 | [0m[35m                cls.data_key: base64.b64encode(obj.array.tobytes()).decode("utf-8"),[0m
[30;1m104 | [0m[35m                cls.shape_key: obj.array.shape,[0m
[30;1m105 | [0m[35m                cls.dtype_key: str(obj.array.dtype),[0m
[30;1m106 | [0m[35m            }[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/pydantic_numpy.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m73 | [0m[35m        keys = {cls.data_key, cls.shape_key, cls.dtype_key}[0m
[30;1m74 | [0m[35m        if isinstance(value, dict) and keys.issubset(value):[0m
[30;1m75 | [0m[35m            try:[0m
[30;1m76 | [0m[35m                data = base64.b64decode(value[cls.data_key])[0m
[30;1m77 | [0m[35m                array = np.frombuffer(data, dtype=value[cls.dtype_key]).reshape([0m
[30;1m78 | [0m[35m                    value[cls.shape_key][0m
[30;1m79 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/pydantic_numpy.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mfrom typing import TYPE_CHECKING, Any, ClassVar[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mimport pydantic[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/baseten/test_api.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m12 | [0m[35mdef mock_auth_service():[0m
[30;1m13 | [0m[35m    auth_service = mock.Mock()[0m
[30;1m14 | [0m[35m    auth_token = mock.Mock(headers=lambda: {"Authorization": "Api-Key token"})[0m
[30;1m15 | [0m[35m    auth_service.authenticate.return_value = auth_token[0m
[30;1m16 | [0m[35m    return auth_service[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/baseten/test_api.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m11 | [0m[35m@pytest.fixture[0m
[30;1m12 | [0m[35mdef mock_auth_service():[0m
[30;1m13 | [0m[35m    auth_service = mock.Mock()[0m
[30;1m14 | [0m[35m    auth_token = mock.Mock(headers=lambda: {"Authorization": "Api-Key token"})[0m
[30;1m15 | [0m[35m    auth_service.authenticate.return_value = auth_token[0m
[30;1m16 | [0m[35m    return auth_service[0m
[30;1m17 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/baseten/test_api.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m304 | [0m[35m[0m
[30;1m305 | [0m[35m[0m
[30;1m306 | [0m[35m@mock.patch("requests.post", return_value=mock_deploy_chain_deployment_response())[0m
[30;1m307 | [0m[35mdef test_deploy_chain_deployment_no_environment(mock_post, baseten_api):[0m
[30;1m308 | [0m[35m    baseten_api.deploy_chain_atomic([0m
[30;1m309 | [0m[35m        chain_id="chain_id",[0m
[30;1m310 | [0m[35m        dependencies=[],[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m### Get an API key[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35mTo set up the Baseten remote, you'll need a [Baseten API key](https://app.baseten.co/settings/accoun[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m### Run `truss push`[0m
[30;1m103 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/base/trt_llm_config.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m18 | [0m[35mwarnings.filterwarnings("ignore", category=PydanticDeprecatedSince20)[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35mENGINE_BUILDER_TRUSS_RUNTIME_MIGRATION = ([0m
[30;1m21 | [0m[35m    os.environ.get("ENGINE_BUILDER_TRUSS_RUNTIME_MIGRATION", "False") == "True"[0m
[30;1m22 | [0m[35m)[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/server.Dockerfile[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35mCOPY ./packages /packages[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35mENV INFERENCE_SERVER_PORT="8080"[0m
[30;1m47 | [0m[35mENV SERVER_START_CMD="/usr/local/bin/python3 /app/main.py"[0m
[30;1m48 | [0m[35mENTRYPOINT ["/usr/local/bin/python3", "/app/main.py"][0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/helpers/inference_server_process_controller.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m    def start(self, inf_env: dict):[0m
[30;1m39 | [0m[35m        with current_directory(self._inference_server_home):[0m
[30;1m40 | [0m[35m            inf_env["INFERENCE_SERVER_PORT"] = str(self._inference_server_port)[0m
[30;1m41 | [0m[35m            self._inference_server_process = subprocess.Popen([0m
[30;1m42 | [0m[35m                self._inference_server_process_args, env=inf_env[0m
[30;1m43 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_control_truss_patching.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m284 | [0m[35mclass Model:[0m
[30;1m285 | [0m[35m    def predict(self, model_input):[0m
[30;1m286 | [0m[35m        print(os.environ.copy())[0m
[30;1m287 | [0m[35m        return os.environ.get("foo", "No foo :(")[0m
[30;1m288 | [0m[35m"""[0m
[30;1m289 | [0m[35m        update_model_code(truss_dir, new_model_code)[0m
[30;1m290 | [0m[35m        result = th.docker_predict([1], tag=tag)[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/util/jinja.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m6 | [0m[35mdef read_template_from_fs(base_dir: Path, template_file_name: str) -> Template:[0m
[30;1m7 | [0m[35m    template_loader = FileSystemLoader(str(base_dir))[0m
[30;1m8 | [0m[35m    template_env = Environment(loader=template_loader)[0m
[30;1m9 | [0m[35m    return template_env.get_template(template_file_name)[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/templates/shared/lazy_data_resolver.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m61 | [0m[35m        self._bptr_resolution: Dict[str, Tuple[str, str, int]] = _read_bptr_resolution()[0m
[30;1m62 | [0m[35m        self._resolution_done = False[0m
[30;1m63 | [0m[35m        self._uses_b10_cache = ([0m
[30;1m64 | [0m[35m            os.environ.get(BASETEN_FS_ENABLED_ENV_VAR, "False") == "True"[0m
[30;1m65 | [0m[35m        )[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m    def cached_download_from_url_using_requests([0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/definitions.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m466 | [0m[35m          This is used to create RPC sessions to dependency chainlets. It contains only[0m
[30;1m467 | [0m[35m          the chainlet services that are dependencies of the current chainlet.[0m
[30;1m468 | [0m[35m        secrets: A mapping from secret names to secret values. It contains only the[0m
[30;1m469 | [0m[35m          secrets that are listed in ``remote_config.assets.secret_keys`` of the[0m
[30;1m470 | [0m[35m          current chainlet.[0m
[30;1m471 | [0m[35m        environment: The environment that the chainlet is deployed in.[0m
[30;1m472 | [0m[35m          None if the chainlet is not associated with an environment.[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/definitions.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m387 | [0m[35m                        pip_requirements=["torch==2.0.1", ...][0m
[30;1m388 | [0m[35m                    ),[0m
[30;1m389 | [0m[35m                    compute=chains.Compute(cpu_count=2, gpu="A10G", ...),[0m
[30;1m390 | [0m[35m                    assets=chains.Assets(secret_keys=["hf_access_token"], ...),[0m
[30;1m391 | [0m[35m                )[0m
[30;1m392 | [0m[35m[0m
[30;1m393 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/definitions.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m336 | [0m[35m        """[0m
[30;1m337 | [0m[35m        self._spec = AssetSpec([0m
[30;1m338 | [0m[35m            cached=list(cached),[0m
[30;1m339 | [0m[35m            secrets={k: SECRET_DUMMY for k in secret_keys},[0m
[30;1m340 | [0m[35m            external_data=list(external_data),[0m
[30;1m341 | [0m[35m        )[0m
[30;1m342 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/definitions.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m326 | [0m[35m        """[0m
[30;1m327 | [0m[35m        Args:[0m
[30;1m328 | [0m[35m            cached: One or more ``truss_config.ModelRepo`` objects.[0m
[30;1m329 | [0m[35m            secret_keys: Names of secrets stored on baseten, that the[0m
[30;1m330 | [0m[35m              chainlet should have access to. You can manage secrets on baseten[0m
[30;1m331 | [0m[35m              `here <https://app.baseten.co/settings/secrets>`_.[0m
[30;1m332 | [0m[35m            external_data: Data to be downloaded from public URLs and made available[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/definitions.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m320 | [0m[35m    def __init__([0m
[30;1m321 | [0m[35m        self,[0m
[30;1m322 | [0m[35m        cached: Iterable[truss_config.ModelRepo] = (),[0m
[30;1m323 | [0m[35m        secret_keys: Iterable[str] = (),[0m
[30;1m324 | [0m[35m        external_data: Iterable[truss_config.ExternalDataItem] = (),[0m
[30;1m325 | [0m[35m    ) -> None:[0m
[30;1m326 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/definitions.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m314 | [0m[35m    """[0m
[30;1m315 | [0m[35m[0m
[30;1m316 | [0m[35m    # Builder to create asset spec.[0m
[30;1m317 | [0m[35m    # This extra layer around `AssetSpec` is needed to add secret_keys.[0m
[30;1m318 | [0m[35m    _spec: AssetSpec[0m
[30;1m319 | [0m[35m[0m
[30;1m320 | [0m[35m    def __init__([0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/PKG-INFO[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m### Get an API key[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35mTo set up the Baseten remote, you'll need a [Baseten API key](https://app.baseten.co/settings/accoun[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m### Run `truss push`[0m
[30;1m154 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m632 | [0m[35m            requirements_file=d.get("requirements_file", None),[0m
[30;1m633 | [0m[35m            requirements=d.get("requirements", []),[0m
[30;1m634 | [0m[35m            system_packages=d.get("system_packages", []),[0m
[30;1m635 | [0m[35m            environment_variables=_handle_env_vars(d.get("environment_variables", {})),[0m
[30;1m636 | [0m[35m            resources=Resources.from_dict(d.get("resources", {})),[0m
[30;1m637 | [0m[35m            runtime=Runtime.from_dict(d.get("runtime", {})),[0m
[30;1m638 | [0m[35m            build=Build.from_dict(d.get("build", {})),[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/contexts/image_builder/cache_warmer.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35mdef _b10cp_path() -> Optional[str]:[0m
[30;1m25 | [0m[35m    return os.environ.get(B10CP_PATH_TRUSS_ENV_VAR_NAME)[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35mdef _download_from_url_using_b10cp(b10cp_path: str, url: str, download_to: Path):[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/util/env_vars.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    def __enter__(self):[0m
[30;1m24 | [0m[35m        for key in self.env_vars:[0m
[30;1m25 | [0m[35m            self.original_vars[key] = os.environ.get(key)[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m        for key, value in self.env_vars.items():[0m
[30;1m28 | [0m[35m            os.environ[key] = value[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_custom_server_truss/test_docker_image/app.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m14 | [0m[35masync def root():[0m
[30;1m15 | [0m[35m    return {[0m
[30;1m16 | [0m[35m        "message": "Hello World",[0m
[30;1m17 | [0m[35m        "is_env_var_passed": os.environ.get("HF_TOKEN") is not None,[0m
[30;1m18 | [0m[35m        "is_secret_mounted": os.path.exists("/secrets/hf_access_token"),[0m
[30;1m19 | [0m[35m    }[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/util/.truss_ignore[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m91 | [0m[35m# pipenv[0m
[30;1m92 | [0m[35m#   According to pypa/pipenv#598, it is recommended to include Pipfile.lock in version control.[0m
[30;1m93 | [0m[35m#   However, in case of collaboration, if having platform-specific dependencies or dependencies[0m
[30;1m94 | [0m[35m#   having no cross-platform support, pipenv may install dependencies that don't work, or not[0m
[30;1m95 | [0m[35m#   install all needed dependencies.[0m
[30;1m96 | [0m[35m#Pipfile.lock[0m
[30;1m97 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/util/.truss_ignore[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m89 | [0m[35m# .python-version[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m# pipenv[0m
[30;1m92 | [0m[35m#   According to pypa/pipenv#598, it is recommended to include Pipfile.lock in version control.[0m
[30;1m93 | [0m[35m#   However, in case of collaboration, if having platform-specific dependencies or dependencies[0m
[30;1m94 | [0m[35m#   having no cross-platform support, pipenv may install dependencies that don't work, or not[0m
[30;1m95 | [0m[35m#   install all needed dependencies.[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/core.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m414 | [0m[35m[0m
[30;1m415 | [0m[35m    Args:[0m
[30;1m416 | [0m[35m        api: BasetenApi instance[0m
[30;1m417 | [0m[35m        config: Base64 encoded JSON string of the Truss config[0m
[30;1m418 | [0m[35m[0m
[30;1m419 | [0m[35m    Returns:[0m
[30;1m420 | [0m[35m        None if the config is valid, otherwise raises an error message[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/core.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m342 | [0m[35m        api: BasetenApi instance.[0m
[30;1m343 | [0m[35m        model_name: Name of the model to create.[0m
[30;1m344 | [0m[35m        s3_key: S3 key of the uploaded TrussHandle.[0m
[30;1m345 | [0m[35m        config: Base64 encoded JSON string of the Truss config.[0m
[30;1m346 | [0m[35m        semver_bump: Semver bump type, defaults to "MINOR".[0m
[30;1m347 | [0m[35m        is_trusted: Whether the model is trusted, defaults to False.[0m
[30;1m348 | [0m[35m        promote: Whether to promote the model after deploy, defaults to False.[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/core/server/test_dynamic_config_resolver.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m92 | [0m[35m        tmp_path / dynamic_config_resolver.ENVIRONMENT_DYNAMIC_CONFIG_KEY, "w"[0m
[30;1m93 | [0m[35m    ) as f:[0m
[30;1m94 | [0m[35m        await f.write(json.dumps(config))[0m
[30;1m95 | [0m[35m    environment_str = await dynamic_config_resolver.get_dynamic_config_value_async([0m
[30;1m96 | [0m[35m        dynamic_config_resolver.ENVIRONMENT_DYNAMIC_CONFIG_KEY[0m
[30;1m97 | [0m[35m    )[0m
[30;1m98 | [0m[35m    assert json.loads(environment_str) == config[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/core/server/test_dynamic_config_resolver.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m85 | [0m[35m@pytest.mark.parametrize([0m
[30;1m86 | [0m[35m    "config", [{"environment_name": "production", "foo": "bar"}, {}, "", None][0m
[30;1m87 | [0m[35m)[0m
[30;1m88 | [0m[35masync def test_get_dynamic_config_environment_value_async([0m
[30;1m89 | [0m[35m    config, tmp_path, dynamic_config_mount_dir[0m
[30;1m90 | [0m[35m):[0m
[30;1m91 | [0m[35m    async with aiofiles.open([0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/core/server/test_dynamic_config_resolver.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m40 | [0m[35m        "w"[0m
[30;1m41 | [0m[35m    ) as f:[0m
[30;1m42 | [0m[35m        f.write(json.dumps(config))[0m
[30;1m43 | [0m[35m    environment_str = dynamic_config_resolver.get_dynamic_config_value_sync([0m
[30;1m44 | [0m[35m        dynamic_config_resolver.ENVIRONMENT_DYNAMIC_CONFIG_KEY[0m
[30;1m45 | [0m[35m    )[0m
[30;1m46 | [0m[35m    assert json.loads(environment_str) == config[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/core/server/test_dynamic_config_resolver.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m33 | [0m[35m@pytest.mark.parametrize([0m
[30;1m34 | [0m[35m    "config", [{"environment_name": "production", "foo": "bar"}, {}, "", None][0m
[30;1m35 | [0m[35m)[0m
[30;1m36 | [0m[35mdef test_get_dynamic_config_environment_value_sync([0m
[30;1m37 | [0m[35m    config, tmp_path, dynamic_config_mount_dir[0m
[30;1m38 | [0m[35m):[0m
[30;1m39 | [0m[35m    with (tmp_path / dynamic_config_resolver.ENVIRONMENT_DYNAMIC_CONFIG_KEY).open([0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/deployment/deployment_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m475 | [0m[35m            "Creating secret automatically."[0m
[30;1m476 | [0m[35m        )[0m
[30;1m477 | [0m[35m        remote_provider.api.upsert_secret([0m
[30;1m478 | [0m[35m            definitions.BASETEN_API_SECRET_NAME, remote_provider.api.auth_token.value[0m
[30;1m479 | [0m[35m        )[0m
[30;1m480 | [0m[35m[0m
[30;1m481 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m121 | [0m[35mENV SERVER_START_CMD="/control/.env/bin/python3 /control/control/server.py"[0m
[30;1m122 | [0m[35mENTRYPOINT ["/control/.env/bin/python3", "/control/control/server.py"][0m
[30;1m123 | [0m[35m    {%- else %}[0m
[30;1m124 | [0m[35mENV INFERENCE_SERVER_PORT="8080"[0m
[30;1m125 | [0m[35mENV SERVER_START_CMD="{{(config.base_image.python_executable_path or "python3") ~ " /app/main.py"}}"[0m
[30;1m126 | [0m[35mENTRYPOINT ["{{config.base_image.python_executable_path or "python3"}}", "/app/main.py"][0m
[30;1m127 | [0m[35m    {%- endif %}[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m117 | [0m[35m    {%- elif config.live_reload %}[0m
[30;1m118 | [0m[35mENV HASH_TRUSS="{{truss_hash}}"[0m
[30;1m119 | [0m[35mENV CONTROL_SERVER_PORT="8080"[0m
[30;1m120 | [0m[35mENV INFERENCE_SERVER_PORT="8090"[0m
[30;1m121 | [0m[35mENV SERVER_START_CMD="/control/.env/bin/python3 /control/control/server.py"[0m
[30;1m122 | [0m[35mENTRYPOINT ["/control/.env/bin/python3", "/control/control/server.py"][0m
[30;1m123 | [0m[35m    {%- else %}[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/contexts/docker_build_setup.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m35 | [0m[35m    tr = truss_handle.TrussHandle(TRUSS_SRC_DIR)[0m
[30;1m36 | [0m[35m    logging.info("Truss is loaded")[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m    if patches_dir := os.environ.get("PATCHES_DIR"):[0m
[30;1m39 | [0m[35m        logging.info("Applying patches")[0m
[30;1m40 | [0m[35m        logger = logging.getLogger("patch_applier")[0m
[30;1m41 | [0m[35m        patch_applier = TrussDirPatchApplier(TRUSS_SRC_DIR, logger)[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/util/download.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35mdef _b10cp_path() -> Optional[str]:[0m
[30;1m40 | [0m[35m    return os.environ.get(B10CP_PATH_TRUSS_ENV_VAR_NAME)[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35mdef _download_external_data_using_b10cp([0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/templates/trtllm-audio/model/model.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m35 | [0m[35m        binary_data = None[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m        if audio_base64:[0m
[30;1m38 | [0m[35m            binary_data = base64.b64decode(audio_base64.encode("utf-8"))[0m
[30;1m39 | [0m[35m        elif audio_url:[0m
[30;1m40 | [0m[35m            resp = requests.get(audio_url)[0m
[30;1m41 | [0m[35m            binary_data = resp.content[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/templates/trtllm-audio/model/model.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m29 | [0m[35m            }[0m
[30;1m30 | [0m[35m        if not audio_base64 and not audio_url:[0m
[30;1m31 | [0m[35m            return {[0m
[30;1m32 | [0m[35m                "error": "Please provide either an audio file in base64 string format or a URL to an[0m
[30;1m33 | [0m[35m            }[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m        binary_data = None[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/templates/trtllm-audio/model/model.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m        if audio_base64 and audio_url:[0m
[30;1m27 | [0m[35m            return {[0m
[30;1m28 | [0m[35m                "error": "Only a base64 audio file OR a URL can be passed to the API, not both of th[0m
[30;1m29 | [0m[35m            }[0m
[30;1m30 | [0m[35m        if not audio_base64 and not audio_url:[0m
[30;1m31 | [0m[35m            return {[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/templates/trtllm-audio/model/model.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport requests[0m
[30;1m4 | [0m[35mimport sigint_patch[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/server.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m5 | [0m[35mfrom application import create_app[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mCONTROL_SERVER_PORT = int(os.environ.get("CONTROL_SERVER_PORT", "8080"))[0m
[30;1m8 | [0m[35mINFERENCE_SERVER_PORT = int(os.environ.get("INFERENCE_SERVER_PORT", "8090"))[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mdef _identify_python_executable_path() -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/server.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m4 | [0m[35mimport uvicorn[0m
[30;1m5 | [0m[35mfrom application import create_app[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mCONTROL_SERVER_PORT = int(os.environ.get("CONTROL_SERVER_PORT", "8080"))[0m
[30;1m8 | [0m[35mINFERENCE_SERVER_PORT = int(os.environ.get("INFERENCE_SERVER_PORT", "8090"))[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/auth.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m20 | [0m[35mclass AuthService:[0m
[30;1m21 | [0m[35m    def __init__(self, api_key: Optional[str] = None) -> None:[0m
[30;1m22 | [0m[35m        if not api_key:[0m
[30;1m23 | [0m[35m            api_key = os.environ.get("BASETEN_API_KEY", None)[0m
[30;1m24 | [0m[35m        self._api_key = api_key[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    def validate(self) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/helpers/inference_server_starter.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m29 | [0m[35m    {"is_current": true}[0m
[30;1m30 | [0m[35m    {"accepted": true}[0m
[30;1m31 | [0m[35m    """[0m
[30;1m32 | [0m[35m    patch_ping_url = os.environ.get("PATCH_PING_URL_TRUSS")[0m
[30;1m33 | [0m[35m    if patch_ping_url is None:[0m
[30;1m34 | [0m[35m        inference_server_controller.start()[0m
[30;1m35 | [0m[35m        return[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/api.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m527 | [0m[35m        return secret_info[0m
[30;1m528 | [0m[35m[0m
[30;1m529 | [0m[35m    def get_all_secrets(self) -> Any:[0m
[30;1m530 | [0m[35m        headers = self._auth_token.header()[0m
[30;1m531 | [0m[35m        resp = requests.get(f"{self._rest_api_url}/v1/secrets", headers=headers)[0m
[30;1m532 | [0m[35m        if not resp.ok:[0m
[30;1m533 | [0m[35m            resp.raise_for_status()[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/api.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m515 | [0m[35m        return deployment[0m
[30;1m516 | [0m[35m[0m
[30;1m517 | [0m[35m    def upsert_secret(self, name: str, value: str) -> Any:[0m
[30;1m518 | [0m[35m        headers = self._auth_token.header()[0m
[30;1m519 | [0m[35m        data = {"name": name, "value": value}[0m
[30;1m520 | [0m[35m        resp = requests.post([0m
[30;1m521 | [0m[35m            f"{self._rest_api_url}/v1/secrets", headers=headers, json=data[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/api.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m503 | [0m[35m        return resp["data"]["truss_validation"][0m
[30;1m504 | [0m[35m[0m
[30;1m505 | [0m[35m    def get_deployment(self, model_id: str, deployment_id: str) -> Any:[0m
[30;1m506 | [0m[35m        headers = self._auth_token.header()[0m
[30;1m507 | [0m[35m        resp = requests.get([0m
[30;1m508 | [0m[35m            f"{self._rest_api_url}/v1/models/{model_id}/deployments/{deployment_id}",[0m
[30;1m509 | [0m[35m            headers=headers,[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/api.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m335 | [0m[35m[0m
[30;1m336 | [0m[35m    def delete_chain_deployment(self, chain_id: str, chain_deployment_id: str) -> Any:[0m
[30;1m337 | [0m[35m        url = f"{self._rest_api_url}/v1/chains/{chain_id}/deployments/{chain_deployment_id}"[0m
[30;1m338 | [0m[35m        headers = self._auth_token.header()[0m
[30;1m339 | [0m[35m        resp = requests.delete(url, headers=headers)[0m
[30;1m340 | [0m[35m        if not resp.ok:[0m
[30;1m341 | [0m[35m            resp.raise_for_status()[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/api.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m325 | [0m[35m[0m
[30;1m326 | [0m[35m    def delete_chain(self, chain_id: str) -> Any:[0m
[30;1m327 | [0m[35m        url = f"{self._rest_api_url}/v1/chains/{chain_id}"[0m
[30;1m328 | [0m[35m        headers = self._auth_token.header()[0m
[30;1m329 | [0m[35m        resp = requests.delete(url, headers=headers)[0m
[30;1m330 | [0m[35m        if not resp.ok:[0m
[30;1m331 | [0m[35m            resp.raise_for_status()[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/api.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m87 | [0m[35m        return self._auth_token[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m    def _post_graphql_query(self, query_string: str) -> dict:[0m
[30;1m90 | [0m[35m        headers = self._auth_token.header()[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m        resp = requests.post([0m
[30;1m93 | [0m[35m            self._graphql_api_url,[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/api.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m    @property[0m
[30;1m86 | [0m[35m    def auth_token(self) -> ApiKey:[0m
[30;1m87 | [0m[35m        return self._auth_token[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m    def _post_graphql_query(self, query_string: str) -> dict:[0m
[30;1m90 | [0m[35m        headers = self._auth_token.header()[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/api.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m83 | [0m[35m        return self._rest_api_url[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m    @property[0m
[30;1m86 | [0m[35m    def auth_token(self) -> ApiKey:[0m
[30;1m87 | [0m[35m        return self._auth_token[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m    def _post_graphql_query(self, query_string: str) -> dict:[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/api.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m72 | [0m[35m        self._graphql_api_url = graphql_api_url[0m
[30;1m73 | [0m[35m        self._rest_api_url = rest_api_url[0m
[30;1m74 | [0m[35m        self._auth_service = auth_service[0m
[30;1m75 | [0m[35m        self._auth_token = self._auth_service.authenticate()[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m    @property[0m
[30;1m78 | [0m[35m    def app_url(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/remote/remote_factory.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m17 | [0m[35mfrom truss.remote.baseten import BasetenRemote[0m
[30;1m18 | [0m[35mfrom truss.remote.truss_remote import RemoteConfig, TrussRemote[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35mUSER_TRUSSRC_PATH = Path(os.environ.get("USER_TRUSSRC_PATH", "~/.trussrc")).expanduser()[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mdef load_config() -> ConfigParser:[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/truss-0.60.0/truss/templates/server/main.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m5 | [0m[35mCONFIG_FILE = "config.yaml"[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mif __name__ == "__main__":[0m
[30;1m8 | [0m[35m    http_port = int(os.environ.get("INFERENCE_SERVER_PORT", "8080"))[0m
[30;1m9 | [0m[35m    TrussServer(http_port, CONFIG_FILE).start()[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/core/server/test_lazy_data_resolver_v2.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m24 | [0m[35m                "uid": "8c6b2f215f0333437cdc3fe7c79be0c802847d2f2a0ccdc0bb251814e63cf375",[0m
[30;1m25 | [0m[35m                "file_name": TARGET_FILE.as_posix(),[0m
[30;1m26 | [0m[35m                "hashtype": "blake3",[0m
[30;1m27 | [0m[35m                "hash": "8c6b2f215f0333437cdc3fe7c79be0c802847d2f2a0ccdc0bb251814e63cf375",[0m
[30;1m28 | [0m[35m                "size": 1482,[0m
[30;1m29 | [0m[35m            }[0m
[30;1m30 | [0m[35m        ][0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/core/server/test_lazy_data_resolver_v2.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m21 | [0m[35m                    "url": "https://raw.githubusercontent.com/basetenlabs/truss/00e01b679afbe353b0b2[0m
[30;1m22 | [0m[35m                    "expiration_timestamp": expiration_timestamp,[0m
[30;1m23 | [0m[35m                },[0m
[30;1m24 | [0m[35m                "uid": "8c6b2f215f0333437cdc3fe7c79be0c802847d2f2a0ccdc0bb251814e63cf375",[0m
[30;1m25 | [0m[35m                "file_name": TARGET_FILE.as_posix(),[0m
[30;1m26 | [0m[35m                "hashtype": "blake3",[0m
[30;1m27 | [0m[35m                "hash": "8c6b2f215f0333437cdc3fe7c79be0c802847d2f2a0ccdc0bb251814e63cf375",[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/trtllm-audio/packages/whisper_trt/tokenizer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m3 | [0m[35m#[0m
[30;1m4 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License");[0m
[30;1m5 | [0m[35m# you may not use this file except in compliance with the License.[0m
[30;1m6 | [0m[35m# You may obtain a copy of the License at[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# http://www.apache.org/licenses/LICENSE-2.0[0m
[30;1m9 | [0m[35m#[0m
[30;1m10 | [0m[35m# Unless required by applicable law or agreed to in writing, software[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/trtllm-audio/packages/whisper_trt/tokenizer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35m# See the License for the specific language governing permissions and[0m
[30;1m14 | [0m[35m# limitations under the License.[0m
[30;1m15 | [0m[35m# Modified from https://github.com/openai/whisper/blob/main/whisper/tokenizer.py[0m
[30;1m16 | [0m[35mimport base64[0m
[30;1m17 | [0m[35mimport os[0m
[30;1m18 | [0m[35mfrom typing import Optional[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35mimport tiktoken[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/trtllm-audio/packages/whisper_trt/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m69 | [0m[35m        audio_stream = io.BytesIO(binary_data)[0m
[30;1m70 | [0m[35m        waveform, sample_rate = torchaudio.load(audio_stream)[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m        # Resample audio to rate compatible with what the model was trained at[0m
[30;1m73 | [0m[35m        if sample_rate != SUPPORTED_SAMPLE_RATE:[0m
[30;1m74 | [0m[35m            waveform = torchaudio.transforms.Resample([0m
[30;1m75 | [0m[35m                orig_freq=sample_rate, new_freq=SUPPORTED_SAMPLE_RATE[0m
[30;1m76 | [0m[35m            )(waveform)[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/trtllm-audio/packages/whisper_trt/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m198 | [0m[35m        """[0m
[30;1m199 | [0m[35m        language_code = LANG_CODE_PATTERN.findall(transcribed_text)[0][0m
[30;1m200 | [0m[35m[0m
[30;1m201 | [0m[35m        # Find all matches in the input string[0m
[30;1m202 | [0m[35m        matches = SEGMENTS_PATTERN.findall(transcribed_text)[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m        # Process matches to create the desired output format[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/helpers/custom_types.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m@dataclass[0m
[30;1m75 | [0m[35mclass SystemPackagePatch(PatchBody):[0m
[30;1m76 | [0m[35m    # For uninstall this should just be the name of the package, but for update[0m
[30;1m77 | [0m[35m    # should be the full line in the requirements.txt format.[0m
[30;1m78 | [0m[35m    package: str[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m    def to_dict(self):[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/helpers/custom_types.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m@dataclass[0m
[30;1m58 | [0m[35mclass PythonRequirementPatch(PatchBody):[0m
[30;1m59 | [0m[35m    # For uninstall this should just be the name of the package, but for update[0m
[30;1m60 | [0m[35m    # should be the full line in the requirements.txt format.[0m
[30;1m61 | [0m[35m    requirement: str[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m    def to_dict(self):[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/helpers/custom_types.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m21 | [0m[35m    """Types of console requests sent to Django and passed along to pynode."""[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    ADD = "ADD"[0m
[30;1m24 | [0m[35m    UPDATE = "UPDATE"[0m
[30;1m25 | [0m[35m    REMOVE = "REMOVE"[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/helpers/inference_server_controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m40 | [0m[35m        self._lock = threading.Lock()[0m
[30;1m41 | [0m[35m        self._process_controller = process_controller[0m
[30;1m42 | [0m[35m        self._patch_applier = patch_applier[0m
[30;1m43 | [0m[35m        self._current_running_hash = os.environ.get("HASH_TRUSS", None)[0m
[30;1m44 | [0m[35m        self._app_logger = app_logger[0m
[30;1m45 | [0m[35m        self._has_partially_applied_patch = False[0m
[30;1m46 | [0m[35m        self._inf_env = ([0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/helpers/inference_server_controller.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport logging[0m
[30;1m2 | [0m[35mimport os[0m
[30;1m3 | [0m[35mimport threading[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35mfrom typing import Optional[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mfrom helpers.custom_types import Patch, PatchType[0m
[30;1m8 | [0m[35mfrom helpers.errors import ([0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_basic_truss/model/model.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35m* `load`: runs exactly once when the model server is spun up or patched and loads the[0m
[30;1m7 | [0m[35m   model onto the model server. Include any logic for initializing your model, such[0m
[30;1m8 | [0m[35m   as downloading model weights and loading the model into memory.[0m
[30;1m9 | [0m[35m* `predict`: runs every time the model server is called. Include any logic for model[0m
[30;1m10 | [0m[35m  inference and return the model output.[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mSee https://truss.baseten.co/quickstart for more.[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_custom_server_truss/test_docker_image/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m7 | [0m[35m3. update version number in VERSION file[0m
[30;1m8 | [0m[35m(before running the next step, make sure you meet with the [prerequisites](https://docs.docker.com/b[0m
[30;1m9 | [0m[35m4. run `sh build_upload_new_image.sh`[0m
[30;1m10 | [0m[35m5. update image tag to latest version in config.yaml[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_custom_server_truss/test_docker_image/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35m1. run `docker login`[0m
[30;1m6 | [0m[35m2. cd into this directory[0m
[30;1m7 | [0m[35m3. update version number in VERSION file[0m
[30;1m8 | [0m[35m(before running the next step, make sure you meet with the [prerequisites](https://docs.docker.com/b[0m
[30;1m9 | [0m[35m4. run `sh build_upload_new_image.sh`[0m
[30;1m10 | [0m[35m5. update image tag to latest version in config.yaml[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_custom_server_truss/test_docker_image/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35mWe built this minimal fastapi docker image to be used in integration test `test_custom_server_truss.[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mSteps to update testing docker image[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35m1. run `docker login`[0m
[30;1m6 | [0m[35m2. cd into this directory[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_custom_server_truss/test_docker_image/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mWe built this minimal fastapi docker image to be used in integration test `test_custom_server_truss.[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mSteps to update testing docker image[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35m1. run `docker login`[0m
[30;1m6 | [0m[35m2. cd into this directory[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_custom_server_truss/test_docker_image/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mWe built this minimal fastapi docker image to be used in integration test `test_custom_server_truss.[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mSteps to update testing docker image[0m
[30;1m4 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_custom_server_truss/test_docker_image/Dockerfile[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35mFROM python:3.11-slim[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35m# Update package lists and install curl[0m
[30;1m4 | [0m[35mRUN apt-get update && apt-get install -y curl[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m# Install pip dependencies[0m
[30;1m7 | [0m[35mRUN pip install fastapi[standard][0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_custom_server_truss/test_docker_image/Dockerfile[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35mFROM python:3.11-slim[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35m# Update package lists and install curl[0m
[30;1m4 | [0m[35mRUN apt-get update && apt-get install -y curl[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m# Install pip dependencies[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_custom_server_truss/test_docker_image/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mRUN apt-get update && apt-get install -y curl[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m# Install pip dependencies[0m
[30;1m7 | [0m[35mRUN pip install fastapi[standard][0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m# Copy the FastAPI application code[0m
[30;1m10 | [0m[35mCOPY app.py /home/app.py[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_custom_server_truss/test_docker_image/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35m# Update package lists and install curl[0m
[30;1m4 | [0m[35mRUN apt-get update && apt-get install -y curl[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m# Install pip dependencies[0m
[30;1m7 | [0m[35mRUN pip install fastapi[standard][0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m# Copy the FastAPI application code[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_custom_server_truss/test_docker_image/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mFROM python:3.11-slim[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35m# Update package lists and install curl[0m
[30;1m4 | [0m[35mRUN apt-get update && apt-get install -y curl[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m# Install pip dependencies[0m
[30;1m7 | [0m[35mRUN pip install fastapi[standard][0m
[30;1m8 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_custom_server_truss/test_docker_image/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mFROM python:3.11-slim[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35m# Update package lists and install curl[0m
[30;1m4 | [0m[35mRUN apt-get update && apt-get install -y curl[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m# Install pip dependencies[0m
[30;1m7 | [0m[35mRUN pip install fastapi[standard][0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_custom_server_truss/test_docker_image/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mFROM python:3.11-slim[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35m# Update package lists and install curl[0m
[30;1m4 | [0m[35mRUN apt-get update && apt-get install -y curl[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m# Install pip dependencies[0m
[30;1m7 | [0m[35mRUN pip install fastapi[standard][0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_custom_server_truss/test_docker_image/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mFROM python:3.11-slim[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35m# Update package lists and install curl[0m
[30;1m4 | [0m[35mRUN apt-get update && apt-get install -y curl[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m# Install pip dependencies[0m
[30;1m7 | [0m[35mRUN pip install fastapi[standard][0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_pyantic_v2/model/model.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35m* `load`: runs exactly once when the model server is spun up or patched and loads the[0m
[30;1m7 | [0m[35m   model onto the model server. Include any logic for initializing your model, such[0m
[30;1m8 | [0m[35m   as downloading model weights and loading the model into memory.[0m
[30;1m9 | [0m[35m* `predict`: runs every time the model server is called. Include any logic for model[0m
[30;1m10 | [0m[35m  inference and return the model output.[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mSee https://truss.baseten.co/quickstart for more.[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_streaming_read_timeout/model/model.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35mfrom typing import Any, Dict, List[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mclass Model:[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_concurrency_truss/model/model.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35mfrom typing import Any, Dict, List[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mclass Model:[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/core/server/test_lazy_data_resolver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m318 | [0m[35m            for file_name, (url, hash, _) in ldr._bptr_resolution.items():[0m
[30;1m319 | [0m[35m                resp = {"file_name": file_name, "url": url}[0m
[30;1m320 | [0m[35m                (CACHE_DIR / hash).write_text(json.dumps(resp))[0m
[30;1m321 | [0m[35m                m.get(url, json=resp)[0m
[30;1m322 | [0m[35m            ldr.fetch()[0m
[30;1m323 | [0m[35m            for file_name, (url, hash, _) in ldr._bptr_resolution.items():[0m
[30;1m324 | [0m[35m                assert (CACHE_DIR / hash).read_text() == json.dumps([0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/core/server/test_lazy_data_resolver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m269 | [0m[35m        with requests_mock.Mocker() as m:[0m
[30;1m270 | [0m[35m            for file_name, (url, _, _) in ldr._bptr_resolution.items():[0m
[30;1m271 | [0m[35m                resp = {"file_name": file_name, "url": url}[0m
[30;1m272 | [0m[35m                m.get(url, json=resp)[0m
[30;1m273 | [0m[35m            ldr.fetch()[0m
[30;1m274 | [0m[35m[0m
[30;1m275 | [0m[35m            for file_name, (url, _, _) in ldr._bptr_resolution.items():[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/core/server/test_lazy_data_resolver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m216 | [0m[35m        with requests_mock.Mocker() as m:[0m
[30;1m217 | [0m[35m            for file_name, (url, hash, _) in ldr._bptr_resolution.items():[0m
[30;1m218 | [0m[35m                resp = {"file_name": file_name, "url": url}[0m
[30;1m219 | [0m[35m                m.get(url, json=resp)[0m
[30;1m220 | [0m[35m            ldr.fetch()[0m
[30;1m221 | [0m[35m            for file_name, (url, hash, _) in ldr._bptr_resolution.items():[0m
[30;1m222 | [0m[35m                assert (CACHE_DIR / hash).read_text() == json.dumps([0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/core/server/test_lazy_data_resolver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m172 | [0m[35m        assert ldr._uses_b10_cache[0m
[30;1m173 | [0m[35m        with requests_mock.Mocker() as m:[0m
[30;1m174 | [0m[35m            for _, (url, _, _) in ldr._bptr_resolution.items():[0m
[30;1m175 | [0m[35m                m.get(url, status_code=500)[0m
[30;1m176 | [0m[35m            with pytest.raises(RuntimeError):[0m
[30;1m177 | [0m[35m                ldr.fetch()[0m
[30;1m178 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/core/server/test_lazy_data_resolver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m126 | [0m[35m        with requests_mock.Mocker() as m:[0m
[30;1m127 | [0m[35m            for file_name, (url, _, _) in ldr._bptr_resolution.items():[0m
[30;1m128 | [0m[35m                resp = {"file_name": file_name, "url": url}[0m
[30;1m129 | [0m[35m                m.get(url, json=resp)[0m
[30;1m130 | [0m[35m            ldr.fetch()[0m
[30;1m131 | [0m[35m            for file_name, (url, _, _) in ldr._bptr_resolution.items():[0m
[30;1m132 | [0m[35m                assert (ldr._data_dir / file_name).read_text() == json.dumps([0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/control/control/test_server_integration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m250 | [0m[35m    resp = requests.get(f"{ctrl_url}/control/truss_hash")[0m
[30;1m251 | [0m[35m    truss_hash = resp.json()["result"][0m
[30;1m252 | [0m[35m[0m
[30;1m253 | [0m[35m    resp = requests.post([0m
[30;1m254 | [0m[35m        f"{ctrl_url}/control/patch",[0m
[30;1m255 | [0m[35m        json={[0m
[30;1m256 | [0m[35m            "hash": "dummy",[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/control/control/test_server_integration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m247 | [0m[35m[0m
[30;1m248 | [0m[35mdef _patch(model_code: str, control_server: ControlServerDetails):[0m
[30;1m249 | [0m[35m    ctrl_url = f"http://localhost:{control_server.control_server_port}"[0m
[30;1m250 | [0m[35m    resp = requests.get(f"{ctrl_url}/control/truss_hash")[0m
[30;1m251 | [0m[35m    truss_hash = resp.json()["result"][0m
[30;1m252 | [0m[35m[0m
[30;1m253 | [0m[35m    resp = requests.post([0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/control/control/test_server_integration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m94 | [0m[35m@pytest.mark.integration[0m
[30;1m95 | [0m[35mdef test_truss_control_server_health_check(control_server: ControlServerDetails):[0m
[30;1m96 | [0m[35m    ctrl_url = f"http://localhost:{control_server.control_server_port}"[0m
[30;1m97 | [0m[35m    resp = requests.get(f"{ctrl_url}/v1/models/model")[0m
[30;1m98 | [0m[35m    assert resp.status_code == 200[0m
[30;1m99 | [0m[35m    assert resp.json() == {}[0m
[30;1m100 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/control/control/test_server_integration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m87 | [0m[35m    _patch(stream_model_code, control_server)[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m    resp = requests.post(f"{ctrl_url}/v1/models/model:predict", json={}, stream=True)[0m
[30;1m90 | [0m[35m    assert resp.headers.get("transfer-encoding") == "chunked"[0m
[30;1m91 | [0m[35m    assert resp.content == "01234".encode("utf-8")[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/control/control/test_server_integration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m    ctrl_url = f"http://localhost:{control_server.control_server_port}"[0m
[30;1m87 | [0m[35m    _patch(stream_model_code, control_server)[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m    resp = requests.post(f"{ctrl_url}/v1/models/model:predict", json={}, stream=True)[0m
[30;1m90 | [0m[35m    assert resp.headers.get("transfer-encoding") == "chunked"[0m
[30;1m91 | [0m[35m    assert resp.content == "01234".encode("utf-8")[0m
[30;1m92 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/control/control/test_server_integration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m    def predict(inp):[0m
[30;1m64 | [0m[35m        time.sleep(random.uniform(0, 0.5))[0m
[30;1m65 | [0m[35m        resp = requests.post(f"{ctrl_url}/v1/models/model:predict", json=inp)[0m
[30;1m66 | [0m[35m        return resp.json()[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m    with ThreadPool(10) as p:[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/control/control/test_server_integration.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m            os.kill(proc_id, signal.SIGTERM)[0m
[30;1m122 | [0m[35m            control_server.control_server_process.join(timeout=30)[0m
[30;1m123 | [0m[35m            # Control server process tree should be dead[0m
[30;1m124 | [0m[35m            assert not control_server.control_server_process.is_alive()[0m
[30;1m125 | [0m[35m            assert _process_tree_is_dead(proc_id)[0m
[30;1m126 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/control/control/test_server_integration.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m207 | [0m[35m    def start_patch_ping_server():[0m
[30;1m208 | [0m[35m        import json[0m
[30;1m209 | [0m[35m        import random[0m
[30;1m210 | [0m[35m        import time[0m
[30;1m211 | [0m[35m        from http.server import BaseHTTPRequestHandler, HTTPServer[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m        class Handler(BaseHTTPRequestHandler):[0m
[30;1m214 | [0m[35m            def do_POST(self):[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/control/control/test_server_integration.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m177 | [0m[35mdef _configured_control_server([0m
[30;1m178 | [0m[35m    truss_control_container_fs: Path, with_patch_ping_flow: bool = False[0m
[30;1m179 | [0m[35m):[0m
[30;1m180 | [0m[35m    # Pick random ports to reduce reuse, port release may take time[0m
[30;1m181 | [0m[35m    # which can interfere with tests[0m
[30;1m182 | [0m[35m    ctrl_port = random.randint(10000, 11000)[0m
[30;1m183 | [0m[35m    inf_port = ctrl_port + 1[0m
[30;1m184 | [0m[35m    patch_ping_server_port = ctrl_port + 2[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/control/control/test_server_integration.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mimport socket[0m
[30;1m5 | [0m[35mimport sys[0m
[30;1m6 | [0m[35mimport tempfile[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35mfrom contextlib import contextmanager[0m
[30;1m9 | [0m[35mfrom dataclasses import dataclass[0m
[30;1m10 | [0m[35mfrom multiprocessing import Process[0m
[30;1m11 | [0m[35mfrom multiprocessing.pool import ThreadPool[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/core/server/test_secrets_resolver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m@contextmanager[0m
[30;1m42 | [0m[35mdef _override_env_var(key: str, value: str):[0m
[30;1m43 | [0m[35m    orig_value = os.environ.get(key, None)[0m
[30;1m44 | [0m[35m    try:[0m
[30;1m45 | [0m[35m        os.environ[key] = value[0m
[30;1m46 | [0m[35m        yield[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_truss_handle.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m699 | [0m[35m        assert result == [1][0m
[30;1m700 | [0m[35m[0m
[30;1m701 | [0m[35m        # Make sure the patch ping url was actually hit[0m
[30;1m702 | [0m[35m        stats = requests.get(f"http://127.0.0.1:{port}/stats").json()[0m
[30;1m703 | [0m[35m        assert stats[f"{patch_path}_called_count"] == expected_call_count[0m
[30;1m704 | [0m[35m[0m
[30;1m705 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_truss_handle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m627 | [0m[35m    assert labels == labels2[0m
[30;1m628 | [0m[35m    directory_content_patcher.assert_called_once()[0m
[30;1m629 | [0m[35m[0m
[30;1m630 | [0m[35m    time.sleep(0.1)  # Make sure different mod time[0m
[30;1m631 | [0m[35m    (custom_model_truss_dir / "model" / "model.py").touch()[0m
[30;1m632 | [0m[35m    labels3 = th._get_serving_labels()[0m
[30;1m633 | [0m[35m    assert labels3 != labels[0m
[30;1m634 | [0m[35m    directory_content_patcher.call_count == 2[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_truss_handle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m596 | [0m[35m        assert result[0] == 1[0m
[30;1m597 | [0m[35m        orig_num_truss_images = len(th.get_all_docker_images())[0m
[30;1m598 | [0m[35m[0m
[30;1m599 | [0m[35m        # No new docker images on second predict[0m
[30;1m600 | [0m[35m        result = th.docker_predict([1], tag=tag)[0m
[30;1m601 | [0m[35m        assert orig_num_truss_images == len(th.get_all_docker_images())[0m
[30;1m602 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_truss_handle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport os[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35mfrom pathlib import Path[0m
[30;1m4 | [0m[35mfrom unittest.mock import MagicMock, patch[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mimport pytest[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server/model_wrapper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m730 | [0m[35m        if "openai" in user_agent.lower():[0m
[30;1m731 | [0m[35m            return False[0m
[30;1m732 | [0m[35m        # TODO(nikhil): determine if we can safely deprecate this behavior.[0m
[30;1m733 | [0m[35m        return request.headers.get("accept") == "application/json"[0m
[30;1m734 | [0m[35m[0m
[30;1m735 | [0m[35m    async def _handle_generator_response([0m
[30;1m736 | [0m[35m        self,[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server/model_wrapper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m726 | [0m[35m        # The OpenAI SDK sends an accept header for JSON even in a streaming context,[0m
[30;1m727 | [0m[35m        # but we need to stream results back for client compatibility. Luckily,[0m
[30;1m728 | [0m[35m        # we can differentiate by looking at the user agent (e.g. OpenAI/Python 1.61.0)[0m
[30;1m729 | [0m[35m        user_agent = request.headers.get("user-agent", "")[0m
[30;1m730 | [0m[35m        if "openai" in user_agent.lower():[0m
[30;1m731 | [0m[35m            return False[0m
[30;1m732 | [0m[35m        # TODO(nikhil): determine if we can safely deprecate this behavior.[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server/model_wrapper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m676 | [0m[35m            ):[0m
[30;1m677 | [0m[35m                while True:[0m
[30;1m678 | [0m[35m                    chunk = await asyncio.wait_for([0m
[30;1m679 | [0m[35m                        response_queue.get(), timeout=streaming_read_timeout[0m
[30;1m680 | [0m[35m                    )[0m
[30;1m681 | [0m[35m                    if chunk == SENTINEL:[0m
[30;1m682 | [0m[35m                        return[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server/model_wrapper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m645 | [0m[35m    ) -> AsyncGenerator[bytes, None]:[0m
[30;1m646 | [0m[35m        # The streaming read timeout is the amount of time in between streamed chunk[0m
[30;1m647 | [0m[35m        # before a timeout is triggered.[0m
[30;1m648 | [0m[35m        streaming_read_timeout = self._config.get("runtime", {}).get([0m
[30;1m649 | [0m[35m            "streaming_read_timeout", STREAMING_RESPONSE_QUEUE_READ_TIMEOUT_SECS[0m
[30;1m650 | [0m[35m        )[0m
[30;1m651 | [0m[35m        async_generator = _force_async_generator(generator)[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server/model_wrapper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m645 | [0m[35m    ) -> AsyncGenerator[bytes, None]:[0m
[30;1m646 | [0m[35m        # The streaming read timeout is the amount of time in between streamed chunk[0m
[30;1m647 | [0m[35m        # before a timeout is triggered.[0m
[30;1m648 | [0m[35m        streaming_read_timeout = self._config.get("runtime", {}).get([0m
[30;1m649 | [0m[35m            "streaming_read_timeout", STREAMING_RESPONSE_QUEUE_READ_TIMEOUT_SECS[0m
[30;1m650 | [0m[35m        )[0m
[30;1m651 | [0m[35m        async_generator = _force_async_generator(generator)[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server/model_wrapper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m415 | [0m[35m        lazy_data_resolver = LazyDataResolver(data_dir)[0m
[30;1m416 | [0m[35m[0m
[30;1m417 | [0m[35m        apply_patches([0m
[30;1m418 | [0m[35m            self._config.get("apply_library_patches", True),[0m
[30;1m419 | [0m[35m            self._config["requirements"],[0m
[30;1m420 | [0m[35m        )[0m
[30;1m421 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server/model_wrapper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m344 | [0m[35m        self._load_lock = Lock()[0m
[30;1m345 | [0m[35m        self._status = ModelWrapper.Status.NOT_READY[0m
[30;1m346 | [0m[35m        self._predict_semaphore = Semaphore([0m
[30;1m347 | [0m[35m            self._config.get("runtime", {}).get([0m
[30;1m348 | [0m[35m                "predict_concurrency", DEFAULT_PREDICT_CONCURRENCY[0m
[30;1m349 | [0m[35m            )[0m
[30;1m350 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server/model_wrapper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m344 | [0m[35m        self._load_lock = Lock()[0m
[30;1m345 | [0m[35m        self._status = ModelWrapper.Status.NOT_READY[0m
[30;1m346 | [0m[35m        self._predict_semaphore = Semaphore([0m
[30;1m347 | [0m[35m            self._config.get("runtime", {}).get([0m
[30;1m348 | [0m[35m                "predict_concurrency", DEFAULT_PREDICT_CONCURRENCY[0m
[30;1m349 | [0m[35m            )[0m
[30;1m350 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server/model_wrapper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35mMODEL_BASENAME = "model"[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35mNUM_LOAD_RETRIES = int(os.environ.get("NUM_LOAD_RETRIES_TRUSS", "1"))[0m
[30;1m43 | [0m[35mSTREAMING_RESPONSE_QUEUE_READ_TIMEOUT_SECS = 60[0m
[30;1m44 | [0m[35mDEFAULT_PREDICT_CONCURRENCY = 1[0m
[30;1m45 | [0m[35mEXTENSIONS_DIR_NAME = "extensions"[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server/model_wrapper.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m725 | [0m[35m    def _should_gather_generator(self, request: starlette.requests.Request) -> bool:[0m
[30;1m726 | [0m[35m        # The OpenAI SDK sends an accept header for JSON even in a streaming context,[0m
[30;1m727 | [0m[35m        # but we need to stream results back for client compatibility. Luckily,[0m
[30;1m728 | [0m[35m        # we can differentiate by looking at the user agent (e.g. OpenAI/Python 1.61.0)[0m
[30;1m729 | [0m[35m        user_agent = request.headers.get("user-agent", "")[0m
[30;1m730 | [0m[35m        if "openai" in user_agent.lower():[0m
[30;1m731 | [0m[35m            return False[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server/model_wrapper.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m532 | [0m[35m        )[0m
[30;1m533 | [0m[35m[0m
[30;1m534 | [0m[35m        while True:[0m
[30;1m535 | [0m[35m            # Give control back to the event loop while waiting for environment updates[0m
[30;1m536 | [0m[35m            await asyncio.sleep(POLL_FOR_ENVIRONMENT_UPDATES_TIMEOUT_SECS)[0m
[30;1m537 | [0m[35m[0m
[30;1m538 | [0m[35m            # Wait for load to finish before checking for environment updates[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server/model_wrapper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m644 | [0m[35m        cleanup_fn: Callable[[], None],[0m
[30;1m645 | [0m[35m    ) -> AsyncGenerator[bytes, None]:[0m
[30;1m646 | [0m[35m        # The streaming read timeout is the amount of time in between streamed chunk[0m
[30;1m647 | [0m[35m        # before a timeout is triggered.[0m
[30;1m648 | [0m[35m        streaming_read_timeout = self._config.get("runtime", {}).get([0m
[30;1m649 | [0m[35m            "streaming_read_timeout", STREAMING_RESPONSE_QUEUE_READ_TIMEOUT_SECS[0m
[30;1m650 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server/model_wrapper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m643 | [0m[35m        trace_ctx: trace.Context,[0m
[30;1m644 | [0m[35m        cleanup_fn: Callable[[], None],[0m
[30;1m645 | [0m[35m    ) -> AsyncGenerator[bytes, None]:[0m
[30;1m646 | [0m[35m        # The streaming read timeout is the amount of time in between streamed chunk[0m
[30;1m647 | [0m[35m        # before a timeout is triggered.[0m
[30;1m648 | [0m[35m        streaming_read_timeout = self._config.get("runtime", {}).get([0m
[30;1m649 | [0m[35m            "streaming_read_timeout", STREAMING_RESPONSE_QUEUE_READ_TIMEOUT_SECS[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server/model_wrapper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m643 | [0m[35m        trace_ctx: trace.Context,[0m
[30;1m644 | [0m[35m        cleanup_fn: Callable[[], None],[0m
[30;1m645 | [0m[35m    ) -> AsyncGenerator[bytes, None]:[0m
[30;1m646 | [0m[35m        # The streaming read timeout is the amount of time in between streamed chunk[0m
[30;1m647 | [0m[35m        # before a timeout is triggered.[0m
[30;1m648 | [0m[35m        streaming_read_timeout = self._config.get("runtime", {}).get([0m
[30;1m649 | [0m[35m            "streaming_read_timeout", STREAMING_RESPONSE_QUEUE_READ_TIMEOUT_SECS[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server/model_wrapper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35mimport os[0m
[30;1m10 | [0m[35mimport pathlib[0m
[30;1m11 | [0m[35mimport sys[0m
[30;1m12 | [0m[35mimport time[0m
[30;1m13 | [0m[35mimport weakref[0m
[30;1m14 | [0m[35mfrom contextlib import asynccontextmanager[0m
[30;1m15 | [0m[35mfrom functools import cached_property[0m
[30;1m16 | [0m[35mfrom multiprocessing import Lock[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/conftest.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m592 | [0m[35m    for _ in range(int(retry_secs / sleep_between_retries)):[0m
[30;1m593 | [0m[35m        time.sleep(sleep_between_retries)[0m
[30;1m594 | [0m[35m        try:[0m
[30;1m595 | [0m[35m            resp = requests.get(f"{base_url}/health")[0m
[30;1m596 | [0m[35m        except requests.exceptions.ConnectionError:[0m
[30;1m597 | [0m[35m            continue[0m
[30;1m598 | [0m[35m        if resp.status_code == 200:[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/conftest.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m133 | [0m[35m"""[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35mLONG_LOAD_MODEL_CODE = """[0m
[30;1m136 | [0m[35mimport time[0m
[30;1m137 | [0m[35mclass Model:[0m
[30;1m138 | [0m[35m     def load(*args, **kwargs):[0m
[30;1m139 | [0m[35m        time.sleep(10)[0m
[30;1m140 | [0m[35m        pass[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/conftest.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35mimport shutil[0m
[30;1m6 | [0m[35mimport subprocess[0m
[30;1m7 | [0m[35mimport sys[0m
[30;1m8 | [0m[35mimport time[0m
[30;1m9 | [0m[35mfrom pathlib import Path[0m
[30;1m10 | [0m[35mfrom typing import Any, Dict[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mimport pytest[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/utils/transfer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mimport contextlib[0m
[30;1m3 | [0m[35mimport json[0m
[30;1m4 | [0m[35mimport os[0m
[30;1m5 | [0m[35mfrom typing import TYPE_CHECKING, Optional, Type[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1855 | [0m[35m                "user-agent": "OpenAI/Python 1.61.0",[0m
[30;1m1856 | [0m[35m            },[0m
[30;1m1857 | [0m[35m        )[0m
[30;1m1858 | [0m[35m        assert response.headers.get("transfer-encoding") == "chunked"[0m
[30;1m1859 | [0m[35m        assert [[0m
[30;1m1860 | [0m[35m            byte_string.decode() for byte_string in list(response.iter_content())[0m
[30;1m1861 | [0m[35m        ] == ["1", "2"][0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1845 | [0m[35m    with ensure_kill_all(), _temp_truss(model) as tr:[0m
[30;1m1846 | [0m[35m        tr.docker_run(local_port=8090, detach=True, wait_for_server_ready=True)[0m
[30;1m1847 | [0m[35m[0m
[30;1m1848 | [0m[35m        response = requests.post([0m
[30;1m1849 | [0m[35m            CHAT_COMPLETIONS_URL,[0m
[30;1m1850 | [0m[35m            json={"nums": ["1", "2"]},[0m
[30;1m1851 | [0m[35m            stream=True,[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1815 | [0m[35m    with ensure_kill_all(), _temp_truss(model) as tr:[0m
[30;1m1816 | [0m[35m        tr.docker_run(local_port=8090, detach=True, wait_for_server_ready=True)[0m
[30;1m1817 | [0m[35m[0m
[30;1m1818 | [0m[35m        response = requests.post(PREDICT_URL, json={"nums": ["1", "2"]})[0m
[30;1m1819 | [0m[35m        assert response.status_code == 200[0m
[30;1m1820 | [0m[35m        assert response.json() == ["1", "2"][0m
[30;1m1821 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1784 | [0m[35m        tr.docker_run(local_port=8090, detach=True, wait_for_server_ready=True)[0m
[30;1m1785 | [0m[35m[0m
[30;1m1786 | [0m[35m        response = requests.post(PREDICT_URL, json={"nums": ["1", "2"]}, stream=True)[0m
[30;1m1787 | [0m[35m        assert response.headers.get("transfer-encoding") == "chunked"[0m
[30;1m1788 | [0m[35m        assert [[0m
[30;1m1789 | [0m[35m            byte_string.decode() for byte_string in list(response.iter_content())[0m
[30;1m1790 | [0m[35m        ] == ["1", "2"][0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1783 | [0m[35m    with ensure_kill_all(), _temp_truss(model) as tr:[0m
[30;1m1784 | [0m[35m        tr.docker_run(local_port=8090, detach=True, wait_for_server_ready=True)[0m
[30;1m1785 | [0m[35m[0m
[30;1m1786 | [0m[35m        response = requests.post(PREDICT_URL, json={"nums": ["1", "2"]}, stream=True)[0m
[30;1m1787 | [0m[35m        assert response.headers.get("transfer-encoding") == "chunked"[0m
[30;1m1788 | [0m[35m        assert [[0m
[30;1m1789 | [0m[35m            byte_string.decode() for byte_string in list(response.iter_content())[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1753 | [0m[35m        assert response.status_code == 200[0m
[30;1m1754 | [0m[35m        assert response.json() == 2[0m
[30;1m1755 | [0m[35m[0m
[30;1m1756 | [0m[35m        response = requests.post(CHAT_COMPLETIONS_URL, json={"increment": 3})[0m
[30;1m1757 | [0m[35m        assert response.status_code == 404[0m
[30;1m1758 | [0m[35m[0m
[30;1m1759 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1749 | [0m[35m        assert response.status_code == 200[0m
[30;1m1750 | [0m[35m        assert response.json() == 1[0m
[30;1m1751 | [0m[35m[0m
[30;1m1752 | [0m[35m        response = requests.post(COMPLETIONS_URL, json={"increment": 2})[0m
[30;1m1753 | [0m[35m        assert response.status_code == 200[0m
[30;1m1754 | [0m[35m        assert response.json() == 2[0m
[30;1m1755 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1745 | [0m[35m    with ensure_kill_all(), _temp_truss(model) as tr:[0m
[30;1m1746 | [0m[35m        tr.docker_run(local_port=8090, detach=True, wait_for_server_ready=True)[0m
[30;1m1747 | [0m[35m[0m
[30;1m1748 | [0m[35m        response = requests.post(PREDICT_URL, json={"increment": 1})[0m
[30;1m1749 | [0m[35m        assert response.status_code == 200[0m
[30;1m1750 | [0m[35m        assert response.json() == 1[0m
[30;1m1751 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1641 | [0m[35m            with httpx.Client([0m
[30;1m1642 | [0m[35m                timeout=httpx.Timeout(1.0, connect=1.0, read=1.0)[0m
[30;1m1643 | [0m[35m            ) as client:[0m
[30;1m1644 | [0m[35m                response = client.post(PREDICT_URL, json={}, timeout=1.0)[0m
[30;1m1645 | [0m[35m                response.raise_for_status()[0m
[30;1m1646 | [0m[35m[0m
[30;1m1647 | [0m[35m        time.sleep(2)  # Wait a bit to get all logs.[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1609 | [0m[35m            with httpx.Client([0m
[30;1m1610 | [0m[35m                timeout=httpx.Timeout(1.0, connect=1.0, read=1.0)[0m
[30;1m1611 | [0m[35m            ) as client:[0m
[30;1m1612 | [0m[35m                response = client.post(PREDICT_URL, json={}, timeout=1.0)[0m
[30;1m1613 | [0m[35m                response.raise_for_status()[0m
[30;1m1614 | [0m[35m[0m
[30;1m1615 | [0m[35m        time.sleep(2)  # Wait a bit to get all logs.[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1569 | [0m[35m            local_port=8090, detach=True, wait_for_server_ready=True[0m
[30;1m1570 | [0m[35m        )[0m
[30;1m1571 | [0m[35m[0m
[30;1m1572 | [0m[35m        response = requests.post(PREDICT_URL, json={})[0m
[30;1m1573 | [0m[35m        assert response.status_code == 500[0m
[30;1m1574 | [0m[35m        assert response.headers["x-baseten-error-source"] == "04"[0m
[30;1m1575 | [0m[35m        assert response.headers["x-baseten-error-code"] == "600"[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1434 | [0m[35m    with ensure_kill_all(), _temp_truss(model) as tr:[0m
[30;1m1435 | [0m[35m        _ = tr.docker_run(local_port=8090, detach=True, wait_for_server_ready=True)[0m
[30;1m1436 | [0m[35m[0m
[30;1m1437 | [0m[35m        response = requests.post(PREDICT_URL, json={"test": 123})[0m
[30;1m1438 | [0m[35m        assert response.status_code == 200[0m
[30;1m1439 | [0m[35m        assert response.json() == {[0m
[30;1m1440 | [0m[35m            "test": 123,[0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1403 | [0m[35m        _ = tr.docker_run(local_port=8090, detach=True, wait_for_server_ready=True)[0m
[30;1m1404 | [0m[35m[0m
[30;1m1405 | [0m[35m        # A request for which response is not completely read.[0m
[30;1m1406 | [0m[35m        predict_response = requests.post(PREDICT_URL, json={}, stream=True)[0m
[30;1m1407 | [0m[35m        assert ([0m
[30;1m1408 | [0m[35m            predict_response.headers["Content-Type"][0m
[30;1m1409 | [0m[35m            == "text/event-stream; charset=utf-8"[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1377 | [0m[35m        assert "x-baseten-error-source" not in response.headers[0m
[30;1m1378 | [0m[35m        assert "x-baseten-error-code" not in response.headers[0m
[30;1m1379 | [0m[35m[0m
[30;1m1380 | [0m[35m        response = requests.post([0m
[30;1m1381 | [0m[35m            PREDICT_URL, json={"code": status.HTTP_500_INTERNAL_SERVER_ERROR}[0m
[30;1m1382 | [0m[35m        )[0m
[30;1m1383 | [0m[35m        assert response.status_code == 500[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1372 | [0m[35m    with ensure_kill_all(), _temp_truss(model) as tr:[0m
[30;1m1373 | [0m[35m        _ = tr.docker_run(local_port=8090, detach=True, wait_for_server_ready=True)[0m
[30;1m1374 | [0m[35m[0m
[30;1m1375 | [0m[35m        response = requests.post(PREDICT_URL, json={"code": status.HTTP_204_NO_CONTENT})[0m
[30;1m1376 | [0m[35m        assert response.status_code == 204[0m
[30;1m1377 | [0m[35m        assert "x-baseten-error-source" not in response.headers[0m
[30;1m1378 | [0m[35m        assert "x-baseten-error-code" not in response.headers[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1312 | [0m[35m[0m
[30;1m1313 | [0m[35m        # When accept is set to application/json, the response is not streamed.[0m
[30;1m1314 | [0m[35m        headers_2 = _make_otel_headers()[0m
[30;1m1315 | [0m[35m        predict_non_stream_response = requests.post([0m
[30;1m1316 | [0m[35m            PREDICT_URL,[0m
[30;1m1317 | [0m[35m            json={},[0m
[30;1m1318 | [0m[35m            stream=True,[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1308 | [0m[35m        predict_response = requests.post([0m
[30;1m1309 | [0m[35m            PREDICT_URL, json={}, stream=True, headers=headers_1[0m
[30;1m1310 | [0m[35m        )[0m
[30;1m1311 | [0m[35m        assert predict_response.headers.get("transfer-encoding") == "chunked"[0m
[30;1m1312 | [0m[35m[0m
[30;1m1313 | [0m[35m        # When accept is set to application/json, the response is not streamed.[0m
[30;1m1314 | [0m[35m        headers_2 = _make_otel_headers()[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1305 | [0m[35m        next(predict_response.iter_content())[0m
[30;1m1306 | [0m[35m[0m
[30;1m1307 | [0m[35m        headers_1 = _make_otel_headers()[0m
[30;1m1308 | [0m[35m        predict_response = requests.post([0m
[30;1m1309 | [0m[35m            PREDICT_URL, json={}, stream=True, headers=headers_1[0m
[30;1m1310 | [0m[35m        )[0m
[30;1m1311 | [0m[35m        assert predict_response.headers.get("transfer-encoding") == "chunked"[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1298 | [0m[35m[0m
[30;1m1299 | [0m[35m        # A request for which response is not completely read[0m
[30;1m1300 | [0m[35m        headers_0 = _make_otel_headers()[0m
[30;1m1301 | [0m[35m        predict_response = requests.post([0m
[30;1m1302 | [0m[35m            PREDICT_URL, json={}, stream=True, headers=headers_0[0m
[30;1m1303 | [0m[35m        )[0m
[30;1m1304 | [0m[35m        # We just read the first part and leave it hanging here[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1199 | [0m[35m[0m
[30;1m1200 | [0m[35m    async def predict_request(data: dict):[0m
[30;1m1201 | [0m[35m        async with httpx.AsyncClient() as client:[0m
[30;1m1202 | [0m[35m            response = await client.post(PREDICT_URL, json=data)[0m
[30;1m1203 | [0m[35m            response.raise_for_status()[0m
[30;1m1204 | [0m[35m            return response.json()[0m
[30;1m1205 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1164 | [0m[35m[0m
[30;1m1165 | [0m[35m        truss_server_addr = "http://localhost:8090"[0m
[30;1m1166 | [0m[35m[0m
[30;1m1167 | [0m[35m        healthy = requests.get(f"{truss_server_addr}/v1/models/model")[0m
[30;1m1168 | [0m[35m        assert healthy.status_code == 200[0m
[30;1m1169 | [0m[35m[0m
[30;1m1170 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1148 | [0m[35m        for response in not_healthy_responses:[0m
[30;1m1149 | [0m[35m            predict_response = requests.post(PREDICT_URL, json={"healthy": response})[0m
[30;1m1150 | [0m[35m            assert predict_response.status_code == 200[0m
[30;1m1151 | [0m[35m            healthy = requests.get(f"{truss_server_addr}/v1/models/model")[0m
[30;1m1152 | [0m[35m            assert healthy.status_code == 503[0m
[30;1m1153 | [0m[35m[0m
[30;1m1154 | [0m[35m    model = """[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1146 | [0m[35m[0m
[30;1m1147 | [0m[35m        not_healthy_responses = [False, "", 0, {}][0m
[30;1m1148 | [0m[35m        for response in not_healthy_responses:[0m
[30;1m1149 | [0m[35m            predict_response = requests.post(PREDICT_URL, json={"healthy": response})[0m
[30;1m1150 | [0m[35m            assert predict_response.status_code == 200[0m
[30;1m1151 | [0m[35m            healthy = requests.get(f"{truss_server_addr}/v1/models/model")[0m
[30;1m1152 | [0m[35m            assert healthy.status_code == 503[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1141 | [0m[35m        for response in healthy_responses:[0m
[30;1m1142 | [0m[35m            predict_response = requests.post(PREDICT_URL, json={"healthy": response})[0m
[30;1m1143 | [0m[35m            assert predict_response.status_code == 200[0m
[30;1m1144 | [0m[35m            healthy = requests.get(f"{truss_server_addr}/v1/models/model")[0m
[30;1m1145 | [0m[35m            assert healthy.status_code == 200[0m
[30;1m1146 | [0m[35m[0m
[30;1m1147 | [0m[35m        not_healthy_responses = [False, "", 0, {}][0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1139 | [0m[35m[0m
[30;1m1140 | [0m[35m        healthy_responses = [True, "yessss", 34, {"woo": "hoo"}][0m
[30;1m1141 | [0m[35m        for response in healthy_responses:[0m
[30;1m1142 | [0m[35m            predict_response = requests.post(PREDICT_URL, json={"healthy": response})[0m
[30;1m1143 | [0m[35m            assert predict_response.status_code == 200[0m
[30;1m1144 | [0m[35m            healthy = requests.get(f"{truss_server_addr}/v1/models/model")[0m
[30;1m1145 | [0m[35m            assert healthy.status_code == 200[0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1137 | [0m[35m        healthy = requests.get(f"{truss_server_addr}/v1/models/model")[0m
[30;1m1138 | [0m[35m        assert healthy.status_code == 503[0m
[30;1m1139 | [0m[35m        time.sleep(10)[0m
[30;1m1140 | [0m[35m        healthy = requests.get(f"{truss_server_addr}/v1/models/model")[0m
[30;1m1141 | [0m[35m        assert healthy.status_code == 200[0m
[30;1m1142 | [0m[35m[0m
[30;1m1143 | [0m[35m        healthy_responses = [True, "yessss", 34, {"woo": "hoo"}][0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1131 | [0m[35m        tr.docker_run(local_port=8090, detach=True, wait_for_server_ready=False)[0m
[30;1m1132 | [0m[35m        time.sleep(5)[0m
[30;1m1133 | [0m[35m        truss_server_addr = "http://localhost:8090"[0m
[30;1m1134 | [0m[35m        healthy = requests.get(f"{truss_server_addr}/v1/models/model")[0m
[30;1m1135 | [0m[35m        assert healthy.status_code == 503[0m
[30;1m1136 | [0m[35m        time.sleep(10)[0m
[30;1m1137 | [0m[35m        healthy = requests.get(f"{truss_server_addr}/v1/models/model")[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1108 | [0m[35m        healthy = requests.get(f"{truss_server_addr}/v1/models/model")[0m
[30;1m1109 | [0m[35m        assert healthy.status_code == 503[0m
[30;1m1110 | [0m[35m        assert container.logs().count("Health check failed.") == 1[0m
[30;1m1111 | [0m[35m        healthy = requests.get(f"{truss_server_addr}/v1/models/model")[0m
[30;1m1112 | [0m[35m        assert healthy.status_code == 503[0m
[30;1m1113 | [0m[35m        assert container.logs().count("Health check failed.") == 2[0m
[30;1m1114 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1102 | [0m[35m        # Sleep a few seconds to get the server some time to wake up[0m
[30;1m1103 | [0m[35m        time.sleep(10)[0m
[30;1m1104 | [0m[35m[0m
[30;1m1105 | [0m[35m        healthy = requests.get(f"{truss_server_addr}/v1/models/model")[0m
[30;1m1106 | [0m[35m        assert healthy.status_code == 503[0m
[30;1m1107 | [0m[35m        assert container.logs().count("Health check failed.") == 1[0m
[30;1m1108 | [0m[35m        healthy = requests.get(f"{truss_server_addr}/v1/models/model")[0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1094 | [0m[35m        truss_server_addr = "http://localhost:8090"[0m
[30;1m1095 | [0m[35m[0m
[30;1m1096 | [0m[35m        time.sleep(5)[0m
[30;1m1097 | [0m[35m        healthy = requests.get(f"{truss_server_addr}/v1/models/model")[0m
[30;1m1098 | [0m[35m        assert healthy.status_code == 503[0m
[30;1m1099 | [0m[35m        # Ensure we only log after model.load is complete[0m
[30;1m1100 | [0m[35m        assert "Health check failed." not in container.logs()[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1066 | [0m[35m[0m
[30;1m1067 | [0m[35m        truss_server_addr = "http://localhost:8090"[0m
[30;1m1068 | [0m[35m[0m
[30;1m1069 | [0m[35m        healthy = requests.get(f"{truss_server_addr}/v1/models/model")[0m
[30;1m1070 | [0m[35m        assert healthy.status_code == 503[0m
[30;1m1071 | [0m[35m        assert ([0m
[30;1m1072 | [0m[35m            "Exception while checking if model is healthy: not healthy"[0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1020 | [0m[35m        truss_server_addr = "http://localhost:8090"[0m
[30;1m1021 | [0m[35m        for _ in range(5):[0m
[30;1m1022 | [0m[35m            time.sleep(1)[0m
[30;1m1023 | [0m[35m            healthy = requests.get(f"{truss_server_addr}/v1/models/model")[0m
[30;1m1024 | [0m[35m            if healthy.status_code == 503:[0m
[30;1m1025 | [0m[35m                break[0m
[30;1m1026 | [0m[35m            assert healthy.status_code == 200[0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m908 | [0m[35m    class Model:[0m
[30;1m909 | [0m[35m        def setup_environment(self, environment: Optional[dict]):[0m
[30;1m910 | [0m[35m            print("setup_environment called with", environment)[0m
[30;1m911 | [0m[35m            self.environment_name = environment.get("name") if environment else None[0m
[30;1m912 | [0m[35m            print(f"in {self.environment_name} environment")[0m
[30;1m913 | [0m[35m[0m
[30;1m914 | [0m[35m        def load(self):[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m869 | [0m[35m    class Model:[0m
[30;1m870 | [0m[35m        def setup_environment(self, environment: Optional[dict]):[0m
[30;1m871 | [0m[35m            print("setup_environment called with", environment)[0m
[30;1m872 | [0m[35m            self.environment_name = environment.get("name") if environment else None[0m
[30;1m873 | [0m[35m            print(f"in {self.environment_name} environment")[0m
[30;1m874 | [0m[35m[0m
[30;1m875 | [0m[35m        def predict(self, model_input):[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m856 | [0m[35m            local_port=8090, detach=True, wait_for_server_ready=True[0m
[30;1m857 | [0m[35m        )[0m
[30;1m858 | [0m[35m        assert "Executing model.load with environment: None" in container.logs()[0m
[30;1m859 | [0m[35m        response = requests.post(PREDICT_URL, json={})[0m
[30;1m860 | [0m[35m        assert response.json() is None[0m
[30;1m861 | [0m[35m        assert response.status_code == 200[0m
[30;1m862 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m844 | [0m[35m            local_port=8090, detach=True, wait_for_server_ready=True[0m
[30;1m845 | [0m[35m        )[0m
[30;1m846 | [0m[35m        assert "Executing model.load with environment: staging" in container.logs()[0m
[30;1m847 | [0m[35m        response = requests.post(PREDICT_URL, json={})[0m
[30;1m848 | [0m[35m        assert response.json() == "staging"[0m
[30;1m849 | [0m[35m        assert response.status_code == 200[0m
[30;1m850 | [0m[35m        container.execute(["bash", "-c", "rm -f /etc/b10_dynamic_config/environment"])[0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m826 | [0m[35m        def __init__(self, **kwargs):[0m
[30;1m827 | [0m[35m            self._config = kwargs["config"][0m
[30;1m828 | [0m[35m            self._environment = kwargs["environment"][0m
[30;1m829 | [0m[35m            self.environment_name = self._environment.get("name") if self._environment else None[0m
[30;1m830 | [0m[35m[0m
[30;1m831 | [0m[35m        def load(self):[0m
[30;1m832 | [0m[35m            print(f"Executing model.load with environment: {self.environment_name}")[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m799 | [0m[35m        _test_ping(200)[0m
[30;1m800 | [0m[35m[0m
[30;1m801 | [0m[35m        predict_call = Thread([0m
[30;1m802 | [0m[35m            target=lambda: requests.post([0m
[30;1m803 | [0m[35m                f"{truss_server_addr}/v1/models/model:predict", json={}[0m
[30;1m804 | [0m[35m            )[0m
[30;1m805 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m771 | [0m[35m            assert ping.status_code == expected_code[0m
[30;1m772 | [0m[35m[0m
[30;1m773 | [0m[35m        def _test_invocations(expected_code):[0m
[30;1m774 | [0m[35m            invocations = requests.post(f"{truss_server_addr}/invocations", json={})[0m
[30;1m775 | [0m[35m            assert invocations.status_code == expected_code[0m
[30;1m776 | [0m[35m[0m
[30;1m777 | [0m[35m        SERVER_WARMUP_TIME = 3[0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m767 | [0m[35m            assert ready.status_code == expected_code[0m
[30;1m768 | [0m[35m[0m
[30;1m769 | [0m[35m        def _test_ping(expected_code):[0m
[30;1m770 | [0m[35m            ping = requests.get(f"{truss_server_addr}/ping")[0m
[30;1m771 | [0m[35m            assert ping.status_code == expected_code[0m
[30;1m772 | [0m[35m[0m
[30;1m773 | [0m[35m        def _test_invocations(expected_code):[0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m763 | [0m[35m            assert ready.status_code == expected_code[0m
[30;1m764 | [0m[35m[0m
[30;1m765 | [0m[35m        def _test_is_loaded(expected_code):[0m
[30;1m766 | [0m[35m            ready = requests.get(f"{truss_server_addr}/v1/models/model/loaded")[0m
[30;1m767 | [0m[35m            assert ready.status_code == expected_code[0m
[30;1m768 | [0m[35m[0m
[30;1m769 | [0m[35m        def _test_ping(expected_code):[0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m759 | [0m[35m            assert live.status_code == expected_code[0m
[30;1m760 | [0m[35m[0m
[30;1m761 | [0m[35m        def _test_readiness_probe(expected_code):[0m
[30;1m762 | [0m[35m            ready = requests.get(f"{truss_server_addr}/v1/models/model")[0m
[30;1m763 | [0m[35m            assert ready.status_code == expected_code[0m
[30;1m764 | [0m[35m[0m
[30;1m765 | [0m[35m        def _test_is_loaded(expected_code):[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m755 | [0m[35m        truss_server_addr = "http://localhost:8090"[0m
[30;1m756 | [0m[35m[0m
[30;1m757 | [0m[35m        def _test_liveness_probe(expected_code):[0m
[30;1m758 | [0m[35m            live = requests.get(f"{truss_server_addr}/")[0m
[30;1m759 | [0m[35m            assert live.status_code == expected_code[0m
[30;1m760 | [0m[35m[0m
[30;1m761 | [0m[35m        def _test_readiness_probe(expected_code):[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m719 | [0m[35m            local_port=8090, detach=True, wait_for_server_ready=True[0m
[30;1m720 | [0m[35m        )[0m
[30;1m721 | [0m[35m[0m
[30;1m722 | [0m[35m        response = requests.post(PREDICT_URL, json={})[0m
[30;1m723 | [0m[35m        assert response.status_code == 500[0m
[30;1m724 | [0m[35m        assert "error" in response.json()[0m
[30;1m725 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m693 | [0m[35m            local_port=8090, detach=True, wait_for_server_ready=True[0m
[30;1m694 | [0m[35m        )[0m
[30;1m695 | [0m[35m[0m
[30;1m696 | [0m[35m        response = requests.post(PREDICT_URL, json={})[0m
[30;1m697 | [0m[35m        assert response.status_code == 500[0m
[30;1m698 | [0m[35m        assert "error" in response.json()[0m
[30;1m699 | [0m[35m        assert response.headers["x-baseten-error-source"] == "04"[0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m666 | [0m[35m            local_port=8090, detach=True, wait_for_server_ready=True[0m
[30;1m667 | [0m[35m        )[0m
[30;1m668 | [0m[35m[0m
[30;1m669 | [0m[35m        response = requests.post(PREDICT_URL, json={})[0m
[30;1m670 | [0m[35m        assert response.status_code == 500[0m
[30;1m671 | [0m[35m        assert "error" in response.json()[0m
[30;1m672 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m647 | [0m[35m            local_port=8090, detach=True, wait_for_server_ready=True[0m
[30;1m648 | [0m[35m        )[0m
[30;1m649 | [0m[35m[0m
[30;1m650 | [0m[35m        response = requests.post(PREDICT_URL, json={})[0m
[30;1m651 | [0m[35m        assert response.status_code == 500[0m
[30;1m652 | [0m[35m        assert "error" in response.json()[0m
[30;1m653 | [0m[35m        _assert_logs_contain_error(container.logs(), "ValueError: error")[0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m624 | [0m[35m            local_port=8090, detach=True, wait_for_server_ready=True[0m
[30;1m625 | [0m[35m        )[0m
[30;1m626 | [0m[35m[0m
[30;1m627 | [0m[35m        response = requests.post(PREDICT_URL, json={})[0m
[30;1m628 | [0m[35m        assert response.status_code == 500[0m
[30;1m629 | [0m[35m        assert "error" in response.json()[0m
[30;1m630 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m600 | [0m[35m            local_port=8090, detach=True, wait_for_server_ready=True[0m
[30;1m601 | [0m[35m        )[0m
[30;1m602 | [0m[35m[0m
[30;1m603 | [0m[35m        response = requests.post(PREDICT_URL, json={})[0m
[30;1m604 | [0m[35m        assert response.status_code == 500[0m
[30;1m605 | [0m[35m        assert "error" in response.json()[0m
[30;1m606 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m565 | [0m[35m[0m
[30;1m566 | [0m[35m        def make_request(delay: int):[0m
[30;1m567 | [0m[35m            time.sleep(delay)[0m
[30;1m568 | [0m[35m            response = requests.post(PREDICT_URL, json={})[0m
[30;1m569 | [0m[35m            assert response.status_code == 200[0m
[30;1m570 | [0m[35m            assert response.json() == ["0 modified", "1 modified"][0m
[30;1m571 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m512 | [0m[35m            # For streamed responses, requests does not start receiving content from server until[0m
[30;1m513 | [0m[35m            # `iter_content` is called, so we must call this in order to get an actual timeout.[0m
[30;1m514 | [0m[35m            time.sleep(delay)[0m
[30;1m515 | [0m[35m            response = requests.post(PREDICT_URL, json={}, stream=True)[0m
[30;1m516 | [0m[35m[0m
[30;1m517 | [0m[35m            assert response.status_code == 200[0m
[30;1m518 | [0m[35m            assert response.content == b"0 modified1 modified"[0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m472 | [0m[35m            local_port=8090, detach=True, wait_for_server_ready=True[0m
[30;1m473 | [0m[35m        )[0m
[30;1m474 | [0m[35m[0m
[30;1m475 | [0m[35m        response = requests.post(PREDICT_URL, json={}, stream=True)[0m
[30;1m476 | [0m[35m        logging.info(response.content)[0m
[30;1m477 | [0m[35m        _assert_logs_contain_error([0m
[30;1m478 | [0m[35m            container.logs(),[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m436 | [0m[35m            local_port=8090, detach=True, wait_for_server_ready=True[0m
[30;1m437 | [0m[35m        )[0m
[30;1m438 | [0m[35m[0m
[30;1m439 | [0m[35m        response = requests.post(PREDICT_URL, json={})[0m
[30;1m440 | [0m[35m        assert response.status_code == 500[0m
[30;1m441 | [0m[35m        _assert_logs_contain_error(container.logs(), missing_secret_error_message)[0m
[30;1m442 | [0m[35m        assert "Internal Server Error" in response.json()["error"][0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m422 | [0m[35m            local_port=8090, detach=True, wait_for_server_ready=True[0m
[30;1m423 | [0m[35m        )[0m
[30;1m424 | [0m[35m[0m
[30;1m425 | [0m[35m        response = requests.post(PREDICT_URL, json={})[0m
[30;1m426 | [0m[35m        assert "error" in response.json()[0m
[30;1m427 | [0m[35m        _assert_logs_contain_error(container.logs(), missing_secret_error_message)[0m
[30;1m428 | [0m[35m        assert "Internal Server Error" in response.json()["error"][0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m409 | [0m[35m        LocalConfigHandler.set_secret("secret", "secret_value")[0m
[30;1m410 | [0m[35m        _ = tr.docker_run(local_port=8090, detach=True, wait_for_server_ready=True)[0m
[30;1m411 | [0m[35m[0m
[30;1m412 | [0m[35m        response = requests.post(PREDICT_URL, json={})[0m
[30;1m413 | [0m[35m[0m
[30;1m414 | [0m[35m        assert response.json() == "secret_value"[0m
[30;1m415 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m362 | [0m[35m        ] == ["0", "1", "2"][0m
[30;1m363 | [0m[35m[0m
[30;1m364 | [0m[35m        # Test that we are able to continue to make requests successfully[0m
[30;1m365 | [0m[35m        predict_non_error_response = requests.post([0m
[30;1m366 | [0m[35m            PREDICT_URL, json={"throw_error": False}, stream=True, timeout=2[0m
[30;1m367 | [0m[35m        )[0m
[30;1m368 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m349 | [0m[35m            local_port=8090, detach=True, wait_for_server_ready=True[0m
[30;1m350 | [0m[35m        )[0m
[30;1m351 | [0m[35m[0m
[30;1m352 | [0m[35m        predict_error_response = requests.post([0m
[30;1m353 | [0m[35m            PREDICT_URL, json={"throw_error": True}, stream=True, timeout=2[0m
[30;1m354 | [0m[35m        )[0m
[30;1m355 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m326 | [0m[35m[0m
[30;1m327 | [0m[35m        # ChunkedEncodingError is raised when the chunk does not get processed due to streaming read[0m
[30;1m328 | [0m[35m        with pytest.raises(requests.exceptions.ChunkedEncodingError):[0m
[30;1m329 | [0m[35m            response = requests.post(PREDICT_URL, json={}, stream=True)[0m
[30;1m330 | [0m[35m[0m
[30;1m331 | [0m[35m            for chunk in response.iter_content():[0m
[30;1m332 | [0m[35m                pass[0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m308 | [0m[35m            byte_string.decode() for byte_string in list(response.iter_content())[0m
[30;1m309 | [0m[35m        ] == ["0", "1", "2", "3", "4"][0m
[30;1m310 | [0m[35m[0m
[30;1m311 | [0m[35m        predict_non_stream_response = requests.post([0m
[30;1m312 | [0m[35m            PREDICT_URL, json={}, stream=True, headers={"accept": "application/json"}[0m
[30;1m313 | [0m[35m        )[0m
[30;1m314 | [0m[35m        assert "transfer-encoding" not in predict_non_stream_response.headers[0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m303 | [0m[35m        _ = tr.docker_run(local_port=8090, detach=True, wait_for_server_ready=True)[0m
[30;1m304 | [0m[35m[0m
[30;1m305 | [0m[35m        response = requests.post(PREDICT_URL, json={}, stream=True)[0m
[30;1m306 | [0m[35m        assert response.headers.get("transfer-encoding") == "chunked"[0m
[30;1m307 | [0m[35m        assert [[0m
[30;1m308 | [0m[35m            byte_string.decode() for byte_string in list(response.iter_content())[0m
[30;1m309 | [0m[35m        ] == ["0", "1", "2", "3", "4"][0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m302 | [0m[35m        tr = TrussHandle(truss_dir)[0m
[30;1m303 | [0m[35m        _ = tr.docker_run(local_port=8090, detach=True, wait_for_server_ready=True)[0m
[30;1m304 | [0m[35m[0m
[30;1m305 | [0m[35m        response = requests.post(PREDICT_URL, json={}, stream=True)[0m
[30;1m306 | [0m[35m        assert response.headers.get("transfer-encoding") == "chunked"[0m
[30;1m307 | [0m[35m        assert [[0m
[30;1m308 | [0m[35m            byte_string.decode() for byte_string in list(response.iter_content())[0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m288 | [0m[35m        tr = TrussHandle(truss_dir)[0m
[30;1m289 | [0m[35m        _ = tr.docker_run(local_port=8090, detach=True, wait_for_server_ready=True)[0m
[30;1m290 | [0m[35m[0m
[30;1m291 | [0m[35m        response = requests.post(PREDICT_URL, json={})[0m
[30;1m292 | [0m[35m        assert response.json() == {[0m
[30;1m293 | [0m[35m            "preprocess_value": "value",[0m
[30;1m294 | [0m[35m            "postprocess_value": "value",[0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m276 | [0m[35m        tr = TrussHandle(truss_dir)[0m
[30;1m277 | [0m[35m        _ = tr.docker_run(local_port=8090, detach=True, wait_for_server_ready=True)[0m
[30;1m278 | [0m[35m[0m
[30;1m279 | [0m[35m        response = requests.post(PREDICT_URL, json={})[0m
[30;1m280 | [0m[35m        assert response.status_code == 200[0m
[30;1m281 | [0m[35m        assert response.json() == '{\n    "foo": "bla",\n    "bar": 123\n}'[0m
[30;1m282 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m263 | [0m[35m        time.sleep(3)  # Sleeping to allow the load to finish[0m
[30;1m264 | [0m[35m[0m
[30;1m265 | [0m[35m        # The prediction imports torch which is specified in a requirements.txt and returns if GPU i[0m
[30;1m266 | [0m[35m        response = requests.post(PREDICT_URL, json={})[0m
[30;1m267 | [0m[35m        assert response.status_code == 200[0m
[30;1m268 | [0m[35m        assert response.json() is False[0m
[30;1m269 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m236 | [0m[35m        # succeed within the 2 seconds, and the third will fail, since[0m
[30;1m237 | [0m[35m        # it cannot start until the first two have completed.[0m
[30;1m238 | [0m[35m        def make_request():[0m
[30;1m239 | [0m[35m            requests.post(PREDICT_URL, json={}, timeout=3)[0m
[30;1m240 | [0m[35m[0m
[30;1m241 | [0m[35m        successful_thread_1 = _PropagatingThread(target=make_request)[0m
[30;1m242 | [0m[35m        successful_thread_2 = _PropagatingThread(target=make_request)[0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m        @handle_request_exception[0m
[30;1m210 | [0m[35m        def _test_invocations(expected_code):[0m
[30;1m211 | [0m[35m            invocations = requests.post([0m
[30;1m212 | [0m[35m                f"{truss_server_addr}/v1/models/model:predict", json={}[0m
[30;1m213 | [0m[35m            )[0m
[30;1m214 | [0m[35m            assert invocations.status_code == expected_code[0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m202 | [0m[35m[0m
[30;1m203 | [0m[35m        @handle_request_exception[0m
[30;1m204 | [0m[35m        def _test_ping(expected_code):[0m
[30;1m205 | [0m[35m            ping = requests.get(f"{truss_server_addr}/ping")[0m
[30;1m206 | [0m[35m            assert ping.status_code == expected_code[0m
[30;1m207 | [0m[35m            return True[0m
[30;1m208 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m196 | [0m[35m[0m
[30;1m197 | [0m[35m        @handle_request_exception[0m
[30;1m198 | [0m[35m        def _test_is_loaded(expected_code):[0m
[30;1m199 | [0m[35m            ready = requests.get(f"{truss_server_addr}/v1/models/model/loaded")[0m
[30;1m200 | [0m[35m            assert ready.status_code == expected_code[0m
[30;1m201 | [0m[35m            return True[0m
[30;1m202 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m        @handle_request_exception[0m
[30;1m192 | [0m[35m        def _test_readiness_probe(expected_code):[0m
[30;1m193 | [0m[35m            ready = requests.get(f"{truss_server_addr}/v1/models/model")[0m
[30;1m194 | [0m[35m            assert ready.status_code == expected_code[0m
[30;1m195 | [0m[35m            return True[0m
[30;1m196 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m184 | [0m[35m[0m
[30;1m185 | [0m[35m        @handle_request_exception[0m
[30;1m186 | [0m[35m        def _test_liveness_probe(expected_code):[0m
[30;1m187 | [0m[35m            live = requests.get(f"{truss_server_addr}/")[0m
[30;1m188 | [0m[35m            assert live.status_code == expected_code[0m
[30;1m189 | [0m[35m            return True[0m
[30;1m190 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1349 | [0m[35m        # Make sure there is no context creep into user traces. No user trace should[0m
[30;1m1350 | [0m[35m        # have a truss trace as parent.[0m
[30;1m1351 | [0m[35m        assert user_parents & truss_spans == set()[0m
[30;1m1352 | [0m[35m        # But make sure traces have parents at all.[0m
[30;1m1353 | [0m[35m        assert len(user_parents) > 3[0m
[30;1m1354 | [0m[35m        assert len(truss_parents) > 3[0m
[30;1m1355 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1653 | [0m[35m    # It seems that the "builtin" functionality of the FastAPI server already buffers[0m
[30;1m1654 | [0m[35m    # the generator, so that it doesn't keep hanging around if the client doesn't[0m
[30;1m1655 | [0m[35m    # consume data. `_buffered_response_generator` might be redundant.[0m
[30;1m1656 | [0m[35m    # This can be observed by waiting for a long time in `make_request`: the server will[0m
[30;1m1657 | [0m[35m    # print `Done` for the tasks, while we still wait and hold the unconsumed response.[0m
[30;1m1658 | [0m[35m    # For testing we need to have actually slow generation to keep the server busy.[0m
[30;1m1659 | [0m[35m    model = """[0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1228 | [0m[35m        assert (await task_1) == {"seconds": 2, "task": 1}[0m
[30;1m1229 | [0m[35m[0m
[30;1m1230 | [0m[35m        # Now mess around in the docker container to reduce the grace period to 3 s.[0m
[30;1m1231 | [0m[35m        # (There's not nice way to patch this...)[0m
[30;1m1232 | [0m[35m        _patch_termination_timeout(container, 3, truss_container_fs)[0m
[30;1m1233 | [0m[35m        # Now only one request should complete.[0m
[30;1m1234 | [0m[35m        container.restart()[0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1227 | [0m[35m        assert (await task_0) == {"seconds": 2, "task": 0}[0m
[30;1m1228 | [0m[35m        assert (await task_1) == {"seconds": 2, "task": 1}[0m
[30;1m1229 | [0m[35m[0m
[30;1m1230 | [0m[35m        # Now mess around in the docker container to reduce the grace period to 3 s.[0m
[30;1m1231 | [0m[35m        # (There's not nice way to patch this...)[0m
[30;1m1232 | [0m[35m        _patch_termination_timeout(container, 3, truss_container_fs)[0m
[30;1m1233 | [0m[35m        # Now only one request should complete.[0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1217 | [0m[35m        await asyncio.sleep(0.1)  # Yield to event loop to make above task run.[0m
[30;1m1218 | [0m[35m[0m
[30;1m1219 | [0m[35m        t0 = time.perf_counter()[0m
[30;1m1220 | [0m[35m        # Even though the server has 120s grace period, we expect to finish much[0m
[30;1m1221 | [0m[35m        # faster in the test here, so use 10s.[0m
[30;1m1222 | [0m[35m        container.stop(10)[0m
[30;1m1223 | [0m[35m        stop_time = time.perf_counter() - t0[0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1188 | [0m[35m@pytest.mark.integration[0m
[30;1m1189 | [0m[35masync def test_graceful_shutdown(truss_container_fs):[0m
[30;1m1190 | [0m[35m    model = """[0m
[30;1m1191 | [0m[35m    import time[0m
[30;1m1192 | [0m[35m    class Model:[0m
[30;1m1193 | [0m[35m        def predict(self, request):[0m
[30;1m1194 | [0m[35m            print(f"Received {request}")[0m
[30;1m1195 | [0m[35m            time.sleep(request["seconds"])[0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1110 | [0m[35m        assert container.logs().count("Health check failed.") == 2[0m
[30;1m1111 | [0m[35m[0m
[30;1m1112 | [0m[35m    model = """[0m
[30;1m1113 | [0m[35m    import time[0m
[30;1m1114 | [0m[35m[0m
[30;1m1115 | [0m[35m    class Model:[0m
[30;1m1116 | [0m[35m        def __init__(self, **kwargs):[0m
[30;1m1117 | [0m[35m            self._healthy = False[0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1099 | [0m[35m        # Ensure we only log after model.load is complete[0m
[30;1m1100 | [0m[35m        assert "Health check failed." not in container.logs()[0m
[30;1m1101 | [0m[35m[0m
[30;1m1102 | [0m[35m        # Sleep a few seconds to get the server some time to wake up[0m
[30;1m1103 | [0m[35m        time.sleep(10)[0m
[30;1m1104 | [0m[35m[0m
[30;1m1105 | [0m[35m        healthy = requests.get(f"{truss_server_addr}/v1/models/model")[0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1075 | [0m[35m        assert "Health check failed." in container.logs()[0m
[30;1m1076 | [0m[35m[0m
[30;1m1077 | [0m[35m    model = """[0m
[30;1m1078 | [0m[35m    import time[0m
[30;1m1079 | [0m[35m[0m
[30;1m1080 | [0m[35m    class Model:[0m
[30;1m1081 | [0m[35m        def load(self):[0m
[30;1m1082 | [0m[35m            time.sleep(10)[0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1061 | [0m[35m            local_port=8090, detach=True, wait_for_server_ready=False[0m
[30;1m1062 | [0m[35m        )[0m
[30;1m1063 | [0m[35m[0m
[30;1m1064 | [0m[35m        # Sleep a few seconds to get the server some time to wake up[0m
[30;1m1065 | [0m[35m        time.sleep(10)[0m
[30;1m1066 | [0m[35m[0m
[30;1m1067 | [0m[35m        truss_server_addr = "http://localhost:8090"[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1026 | [0m[35m            assert healthy.status_code == 200[0m
[30;1m1027 | [0m[35m        assert healthy.status_code == 503[0m
[30;1m1028 | [0m[35m        diff = container.diff()[0m
[30;1m1029 | [0m[35m        assert "/root/inference_server_crashed.txt" in diff[0m
[30;1m1030 | [0m[35m        assert diff["/root/inference_server_crashed.txt"] == "A"[0m
[30;1m1031 | [0m[35m[0m
[30;1m1032 | [0m[35m    model = """[0m
[30;1m1033 | [0m[35m    class Model:[0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1025 | [0m[35m                break[0m
[30;1m1026 | [0m[35m            assert healthy.status_code == 200[0m
[30;1m1027 | [0m[35m        assert healthy.status_code == 503[0m
[30;1m1028 | [0m[35m        diff = container.diff()[0m
[30;1m1029 | [0m[35m        assert "/root/inference_server_crashed.txt" in diff[0m
[30;1m1030 | [0m[35m        assert diff["/root/inference_server_crashed.txt"] == "A"[0m
[30;1m1031 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m779 | [0m[35m        LOAD_BUFFER_TIME = 7[0m
[30;1m780 | [0m[35m        PREDICT_TEST_TIME = 15[0m
[30;1m781 | [0m[35m[0m
[30;1m782 | [0m[35m        # Sleep a few seconds to get the server some time to wake up[0m
[30;1m783 | [0m[35m        time.sleep(SERVER_WARMUP_TIME)[0m
[30;1m784 | [0m[35m[0m
[30;1m785 | [0m[35m        # The truss takes about 30 seconds to load.[0m

[31m--[ [0m[34mMatch #[0m[33m232[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m571 | [0m[35m[0m
[30;1m572 | [0m[35m        with ThreadPoolExecutor() as e:[0m
[30;1m573 | [0m[35m            # We use concurrent.futures.wait instead of the timeout property[0m
[30;1m574 | [0m[35m            # on requests, since requests timeout property has a complex interaction[0m
[30;1m575 | [0m[35m            # with streaming.[0m
[30;1m576 | [0m[35m            first_request = e.submit(make_request, 0)[0m
[30;1m577 | [0m[35m            second_request = e.submit(make_request, 0.2)[0m

[31m--[ [0m[34mMatch #[0m[33m233[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m570 | [0m[35m            assert response.json() == ["0 modified", "1 modified"][0m
[30;1m571 | [0m[35m[0m
[30;1m572 | [0m[35m        with ThreadPoolExecutor() as e:[0m
[30;1m573 | [0m[35m            # We use concurrent.futures.wait instead of the timeout property[0m
[30;1m574 | [0m[35m            # on requests, since requests timeout property has a complex interaction[0m
[30;1m575 | [0m[35m            # with streaming.[0m
[30;1m576 | [0m[35m            first_request = e.submit(make_request, 0)[0m

[31m--[ [0m[34mMatch #[0m[33m234[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m545 | [0m[35m    """[0m
[30;1m546 | [0m[35m[0m
[30;1m547 | [0m[35m    model = """[0m
[30;1m548 | [0m[35m    import time[0m
[30;1m549 | [0m[35m[0m
[30;1m550 | [0m[35m    class Model:[0m
[30;1m551 | [0m[35m        def postprocess(self, response):[0m
[30;1m552 | [0m[35m            updated_items = [][0m

[31m--[ [0m[34mMatch #[0m[33m235[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m541 | [0m[35m    Tests a Truss that has a postprocess step defined, and ensures that the[0m
[30;1m542 | [0m[35m    postprocess does not happen within the predict lock. To do this, we sleep[0m
[30;1m543 | [0m[35m    for two seconds during the postprocess, and fire off two requests with a total[0m
[30;1m544 | [0m[35m    timeout of 3 seconds, ensureing that if they were serialized the test would fail.[0m
[30;1m545 | [0m[35m    """[0m
[30;1m546 | [0m[35m[0m
[30;1m547 | [0m[35m    model = """[0m

[31m--[ [0m[34mMatch #[0m[33m236[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m519 | [0m[35m[0m
[30;1m520 | [0m[35m        with ThreadPoolExecutor() as e:[0m
[30;1m521 | [0m[35m            # We use concurrent.futures.wait instead of the timeout property[0m
[30;1m522 | [0m[35m            # on requests, since requests timeout property has a complex interaction[0m
[30;1m523 | [0m[35m            # with streaming.[0m
[30;1m524 | [0m[35m            first_request = e.submit(make_request, 0)[0m
[30;1m525 | [0m[35m            second_request = e.submit(make_request, 0.2)[0m

[31m--[ [0m[34mMatch #[0m[33m237[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m518 | [0m[35m            assert response.content == b"0 modified1 modified"[0m
[30;1m519 | [0m[35m[0m
[30;1m520 | [0m[35m        with ThreadPoolExecutor() as e:[0m
[30;1m521 | [0m[35m            # We use concurrent.futures.wait instead of the timeout property[0m
[30;1m522 | [0m[35m            # on requests, since requests timeout property has a complex interaction[0m
[30;1m523 | [0m[35m            # with streaming.[0m
[30;1m524 | [0m[35m            first_request = e.submit(make_request, 0)[0m

[31m--[ [0m[34mMatch #[0m[33m238[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m493 | [0m[35m    the test would fail.[0m
[30;1m494 | [0m[35m    """[0m
[30;1m495 | [0m[35m    model = """[0m
[30;1m496 | [0m[35m    import time[0m
[30;1m497 | [0m[35m[0m
[30;1m498 | [0m[35m    class Model:[0m
[30;1m499 | [0m[35m        def postprocess(self, response):[0m
[30;1m500 | [0m[35m            for item in response:[0m

[31m--[ [0m[34mMatch #[0m[33m239[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m489 | [0m[35m    Tests a Truss where predict returns non-streaming, but postprocess is streamed, and[0m
[30;1m490 | [0m[35m    ensures that the postprocess step does not happen within the predict lock. To do this,[0m
[30;1m491 | [0m[35m    we sleep for two seconds during the postprocess streaming process, and fire off two[0m
[30;1m492 | [0m[35m    requests with a total timeout of 3 seconds, ensuring that if they were serialized[0m
[30;1m493 | [0m[35m    the test would fail.[0m
[30;1m494 | [0m[35m    """[0m
[30;1m495 | [0m[35m    model = """[0m

[31m--[ [0m[34mMatch #[0m[33m240[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m454 | [0m[35m    function is applied.[0m
[30;1m455 | [0m[35m    """[0m
[30;1m456 | [0m[35m    model = """[0m
[30;1m457 | [0m[35m    import time[0m
[30;1m458 | [0m[35m[0m
[30;1m459 | [0m[35m    class Model:[0m
[30;1m460 | [0m[35m        def postprocess(self, response):[0m
[30;1m461 | [0m[35m            for item in response:[0m

[31m--[ [0m[34mMatch #[0m[33m241[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m354 | [0m[35m        )[0m
[30;1m355 | [0m[35m[0m
[30;1m356 | [0m[35m        # In error cases, the response will return whatever the stream returned,[0m
[30;1m357 | [0m[35m        # in this case, the first 3 items. We timeout after 2 seconds to ensure that[0m
[30;1m358 | [0m[35m        # stream finishes reading and releases the predict semaphore.[0m
[30;1m359 | [0m[35m        assert [[0m
[30;1m360 | [0m[35m            byte_string.decode()[0m

[31m--[ [0m[34mMatch #[0m[33m242[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m331 | [0m[35m            for chunk in response.iter_content():[0m
[30;1m332 | [0m[35m                pass[0m
[30;1m333 | [0m[35m[0m
[30;1m334 | [0m[35m        # Check to ensure the Timeout error is in the container logs[0m
[30;1m335 | [0m[35m        # TODO: maybe intercept this error better?[0m
[30;1m336 | [0m[35m        _assert_logs_contain_error([0m
[30;1m337 | [0m[35m            container.logs(),[0m

[31m--[ [0m[34mMatch #[0m[33m243[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m324 | [0m[35m            local_port=8090, detach=True, wait_for_server_ready=True[0m
[30;1m325 | [0m[35m        )[0m
[30;1m326 | [0m[35m[0m
[30;1m327 | [0m[35m        # ChunkedEncodingError is raised when the chunk does not get processed due to streaming read[0m
[30;1m328 | [0m[35m        with pytest.raises(requests.exceptions.ChunkedEncodingError):[0m
[30;1m329 | [0m[35m            response = requests.post(PREDICT_URL, json={}, stream=True)[0m
[30;1m330 | [0m[35m[0m
[30;1m331 | [0m[35m            for chunk in response.iter_content():[0m

[31m--[ [0m[34mMatch #[0m[33m244[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m168 | [0m[35m[0m
[30;1m169 | [0m[35m        _ = tr.docker_run(local_port=8090, detach=True, wait_for_server_ready=False)[0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35m        # Sleep a few seconds to get the server some time to  wake up[0m
[30;1m172 | [0m[35m        time.sleep(10)[0m
[30;1m173 | [0m[35m[0m
[30;1m174 | [0m[35m        truss_server_addr = "http://localhost:8090"[0m

[31m--[ [0m[34mMatch #[0m[33m245[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m65 | [0m[35mdef _assert_logs_contain(logs: str, message: str, level: str = "INFO"):[0m
[30;1m66 | [0m[35m    loglines = [json.loads(line) for line in logs.splitlines()][0m
[30;1m67 | [0m[35m    assert any(_log_contains_line(line, message, level) for line in loglines), ([0m
[30;1m68 | [0m[35m        f"Did not find expected  logs.\n"[0m
[30;1m69 | [0m[35m        f"Expected message: {message}\nActual logs:\n{loglines}"[0m
[30;1m70 | [0m[35m    )[0m
[30;1m71 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m246[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35m    assert any([0m
[30;1m58 | [0m[35m        _log_contains_line(line, message, "ERROR", error) for line in loglines[0m
[30;1m59 | [0m[35m    ), ([0m
[30;1m60 | [0m[35m        f"Did not find expected error in logs.\nExpected error: {error}\n"[0m
[30;1m61 | [0m[35m        f"Expected message: {message}\nActual logs:\n{loglines}"[0m
[30;1m62 | [0m[35m    )[0m
[30;1m63 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m247[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_inference.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35mimport sys[0m
[30;1m10 | [0m[35mimport tempfile[0m
[30;1m11 | [0m[35mimport textwrap[0m
[30;1m12 | [0m[35mimport time[0m
[30;1m13 | [0m[35mfrom concurrent.futures import ThreadPoolExecutor[0m
[30;1m14 | [0m[35mfrom pathlib import Path[0m
[30;1m15 | [0m[35mfrom threading import Thread[0m
[30;1m16 | [0m[35mfrom typing import Iterator, Mapping, Optional[0m

[31m--[ [0m[34mMatch #[0m[33m248[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/control/control/test_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m274 | [0m[35m    resp = await client.get("/control/truss_hash")[0m
[30;1m275 | [0m[35m    original_hash = resp.json()["result"][0m
[30;1m276 | [0m[35m    patch_request = PatchRequest(hash="dummy", prev_hash=original_hash, patches=patches)[0m
[30;1m277 | [0m[35m    return await client.post("/control/patch", json=patch_request.to_dict())[0m
[30;1m278 | [0m[35m[0m
[30;1m279 | [0m[35m[0m
[30;1m280 | [0m[35m@contextmanager[0m

[31m--[ [0m[34mMatch #[0m[33m249[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/control/control/test_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m271 | [0m[35m[0m
[30;1m272 | [0m[35m[0m
[30;1m273 | [0m[35masync def _apply_patches(client, patches: List[Patch]):[0m
[30;1m274 | [0m[35m    resp = await client.get("/control/truss_hash")[0m
[30;1m275 | [0m[35m    original_hash = resp.json()["result"][0m
[30;1m276 | [0m[35m    patch_request = PatchRequest(hash="dummy", prev_hash=original_hash, patches=patches)[0m
[30;1m277 | [0m[35m    return await client.post("/control/patch", json=patch_request.to_dict())[0m

[31m--[ [0m[34mMatch #[0m[33m250[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/control/control/test_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m263 | [0m[35m    original_hash = resp.json()["result"][0m
[30;1m264 | [0m[35m    print(f"ORIGINAL HASH: {original_hash}")[0m
[30;1m265 | [0m[35m    patch_request = PatchRequest(hash="dummy", prev_hash=original_hash, patches=[patch])[0m
[30;1m266 | [0m[35m    resp = await client.post("/control/patch", json=patch_request.to_dict())[0m
[30;1m267 | [0m[35m    resp = await _apply_patches(client, [patch])[0m
[30;1m268 | [0m[35m    assert resp.status_code == 200[0m
[30;1m269 | [0m[35m    assert "error" not in resp.json()[0m

[31m--[ [0m[34mMatch #[0m[33m251[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/control/control/test_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m259 | [0m[35m[0m
[30;1m260 | [0m[35m[0m
[30;1m261 | [0m[35masync def _verify_apply_patch_success(client, patch: Patch):[0m
[30;1m262 | [0m[35m    resp = await client.get("/control/truss_hash")[0m
[30;1m263 | [0m[35m    original_hash = resp.json()["result"][0m
[30;1m264 | [0m[35m    print(f"ORIGINAL HASH: {original_hash}")[0m
[30;1m265 | [0m[35m    patch_request = PatchRequest(hash="dummy", prev_hash=original_hash, patches=[patch])[0m

[31m--[ [0m[34mMatch #[0m[33m252[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/control/control/test_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m252 | [0m[35m    with patch("endpoints.INFERENCE_SERVER_START_WAIT_SECS", new=4), pytest.raises([0m
[30;1m253 | [0m[35m        RetryError[0m
[30;1m254 | [0m[35m    ):[0m
[30;1m255 | [0m[35m        await client.get("/v1/models/model")[0m
[30;1m256 | [0m[35m[0m
[30;1m257 | [0m[35m    # We should have made 5 attempts[0m
[30;1m258 | [0m[35m    assert app.state.proxy_client.send.call_count == 5[0m

[31m--[ [0m[34mMatch #[0m[33m253[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/control/control/test_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m231 | [0m[35m    app.state.proxy_client.send = AsyncMock(side_effect=mock_send)[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m    with pytest.raises(RetryError):[0m
[30;1m234 | [0m[35m        await client.get("/v1/models/model")[0m
[30;1m235 | [0m[35m[0m
[30;1m236 | [0m[35m    # Health check was retried 10 times[0m
[30;1m237 | [0m[35m    assert app.state.proxy_client.send.call_count == 10[0m

[31m--[ [0m[34mMatch #[0m[33m254[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/control/control/test_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m216 | [0m[35m[0m
[30;1m217 | [0m[35m@pytest.mark.anyio[0m
[30;1m218 | [0m[35masync def test_health_check(client):[0m
[30;1m219 | [0m[35m    resp = await client.get("/v1/models/model")[0m
[30;1m220 | [0m[35m    assert resp.status_code == 200[0m
[30;1m221 | [0m[35m    assert resp.json() == {}[0m
[30;1m222 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m255[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/control/control/test_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m175 | [0m[35m@pytest.mark.anyio[0m
[30;1m176 | [0m[35masync def test_invalid_patch(client):[0m
[30;1m177 | [0m[35m    patch_request = PatchRequest(hash="dummy", prev_hash="invalid", patches=[])[0m
[30;1m178 | [0m[35m    resp = await client.post("/control/patch", json=patch_request.to_dict())[0m
[30;1m179 | [0m[35m    assert resp.status_code == 200[0m
[30;1m180 | [0m[35m    assert "error" in resp.json()[0m
[30;1m181 | [0m[35m    assert resp.json()["error"]["type"] == "inadmissible_patch"[0m

[31m--[ [0m[34mMatch #[0m[33m256[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/control/control/test_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m168 | [0m[35m[0m
[30;1m169 | [0m[35m@pytest.mark.anyio[0m
[30;1m170 | [0m[35masync def test_404(client):[0m
[30;1m171 | [0m[35m    resp = await client.post("/control/nonexitant")[0m
[30;1m172 | [0m[35m    assert resp.status_code == 404[0m
[30;1m173 | [0m[35m[0m
[30;1m174 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m257[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/control/control/test_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m133 | [0m[35m        ),[0m
[30;1m134 | [0m[35m    )[0m
[30;1m135 | [0m[35m    await _verify_apply_patch_success(client, patch)[0m
[30;1m136 | [0m[35m    resp = await client.post("/v1/models/model:predict", json={})[0m
[30;1m137 | [0m[35m    resp.status_code == 200[0m
[30;1m138 | [0m[35m    assert resp.json() == {"prediction": [1]}[0m
[30;1m139 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m258[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/control/control/test_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m90 | [0m[35m    assert "msg" in resp.json()[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m    # Try second restart[0m
[30;1m93 | [0m[35m    resp = await client.post("/control/stop_inference_server")[0m
[30;1m94 | [0m[35m    assert resp.status_code == 200[0m
[30;1m95 | [0m[35m    assert "error" not in resp.json()[0m
[30;1m96 | [0m[35m    assert "msg" in resp.json()[0m

[31m--[ [0m[34mMatch #[0m[33m259[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/control/control/test_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m@pytest.mark.anyio[0m
[30;1m86 | [0m[35masync def test_restart_server(client):[0m
[30;1m87 | [0m[35m    resp = await client.post("/control/stop_inference_server")[0m
[30;1m88 | [0m[35m    assert resp.status_code == 200[0m
[30;1m89 | [0m[35m    assert "error" not in resp.json()[0m
[30;1m90 | [0m[35m    assert "msg" in resp.json()[0m

[31m--[ [0m[34mMatch #[0m[33m260[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/control/control/test_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m120 | [0m[35m    mock_model_file_content = """[0m
[30;1m121 | [0m[35mclass Model:[0m
[30;1m122 | [0m[35m    def load(self):[0m
[30;1m123 | [0m[35m        import time[0m
[30;1m124 | [0m[35m        time.sleep(3)[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m    def predict(self, request):[0m
[30;1m127 | [0m[35m        return {'prediction': [1]}[0m

[31m--[ [0m[34mMatch #[0m[33m261[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/control/control/test_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35mfrom tenacity import RetryError[0m
[30;1m11 | [0m[35mfrom truss.truss_handle.patch.custom_types import PatchRequest[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m# Needed to simulate the set up on the model docker container[0m
[30;1m14 | [0m[35msys.path.append([0m
[30;1m15 | [0m[35m    str([0m
[30;1m16 | [0m[35m        Path(__file__).parent.parent.parent.parent.parent[0m

[31m--[ [0m[34mMatch #[0m[33m262[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/shared/log_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mdef _disable_json_logging() -> bool:[0m
[30;1m12 | [0m[35m    return bool(os.environ.get("DISABLE_JSON_LOGGING"))[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mclass _HealthCheckFilter(logging.Filter):[0m

[31m--[ [0m[34mMatch #[0m[33m263[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/pydantic_numpy.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mfrom typing import TYPE_CHECKING, Any, ClassVar[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mimport pydantic[0m
[30;1m5 | [0m[35mfrom pydantic.json_schema import JsonSchemaValue[0m

[31m--[ [0m[34mMatch #[0m[33m264[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server/common/tracing.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m58 | [0m[35m    completely from potential user-defined tracing - see also `detach_context` below.[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    """[0m
[30;1m61 | [0m[35m    enable_tracing_data = config.get("runtime", {}).get([0m
[30;1m62 | [0m[35m        "enable_tracing_data", DEFAULT_ENABLE_TRACING_DATA[0m
[30;1m63 | [0m[35m    )[0m
[30;1m64 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m265[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server/common/tracing.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m58 | [0m[35m    completely from potential user-defined tracing - see also `detach_context` below.[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    """[0m
[30;1m61 | [0m[35m    enable_tracing_data = config.get("runtime", {}).get([0m
[30;1m62 | [0m[35m        "enable_tracing_data", DEFAULT_ENABLE_TRACING_DATA[0m
[30;1m63 | [0m[35m    )[0m
[30;1m64 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m266[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server/common/tracing.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mimport logging[0m
[30;1m4 | [0m[35mimport os[0m
[30;1m5 | [0m[35mimport pathlib[0m
[30;1m6 | [0m[35mimport time[0m
[30;1m7 | [0m[35mfrom typing import Iterator, List, Optional, Sequence[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mimport opentelemetry.exporter.otlp.proto.http.trace_exporter as oltp_exporter[0m
[30;1m10 | [0m[35mimport opentelemetry.sdk.resources as resources[0m

[31m--[ [0m[34mMatch #[0m[33m267[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/contexts/local_loader/docker_build_emulator.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m40 | [0m[35m            return list(map(_resolve_env, keys))[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m        result = DockerBuildEmulatorResult()[0m
[30;1m43 | [0m[35m        for cmd in self._commands:[0m
[30;1m44 | [0m[35m            if cmd.cmd not in ["ENV", "ENTRYPOINT", "COPY", "WORKDIR"]:[0m
[30;1m45 | [0m[35m                continue[0m
[30;1m46 | [0m[35m            values = _resolve_values(cmd.value)[0m

[31m--[ [0m[34mMatch #[0m[33m268[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/contexts/local_loader/docker_build_emulator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35m    """Emulates Docker Builds[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m    As running docker builds is expensive, this class emulates the docker build[0m
[30;1m19 | [0m[35m    by parsing the docker file and applying certain commands to create an[0m
[30;1m20 | [0m[35m    appropriate enviroment in a directory to simulate the root of the file system.[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m    Support COPY, ENV, ENTRYPOINT, WORKDIR commands. All other commands are ignored.[0m

[31m--[ [0m[34mMatch #[0m[33m269[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/contexts/local_loader/docker_build_emulator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m15 | [0m[35mclass DockerBuildEmulator:[0m
[30;1m16 | [0m[35m    """Emulates Docker Builds[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m    As running docker builds is expensive, this class emulates the docker build[0m
[30;1m19 | [0m[35m    by parsing the docker file and applying certain commands to create an[0m
[30;1m20 | [0m[35m    appropriate enviroment in a directory to simulate the root of the file system.[0m
[30;1m21 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m270[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/contexts/local_loader/docker_build_emulator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m15 | [0m[35mclass DockerBuildEmulator:[0m
[30;1m16 | [0m[35m    """Emulates Docker Builds[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m    As running docker builds is expensive, this class emulates the docker build[0m
[30;1m19 | [0m[35m    by parsing the docker file and applying certain commands to create an[0m
[30;1m20 | [0m[35m    appropriate enviroment in a directory to simulate the root of the file system.[0m
[30;1m21 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m271[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/contexts/local_loader/docker_build_emulator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mclass DockerBuildEmulator:[0m
[30;1m16 | [0m[35m    """Emulates Docker Builds[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m    As running docker builds is expensive, this class emulates the docker build[0m
[30;1m19 | [0m[35m    by parsing the docker file and applying certain commands to create an[0m

[31m--[ [0m[34mMatch #[0m[33m272[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/pyproject.toml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m70 | [0m[35m#  isolated.[0m
[30;1m71 | [0m[35m[tool.poetry.dependencies][0m
[30;1m72 | [0m[35m# "base" dependencies.[0m
[30;1m73 | [0m[35m# "When using chains, 3.9 will be required at runtime, but other truss functionality works with 3.8.[0m
[30;1m74 | [0m[35mpython = ">=3.8,<3.13"[0m
[30;1m75 | [0m[35mhuggingface_hub = ">=0.25.0"[0m
[30;1m76 | [0m[35mpydantic = ">=1.10.0"  # We cannot upgrade to v2, due to customer constraints.[0m

[31m--[ [0m[34mMatch #[0m[33m273[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/pyproject.toml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m50 | [0m[35mess:[0m
[30;1m51 | [0m[35m#[0m
[30;1m52 | [0m[35m# * Use poetry groups only for dev dependencies. These are never included in pip. For dev envs[0m
[30;1m53 | [0m[35m#   use the following installation command `poetry install --with=dev,dev-server --extras=all`.[0m
[30;1m54 | [0m[35m# * All other dependencies are in the main group `tool.poetry.dependencies`. Base dependencies are[0m
[30;1m55 | [0m[35m#   at the top and non-optional.[0m
[30;1m56 | [0m[35m# * Dependencies from other compoents are listed after, and marked with `optional = false`. If a[0m
[30;1m57 | [0m[35m#   dependency is needed by mutlipe extras, only add it once, but see next step. This also ensures[0m

[31m--[ [0m[34mMatch #[0m[33m274[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/pyproject.toml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m[tool.poetry.group.dev-server.dependencies][0m
[30;1m158 | [0m[35m# These packages are needed to run local tests of server components. Note that the actual[0m
[30;1m159 | [0m[35m# server deps for building the docker image are (so far) defined in `requirements.txt`-files.[0m
[30;1m160 | [0m[35mdockerfile = "^3.2.0"[0m
[30;1m161 | [0m[35mfastapi =">=0.109.1"[0m
[30;1m162 | [0m[35mflask = "^2.3.3"[0m

[31m--[ [0m[34mMatch #[0m[33m275[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/pyproject.toml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m52 | [0m[35m# * Use poetry groups only for dev dependencies. These are never included in pip. For dev envs[0m
[30;1m53 | [0m[35m#   use the following installation command `poetry install --with=dev,dev-server --extras=all`.[0m
[30;1m54 | [0m[35m# * All other dependencies are in the main group `tool.poetry.dependencies`. Base dependencies are[0m
[30;1m55 | [0m[35m#   at the top and non-optional.[0m
[30;1m56 | [0m[35m# * Dependencies from other compoents are listed after, and marked with `optional = false`. If a[0m
[30;1m57 | [0m[35m#   dependency is needed by mutlipe extras, only add it once, but see next step. This also ensures[0m

[31m--[ [0m[34mMatch #[0m[33m276[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/pyproject.toml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m42 | [0m[35m# how they depend on and import each other (e.g. `base` must not depend on anything else, the[0m
[30;1m43 | [0m[35m# server does not need local CLI tools).[0m
[30;1m44 | [0m[35m#[0m
[30;1m45 | [0m[35m# We want components to be selectable via pip installs (e.g. `pip install truss[server]`).[0m
[30;1m46 | [0m[35m# Unfortunately poetry dependency groups don't integrate natively with the "extras" concept:[0m
[30;1m47 | [0m[35m# Specifically, dependencies listed in groups (other than the implicit main group) cannot be used[0m
[30;1m48 | [0m[35m# for extras.[0m

[31m--[ [0m[34mMatch #[0m[33m277[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_testing_utilities_for_other_tests.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35mimport logging[0m
[30;1m6 | [0m[35mimport shutil[0m
[30;1m7 | [0m[35mimport subprocess[0m
[30;1m8 | [0m[35mimport time[0m
[30;1m9 | [0m[35mfrom contextlib import contextmanager[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mfrom truss.base.constants import TRUSS[0m
[30;1m12 | [0m[35mfrom truss.util.docker import get_containers, kill_all[0m

[31m--[ [0m[34mMatch #[0m[33m278[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/local/local_config_handler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    @staticmethod[0m
[30;1m24 | [0m[35m    def sync_secrets_mount_dir():[0m
[30;1m25 | [0m[35m        """Syncs config secrets into a directory form, meant for mounting onto docker containers."""[0m
[30;1m26 | [0m[35m        LocalConfigHandler._ensure_config_dir()[0m
[30;1m27 | [0m[35m        local_config = LocalConfigHandler.get_config()[0m
[30;1m28 | [0m[35m        secrets = local_config.secrets[0m

[31m--[ [0m[34mMatch #[0m[33m279[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1072 | [0m[35m        ),[0m
[30;1m1073 | [0m[35m    ):[0m
[30;1m1074 | [0m[35m        with attempt:[0m
[30;1m1075 | [0m[35m            response = requests.get(url)[0m
[30;1m1076 | [0m[35m            return response[0m
[30;1m1077 | [0m[35m[0m
[30;1m1078 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m280[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m788 | [0m[35m[0m
[30;1m789 | [0m[35m        container = self.get_running_serving_container_ignore_hash()[0m
[30;1m790 | [0m[35m        model_base_url = _get_url_from_container(container)[0m
[30;1m791 | [0m[35m        resp = requests.get(f"{model_base_url}/control/has_partially_applied_patch")[0m
[30;1m792 | [0m[35m        resp.raise_for_status()[0m
[30;1m793 | [0m[35m        respj = resp.json()[0m
[30;1m794 | [0m[35m        if "error" in respj:[0m

[31m--[ [0m[34mMatch #[0m[33m281[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m762 | [0m[35m[0m
[30;1m763 | [0m[35m        container = self.get_running_serving_container_ignore_hash()[0m
[30;1m764 | [0m[35m        model_base_url = _get_url_from_container(container)[0m
[30;1m765 | [0m[35m        resp = requests.get(f"{model_base_url}/control/truss_hash")[0m
[30;1m766 | [0m[35m        resp.raise_for_status()[0m
[30;1m767 | [0m[35m        respj = resp.json()[0m
[30;1m768 | [0m[35m        if "error" in respj:[0m

[31m--[ [0m[34mMatch #[0m[33m282[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m742 | [0m[35m            )[0m
[30;1m743 | [0m[35m[0m
[30;1m744 | [0m[35m        model_base_url = _get_url_from_container(container)[0m
[30;1m745 | [0m[35m        resp = requests.post([0m
[30;1m746 | [0m[35m            f"{model_base_url}/control/patch", json=patch_request.to_dict()[0m
[30;1m747 | [0m[35m        )[0m
[30;1m748 | [0m[35m        resp.raise_for_status()[0m

[31m--[ [0m[34mMatch #[0m[33m283[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m426 | [0m[35m        if resp.status_code == 500:[0m
[30;1m427 | [0m[35m            raise requests.exceptions.HTTPError("500 error", response=resp)[0m
[30;1m428 | [0m[35m[0m
[30;1m429 | [0m[35m        if resp.headers.get("transfer-encoding") == "chunked":[0m
[30;1m430 | [0m[35m            # Streaming responses come back just as bytes, so we don't make assumptions[0m
[30;1m431 | [0m[35m            # about the format being JSON or msgpack.[0m
[30;1m432 | [0m[35m            return resp.content[0m

[31m--[ [0m[34mMatch #[0m[33m284[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m142 | [0m[35m                headers={"Content-Type": "application/octet-stream"},[0m
[30;1m143 | [0m[35m            )[0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35m        return requests.post(url, json=request)[0m
[30;1m146 | [0m[35m[0m
[30;1m147 | [0m[35m    @proxy_to_shadow_if_scattered[0m
[30;1m148 | [0m[35m    def build_docker_build_context(self, build_dir: Optional[Path] = None):[0m

[31m--[ [0m[34mMatch #[0m[33m285[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m        if binary:[0m
[30;1m137 | [0m[35m            binary_data = truss_msgpack_serialize(request)[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m            return requests.post([0m
[30;1m140 | [0m[35m                url,[0m
[30;1m141 | [0m[35m                data=binary_data,[0m
[30;1m142 | [0m[35m                headers={"Content-Type": "application/octet-stream"},[0m

[31m--[ [0m[34mMatch #[0m[33m286[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1030 | [0m[35m            for path in self._spec.external_package_dirs_paths:[0m
[30;1m1031 | [0m[35m                if not path.exists():[0m
[30;1m1032 | [0m[35m                    raise RuntimeError([0m
[30;1m1033 | [0m[35m                        f"Truss referes to external package at "[0m
[30;1m1034 | [0m[35m                        f"{path.resolve()} but that path does not exist."[0m
[30;1m1035 | [0m[35m                    )[0m
[30;1m1036 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m287[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1000 | [0m[35m        )[0m
[30;1m1001 | [0m[35m        resp = self.patch_container(patch_request)[0m
[30;1m1002 | [0m[35m        if "error" in resp:[0m
[30;1m1003 | [0m[35m            raise RuntimeError(f"Failed to patch control truss {resp['error']}")[0m
[30;1m1004 | [0m[35m        self._store_signature()[0m
[30;1m1005 | [0m[35m        return container[0m
[30;1m1006 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m288[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m819 | [0m[35m    def live_reload(self, enable: bool = True):[0m
[30;1m820 | [0m[35m        """Enable control plane.[0m
[30;1m821 | [0m[35m[0m
[30;1m822 | [0m[35m        Control plane allows loading truss changes into the running model[0m
[30;1m823 | [0m[35m        container. This is useful during development to iterate on model changes[0m
[30;1m824 | [0m[35m        quickly.[0m
[30;1m825 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m289[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m817 | [0m[35m        self._update_config(lambda conf: replace(conf, description=description))[0m
[30;1m818 | [0m[35m[0m
[30;1m819 | [0m[35m    def live_reload(self, enable: bool = True):[0m
[30;1m820 | [0m[35m        """Enable control plane.[0m
[30;1m821 | [0m[35m[0m
[30;1m822 | [0m[35m        Control plane allows loading truss changes into the running model[0m
[30;1m823 | [0m[35m        container. This is useful during development to iterate on model changes[0m

[31m--[ [0m[34mMatch #[0m[33m290[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m793 | [0m[35m        respj = resp.json()[0m
[30;1m794 | [0m[35m        if "error" in respj:[0m
[30;1m795 | [0m[35m            logger.error([0m
[30;1m796 | [0m[35m                "Unable to check if control truss container has partially applied patch."[0m
[30;1m797 | [0m[35m            )[0m
[30;1m798 | [0m[35m            return None[0m
[30;1m799 | [0m[35m        return respj["result"][0m

[31m--[ [0m[34mMatch #[0m[33m291[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m784 | [0m[35m    def _control_serving_container_has_partially_applied_patch(self) -> Optional[bool]:[0m
[30;1m785 | [0m[35m        """Check if there is a partially applied patch on the running live_reload capable container.[0m
[30;1m786 | [0m[35m        if not self.spec.live_reload:[0m
[30;1m787 | [0m[35m            raise ValueError("Not a control truss, operation not supported.")[0m
[30;1m788 | [0m[35m[0m
[30;1m789 | [0m[35m        container = self.get_running_serving_container_ignore_hash()[0m
[30;1m790 | [0m[35m        model_base_url = _get_url_from_container(container)[0m

[31m--[ [0m[34mMatch #[0m[33m292[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m757 | [0m[35m        """Get content hash of truss running on container."""[0m
[30;1m758 | [0m[35m        if not self.spec.live_reload:[0m
[30;1m759 | [0m[35m            raise ValueError([0m
[30;1m760 | [0m[35m                "Not a control truss fetching truss hash is not supported."[0m
[30;1m761 | [0m[35m            )[0m
[30;1m762 | [0m[35m[0m
[30;1m763 | [0m[35m        container = self.get_running_serving_container_ignore_hash()[0m

[31m--[ [0m[34mMatch #[0m[33m293[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m732 | [0m[35m        Useful for local incremental development.[0m
[30;1m733 | [0m[35m        """[0m
[30;1m734 | [0m[35m        if not self.spec.live_reload:[0m
[30;1m735 | [0m[35m            raise ValueError("Not a control truss: applying patch is not supported.")[0m
[30;1m736 | [0m[35m[0m
[30;1m737 | [0m[35m        # Note that we match on only the truss directory, not hash.[0m
[30;1m738 | [0m[35m        container = self.get_running_serving_container_ignore_hash()[0m

[31m--[ [0m[34mMatch #[0m[33m294[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m534 | [0m[35m        """Update requirements in truss model's config.[0m
[30;1m535 | [0m[35m[0m
[30;1m536 | [0m[35m        Replaces requirements in truss model's config with those from the file[0m
[30;1m537 | [0m[35m        at the given path.[0m
[30;1m538 | [0m[35m        """[0m
[30;1m539 | [0m[35m        with Path(requirements_filepath).open() as req_file:[0m
[30;1m540 | [0m[35m            self.update_requirements([0m

[31m--[ [0m[34mMatch #[0m[33m295[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m243 | [0m[35m        disable_json_logging: bool = False,[0m
[30;1m244 | [0m[35m    ):[0m
[30;1m245 | [0m[35m        """[0m
[30;1m246 | [0m[35m        Builds a docker image and runs it as a container. For control trusses,[0m
[30;1m247 | [0m[35m        tries to patch.[0m
[30;1m248 | [0m[35m[0m
[30;1m249 | [0m[35m        Args:[0m

[31m--[ [0m[34mMatch #[0m[33m296[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1121 | [0m[35m[0m
[30;1m1122 | [0m[35m[0m
[30;1m1123 | [0m[35mdef _docker_image_from_labels(labels: Dict):[0m
[30;1m1124 | [0m[35m    """Get docker image from given labels.[0m
[30;1m1125 | [0m[35m[0m
[30;1m1126 | [0m[35m    Assumes there's only one. Returns the first one it finds if there are many,[0m
[30;1m1127 | [0m[35m    no guarantees which one.[0m

[31m--[ [0m[34mMatch #[0m[33m297[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1012 | [0m[35m        model binaries.[0m
[30;1m1013 | [0m[35m        """[0m
[30;1m1014 | [0m[35m        truss_mod_time = get_max_modified_time_of_dir(self._truss_dir)[0m
[30;1m1015 | [0m[35m        # If mod time hasn't changed then hash must be the same[0m
[30;1m1016 | [0m[35m        if ([0m
[30;1m1017 | [0m[35m            self._hash_for_mod_time is not None[0m
[30;1m1018 | [0m[35m            and self._hash_for_mod_time[0] == truss_mod_time[0m

[31m--[ [0m[34mMatch #[0m[33m298[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1007 | [0m[35m    def _serving_hash(self) -> str:[0m
[30;1m1008 | [0m[35m        """Hash to be used for the serving image.[0m
[30;1m1009 | [0m[35m[0m
[30;1m1010 | [0m[35m        Caches based on max mod time of files in truss. If truss is not touched[0m
[30;1m1011 | [0m[35m        then this avoids calculating the hash, which could be expensive for large[0m
[30;1m1012 | [0m[35m        model binaries.[0m
[30;1m1013 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m299[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m875 | [0m[35m[0m
[30;1m876 | [0m[35m    @property[0m
[30;1m877 | [0m[35m    def max_modified_time(self) -> float:[0m
[30;1m878 | [0m[35m        """Max modified time of all the files and directories that this Truss spans."""[0m
[30;1m879 | [0m[35m        max_mod_time = get_max_modified_time_of_dir(self._truss_dir)[0m
[30;1m880 | [0m[35m        if self.no_external_packages:[0m
[30;1m881 | [0m[35m            return max_mod_time[0m

[31m--[ [0m[34mMatch #[0m[33m300[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m699 | [0m[35m        This is suggestive, model serving environment may still use cpu, e.g. if[0m
[30;1m700 | [0m[35m        the setup doesn't have access to a GPU.[0m
[30;1m701 | [0m[35m[0m
[30;1m702 | [0m[35m        Note that truss would typically use a larger docker base image when this[0m
[30;1m703 | [0m[35m        is enabled, for example to include the cuda libraries.[0m
[30;1m704 | [0m[35m        """[0m
[30;1m705 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m301[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m651 | [0m[35m    def get_serving_docker_containers_from_labels([0m
[30;1m652 | [0m[35m        self, all: bool = False, labels: Optional[dict] = None[0m
[30;1m653 | [0m[35m    ) -> list:[0m
[30;1m654 | [0m[35m        """Get serving docker containers, with given labels.[0m
[30;1m655 | [0m[35m[0m
[30;1m656 | [0m[35m        Args:[0m
[30;1m657 | [0m[35m            labels: Labels to match on. If none then use labels for this specific truss.[0m

[31m--[ [0m[34mMatch #[0m[33m302[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m636 | [0m[35m[0m
[30;1m637 | [0m[35m    @proxy_to_shadow_if_scattered[0m
[30;1m638 | [0m[35m    def get_all_docker_images(self):[0m
[30;1m639 | [0m[35m        """Returns all docker images for this truss.[0m
[30;1m640 | [0m[35m[0m
[30;1m641 | [0m[35m        Includes images created for previous state of the truss.[0m
[30;1m642 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m303[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m444 | [0m[35m        Set up a directory to build docker image from.[0m
[30;1m445 | [0m[35m[0m
[30;1m446 | [0m[35m        Returns:[0m
[30;1m447 | [0m[35m            docker build command.[0m
[30;1m448 | [0m[35m        """[0m
[30;1m449 | [0m[35m        image_builder = ServingImageBuilderContext.run(self._truss_dir)[0m
[30;1m450 | [0m[35m        image_builder.prepare_image_build_dir(build_dir, use_hf_secret=use_hf_secret)[0m

[31m--[ [0m[34mMatch #[0m[33m304[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m441 | [0m[35m        self, build_dir: Optional[Path] = None, use_hf_secret: bool = False[0m
[30;1m442 | [0m[35m    ):[0m
[30;1m443 | [0m[35m        """[0m
[30;1m444 | [0m[35m        Set up a directory to build docker image from.[0m
[30;1m445 | [0m[35m[0m
[30;1m446 | [0m[35m        Returns:[0m
[30;1m447 | [0m[35m            docker build command.[0m

[31m--[ [0m[34mMatch #[0m[33m305[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m401 | [0m[35m            build_dir: Directory to use for creating docker build context.[0m
[30;1m402 | [0m[35m            tag: Tags to apply to docker image.[0m
[30;1m403 | [0m[35m            local_port: Local port to forward inference server to.[0m
[30;1m404 | [0m[35m            detach: Run docker container in detached mode.[0m
[30;1m405 | [0m[35m            patch_ping_url:  Mostly for testing, if supplied then a live[0m
[30;1m406 | [0m[35m                             reload capable truss queries for truss changes[0m
[30;1m407 | [0m[35m                             by hitting this url.[0m

[31m--[ [0m[34mMatch #[0m[33m306[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m399 | [0m[35m        Args:[0m
[30;1m400 | [0m[35m            request: Input to the predict function of model truss.[0m
[30;1m401 | [0m[35m            build_dir: Directory to use for creating docker build context.[0m
[30;1m402 | [0m[35m            tag: Tags to apply to docker image.[0m
[30;1m403 | [0m[35m            local_port: Local port to forward inference server to.[0m
[30;1m404 | [0m[35m            detach: Run docker container in detached mode.[0m
[30;1m405 | [0m[35m            patch_ping_url:  Mostly for testing, if supplied then a live[0m

[31m--[ [0m[34mMatch #[0m[33m307[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m398 | [0m[35m[0m
[30;1m399 | [0m[35m        Args:[0m
[30;1m400 | [0m[35m            request: Input to the predict function of model truss.[0m
[30;1m401 | [0m[35m            build_dir: Directory to use for creating docker build context.[0m
[30;1m402 | [0m[35m            tag: Tags to apply to docker image.[0m
[30;1m403 | [0m[35m            local_port: Local port to forward inference server to.[0m
[30;1m404 | [0m[35m            detach: Run docker container in detached mode.[0m

[31m--[ [0m[34mMatch #[0m[33m308[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m392 | [0m[35m        network: Optional[str] = None,[0m
[30;1m393 | [0m[35m    ):[0m
[30;1m394 | [0m[35m        """[0m
[30;1m395 | [0m[35m        Builds docker image, runs that as a docker container[0m
[30;1m396 | [0m[35m        and makes a prediction request to the server running on the container.[0m
[30;1m397 | [0m[35m        Kills the container afterwards. Mostly useful for testing.[0m
[30;1m398 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m309[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m392 | [0m[35m        network: Optional[str] = None,[0m
[30;1m393 | [0m[35m    ):[0m
[30;1m394 | [0m[35m        """[0m
[30;1m395 | [0m[35m        Builds docker image, runs that as a docker container[0m
[30;1m396 | [0m[35m        and makes a prediction request to the server running on the container.[0m
[30;1m397 | [0m[35m        Kills the container afterwards. Mostly useful for testing.[0m
[30;1m398 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m310[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m332 | [0m[35m                container = _run_docker(None)[0m
[30;1m333 | [0m[35m[0m
[30;1m334 | [0m[35m            logger.info([0m
[30;1m335 | [0m[35m                f"Model server started on port {local_port}, docker container id {container.id}"[0m
[30;1m336 | [0m[35m            )[0m
[30;1m337 | [0m[35m        model_base_url = f"http://localhost:{local_port}/v1/models/model"[0m
[30;1m338 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m311[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m257 | [0m[35m            wait_for_server_ready: If true, wait for server to pass readiness[0m
[30;1m258 | [0m[35m              probe before returning.[0m
[30;1m259 | [0m[35m            network: docker network name.[0m
[30;1m260 | [0m[35m            container_name_prefix: optional docker container name prefix.[0m
[30;1m261 | [0m[35m[0m
[30;1m262 | [0m[35m        Returns:[0m
[30;1m263 | [0m[35m            Container, which can be used to get information about the running,[0m

[31m--[ [0m[34mMatch #[0m[33m312[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m256 | [0m[35m                             by hitting this url.[0m
[30;1m257 | [0m[35m            wait_for_server_ready: If true, wait for server to pass readiness[0m
[30;1m258 | [0m[35m              probe before returning.[0m
[30;1m259 | [0m[35m            network: docker network name.[0m
[30;1m260 | [0m[35m            container_name_prefix: optional docker container name prefix.[0m
[30;1m261 | [0m[35m[0m
[30;1m262 | [0m[35m        Returns:[0m

[31m--[ [0m[34mMatch #[0m[33m313[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m250 | [0m[35m            build_dir: Directory to use for creating docker build context.[0m
[30;1m251 | [0m[35m            tag: Tags to apply to docker image.[0m
[30;1m252 | [0m[35m            local_port: Local port to forward inference server to.[0m
[30;1m253 | [0m[35m            detach: Run docker container in detached mode.[0m
[30;1m254 | [0m[35m            patch_ping_url:  Mostly for testing, if supplied then a live[0m
[30;1m255 | [0m[35m                             reload capable truss queries for truss changes[0m
[30;1m256 | [0m[35m                             by hitting this url.[0m

[31m--[ [0m[34mMatch #[0m[33m314[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m248 | [0m[35m[0m
[30;1m249 | [0m[35m        Args:[0m
[30;1m250 | [0m[35m            build_dir: Directory to use for creating docker build context.[0m
[30;1m251 | [0m[35m            tag: Tags to apply to docker image.[0m
[30;1m252 | [0m[35m            local_port: Local port to forward inference server to.[0m
[30;1m253 | [0m[35m            detach: Run docker container in detached mode.[0m
[30;1m254 | [0m[35m            patch_ping_url:  Mostly for testing, if supplied then a live[0m

[31m--[ [0m[34mMatch #[0m[33m315[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m247 | [0m[35m        tries to patch.[0m
[30;1m248 | [0m[35m[0m
[30;1m249 | [0m[35m        Args:[0m
[30;1m250 | [0m[35m            build_dir: Directory to use for creating docker build context.[0m
[30;1m251 | [0m[35m            tag: Tags to apply to docker image.[0m
[30;1m252 | [0m[35m            local_port: Local port to forward inference server to.[0m
[30;1m253 | [0m[35m            detach: Run docker container in detached mode.[0m

[31m--[ [0m[34mMatch #[0m[33m316[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m243 | [0m[35m        disable_json_logging: bool = False,[0m
[30;1m244 | [0m[35m    ):[0m
[30;1m245 | [0m[35m        """[0m
[30;1m246 | [0m[35m        Builds a docker image and runs it as a container. For control trusses,[0m
[30;1m247 | [0m[35m        tries to patch.[0m
[30;1m248 | [0m[35m[0m
[30;1m249 | [0m[35m        Args:[0m

[31m--[ [0m[34mMatch #[0m[33m317[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m98 | [0m[35m        return docker.logs(self.container, follow=True, stream=True)[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m    def wait(self):[0m
[30;1m101 | [0m[35m        from python_on_whales import docker[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m        return docker.wait(self.container)[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m318[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_handle.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m93 | [0m[35m        self.container = container[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m    def logs(self):[0m
[30;1m96 | [0m[35m        from python_on_whales import docker[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m        return docker.logs(self.container, follow=True, stream=True)[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m    def wait(self):[0m

[31m--[ [0m[34mMatch #[0m[33m319[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/CONTRIBUTING.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m## Contributing[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mTruss was first created at [Baseten](https://baseten.co), but as an open and living project eagerly [0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mWe use GitHub features for project management on Truss:[0m
[30;1m6 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m320[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/patch/truss_dir_patch_applier.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m    def __call__(self, patches: List[Patch]):[0m
[30;1m45 | [0m[35m        # Apply model code patches immediately[0m
[30;1m46 | [0m[35m        # Aggregate config patches and apply at end[0m
[30;1m47 | [0m[35m        reqs = reqs_by_name(self._truss_config.requirements)[0m
[30;1m48 | [0m[35m        pkgs = system_packages_set(self._truss_config.system_packages)[0m
[30;1m49 | [0m[35m        new_config = self._truss_config[0m

[31m--[ [0m[34mMatch #[0m[33m321[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/contexts/local_loader/load_model_local.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m15 | [0m[35m    """Loads a Truss model locally.[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m    The loaded model can be used to make predictions for quick testing.[0m
[30;1m18 | [0m[35m    Runs in the current pip environment directly. Assumes all requirements and[0m
[30;1m19 | [0m[35m    system packages are already installed.[0m
[30;1m20 | [0m[35m    """[0m
[30;1m21 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m322[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/baseten/test_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mfrom truss.remote.baseten import service[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mdef test_model_invocation_url_prod():[0m
[30;1m5 | [0m[35m    url = service.URLConfig.invocation_url([0m

[31m--[ [0m[34mMatch #[0m[33m323[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/README.md.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m67 | [0m[35m```[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m### Adding pre/postprocessing code[0m
[30;1m70 | [0m[35mYou may find that you'd like to preprocess the inputs to your model or postprocess the outputs of yo[0m
[30;1m71 | [0m[35m1. Navigate to `model/{{ config.model_class_filename }}`. This is where your preprocessing/postproce[0m
[30;1m72 | [0m[35m2. Define a `preprocess` or `postprocess` function as such.[0m
[30;1m73 | [0m[35m```[0m

[31m--[ [0m[34mMatch #[0m[33m324[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/README.md.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m-X POST http://localhost:8080/v1/models/model:predict[0m
[30;1m41 | [0m[35m{% else %}[0m
[30;1m42 | [0m[35m    {%- for example in examples %}[0m
[30;1m43 | [0m[35m        {%- for second_key, second_value in example.input.items() %}[0m
[30;1m44 | [0m[35mcurl -H 'Content-Type: application/json' \[0m
[30;1m45 | [0m[35m-d '{{ second_value[0] }}' \[0m
[30;1m46 | [0m[35m-X POST http://localhost:8080/v1/models/model:predict[0m
[30;1m47 | [0m[35m        {%- endfor %}[0m

[31m--[ [0m[34mMatch #[0m[33m325[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/README.md.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m34 | [0m[35m#### Via CURL[0m
[30;1m35 | [0m[35mIn order to run inference via CURL, we assume you've built and run the Docker image generated from y[0m
[30;1m36 | [0m[35m```[0m
[30;1m37 | [0m[35m{%- if examples == None %}[0m
[30;1m38 | [0m[35mcurl -H 'Content-Type: application/json' \[0m
[30;1m39 | [0m[35m-d 'YOUR_INPUT' \[0m
[30;1m40 | [0m[35m-X POST http://localhost:8080/v1/models/model:predict[0m
[30;1m41 | [0m[35m{% else %}[0m

[31m--[ [0m[34mMatch #[0m[33m326[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/README.md.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m32 | [0m[35m```[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m#### Via CURL[0m
[30;1m35 | [0m[35mIn order to run inference via CURL, we assume you've built and run the Docker image generated from y[0m
[30;1m36 | [0m[35m```[0m
[30;1m37 | [0m[35m{%- if examples == None %}[0m
[30;1m38 | [0m[35mcurl -H 'Content-Type: application/json' \[0m

[31m--[ [0m[34mMatch #[0m[33m327[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/README.md.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35m{%- endif %}[0m
[30;1m32 | [0m[35m```[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m#### Via CURL[0m
[30;1m35 | [0m[35mIn order to run inference via CURL, we assume you've built and run the Docker image generated from y[0m
[30;1m36 | [0m[35m```[0m
[30;1m37 | [0m[35m{%- if examples == None %}[0m
[30;1m38 | [0m[35mcurl -H 'Content-Type: application/json' \[0m

[31m--[ [0m[34mMatch #[0m[33m328[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/README.md.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35mtruss build-image[0m
[30;1m11 | [0m[35m```[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m### Run the Docker image from your Truss[0m
[30;1m14 | [0m[35m```[0m
[30;1m15 | [0m[35m# We assume you've built the image first.[0m
[30;1m16 | [0m[35mtruss run-image[0m

[31m--[ [0m[34mMatch #[0m[33m329[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/README.md.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35m{% endif %}[0m
[30;1m6 | [0m[35mWelcome to your {{ config.model_framework.value }} model's Truss. Below are some useful commands to [0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m### Build a Docker image from your Truss[0m
[30;1m9 | [0m[35m```[0m
[30;1m10 | [0m[35mtruss build-image[0m
[30;1m11 | [0m[35m```[0m

[31m--[ [0m[34mMatch #[0m[33m330[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/README.md.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35m{% else %}[0m
[30;1m4 | [0m[35m# {{ config.model_name }} how-to[0m
[30;1m5 | [0m[35m{% endif %}[0m
[30;1m6 | [0m[35mWelcome to your {{ config.model_framework.value }} model's Truss. Below are some useful commands to [0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m### Build a Docker image from your Truss[0m
[30;1m9 | [0m[35m```[0m

[31m--[ [0m[34mMatch #[0m[33m331[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35mThe pipeline model relies on [Transformers](https://huggingface.co/docs/transformers/index) and [PyT[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35mIn `config.yaml`, find the line `requirements`. Replace the empty list with:[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m```yaml[0m
[30;1m85 | [0m[35mrequirements:[0m

[31m--[ [0m[34mMatch #[0m[33m332[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35mThere are two member functions that you must implement in the `Model` class:[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m* `load()` loads the model onto the model server. It runs exactly once when the model server is spun[0m
[30;1m57 | [0m[35m* `predict()` handles model inference. It runs every time the model server is called.[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35mHere's the complete `model/model.py` for the text classification model:[0m
[30;1m60 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m333[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35mInstall Truss with:[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m```[0m
[30;1m27 | [0m[35mpip install --upgrade truss[0m
[30;1m28 | [0m[35m```[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m## Quickstart[0m

[31m--[ [0m[34mMatch #[0m[33m334[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35m## Why Truss?[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m* **Write once, run anywhere:** Package and test model code, weights, and dependencies with a model [0m
[30;1m11 | [0m[35m* **Fast developer loop:** Implement your model with fast feedback from a live reload server, and sk[0m
[30;1m12 | [0m[35m* **Support for all Python frameworks**: From `transformers` and `diffusers` to `PyTorch` and `Tenso[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mSee Trusses for popular models including:[0m

[31m--[ [0m[34mMatch #[0m[33m335[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/cache.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35mRUN apt-get -y update; apt-get -y install curl; curl -s https://baseten-public.s3.us-west-2.amazonaw[0m
[30;1m11 | [0m[35mENV B10CP_PATH_TRUSS="/app/b10cp"[0m
[30;1m12 | [0m[35mCOPY ./cache_requirements.txt /app/cache_requirements.txt[0m
[30;1m13 | [0m[35mRUN pip install -r /app/cache_requirements.txt --no-cache-dir && rm -rf /root/.cache/pip[0m
[30;1m14 | [0m[35mCOPY ./cache_warmer.py /cache_warmer.py[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m{% for credential in credentials_to_cache  %}[0m

[31m--[ [0m[34mMatch #[0m[33m336[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/cache.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mENV HUGGING_FACE_HUB_TOKEN="{{hf_access_token}}"[0m
[30;1m8 | [0m[35m{% endif %}[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mRUN apt-get -y update; apt-get -y install curl; curl -s https://baseten-public.s3.us-west-2.amazonaw[0m
[30;1m11 | [0m[35mENV B10CP_PATH_TRUSS="/app/b10cp"[0m
[30;1m12 | [0m[35mCOPY ./cache_requirements.txt /app/cache_requirements.txt[0m
[30;1m13 | [0m[35mRUN pip install -r /app/cache_requirements.txt --no-cache-dir && rm -rf /root/.cache/pip[0m
[30;1m14 | [0m[35mCOPY ./cache_warmer.py /cache_warmer.py[0m

[31m--[ [0m[34mMatch #[0m[33m337[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/cache.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mENV HUGGING_FACE_HUB_TOKEN="{{hf_access_token}}"[0m
[30;1m8 | [0m[35m{% endif %}[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mRUN apt-get -y update; apt-get -y install curl; curl -s https://baseten-public.s3.us-west-2.amazonaw[0m
[30;1m11 | [0m[35mENV B10CP_PATH_TRUSS="/app/b10cp"[0m
[30;1m12 | [0m[35mCOPY ./cache_requirements.txt /app/cache_requirements.txt[0m
[30;1m13 | [0m[35mRUN pip install -r /app/cache_requirements.txt --no-cache-dir && rm -rf /root/.cache/pip[0m

[31m--[ [0m[34mMatch #[0m[33m338[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/cache.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mENV HUGGING_FACE_HUB_TOKEN="{{hf_access_token}}"[0m
[30;1m8 | [0m[35m{% endif %}[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mRUN apt-get -y update; apt-get -y install curl; curl -s https://baseten-public.s3.us-west-2.amazonaw[0m
[30;1m11 | [0m[35mENV B10CP_PATH_TRUSS="/app/b10cp"[0m
[30;1m12 | [0m[35mCOPY ./cache_requirements.txt /app/cache_requirements.txt[0m
[30;1m13 | [0m[35mRUN pip install -r /app/cache_requirements.txt --no-cache-dir && rm -rf /root/.cache/pip[0m

[31m--[ [0m[34mMatch #[0m[33m339[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/cache.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mENV HUGGING_FACE_HUB_TOKEN="{{hf_access_token}}"[0m
[30;1m8 | [0m[35m{% endif %}[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mRUN apt-get -y update; apt-get -y install curl; curl -s https://baseten-public.s3.us-west-2.amazonaw[0m
[30;1m11 | [0m[35mENV B10CP_PATH_TRUSS="/app/b10cp"[0m
[30;1m12 | [0m[35mCOPY ./cache_requirements.txt /app/cache_requirements.txt[0m
[30;1m13 | [0m[35mRUN pip install -r /app/cache_requirements.txt --no-cache-dir && rm -rf /root/.cache/pip[0m

[31m--[ [0m[34mMatch #[0m[33m340[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/cache.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mENV HUGGING_FACE_HUB_TOKEN="{{hf_access_token}}"[0m
[30;1m8 | [0m[35m{% endif %}[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mRUN apt-get -y update; apt-get -y install curl; curl -s https://baseten-public.s3.us-west-2.amazonaw[0m
[30;1m11 | [0m[35mENV B10CP_PATH_TRUSS="/app/b10cp"[0m
[30;1m12 | [0m[35mCOPY ./cache_requirements.txt /app/cache_requirements.txt[0m
[30;1m13 | [0m[35mRUN pip install -r /app/cache_requirements.txt --no-cache-dir && rm -rf /root/.cache/pip[0m

[31m--[ [0m[34mMatch #[0m[33m341[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/cache.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mRUN mkdir -p /app/model_cache[0m
[30;1m4 | [0m[35mWORKDIR /app[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m{% if hf_access_token %}[0m
[30;1m7 | [0m[35mENV HUGGING_FACE_HUB_TOKEN="{{hf_access_token}}"[0m
[30;1m8 | [0m[35m{% endif %}[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mRUN apt-get -y update; apt-get -y install curl; curl -s https://baseten-public.s3.us-west-2.amazonaw[0m

[31m--[ [0m[34mMatch #[0m[33m342[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/api/definitions.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35m        Waits for the deployment to be active.[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m        Args:[0m
[30;1m26 | [0m[35m            timeout_seconds: The maximum time to wait for the deployment to be active.[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m        Returns:[0m
[30;1m29 | [0m[35m            The status of the deployment.[0m

[31m--[ [0m[34mMatch #[0m[33m343[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/api/definitions.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35m    def __init__(self, service: service.BasetenService):[0m
[30;1m17 | [0m[35m        self.model_id = service._model_id[0m
[30;1m18 | [0m[35m        self.model_deployment_id = service._model_version_id[0m
[30;1m19 | [0m[35m        self._baseten_service = service[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m    def wait_for_active(self, timeout_seconds: int = 600) -> bool:[0m
[30;1m22 | [0m[35m        """[0m
[30;1m23 | [0m[35m        Waits for the deployment to be active.[0m

[31m--[ [0m[34mMatch #[0m[33m344[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/api/definitions.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport pydantic[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mfrom truss.remote.baseten import service[0m
[30;1m6 | [0m[35mfrom truss.remote.baseten.core import ACTIVE_STATUS, DEPLOYING_STATUSES[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mclass ModelDeployment:[0m

[31m--[ [0m[34mMatch #[0m[33m345[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/api/definitions.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport pydantic[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mfrom truss.remote.baseten import service[0m

[31m--[ [0m[34mMatch #[0m[33m346[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/public_api.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m83 | [0m[35m    options = definitions.RPCOptions([0m
[30;1m84 | [0m[35m        retries=retries, timeout_sec=timeout_sec, use_binary=use_binary[0m
[30;1m85 | [0m[35m    )[0m
[30;1m86 | [0m[35m    # The type error is silenced to because chains framework will at runtime inject[0m
[30;1m87 | [0m[35m    # a corresponding instance. Nonetheless, we want to use a type annotation here,[0m
[30;1m88 | [0m[35m    # to facilitate type inference, code-completion and type checking within the code[0m
[30;1m89 | [0m[35m    # of chainlets that depend on the other chainlet.[0m

[31m--[ [0m[34mMatch #[0m[33m347[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/public_api.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    """[0m
[30;1m38 | [0m[35m    # The type error is silenced to because chains framework will at runtime inject[0m
[30;1m39 | [0m[35m    # a corresponding instance. Nonetheless, we want to use a type annotation here,[0m
[30;1m40 | [0m[35m    # to facilitate type inference, code-completion and type checking within the code[0m
[30;1m41 | [0m[35m    # of chainlets that depend on the other chainlet.[0m

[31m--[ [0m[34mMatch #[0m[33m348[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/public_api.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35mdef depends_context() -> definitions.DeploymentContext:[0m
[30;1m21 | [0m[35m    """Sets a "symbolic marker" for injecting a context object at runtime.[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    Refer to `the docs <https://docs.baseten.co/chains/getting-started>`_ and this[0m
[30;1m24 | [0m[35m    `example chainlet <https://github.com/basetenlabs/truss/blob/main/truss-chains/truss_chains/exam[0m

[31m--[ [0m[34mMatch #[0m[33m349[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/public_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m194 | [0m[35m    Args:[0m
[30;1m195 | [0m[35m        secrets: A dict of secrets keys and values to provide to the chainlets.[0m
[30;1m196 | [0m[35m        data_dir: Path to a directory with data files.[0m
[30;1m197 | [0m[35m        chainlet_to_service: A dict of chainlet names to service descriptors.[0m
[30;1m198 | [0m[35m[0m
[30;1m199 | [0m[35m    Example usage (as trailing main section in a chain file)::[0m
[30;1m200 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m350[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/public_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m176 | [0m[35m    assert isinstance([0m
[30;1m177 | [0m[35m        service, deployment_client.BasetenChainService[0m
[30;1m178 | [0m[35m    )  # Per options above.[0m
[30;1m179 | [0m[35m    return service[0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35m[0m
[30;1m182 | [0m[35mdef run_local([0m
[30;1m183 | [0m[35m    secrets: Optional[Mapping[str, str]] = None,[0m

[31m--[ [0m[34mMatch #[0m[33m351[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/public_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m172 | [0m[35m        remote=remote,[0m
[30;1m173 | [0m[35m        environment=environment,[0m
[30;1m174 | [0m[35m    )[0m
[30;1m175 | [0m[35m    service = deployment_client.push(entrypoint, options, progress_bar=progress_bar)[0m
[30;1m176 | [0m[35m    assert isinstance([0m
[30;1m177 | [0m[35m        service, deployment_client.BasetenChainService[0m
[30;1m178 | [0m[35m    )  # Per options above.[0m

[31m--[ [0m[34mMatch #[0m[33m352[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/public_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m161 | [0m[35m        progress_bar: Optional `rich.progress.Progress` if output is desired.[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m    Returns:[0m
[30;1m164 | [0m[35m        A chain service handle to the deployed chain.[0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35m    """[0m
[30;1m167 | [0m[35m    options = definitions.PushOptionsBaseten.create([0m

[31m--[ [0m[34mMatch #[0m[33m353[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/public_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m70 | [0m[35m          (e.g. due to transient network issues). For streaming, retries are only made[0m
[30;1m71 | [0m[35m          if the request fails before streaming any results back. Failures mid-stream[0m
[30;1m72 | [0m[35m          not retried.[0m
[30;1m73 | [0m[35m        timeout_sec: Timeout for the HTTP request to this chainlet.[0m
[30;1m74 | [0m[35m        use_binary: Whether to send data in binary format. This can give a parsing[0m
[30;1m75 | [0m[35m         speedup and message size reduction (~25%) for numpy arrays. Use[0m
[30;1m76 | [0m[35m         ``NumpyArrayField`` as a field type on pydantic models for integration and set[0m

[31m--[ [0m[34mMatch #[0m[33m354[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000703[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Username[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/cli/cli.py[0m
   Pattern: [32m.userInfo[0m
[30;1m364 | [0m[35m    if not remote:[0m
[30;1m365 | [0m[35m        remote = inquire_remote_name(RemoteFactory.get_available_config_names())[0m
[30;1m366 | [0m[35m[0m
[30;1m367 | [0m[35m    user = whoami(remote)[0m
[30;1m368 | [0m[35m[0m
[30;1m369 | [0m[35m    console.print(f"{user.workspace_name}\{user.user_email}")[0m
[30;1m370 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m355[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000703[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Username[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/cli/cli.py[0m
   Pattern: [32m.userInfo[0m
[30;1m359 | [0m[35m    """[0m
[30;1m360 | [0m[35m    Shows user information and exit.[0m
[30;1m361 | [0m[35m    """[0m
[30;1m362 | [0m[35m    from truss.api import whoami[0m
[30;1m363 | [0m[35m[0m
[30;1m364 | [0m[35m    if not remote:[0m
[30;1m365 | [0m[35m        remote = inquire_remote_name(RemoteFactory.get_available_config_names())[0m

[31m--[ [0m[34mMatch #[0m[33m356[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000703[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Username[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/cli/cli.py[0m
   Pattern: [32m.userInfo[0m
[30;1m355 | [0m[35m    help="Name of the remote in .trussrc to check whoami.",[0m
[30;1m356 | [0m[35m)[0m
[30;1m357 | [0m[35m@error_handling[0m
[30;1m358 | [0m[35mdef whoami(remote: Optional[str]):[0m
[30;1m359 | [0m[35m    """[0m
[30;1m360 | [0m[35m    Shows user information and exit.[0m
[30;1m361 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m357[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000703[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Username[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/cli/cli.py[0m
   Pattern: [32m.userInfo[0m
[30;1m352 | [0m[35m    "--remote",[0m
[30;1m353 | [0m[35m    type=str,[0m
[30;1m354 | [0m[35m    required=False,[0m
[30;1m355 | [0m[35m    help="Name of the remote in .trussrc to check whoami.",[0m
[30;1m356 | [0m[35m)[0m
[30;1m357 | [0m[35m@error_handling[0m
[30;1m358 | [0m[35mdef whoami(remote: Optional[str]):[0m

[31m--[ [0m[34mMatch #[0m[33m358[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/cli/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1239 | [0m[35m        console.print(promotion_text, style="green")[0m
[30;1m1240 | [0m[35m[0m
[30;1m1241 | [0m[35m    console.print([0m
[30;1m1242 | [0m[35m        f"🪵  View logs for your deployment at {_format_link(service.logs_url)}"[0m
[30;1m1243 | [0m[35m    )[0m
[30;1m1244 | [0m[35m    if wait:[0m
[30;1m1245 | [0m[35m        start_time = time.time()[0m

[31m--[ [0m[34mMatch #[0m[33m359[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/cli/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1196 | [0m[35m                fp8_and_num_builder_gpus_text = ([0m
[30;1m1197 | [0m[35m                    "Warning: build specifies FP8 quantization but does not explicitly specify numbe[0m
[30;1m1198 | [0m[35m                    "GPU memory required at build time may be significantly more than that required [0m
[30;1m1199 | [0m[35m                    "`num_builder_gpus` can be used to specify the number of GPUs to use at build ti[0m
[30;1m1200 | [0m[35m                )[0m
[30;1m1201 | [0m[35m                console.print(fp8_and_num_builder_gpus_text, style="yellow")[0m
[30;1m1202 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m360[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/cli/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1195 | [0m[35m            ):[0m
[30;1m1196 | [0m[35m                fp8_and_num_builder_gpus_text = ([0m
[30;1m1197 | [0m[35m                    "Warning: build specifies FP8 quantization but does not explicitly specify numbe[0m
[30;1m1198 | [0m[35m                    "GPU memory required at build time may be significantly more than that required [0m
[30;1m1199 | [0m[35m                    "`num_builder_gpus` can be used to specify the number of GPUs to use at build ti[0m
[30;1m1200 | [0m[35m                )[0m
[30;1m1201 | [0m[35m                console.print(fp8_and_num_builder_gpus_text, style="yellow")[0m

[31m--[ [0m[34mMatch #[0m[33m361[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/cli/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1195 | [0m[35m            ):[0m
[30;1m1196 | [0m[35m                fp8_and_num_builder_gpus_text = ([0m
[30;1m1197 | [0m[35m                    "Warning: build specifies FP8 quantization but does not explicitly specify numbe[0m
[30;1m1198 | [0m[35m                    "GPU memory required at build time may be significantly more than that required [0m
[30;1m1199 | [0m[35m                    "`num_builder_gpus` can be used to specify the number of GPUs to use at build ti[0m
[30;1m1200 | [0m[35m                )[0m
[30;1m1201 | [0m[35m                console.print(fp8_and_num_builder_gpus_text, style="yellow")[0m

[31m--[ [0m[34mMatch #[0m[33m362[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/cli/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m402 | [0m[35m[0m
[30;1m403 | [0m[35m    service = remote_provider.get_service(model_identifier=ModelName(model_name))[0m
[30;1m404 | [0m[35m    console.print([0m
[30;1m405 | [0m[35m        f"🪵  View logs for your deployment at {_format_link(service.logs_url)}"[0m
[30;1m406 | [0m[35m    )[0m
[30;1m407 | [0m[35m[0m
[30;1m408 | [0m[35m    if not os.path.isfile(target_directory):[0m

[31m--[ [0m[34mMatch #[0m[33m363[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/cli/cli.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m315 | [0m[35m    urls = tr.get_urls_from_truss()[0m
[30;1m316 | [0m[35m    if urls:[0m
[30;1m317 | [0m[35m        click.confirm([0m
[30;1m318 | [0m[35m            f"Container already exists at {urls}. Are you sure you want to continue?"[0m
[30;1m319 | [0m[35m        )[0m
[30;1m320 | [0m[35m    if use_host_network:[0m
[30;1m321 | [0m[35m        tr.docker_run([0m

[31m--[ [0m[34mMatch #[0m[33m364[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/cli/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1333 | [0m[35m    Clean up truss data.[0m
[30;1m1334 | [0m[35m[0m
[30;1m1335 | [0m[35m    Truss creates temporary directories for various operations[0m
[30;1m1336 | [0m[35m    such as for building docker images. This command clears[0m
[30;1m1337 | [0m[35m    that data to free up disk space.[0m
[30;1m1338 | [0m[35m    """[0m
[30;1m1339 | [0m[35m    _cleanup()[0m

[31m--[ [0m[34mMatch #[0m[33m365[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/cli/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1201 | [0m[35m                console.print(fp8_and_num_builder_gpus_text, style="yellow")[0m
[30;1m1202 | [0m[35m[0m
[30;1m1203 | [0m[35m    # TODO(Abu): This needs to be refactored to be more generic[0m
[30;1m1204 | [0m[35m    service = remote_provider.push([0m
[30;1m1205 | [0m[35m        tr,[0m
[30;1m1206 | [0m[35m        model_name=model_name,[0m
[30;1m1207 | [0m[35m        publish=publish,[0m

[31m--[ [0m[34mMatch #[0m[33m366[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/cli/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1195 | [0m[35m            ):[0m
[30;1m1196 | [0m[35m                fp8_and_num_builder_gpus_text = ([0m
[30;1m1197 | [0m[35m                    "Warning: build specifies FP8 quantization but does not explicitly specify numbe[0m
[30;1m1198 | [0m[35m                    "GPU memory required at build time may be significantly more than that required [0m
[30;1m1199 | [0m[35m                    "`num_builder_gpus` can be used to specify the number of GPUs to use at build ti[0m
[30;1m1200 | [0m[35m                )[0m
[30;1m1201 | [0m[35m                console.print(fp8_and_num_builder_gpus_text, style="yellow")[0m

[31m--[ [0m[34mMatch #[0m[33m367[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/cli/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1195 | [0m[35m            ):[0m
[30;1m1196 | [0m[35m                fp8_and_num_builder_gpus_text = ([0m
[30;1m1197 | [0m[35m                    "Warning: build specifies FP8 quantization but does not explicitly specify numbe[0m
[30;1m1198 | [0m[35m                    "GPU memory required at build time may be significantly more than that required [0m
[30;1m1199 | [0m[35m                    "`num_builder_gpus` can be used to specify the number of GPUs to use at build ti[0m
[30;1m1200 | [0m[35m                )[0m
[30;1m1201 | [0m[35m                console.print(fp8_and_num_builder_gpus_text, style="yellow")[0m

[31m--[ [0m[34mMatch #[0m[33m368[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/cli/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1116 | [0m[35m    type=int,[0m
[30;1m1117 | [0m[35m    required=False,[0m
[30;1m1118 | [0m[35m    help=([0m
[30;1m1119 | [0m[35m        "Maximum time to wait for deployment to complete in seconds. Without "[0m
[30;1m1120 | [0m[35m        "specifying, the command will not complete until the deployment is complete."[0m
[30;1m1121 | [0m[35m    ),[0m
[30;1m1122 | [0m[35m)[0m

[31m--[ [0m[34mMatch #[0m[33m369[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/cli/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m972 | [0m[35m[0m
[30;1m973 | [0m[35m    request_data = _extract_request_data(data=data, file=file)[0m
[30;1m974 | [0m[35m[0m
[30;1m975 | [0m[35m    service = remote_provider.get_service([0m
[30;1m976 | [0m[35m        model_identifier=model_identifier, published=published[0m
[30;1m977 | [0m[35m    )[0m
[30;1m978 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m370[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/cli/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m645 | [0m[35m            remote=remote,[0m
[30;1m646 | [0m[35m            environment=environment,[0m
[30;1m647 | [0m[35m        )[0m
[30;1m648 | [0m[35m        service = deployment_client.push([0m
[30;1m649 | [0m[35m            entrypoint_cls, options, progress_bar=progress.Progress[0m
[30;1m650 | [0m[35m        )[0m
[30;1m651 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m371[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/cli/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m610 | [0m[35m    from truss_chains.deployment import deployment_client[0m
[30;1m611 | [0m[35m[0m
[30;1m612 | [0m[35m    if experimental_watch_chainlet_names:[0m
[30;1m613 | [0m[35m        watch = True[0m
[30;1m614 | [0m[35m[0m
[30;1m615 | [0m[35m    if watch:[0m
[30;1m616 | [0m[35m        if publish or promote:[0m

[31m--[ [0m[34mMatch #[0m[33m372[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/cli/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m553 | [0m[35m    help=([0m
[30;1m554 | [0m[35m        "Watches the chains source code and applies live patches. Using this option "[0m
[30;1m555 | [0m[35m        "will wait for the chain to be deployed (i.e. `--wait` flag is applied), "[0m
[30;1m556 | [0m[35m        "before starting to watch for changes. This option required the deployment "[0m
[30;1m557 | [0m[35m        "to be a development deployment (i.e. `--no-promote` and `--no-publish`."[0m
[30;1m558 | [0m[35m    ),[0m
[30;1m559 | [0m[35m)[0m

[31m--[ [0m[34mMatch #[0m[33m373[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/cli/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m400 | [0m[35m        )[0m
[30;1m401 | [0m[35m        sys.exit(1)[0m
[30;1m402 | [0m[35m[0m
[30;1m403 | [0m[35m    service = remote_provider.get_service(model_identifier=ModelName(model_name))[0m
[30;1m404 | [0m[35m    console.print([0m
[30;1m405 | [0m[35m        f"🪵  View logs for your deployment at {_format_link(service.logs_url)}"[0m
[30;1m406 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m374[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/cli/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m303 | [0m[35m    target_directory: str, build_dir: Path, tag, port, attach, use_host_network[0m
[30;1m304 | [0m[35m) -> None:[0m
[30;1m305 | [0m[35m    """[0m
[30;1m306 | [0m[35m    Runs the docker image for a Truss.[0m
[30;1m307 | [0m[35m[0m
[30;1m308 | [0m[35m    TARGET_DIRECTORY: A Truss directory. If none, use current directory.[0m
[30;1m309 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m375[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/cli/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m295 | [0m[35m    "--use_host_network",[0m
[30;1m296 | [0m[35m    is_flag=True,[0m
[30;1m297 | [0m[35m    default=False,[0m
[30;1m298 | [0m[35m    help="Use host network for docker build",[0m
[30;1m299 | [0m[35m)[0m
[30;1m300 | [0m[35m@log_level_option[0m
[30;1m301 | [0m[35m@error_handling[0m

[31m--[ [0m[34mMatch #[0m[33m376[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/cli/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m268 | [0m[35m@error_handling[0m
[30;1m269 | [0m[35mdef build(target_directory: str, build_dir: Path, tag, use_host_network) -> None:[0m
[30;1m270 | [0m[35m    """[0m
[30;1m271 | [0m[35m    Builds the docker image for a Truss.[0m
[30;1m272 | [0m[35m[0m
[30;1m273 | [0m[35m    TARGET_DIRECTORY: A Truss directory. If none, use current directory.[0m
[30;1m274 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m377[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/cli/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m262 | [0m[35m    "--use_host_network",[0m
[30;1m263 | [0m[35m    is_flag=True,[0m
[30;1m264 | [0m[35m    default=False,[0m
[30;1m265 | [0m[35m    help="Use host network for docker build",[0m
[30;1m266 | [0m[35m)[0m
[30;1m267 | [0m[35m@log_level_option[0m
[30;1m268 | [0m[35m@error_handling[0m

[31m--[ [0m[34mMatch #[0m[33m378[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/cli/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m244 | [0m[35m@error_handling[0m
[30;1m245 | [0m[35mdef build_context(build_dir, target_directory: str) -> None:[0m
[30;1m246 | [0m[35m    """[0m
[30;1m247 | [0m[35m    Create a docker build context for a Truss.[0m
[30;1m248 | [0m[35m[0m
[30;1m249 | [0m[35m    BUILD_DIR: Folder where image context is built for Truss[0m
[30;1m250 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m379[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/cli/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m51 | [0m[35mfrom truss.truss_handle.build import cleanup as _cleanup[0m
[30;1m52 | [0m[35mfrom truss.truss_handle.build import init_directory as _init[0m
[30;1m53 | [0m[35mfrom truss.truss_handle.build import load[0m
[30;1m54 | [0m[35mfrom truss.util import docker[0m
[30;1m55 | [0m[35mfrom truss.util.log_utils import LogInterceptor[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35mrich.spinner.SPINNERS["deploying"] = {"interval": 500, "frames": ["👾 ", " 👾"]}[0m
[30;1m58 | [0m[35mrich.spinner.SPINNERS["building"] = {"interval": 500, "frames": ["🛠️ ", " 🛠️"]}[0m

[31m--[ [0m[34mMatch #[0m[33m380[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/cli/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mimport logging[0m
[30;1m4 | [0m[35mimport os[0m
[30;1m5 | [0m[35mimport sys[0m
[30;1m6 | [0m[35mimport time[0m
[30;1m7 | [0m[35mimport warnings[0m
[30;1m8 | [0m[35mfrom functools import wraps[0m
[30;1m9 | [0m[35mfrom pathlib import Path[0m
[30;1m10 | [0m[35mfrom typing import Callable, List, Optional, Tuple, Union[0m

[31m--[ [0m[34mMatch #[0m[33m381[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/trt_llm_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m264 | [0m[35m                        {[0m
[30;1m265 | [0m[35m                            k: v[0m
[30;1m266 | [0m[35m                            for k, v in extra_runtime_fields.items()[0m
[30;1m267 | [0m[35m                            if k not in data.get("runtime")[0m
[30;1m268 | [0m[35m                        }[0m
[30;1m269 | [0m[35m                    )[0m
[30;1m270 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m382[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/trt_llm_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m260 | [0m[35m                    " This configuration of deprecated fields is scheduled for removal, please upgra[0m
[30;1m261 | [0m[35m                )[0m
[30;1m262 | [0m[35m                if data.get("runtime"):[0m
[30;1m263 | [0m[35m                    data.get("runtime").update([0m
[30;1m264 | [0m[35m                        {[0m
[30;1m265 | [0m[35m                            k: v[0m
[30;1m266 | [0m[35m                            for k, v in extra_runtime_fields.items()[0m

[31m--[ [0m[34mMatch #[0m[33m383[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/trt_llm_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m259 | [0m[35m                    f"Found extra fields {list(extra_runtime_fields.keys())} in build configuration,[0m
[30;1m260 | [0m[35m                    " This configuration of deprecated fields is scheduled for removal, please upgra[0m
[30;1m261 | [0m[35m                )[0m
[30;1m262 | [0m[35m                if data.get("runtime"):[0m
[30;1m263 | [0m[35m                    data.get("runtime").update([0m
[30;1m264 | [0m[35m                        {[0m
[30;1m265 | [0m[35m                            k: v[0m

[31m--[ [0m[34mMatch #[0m[33m384[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/trt_llm_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m247 | [0m[35m        extra_runtime_fields = {}[0m
[30;1m248 | [0m[35m        valid_build_fields = {}[0m
[30;1m249 | [0m[35m        if isinstance(data.get("build"), dict):[0m
[30;1m250 | [0m[35m            for key, value in data.get("build").items():[0m
[30;1m251 | [0m[35m                if key in TrussTRTLLMBuildConfiguration.__annotations__:[0m
[30;1m252 | [0m[35m                    valid_build_fields[key] = value[0m
[30;1m253 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m385[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/trt_llm_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m246 | [0m[35m    def migrate_runtime_fields(cls, data: Any) -> Any:[0m
[30;1m247 | [0m[35m        extra_runtime_fields = {}[0m
[30;1m248 | [0m[35m        valid_build_fields = {}[0m
[30;1m249 | [0m[35m        if isinstance(data.get("build"), dict):[0m
[30;1m250 | [0m[35m            for key, value in data.get("build").items():[0m
[30;1m251 | [0m[35m                if key in TrussTRTLLMBuildConfiguration.__annotations__:[0m
[30;1m252 | [0m[35m                    valid_build_fields[key] = value[0m

[31m--[ [0m[34mMatch #[0m[33m386[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/trt_llm_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m18 | [0m[35mwarnings.filterwarnings("ignore", category=PydanticDeprecatedSince20)[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35mENGINE_BUILDER_TRUSS_RUNTIME_MIGRATION = ([0m
[30;1m21 | [0m[35m    os.environ.get("ENGINE_BUILDER_TRUSS_RUNTIME_MIGRATION", "False") == "True"[0m
[30;1m22 | [0m[35m)[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m387[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/trt_llm_config.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m257 | [0m[35m            if extra_runtime_fields:[0m
[30;1m258 | [0m[35m                logger.warning([0m
[30;1m259 | [0m[35m                    f"Found extra fields {list(extra_runtime_fields.keys())} in build configuration,[0m
[30;1m260 | [0m[35m                    " This configuration of deprecated fields is scheduled for removal, please upgra[0m
[30;1m261 | [0m[35m                )[0m
[30;1m262 | [0m[35m                if data.get("runtime"):[0m
[30;1m263 | [0m[35m                    data.get("runtime").update([0m

[31m--[ [0m[34mMatch #[0m[33m388[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/contexts/image_builder/serving_image_builder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m660 | [0m[35m            MIN_SUPPORTED_PYTHON_VERSION_IN_CUSTOM_BASE_IMAGE.split(".")[0][0m
[30;1m661 | [0m[35m        )[0m
[30;1m662 | [0m[35m[0m
[30;1m663 | [0m[35m        hf_access_token = config.secrets.get(constants.HF_ACCESS_TOKEN_KEY)[0m
[30;1m664 | [0m[35m        dockerfile_contents = dockerfile_template.render([0m
[30;1m665 | [0m[35m            should_install_server_requirements=should_install_server_requirements,[0m
[30;1m666 | [0m[35m            base_image_name_and_tag=base_image_name_and_tag,[0m

[31m--[ [0m[34mMatch #[0m[33m389[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/contexts/image_builder/serving_image_builder.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m529 | [0m[35m            BUILD_SERVER_DIR_NAME + "/" + SHARED_SERVING_AND_TRAINING_CODE_DIR_NAME,[0m
[30;1m530 | [0m[35m        )[0m
[30;1m531 | [0m[35m[0m
[30;1m532 | [0m[35m        # Copy control server code[0m
[30;1m533 | [0m[35m        if config.live_reload:[0m
[30;1m534 | [0m[35m            self._copy_into_build_dir([0m
[30;1m535 | [0m[35m                CONTROL_SERVER_CODE_DIR, build_dir, BUILD_CONTROL_SERVER_DIR_NAME[0m

[31m--[ [0m[34mMatch #[0m[33m390[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/contexts/image_builder/serving_image_builder.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m432 | [0m[35m            "prepare_trtllm_decoder_build_dir should only be called for decoder tensorrt-llm model"[0m
[30;1m433 | [0m[35m        )[0m
[30;1m434 | [0m[35m[0m
[30;1m435 | [0m[35m        # trt_llm is treated as an extension at model run time.[0m
[30;1m436 | [0m[35m        self._copy_into_build_dir([0m
[30;1m437 | [0m[35m            TRTLLM_TRUSS_DIR / "src",[0m
[30;1m438 | [0m[35m            build_dir,[0m

[31m--[ [0m[34mMatch #[0m[33m391[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/contexts/image_builder/serving_image_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m568 | [0m[35m            base_server_requirements = f.read()[0m
[30;1m569 | [0m[35m[0m
[30;1m570 | [0m[35m        if config.docker_server:[0m
[30;1m571 | [0m[35m            # when docker server is enabled, no need to install truss requirements[0m
[30;1m572 | [0m[35m            # only install user-provided python requirements[0m
[30;1m573 | [0m[35m            user_provided_python_requirements = spec.requirements_txt[0m
[30;1m574 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m392[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/contexts/image_builder/serving_image_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m463 | [0m[35m        self, build_dir: Optional[Path] = None, use_hf_secret: bool = False[0m
[30;1m464 | [0m[35m    ):[0m
[30;1m465 | [0m[35m        """[0m
[30;1m466 | [0m[35m        Prepare a directory for building the docker image from.[0m
[30;1m467 | [0m[35m        """[0m
[30;1m468 | [0m[35m        truss_dir = self._truss_dir[0m
[30;1m469 | [0m[35m        spec = self._spec[0m

[31m--[ [0m[34mMatch #[0m[33m393[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/contexts/image_builder/serving_image_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m442 | [0m[35m        # supplied code in bundled packages can conflict with those from[0m
[30;1m443 | [0m[35m        # the trtllm extension. We don't want to put this in the build[0m
[30;1m444 | [0m[35m        # directory directly either because of chances of conflict there[0m
[30;1m445 | [0m[35m        # as well and the noise it can create there. We need to find a[0m
[30;1m446 | [0m[35m        # new place that's made available in model's pythonpath. This is[0m
[30;1m447 | [0m[35m        # a bigger lift and feels overkill right now. Worth revisiting[0m
[30;1m448 | [0m[35m        # if we come across cases of actual conflicts.[0m

[31m--[ [0m[34mMatch #[0m[33m394[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/helpers/truss_patch/requirement_name_identifier.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m16 | [0m[35m    if is_url_based_requirement(req):[0m
[30;1m17 | [0m[35m        parsed_url = urlparse(req)[0m
[30;1m18 | [0m[35m        fragments = parse_qs(parsed_url.fragment)[0m
[30;1m19 | [0m[35m        return fragments.get("egg", None)[0m
[30;1m20 | [0m[35m    return None[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m395[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/server.Dockerfile[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m15 | [0m[35mENV DEBIAN_FRONTEND="noninteractive"[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mRUN apt update && \[0m
[30;1m18 | [0m[35m    apt install -y bash \[0m
[30;1m19 | [0m[35m                build-essential \[0m
[30;1m20 | [0m[35m                git \[0m
[30;1m21 | [0m[35m                curl \[0m

[31m--[ [0m[34mMatch #[0m[33m396[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/server.Dockerfile[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m14 | [0m[35mENV PYTHONUNBUFFERED="True"[0m
[30;1m15 | [0m[35mENV DEBIAN_FRONTEND="noninteractive"[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mRUN apt update && \[0m
[30;1m18 | [0m[35m    apt install -y bash \[0m
[30;1m19 | [0m[35m                build-essential \[0m
[30;1m20 | [0m[35m                git \[0m

[31m--[ [0m[34mMatch #[0m[33m397[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/server.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35mCOPY ./packages /packages[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35mENV INFERENCE_SERVER_PORT="8080"[0m
[30;1m47 | [0m[35mENV SERVER_START_CMD="/usr/local/bin/python3 /app/main.py"[0m
[30;1m48 | [0m[35mENTRYPOINT ["/usr/local/bin/python3", "/app/main.py"][0m

[31m--[ [0m[34mMatch #[0m[33m398[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/server.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35mCOPY ./model /app/model[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35mCOPY ./packages /packages[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35mENV INFERENCE_SERVER_PORT="8080"[0m
[30;1m49 | [0m[35mENV SERVER_START_CMD="/usr/local/bin/python3 /app/main.py"[0m
[30;1m50 | [0m[35mENTRYPOINT ["/usr/local/bin/python3", "/app/main.py"][0m

[31m--[ [0m[34mMatch #[0m[33m399[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/server.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35mCOPY ./requirements.txt requirements.txt[0m
[30;1m32 | [0m[35mRUN cat requirements.txt[0m
[30;1m33 | [0m[35mRUN pip install -r requirements.txt --no-cache-dir && rm -rf /root/.cache/pip[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35mENV APP_HOME="/app"[0m
[30;1m36 | [0m[35mWORKDIR $APP_HOME[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m# Copy data before code for better caching[0m

[31m--[ [0m[34mMatch #[0m[33m400[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/server.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35mCOPY ./requirements.txt requirements.txt[0m
[30;1m32 | [0m[35mRUN cat requirements.txt[0m
[30;1m33 | [0m[35mRUN pip install -r requirements.txt --no-cache-dir && rm -rf /root/.cache/pip[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35mENV APP_HOME="/app"[0m
[30;1m36 | [0m[35mWORKDIR $APP_HOME[0m

[31m--[ [0m[34mMatch #[0m[33m401[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/server.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35mRUN pip install -r base_server_requirements.txt --no-cache-dir && rm -rf /root/.cache/pip[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35mCOPY ./requirements.txt requirements.txt[0m
[30;1m32 | [0m[35mRUN cat requirements.txt[0m
[30;1m33 | [0m[35mRUN pip install -r requirements.txt --no-cache-dir && rm -rf /root/.cache/pip[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35mENV APP_HOME="/app"[0m

[31m--[ [0m[34mMatch #[0m[33m402[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/server.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m26 | [0m[35m    && rm -rf /var/lib/apt/lists/*[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35mCOPY ./base_server_requirements.txt base_server_requirements.txt[0m
[30;1m29 | [0m[35mRUN pip install -r base_server_requirements.txt --no-cache-dir && rm -rf /root/.cache/pip[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35mCOPY ./requirements.txt requirements.txt[0m
[30;1m32 | [0m[35mRUN cat requirements.txt[0m

[31m--[ [0m[34mMatch #[0m[33m403[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/server.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m                ca-certificates \[0m
[30;1m23 | [0m[35m                software-properties-common \[0m
[30;1m24 | [0m[35m    && apt-get autoremove -y \[0m
[30;1m25 | [0m[35m    && apt-get clean -y \[0m
[30;1m26 | [0m[35m    && rm -rf /var/lib/apt/lists/*[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35mCOPY ./base_server_requirements.txt base_server_requirements.txt[0m

[31m--[ [0m[34mMatch #[0m[33m404[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/server.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m                curl \[0m
[30;1m22 | [0m[35m                ca-certificates \[0m
[30;1m23 | [0m[35m                software-properties-common \[0m
[30;1m24 | [0m[35m    && apt-get autoremove -y \[0m
[30;1m25 | [0m[35m    && apt-get clean -y \[0m
[30;1m26 | [0m[35m    && rm -rf /var/lib/apt/lists/*[0m
[30;1m27 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m405[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/server.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m    apt install -y bash \[0m
[30;1m19 | [0m[35m                build-essential \[0m
[30;1m20 | [0m[35m                git \[0m
[30;1m21 | [0m[35m                curl \[0m
[30;1m22 | [0m[35m                ca-certificates \[0m
[30;1m23 | [0m[35m                software-properties-common \[0m
[30;1m24 | [0m[35m    && apt-get autoremove -y \[0m

[31m--[ [0m[34mMatch #[0m[33m406[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/server.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m17 | [0m[35mRUN apt update && \[0m
[30;1m18 | [0m[35m    apt install -y bash \[0m
[30;1m19 | [0m[35m                build-essential \[0m
[30;1m20 | [0m[35m                git \[0m
[30;1m21 | [0m[35m                curl \[0m
[30;1m22 | [0m[35m                ca-certificates \[0m
[30;1m23 | [0m[35m                software-properties-common \[0m

[31m--[ [0m[34mMatch #[0m[33m407[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/server.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m15 | [0m[35mENV DEBIAN_FRONTEND="noninteractive"[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mRUN apt update && \[0m
[30;1m18 | [0m[35m    apt install -y bash \[0m
[30;1m19 | [0m[35m                build-essential \[0m
[30;1m20 | [0m[35m                git \[0m
[30;1m21 | [0m[35m                curl \[0m

[31m--[ [0m[34mMatch #[0m[33m408[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/server.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m15 | [0m[35mENV DEBIAN_FRONTEND="noninteractive"[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mRUN apt update && \[0m
[30;1m18 | [0m[35m    apt install -y bash \[0m
[30;1m19 | [0m[35m                build-essential \[0m
[30;1m20 | [0m[35m                git \[0m
[30;1m21 | [0m[35m                curl \[0m

[31m--[ [0m[34mMatch #[0m[33m409[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/server.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14 | [0m[35mENV PYTHONUNBUFFERED="True"[0m
[30;1m15 | [0m[35mENV DEBIAN_FRONTEND="noninteractive"[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mRUN apt update && \[0m
[30;1m18 | [0m[35m    apt install -y bash \[0m
[30;1m19 | [0m[35m                build-essential \[0m
[30;1m20 | [0m[35m                git \[0m

[31m--[ [0m[34mMatch #[0m[33m410[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/server.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35m    && rm -rf /root/.cache/pip[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m# If user base image is supplied in config, apply build commands from truss base image[0m
[30;1m14 | [0m[35mENV PYTHONUNBUFFERED="True"[0m
[30;1m15 | [0m[35mENV DEBIAN_FRONTEND="noninteractive"[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mRUN apt update && \[0m
[30;1m18 | [0m[35m    apt install -y bash \[0m

[31m--[ [0m[34mMatch #[0m[33m411[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/server.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35mRUN pip install --upgrade pip --no-cache-dir \[0m
[30;1m11 | [0m[35m    && rm -rf /root/.cache/pip[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m# If user base image is supplied in config, apply build commands from truss base image[0m
[30;1m14 | [0m[35mENV PYTHONUNBUFFERED="True"[0m
[30;1m15 | [0m[35mENV DEBIAN_FRONTEND="noninteractive"[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mRUN apt update && \[0m

[31m--[ [0m[34mMatch #[0m[33m412[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/server.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mRUN $PYTHON_EXECUTABLE -c "import sys; sys.exit(0) if sys.version_info.major == 3 and sys.version_in[0m
[30;1m8 | [0m[35m    || { echo "ERROR: Supplied base image does not have 3.8 <= python <= 3.12"; exit 1; }[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mRUN pip install --upgrade pip --no-cache-dir \[0m
[30;1m11 | [0m[35m    && rm -rf /root/.cache/pip[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m# If user base image is supplied in config, apply build commands from truss base image[0m

[31m--[ [0m[34mMatch #[0m[33m413[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/server.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mRUN $PYTHON_EXECUTABLE -c "import sys; sys.exit(0) if sys.version_info.major == 3 and sys.version_in[0m
[30;1m8 | [0m[35m    || { echo "ERROR: Supplied base image does not have 3.8 <= python <= 3.12"; exit 1; }[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mRUN pip install --upgrade pip --no-cache-dir \[0m
[30;1m11 | [0m[35m    && rm -rf /root/.cache/pip[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m# If user base image is supplied in config, apply build commands from truss base image[0m

[31m--[ [0m[34mMatch #[0m[33m414[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/server.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mENV PYTHON_EXECUTABLE="/usr/local/bin/python3"[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mRUN grep -w 'ID=debian\|ID_LIKE=debian' /etc/os-release || { echo "ERROR: Supplied base image is not[0m
[30;1m7 | [0m[35mRUN $PYTHON_EXECUTABLE -c "import sys; sys.exit(0) if sys.version_info.major == 3 and sys.version_in[0m
[30;1m8 | [0m[35m    || { echo "ERROR: Supplied base image does not have 3.8 <= python <= 3.12"; exit 1; }[0m
[30;1m9 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m415[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/server.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mARG PYVERSION=py39[0m
[30;1m2 | [0m[35mFROM baseten/truss-server-base:3.9-v0.4.3 AS truss_server[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mENV PYTHON_EXECUTABLE="/usr/local/bin/python3"[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mRUN grep -w 'ID=debian\|ID_LIKE=debian' /etc/os-release || { echo "ERROR: Supplied base image is not[0m
[30;1m7 | [0m[35mRUN $PYTHON_EXECUTABLE -c "import sys; sys.exit(0) if sys.version_info.major == 3 and sys.version_in[0m

[31m--[ [0m[34mMatch #[0m[33m416[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server/common/patches/whisper/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m39 | [0m[35m    with urllib.request.urlopen(url) as source, open(download_target, "wb") as output:[0m
[30;1m40 | [0m[35m        with tqdm([0m
[30;1m41 | [0m[35m            total=int(source.info().get("Content-Length"))[0m
[30;1m42 | [0m[35m            if source.info().get("Content-Length") is not None[0m
[30;1m43 | [0m[35m            else None,[0m
[30;1m44 | [0m[35m            ncols=80,[0m
[30;1m45 | [0m[35m            unit="iB",[0m

[31m--[ [0m[34mMatch #[0m[33m417[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server/common/patches/whisper/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m    with urllib.request.urlopen(url) as source, open(download_target, "wb") as output:[0m
[30;1m40 | [0m[35m        with tqdm([0m
[30;1m41 | [0m[35m            total=int(source.info().get("Content-Length"))[0m
[30;1m42 | [0m[35m            if source.info().get("Content-Length") is not None[0m
[30;1m43 | [0m[35m            else None,[0m
[30;1m44 | [0m[35m            ncols=80,[0m

[31m--[ [0m[34mMatch #[0m[33m418[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/control/control/helpers/test_model_container_patch_applier.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35mimport pytest[0m
[30;1m7 | [0m[35mfrom truss.base.truss_config import TrussConfig[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m# Needed to simulate the set up on the model docker container[0m
[30;1m10 | [0m[35msys.path.append([0m
[30;1m11 | [0m[35m    str([0m
[30;1m12 | [0m[35m        Path(__file__).parent.parent.parent.parent.parent.parent[0m

[31m--[ [0m[34mMatch #[0m[33m419[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/context_builder.Dockerfile[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m4 | [0m[35m# docker buildx build . -f context_builder.Dockerfile --platform=linux/amd64 -t baseten/truss-contex[0m
[30;1m5 | [0m[35mFROM python:3.9-slim[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mRUN apt-get update \[0m
[30;1m8 | [0m[35m    && apt-get install --yes --no-install-recommends curl tar \[0m
[30;1m9 | [0m[35m    && apt-get autoremove -y \[0m
[30;1m10 | [0m[35m    && apt-get clean -y \[0m

[31m--[ [0m[34mMatch #[0m[33m420[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/context_builder.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35m    && rm -rf /var/lib/apt/lists/* /tmp/library-scripts/[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mRUN curl -sSL https://install.python-poetry.org | python -[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mENV PATH="/root/.local/bin:${PATH}"[0m
[30;1m18 | [0m[35mCOPY ./truss ./truss[0m
[30;1m19 | [0m[35m# Chains source code is not actually needed (and deps from chains group won't be[0m
[30;1m20 | [0m[35m# installed when using `--only builder`). But nonetheless poetry fails the install[0m

[31m--[ [0m[34mMatch #[0m[33m421[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/context_builder.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35m    && apt-get clean -y \[0m
[30;1m11 | [0m[35m    && rm -rf /var/lib/apt/lists/* /tmp/library-scripts/[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mRUN curl -sSL https://install.python-poetry.org | python -[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mENV PATH="/root/.local/bin:${PATH}"[0m
[30;1m16 | [0m[35mCOPY ./truss ./truss[0m

[31m--[ [0m[34mMatch #[0m[33m422[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/context_builder.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mRUN apt-get update \[0m
[30;1m8 | [0m[35m    && apt-get install --yes --no-install-recommends curl tar \[0m
[30;1m9 | [0m[35m    && apt-get autoremove -y \[0m
[30;1m10 | [0m[35m    && apt-get clean -y \[0m
[30;1m11 | [0m[35m    && rm -rf /var/lib/apt/lists/* /tmp/library-scripts/[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mRUN curl -sSL https://install.python-poetry.org | python -[0m

[31m--[ [0m[34mMatch #[0m[33m423[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/context_builder.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mRUN apt-get update \[0m
[30;1m8 | [0m[35m    && apt-get install --yes --no-install-recommends curl tar \[0m
[30;1m9 | [0m[35m    && apt-get autoremove -y \[0m
[30;1m10 | [0m[35m    && apt-get clean -y \[0m
[30;1m11 | [0m[35m    && rm -rf /var/lib/apt/lists/* /tmp/library-scripts/[0m
[30;1m12 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m424[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/context_builder.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35mFROM python:3.9-slim[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mRUN apt-get update \[0m
[30;1m8 | [0m[35m    && apt-get install --yes --no-install-recommends curl tar \[0m
[30;1m9 | [0m[35m    && apt-get autoremove -y \[0m
[30;1m10 | [0m[35m    && apt-get clean -y \[0m
[30;1m11 | [0m[35m    && rm -rf /var/lib/apt/lists/* /tmp/library-scripts/[0m

[31m--[ [0m[34mMatch #[0m[33m425[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/context_builder.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35mFROM python:3.9-slim[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mRUN apt-get update \[0m
[30;1m8 | [0m[35m    && apt-get install --yes --no-install-recommends curl tar \[0m
[30;1m9 | [0m[35m    && apt-get autoremove -y \[0m
[30;1m10 | [0m[35m    && apt-get clean -y \[0m
[30;1m11 | [0m[35m    && rm -rf /var/lib/apt/lists/* /tmp/library-scripts/[0m

[31m--[ [0m[34mMatch #[0m[33m426[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/context_builder.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m# docker buildx build . -f context_builder.Dockerfile --platform=linux/amd64 -t baseten/truss-contex[0m
[30;1m5 | [0m[35mFROM python:3.9-slim[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mRUN apt-get update \[0m
[30;1m8 | [0m[35m    && apt-get install --yes --no-install-recommends curl tar \[0m
[30;1m9 | [0m[35m    && apt-get autoremove -y \[0m
[30;1m10 | [0m[35m    && apt-get clean -y \[0m

[31m--[ [0m[34mMatch #[0m[33m427[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/context_builder.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# Builds baseten/truss-context-builder, a light-weight image that can be used[0m
[30;1m2 | [0m[35m# for creating docker build context out of a Truss.[0m
[30;1m3 | [0m[35m# Build that image as:[0m
[30;1m4 | [0m[35m# docker buildx build . -f context_builder.Dockerfile --platform=linux/amd64 -t baseten/truss-contex[0m
[30;1m5 | [0m[35mFROM python:3.9-slim[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mRUN apt-get update \[0m

[31m--[ [0m[34mMatch #[0m[33m428[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/context_builder.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# Builds baseten/truss-context-builder, a light-weight image that can be used[0m
[30;1m2 | [0m[35m# for creating docker build context out of a Truss.[0m
[30;1m3 | [0m[35m# Build that image as:[0m
[30;1m4 | [0m[35m# docker buildx build . -f context_builder.Dockerfile --platform=linux/amd64 -t baseten/truss-contex[0m
[30;1m5 | [0m[35mFROM python:3.9-slim[0m

[31m--[ [0m[34mMatch #[0m[33m429[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/helpers/inference_server_process_controller.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport logging[0m
[30;1m2 | [0m[35mimport subprocess[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mfrom pathlib import Path[0m
[30;1m5 | [0m[35mfrom typing import List, Optional[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mfrom helpers.context_managers import current_directory[0m

[31m--[ [0m[34mMatch #[0m[33m430[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m446 | [0m[35m        assert response.json() == {"generated_text": "value"}[0m
[30;1m447 | [0m[35m        assert response.status_code == 200[0m
[30;1m448 | [0m[35m[0m
[30;1m449 | [0m[35m        schema_response = requests.get(SCHEMA_URL)[0m
[30;1m450 | [0m[35m[0m
[30;1m451 | [0m[35m        schema = schema_response.json()[0m
[30;1m452 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m431[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m439 | [0m[35m        tr = TrussHandle(truss_dir)[0m
[30;1m440 | [0m[35m        _ = tr.docker_run(local_port=8090, detach=True, wait_for_server_ready=True)[0m
[30;1m441 | [0m[35m[0m
[30;1m442 | [0m[35m        response = requests.post([0m
[30;1m443 | [0m[35m            INFERENCE_URL, json={"prompt": "value", "stream": False}[0m
[30;1m444 | [0m[35m        )[0m
[30;1m445 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m432[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m384 | [0m[35m        assert response.status_code == 200[0m
[30;1m385 | [0m[35m        assert response.content == b"01"[0m
[30;1m386 | [0m[35m[0m
[30;1m387 | [0m[35m        schema_response = requests.get(SCHEMA_URL)[0m
[30;1m388 | [0m[35m[0m
[30;1m389 | [0m[35m        schema = schema_response.json()[0m
[30;1m390 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m433[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m377 | [0m[35m        assert response.json() == {"generated_text": "value"}[0m
[30;1m378 | [0m[35m        assert response.status_code == 200[0m
[30;1m379 | [0m[35m[0m
[30;1m380 | [0m[35m        response = requests.post([0m
[30;1m381 | [0m[35m            INFERENCE_URL, json={"prompt": "value", "stream": True}[0m
[30;1m382 | [0m[35m        )[0m
[30;1m383 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m434[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m370 | [0m[35m        tr = TrussHandle(truss_dir)[0m
[30;1m371 | [0m[35m        _ = tr.docker_run(local_port=8090, detach=True, wait_for_server_ready=True)[0m
[30;1m372 | [0m[35m[0m
[30;1m373 | [0m[35m        response = requests.post([0m
[30;1m374 | [0m[35m            INFERENCE_URL, json={"prompt": "value", "stream": False}[0m
[30;1m375 | [0m[35m        )[0m
[30;1m376 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m435[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m323 | [0m[35m[0m
[30;1m324 | [0m[35m        assert response.content == b"01"[0m
[30;1m325 | [0m[35m[0m
[30;1m326 | [0m[35m        schema_response = requests.get(SCHEMA_URL)[0m
[30;1m327 | [0m[35m[0m
[30;1m328 | [0m[35m        schema = schema_response.json()[0m
[30;1m329 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m436[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m319 | [0m[35m        tr = TrussHandle(truss_dir)[0m
[30;1m320 | [0m[35m        _ = tr.docker_run(local_port=8090, detach=True, wait_for_server_ready=True)[0m
[30;1m321 | [0m[35m[0m
[30;1m322 | [0m[35m        response = requests.post(INFERENCE_URL, json={"prompt": "value"})[0m
[30;1m323 | [0m[35m[0m
[30;1m324 | [0m[35m        assert response.content == b"01"[0m
[30;1m325 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m437[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m272 | [0m[35m[0m
[30;1m273 | [0m[35m        assert response.json() == {"generated_text": "value"}[0m
[30;1m274 | [0m[35m[0m
[30;1m275 | [0m[35m        schema_response = requests.get(SCHEMA_URL)[0m
[30;1m276 | [0m[35m[0m
[30;1m277 | [0m[35m        schema = schema_response.json()[0m
[30;1m278 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m438[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m268 | [0m[35m        tr = TrussHandle(truss_dir)[0m
[30;1m269 | [0m[35m        _ = tr.docker_run(local_port=8090, detach=True, wait_for_server_ready=True)[0m
[30;1m270 | [0m[35m[0m
[30;1m271 | [0m[35m        response = requests.post(INFERENCE_URL, json={"prompt": "value"})[0m
[30;1m272 | [0m[35m[0m
[30;1m273 | [0m[35m        assert response.json() == {"generated_text": "value"}[0m
[30;1m274 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m439[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m227 | [0m[35m[0m
[30;1m228 | [0m[35m        assert response.content == b"01"[0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35m        schema_response = requests.get(SCHEMA_URL)[0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35m        schema = schema_response.json()[0m
[30;1m233 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m440[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m223 | [0m[35m        tr = TrussHandle(truss_dir)[0m
[30;1m224 | [0m[35m        _ = tr.docker_run(local_port=8090, detach=True, wait_for_server_ready=True)[0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m        response = requests.post(INFERENCE_URL, json={"prompt": "value"})[0m
[30;1m227 | [0m[35m[0m
[30;1m228 | [0m[35m        assert response.content == b"01"[0m
[30;1m229 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m441[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m174 | [0m[35m[0m
[30;1m175 | [0m[35m        assert response.json() == {"generated_text": "value"}[0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m        schema_response = requests.get(SCHEMA_URL)[0m
[30;1m178 | [0m[35m[0m
[30;1m179 | [0m[35m        schema = schema_response.json()[0m
[30;1m180 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m442[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35m        tr = TrussHandle(truss_dir)[0m
[30;1m172 | [0m[35m        _ = tr.docker_run(local_port=8090, detach=True, wait_for_server_ready=True)[0m
[30;1m173 | [0m[35m        response = requests.post(INFERENCE_URL, json={"prompt": "value"})[0m
[30;1m174 | [0m[35m[0m
[30;1m175 | [0m[35m        assert response.json() == {"generated_text": "value"}[0m
[30;1m176 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m443[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m127 | [0m[35m        assert response.headers["x-baseten-error-code"] == "700"[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m        # Schema response.[0m
[30;1m130 | [0m[35m        schema_response = requests.get(SCHEMA_URL)[0m
[30;1m131 | [0m[35m        schema = schema_response.json()[0m
[30;1m132 | [0m[35m        assert schema["input_schema"] == {[0m
[30;1m133 | [0m[35m            "properties": {"prompt": {"title": "Prompt", "type": "string"}},[0m

[31m--[ [0m[34mMatch #[0m[33m444[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m116 | [0m[35m        assert response.content == b"\x81\xaegenerated_text\xa5value"[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m        # An invalid input[0m
[30;1m119 | [0m[35m        response = requests.post(INFERENCE_URL, json={"bad_key": "value"})[0m
[30;1m120 | [0m[35m        assert response.status_code == 400[0m
[30;1m121 | [0m[35m        assert "error" in response.json()[0m
[30;1m122 | [0m[35m        assert ([0m

[31m--[ [0m[34mMatch #[0m[33m445[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m108 | [0m[35m        # Valid binary input.[0m
[30;1m109 | [0m[35m        byte_input = serialization.truss_msgpack_serialize(json_input)[0m
[30;1m110 | [0m[35m        print(byte_input)[0m
[30;1m111 | [0m[35m        response = requests.post([0m
[30;1m112 | [0m[35m            INFERENCE_URL,[0m
[30;1m113 | [0m[35m            data=byte_input,[0m
[30;1m114 | [0m[35m            headers={"Content-Type": "application/octet-stream"},[0m

[31m--[ [0m[34mMatch #[0m[33m446[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m102 | [0m[35m        _ = tr.docker_run(local_port=8090, detach=True, wait_for_server_ready=True)[0m
[30;1m103 | [0m[35m        # Valid JSON input.[0m
[30;1m104 | [0m[35m        json_input = {"prompt": "value"}[0m
[30;1m105 | [0m[35m        response = requests.post(INFERENCE_URL, json=json_input)[0m
[30;1m106 | [0m[35m        assert response.json() == {"generated_text": "value"}[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35m        # Valid binary input.[0m

[31m--[ [0m[34mMatch #[0m[33m447[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m84 | [0m[35m        # Wait a bit for the server to start[0m
[30;1m85 | [0m[35m        time.sleep(2)[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m        schema_response = requests.get(SCHEMA_URL)[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m        # If the load has not successfully completed,[0m
[30;1m90 | [0m[35m        # we return a 503 instead of 404, so that clients[0m

[31m--[ [0m[34mMatch #[0m[33m448[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m        response = requests.post(INFERENCE_URL, json={"prompt": "value"})[0m
[30;1m56 | [0m[35m        assert response.json() == ["hello"][0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m        schema_response = requests.get(SCHEMA_URL)[0m
[30;1m59 | [0m[35m        assert schema_response.status_code == 404[0m
[30;1m60 | [0m[35m        assert schema_response.json()["error"] == "No schema found"[0m
[30;1m61 | [0m[35m        assert schema_response.headers["x-baseten-error-source"] == "04"[0m

[31m--[ [0m[34mMatch #[0m[33m449[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m52 | [0m[35m        tr = TrussHandle(truss_dir)[0m
[30;1m53 | [0m[35m        _ = tr.docker_run(local_port=8090, detach=True, wait_for_server_ready=True)[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m        response = requests.post(INFERENCE_URL, json={"prompt": "value"})[0m
[30;1m56 | [0m[35m        assert response.json() == ["hello"][0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m        schema_response = requests.get(SCHEMA_URL)[0m

[31m--[ [0m[34mMatch #[0m[33m450[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m        response = requests.post(INFERENCE_URL, json={"prompt": "value"})[0m
[30;1m29 | [0m[35m        assert response.json() == {"prompt": "value"}[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m        schema_response = requests.get(SCHEMA_URL)[0m
[30;1m32 | [0m[35m        assert schema_response.status_code == 404[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m        assert schema_response.json()["error"] == "No schema found"[0m

[31m--[ [0m[34mMatch #[0m[33m451[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m    with ensure_kill_all():[0m
[30;1m26 | [0m[35m        _ = tr.docker_run(local_port=8090, detach=True, wait_for_server_ready=True)[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m        response = requests.post(INFERENCE_URL, json={"prompt": "value"})[0m
[30;1m29 | [0m[35m        assert response.json() == {"prompt": "value"}[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m        schema_response = requests.get(SCHEMA_URL)[0m

[31m--[ [0m[34mMatch #[0m[33m452[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_model_schema.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport tempfile[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35mfrom pathlib import Path[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mimport pytest[0m
[30;1m6 | [0m[35mimport requests[0m

[31m--[ [0m[34mMatch #[0m[33m453[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_control_truss_patching.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m284 | [0m[35mclass Model:[0m
[30;1m285 | [0m[35m    def predict(self, model_input):[0m
[30;1m286 | [0m[35m        print(os.environ.copy())[0m
[30;1m287 | [0m[35m        return os.environ.get("foo", "No foo :(")[0m
[30;1m288 | [0m[35m"""[0m
[30;1m289 | [0m[35m        update_model_code(truss_dir, new_model_code)[0m
[30;1m290 | [0m[35m        result = th.docker_predict([1], tag=tag)[0m

[31m--[ [0m[34mMatch #[0m[33m454[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m283 | [0m[35m[0m
[30;1m284 | [0m[35m    assert new_config == config.to_dict(verbose=False)[0m
[30;1m285 | [0m[35m    assert config.to_dict(verbose=True)["model_cache"][0].get("revision") is None[0m
[30;1m286 | [0m[35m    assert config.to_dict(verbose=True)["model_cache"][1].get("revision") == "not-main2"[0m
[30;1m287 | [0m[35m[0m
[30;1m288 | [0m[35m[0m
[30;1m289 | [0m[35mdef test_empty_config(default_config):[0m

[31m--[ [0m[34mMatch #[0m[33m455[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m282 | [0m[35m    ][0m
[30;1m283 | [0m[35m[0m
[30;1m284 | [0m[35m    assert new_config == config.to_dict(verbose=False)[0m
[30;1m285 | [0m[35m    assert config.to_dict(verbose=True)["model_cache"][0].get("revision") is None[0m
[30;1m286 | [0m[35m    assert config.to_dict(verbose=True)["model_cache"][1].get("revision") == "not-main2"[0m
[30;1m287 | [0m[35m[0m
[30;1m288 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m456[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m263 | [0m[35m[0m
[30;1m264 | [0m[35m    assert new_config == config.to_dict(verbose=False)[0m
[30;1m265 | [0m[35m    assert config.to_dict(verbose=True)["model_cache"][0].get("revision") == "main"[0m
[30;1m266 | [0m[35m    assert config.to_dict(verbose=True)["model_cache"][1].get("revision") is None[0m
[30;1m267 | [0m[35m[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35mdef test_huggingface_cache_multiple_models_mixed_revision(default_config):[0m

[31m--[ [0m[34mMatch #[0m[33m457[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m262 | [0m[35m    ][0m
[30;1m263 | [0m[35m[0m
[30;1m264 | [0m[35m    assert new_config == config.to_dict(verbose=False)[0m
[30;1m265 | [0m[35m    assert config.to_dict(verbose=True)["model_cache"][0].get("revision") == "main"[0m
[30;1m266 | [0m[35m    assert config.to_dict(verbose=True)["model_cache"][1].get("revision") is None[0m
[30;1m267 | [0m[35m[0m
[30;1m268 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m458[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m243 | [0m[35m        model_cache=ModelCache(models=[ModelRepo("test/model", "not-main")]),[0m
[30;1m244 | [0m[35m    )[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m    assert config.to_dict(verbose=False)["model_cache"][0].get("revision") == "not-main"[0m
[30;1m247 | [0m[35m[0m
[30;1m248 | [0m[35m[0m
[30;1m249 | [0m[35mdef test_huggingface_cache_multiple_models_default_revision(default_config):[0m

[31m--[ [0m[34mMatch #[0m[33m459[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m233 | [0m[35m    new_config["model_cache"] = [{"repo_id": "test/model"}][0m
[30;1m234 | [0m[35m[0m
[30;1m235 | [0m[35m    assert new_config == config.to_dict(verbose=False)[0m
[30;1m236 | [0m[35m    assert config.to_dict(verbose=True)["model_cache"][0].get("revision") is None[0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m[0m
[30;1m239 | [0m[35mdef test_huggingface_cache_single_model_non_default_revision():[0m

[31m--[ [0m[34mMatch #[0m[33m460[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_custom_server_truss/test_docker_image/build_upload_new_image.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mdocker buildx build --platform linux/amd64,linux/arm64 -f ./Dockerfile -t fastapi-test:$VERSION . ||[0m
[30;1m5 | [0m[35mdocker tag fastapi-test:$VERSION baseten/fastapi-test:$VERSION || { echo "Failed to tag the Docker i[0m
[30;1m6 | [0m[35mdocker push baseten/fastapi-test:$VERSION || { echo "Failed to push the Docker image."; exit 1; }[0m

[31m--[ [0m[34mMatch #[0m[33m461[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_custom_server_truss/test_docker_image/build_upload_new_image.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mVERSION=$(cat VERSION)[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mdocker buildx build --platform linux/amd64,linux/arm64 -f ./Dockerfile -t fastapi-test:$VERSION . ||[0m
[30;1m5 | [0m[35mdocker tag fastapi-test:$VERSION baseten/fastapi-test:$VERSION || { echo "Failed to tag the Docker i[0m
[30;1m6 | [0m[35mdocker push baseten/fastapi-test:$VERSION || { echo "Failed to push the Docker image."; exit 1; }[0m

[31m--[ [0m[34mMatch #[0m[33m462[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_custom_server_truss/test_docker_image/build_upload_new_image.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mVERSION=$(cat VERSION)[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mdocker buildx build --platform linux/amd64,linux/arm64 -f ./Dockerfile -t fastapi-test:$VERSION . ||[0m
[30;1m5 | [0m[35mdocker tag fastapi-test:$VERSION baseten/fastapi-test:$VERSION || { echo "Failed to tag the Docker i[0m
[30;1m6 | [0m[35mdocker push baseten/fastapi-test:$VERSION || { echo "Failed to push the Docker image."; exit 1; }[0m

[31m--[ [0m[34mMatch #[0m[33m463[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_custom_server_truss/test_docker_image/build_upload_new_image.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# Read the version from the VERSION file[0m
[30;1m2 | [0m[35mVERSION=$(cat VERSION)[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mdocker buildx build --platform linux/amd64,linux/arm64 -f ./Dockerfile -t fastapi-test:$VERSION . ||[0m
[30;1m5 | [0m[35mdocker tag fastapi-test:$VERSION baseten/fastapi-test:$VERSION || { echo "Failed to tag the Docker i[0m
[30;1m6 | [0m[35mdocker push baseten/fastapi-test:$VERSION || { echo "Failed to push the Docker image."; exit 1; }[0m

[31m--[ [0m[34mMatch #[0m[33m464[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_custom_server_truss/test_docker_image/build_upload_new_image.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# Read the version from the VERSION file[0m
[30;1m2 | [0m[35mVERSION=$(cat VERSION)[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mdocker buildx build --platform linux/amd64,linux/arm64 -f ./Dockerfile -t fastapi-test:$VERSION . ||[0m
[30;1m5 | [0m[35mdocker tag fastapi-test:$VERSION baseten/fastapi-test:$VERSION || { echo "Failed to tag the Docker i[0m
[30;1m6 | [0m[35mdocker push baseten/fastapi-test:$VERSION || { echo "Failed to push the Docker image."; exit 1; }[0m

[31m--[ [0m[34mMatch #[0m[33m465[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_custom_server_truss/test_docker_image/build_upload_new_image.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# Read the version from the VERSION file[0m
[30;1m2 | [0m[35mVERSION=$(cat VERSION)[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mdocker buildx build --platform linux/amd64,linux/arm64 -f ./Dockerfile -t fastapi-test:$VERSION . ||[0m
[30;1m5 | [0m[35mdocker tag fastapi-test:$VERSION baseten/fastapi-test:$VERSION || { echo "Failed to tag the Docker i[0m
[30;1m6 | [0m[35mdocker push baseten/fastapi-test:$VERSION || { echo "Failed to push the Docker image."; exit 1; }[0m

[31m--[ [0m[34mMatch #[0m[33m466[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/base.Dockerfile.jinja[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m28 | [0m[35m{% block install_system_requirements %}[0m
[30;1m29 | [0m[35m    {%- if should_install_system_requirements %}[0m
[30;1m30 | [0m[35mCOPY ./{{system_packages_filename}} {{system_packages_filename}}[0m
[30;1m31 | [0m[35mRUN apt-get update && apt-get install --yes --no-install-recommends $(cat {{system_packages_filename[0m
[30;1m32 | [0m[35m    && apt-get autoremove -y \[0m
[30;1m33 | [0m[35m    && apt-get clean -y \[0m
[30;1m34 | [0m[35m    && rm -rf /var/lib/apt/lists/*[0m

[31m--[ [0m[34mMatch #[0m[33m467[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/base.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m67 | [0m[35m{% endblock %}[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m{% for env_var_name, env_var_value in config.environment_variables.items() %}[0m
[30;1m71 | [0m[35mENV {{ env_var_name }}="{{ env_var_value }}"[0m
[30;1m72 | [0m[35m{% endfor %}[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m{% block run %}[0m

[31m--[ [0m[34mMatch #[0m[33m468[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/base.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m{%- if not config.docker_server %}[0m
[30;1m55 | [0m[35mENV APP_HOME="/app"[0m
[30;1m56 | [0m[35mWORKDIR $APP_HOME[0m
[30;1m57 | [0m[35m{%- endif %}[0m
[30;1m58 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m469[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/base.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m    {%- if should_install_requirements %}[0m
[30;1m46 | [0m[35mCOPY ./{{config_requirements_filename}} {{config_requirements_filename}}[0m
[30;1m47 | [0m[35mRUN cat {{config_requirements_filename}}[0m
[30;1m48 | [0m[35mRUN pip install -r {{config_requirements_filename}} --no-cache-dir && rm -rf /root/.cache/pip[0m
[30;1m49 | [0m[35m    {%- endif %}[0m
[30;1m50 | [0m[35m{% endblock %}[0m
[30;1m51 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m470[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/base.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35m    {%- endif %}[0m
[30;1m45 | [0m[35m    {%- if should_install_requirements %}[0m
[30;1m46 | [0m[35mCOPY ./{{config_requirements_filename}} {{config_requirements_filename}}[0m
[30;1m47 | [0m[35mRUN cat {{config_requirements_filename}}[0m
[30;1m48 | [0m[35mRUN pip install -r {{config_requirements_filename}} --no-cache-dir && rm -rf /root/.cache/pip[0m
[30;1m49 | [0m[35m    {%- endif %}[0m
[30;1m50 | [0m[35m{% endblock %}[0m

[31m--[ [0m[34mMatch #[0m[33m471[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/base.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m    {%- if should_install_user_requirements_file %}[0m
[30;1m41 | [0m[35mCOPY ./{{user_supplied_requirements_filename}} {{user_supplied_requirements_filename}}[0m
[30;1m42 | [0m[35mRUN cat {{user_supplied_requirements_filename}}[0m
[30;1m43 | [0m[35mRUN pip install -r {{user_supplied_requirements_filename}} --no-cache-dir && rm -rf /root/.cache/pip[0m
[30;1m44 | [0m[35m    {%- endif %}[0m
[30;1m45 | [0m[35m    {%- if should_install_requirements %}[0m
[30;1m46 | [0m[35mCOPY ./{{config_requirements_filename}} {{config_requirements_filename}}[0m

[31m--[ [0m[34mMatch #[0m[33m472[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/base.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35m{% block install_requirements %}[0m
[30;1m40 | [0m[35m    {%- if should_install_user_requirements_file %}[0m
[30;1m41 | [0m[35mCOPY ./{{user_supplied_requirements_filename}} {{user_supplied_requirements_filename}}[0m
[30;1m42 | [0m[35mRUN cat {{user_supplied_requirements_filename}}[0m
[30;1m43 | [0m[35mRUN pip install -r {{user_supplied_requirements_filename}} --no-cache-dir && rm -rf /root/.cache/pip[0m
[30;1m44 | [0m[35m    {%- endif %}[0m
[30;1m45 | [0m[35m    {%- if should_install_requirements %}[0m

[31m--[ [0m[34mMatch #[0m[33m473[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/base.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35mCOPY ./{{system_packages_filename}} {{system_packages_filename}}[0m
[30;1m31 | [0m[35mRUN apt-get update && apt-get install --yes --no-install-recommends $(cat {{system_packages_filename[0m
[30;1m32 | [0m[35m    && apt-get autoremove -y \[0m
[30;1m33 | [0m[35m    && apt-get clean -y \[0m
[30;1m34 | [0m[35m    && rm -rf /var/lib/apt/lists/*[0m
[30;1m35 | [0m[35m    {%- endif %}[0m
[30;1m36 | [0m[35m{% endblock %}[0m

[31m--[ [0m[34mMatch #[0m[33m474[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/base.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35m    {%- if should_install_system_requirements %}[0m
[30;1m30 | [0m[35mCOPY ./{{system_packages_filename}} {{system_packages_filename}}[0m
[30;1m31 | [0m[35mRUN apt-get update && apt-get install --yes --no-install-recommends $(cat {{system_packages_filename[0m
[30;1m32 | [0m[35m    && apt-get autoremove -y \[0m
[30;1m33 | [0m[35m    && apt-get clean -y \[0m
[30;1m34 | [0m[35m    && rm -rf /var/lib/apt/lists/*[0m
[30;1m35 | [0m[35m    {%- endif %}[0m

[31m--[ [0m[34mMatch #[0m[33m475[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/base.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m28 | [0m[35m{% block install_system_requirements %}[0m
[30;1m29 | [0m[35m    {%- if should_install_system_requirements %}[0m
[30;1m30 | [0m[35mCOPY ./{{system_packages_filename}} {{system_packages_filename}}[0m
[30;1m31 | [0m[35mRUN apt-get update && apt-get install --yes --no-install-recommends $(cat {{system_packages_filename[0m
[30;1m32 | [0m[35m    && apt-get autoremove -y \[0m
[30;1m33 | [0m[35m    && apt-get clean -y \[0m
[30;1m34 | [0m[35m    && rm -rf /var/lib/apt/lists/*[0m

[31m--[ [0m[34mMatch #[0m[33m476[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/base.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m28 | [0m[35m{% block install_system_requirements %}[0m
[30;1m29 | [0m[35m    {%- if should_install_system_requirements %}[0m
[30;1m30 | [0m[35mCOPY ./{{system_packages_filename}} {{system_packages_filename}}[0m
[30;1m31 | [0m[35mRUN apt-get update && apt-get install --yes --no-install-recommends $(cat {{system_packages_filename[0m
[30;1m32 | [0m[35m    && apt-get autoremove -y \[0m
[30;1m33 | [0m[35m    && apt-get clean -y \[0m
[30;1m34 | [0m[35m    && rm -rf /var/lib/apt/lists/*[0m

[31m--[ [0m[34mMatch #[0m[33m477[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/base.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m{% if config.model_framework.value == 'huggingface_transformer' %}[0m
[30;1m19 | [0m[35m    {% if config.resources.use_gpu %}[0m
[30;1m20 | [0m[35m# HuggingFace pytorch gpu support needs mkl[0m
[30;1m21 | [0m[35mRUN pip install mkl[0m
[30;1m22 | [0m[35m    {% endif %}[0m
[30;1m23 | [0m[35m{% endif%}[0m
[30;1m24 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m478[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/base.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35m    || { echo "ERROR: Supplied base image does not have {{min_supported_python_version_in_custom_bas[0m
[30;1m10 | [0m[35m{% endblock %}[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mRUN pip install --upgrade pip --no-cache-dir \[0m
[30;1m13 | [0m[35m    && rm -rf /root/.cache/pip[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m{% block base_image_patch %}[0m

[31m--[ [0m[34mMatch #[0m[33m479[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/base.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35m    || { echo "ERROR: Supplied base image does not have {{min_supported_python_version_in_custom_bas[0m
[30;1m10 | [0m[35m{% endblock %}[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mRUN pip install --upgrade pip --no-cache-dir \[0m
[30;1m13 | [0m[35m    && rm -rf /root/.cache/pip[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m{% block base_image_patch %}[0m

[31m--[ [0m[34mMatch #[0m[33m480[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/base.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mARG PYVERSION={{config.python_version}}[0m
[30;1m2 | [0m[35mFROM {{base_image_name_and_tag}} AS truss_server[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mENV PYTHON_EXECUTABLE="{{ config.base_image.python_executable_path or 'python3' }}"[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m{% block fail_fast %}[0m
[30;1m7 | [0m[35mRUN grep -w 'ID=debian\|ID_LIKE=debian' /etc/os-release || { echo "ERROR: Supplied base image is not[0m

[31m--[ [0m[34mMatch #[0m[33m481[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/base.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mARG PYVERSION={{config.python_version}}[0m
[30;1m2 | [0m[35mFROM {{base_image_name_and_tag}} AS truss_server[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mENV PYTHON_EXECUTABLE="{{ config.base_image.python_executable_path or 'python3' }}"[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m{% block fail_fast %}[0m
[30;1m7 | [0m[35mRUN grep -w 'ID=debian\|ID_LIKE=debian' /etc/os-release || { echo "ERROR: Supplied base image is not[0m

[31m--[ [0m[34mMatch #[0m[33m482[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/shared/lazy_data_resolver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m                    return[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m        # Streaming download to keep memory usage low[0m
[30;1m84 | [0m[35m        resp = requests.get([0m
[30;1m85 | [0m[35m            URL, allow_redirects=True, stream=True, timeout=BLOB_DOWNLOAD_TIMEOUT_SECS[0m
[30;1m86 | [0m[35m        )[0m
[30;1m87 | [0m[35m        resp.raise_for_status()[0m

[31m--[ [0m[34mMatch #[0m[33m483[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/shared/lazy_data_resolver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m        self._bptr_resolution: Dict[str, Tuple[str, str, int]] = _read_bptr_resolution()[0m
[30;1m62 | [0m[35m        self._resolution_done = False[0m
[30;1m63 | [0m[35m        self._uses_b10_cache = ([0m
[30;1m64 | [0m[35m            os.environ.get(BASETEN_FS_ENABLED_ENV_VAR, "False") == "True"[0m
[30;1m65 | [0m[35m        )[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m    def cached_download_from_url_using_requests([0m

[31m--[ [0m[34mMatch #[0m[33m484[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/shared/lazy_data_resolver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35mclass BasetenPointer(pydantic.BaseModel):[0m
[30;1m39 | [0m[35m    """Specification for lazy data resolution for download of large files, similar to Git LFS pointe[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m    resolution: Resolution[0m
[30;1m42 | [0m[35m    uid: str[0m

[31m--[ [0m[34mMatch #[0m[33m485[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/server_conformance_test_truss/model/model.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35mfrom typing import Any, Dict, List[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mclass Model:[0m

[31m--[ [0m[34mMatch #[0m[33m486[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_context_builder_image.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m        cwd=root,[0m
[30;1m41 | [0m[35m    )[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m    # This will throw if building docker build context fails[0m
[30;1m44 | [0m[35m    subprocess.run([0m
[30;1m45 | [0m[35m        ["docker", "run", "baseten/truss-context-builder-test"], check=True, cwd=root[0m
[30;1m46 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m487[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/gcs_fix/model/model.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35m* `load`: runs exactly once when the model server is spun up or patched and loads the[0m
[30;1m7 | [0m[35m   model onto the model server. Include any logic for initializing your model, such[0m
[30;1m8 | [0m[35m   as downloading model weights and loading the model into memory.[0m
[30;1m9 | [0m[35m* `predict`: runs every time the model server is called. Include any logic for model[0m
[30;1m10 | [0m[35m  inference and return the model output.[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mSee https://truss.baseten.co/quickstart for more.[0m

[31m--[ [0m[34mMatch #[0m[33m488[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/contexts/local_loader/truss_module_loader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m149 | [0m[35m[0m
[30;1m150 | [0m[35mdef _unload_top_level_module(module_name: str) -> None:[0m
[30;1m151 | [0m[35m    if "." in module_name:[0m
[30;1m152 | [0m[35m        raise ValueError(f"Expecting a top level module but found {module_name}")[0m
[30;1m153 | [0m[35m[0m
[30;1m154 | [0m[35m    truss_module_submodules = [[0m
[30;1m155 | [0m[35m        sys_module_name[0m

[31m--[ [0m[34mMatch #[0m[33m489[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/readme_int_example.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m```[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m### Adding pre/postprocessing code[0m
[30;1m43 | [0m[35mYou may find that you'd like to preprocess the inputs to your model or postprocess the outputs of yo[0m
[30;1m44 | [0m[35m1. Navigate to `model/model.py`. This is where your preprocessing/postprocessing logic will live.[0m
[30;1m45 | [0m[35m2. Define a `preprocess` or `postprocess` function as such.[0m
[30;1m46 | [0m[35m```[0m

[31m--[ [0m[34mMatch #[0m[33m490[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/readme_int_example.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m#### Via CURL[0m
[30;1m24 | [0m[35mIn order to run inference via CURL, we assume you've built and run the Docker image generated from y[0m
[30;1m25 | [0m[35m```[0m
[30;1m26 | [0m[35mcurl -H 'Content-Type: application/json' \[0m
[30;1m27 | [0m[35m-d '[0]' \[0m
[30;1m28 | [0m[35m-X POST http://localhost:8080/v1/models/model:predict[0m
[30;1m29 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m491[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/readme_int_example.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m```[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m#### Via CURL[0m
[30;1m24 | [0m[35mIn order to run inference via CURL, we assume you've built and run the Docker image generated from y[0m
[30;1m25 | [0m[35m```[0m
[30;1m26 | [0m[35mcurl -H 'Content-Type: application/json' \[0m
[30;1m27 | [0m[35m-d '[0]' \[0m

[31m--[ [0m[34mMatch #[0m[33m492[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/readme_int_example.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35mtruss predict --target_directory ./  --request '[0]'[0m
[30;1m21 | [0m[35m```[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m#### Via CURL[0m
[30;1m24 | [0m[35mIn order to run inference via CURL, we assume you've built and run the Docker image generated from y[0m
[30;1m25 | [0m[35m```[0m
[30;1m26 | [0m[35mcurl -H 'Content-Type: application/json' \[0m
[30;1m27 | [0m[35m-d '[0]' \[0m

[31m--[ [0m[34mMatch #[0m[33m493[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/readme_int_example.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mtruss build-image[0m
[30;1m8 | [0m[35m```[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m### Run the Docker image from your Truss[0m
[30;1m11 | [0m[35m```[0m
[30;1m12 | [0m[35m# We assume you've built the image first.[0m
[30;1m13 | [0m[35mtruss run-image[0m

[31m--[ [0m[34mMatch #[0m[33m494[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/readme_int_example.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mWelcome to your custom model's Truss. Below are some useful commands to work with this Truss. For al[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35m### Build a Docker image from your Truss[0m
[30;1m6 | [0m[35m```[0m
[30;1m7 | [0m[35mtruss build-image[0m
[30;1m8 | [0m[35m```[0m

[31m--[ [0m[34mMatch #[0m[33m495[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/readme_int_example.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# Model how-to[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mWelcome to your custom model's Truss. Below are some useful commands to work with this Truss. For al[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35m### Build a Docker image from your Truss[0m
[30;1m6 | [0m[35m```[0m

[31m--[ [0m[34mMatch #[0m[33m496[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/definitions.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m751 | [0m[35m    # on baseten, a real API key must be provided (i.e. the default must be overridden).[0m
[30;1m752 | [0m[35m    baseten_chain_api_key: str = "docker_dummy_key"[0m
[30;1m753 | [0m[35m    # If enabled, chains code is copied from the local package into `/app/truss_chains`[0m
[30;1m754 | [0m[35m    # in the docker image (which takes precedence over potential pip/site-packages).[0m
[30;1m755 | [0m[35m    # This should be used for integration tests or quick local dev loops.[0m
[30;1m756 | [0m[35m    use_local_chains_src: bool = False[0m

[31m--[ [0m[34mMatch #[0m[33m497[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/definitions.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m747 | [0m[35mclass PushOptionsLocalDocker(PushOptions):[0m
[30;1m748 | [0m[35m    # Local docker-to-docker requests don't need auth, but we need to set a[0m
[30;1m749 | [0m[35m    # value different from `SECRET_DUMMY` to not trigger the check that the secret[0m
[30;1m750 | [0m[35m    # is unset. Additionally, if local docker containers make calls to models deployed[0m
[30;1m751 | [0m[35m    # on baseten, a real API key must be provided (i.e. the default must be overridden).[0m
[30;1m752 | [0m[35m    baseten_chain_api_key: str = "docker_dummy_key"[0m
[30;1m753 | [0m[35m    # If enabled, chains code is copied from the local package into `/app/truss_chains`[0m

[31m--[ [0m[34mMatch #[0m[33m498[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/definitions.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m462 | [0m[35m    Args:[0m
[30;1m463 | [0m[35m        data_dir: The directory where the chainlet can store and access data,[0m
[30;1m464 | [0m[35m          e.g. for downloading model weights.[0m
[30;1m465 | [0m[35m        chainlet_to_service: A mapping from chainlet names to service descriptors.[0m
[30;1m466 | [0m[35m          This is used to create RPC sessions to dependency chainlets. It contains only[0m
[30;1m467 | [0m[35m          the chainlet services that are dependencies of the current chainlet.[0m
[30;1m468 | [0m[35m        secrets: A mapping from secret names to secret values. It contains only the[0m

[31m--[ [0m[34mMatch #[0m[33m499[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/definitions.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m416 | [0m[35m          (e.g. due to transient network issues). For streaming, retries are only made[0m
[30;1m417 | [0m[35m          if the request fails before streaming any results back. Failures mid-stream[0m
[30;1m418 | [0m[35m          not retried.[0m
[30;1m419 | [0m[35m        timeout_sec: Timeout for the HTTP request to this chainlet.[0m
[30;1m420 | [0m[35m        use_binary: Whether to send data in binary format. This can give a parsing[0m
[30;1m421 | [0m[35m         speedup and message size reduction (~25%) for numpy arrays. Use[0m
[30;1m422 | [0m[35m         ``NumpyArrayField`` as a field type on pydantic models for integration and set[0m

[31m--[ [0m[34mMatch #[0m[33m500[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/definitions.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m206 | [0m[35mclass ComputeSpec(pydantic.BaseModel):[0m
[30;1m207 | [0m[35m    """Parsed and validated compute.  See ``Compute`` for more information."""[0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m    # TODO[rcano] add node count[0m
[30;1m210 | [0m[35m    cpu_count: int = 1[0m
[30;1m211 | [0m[35m    predict_concurrency: int = 1[0m
[30;1m212 | [0m[35m    memory: str = "2Gi"[0m

[31m--[ [0m[34mMatch #[0m[33m501[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/definitions.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m180 | [0m[35m          accessible to the remote chainlet at runtime.[0m
[30;1m181 | [0m[35m        external_package_dirs: A list of directories containing additional python[0m
[30;1m182 | [0m[35m          packages outside the chain's workspace dir, e.g. a shared library. This code[0m
[30;1m183 | [0m[35m          is copied into the docker image and importable at runtime.[0m
[30;1m184 | [0m[35m    """[0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35m    base_image: Union[BasetenImage, CustomImage] = BasetenImage.PY311[0m

[31m--[ [0m[34mMatch #[0m[33m502[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/definitions.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m176 | [0m[35m        pip_requirements: A list of pip requirements to install.  The items are[0m
[30;1m177 | [0m[35m          naively concatenated with the content of the ``pip_requirements_file``.[0m
[30;1m178 | [0m[35m        apt_requirements: A list of apt requirements to install.[0m
[30;1m179 | [0m[35m        data_dir: Data from this directory is copied into the docker image and[0m
[30;1m180 | [0m[35m          accessible to the remote chainlet at runtime.[0m
[30;1m181 | [0m[35m        external_package_dirs: A list of directories containing additional python[0m
[30;1m182 | [0m[35m          packages outside the chain's workspace dir, e.g. a shared library. This code[0m

[31m--[ [0m[34mMatch #[0m[33m503[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/definitions.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m175 | [0m[35m          content is naively concatenated with ``pip_requirements``.[0m
[30;1m176 | [0m[35m        pip_requirements: A list of pip requirements to install.  The items are[0m
[30;1m177 | [0m[35m          naively concatenated with the content of the ``pip_requirements_file``.[0m
[30;1m178 | [0m[35m        apt_requirements: A list of apt requirements to install.[0m
[30;1m179 | [0m[35m        data_dir: Data from this directory is copied into the docker image and[0m
[30;1m180 | [0m[35m          accessible to the remote chainlet at runtime.[0m
[30;1m181 | [0m[35m        external_package_dirs: A list of directories containing additional python[0m

[31m--[ [0m[34mMatch #[0m[33m504[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/definitions.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m173 | [0m[35m          provide a custom image (e.g. ``CustomImage(image="python:3.11-slim")``)..[0m
[30;1m174 | [0m[35m        pip_requirements_file: Path to a file containing pip requirements. The file[0m
[30;1m175 | [0m[35m          content is naively concatenated with ``pip_requirements``.[0m
[30;1m176 | [0m[35m        pip_requirements: A list of pip requirements to install.  The items are[0m
[30;1m177 | [0m[35m          naively concatenated with the content of the ``pip_requirements_file``.[0m
[30;1m178 | [0m[35m        apt_requirements: A list of apt requirements to install.[0m
[30;1m179 | [0m[35m        data_dir: Data from this directory is copied into the docker image and[0m

[31m--[ [0m[34mMatch #[0m[33m505[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/definitions.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m171 | [0m[35m          a Baseten default image for a supported python version (e.g.[0m
[30;1m172 | [0m[35m          ``BasetenImage.PY311``), this will also include GPU drivers if needed, or[0m
[30;1m173 | [0m[35m          provide a custom image (e.g. ``CustomImage(image="python:3.11-slim")``)..[0m
[30;1m174 | [0m[35m        pip_requirements_file: Path to a file containing pip requirements. The file[0m
[30;1m175 | [0m[35m          content is naively concatenated with ``pip_requirements``.[0m
[30;1m176 | [0m[35m        pip_requirements: A list of pip requirements to install.  The items are[0m
[30;1m177 | [0m[35m          naively concatenated with the content of the ``pip_requirements_file``.[0m

[31m--[ [0m[34mMatch #[0m[33m506[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/definitions.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m167 | [0m[35m[0m
[30;1m168 | [0m[35m    Args:[0m
[30;1m169 | [0m[35m        base_image: The base image used by the chainlet. Other dependencies and[0m
[30;1m170 | [0m[35m          assets are included as additional layers on top of that image. You can choose[0m
[30;1m171 | [0m[35m          a Baseten default image for a supported python version (e.g.[0m
[30;1m172 | [0m[35m          ``BasetenImage.PY311``), this will also include GPU drivers if needed, or[0m
[30;1m173 | [0m[35m          provide a custom image (e.g. ``CustomImage(image="python:3.11-slim")``)..[0m

[31m--[ [0m[34mMatch #[0m[33m507[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/definitions.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35mclass DockerImage(SafeModelNonSerializable):[0m
[30;1m160 | [0m[35m    """Configures the docker image in which a remoted chainlet is deployed.[0m
[30;1m161 | [0m[35m[0m
[30;1m162 | [0m[35m    Note:[0m
[30;1m163 | [0m[35m        Any paths are relative to the source file where ``DockerImage`` is[0m

[31m--[ [0m[34mMatch #[0m[33m508[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/definitions.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m180 | [0m[35m          accessible to the remote chainlet at runtime.[0m
[30;1m181 | [0m[35m        external_package_dirs: A list of directories containing additional python[0m
[30;1m182 | [0m[35m          packages outside the chain's workspace dir, e.g. a shared library. This code[0m
[30;1m183 | [0m[35m          is copied into the docker image and importable at runtime.[0m
[30;1m184 | [0m[35m    """[0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35m    base_image: Union[BasetenImage, CustomImage] = BasetenImage.PY311[0m

[31m--[ [0m[34mMatch #[0m[33m509[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/definitions.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m177 | [0m[35m          naively concatenated with the content of the ``pip_requirements_file``.[0m
[30;1m178 | [0m[35m        apt_requirements: A list of apt requirements to install.[0m
[30;1m179 | [0m[35m        data_dir: Data from this directory is copied into the docker image and[0m
[30;1m180 | [0m[35m          accessible to the remote chainlet at runtime.[0m
[30;1m181 | [0m[35m        external_package_dirs: A list of directories containing additional python[0m
[30;1m182 | [0m[35m          packages outside the chain's workspace dir, e.g. a shared library. This code[0m
[30;1m183 | [0m[35m          is copied into the docker image and importable at runtime.[0m

[31m--[ [0m[34mMatch #[0m[33m510[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/definitions.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35mclass ChainsRuntimeError(Exception):[0m
[30;1m101 | [0m[35m    """Raised when components are not used the expected way at runtime."""[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35mclass ChainsDeploymentError(Exception):[0m

[31m--[ [0m[34mMatch #[0m[33m511[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/util/docker.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35mdef get_urls_from_container(container_details) -> Dict[int, List[str]]:[0m
[30;1m40 | [0m[35m    """Gets url where docker container is hosted."""[0m
[30;1m41 | [0m[35m    if ([0m
[30;1m42 | [0m[35m        container_details.network_settings is None[0m
[30;1m43 | [0m[35m        or container_details.network_settings.ports is None[0m

[31m--[ [0m[34mMatch #[0m[33m512[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/util/docker.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35m            if LocalConfigHandler.get_config().use_sudo:[0m
[30;1m21 | [0m[35m                Docker._client = DockerClient(client_call=["sudo", "docker"])[0m
[30;1m22 | [0m[35m            else:[0m
[30;1m23 | [0m[35m                Docker._client = docker[0m
[30;1m24 | [0m[35m        return Docker._client[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35mdef get_containers(labels: Dict, all: bool = False):[0m

[31m--[ [0m[34mMatch #[0m[33m513[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/util/docker.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m15 | [0m[35m    @staticmethod[0m
[30;1m16 | [0m[35m    def client():[0m
[30;1m17 | [0m[35m        if Docker._client is None:[0m
[30;1m18 | [0m[35m            from python_on_whales import DockerClient, docker[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m            if LocalConfigHandler.get_config().use_sudo:[0m
[30;1m21 | [0m[35m                Docker._client = DockerClient(client_call=["sudo", "docker"])[0m
[30;1m22 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m514[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/contexts/image_builder/image_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35m        Arguments:[0m
[30;1m21 | [0m[35m            build_dir(Path): Directory to use for building the docker image. If None[0m
[30;1m22 | [0m[35m                             then a temporary directory is used.[0m
[30;1m23 | [0m[35m            tag(str): A tag to assign to the docker image.[0m
[30;1m24 | [0m[35m        """[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m        with given_or_temporary_dir(build_dir) as build_dir_path:[0m

[31m--[ [0m[34mMatch #[0m[33m515[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/contexts/image_builder/image_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m        """Build image.[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m        Arguments:[0m
[30;1m21 | [0m[35m            build_dir(Path): Directory to use for building the docker image. If None[0m
[30;1m22 | [0m[35m                             then a temporary directory is used.[0m
[30;1m23 | [0m[35m            tag(str): A tag to assign to the docker image.[0m
[30;1m24 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m516[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/contexts/image_builder/image_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mfrom pathlib import Path[0m
[30;1m3 | [0m[35mfrom typing import Optional[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mfrom truss.util.docker import Docker[0m
[30;1m6 | [0m[35mfrom truss.util.path import given_or_temporary_dir[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mclass ImageBuilder(ABC):[0m

[31m--[ [0m[34mMatch #[0m[33m517[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/CODE_OF_CONDUCT.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m121 | [0m[35m[Mozilla's code of conduct enforcement ladder][Mozilla CoC].[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35mFor answers to common questions about this code of conduct, see the FAQ at[0m
[30;1m124 | [0m[35m[https://www.contributor-covenant.org/faq][FAQ]. Translations are available at[0m
[30;1m125 | [0m[35m[https://www.contributor-covenant.org/translations][translations].[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m[homepage]: https://www.contributor-covenant.org[0m
[30;1m128 | [0m[35m[v2.1]: https://www.contributor-covenant.org/version/2/1/code_of_conduct.html[0m

[31m--[ [0m[34mMatch #[0m[33m518[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/CODE_OF_CONDUCT.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m120 | [0m[35mCommunity Impact Guidelines were inspired by[0m
[30;1m121 | [0m[35m[Mozilla's code of conduct enforcement ladder][Mozilla CoC].[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35mFor answers to common questions about this code of conduct, see the FAQ at[0m
[30;1m124 | [0m[35m[https://www.contributor-covenant.org/faq][FAQ]. Translations are available at[0m
[30;1m125 | [0m[35m[https://www.contributor-covenant.org/translations][translations].[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m[homepage]: https://www.contributor-covenant.org[0m

[31m--[ [0m[34mMatch #[0m[33m519[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/CODE_OF_CONDUCT.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m114 | [0m[35m## Attribution[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35mThis Code of Conduct is adapted from the [Contributor Covenant][homepage],[0m
[30;1m117 | [0m[35mversion 2.1, available at[0m
[30;1m118 | [0m[35m[https://www.contributor-covenant.org/version/2/1/code_of_conduct.html][v2.1].[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35mCommunity Impact Guidelines were inspired by[0m
[30;1m121 | [0m[35m[Mozilla's code of conduct enforcement ladder][Mozilla CoC].[0m

[31m--[ [0m[34mMatch #[0m[33m520[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/CODE_OF_CONDUCT.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m59 | [0m[35m## Enforcement[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35mInstances of abusive, harassing, or otherwise unacceptable behavior may be[0m
[30;1m62 | [0m[35mreported to the community leaders responsible for enforcement at support@baseten.co.[0m
[30;1m63 | [0m[35mAll complaints will be reviewed and investigated promptly and fairly.[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35mAll community leaders are obligated to respect the privacy and security of the[0m

[31m--[ [0m[34mMatch #[0m[33m521[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/CODE_OF_CONDUCT.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m54 | [0m[35man individual is officially representing the community in public spaces.[0m
[30;1m55 | [0m[35mExamples of representing our community include using an official e-mail address,[0m
[30;1m56 | [0m[35mposting via an official social media account, or acting as an appointed[0m
[30;1m57 | [0m[35mrepresentative at an online or offline event.[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m## Enforcement[0m
[30;1m60 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m522[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/CODE_OF_CONDUCT.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m108 | [0m[35mstandards, including sustained inappropriate behavior, harassment of an[0m
[30;1m109 | [0m[35mindividual, or aggression toward or disparagement of classes of individuals.[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m**Consequence**: A permanent ban from any sort of public interaction within the[0m
[30;1m112 | [0m[35mcommunity.[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m## Attribution[0m

[31m--[ [0m[34mMatch #[0m[33m523[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/CODE_OF_CONDUCT.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m96 | [0m[35m**Community Impact**: A serious violation of community standards, including[0m
[30;1m97 | [0m[35msustained inappropriate behavior.[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m**Consequence**: A temporary ban from any sort of interaction or public[0m
[30;1m100 | [0m[35mcommunication with the community for a specified period of time. No public or[0m
[30;1m101 | [0m[35mprivate interaction with the people involved, including unsolicited interaction[0m
[30;1m102 | [0m[35mwith those enforcing the Code of Conduct, is allowed during this period.[0m

[31m--[ [0m[34mMatch #[0m[33m524[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_requirements_file_truss/model/model.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35m* `load`: runs exactly once when the model server is spun up or patched and loads the[0m
[30;1m7 | [0m[35m   model onto the model server. Include any logic for initializing your model, such[0m
[30;1m8 | [0m[35m   as downloading model weights and loading the model into memory.[0m
[30;1m9 | [0m[35m* `predict`: runs every time the model server is called. Include any logic for model[0m
[30;1m10 | [0m[35m  inference and return the model output.[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mSee https://truss.baseten.co/quickstart for more.[0m

[31m--[ [0m[34mMatch #[0m[33m525[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000703[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Username[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/__init__.py[0m
   Pattern: [32m.userInfo[0m
[30;1m18 | [0m[35mfrom truss.base import truss_config[0m
[30;1m19 | [0m[35mfrom truss.truss_handle.build import load  # TODO: Refactor all usages and remove.[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m__all__ = ["push", "login", "load", "whoami", "truss_config"][0m

[31m--[ [0m[34mMatch #[0m[33m526[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000703[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Username[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/__init__.py[0m
   Pattern: [32m.userInfo[0m
[30;1m14 | [0m[35m    return __version__[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mfrom truss.api import login, push, whoami[0m
[30;1m18 | [0m[35mfrom truss.base import truss_config[0m
[30;1m19 | [0m[35mfrom truss.truss_handle.build import load  # TODO: Refactor all usages and remove.[0m
[30;1m20 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m527[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/shared/secrets_resolver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m    @staticmethod[0m
[30;1m18 | [0m[35m    def get_secrets(config: Dict):[0m
[30;1m19 | [0m[35m        return Secrets(config.get("secrets", {}))[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m    @staticmethod[0m
[30;1m22 | [0m[35m    def _resolve_secret(secret_name: str, default_value: Optional[str]):[0m

[31m--[ [0m[34mMatch #[0m[33m528[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_streaming_truss_with_error/model/model.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m8 | [0m[35m        def inner():[0m
[30;1m9 | [0m[35m            for i in range(5):[0m
[30;1m10 | [0m[35m                # Raise error partway through if throw_error is set[0m
[30;1m11 | [0m[35m                if i == 3 and model_input.get("throw_error"):[0m
[30;1m12 | [0m[35m                    helpers_1.foo(123)[0m
[30;1m13 | [0m[35m                yield str(i)[0m
[30;1m14 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m529[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35mThe pipeline model relies on [Transformers](https://huggingface.co/docs/transformers/index) and [PyT[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35mIn `config.yaml`, find the line `requirements`. Replace the empty list with:[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m```yaml[0m
[30;1m136 | [0m[35mrequirements:[0m

[31m--[ [0m[34mMatch #[0m[33m530[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m105 | [0m[35mThere are two member functions that you must implement in the `Model` class:[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m* `load()` loads the model onto the model server. It runs exactly once when the model server is spun[0m
[30;1m108 | [0m[35m* `predict()` handles model inference. It runs every time the model server is called.[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35mHere's the complete `model/model.py` for the text classification model:[0m
[30;1m111 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m531[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35mInstall Truss with:[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m```[0m
[30;1m78 | [0m[35mpip install --upgrade truss[0m
[30;1m79 | [0m[35m```[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m## Quickstart[0m

[31m--[ [0m[34mMatch #[0m[33m532[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m59 | [0m[35m## Why Truss?[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m* **Write once, run anywhere:** Package and test model code, weights, and dependencies with a model [0m
[30;1m62 | [0m[35m* **Fast developer loop:** Implement your model with fast feedback from a live reload server, and sk[0m
[30;1m63 | [0m[35m* **Support for all Python frameworks**: From `transformers` and `diffusers` to `PyTorch` and `Tenso[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35mSee Trusses for popular models including:[0m

[31m--[ [0m[34mMatch #[0m[33m533[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/utils/status.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35m    Baseten REST API will return status strings matching the ones here, so we don't[0m
[30;1m27 | [0m[35m    need to do any mapping.[0m
[30;1m28 | [0m[35m    """[0m
[30;1m29 | [0m[35m    return STATUS_TO_DISPLAYABLE.get(status, "UNKNOWN")[0m

[31m--[ [0m[34mMatch #[0m[33m534[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m662 | [0m[35m                d.get("trt_llm"), lambda x: (TRTLLMConfiguration(**x))[0m
[30;1m663 | [0m[35m            ),[0m
[30;1m664 | [0m[35m            build_commands=d.get("build_commands", []),[0m
[30;1m665 | [0m[35m            use_local_chains_src=d.get("use_local_chains_src", False),[0m
[30;1m666 | [0m[35m        )[0m
[30;1m667 | [0m[35m        config.validate()[0m
[30;1m668 | [0m[35m        return config[0m

[31m--[ [0m[34mMatch #[0m[33m535[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m661 | [0m[35m            trt_llm=transform_optional([0m
[30;1m662 | [0m[35m                d.get("trt_llm"), lambda x: (TRTLLMConfiguration(**x))[0m
[30;1m663 | [0m[35m            ),[0m
[30;1m664 | [0m[35m            build_commands=d.get("build_commands", []),[0m
[30;1m665 | [0m[35m            use_local_chains_src=d.get("use_local_chains_src", False),[0m
[30;1m666 | [0m[35m        )[0m
[30;1m667 | [0m[35m        config.validate()[0m

[31m--[ [0m[34mMatch #[0m[33m536[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m659 | [0m[35m                ModelCache.from_list,[0m
[30;1m660 | [0m[35m            ),[0m
[30;1m661 | [0m[35m            trt_llm=transform_optional([0m
[30;1m662 | [0m[35m                d.get("trt_llm"), lambda x: (TRTLLMConfiguration(**x))[0m
[30;1m663 | [0m[35m            ),[0m
[30;1m664 | [0m[35m            build_commands=d.get("build_commands", []),[0m
[30;1m665 | [0m[35m            use_local_chains_src=d.get("use_local_chains_src", False),[0m

[31m--[ [0m[34mMatch #[0m[33m537[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m655 | [0m[35m                d.get("docker_server"), DockerServer.from_dict[0m
[30;1m656 | [0m[35m            ),[0m
[30;1m657 | [0m[35m            model_cache=transform_optional([0m
[30;1m658 | [0m[35m                d.get("model_cache") or d.get("hf_cache") or [],  # type: ignore[0m
[30;1m659 | [0m[35m                ModelCache.from_list,[0m
[30;1m660 | [0m[35m            ),[0m
[30;1m661 | [0m[35m            trt_llm=transform_optional([0m

[31m--[ [0m[34mMatch #[0m[33m538[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m655 | [0m[35m                d.get("docker_server"), DockerServer.from_dict[0m
[30;1m656 | [0m[35m            ),[0m
[30;1m657 | [0m[35m            model_cache=transform_optional([0m
[30;1m658 | [0m[35m                d.get("model_cache") or d.get("hf_cache") or [],  # type: ignore[0m
[30;1m659 | [0m[35m                ModelCache.from_list,[0m
[30;1m660 | [0m[35m            ),[0m
[30;1m661 | [0m[35m            trt_llm=transform_optional([0m

[31m--[ [0m[34mMatch #[0m[33m539[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m652 | [0m[35m            ),[0m
[30;1m653 | [0m[35m            base_image=transform_optional(d.get("base_image"), BaseImage.from_dict),[0m
[30;1m654 | [0m[35m            docker_server=transform_optional([0m
[30;1m655 | [0m[35m                d.get("docker_server"), DockerServer.from_dict[0m
[30;1m656 | [0m[35m            ),[0m
[30;1m657 | [0m[35m            model_cache=transform_optional([0m
[30;1m658 | [0m[35m                d.get("model_cache") or d.get("hf_cache") or [],  # type: ignore[0m

[31m--[ [0m[34mMatch #[0m[33m540[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m650 | [0m[35m            external_data=transform_optional([0m
[30;1m651 | [0m[35m                d.get("external_data"), ExternalData.from_list[0m
[30;1m652 | [0m[35m            ),[0m
[30;1m653 | [0m[35m            base_image=transform_optional(d.get("base_image"), BaseImage.from_dict),[0m
[30;1m654 | [0m[35m            docker_server=transform_optional([0m
[30;1m655 | [0m[35m                d.get("docker_server"), DockerServer.from_dict[0m
[30;1m656 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m541[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m648 | [0m[35m            live_reload=d.get("live_reload", False),[0m
[30;1m649 | [0m[35m            apply_library_patches=d.get("apply_library_patches", True),[0m
[30;1m650 | [0m[35m            external_data=transform_optional([0m
[30;1m651 | [0m[35m                d.get("external_data"), ExternalData.from_list[0m
[30;1m652 | [0m[35m            ),[0m
[30;1m653 | [0m[35m            base_image=transform_optional(d.get("base_image"), BaseImage.from_dict),[0m
[30;1m654 | [0m[35m            docker_server=transform_optional([0m

[31m--[ [0m[34mMatch #[0m[33m542[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m646 | [0m[35m            ),[0m
[30;1m647 | [0m[35m            external_package_dirs=d.get("external_package_dirs", []),[0m
[30;1m648 | [0m[35m            live_reload=d.get("live_reload", False),[0m
[30;1m649 | [0m[35m            apply_library_patches=d.get("apply_library_patches", True),[0m
[30;1m650 | [0m[35m            external_data=transform_optional([0m
[30;1m651 | [0m[35m                d.get("external_data"), ExternalData.from_list[0m
[30;1m652 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m543[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m645 | [0m[35m                "bundled_packages_dir", DEFAULT_BUNDLED_PACKAGES_DIR[0m
[30;1m646 | [0m[35m            ),[0m
[30;1m647 | [0m[35m            external_package_dirs=d.get("external_package_dirs", []),[0m
[30;1m648 | [0m[35m            live_reload=d.get("live_reload", False),[0m
[30;1m649 | [0m[35m            apply_library_patches=d.get("apply_library_patches", True),[0m
[30;1m650 | [0m[35m            external_data=transform_optional([0m
[30;1m651 | [0m[35m                d.get("external_data"), ExternalData.from_list[0m

[31m--[ [0m[34mMatch #[0m[33m544[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m644 | [0m[35m            bundled_packages_dir=d.get([0m
[30;1m645 | [0m[35m                "bundled_packages_dir", DEFAULT_BUNDLED_PACKAGES_DIR[0m
[30;1m646 | [0m[35m            ),[0m
[30;1m647 | [0m[35m            external_package_dirs=d.get("external_package_dirs", []),[0m
[30;1m648 | [0m[35m            live_reload=d.get("live_reload", False),[0m
[30;1m649 | [0m[35m            apply_library_patches=d.get("apply_library_patches", True),[0m
[30;1m650 | [0m[35m            external_data=transform_optional([0m

[31m--[ [0m[34mMatch #[0m[33m545[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m641 | [0m[35m            examples_filename=d.get("examples_filename", DEFAULT_EXAMPLES_FILENAME),[0m
[30;1m642 | [0m[35m            secrets=d.get("secrets", {}),[0m
[30;1m643 | [0m[35m            description=d.get("description", None),[0m
[30;1m644 | [0m[35m            bundled_packages_dir=d.get([0m
[30;1m645 | [0m[35m                "bundled_packages_dir", DEFAULT_BUNDLED_PACKAGES_DIR[0m
[30;1m646 | [0m[35m            ),[0m
[30;1m647 | [0m[35m            external_package_dirs=d.get("external_package_dirs", []),[0m

[31m--[ [0m[34mMatch #[0m[33m546[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m640 | [0m[35m            model_name=d.get("model_name", None),[0m
[30;1m641 | [0m[35m            examples_filename=d.get("examples_filename", DEFAULT_EXAMPLES_FILENAME),[0m
[30;1m642 | [0m[35m            secrets=d.get("secrets", {}),[0m
[30;1m643 | [0m[35m            description=d.get("description", None),[0m
[30;1m644 | [0m[35m            bundled_packages_dir=d.get([0m
[30;1m645 | [0m[35m                "bundled_packages_dir", DEFAULT_BUNDLED_PACKAGES_DIR[0m
[30;1m646 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m547[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m639 | [0m[35m            python_version=d.get("python_version", DEFAULT_PYTHON_VERSION),[0m
[30;1m640 | [0m[35m            model_name=d.get("model_name", None),[0m
[30;1m641 | [0m[35m            examples_filename=d.get("examples_filename", DEFAULT_EXAMPLES_FILENAME),[0m
[30;1m642 | [0m[35m            secrets=d.get("secrets", {}),[0m
[30;1m643 | [0m[35m            description=d.get("description", None),[0m
[30;1m644 | [0m[35m            bundled_packages_dir=d.get([0m
[30;1m645 | [0m[35m                "bundled_packages_dir", DEFAULT_BUNDLED_PACKAGES_DIR[0m

[31m--[ [0m[34mMatch #[0m[33m548[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m638 | [0m[35m            build=Build.from_dict(d.get("build", {})),[0m
[30;1m639 | [0m[35m            python_version=d.get("python_version", DEFAULT_PYTHON_VERSION),[0m
[30;1m640 | [0m[35m            model_name=d.get("model_name", None),[0m
[30;1m641 | [0m[35m            examples_filename=d.get("examples_filename", DEFAULT_EXAMPLES_FILENAME),[0m
[30;1m642 | [0m[35m            secrets=d.get("secrets", {}),[0m
[30;1m643 | [0m[35m            description=d.get("description", None),[0m
[30;1m644 | [0m[35m            bundled_packages_dir=d.get([0m

[31m--[ [0m[34mMatch #[0m[33m549[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m637 | [0m[35m            runtime=Runtime.from_dict(d.get("runtime", {})),[0m
[30;1m638 | [0m[35m            build=Build.from_dict(d.get("build", {})),[0m
[30;1m639 | [0m[35m            python_version=d.get("python_version", DEFAULT_PYTHON_VERSION),[0m
[30;1m640 | [0m[35m            model_name=d.get("model_name", None),[0m
[30;1m641 | [0m[35m            examples_filename=d.get("examples_filename", DEFAULT_EXAMPLES_FILENAME),[0m
[30;1m642 | [0m[35m            secrets=d.get("secrets", {}),[0m
[30;1m643 | [0m[35m            description=d.get("description", None),[0m

[31m--[ [0m[34mMatch #[0m[33m550[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m636 | [0m[35m            resources=Resources.from_dict(d.get("resources", {})),[0m
[30;1m637 | [0m[35m            runtime=Runtime.from_dict(d.get("runtime", {})),[0m
[30;1m638 | [0m[35m            build=Build.from_dict(d.get("build", {})),[0m
[30;1m639 | [0m[35m            python_version=d.get("python_version", DEFAULT_PYTHON_VERSION),[0m
[30;1m640 | [0m[35m            model_name=d.get("model_name", None),[0m
[30;1m641 | [0m[35m            examples_filename=d.get("examples_filename", DEFAULT_EXAMPLES_FILENAME),[0m
[30;1m642 | [0m[35m            secrets=d.get("secrets", {}),[0m

[31m--[ [0m[34mMatch #[0m[33m551[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m635 | [0m[35m            environment_variables=_handle_env_vars(d.get("environment_variables", {})),[0m
[30;1m636 | [0m[35m            resources=Resources.from_dict(d.get("resources", {})),[0m
[30;1m637 | [0m[35m            runtime=Runtime.from_dict(d.get("runtime", {})),[0m
[30;1m638 | [0m[35m            build=Build.from_dict(d.get("build", {})),[0m
[30;1m639 | [0m[35m            python_version=d.get("python_version", DEFAULT_PYTHON_VERSION),[0m
[30;1m640 | [0m[35m            model_name=d.get("model_name", None),[0m
[30;1m641 | [0m[35m            examples_filename=d.get("examples_filename", DEFAULT_EXAMPLES_FILENAME),[0m

[31m--[ [0m[34mMatch #[0m[33m552[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m634 | [0m[35m            system_packages=d.get("system_packages", []),[0m
[30;1m635 | [0m[35m            environment_variables=_handle_env_vars(d.get("environment_variables", {})),[0m
[30;1m636 | [0m[35m            resources=Resources.from_dict(d.get("resources", {})),[0m
[30;1m637 | [0m[35m            runtime=Runtime.from_dict(d.get("runtime", {})),[0m
[30;1m638 | [0m[35m            build=Build.from_dict(d.get("build", {})),[0m
[30;1m639 | [0m[35m            python_version=d.get("python_version", DEFAULT_PYTHON_VERSION),[0m
[30;1m640 | [0m[35m            model_name=d.get("model_name", None),[0m

[31m--[ [0m[34mMatch #[0m[33m553[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m633 | [0m[35m            requirements=d.get("requirements", []),[0m
[30;1m634 | [0m[35m            system_packages=d.get("system_packages", []),[0m
[30;1m635 | [0m[35m            environment_variables=_handle_env_vars(d.get("environment_variables", {})),[0m
[30;1m636 | [0m[35m            resources=Resources.from_dict(d.get("resources", {})),[0m
[30;1m637 | [0m[35m            runtime=Runtime.from_dict(d.get("runtime", {})),[0m
[30;1m638 | [0m[35m            build=Build.from_dict(d.get("build", {})),[0m
[30;1m639 | [0m[35m            python_version=d.get("python_version", DEFAULT_PYTHON_VERSION),[0m

[31m--[ [0m[34mMatch #[0m[33m554[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m632 | [0m[35m            requirements_file=d.get("requirements_file", None),[0m
[30;1m633 | [0m[35m            requirements=d.get("requirements", []),[0m
[30;1m634 | [0m[35m            system_packages=d.get("system_packages", []),[0m
[30;1m635 | [0m[35m            environment_variables=_handle_env_vars(d.get("environment_variables", {})),[0m
[30;1m636 | [0m[35m            resources=Resources.from_dict(d.get("resources", {})),[0m
[30;1m637 | [0m[35m            runtime=Runtime.from_dict(d.get("runtime", {})),[0m
[30;1m638 | [0m[35m            build=Build.from_dict(d.get("build", {})),[0m

[31m--[ [0m[34mMatch #[0m[33m555[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m631 | [0m[35m            model_metadata=d.get("model_metadata", {}),[0m
[30;1m632 | [0m[35m            requirements_file=d.get("requirements_file", None),[0m
[30;1m633 | [0m[35m            requirements=d.get("requirements", []),[0m
[30;1m634 | [0m[35m            system_packages=d.get("system_packages", []),[0m
[30;1m635 | [0m[35m            environment_variables=_handle_env_vars(d.get("environment_variables", {})),[0m
[30;1m636 | [0m[35m            resources=Resources.from_dict(d.get("resources", {})),[0m
[30;1m637 | [0m[35m            runtime=Runtime.from_dict(d.get("runtime", {})),[0m

[31m--[ [0m[34mMatch #[0m[33m556[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m630 | [0m[35m            input_type=d.get("input_type", DEFAULT_MODEL_INPUT_TYPE),[0m
[30;1m631 | [0m[35m            model_metadata=d.get("model_metadata", {}),[0m
[30;1m632 | [0m[35m            requirements_file=d.get("requirements_file", None),[0m
[30;1m633 | [0m[35m            requirements=d.get("requirements", []),[0m
[30;1m634 | [0m[35m            system_packages=d.get("system_packages", []),[0m
[30;1m635 | [0m[35m            environment_variables=_handle_env_vars(d.get("environment_variables", {})),[0m
[30;1m636 | [0m[35m            resources=Resources.from_dict(d.get("resources", {})),[0m

[31m--[ [0m[34mMatch #[0m[33m557[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m629 | [0m[35m            data_dir=d.get("data_dir", DEFAULT_DATA_DIRECTORY),[0m
[30;1m630 | [0m[35m            input_type=d.get("input_type", DEFAULT_MODEL_INPUT_TYPE),[0m
[30;1m631 | [0m[35m            model_metadata=d.get("model_metadata", {}),[0m
[30;1m632 | [0m[35m            requirements_file=d.get("requirements_file", None),[0m
[30;1m633 | [0m[35m            requirements=d.get("requirements", []),[0m
[30;1m634 | [0m[35m            system_packages=d.get("system_packages", []),[0m
[30;1m635 | [0m[35m            environment_variables=_handle_env_vars(d.get("environment_variables", {})),[0m

[31m--[ [0m[34mMatch #[0m[33m558[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m628 | [0m[35m            model_class_name=d.get("model_class_name", DEFAULT_MODEL_CLASS_NAME),[0m
[30;1m629 | [0m[35m            data_dir=d.get("data_dir", DEFAULT_DATA_DIRECTORY),[0m
[30;1m630 | [0m[35m            input_type=d.get("input_type", DEFAULT_MODEL_INPUT_TYPE),[0m
[30;1m631 | [0m[35m            model_metadata=d.get("model_metadata", {}),[0m
[30;1m632 | [0m[35m            requirements_file=d.get("requirements_file", None),[0m
[30;1m633 | [0m[35m            requirements=d.get("requirements", []),[0m
[30;1m634 | [0m[35m            system_packages=d.get("system_packages", []),[0m

[31m--[ [0m[34mMatch #[0m[33m559[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m627 | [0m[35m            ),[0m
[30;1m628 | [0m[35m            model_class_name=d.get("model_class_name", DEFAULT_MODEL_CLASS_NAME),[0m
[30;1m629 | [0m[35m            data_dir=d.get("data_dir", DEFAULT_DATA_DIRECTORY),[0m
[30;1m630 | [0m[35m            input_type=d.get("input_type", DEFAULT_MODEL_INPUT_TYPE),[0m
[30;1m631 | [0m[35m            model_metadata=d.get("model_metadata", {}),[0m
[30;1m632 | [0m[35m            requirements_file=d.get("requirements_file", None),[0m
[30;1m633 | [0m[35m            requirements=d.get("requirements", []),[0m

[31m--[ [0m[34mMatch #[0m[33m560[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m626 | [0m[35m                "model_class_filename", DEFAULT_MODEL_CLASS_FILENAME[0m
[30;1m627 | [0m[35m            ),[0m
[30;1m628 | [0m[35m            model_class_name=d.get("model_class_name", DEFAULT_MODEL_CLASS_NAME),[0m
[30;1m629 | [0m[35m            data_dir=d.get("data_dir", DEFAULT_DATA_DIRECTORY),[0m
[30;1m630 | [0m[35m            input_type=d.get("input_type", DEFAULT_MODEL_INPUT_TYPE),[0m
[30;1m631 | [0m[35m            model_metadata=d.get("model_metadata", {}),[0m
[30;1m632 | [0m[35m            requirements_file=d.get("requirements_file", None),[0m

[31m--[ [0m[34mMatch #[0m[33m561[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m625 | [0m[35m            model_class_filename=d.get([0m
[30;1m626 | [0m[35m                "model_class_filename", DEFAULT_MODEL_CLASS_FILENAME[0m
[30;1m627 | [0m[35m            ),[0m
[30;1m628 | [0m[35m            model_class_name=d.get("model_class_name", DEFAULT_MODEL_CLASS_NAME),[0m
[30;1m629 | [0m[35m            data_dir=d.get("data_dir", DEFAULT_DATA_DIRECTORY),[0m
[30;1m630 | [0m[35m            input_type=d.get("input_type", DEFAULT_MODEL_INPUT_TYPE),[0m
[30;1m631 | [0m[35m            model_metadata=d.get("model_metadata", {}),[0m

[31m--[ [0m[34mMatch #[0m[33m562[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m622 | [0m[35m                d.get("model_framework", DEFAULT_MODEL_FRAMEWORK_TYPE.value)[0m
[30;1m623 | [0m[35m            ),[0m
[30;1m624 | [0m[35m            model_module_dir=d.get("model_module_dir", DEFAULT_MODEL_MODULE_DIR),[0m
[30;1m625 | [0m[35m            model_class_filename=d.get([0m
[30;1m626 | [0m[35m                "model_class_filename", DEFAULT_MODEL_CLASS_FILENAME[0m
[30;1m627 | [0m[35m            ),[0m
[30;1m628 | [0m[35m            model_class_name=d.get("model_class_name", DEFAULT_MODEL_CLASS_NAME),[0m

[31m--[ [0m[34mMatch #[0m[33m563[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m621 | [0m[35m            model_framework=ModelFrameworkType([0m
[30;1m622 | [0m[35m                d.get("model_framework", DEFAULT_MODEL_FRAMEWORK_TYPE.value)[0m
[30;1m623 | [0m[35m            ),[0m
[30;1m624 | [0m[35m            model_module_dir=d.get("model_module_dir", DEFAULT_MODEL_MODULE_DIR),[0m
[30;1m625 | [0m[35m            model_class_filename=d.get([0m
[30;1m626 | [0m[35m                "model_class_filename", DEFAULT_MODEL_CLASS_FILENAME[0m
[30;1m627 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m564[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m619 | [0m[35m            spec_version=d.get("spec_version", DEFAULT_SPEC_VERSION),[0m
[30;1m620 | [0m[35m            model_type=d.get("model_type", DEFAULT_MODEL_TYPE),[0m
[30;1m621 | [0m[35m            model_framework=ModelFrameworkType([0m
[30;1m622 | [0m[35m                d.get("model_framework", DEFAULT_MODEL_FRAMEWORK_TYPE.value)[0m
[30;1m623 | [0m[35m            ),[0m
[30;1m624 | [0m[35m            model_module_dir=d.get("model_module_dir", DEFAULT_MODEL_MODULE_DIR),[0m
[30;1m625 | [0m[35m            model_class_filename=d.get([0m

[31m--[ [0m[34mMatch #[0m[33m565[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m617 | [0m[35m    def from_dict(d):[0m
[30;1m618 | [0m[35m        config = TrussConfig([0m
[30;1m619 | [0m[35m            spec_version=d.get("spec_version", DEFAULT_SPEC_VERSION),[0m
[30;1m620 | [0m[35m            model_type=d.get("model_type", DEFAULT_MODEL_TYPE),[0m
[30;1m621 | [0m[35m            model_framework=ModelFrameworkType([0m
[30;1m622 | [0m[35m                d.get("model_framework", DEFAULT_MODEL_FRAMEWORK_TYPE.value)[0m
[30;1m623 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m566[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m616 | [0m[35m    @staticmethod[0m
[30;1m617 | [0m[35m    def from_dict(d):[0m
[30;1m618 | [0m[35m        config = TrussConfig([0m
[30;1m619 | [0m[35m            spec_version=d.get("spec_version", DEFAULT_SPEC_VERSION),[0m
[30;1m620 | [0m[35m            model_type=d.get("model_type", DEFAULT_MODEL_TYPE),[0m
[30;1m621 | [0m[35m            model_framework=ModelFrameworkType([0m
[30;1m622 | [0m[35m                d.get("model_framework", DEFAULT_MODEL_FRAMEWORK_TYPE.value)[0m

[31m--[ [0m[34mMatch #[0m[33m567[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m463 | [0m[35m            server_port=d.get("server_port"),[0m
[30;1m464 | [0m[35m            predict_endpoint=d.get("predict_endpoint"),[0m
[30;1m465 | [0m[35m            readiness_endpoint=d.get("readiness_endpoint"),[0m
[30;1m466 | [0m[35m            liveness_endpoint=d.get("liveness_endpoint"),[0m
[30;1m467 | [0m[35m        )[0m
[30;1m468 | [0m[35m[0m
[30;1m469 | [0m[35m    def to_dict(self):[0m

[31m--[ [0m[34mMatch #[0m[33m568[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m462 | [0m[35m            start_command=d.get("start_command"),[0m
[30;1m463 | [0m[35m            server_port=d.get("server_port"),[0m
[30;1m464 | [0m[35m            predict_endpoint=d.get("predict_endpoint"),[0m
[30;1m465 | [0m[35m            readiness_endpoint=d.get("readiness_endpoint"),[0m
[30;1m466 | [0m[35m            liveness_endpoint=d.get("liveness_endpoint"),[0m
[30;1m467 | [0m[35m        )[0m
[30;1m468 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m569[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m461 | [0m[35m        return DockerServer([0m
[30;1m462 | [0m[35m            start_command=d.get("start_command"),[0m
[30;1m463 | [0m[35m            server_port=d.get("server_port"),[0m
[30;1m464 | [0m[35m            predict_endpoint=d.get("predict_endpoint"),[0m
[30;1m465 | [0m[35m            readiness_endpoint=d.get("readiness_endpoint"),[0m
[30;1m466 | [0m[35m            liveness_endpoint=d.get("liveness_endpoint"),[0m
[30;1m467 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m570[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m460 | [0m[35m    def from_dict(d) -> "DockerServer":[0m
[30;1m461 | [0m[35m        return DockerServer([0m
[30;1m462 | [0m[35m            start_command=d.get("start_command"),[0m
[30;1m463 | [0m[35m            server_port=d.get("server_port"),[0m
[30;1m464 | [0m[35m            predict_endpoint=d.get("predict_endpoint"),[0m
[30;1m465 | [0m[35m            readiness_endpoint=d.get("readiness_endpoint"),[0m
[30;1m466 | [0m[35m            liveness_endpoint=d.get("liveness_endpoint"),[0m

[31m--[ [0m[34mMatch #[0m[33m571[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m459 | [0m[35m    @staticmethod[0m
[30;1m460 | [0m[35m    def from_dict(d) -> "DockerServer":[0m
[30;1m461 | [0m[35m        return DockerServer([0m
[30;1m462 | [0m[35m            start_command=d.get("start_command"),[0m
[30;1m463 | [0m[35m            server_port=d.get("server_port"),[0m
[30;1m464 | [0m[35m            predict_endpoint=d.get("predict_endpoint"),[0m
[30;1m465 | [0m[35m            readiness_endpoint=d.get("readiness_endpoint"),[0m

[31m--[ [0m[34mMatch #[0m[33m572[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m428 | [0m[35m    def from_dict(d):[0m
[30;1m429 | [0m[35m        image = d.get("image", "")[0m
[30;1m430 | [0m[35m        python_executable_path = d.get("python_executable_path", "")[0m
[30;1m431 | [0m[35m        docker_auth = d.get("docker_auth")[0m
[30;1m432 | [0m[35m        validate_python_executable_path(python_executable_path)[0m
[30;1m433 | [0m[35m        return BaseImage([0m
[30;1m434 | [0m[35m            image=image,[0m

[31m--[ [0m[34mMatch #[0m[33m573[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m427 | [0m[35m    @staticmethod[0m
[30;1m428 | [0m[35m    def from_dict(d):[0m
[30;1m429 | [0m[35m        image = d.get("image", "")[0m
[30;1m430 | [0m[35m        python_executable_path = d.get("python_executable_path", "")[0m
[30;1m431 | [0m[35m        docker_auth = d.get("docker_auth")[0m
[30;1m432 | [0m[35m        validate_python_executable_path(python_executable_path)[0m
[30;1m433 | [0m[35m        return BaseImage([0m

[31m--[ [0m[34mMatch #[0m[33m574[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m426 | [0m[35m[0m
[30;1m427 | [0m[35m    @staticmethod[0m
[30;1m428 | [0m[35m    def from_dict(d):[0m
[30;1m429 | [0m[35m        image = d.get("image", "")[0m
[30;1m430 | [0m[35m        python_executable_path = d.get("python_executable_path", "")[0m
[30;1m431 | [0m[35m        docker_auth = d.get("docker_auth")[0m
[30;1m432 | [0m[35m        validate_python_executable_path(python_executable_path)[0m

[31m--[ [0m[34mMatch #[0m[33m575[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m407 | [0m[35m        return DockerAuthSettings([0m
[30;1m408 | [0m[35m            auth_method=DockerAuthType[auth_method],[0m
[30;1m409 | [0m[35m            secret_name=secret_name,[0m
[30;1m410 | [0m[35m            registry=d.get("registry"),[0m
[30;1m411 | [0m[35m        )[0m
[30;1m412 | [0m[35m[0m
[30;1m413 | [0m[35m    def to_dict(self):[0m

[31m--[ [0m[34mMatch #[0m[33m576[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m390 | [0m[35m    @staticmethod[0m
[30;1m391 | [0m[35m    def from_dict(d: Dict[str, str]):[0m
[30;1m392 | [0m[35m        auth_method = d.get("auth_method")[0m
[30;1m393 | [0m[35m        secret_name = d.get("secret_name")[0m
[30;1m394 | [0m[35m[0m
[30;1m395 | [0m[35m        if auth_method:[0m
[30;1m396 | [0m[35m            # Capitalize the auth method so that we support this field passed[0m

[31m--[ [0m[34mMatch #[0m[33m577[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m389 | [0m[35m[0m
[30;1m390 | [0m[35m    @staticmethod[0m
[30;1m391 | [0m[35m    def from_dict(d: Dict[str, str]):[0m
[30;1m392 | [0m[35m        auth_method = d.get("auth_method")[0m
[30;1m393 | [0m[35m        secret_name = d.get("secret_name")[0m
[30;1m394 | [0m[35m[0m
[30;1m395 | [0m[35m        if auth_method:[0m

[31m--[ [0m[34mMatch #[0m[33m578[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m334 | [0m[35m            url=d["url"],[0m
[30;1m335 | [0m[35m            local_data_path=d["local_data_path"],[0m
[30;1m336 | [0m[35m            name=d.get("name"),[0m
[30;1m337 | [0m[35m            backend=d.get("backend", DEFAULT_BLOB_BACKEND),[0m
[30;1m338 | [0m[35m        )[0m
[30;1m339 | [0m[35m        return item[0m
[30;1m340 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m579[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m333 | [0m[35m        item = ExternalDataItem([0m
[30;1m334 | [0m[35m            url=d["url"],[0m
[30;1m335 | [0m[35m            local_data_path=d["local_data_path"],[0m
[30;1m336 | [0m[35m            name=d.get("name"),[0m
[30;1m337 | [0m[35m            backend=d.get("backend", DEFAULT_BLOB_BACKEND),[0m
[30;1m338 | [0m[35m        )[0m
[30;1m339 | [0m[35m        return item[0m

[31m--[ [0m[34mMatch #[0m[33m580[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m324 | [0m[35m        url = d.get("url")[0m
[30;1m325 | [0m[35m        if url is None or url == "":[0m
[30;1m326 | [0m[35m            raise ValueError("URL of an external data item cannot be empty")[0m
[30;1m327 | [0m[35m        local_data_path = d.get("local_data_path")[0m
[30;1m328 | [0m[35m        if local_data_path is None or local_data_path == "":[0m
[30;1m329 | [0m[35m            raise ValueError([0m
[30;1m330 | [0m[35m                "The `local_data_path` field of an external data item cannot be empty"[0m

[31m--[ [0m[34mMatch #[0m[33m581[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m321 | [0m[35m[0m
[30;1m322 | [0m[35m    @staticmethod[0m
[30;1m323 | [0m[35m    def from_dict(d: Dict[str, str]) -> "ExternalDataItem":[0m
[30;1m324 | [0m[35m        url = d.get("url")[0m
[30;1m325 | [0m[35m        if url is None or url == "":[0m
[30;1m326 | [0m[35m            raise ValueError("URL of an external data item cannot be empty")[0m
[30;1m327 | [0m[35m        local_data_path = d.get("local_data_path")[0m

[31m--[ [0m[34mMatch #[0m[33m582[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m278 | [0m[35m[0m
[30;1m279 | [0m[35m        # only add node_count if not None. This helps keep[0m
[30;1m280 | [0m[35m        # config generated by truss init concise.[0m
[30;1m281 | [0m[35m        node_count = d.get("node_count")[0m
[30;1m282 | [0m[35m        validate_node_count(node_count)[0m
[30;1m283 | [0m[35m        r.node_count = node_count[0m
[30;1m284 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m583[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m270 | [0m[35m        memory = d.get("memory", DEFAULT_MEMORY)[0m
[30;1m271 | [0m[35m        validate_memory_spec(memory)[0m
[30;1m272 | [0m[35m        accelerator = AcceleratorSpec.from_str((d.get("accelerator", None)))[0m
[30;1m273 | [0m[35m        use_gpu = d.get("use_gpu", DEFAULT_USE_GPU)[0m
[30;1m274 | [0m[35m        if accelerator.accelerator is not None:[0m
[30;1m275 | [0m[35m            use_gpu = True[0m
[30;1m276 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m584[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m269 | [0m[35m        validate_cpu_spec(cpu)[0m
[30;1m270 | [0m[35m        memory = d.get("memory", DEFAULT_MEMORY)[0m
[30;1m271 | [0m[35m        validate_memory_spec(memory)[0m
[30;1m272 | [0m[35m        accelerator = AcceleratorSpec.from_str((d.get("accelerator", None)))[0m
[30;1m273 | [0m[35m        use_gpu = d.get("use_gpu", DEFAULT_USE_GPU)[0m
[30;1m274 | [0m[35m        if accelerator.accelerator is not None:[0m
[30;1m275 | [0m[35m            use_gpu = True[0m

[31m--[ [0m[34mMatch #[0m[33m585[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m267 | [0m[35m    def from_dict(d):[0m
[30;1m268 | [0m[35m        cpu = d.get("cpu", DEFAULT_CPU)[0m
[30;1m269 | [0m[35m        validate_cpu_spec(cpu)[0m
[30;1m270 | [0m[35m        memory = d.get("memory", DEFAULT_MEMORY)[0m
[30;1m271 | [0m[35m        validate_memory_spec(memory)[0m
[30;1m272 | [0m[35m        accelerator = AcceleratorSpec.from_str((d.get("accelerator", None)))[0m
[30;1m273 | [0m[35m        use_gpu = d.get("use_gpu", DEFAULT_USE_GPU)[0m

[31m--[ [0m[34mMatch #[0m[33m586[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35m    @staticmethod[0m
[30;1m267 | [0m[35m    def from_dict(d):[0m
[30;1m268 | [0m[35m        cpu = d.get("cpu", DEFAULT_CPU)[0m
[30;1m269 | [0m[35m        validate_cpu_spec(cpu)[0m
[30;1m270 | [0m[35m        memory = d.get("memory", DEFAULT_MEMORY)[0m
[30;1m271 | [0m[35m        validate_memory_spec(memory)[0m

[31m--[ [0m[34mMatch #[0m[33m587[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m238 | [0m[35m    def from_dict(d):[0m
[30;1m239 | [0m[35m        model_server = ModelServer[d.get("model_server", "TrussServer")][0m
[30;1m240 | [0m[35m        arguments = d.get("arguments", {})[0m
[30;1m241 | [0m[35m        secret_to_path_mapping = d.get("secret_to_path_mapping", {})[0m
[30;1m242 | [0m[35m        validate_secret_to_path_mapping(secret_to_path_mapping)[0m
[30;1m243 | [0m[35m        if not isinstance(secret_to_path_mapping, dict):[0m
[30;1m244 | [0m[35m            raise ValueError([0m

[31m--[ [0m[34mMatch #[0m[33m588[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m237 | [0m[35m    @staticmethod[0m
[30;1m238 | [0m[35m    def from_dict(d):[0m
[30;1m239 | [0m[35m        model_server = ModelServer[d.get("model_server", "TrussServer")][0m
[30;1m240 | [0m[35m        arguments = d.get("arguments", {})[0m
[30;1m241 | [0m[35m        secret_to_path_mapping = d.get("secret_to_path_mapping", {})[0m
[30;1m242 | [0m[35m        validate_secret_to_path_mapping(secret_to_path_mapping)[0m
[30;1m243 | [0m[35m        if not isinstance(secret_to_path_mapping, dict):[0m

[31m--[ [0m[34mMatch #[0m[33m589[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m236 | [0m[35m[0m
[30;1m237 | [0m[35m    @staticmethod[0m
[30;1m238 | [0m[35m    def from_dict(d):[0m
[30;1m239 | [0m[35m        model_server = ModelServer[d.get("model_server", "TrussServer")][0m
[30;1m240 | [0m[35m        arguments = d.get("arguments", {})[0m
[30;1m241 | [0m[35m        secret_to_path_mapping = d.get("secret_to_path_mapping", {})[0m
[30;1m242 | [0m[35m        validate_secret_to_path_mapping(secret_to_path_mapping)[0m

[31m--[ [0m[34mMatch #[0m[33m590[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m199 | [0m[35m            "streaming_read_timeout", DEFAULT_STREAMING_RESPONSE_READ_TIMEOUT[0m
[30;1m200 | [0m[35m        )[0m
[30;1m201 | [0m[35m        enable_tracing_data = d.get("enable_tracing_data", DEFAULT_ENABLE_TRACING_DATA)[0m
[30;1m202 | [0m[35m        health_checks = HealthChecks.from_dict(d.get("health_checks", {}))[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m        return Runtime([0m
[30;1m205 | [0m[35m            predict_concurrency=predict_concurrency,[0m

[31m--[ [0m[34mMatch #[0m[33m591[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m198 | [0m[35m        streaming_read_timeout = d.get([0m
[30;1m199 | [0m[35m            "streaming_read_timeout", DEFAULT_STREAMING_RESPONSE_READ_TIMEOUT[0m
[30;1m200 | [0m[35m        )[0m
[30;1m201 | [0m[35m        enable_tracing_data = d.get("enable_tracing_data", DEFAULT_ENABLE_TRACING_DATA)[0m
[30;1m202 | [0m[35m        health_checks = HealthChecks.from_dict(d.get("health_checks", {}))[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m        return Runtime([0m

[31m--[ [0m[34mMatch #[0m[33m592[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m195 | [0m[35m                "and as a last resort thread/process pools inside the "[0m
[30;1m196 | [0m[35m                "truss model."[0m
[30;1m197 | [0m[35m            )[0m
[30;1m198 | [0m[35m        streaming_read_timeout = d.get([0m
[30;1m199 | [0m[35m            "streaming_read_timeout", DEFAULT_STREAMING_RESPONSE_READ_TIMEOUT[0m
[30;1m200 | [0m[35m        )[0m
[30;1m201 | [0m[35m        enable_tracing_data = d.get("enable_tracing_data", DEFAULT_ENABLE_TRACING_DATA)[0m

[31m--[ [0m[34mMatch #[0m[33m593[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m187 | [0m[35m    @staticmethod[0m
[30;1m188 | [0m[35m    def from_dict(d):[0m
[30;1m189 | [0m[35m        predict_concurrency = d.get("predict_concurrency", DEFAULT_PREDICT_CONCURRENCY)[0m
[30;1m190 | [0m[35m        num_workers = d.get("num_workers", 1)[0m
[30;1m191 | [0m[35m        if num_workers != 1:[0m
[30;1m192 | [0m[35m            raise ValueError([0m
[30;1m193 | [0m[35m                "After truss 0.9.49 only 1 worker per server is allowed. "[0m

[31m--[ [0m[34mMatch #[0m[33m594[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m    @staticmethod[0m
[30;1m188 | [0m[35m    def from_dict(d):[0m
[30;1m189 | [0m[35m        predict_concurrency = d.get("predict_concurrency", DEFAULT_PREDICT_CONCURRENCY)[0m
[30;1m190 | [0m[35m        num_workers = d.get("num_workers", 1)[0m
[30;1m191 | [0m[35m        if num_workers != 1:[0m
[30;1m192 | [0m[35m            raise ValueError([0m

[31m--[ [0m[34mMatch #[0m[33m595[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m165 | [0m[35m        return HealthChecks([0m
[30;1m166 | [0m[35m            restart_check_delay_seconds=d.get("restart_check_delay_seconds"),[0m
[30;1m167 | [0m[35m            restart_threshold_seconds=d.get("restart_threshold_seconds"),[0m
[30;1m168 | [0m[35m            stop_traffic_threshold_seconds=d.get("stop_traffic_threshold_seconds"),[0m
[30;1m169 | [0m[35m        )[0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35m    def to_dict(self):[0m

[31m--[ [0m[34mMatch #[0m[33m596[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m164 | [0m[35m    def from_dict(d):[0m
[30;1m165 | [0m[35m        return HealthChecks([0m
[30;1m166 | [0m[35m            restart_check_delay_seconds=d.get("restart_check_delay_seconds"),[0m
[30;1m167 | [0m[35m            restart_threshold_seconds=d.get("restart_threshold_seconds"),[0m
[30;1m168 | [0m[35m            stop_traffic_threshold_seconds=d.get("stop_traffic_threshold_seconds"),[0m
[30;1m169 | [0m[35m        )[0m
[30;1m170 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m597[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m163 | [0m[35m    @staticmethod[0m
[30;1m164 | [0m[35m    def from_dict(d):[0m
[30;1m165 | [0m[35m        return HealthChecks([0m
[30;1m166 | [0m[35m            restart_check_delay_seconds=d.get("restart_check_delay_seconds"),[0m
[30;1m167 | [0m[35m            restart_threshold_seconds=d.get("restart_threshold_seconds"),[0m
[30;1m168 | [0m[35m            stop_traffic_threshold_seconds=d.get("stop_traffic_threshold_seconds"),[0m
[30;1m169 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m598[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m        revision = d.get("revision", None)[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m        allow_patterns = d.get("allow_patterns", None)[0m
[30;1m121 | [0m[35m        ignore_pattenrs = d.get("ignore_patterns", None)[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m        return ModelRepo([0m
[30;1m124 | [0m[35m            repo_id=repo_id,[0m

[31m--[ [0m[34mMatch #[0m[33m599[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m117 | [0m[35m            raise ValueError("Repo ID for Hugging Face model cannot be empty.")[0m
[30;1m118 | [0m[35m        revision = d.get("revision", None)[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m        allow_patterns = d.get("allow_patterns", None)[0m
[30;1m121 | [0m[35m        ignore_pattenrs = d.get("ignore_patterns", None)[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m        return ModelRepo([0m

[31m--[ [0m[34mMatch #[0m[33m600[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m115 | [0m[35m        repo_id = d.get("repo_id")[0m
[30;1m116 | [0m[35m        if repo_id is None or repo_id == "":[0m
[30;1m117 | [0m[35m            raise ValueError("Repo ID for Hugging Face model cannot be empty.")[0m
[30;1m118 | [0m[35m        revision = d.get("revision", None)[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m        allow_patterns = d.get("allow_patterns", None)[0m
[30;1m121 | [0m[35m        ignore_pattenrs = d.get("ignore_patterns", None)[0m

[31m--[ [0m[34mMatch #[0m[33m601[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m    @staticmethod[0m
[30;1m114 | [0m[35m    def from_dict(d):[0m
[30;1m115 | [0m[35m        repo_id = d.get("repo_id")[0m
[30;1m116 | [0m[35m        if repo_id is None or repo_id == "":[0m
[30;1m117 | [0m[35m            raise ValueError("Repo ID for Hugging Face model cannot be empty.")[0m
[30;1m118 | [0m[35m        revision = d.get("revision", None)[0m

[31m--[ [0m[34mMatch #[0m[33m602[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m379 | [0m[35m@dataclass[0m
[30;1m380 | [0m[35mclass DockerAuthSettings:[0m
[30;1m381 | [0m[35m    """[0m
[30;1m382 | [0m[35m    Provides information about how to authenticate to the docker registry containing[0m
[30;1m383 | [0m[35m    the custom base image.[0m
[30;1m384 | [0m[35m    """[0m
[30;1m385 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m603[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m700 | [0m[35m                logger.warning([0m
[30;1m701 | [0m[35m                    """Warning: `hf_cache` is deprecated in favor of `model_cache`.[0m
[30;1m702 | [0m[35m                    Everything will run as before, but if you are pulling weights from S3 or GCS, th[0m
[30;1m703 | [0m[35m                    stored at /app/model_cache instead of /app/hf_cache as before."""[0m
[30;1m704 | [0m[35m                )[0m
[30;1m705 | [0m[35m            return TrussConfig.from_dict(raw_data)[0m
[30;1m706 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m604[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m693 | [0m[35m    @staticmethod[0m
[30;1m694 | [0m[35m    def from_yaml(yaml_path: Path):[0m
[30;1m695 | [0m[35m        if not os.path.isfile(yaml_path):[0m
[30;1m696 | [0m[35m            raise ValueError(f"Expected a truss configuration file at {yaml_path}")[0m
[30;1m697 | [0m[35m        with yaml_path.open() as yaml_file:[0m
[30;1m698 | [0m[35m            raw_data = yaml.safe_load(yaml_file) or {}[0m
[30;1m699 | [0m[35m            if "hf_cache" in raw_data:[0m

[31m--[ [0m[34mMatch #[0m[33m605[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m543 | [0m[35m            documentation of the format.[0m
[30;1m544 | [0m[35m            </Warning>[0m
[30;1m545 | [0m[35m            A model may depend on certain secret values that can't be bundled with the model[0m
[30;1m546 | [0m[35m            and need to be bound securely at runtime. For example, a model may need to download[0m
[30;1m547 | [0m[35m            information from s3 and may need access to AWS credentials for that.[0m
[30;1m548 | [0m[35m            ```yaml[0m
[30;1m549 | [0m[35m            secrets:[0m

[31m--[ [0m[34mMatch #[0m[33m606[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m499 | [0m[35m            ```[0m
[30;1m500 | [0m[35m        model_metadata (Dict[str, str]):[0m
[30;1m501 | [0m[35m            Set any additional metadata in this catch-all field. The entire contents of the[0m
[30;1m502 | [0m[35m            config file are available to the model at runtime, so this is a good place to[0m
[30;1m503 | [0m[35m            store any custom information that model needs. For example, scikit-learn models[0m
[30;1m504 | [0m[35m            include a flag here that indicates whether the model supports returning[0m
[30;1m505 | [0m[35m            probabilities alongside predictions.[0m

[31m--[ [0m[34mMatch #[0m[33m607[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/truss_config.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m298 | [0m[35m[0m
[30;1m299 | [0m[35m@dataclass[0m
[30;1m300 | [0m[35mclass ExternalDataItem:[0m
[30;1m301 | [0m[35m    """A piece of remote data, to be made available to the Truss at serving time.[0m
[30;1m302 | [0m[35m[0m
[30;1m303 | [0m[35m    Remote data is downloaded and stored under Truss's data directory. Care should be taken[0m
[30;1m304 | [0m[35m    to avoid conflicts. This will get precedence if there's overlap.[0m

[31m--[ [0m[34mMatch #[0m[33m608[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/readme_str_example.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m```[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m### Adding pre/postprocessing code[0m
[30;1m43 | [0m[35mYou may find that you'd like to preprocess the inputs to your model or postprocess the outputs of yo[0m
[30;1m44 | [0m[35m1. Navigate to `model/model.py`. This is where your preprocessing/postprocessing logic will live.[0m
[30;1m45 | [0m[35m2. Define a `preprocess` or `postprocess` function as such.[0m
[30;1m46 | [0m[35m```[0m

[31m--[ [0m[34mMatch #[0m[33m609[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/readme_str_example.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m#### Via CURL[0m
[30;1m24 | [0m[35mIn order to run inference via CURL, we assume you've built and run the Docker image generated from y[0m
[30;1m25 | [0m[35m```[0m
[30;1m26 | [0m[35mcurl -H 'Content-Type: application/json' \[0m
[30;1m27 | [0m[35m-d '{'image_url': 'https://github.com/pytorch/hub/raw/master/images/dog.jpg'}' \[0m
[30;1m28 | [0m[35m-X POST http://localhost:8080/v1/models/model:predict[0m
[30;1m29 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m610[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/readme_str_example.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m```[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m#### Via CURL[0m
[30;1m24 | [0m[35mIn order to run inference via CURL, we assume you've built and run the Docker image generated from y[0m
[30;1m25 | [0m[35m```[0m
[30;1m26 | [0m[35mcurl -H 'Content-Type: application/json' \[0m
[30;1m27 | [0m[35m-d '{'image_url': 'https://github.com/pytorch/hub/raw/master/images/dog.jpg'}' \[0m

[31m--[ [0m[34mMatch #[0m[33m611[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/readme_str_example.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35mtruss predict --target_directory ./  --request '{'image_url': 'https://github.com/pytorch/hub/raw/ma[0m
[30;1m21 | [0m[35m```[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m#### Via CURL[0m
[30;1m24 | [0m[35mIn order to run inference via CURL, we assume you've built and run the Docker image generated from y[0m
[30;1m25 | [0m[35m```[0m
[30;1m26 | [0m[35mcurl -H 'Content-Type: application/json' \[0m
[30;1m27 | [0m[35m-d '{'image_url': 'https://github.com/pytorch/hub/raw/master/images/dog.jpg'}' \[0m

[31m--[ [0m[34mMatch #[0m[33m612[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/readme_str_example.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mtruss build-image[0m
[30;1m8 | [0m[35m```[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m### Run the Docker image from your Truss[0m
[30;1m11 | [0m[35m```[0m
[30;1m12 | [0m[35m# We assume you've built the image first.[0m
[30;1m13 | [0m[35mtruss run-image[0m

[31m--[ [0m[34mMatch #[0m[33m613[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/readme_str_example.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mWelcome to your custom model's Truss. Below are some useful commands to work with this Truss. For al[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35m### Build a Docker image from your Truss[0m
[30;1m6 | [0m[35m```[0m
[30;1m7 | [0m[35mtruss build-image[0m
[30;1m8 | [0m[35m```[0m

[31m--[ [0m[34mMatch #[0m[33m614[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/readme_str_example.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# Model how-to[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mWelcome to your custom model's Truss. Below are some useful commands to work with this Truss. For al[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35m### Build a Docker image from your Truss[0m
[30;1m6 | [0m[35m```[0m

[31m--[ [0m[34mMatch #[0m[33m615[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/contexts/image_builder/cache_warmer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m63 | [0m[35m        access_key_id=data["aws_access_key_id"],[0m
[30;1m64 | [0m[35m        secret_access_key=data["aws_secret_access_key"],[0m
[30;1m65 | [0m[35m        region=data["aws_region"],[0m
[30;1m66 | [0m[35m        session_token=data.get("aws_session_token", None),[0m
[30;1m67 | [0m[35m    )[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m    return aws_sa[0m

[31m--[ [0m[34mMatch #[0m[33m616[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/contexts/image_builder/cache_warmer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35mdef _b10cp_path() -> Optional[str]:[0m
[30;1m25 | [0m[35m    return os.environ.get(B10CP_PATH_TRUSS_ENV_VAR_NAME)[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35mdef _download_from_url_using_b10cp(b10cp_path: str, url: str, download_to: Path):[0m

[31m--[ [0m[34mMatch #[0m[33m617[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/contexts/image_builder/cache_warmer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m58 | [0m[35m    ):[0m
[30;1m59 | [0m[35m        raise ValueError("Invalid AWS credentials file")[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m    # create an AWS Service Account object[0m
[30;1m62 | [0m[35m    aws_sa = AWSCredentials([0m
[30;1m63 | [0m[35m        access_key_id=data["aws_access_key_id"],[0m
[30;1m64 | [0m[35m        secret_access_key=data["aws_secret_access_key"],[0m

[31m--[ [0m[34mMatch #[0m[33m618[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/contexts/image_builder/util.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mfrom truss import __version__[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m# This needs to be updated whenever we want to update[0m
[30;1m7 | [0m[35m# base images on a merge. Updating this version will cause[0m
[30;1m8 | [0m[35m# base images to be pushed with this tag.[0m
[30;1m9 | [0m[35mTRUSS_BASE_IMAGE_VERSION_TAG = "v0.9.0"[0m
[30;1m10 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m619[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000703[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Username[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/test_remote_factory.py[0m
   Pattern: [32m.userInfo[0m
[30;1m41 | [0m[35m    def sync_truss_to_dev_version_by_name(self, model_name: str, target_directory: str):[0m
[30;1m42 | [0m[35m        raise NotImplementedError[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m    def whoami(self) -> RemoteUser:[0m
[30;1m45 | [0m[35m        return RemoteUser("test_user", "test_email")[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m620[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/test_remote_factory.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m129 | [0m[35m)[0m
[30;1m130 | [0m[35m@mock.patch("pathlib.Path.exists", return_value=True)[0m
[30;1m131 | [0m[35mdef test_load_remote_config_no_params(mock_exists, mock_open):[0m
[30;1m132 | [0m[35m    service = RemoteFactory.load_remote_config("test")[0m
[30;1m133 | [0m[35m    with pytest.raises(ValueError):[0m
[30;1m134 | [0m[35m        RemoteFactory.validate_remote_config(service.configs, "test")[0m

[31m--[ [0m[34mMatch #[0m[33m621[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/test_remote_factory.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m118 | [0m[35m)[0m
[30;1m119 | [0m[35m@mock.patch("pathlib.Path.exists", return_value=True)[0m
[30;1m120 | [0m[35mdef test_validate_remote_config_no_remote(mock_exists, mock_open):[0m
[30;1m121 | [0m[35m    service = RemoteFactory.load_remote_config("test")[0m
[30;1m122 | [0m[35m    with pytest.raises(ValueError):[0m
[30;1m123 | [0m[35m        RemoteFactory.validate_remote_config(service.configs, "test")[0m
[30;1m124 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m622[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/test_remote_factory.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m85 | [0m[35m@mock.patch("builtins.open", new_callable=mock.mock_open, read_data=SAMPLE_TRUSSRC)[0m
[30;1m86 | [0m[35m@mock.patch("pathlib.Path.exists", return_value=True)[0m
[30;1m87 | [0m[35mdef test_load_remote_config(mock_exists, mock_open):[0m
[30;1m88 | [0m[35m    service = RemoteFactory.load_remote_config("test")[0m
[30;1m89 | [0m[35m    assert service.name == "test"[0m
[30;1m90 | [0m[35m    assert service.configs == {"remote_provider": "test_remote", **SAMPLE_CONFIG}[0m
[30;1m91 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m623[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/custom/model/model.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35m* `load`: runs exactly once when the model server is spun up or patched and loads the[0m
[30;1m7 | [0m[35m   model onto the model server. Include any logic for initializing your model, such[0m
[30;1m8 | [0m[35m   as downloading model weights and loading the model into memory.[0m
[30;1m9 | [0m[35m* `predict`: runs every time the model server is called. Include any logic for model[0m
[30;1m10 | [0m[35m  inference and return the model output.[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mSee https://truss.baseten.co/quickstart for more.[0m

[31m--[ [0m[34mMatch #[0m[33m624[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/util/env_vars.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    def __enter__(self):[0m
[30;1m24 | [0m[35m        for key in self.env_vars:[0m
[30;1m25 | [0m[35m            self.original_vars[key] = os.environ.get(key)[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m        for key, value in self.env_vars.items():[0m
[30;1m28 | [0m[35m            os.environ[key] = value[0m

[31m--[ [0m[34mMatch #[0m[33m625[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m96 | [0m[35m        # make sure that the inference server is stopeed when control server[0m
[30;1m97 | [0m[35m        # shuts down. Inference server has logic to wait until all requests are[0m
[30;1m98 | [0m[35m        # finished before exiting. By waiting on that, we inherit the same[0m
[30;1m99 | [0m[35m        # behavior for control server.[0m
[30;1m100 | [0m[35m        app.state.logger.info("Term signal received, shutting down.")[0m
[30;1m101 | [0m[35m        app.state.inference_server_process_controller.terminate_with_wait()[0m
[30;1m102 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m626[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/application.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m93 | [0m[35m    @app.on_event("shutdown")[0m
[30;1m94 | [0m[35m    def on_shutdown():[0m
[30;1m95 | [0m[35m        # FastApi handles the term signal to start the shutdown flow. Here we[0m
[30;1m96 | [0m[35m        # make sure that the inference server is stopeed when control server[0m
[30;1m97 | [0m[35m        # shuts down. Inference server has logic to wait until all requests are[0m
[30;1m98 | [0m[35m        # finished before exiting. By waiting on that, we inherit the same[0m
[30;1m99 | [0m[35m        # behavior for control server.[0m

[31m--[ [0m[34mMatch #[0m[33m627[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_docker.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport pytest[0m
[30;1m2 | [0m[35mfrom python_on_whales import docker[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mfrom truss.util.docker import get_urls_from_container[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m628[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/endpoints.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m132 | [0m[35m    return {"result": app_has_partially_applied_patch}[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m@control_app.post("/control/stop_inference_server")[0m
[30;1m136 | [0m[35masync def stop_inference_server(request: Request) -> Dict[str, str]:[0m
[30;1m137 | [0m[35m    request.app.state.inference_server_controller.stop()[0m
[30;1m138 | [0m[35m    return {"msg": "Inference server stopped successfully"}[0m

[31m--[ [0m[34mMatch #[0m[33m629[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/endpoints.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m    return {"msg": "Inference server started successfully"}[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m@control_app.get("/control/has_partially_applied_patch")[0m
[30;1m128 | [0m[35masync def has_partially_applied_patch(request: Request) -> Dict[str, Any]:[0m
[30;1m129 | [0m[35m    app_has_partially_applied_patch = ([0m
[30;1m130 | [0m[35m        request.app.state.inference_server_controller.has_partially_applied_patch()[0m

[31m--[ [0m[34mMatch #[0m[33m630[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/endpoints.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m117 | [0m[35m    return {"result": t_hash}[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m@control_app.post("/control/restart_inference_server")[0m
[30;1m121 | [0m[35masync def restart_inference_server(request: Request) -> Dict[str, str]:[0m
[30;1m122 | [0m[35m    request.app.state.inference_server_controller.restart()[0m
[30;1m123 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m631[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/endpoints.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m111 | [0m[35m    return {"msg": "Patch applied successfully"}[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m@control_app.get("/control/truss_hash")[0m
[30;1m115 | [0m[35masync def truss_hash(request: Request) -> Dict[str, Any]:[0m
[30;1m116 | [0m[35m    t_hash = request.app.state.inference_server_controller.truss_hash()[0m
[30;1m117 | [0m[35m    return {"result": t_hash}[0m

[31m--[ [0m[34mMatch #[0m[33m632[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/endpoints.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m96 | [0m[35mcontrol_app.add_route("/v1/{path:path}", proxy, ["GET", "POST"])[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m@control_app.post("/control/patch")[0m
[30;1m100 | [0m[35masync def patch(request: Request) -> Dict[str, str]:[0m
[30;1m101 | [0m[35m    request.app.state.logger.info("Patch request received.")[0m
[30;1m102 | [0m[35m    patch_request = await request.json()[0m

[31m--[ [0m[34mMatch #[0m[33m633[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/endpoints.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m15 | [0m[35mcontrol_app = APIRouter()[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m@control_app.get("/")[0m
[30;1m19 | [0m[35mdef index():[0m
[30;1m20 | [0m[35m    return {}[0m
[30;1m21 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m634[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/endpoints.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    # 2 min connect timeouts, no timeout for requests.[0m
[30;1m33 | [0m[35m    # We don't want requests to fail due to timeout on the proxy[0m
[30;1m34 | [0m[35m    timeout = httpx.Timeout(None, connect=2 * 60.0)[0m
[30;1m35 | [0m[35m    try:[0m
[30;1m36 | [0m[35m        request_body = await request.body()[0m
[30;1m37 | [0m[35m    except ClientDisconnect:[0m

[31m--[ [0m[34mMatch #[0m[33m635[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/endpoints.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35m    url = URL(path=path, query=request.url.query.encode("utf-8"))[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    # 2 min connect timeouts, no timeout for requests.[0m
[30;1m33 | [0m[35m    # We don't want requests to fail due to timeout on the proxy[0m
[30;1m34 | [0m[35m    timeout = httpx.Timeout(None, connect=2 * 60.0)[0m
[30;1m35 | [0m[35m    try:[0m
[30;1m36 | [0m[35m        request_body = await request.body()[0m

[31m--[ [0m[34mMatch #[0m[33m636[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/endpoints.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35m    path = _reroute_if_health_check(request.url.path)[0m
[30;1m30 | [0m[35m    url = URL(path=path, query=request.url.query.encode("utf-8"))[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    # 2 min connect timeouts, no timeout for requests.[0m
[30;1m33 | [0m[35m    # We don't want requests to fail due to timeout on the proxy[0m
[30;1m34 | [0m[35m    timeout = httpx.Timeout(None, connect=2 * 60.0)[0m
[30;1m35 | [0m[35m    try:[0m

[31m--[ [0m[34mMatch #[0m[33m637[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_util.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35mdef test_download_into_nested_subdir(tmp_path):[0m
[30;1m28 | [0m[35m    mocked_download_content = b"mocked content"[0m
[30;1m29 | [0m[35m    with patch.dict(os.environ, {}), requests_mock.Mocker() as m:[0m
[30;1m30 | [0m[35m        m.get(TEST_DOWNLOAD_URL, content=mocked_download_content)[0m
[30;1m31 | [0m[35m        external_data = ExternalData.from_list([0m
[30;1m32 | [0m[35m            [{"local_data_path": "foo/bar/baz", "url": TEST_DOWNLOAD_URL}][0m
[30;1m33 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m638[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_util.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m12 | [0m[35mdef test_download(tmp_path):[0m
[30;1m13 | [0m[35m    mocked_download_content = b"mocked content"[0m
[30;1m14 | [0m[35m    with patch.dict(os.environ, {}), requests_mock.Mocker() as m:[0m
[30;1m15 | [0m[35m        m.get(TEST_DOWNLOAD_URL, content=mocked_download_content)[0m
[30;1m16 | [0m[35m        external_data = ExternalData.from_list([0m
[30;1m17 | [0m[35m            [{"local_data_path": "foo", "url": TEST_DOWNLOAD_URL}][0m
[30;1m18 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m639[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/baseten/test_remote.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m673 | [0m[35m        }[0m
[30;1m674 | [0m[35m    }[0m
[30;1m675 | [0m[35m    with requests_mock.Mocker() as m:[0m
[30;1m676 | [0m[35m        m.post(_TEST_REMOTE_GRAPHQL_PATH, json=model_response)[0m
[30;1m677 | [0m[35m        th = TrussHandle(custom_model_truss_dir_with_pre_and_post)[0m
[30;1m678 | [0m[35m[0m
[30;1m679 | [0m[35m        with pytest.raises([0m

[31m--[ [0m[34mMatch #[0m[33m640[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/baseten/test_remote.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m562 | [0m[35m    remote = BasetenRemote(_TEST_REMOTE_URL, "api_key")[0m
[30;1m563 | [0m[35m[0m
[30;1m564 | [0m[35m    with requests_mock.Mocker() as m:[0m
[30;1m565 | [0m[35m        m.post([0m
[30;1m566 | [0m[35m            _TEST_REMOTE_GRAPHQL_PATH,[0m
[30;1m567 | [0m[35m            [[0m
[30;1m568 | [0m[35m                {[0m

[31m--[ [0m[34mMatch #[0m[33m641[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/baseten/test_remote.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m459 | [0m[35m    remote = BasetenRemote(_TEST_REMOTE_URL, "api_key")[0m
[30;1m460 | [0m[35m[0m
[30;1m461 | [0m[35m    with requests_mock.Mocker() as m:[0m
[30;1m462 | [0m[35m        m.post([0m
[30;1m463 | [0m[35m            _TEST_REMOTE_GRAPHQL_PATH,[0m
[30;1m464 | [0m[35m            [[0m
[30;1m465 | [0m[35m                {[0m

[31m--[ [0m[34mMatch #[0m[33m642[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/baseten/test_remote.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m365 | [0m[35m    remote = BasetenRemote(_TEST_REMOTE_URL, "api_key")[0m
[30;1m366 | [0m[35m[0m
[30;1m367 | [0m[35m    with requests_mock.Mocker() as m:[0m
[30;1m368 | [0m[35m        m.post([0m
[30;1m369 | [0m[35m            _TEST_REMOTE_GRAPHQL_PATH,[0m
[30;1m370 | [0m[35m            [[0m
[30;1m371 | [0m[35m                {"json": {"data": {"chains": []}}},[0m

[31m--[ [0m[34mMatch #[0m[33m643[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/baseten/test_remote.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m269 | [0m[35m    remote = BasetenRemote(_TEST_REMOTE_URL, "api_key")[0m
[30;1m270 | [0m[35m[0m
[30;1m271 | [0m[35m    with requests_mock.Mocker() as m:[0m
[30;1m272 | [0m[35m        m.post([0m
[30;1m273 | [0m[35m            _TEST_REMOTE_GRAPHQL_PATH,[0m
[30;1m274 | [0m[35m            [[0m
[30;1m275 | [0m[35m                {"json": {"data": {"chains": []}}},[0m

[31m--[ [0m[34mMatch #[0m[33m644[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/baseten/test_remote.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m248 | [0m[35m        }[0m
[30;1m249 | [0m[35m    }[0m
[30;1m250 | [0m[35m    with requests_mock.Mocker() as m:[0m
[30;1m251 | [0m[35m        m.post(_TEST_REMOTE_GRAPHQL_PATH, json=model_response)[0m
[30;1m252 | [0m[35m        th = TrussHandle(custom_model_truss_dir_with_pre_and_post)[0m
[30;1m253 | [0m[35m[0m
[30;1m254 | [0m[35m        with pytest.raises([0m

[31m--[ [0m[34mMatch #[0m[33m645[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/baseten/test_remote.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m216 | [0m[35m        }[0m
[30;1m217 | [0m[35m    }[0m
[30;1m218 | [0m[35m    with requests_mock.Mocker() as m:[0m
[30;1m219 | [0m[35m        m.post(_TEST_REMOTE_GRAPHQL_PATH, json=model_response)[0m
[30;1m220 | [0m[35m        th = TrussHandle(custom_model_truss_dir_with_pre_and_post)[0m
[30;1m221 | [0m[35m[0m
[30;1m222 | [0m[35m        with pytest.raises([0m

[31m--[ [0m[34mMatch #[0m[33m646[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/baseten/test_remote.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m184 | [0m[35m        }[0m
[30;1m185 | [0m[35m    }[0m
[30;1m186 | [0m[35m    with requests_mock.Mocker() as m:[0m
[30;1m187 | [0m[35m        m.post(_TEST_REMOTE_GRAPHQL_PATH, json=model_response)[0m
[30;1m188 | [0m[35m        th = TrussHandle(custom_model_truss_dir_with_pre_and_post)[0m
[30;1m189 | [0m[35m[0m
[30;1m190 | [0m[35m        with pytest.raises([0m

[31m--[ [0m[34mMatch #[0m[33m647[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/baseten/test_remote.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m165 | [0m[35m    remote = BasetenRemote(_TEST_REMOTE_URL, "api_key")[0m
[30;1m166 | [0m[35m    model_response = {"errors": [{"message": "error"}]}[0m
[30;1m167 | [0m[35m    with requests_mock.Mocker() as m:[0m
[30;1m168 | [0m[35m        m.post(_TEST_REMOTE_GRAPHQL_PATH, json=model_response)[0m
[30;1m169 | [0m[35m        with pytest.raises(RemoteError):[0m
[30;1m170 | [0m[35m            remote.get_service(model_identifier=ModelId("model_id"))[0m
[30;1m171 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m648[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/baseten/test_remote.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m154 | [0m[35m    }[0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35m    with requests_mock.Mocker() as m:[0m
[30;1m157 | [0m[35m        m.post(_TEST_REMOTE_GRAPHQL_PATH, json=model_response)[0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35m        service = remote.get_service(model_identifier=ModelId("model_id"))[0m
[30;1m160 | [0m[35m        assert service.model_id == "model_id"[0m

[31m--[ [0m[34mMatch #[0m[33m649[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/baseten/test_remote.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m125 | [0m[35m    }[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m    with requests_mock.Mocker() as m:[0m
[30;1m128 | [0m[35m        m.post(_TEST_REMOTE_GRAPHQL_PATH, json=model_response)[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m        # Since no production version exists, calling get_service with[0m
[30;1m131 | [0m[35m        # published=True should raise an error.[0m

[31m--[ [0m[34mMatch #[0m[33m650[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/baseten/test_remote.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m97 | [0m[35m    }[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m    with requests_mock.Mocker() as m:[0m
[30;1m100 | [0m[35m        m.post(_TEST_REMOTE_GRAPHQL_PATH, json=model_response)[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m        # Check that the production version is returned when published is True.[0m
[30;1m103 | [0m[35m        service = remote.get_service([0m

[31m--[ [0m[34mMatch #[0m[33m651[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/baseten/test_remote.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m69 | [0m[35m    }[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m    with requests_mock.Mocker() as m:[0m
[30;1m72 | [0m[35m        m.post(_TEST_REMOTE_GRAPHQL_PATH, json=model_response)[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m        # Check that the production version is returned when published is True.[0m
[30;1m75 | [0m[35m        service = remote.get_service([0m

[31m--[ [0m[34mMatch #[0m[33m652[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/baseten/test_remote.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m    remote = BasetenRemote(_TEST_REMOTE_URL, "api_key")[0m
[30;1m50 | [0m[35m    model_version_response = {"errors": [{"message": "error"}]}[0m
[30;1m51 | [0m[35m    with requests_mock.Mocker() as m:[0m
[30;1m52 | [0m[35m        m.post(_TEST_REMOTE_GRAPHQL_PATH, json=model_version_response)[0m
[30;1m53 | [0m[35m        with pytest.raises(RemoteError):[0m
[30;1m54 | [0m[35m            remote.get_service(model_identifier=ModelVersionId("version_id"))[0m
[30;1m55 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m653[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/baseten/test_remote.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m38 | [0m[35m    model_version_response = {"data": {"model_version": version}}[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m    with requests_mock.Mocker() as m:[0m
[30;1m41 | [0m[35m        m.post(_TEST_REMOTE_GRAPHQL_PATH, json=model_version_response)[0m
[30;1m42 | [0m[35m        service = remote.get_service(model_identifier=ModelVersionId("version_id"))[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m    assert service.model_id == "model_id"[0m

[31m--[ [0m[34mMatch #[0m[33m654[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/baseten/test_remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m156 | [0m[35m    with requests_mock.Mocker() as m:[0m
[30;1m157 | [0m[35m        m.post(_TEST_REMOTE_GRAPHQL_PATH, json=model_response)[0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35m        service = remote.get_service(model_identifier=ModelId("model_id"))[0m
[30;1m160 | [0m[35m        assert service.model_id == "model_id"[0m
[30;1m161 | [0m[35m        assert service.model_version_id == "version_id"[0m
[30;1m162 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m655[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/baseten/test_remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m133 | [0m[35m            remote.get_service(model_identifier=ModelName("model_name"), published=True)[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m        # Check that the development version is returned when published is False.[0m
[30;1m136 | [0m[35m        service = remote.get_service([0m
[30;1m137 | [0m[35m            model_identifier=ModelName("model_name"), published=False[0m
[30;1m138 | [0m[35m        )[0m
[30;1m139 | [0m[35m        assert service.model_id == "model_id"[0m

[31m--[ [0m[34mMatch #[0m[33m656[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/baseten/test_remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m100 | [0m[35m        m.post(_TEST_REMOTE_GRAPHQL_PATH, json=model_response)[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m        # Check that the production version is returned when published is True.[0m
[30;1m103 | [0m[35m        service = remote.get_service([0m
[30;1m104 | [0m[35m            model_identifier=ModelName("model_name"), published=True[0m
[30;1m105 | [0m[35m        )[0m
[30;1m106 | [0m[35m        assert service.model_id == "model_id"[0m

[31m--[ [0m[34mMatch #[0m[33m657[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/baseten/test_remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m79 | [0m[35m        assert service.model_version_id == "2"[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m        # Check that the development version is returned when published is False.[0m
[30;1m82 | [0m[35m        service = remote.get_service([0m
[30;1m83 | [0m[35m            model_identifier=ModelName("model_name"), published=False[0m
[30;1m84 | [0m[35m        )[0m
[30;1m85 | [0m[35m        assert service.model_id == "model_id"[0m

[31m--[ [0m[34mMatch #[0m[33m658[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/baseten/test_remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m72 | [0m[35m        m.post(_TEST_REMOTE_GRAPHQL_PATH, json=model_response)[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m        # Check that the production version is returned when published is True.[0m
[30;1m75 | [0m[35m        service = remote.get_service([0m
[30;1m76 | [0m[35m            model_identifier=ModelName("model_name"), published=True[0m
[30;1m77 | [0m[35m        )[0m
[30;1m78 | [0m[35m        assert service.model_id == "model_id"[0m

[31m--[ [0m[34mMatch #[0m[33m659[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/baseten/test_remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m    with requests_mock.Mocker() as m:[0m
[30;1m41 | [0m[35m        m.post(_TEST_REMOTE_GRAPHQL_PATH, json=model_version_response)[0m
[30;1m42 | [0m[35m        service = remote.get_service(model_identifier=ModelVersionId("version_id"))[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m    assert service.model_id == "model_id"[0m
[30;1m45 | [0m[35m    assert service.model_version_id == "version_id"[0m

[31m--[ [0m[34mMatch #[0m[33m660[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/truss_gatherer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m37 | [0m[35m    for path in handle.spec.external_package_dirs_paths:[0m
[30;1m38 | [0m[35m        if not path.is_dir():[0m
[30;1m39 | [0m[35m            raise ValueError([0m
[30;1m40 | [0m[35m                f"External packages directory at {path} is not a directory"[0m
[30;1m41 | [0m[35m            )[0m
[30;1m42 | [0m[35m        # We copy over contents of the external package directory, not the[0m
[30;1m43 | [0m[35m        # directory itself. This mimics the local load behavior and is meant to[0m

[31m--[ [0m[34mMatch #[0m[33m661[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/test_truss_remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m@mock.patch("requests.request", return_value=mock_successful_response())[0m
[30;1m88 | [0m[35mdef test_predict_no_data(mock_request):[0m
[30;1m89 | [0m[35m    service = TrussTestService(TEST_SERVICE_URL, True)[0m
[30;1m90 | [0m[35m    with pytest.raises(ValueError):[0m
[30;1m91 | [0m[35m        service._send_request(TEST_SERVICE_URL, "POST")[0m

[31m--[ [0m[34mMatch #[0m[33m662[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/test_truss_remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m@mock.patch("requests.request", return_value=mock_successful_response())[0m
[30;1m81 | [0m[35mdef test_predict(mock_request):[0m
[30;1m82 | [0m[35m    service = TrussTestService(TEST_SERVICE_URL, True)[0m
[30;1m83 | [0m[35m    response = service.predict({"model_input": "test"})[0m
[30;1m84 | [0m[35m    assert response.status_code == 200[0m
[30;1m85 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m663[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/test_truss_remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m@mock.patch("requests.request", return_value=mock_unsuccessful_response())[0m
[30;1m75 | [0m[35mdef test_is_not_ready(mock_request):[0m
[30;1m76 | [0m[35m    service = TrussTestService(TEST_SERVICE_URL, True)[0m
[30;1m77 | [0m[35m    assert service.is_ready() is False[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m664[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/test_truss_remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m@mock.patch("requests.request", return_value=mock_successful_response())[0m
[30;1m69 | [0m[35mdef test_is_ready(mock_request):[0m
[30;1m70 | [0m[35m    service = TrussTestService(TEST_SERVICE_URL, True)[0m
[30;1m71 | [0m[35m    assert service.is_ready()[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m665[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/test_truss_remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m@mock.patch("requests.request", return_value=mock_unsuccessful_response())[0m
[30;1m63 | [0m[35mdef test_is_not_live(mock_request):[0m
[30;1m64 | [0m[35m    service = TrussTestService(TEST_SERVICE_URL, True)[0m
[30;1m65 | [0m[35m    assert service.is_live() is False[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m666[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/remote/test_truss_remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m@mock.patch("requests.request", return_value=mock_successful_response())[0m
[30;1m57 | [0m[35mdef test_is_live(mock_request):[0m
[30;1m58 | [0m[35m    service = TrussTestService(TEST_SERVICE_URL, True)[0m
[30;1m59 | [0m[35m    assert service.is_live()[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m667[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/base/constants.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m66 | [0m[35mDOCKERFILE = "Dockerfile"[0m
[30;1m67 | [0m[35m# Used to indicate whether to associate a container with Truss[0m
[30;1m68 | [0m[35mTRUSS = "truss"[0m
[30;1m69 | [0m[35m# Used to create unique identifier based on last time truss was updated[0m
[30;1m70 | [0m[35mTRUSS_MODIFIED_TIME = "truss_modified_time"[0m
[30;1m71 | [0m[35m# Path of the Truss used to identify which Truss is being referred[0m
[30;1m72 | [0m[35mTRUSS_DIR = "truss_dir"[0m

[31m--[ [0m[34mMatch #[0m[33m668[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000703[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Username[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/api/__init__.py[0m
   Pattern: [32m.userInfo[0m
[30;1m47 | [0m[35m            )[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m    remote_provider = RemoteFactory.create(remote=remote)[0m
[30;1m50 | [0m[35m    return remote_provider.whoami()[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35mdef push([0m

[31m--[ [0m[34mMatch #[0m[33m669[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000703[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Username[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/api/__init__.py[0m
   Pattern: [32m.userInfo[0m
[30;1m29 | [0m[35m    RemoteFactory.update_remote_config(remote_config)[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35mdef whoami(remote: Optional[str] = None):[0m
[30;1m33 | [0m[35m    """[0m
[30;1m34 | [0m[35m    Returns account information for the current user.[0m
[30;1m35 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m670[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/api/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m108 | [0m[35m            "No model name provided. Please specify a model name in config.yaml."[0m
[30;1m109 | [0m[35m        )[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m    service = remote_provider.push([0m
[30;1m112 | [0m[35m        tr,[0m
[30;1m113 | [0m[35m        model_name=model_name,[0m
[30;1m114 | [0m[35m        publish=publish,[0m

[31m--[ [0m[34mMatch #[0m[33m671[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/readme_no_example.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m43 | [0m[35m```[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m### Adding pre/postprocessing code[0m
[30;1m46 | [0m[35mYou may find that you'd like to preprocess the inputs to your model or postprocess the outputs of yo[0m
[30;1m47 | [0m[35m1. Navigate to `model/model.py`. This is where your preprocessing/postprocessing logic will live.[0m
[30;1m48 | [0m[35m2. Define a `preprocess` or `postprocess` function as such.[0m
[30;1m49 | [0m[35m```[0m

[31m--[ [0m[34mMatch #[0m[33m672[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/readme_no_example.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m#### Via CURL[0m
[30;1m25 | [0m[35mIn order to run inference via CURL, we assume you've built and run the Docker image generated from y[0m
[30;1m26 | [0m[35m```[0m
[30;1m27 | [0m[35mcurl -H 'Content-Type: application/json' \[0m
[30;1m28 | [0m[35m-d 'YOUR_INPUT' \[0m
[30;1m29 | [0m[35m-X POST http://localhost:8080/v1/models/model:predict[0m
[30;1m30 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m673[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/readme_no_example.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m```[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m#### Via CURL[0m
[30;1m25 | [0m[35mIn order to run inference via CURL, we assume you've built and run the Docker image generated from y[0m
[30;1m26 | [0m[35m```[0m
[30;1m27 | [0m[35mcurl -H 'Content-Type: application/json' \[0m
[30;1m28 | [0m[35m-d 'YOUR_INPUT' \[0m

[31m--[ [0m[34mMatch #[0m[33m674[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/readme_no_example.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m```[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m#### Via CURL[0m
[30;1m25 | [0m[35mIn order to run inference via CURL, we assume you've built and run the Docker image generated from y[0m
[30;1m26 | [0m[35m```[0m
[30;1m27 | [0m[35mcurl -H 'Content-Type: application/json' \[0m
[30;1m28 | [0m[35m-d 'YOUR_INPUT' \[0m

[31m--[ [0m[34mMatch #[0m[33m675[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/readme_no_example.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mtruss build-image[0m
[30;1m8 | [0m[35m```[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m### Run the Docker image from your Truss[0m
[30;1m11 | [0m[35m```[0m
[30;1m12 | [0m[35m# We assume you've built the image first.[0m
[30;1m13 | [0m[35mtruss run-image[0m

[31m--[ [0m[34mMatch #[0m[33m676[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/readme_no_example.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mWelcome to your custom model's Truss. Below are some useful commands to work with this Truss. For al[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35m### Build a Docker image from your Truss[0m
[30;1m6 | [0m[35m```[0m
[30;1m7 | [0m[35mtruss build-image[0m
[30;1m8 | [0m[35m```[0m

[31m--[ [0m[34mMatch #[0m[33m677[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/readme_no_example.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# Model how-to[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mWelcome to your custom model's Truss. Below are some useful commands to work with this Truss. For al[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35m### Build a Docker image from your Truss[0m
[30;1m6 | [0m[35m```[0m

[31m--[ [0m[34mMatch #[0m[33m678[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_custom_server_truss/test_docker_image/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m14 | [0m[35masync def root():[0m
[30;1m15 | [0m[35m    return {[0m
[30;1m16 | [0m[35m        "message": "Hello World",[0m
[30;1m17 | [0m[35m        "is_env_var_passed": os.environ.get("HF_TOKEN") is not None,[0m
[30;1m18 | [0m[35m        "is_secret_mounted": os.path.exists("/secrets/hf_access_token"),[0m
[30;1m19 | [0m[35m    }[0m

[31m--[ [0m[34mMatch #[0m[33m679[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_custom_server_truss/test_docker_image/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m10 | [0m[35m    return {"message": "OK"}[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m@app.post("/predict")[0m
[30;1m14 | [0m[35masync def root():[0m
[30;1m15 | [0m[35m    return {[0m
[30;1m16 | [0m[35m        "message": "Hello World",[0m

[31m--[ [0m[34mMatch #[0m[33m680[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_custom_server_truss/test_docker_image/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m5 | [0m[35mapp = FastAPI()[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m@app.get("/health")[0m
[30;1m9 | [0m[35masync def health():[0m
[30;1m10 | [0m[35m    return {"message": "OK"}[0m
[30;1m11 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m681[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/util/.truss_ignore[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35m# PyCharm[0m
[30;1m157 | [0m[35m#  JetBrains specific template is maintained in a separate JetBrains.gitignore that can[0m
[30;1m158 | [0m[35m#  be found at https://github.com/github/gitignore/blob/main/Global/JetBrains.gitignore[0m
[30;1m159 | [0m[35m#  and can be added to the global gitignore or merged into this file.  For a more nuclear[0m
[30;1m160 | [0m[35m#  option (not recommended) you can uncomment the following to ignore the entire idea folder.[0m
[30;1m161 | [0m[35m#.idea/[0m

[31m--[ [0m[34mMatch #[0m[33m682[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/util/.truss_ignore[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m160 | [0m[35m#  option (not recommended) you can uncomment the following to ignore the entire idea folder.[0m
[30;1m161 | [0m[35m#.idea/[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m# Git[0m
[30;1m164 | [0m[35m.git[0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35m# temp files[0m
[30;1m167 | [0m[35m*.tmp[0m

[31m--[ [0m[34mMatch #[0m[33m683[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/util/.truss_ignore[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m28 | [0m[35m.DS_Store[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m# PyInstaller[0m
[30;1m31 | [0m[35m#  Usually these files are written by a python script from a template[0m
[30;1m32 | [0m[35m#  before PyInstaller builds the exe, so as to inject date/other infos into it.[0m
[30;1m33 | [0m[35m*.manifest[0m
[30;1m34 | [0m[35m*.spec[0m

[31m--[ [0m[34mMatch #[0m[33m684[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/util/test_path.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport os[0m
[30;1m2 | [0m[35mimport tempfile[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mfrom pathlib import Path[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom truss.contexts.image_builder.serving_image_builder import ([0m
[30;1m7 | [0m[35m    ServingImageBuilderContext,[0m

[31m--[ [0m[34mMatch #[0m[33m685[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m422 | [0m[35m    valid_config = api.validate_truss(truss.version(), config)[0m
[30;1m423 | [0m[35m    if not valid_config.get("success"):[0m
[30;1m424 | [0m[35m        details = json.loads(valid_config.get("details"))[0m
[30;1m425 | [0m[35m        errors = details.get("errors", [])[0m
[30;1m426 | [0m[35m        if errors:[0m
[30;1m427 | [0m[35m            error_messages = "\n".join(textwrap.indent(error, "  ") for error in errors)[0m
[30;1m428 | [0m[35m            raise ValidationError([0m

[31m--[ [0m[34mMatch #[0m[33m686[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m421 | [0m[35m    """[0m
[30;1m422 | [0m[35m    valid_config = api.validate_truss(truss.version(), config)[0m
[30;1m423 | [0m[35m    if not valid_config.get("success"):[0m
[30;1m424 | [0m[35m        details = json.loads(valid_config.get("details"))[0m
[30;1m425 | [0m[35m        errors = details.get("errors", [])[0m
[30;1m426 | [0m[35m        if errors:[0m
[30;1m427 | [0m[35m            error_messages = "\n".join(textwrap.indent(error, "  ") for error in errors)[0m

[31m--[ [0m[34mMatch #[0m[33m687[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m420 | [0m[35m        None if the config is valid, otherwise raises an error message[0m
[30;1m421 | [0m[35m    """[0m
[30;1m422 | [0m[35m    valid_config = api.validate_truss(truss.version(), config)[0m
[30;1m423 | [0m[35m    if not valid_config.get("success"):[0m
[30;1m424 | [0m[35m        details = json.loads(valid_config.get("details"))[0m
[30;1m425 | [0m[35m        errors = details.get("errors", [])[0m
[30;1m426 | [0m[35m        if errors:[0m

[31m--[ [0m[34mMatch #[0m[33m688[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m    chains = api.get_chains()[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m    chain_name_id_mapping = {chain["name"]: chain["id"] for chain in chains}[0m
[30;1m88 | [0m[35m    return chain_name_id_mapping.get(chain_name)[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35mdef get_dev_chain_deployment(api: BasetenApi, chain_id: str):[0m

[31m--[ [0m[34mMatch #[0m[33m689[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m414 | [0m[35m[0m
[30;1m415 | [0m[35m    Args:[0m
[30;1m416 | [0m[35m        api: BasetenApi instance[0m
[30;1m417 | [0m[35m        config: Base64 encoded JSON string of the Truss config[0m
[30;1m418 | [0m[35m[0m
[30;1m419 | [0m[35m    Returns:[0m
[30;1m420 | [0m[35m        None if the config is valid, otherwise raises an error message[0m

[31m--[ [0m[34mMatch #[0m[33m690[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m342 | [0m[35m        api: BasetenApi instance.[0m
[30;1m343 | [0m[35m        model_name: Name of the model to create.[0m
[30;1m344 | [0m[35m        s3_key: S3 key of the uploaded TrussHandle.[0m
[30;1m345 | [0m[35m        config: Base64 encoded JSON string of the Truss config.[0m
[30;1m346 | [0m[35m        semver_bump: Semver bump type, defaults to "MINOR".[0m
[30;1m347 | [0m[35m        is_trusted: Whether the model is trusted, defaults to False.[0m
[30;1m348 | [0m[35m        promote: Whether to promote the model after deploy, defaults to False.[0m

[31m--[ [0m[34mMatch #[0m[33m691[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m276 | [0m[35m    """Archive a TrussHandle into a tar file.[0m
[30;1m277 | [0m[35m[0m
[30;1m278 | [0m[35m    Returns:[0m
[30;1m279 | [0m[35m        A file-like object containing the tar file[0m
[30;1m280 | [0m[35m    """[0m
[30;1m281 | [0m[35m    truss_dir = truss_handle._truss_dir[0m
[30;1m282 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m692[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m273 | [0m[35mdef archive_truss([0m
[30;1m274 | [0m[35m    truss_handle: TrussHandle, progress_bar: Optional[Type["progress.Progress"]][0m
[30;1m275 | [0m[35m) -> IO:[0m
[30;1m276 | [0m[35m    """Archive a TrussHandle into a tar file.[0m
[30;1m277 | [0m[35m[0m
[30;1m278 | [0m[35m    Returns:[0m
[30;1m279 | [0m[35m        A file-like object containing the tar file[0m

[31m--[ [0m[34mMatch #[0m[33m693[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/patch/test_calc_patch.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m322 | [0m[35m    )[0m
[30;1m323 | [0m[35m    assert len(patches) == 3[0m
[30;1m324 | [0m[35m    assert patches == [[0m
[30;1m325 | [0m[35m        # In this case, a Config Update patch is not issued. This does not cause issues on the backe[0m
[30;1m326 | [0m[35m        Patch([0m
[30;1m327 | [0m[35m            type=PatchType.PYTHON_REQUIREMENT,[0m
[30;1m328 | [0m[35m            body=PythonRequirementPatch(action=Action.REMOVE, requirement="xformers"),[0m

[31m--[ [0m[34mMatch #[0m[33m694[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/core/server/test_lazy_data_resolver_v2.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport json[0m
[30;1m2 | [0m[35mimport tempfile[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mfrom pathlib import Path[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mimport pytest[0m
[30;1m7 | [0m[35mfrom truss.templates.shared.lazy_data_resolver import ([0m

[31m--[ [0m[34mMatch #[0m[33m695[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/reference_code/reference_chainlet.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35m# By inhereting chains.ChainletBase, the chains framework will know to create a chainlet that hosts [0m
[30;1m8 | [0m[35mclass RandInt(chains.ChainletBase):[0m
[30;1m9 | [0m[35m    # run_remote must be implemented by all chainlets. This is the code that will be executed at inf[0m
[30;1m10 | [0m[35m    def run_remote(self, max_value: int) -> int:[0m
[30;1m11 | [0m[35m        return random.randint(1, max_value)[0m
[30;1m12 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m696[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server/common/retry.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35mfrom typing import Callable[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35m# TODO: replace with tenacity.[0m

[31m--[ [0m[34mMatch #[0m[33m697[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/framework.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1108 | [0m[35m    @functools.wraps(__original_init__)[0m
[30;1m1109 | [0m[35m    def __init_local__(self: definitions.ABCChainlet, **kwargs) -> None:[0m
[30;1m1110 | [0m[35m        logging.debug(f"Patched `__init__` of `{chainlet_descriptor.name}`.")[0m
[30;1m1111 | [0m[35m        stack_depth = run_local_stack_depth.get(None)[0m
[30;1m1112 | [0m[35m        assert stack_depth is not None, "__init_local__ is only called in context."[0m
[30;1m1113 | [0m[35m        stack = inspect.stack()[0m
[30;1m1114 | [0m[35m        current_stack_depth = len(stack)[0m

[31m--[ [0m[34mMatch #[0m[33m698[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/framework.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1285 | [0m[35m        # Since the framework depends on tracking the source files via `inspect` and this[0m
[30;1m1286 | [0m[35m        # depends on the modules bein properly registered in `sys.modules`, we have to[0m
[30;1m1287 | [0m[35m        # manually do this here (because importlib does not do it automatically). This[0m
[30;1m1288 | [0m[35m        # registration has to stay at least until the push command has finished.[0m
[30;1m1289 | [0m[35m        if module_name in sys.modules:[0m
[30;1m1290 | [0m[35m            raise ImportError([0m
[30;1m1291 | [0m[35m                f"{import_error_msg} There is already a module in `sys.modules` "[0m

[31m--[ [0m[34mMatch #[0m[33m699[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/framework.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1266 | [0m[35m        """The context manager ensures that modules imported by the Model/Chain[0m
[30;1m1267 | [0m[35m         are removed upon exit.[0m
[30;1m1268 | [0m[35m[0m
[30;1m1269 | [0m[35m        I.e. aiming at making the import idempotent for common usages, although there could[0m
[30;1m1270 | [0m[35m        be additional side effects not accounted for by this implementation."""[0m
[30;1m1271 | [0m[35m        module_name = module_path.stem  # Use the file's name as the module name[0m
[30;1m1272 | [0m[35m        if not os.path.isfile(module_path):[0m

[31m--[ [0m[34mMatch #[0m[33m700[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/framework.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m101 | [0m[35m    def __init__(self) -> None:[0m
[30;1m102 | [0m[35m        self._errors = [][0m
[30;1m103 | [0m[35m        # This hook is for the case of just running the Chainlet file, without[0m
[30;1m104 | [0m[35m        # making a push - we want to surface the errors at exit.[0m
[30;1m105 | [0m[35m        atexit.register(self.maybe_display_errors)[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m    def clear(self) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m701[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/framework.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1312 | [0m[35m        # is attempted. Since torch is a common lib, we make this explicit special[0m
[30;1m1313 | [0m[35m        # case and just leave those modules.[0m
[30;1m1314 | [0m[35m        # TODO: this seems still brittle and other modules might cause similar problems.[0m
[30;1m1315 | [0m[35m        #  it would be good to find a more principled solution.[0m
[30;1m1316 | [0m[35m        modules_to_delete = {[0m
[30;1m1317 | [0m[35m            s for s in modules_diff if not (s.startswith("torch.") or s == "torch")[0m
[30;1m1318 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m702[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/framework.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1010 | [0m[35m        #[0m
[30;1m1011 | [0m[35m        # We look into the calls stack of any (wrapped) invocation of an[0m
[30;1m1012 | [0m[35m        # ABCChainlet-subclass's `__init__`.[0m
[30;1m1013 | [0m[35m        # We also cut off the "above" call stack, such that `run_local` (and anything[0m
[30;1m1014 | [0m[35m        # above that) is ignored, so it is possible to use `run_local` in nested code.[0m
[30;1m1015 | [0m[35m        #[0m
[30;1m1016 | [0m[35m        # A valid stack looks like this:[0m

[31m--[ [0m[34mMatch #[0m[33m703[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/framework.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1002 | [0m[35m    def _detect_naive_instantiations([0m
[30;1m1003 | [0m[35m        stack: list[inspect.FrameInfo], levels_below_run_local: int[0m
[30;1m1004 | [0m[35m    ) -> None:[0m
[30;1m1005 | [0m[35m        # The goal is to find cases where a chainlet is directly instantiated[0m
[30;1m1006 | [0m[35m        # in a place that is not immediately inside the `run_local`-contextmanager.[0m
[30;1m1007 | [0m[35m        # In particular chainlets being instantiated in the `__init__` or `run_remote`[0m
[30;1m1008 | [0m[35m        # methods of other chainlets (instead of being passed as dependencies with[0m

[31m--[ [0m[34mMatch #[0m[33m704[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/framework.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m732 | [0m[35m        # Also lenient with type annotation: since the RHS / default is asserted to be a[0m
[30;1m733 | [0m[35m        # chainlet class, proper type inference is possible even without annotation.[0m
[30;1m734 | [0m[35m        # TODO: `Protocol` is not a proper class and this might be version dependent.[0m
[30;1m735 | [0m[35m        #   Find a better way to inspect this.[0m
[30;1m736 | [0m[35m        if not ([0m
[30;1m737 | [0m[35m            param.annotation == inspect.Parameter.empty[0m
[30;1m738 | [0m[35m            or utils.issubclass_safe(param.annotation, Protocol)  # type: ignore[arg-type][0m

[31m--[ [0m[34mMatch #[0m[33m705[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/framework.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m247 | [0m[35m    source = pathlib.Path(src_path).read_text()[0m
[30;1m248 | [0m[35m    tree = ast.parse(source)[0m
[30;1m249 | [0m[35m    class_code = ""[0m
[30;1m250 | [0m[35m    for node in ast.walk(tree):[0m
[30;1m251 | [0m[35m        if isinstance(node, ast.ClassDef) and node.name == target_class_name:[0m
[30;1m252 | [0m[35m            # Extract the source code of the class definition[0m
[30;1m253 | [0m[35m            lines = source.splitlines()[0m

[31m--[ [0m[34mMatch #[0m[33m706[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/helpers/truss_patch/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m12 | [0m[35m# but the code here should use Truss library very sparingly, perhaps just TrussConfig.[0m
[30;1m13 | [0m[35m# This because control server can only use Truss library code via published[0m
[30;1m14 | [0m[35m# versions, so getting changes in Truss server requires Truss code to be published[0m
[30;1m15 | [0m[35m# and the control server's requirements.txt updated.[0m

[31m--[ [0m[34mMatch #[0m[33m707[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/helpers/truss_patch/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m10 | [0m[35m# is a good candidate for extracting out into a smaller library.[0m
[30;1m11 | [0m[35m# Protocol of usage for now is that Truss library can use the code here,[0m
[30;1m12 | [0m[35m# but the code here should use Truss library very sparingly, perhaps just TrussConfig.[0m
[30;1m13 | [0m[35m# This because control server can only use Truss library code via published[0m
[30;1m14 | [0m[35m# versions, so getting changes in Truss server requires Truss code to be published[0m
[30;1m15 | [0m[35m# and the control server's requirements.txt updated.[0m

[31m--[ [0m[34mMatch #[0m[33m708[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/helpers/truss_patch/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35m#   - Patching the truss directory itself to updae contents[0m
[30;1m6 | [0m[35m#   - Patching the truss as laid out on the generated docker image[0m
[30;1m7 | [0m[35m#     (which may be different from the truss dir structure)[0m
[30;1m8 | [0m[35m#   - Patching the container environment, e.g. installing/removing pip and system packages[0m
[30;1m9 | [0m[35m# Right now we bundle this folder in both truss and in live_reload images. This[0m
[30;1m10 | [0m[35m# is a good candidate for extracting out into a smaller library.[0m
[30;1m11 | [0m[35m# Protocol of usage for now is that Truss library can use the code here,[0m

[31m--[ [0m[34mMatch #[0m[33m709[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/helpers/truss_patch/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35m# various ML libraries.[0m
[30;1m4 | [0m[35m# Truss may be patched in different forms:[0m
[30;1m5 | [0m[35m#   - Patching the truss directory itself to updae contents[0m
[30;1m6 | [0m[35m#   - Patching the truss as laid out on the generated docker image[0m
[30;1m7 | [0m[35m#     (which may be different from the truss dir structure)[0m
[30;1m8 | [0m[35m#   - Patching the container environment, e.g. installing/removing pip and system packages[0m
[30;1m9 | [0m[35m# Right now we bundle this folder in both truss and in live_reload images. This[0m

[31m--[ [0m[34mMatch #[0m[33m710[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/deployment/deployment_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m386 | [0m[35m                f"Authentication failed with status code {response.status_code}"[0m
[30;1m387 | [0m[35m            )[0m
[30;1m388 | [0m[35m[0m
[30;1m389 | [0m[35m        if response.headers.get("transfer-encoding") == "chunked":[0m
[30;1m390 | [0m[35m            # Case of streaming response, the backend does not set an encoding, so[0m
[30;1m391 | [0m[35m            # manually decode to the contents to utf-8 here.[0m
[30;1m392 | [0m[35m            def decode_content():[0m

[31m--[ [0m[34mMatch #[0m[33m711[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/deployment/deployment_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m378 | [0m[35m        Returns:[0m
[30;1m379 | [0m[35m            The JSON response."""[0m
[30;1m380 | [0m[35m        headers = self._remote._auth_service.authenticate().header()[0m
[30;1m381 | [0m[35m        response = requests.post([0m
[30;1m382 | [0m[35m            self.run_remote_url, json=json_data, headers=headers, stream=True[0m
[30;1m383 | [0m[35m        )[0m
[30;1m384 | [0m[35m        if response.status_code == 401:[0m

[31m--[ [0m[34mMatch #[0m[33m712[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/deployment/deployment_client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m813 | [0m[35m[0m
[30;1m814 | [0m[35m    def watch(self) -> None:[0m
[30;1m815 | [0m[35m        with concurrent.futures.ThreadPoolExecutor() as executor:[0m
[30;1m816 | [0m[35m            # Perform one initial patch at startup.[0m
[30;1m817 | [0m[35m            self._patch(executor)[0m
[30;1m818 | [0m[35m            self._console.print("👀 Watching for new changes.", style="blue")[0m
[30;1m819 | [0m[35m            for _ in watchfiles.watch([0m

[31m--[ [0m[34mMatch #[0m[33m713[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/deployment/deployment_client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m576 | [0m[35m            _handle_import_error(exception_raised, self._console, self._error_console)[0m
[30;1m577 | [0m[35m[0m
[30;1m578 | [0m[35m    def watch(self) -> None:[0m
[30;1m579 | [0m[35m        # Perform one initial patch at startup.[0m
[30;1m580 | [0m[35m        self._patch()[0m
[30;1m581 | [0m[35m        self._console.print("👀 Watching for new changes.", style="blue")[0m
[30;1m582 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m714[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/deployment/deployment_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m836 | [0m[35m) -> None:[0m
[30;1m837 | [0m[35m    console.print([0m
[30;1m838 | [0m[35m        ([0m
[30;1m839 | [0m[35m            "👀 Starting to watch for Chain source code and applying live patches "[0m
[30;1m840 | [0m[35m            "when changes are detected."[0m
[30;1m841 | [0m[35m        ),[0m
[30;1m842 | [0m[35m        style="blue",[0m

[31m--[ [0m[34mMatch #[0m[33m715[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/deployment/deployment_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m634 | [0m[35m        if included_chainlets:[0m
[30;1m635 | [0m[35m            if not_matched := (set(included_chainlets) - chainlet_names):[0m
[30;1m636 | [0m[35m                raise definitions.ChainsDeploymentError([0m
[30;1m637 | [0m[35m                    "Requested to watch specific chainlets, but did not find "[0m
[30;1m638 | [0m[35m                    f"{not_matched} among available chainlets {chainlet_names}."[0m
[30;1m639 | [0m[35m                )[0m
[30;1m640 | [0m[35m            self._included_chainlets = set(included_chainlets)[0m

[31m--[ [0m[34mMatch #[0m[33m716[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/deployment/deployment_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m634 | [0m[35m        if included_chainlets:[0m
[30;1m635 | [0m[35m            if not_matched := (set(included_chainlets) - chainlet_names):[0m
[30;1m636 | [0m[35m                raise definitions.ChainsDeploymentError([0m
[30;1m637 | [0m[35m                    "Requested to watch specific chainlets, but did not find "[0m
[30;1m638 | [0m[35m                    f"{not_matched} among available chainlets {chainlet_names}."[0m
[30;1m639 | [0m[35m                )[0m
[30;1m640 | [0m[35m            self._included_chainlets = set(included_chainlets)[0m

[31m--[ [0m[34mMatch #[0m[33m717[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/deployment/deployment_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m479 | [0m[35m        )[0m
[30;1m480 | [0m[35m[0m
[30;1m481 | [0m[35m[0m
[30;1m482 | [0m[35m# Watch / Live Patching ################################################################[0m
[30;1m483 | [0m[35m[0m
[30;1m484 | [0m[35m[0m
[30;1m485 | [0m[35mdef _create_watch_filter(root_dir: pathlib.Path):[0m

[31m--[ [0m[34mMatch #[0m[33m718[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/deployment/deployment_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m332 | [0m[35m            truss_dir, chainlet_artifact.display_name, docker_options, port[0m
[30;1m333 | [0m[35m        )[0m
[30;1m334 | [0m[35m        logging.info([0m
[30;1m335 | [0m[35m            f"Pushed Chainlet `{chainlet_artifact.display_name}` as docker container."[0m
[30;1m336 | [0m[35m        )[0m
[30;1m337 | [0m[35m        logging.debug([0m
[30;1m338 | [0m[35m            "Internal model endpoint: "[0m

[31m--[ [0m[34mMatch #[0m[33m719[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/deployment/deployment_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m326 | [0m[35m[0m
[30;1m327 | [0m[35m        truss_dir = chainlet_artifact.truss_dir[0m
[30;1m328 | [0m[35m        logging.info([0m
[30;1m329 | [0m[35m            f"Building Chainlet `{chainlet_artifact.display_name}` docker image."[0m
[30;1m330 | [0m[35m        )[0m
[30;1m331 | [0m[35m        _push_service_docker([0m
[30;1m332 | [0m[35m            truss_dir, chainlet_artifact.display_name, docker_options, port[0m

[31m--[ [0m[34mMatch #[0m[33m720[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/deployment/deployment_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m318 | [0m[35m        chainlet_to_predict_url[chainlet_artifact.display_name] = {[0m
[30;1m319 | [0m[35m            "predict_url": docker_internal_url[0m
[30;1m320 | [0m[35m        }[0m
[30;1m321 | [0m[35m        chainlet_to_service[chainlet_artifact.name] = service[0m
[30;1m322 | [0m[35m[0m
[30;1m323 | [0m[35m        local_config_handler.LocalConfigHandler.set_dynamic_config([0m
[30;1m324 | [0m[35m            definitions.DYNAMIC_CHAINLET_CONFIG_KEY, json.dumps(chainlet_to_predict_url)[0m
[30;1m325 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m721[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/deployment/deployment_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m310 | [0m[35m    chainlet_to_service: Dict[str, DockerChainletService] = {}[0m
[30;1m311 | [0m[35m    for chainlet_artifact in chainlet_artifacts:[0m
[30;1m312 | [0m[35m        port = utils.get_free_port()[0m
[30;1m313 | [0m[35m        service = DockerChainletService(port)[0m
[30;1m314 | [0m[35m[0m
[30;1m315 | [0m[35m        docker_internal_url = service.predict_url.replace([0m
[30;1m316 | [0m[35m            "localhost", "host.docker.internal"[0m

[31m--[ [0m[34mMatch #[0m[33m722[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/deployment/deployment_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m219 | [0m[35m[0m
[30;1m220 | [0m[35m[0m
[30;1m221 | [0m[35mclass DockerChainletService(b10_service.TrussService):[0m
[30;1m222 | [0m[35m    """This service is for Chainlets (not for Chains)."""[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m    def __init__(self, port: int, **kwargs):[0m
[30;1m225 | [0m[35m        remote_url = f"http://localhost:{port}"[0m

[31m--[ [0m[34mMatch #[0m[33m723[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/deployment/deployment_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m215 | [0m[35m        raise NotImplementedError(options)[0m
[30;1m216 | [0m[35m[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m# Docker ###############################################################################[0m
[30;1m219 | [0m[35m[0m
[30;1m220 | [0m[35m[0m
[30;1m221 | [0m[35mclass DockerChainletService(b10_service.TrussService):[0m

[31m--[ [0m[34mMatch #[0m[33m724[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/deployment/deployment_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35mfrom truss.remote.baseten import custom_types as b10_types[0m
[30;1m30 | [0m[35mfrom truss.remote.baseten import error as b10_errors[0m
[30;1m31 | [0m[35mfrom truss.remote.baseten import remote as b10_remote[0m
[30;1m32 | [0m[35mfrom truss.remote.baseten import service as b10_service[0m
[30;1m33 | [0m[35mfrom truss.truss_handle import truss_handle[0m
[30;1m34 | [0m[35mfrom truss.util import log_utils[0m
[30;1m35 | [0m[35mfrom truss.util import path as truss_path[0m

[31m--[ [0m[34mMatch #[0m[33m725[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m{% block run %}[0m
[30;1m101 | [0m[35m    {%- if config.docker_server %}[0m
[30;1m102 | [0m[35mRUN apt-get update && DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends \[0m
[30;1m103 | [0m[35m        curl nginx python3-pip && \[0m
[30;1m104 | [0m[35m        rm -rf /var/lib/apt/lists/*[0m
[30;1m105 | [0m[35mCOPY ./docker_server_requirements.txt /app/docker_server_requirements.txt[0m

[31m--[ [0m[34mMatch #[0m[33m726[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m36 | [0m[35m    && rm -rf /var/lib/apt/lists/*; }[0m
[30;1m37 | [0m[35m# Create symlink for control server to start inference server process with correct python executable[0m
[30;1m38 | [0m[35mRUN readlink {{config.base_image.python_executable_path}} &>/dev/null \[0m
[30;1m39 | [0m[35m    && echo "WARNING: Overwriting existing link at /usr/local/bin/python"[0m
[30;1m40 | [0m[35mRUN ln -sf {{config.base_image.python_executable_path}} /usr/local/bin/python[0m
[30;1m41 | [0m[35m    {%- endif %}[0m
[30;1m42 | [0m[35m{% endif %}[0m

[31m--[ [0m[34mMatch #[0m[33m727[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m34 | [0m[35m    && apt-get autoremove -y \[0m
[30;1m35 | [0m[35m    && apt-get clean -y \[0m
[30;1m36 | [0m[35m    && rm -rf /var/lib/apt/lists/*; }[0m
[30;1m37 | [0m[35m# Create symlink for control server to start inference server process with correct python executable[0m
[30;1m38 | [0m[35mRUN readlink {{config.base_image.python_executable_path}} &>/dev/null \[0m
[30;1m39 | [0m[35m    && echo "WARNING: Overwriting existing link at /usr/local/bin/python"[0m
[30;1m40 | [0m[35mRUN ln -sf {{config.base_image.python_executable_path}} /usr/local/bin/python[0m

[31m--[ [0m[34mMatch #[0m[33m728[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m30 | [0m[35mRUN $PYTHON_EXECUTABLE -m venv -h >/dev/null \[0m
[30;1m31 | [0m[35m    || { pythonVersion=$(echo $($PYTHON_EXECUTABLE --version) | cut -d" " -f2 | cut -d"." -f1,2) \[0m
[30;1m32 | [0m[35m    && add-apt-repository -y ppa:deadsnakes/ppa \[0m
[30;1m33 | [0m[35m    && apt update -y && apt install -y --no-install-recommends python$pythonVersion-venv \[0m
[30;1m34 | [0m[35m    && apt-get autoremove -y \[0m
[30;1m35 | [0m[35m    && apt-get clean -y \[0m
[30;1m36 | [0m[35m    && rm -rf /var/lib/apt/lists/*; }[0m

[31m--[ [0m[34mMatch #[0m[33m729[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m12 | [0m[35mENV DEBIAN_FRONTEND="noninteractive"[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mRUN apt update && \[0m
[30;1m15 | [0m[35m    apt install -y bash \[0m
[30;1m16 | [0m[35m                build-essential \[0m
[30;1m17 | [0m[35m                git \[0m
[30;1m18 | [0m[35m                curl \[0m

[31m--[ [0m[34mMatch #[0m[33m730[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m11 | [0m[35mENV PYTHONUNBUFFERED="True"[0m
[30;1m12 | [0m[35mENV DEBIAN_FRONTEND="noninteractive"[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mRUN apt update && \[0m
[30;1m15 | [0m[35m    apt install -y bash \[0m
[30;1m16 | [0m[35m                build-essential \[0m
[30;1m17 | [0m[35m                git \[0m

[31m--[ [0m[34mMatch #[0m[33m731[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m121 | [0m[35mENV SERVER_START_CMD="/control/.env/bin/python3 /control/control/server.py"[0m
[30;1m122 | [0m[35mENTRYPOINT ["/control/.env/bin/python3", "/control/control/server.py"][0m
[30;1m123 | [0m[35m    {%- else %}[0m
[30;1m124 | [0m[35mENV INFERENCE_SERVER_PORT="8080"[0m
[30;1m125 | [0m[35mENV SERVER_START_CMD="{{(config.base_image.python_executable_path or "python3") ~ " /app/main.py"}}"[0m
[30;1m126 | [0m[35mENTRYPOINT ["{{config.base_image.python_executable_path or "python3"}}", "/app/main.py"][0m
[30;1m127 | [0m[35m    {%- endif %}[0m
[30;1m128 | [0m[35m{% endblock %}[0m

[31m--[ [0m[34mMatch #[0m[33m732[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m120 | [0m[35mENV INFERENCE_SERVER_PORT="8090"[0m
[30;1m121 | [0m[35mENV SERVER_START_CMD="/control/.env/bin/python3 /control/control/server.py"[0m
[30;1m122 | [0m[35mENTRYPOINT ["/control/.env/bin/python3", "/control/control/server.py"][0m
[30;1m123 | [0m[35m    {%- else %}[0m
[30;1m124 | [0m[35mENV INFERENCE_SERVER_PORT="8080"[0m
[30;1m125 | [0m[35mENV SERVER_START_CMD="{{(config.base_image.python_executable_path or "python3") ~ " /app/main.py"}}"[0m
[30;1m126 | [0m[35mENTRYPOINT ["{{config.base_image.python_executable_path or "python3"}}", "/app/main.py"][0m
[30;1m127 | [0m[35m    {%- endif %}[0m

[31m--[ [0m[34mMatch #[0m[33m733[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m117 | [0m[35m    {%- elif config.live_reload %}[0m
[30;1m118 | [0m[35mENV HASH_TRUSS="{{truss_hash}}"[0m
[30;1m119 | [0m[35mENV CONTROL_SERVER_PORT="8080"[0m
[30;1m120 | [0m[35mENV INFERENCE_SERVER_PORT="8090"[0m
[30;1m121 | [0m[35mENV SERVER_START_CMD="/control/.env/bin/python3 /control/control/server.py"[0m
[30;1m122 | [0m[35mENTRYPOINT ["/control/.env/bin/python3", "/control/control/server.py"][0m
[30;1m123 | [0m[35m    {%- else %}[0m
[30;1m124 | [0m[35mENV INFERENCE_SERVER_PORT="8080"[0m

[31m--[ [0m[34mMatch #[0m[33m734[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m116 | [0m[35mENTRYPOINT ["supervisord", "-c", "{{ supervisor_config_path }}"][0m
[30;1m117 | [0m[35m    {%- elif config.live_reload %}[0m
[30;1m118 | [0m[35mENV HASH_TRUSS="{{truss_hash}}"[0m
[30;1m119 | [0m[35mENV CONTROL_SERVER_PORT="8080"[0m
[30;1m120 | [0m[35mENV INFERENCE_SERVER_PORT="8090"[0m
[30;1m121 | [0m[35mENV SERVER_START_CMD="/control/.env/bin/python3 /control/control/server.py"[0m
[30;1m122 | [0m[35mENTRYPOINT ["/control/.env/bin/python3", "/control/control/server.py"][0m
[30;1m123 | [0m[35m    {%- else %}[0m

[31m--[ [0m[34mMatch #[0m[33m735[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m115 | [0m[35mENV SERVER_START_CMD="supervisord -c {{ supervisor_config_path }}"[0m
[30;1m116 | [0m[35mENTRYPOINT ["supervisord", "-c", "{{ supervisor_config_path }}"][0m
[30;1m117 | [0m[35m    {%- elif config.live_reload %}[0m
[30;1m118 | [0m[35mENV HASH_TRUSS="{{truss_hash}}"[0m
[30;1m119 | [0m[35mENV CONTROL_SERVER_PORT="8080"[0m
[30;1m120 | [0m[35mENV INFERENCE_SERVER_PORT="8090"[0m
[30;1m121 | [0m[35mENV SERVER_START_CMD="/control/.env/bin/python3 /control/control/server.py"[0m
[30;1m122 | [0m[35mENTRYPOINT ["/control/.env/bin/python3", "/control/control/server.py"][0m

[31m--[ [0m[34mMatch #[0m[33m736[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m114 | [0m[35mENV SUPERVISOR_SERVER_URL="{{ supervisor_server_url }}"[0m
[30;1m115 | [0m[35mENV SERVER_START_CMD="supervisord -c {{ supervisor_config_path }}"[0m
[30;1m116 | [0m[35mENTRYPOINT ["supervisord", "-c", "{{ supervisor_config_path }}"][0m
[30;1m117 | [0m[35m    {%- elif config.live_reload %}[0m
[30;1m118 | [0m[35mENV HASH_TRUSS="{{truss_hash}}"[0m
[30;1m119 | [0m[35mENV CONTROL_SERVER_PORT="8080"[0m
[30;1m120 | [0m[35mENV INFERENCE_SERVER_PORT="8090"[0m
[30;1m121 | [0m[35mENV SERVER_START_CMD="/control/.env/bin/python3 /control/control/server.py"[0m

[31m--[ [0m[34mMatch #[0m[33m737[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m111 | [0m[35mCOPY ./proxy.conf {{ proxy_config_path }}[0m
[30;1m112 | [0m[35mRUN mkdir -p {{ supervisor_log_dir }}[0m
[30;1m113 | [0m[35mCOPY supervisord.conf {{ supervisor_config_path }}[0m
[30;1m114 | [0m[35mENV SUPERVISOR_SERVER_URL="{{ supervisor_server_url }}"[0m
[30;1m115 | [0m[35mENV SERVER_START_CMD="supervisord -c {{ supervisor_config_path }}"[0m
[30;1m116 | [0m[35mENTRYPOINT ["supervisord", "-c", "{{ supervisor_config_path }}"][0m
[30;1m117 | [0m[35m    {%- elif config.live_reload %}[0m
[30;1m118 | [0m[35mENV HASH_TRUSS="{{truss_hash}}"[0m

[31m--[ [0m[34mMatch #[0m[33m738[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m110 | [0m[35m{% set supervisor_server_url = "http://localhost:8080" %}[0m
[30;1m111 | [0m[35mCOPY ./proxy.conf {{ proxy_config_path }}[0m
[30;1m112 | [0m[35mRUN mkdir -p {{ supervisor_log_dir }}[0m
[30;1m113 | [0m[35mCOPY supervisord.conf {{ supervisor_config_path }}[0m
[30;1m114 | [0m[35mENV SUPERVISOR_SERVER_URL="{{ supervisor_server_url }}"[0m
[30;1m115 | [0m[35mENV SERVER_START_CMD="supervisord -c {{ supervisor_config_path }}"[0m
[30;1m116 | [0m[35mENTRYPOINT ["supervisord", "-c", "{{ supervisor_config_path }}"][0m
[30;1m117 | [0m[35m    {%- elif config.live_reload %}[0m

[31m--[ [0m[34mMatch #[0m[33m739[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m103 | [0m[35m        curl nginx python3-pip && \[0m
[30;1m104 | [0m[35m        rm -rf /var/lib/apt/lists/*[0m
[30;1m105 | [0m[35mCOPY ./docker_server_requirements.txt /app/docker_server_requirements.txt[0m
[30;1m106 | [0m[35mRUN pip install -r /app/docker_server_requirements.txt --no-cache-dir && rm -rf /root/.cache/pip[0m
[30;1m107 | [0m[35m{% set proxy_config_path = "/etc/nginx/conf.d/proxy.conf" %}[0m
[30;1m108 | [0m[35m{% set supervisor_config_path = "/etc/supervisor/supervisord.conf" %}[0m
[30;1m109 | [0m[35m{% set supervisor_log_dir = "/var/log/supervisor" %}[0m

[31m--[ [0m[34mMatch #[0m[33m740[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m100 | [0m[35m{% block run %}[0m
[30;1m101 | [0m[35m    {%- if config.docker_server %}[0m
[30;1m102 | [0m[35mRUN apt-get update && DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends \[0m
[30;1m103 | [0m[35m        curl nginx python3-pip && \[0m
[30;1m104 | [0m[35m        rm -rf /var/lib/apt/lists/*[0m
[30;1m105 | [0m[35mCOPY ./docker_server_requirements.txt /app/docker_server_requirements.txt[0m
[30;1m106 | [0m[35mRUN pip install -r /app/docker_server_requirements.txt --no-cache-dir && rm -rf /root/.cache/pip[0m

[31m--[ [0m[34mMatch #[0m[33m741[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m{% block run %}[0m
[30;1m101 | [0m[35m    {%- if config.docker_server %}[0m
[30;1m102 | [0m[35mRUN apt-get update && DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends \[0m
[30;1m103 | [0m[35m        curl nginx python3-pip && \[0m
[30;1m104 | [0m[35m        rm -rf /var/lib/apt/lists/*[0m
[30;1m105 | [0m[35mCOPY ./docker_server_requirements.txt /app/docker_server_requirements.txt[0m

[31m--[ [0m[34mMatch #[0m[33m742[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m{% block run %}[0m
[30;1m101 | [0m[35m    {%- if config.docker_server %}[0m
[30;1m102 | [0m[35mRUN apt-get update && DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends \[0m
[30;1m103 | [0m[35m        curl nginx python3-pip && \[0m
[30;1m104 | [0m[35m        rm -rf /var/lib/apt/lists/*[0m
[30;1m105 | [0m[35mCOPY ./docker_server_requirements.txt /app/docker_server_requirements.txt[0m

[31m--[ [0m[34mMatch #[0m[33m743[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m{%- if external_data_files %}[0m
[30;1m62 | [0m[35m{% for url, dst in external_data_files %}[0m
[30;1m63 | [0m[35mRUN mkdir -p {{ dst.parent }}; curl -L "{{ url }}" -o {{ dst }}[0m
[30;1m64 | [0m[35m{% endfor %}[0m
[30;1m65 | [0m[35m{%- endif  %}[0m
[30;1m66 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m744[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35m{% block install_requirements %}[0m
[30;1m47 | [0m[35m    {%- if should_install_server_requirements %}[0m
[30;1m48 | [0m[35mCOPY ./{{server_requirements_filename}} {{server_requirements_filename}}[0m
[30;1m49 | [0m[35mRUN pip install -r {{server_requirements_filename}} --no-cache-dir && rm -rf /root/.cache/pip[0m
[30;1m50 | [0m[35m    {%- endif %}[0m
[30;1m51 | [0m[35m{{ super() }}[0m
[30;1m52 | [0m[35m{% endblock %}[0m

[31m--[ [0m[34mMatch #[0m[33m745[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m32 | [0m[35m    && add-apt-repository -y ppa:deadsnakes/ppa \[0m
[30;1m33 | [0m[35m    && apt update -y && apt install -y --no-install-recommends python$pythonVersion-venv \[0m
[30;1m34 | [0m[35m    && apt-get autoremove -y \[0m
[30;1m35 | [0m[35m    && apt-get clean -y \[0m
[30;1m36 | [0m[35m    && rm -rf /var/lib/apt/lists/*; }[0m
[30;1m37 | [0m[35m# Create symlink for control server to start inference server process with correct python executable[0m
[30;1m38 | [0m[35mRUN readlink {{config.base_image.python_executable_path}} &>/dev/null \[0m

[31m--[ [0m[34mMatch #[0m[33m746[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35m    || { pythonVersion=$(echo $($PYTHON_EXECUTABLE --version) | cut -d" " -f2 | cut -d"." -f1,2) \[0m
[30;1m32 | [0m[35m    && add-apt-repository -y ppa:deadsnakes/ppa \[0m
[30;1m33 | [0m[35m    && apt update -y && apt install -y --no-install-recommends python$pythonVersion-venv \[0m
[30;1m34 | [0m[35m    && apt-get autoremove -y \[0m
[30;1m35 | [0m[35m    && apt-get clean -y \[0m
[30;1m36 | [0m[35m    && rm -rf /var/lib/apt/lists/*; }[0m
[30;1m37 | [0m[35m# Create symlink for control server to start inference server process with correct python executable[0m

[31m--[ [0m[34mMatch #[0m[33m747[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35mRUN $PYTHON_EXECUTABLE -m venv -h >/dev/null \[0m
[30;1m31 | [0m[35m    || { pythonVersion=$(echo $($PYTHON_EXECUTABLE --version) | cut -d" " -f2 | cut -d"." -f1,2) \[0m
[30;1m32 | [0m[35m    && add-apt-repository -y ppa:deadsnakes/ppa \[0m
[30;1m33 | [0m[35m    && apt update -y && apt install -y --no-install-recommends python$pythonVersion-venv \[0m
[30;1m34 | [0m[35m    && apt-get autoremove -y \[0m
[30;1m35 | [0m[35m    && apt-get clean -y \[0m
[30;1m36 | [0m[35m    && rm -rf /var/lib/apt/lists/*; }[0m

[31m--[ [0m[34mMatch #[0m[33m748[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35mRUN $PYTHON_EXECUTABLE -m venv -h >/dev/null \[0m
[30;1m31 | [0m[35m    || { pythonVersion=$(echo $($PYTHON_EXECUTABLE --version) | cut -d" " -f2 | cut -d"." -f1,2) \[0m
[30;1m32 | [0m[35m    && add-apt-repository -y ppa:deadsnakes/ppa \[0m
[30;1m33 | [0m[35m    && apt update -y && apt install -y --no-install-recommends python$pythonVersion-venv \[0m
[30;1m34 | [0m[35m    && apt-get autoremove -y \[0m
[30;1m35 | [0m[35m    && apt-get clean -y \[0m
[30;1m36 | [0m[35m    && rm -rf /var/lib/apt/lists/*; }[0m

[31m--[ [0m[34mMatch #[0m[33m749[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    {%- if config.live_reload  and not config.docker_server%}[0m
[30;1m30 | [0m[35mRUN $PYTHON_EXECUTABLE -m venv -h >/dev/null \[0m
[30;1m31 | [0m[35m    || { pythonVersion=$(echo $($PYTHON_EXECUTABLE --version) | cut -d" " -f2 | cut -d"." -f1,2) \[0m
[30;1m32 | [0m[35m    && add-apt-repository -y ppa:deadsnakes/ppa \[0m
[30;1m33 | [0m[35m    && apt update -y && apt install -y --no-install-recommends python$pythonVersion-venv \[0m
[30;1m34 | [0m[35m    && apt-get autoremove -y \[0m

[31m--[ [0m[34mMatch #[0m[33m750[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    {%- if config.live_reload  and not config.docker_server%}[0m
[30;1m30 | [0m[35mRUN $PYTHON_EXECUTABLE -m venv -h >/dev/null \[0m
[30;1m31 | [0m[35m    || { pythonVersion=$(echo $($PYTHON_EXECUTABLE --version) | cut -d" " -f2 | cut -d"." -f1,2) \[0m
[30;1m32 | [0m[35m    && add-apt-repository -y ppa:deadsnakes/ppa \[0m
[30;1m33 | [0m[35m    && apt update -y && apt install -y --no-install-recommends python$pythonVersion-venv \[0m
[30;1m34 | [0m[35m    && apt-get autoremove -y \[0m

[31m--[ [0m[34mMatch #[0m[33m751[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35m    && rm -rf /var/lib/apt/lists/*[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35mCOPY ./{{base_server_requirements_filename}} {{base_server_requirements_filename}}[0m
[30;1m26 | [0m[35mRUN pip install -r {{base_server_requirements_filename}} --no-cache-dir && rm -rf /root/.cache/pip[0m
[30;1m27 | [0m[35m    {%- endif %}[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    {%- if config.live_reload  and not config.docker_server%}[0m

[31m--[ [0m[34mMatch #[0m[33m752[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m19 | [0m[35m                ca-certificates \[0m
[30;1m20 | [0m[35m                software-properties-common \[0m
[30;1m21 | [0m[35m    && apt-get autoremove -y \[0m
[30;1m22 | [0m[35m    && apt-get clean -y \[0m
[30;1m23 | [0m[35m    && rm -rf /var/lib/apt/lists/*[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35mCOPY ./{{base_server_requirements_filename}} {{base_server_requirements_filename}}[0m

[31m--[ [0m[34mMatch #[0m[33m753[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m                curl \[0m
[30;1m19 | [0m[35m                ca-certificates \[0m
[30;1m20 | [0m[35m                software-properties-common \[0m
[30;1m21 | [0m[35m    && apt-get autoremove -y \[0m
[30;1m22 | [0m[35m    && apt-get clean -y \[0m
[30;1m23 | [0m[35m    && rm -rf /var/lib/apt/lists/*[0m
[30;1m24 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m754[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m15 | [0m[35m    apt install -y bash \[0m
[30;1m16 | [0m[35m                build-essential \[0m
[30;1m17 | [0m[35m                git \[0m
[30;1m18 | [0m[35m                curl \[0m
[30;1m19 | [0m[35m                ca-certificates \[0m
[30;1m20 | [0m[35m                software-properties-common \[0m
[30;1m21 | [0m[35m    && apt-get autoremove -y \[0m

[31m--[ [0m[34mMatch #[0m[33m755[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14 | [0m[35mRUN apt update && \[0m
[30;1m15 | [0m[35m    apt install -y bash \[0m
[30;1m16 | [0m[35m                build-essential \[0m
[30;1m17 | [0m[35m                git \[0m
[30;1m18 | [0m[35m                curl \[0m
[30;1m19 | [0m[35m                ca-certificates \[0m
[30;1m20 | [0m[35m                software-properties-common \[0m

[31m--[ [0m[34mMatch #[0m[33m756[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35mENV DEBIAN_FRONTEND="noninteractive"[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mRUN apt update && \[0m
[30;1m15 | [0m[35m    apt install -y bash \[0m
[30;1m16 | [0m[35m                build-essential \[0m
[30;1m17 | [0m[35m                git \[0m
[30;1m18 | [0m[35m                curl \[0m

[31m--[ [0m[34mMatch #[0m[33m757[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35mENV DEBIAN_FRONTEND="noninteractive"[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mRUN apt update && \[0m
[30;1m15 | [0m[35m    apt install -y bash \[0m
[30;1m16 | [0m[35m                build-essential \[0m
[30;1m17 | [0m[35m                git \[0m
[30;1m18 | [0m[35m                curl \[0m

[31m--[ [0m[34mMatch #[0m[33m758[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35mENV PYTHONUNBUFFERED="True"[0m
[30;1m12 | [0m[35mENV DEBIAN_FRONTEND="noninteractive"[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mRUN apt update && \[0m
[30;1m15 | [0m[35m    apt install -y bash \[0m
[30;1m16 | [0m[35m                build-essential \[0m
[30;1m17 | [0m[35m                git \[0m

[31m--[ [0m[34mMatch #[0m[33m759[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35m# If user base image is supplied in config, apply build commands from truss base image[0m
[30;1m9 | [0m[35m{% if config.base_image %}[0m
[30;1m10 | [0m[35m    {%- if not config.docker_server %}[0m
[30;1m11 | [0m[35mENV PYTHONUNBUFFERED="True"[0m
[30;1m12 | [0m[35mENV DEBIAN_FRONTEND="noninteractive"[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mRUN apt update && \[0m
[30;1m15 | [0m[35m    apt install -y bash \[0m

[31m--[ [0m[34mMatch #[0m[33m760[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server.Dockerfile.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35m{% block base_image_patch %}[0m
[30;1m8 | [0m[35m# If user base image is supplied in config, apply build commands from truss base image[0m
[30;1m9 | [0m[35m{% if config.base_image %}[0m
[30;1m10 | [0m[35m    {%- if not config.docker_server %}[0m
[30;1m11 | [0m[35mENV PYTHONUNBUFFERED="True"[0m
[30;1m12 | [0m[35mENV DEBIAN_FRONTEND="noninteractive"[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mRUN apt update && \[0m

[31m--[ [0m[34mMatch #[0m[33m761[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/helpers/truss_patch/model_code_patch_applier.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m24 | [0m[35m            content = patch.content[0m
[30;1m25 | [0m[35m            if content is None:[0m
[30;1m26 | [0m[35m                raise ValueError([0m
[30;1m27 | [0m[35m                    "Invalid patch: content of a file update patch should not be None."[0m
[30;1m28 | [0m[35m                )[0m
[30;1m29 | [0m[35m            file.write(content)[0m
[30;1m30 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m762[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/trt_llm/config_checks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m    The hf hub API will return 401 when trying to access a private or gated model without auth.[0m
[30;1m37 | [0m[35m    """[0m
[30;1m38 | [0m[35m    response = requests.get(f"{HF_MODELS_API_URL}/{model_id}")[0m
[30;1m39 | [0m[35m    return response.status_code == 200[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m763[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m127 | [0m[35m            self.predict_url, "POST", data=model_request_body, stream=True[0m
[30;1m128 | [0m[35m        )[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m        if response.headers.get("transfer-encoding") == "chunked":[0m
[30;1m131 | [0m[35m            # Case of streaming response, the backend does not set an encoding, so[0m
[30;1m132 | [0m[35m            # manually decode to the contents to utf-8 here.[0m
[30;1m133 | [0m[35m            def decode_content():[0m

[31m--[ [0m[34mMatch #[0m[33m764[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m178 | [0m[35m[0m
[30;1m179 | [0m[35m    def poll_deployment_status(self, sleep_secs: int = 1) -> Iterator[str]:[0m
[30;1m180 | [0m[35m        """[0m
[30;1m181 | [0m[35m        Wait for the service to be deployed.[0m
[30;1m182 | [0m[35m        """[0m
[30;1m183 | [0m[35m        while True:[0m
[30;1m184 | [0m[35m            time.sleep(sleep_secs)[0m

[31m--[ [0m[34mMatch #[0m[33m765[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport enum[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35mimport urllib.parse[0m
[30;1m4 | [0m[35mimport warnings[0m
[30;1m5 | [0m[35mfrom typing import Any, Dict, Iterator, NamedTuple, Optional[0m
[30;1m6 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m766[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/patch/custom_types.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m32 | [0m[35m    @staticmethod[0m
[30;1m33 | [0m[35m    def from_dict(d) -> "TrussSignature":[0m
[30;1m34 | [0m[35m        requirements = [][0m
[30;1m35 | [0m[35m        for req in d.get("requirements_file_requirements", []):[0m
[30;1m36 | [0m[35m            parsed_req = parse_requirement_string(req)[0m
[30;1m37 | [0m[35m            if parsed_req:[0m
[30;1m38 | [0m[35m                requirements.append(parsed_req)[0m

[31m--[ [0m[34mMatch #[0m[33m767[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_custom_server_truss/config.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35m  cpu: '1'[0m
[30;1m12 | [0m[35m  memory: 2Gi[0m
[30;1m13 | [0m[35m  use_gpu: false[0m
[30;1m14 | [0m[35mmodel_name: Test Docker Server Truss[0m
[30;1m15 | [0m[35msecrets:[0m
[30;1m16 | [0m[35m  hf_access_token: null[0m
[30;1m17 | [0m[35menvironment_variables:[0m

[31m--[ [0m[34mMatch #[0m[33m768[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/contexts/image_builder/test_serving_image_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport filecmp[0m
[30;1m2 | [0m[35mimport os[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mfrom pathlib import Path[0m
[30;1m5 | [0m[35mfrom tempfile import TemporaryDirectory[0m
[30;1m6 | [0m[35mfrom unittest.mock import patch[0m
[30;1m7 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m769[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/contexts/docker_build_setup.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35m    tr = truss_handle.TrussHandle(TRUSS_SRC_DIR)[0m
[30;1m36 | [0m[35m    logging.info("Truss is loaded")[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m    if patches_dir := os.environ.get("PATCHES_DIR"):[0m
[30;1m39 | [0m[35m        logging.info("Applying patches")[0m
[30;1m40 | [0m[35m        logger = logging.getLogger("patch_applier")[0m
[30;1m41 | [0m[35m        patch_applier = TrussDirPatchApplier(TRUSS_SRC_DIR, logger)[0m

[31m--[ [0m[34mMatch #[0m[33m770[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/contexts/docker_build_setup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m26 | [0m[35mdef docker_build_setup(truss_type: str) -> None:[0m
[30;1m27 | [0m[35m    """[0m
[30;1m28 | [0m[35m    Prepares source and asset files in a build directory (build context), on which a[0m
[30;1m29 | [0m[35m    docker build command can be run.[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m    This is to be run for remote builds on baseten.[0m
[30;1m32 | [0m[35m    Local builds use `TrussHandle.build_serving_docker_image`.[0m

[31m--[ [0m[34mMatch #[0m[33m771[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/helpers/truss_patch/model_container_patch_applier.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m191 | [0m[35m    if Path("/usr/local/bin/pip").exists():[0m
[30;1m192 | [0m[35m        return "/usr/local/bin/pip"[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m    raise RuntimeError("Unable to find pip, make sure it's installed.")[0m

[31m--[ [0m[34mMatch #[0m[33m772[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/truss_remote.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m76 | [0m[35m        elif method == "POST":[0m
[30;1m77 | [0m[35m            if data is None:[0m
[30;1m78 | [0m[35m                raise ValueError("POST request must have data")[0m
[30;1m79 | [0m[35m            response = requests.request([0m
[30;1m80 | [0m[35m                method, url, json=data, headers=headers, stream=stream[0m
[30;1m81 | [0m[35m            )[0m
[30;1m82 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m773[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/truss_remote.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m        auth_header = self.authenticate()[0m
[30;1m73 | [0m[35m        headers = {**headers, **auth_header}[0m
[30;1m74 | [0m[35m        if method == "GET":[0m
[30;1m75 | [0m[35m            response = requests.request(method, url, headers=headers, stream=stream)[0m
[30;1m76 | [0m[35m        elif method == "POST":[0m
[30;1m77 | [0m[35m            if data is None:[0m
[30;1m78 | [0m[35m                raise ValueError("POST request must have data")[0m

[31m--[ [0m[34mMatch #[0m[33m774[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000703[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Username[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/truss_remote.py[0m
   Pattern: [32m.userInfo[0m
[30;1m221 | [0m[35m        """[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m    @abstractmethod[0m
[30;1m224 | [0m[35m    def whoami(self) -> RemoteUser:[0m
[30;1m225 | [0m[35m        """[0m
[30;1m226 | [0m[35m        Returns account information for the current user.[0m
[30;1m227 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m775[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/truss_remote.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m24 | [0m[35m    """[0m
[30;1m25 | [0m[35m    Define the abstract base class for a TrussService.[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    A TrussService interacts with a service at a given URL and can either be in[0m
[30;1m28 | [0m[35m    draft or non-draft mode.[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m    Attributes:[0m

[31m--[ [0m[34mMatch #[0m[33m776[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/truss_remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m        This method should be implemented in subclasses and return a TrussService[0m
[30;1m239 | [0m[35m        object for interacting with the remote service. This support keyword args,[0m
[30;1m240 | [0m[35m        so that implementing remotes can be flexible with how a service is instantiated.[0m
[30;1m241 | [0m[35m[0m
[30;1m242 | [0m[35m        Args:[0m
[30;1m243 | [0m[35m            **kwargs: Keyword arguments for the get_service operation.[0m

[31m--[ [0m[34mMatch #[0m[33m777[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/truss_remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m187 | [0m[35m    """[0m
[30;1m188 | [0m[35m    Define the abstract base class for a remote Truss service.[0m
[30;1m189 | [0m[35m[0m
[30;1m190 | [0m[35m    A remote Truss service is a service that can push a TrussHandle to a remote[0m
[30;1m191 | [0m[35m    location. The `push` and `authenticate` methods should be implemented in subclasses.[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m    Attributes:[0m

[31m--[ [0m[34mMatch #[0m[33m778[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/truss_remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m187 | [0m[35m    """[0m
[30;1m188 | [0m[35m    Define the abstract base class for a remote Truss service.[0m
[30;1m189 | [0m[35m[0m
[30;1m190 | [0m[35m    A remote Truss service is a service that can push a TrussHandle to a remote[0m
[30;1m191 | [0m[35m    location. The `push` and `authenticate` methods should be implemented in subclasses.[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m    Attributes:[0m

[31m--[ [0m[34mMatch #[0m[33m779[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/truss_remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m163 | [0m[35m    @abstractmethod[0m
[30;1m164 | [0m[35m    def logs_url(self) -> str:[0m
[30;1m165 | [0m[35m        """[0m
[30;1m166 | [0m[35m        Get the URL for the service logs.[0m
[30;1m167 | [0m[35m        """[0m
[30;1m168 | [0m[35m        pass[0m
[30;1m169 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m780[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/truss_remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m154 | [0m[35m        Authenticate to the service.[0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35m        This method should be implemented in subclasses and return a dictionary[0m
[30;1m157 | [0m[35m        of headers to include in requests to the service with authentication[0m
[30;1m158 | [0m[35m        information.[0m
[30;1m159 | [0m[35m        """[0m
[30;1m160 | [0m[35m        return {}[0m

[31m--[ [0m[34mMatch #[0m[33m781[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/truss_remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m123 | [0m[35m        is successful.[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m        Returns:[0m
[30;1m126 | [0m[35m            A boolean indicating if the service is ready.[0m
[30;1m127 | [0m[35m        """[0m
[30;1m128 | [0m[35m        readiness_url = f"{self._service_url}/v1/models/model"[0m
[30;1m129 | [0m[35m        response = self._send_request(readiness_url, "GET", {})[0m

[31m--[ [0m[34mMatch #[0m[33m782[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/truss_remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m119 | [0m[35m        """[0m
[30;1m120 | [0m[35m        Check if the service is ready.[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m        Sends a GET request to the model path of the service and returns whether it[0m
[30;1m123 | [0m[35m        is successful.[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m        Returns:[0m

[31m--[ [0m[34mMatch #[0m[33m783[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/truss_remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m117 | [0m[35m    @abstractmethod[0m
[30;1m118 | [0m[35m    def is_ready(self) -> bool:[0m
[30;1m119 | [0m[35m        """[0m
[30;1m120 | [0m[35m        Check if the service is ready.[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m        Sends a GET request to the model path of the service and returns whether it[0m
[30;1m123 | [0m[35m        is successful.[0m

[31m--[ [0m[34mMatch #[0m[33m784[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/truss_remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m108 | [0m[35m        is successful.[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m        Returns:[0m
[30;1m111 | [0m[35m            A boolean indicating if the service is live.[0m
[30;1m112 | [0m[35m        """[0m
[30;1m113 | [0m[35m        liveness_url = f"{self._service_url}/"[0m
[30;1m114 | [0m[35m        response = self._send_request(liveness_url, "GET", {})[0m

[31m--[ [0m[34mMatch #[0m[33m785[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/truss_remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m104 | [0m[35m        """[0m
[30;1m105 | [0m[35m        Check if the service is live.[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m        Sends a GET request to the root of the service and returns whether it[0m
[30;1m108 | [0m[35m        is successful.[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m        Returns:[0m

[31m--[ [0m[34mMatch #[0m[33m786[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/truss_remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m102 | [0m[35m    @abstractmethod[0m
[30;1m103 | [0m[35m    def is_live(self) -> bool:[0m
[30;1m104 | [0m[35m        """[0m
[30;1m105 | [0m[35m        Check if the service is live.[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m        Sends a GET request to the root of the service and returns whether it[0m
[30;1m108 | [0m[35m        is successful.[0m

[31m--[ [0m[34mMatch #[0m[33m787[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/truss_remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m95 | [0m[35m        Check if the service is in draft mode.[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m        Returns:[0m
[30;1m98 | [0m[35m            A boolean indicating if the service is in draft mode.[0m
[30;1m99 | [0m[35m        """[0m
[30;1m100 | [0m[35m        return self._is_draft[0m
[30;1m101 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m788[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/truss_remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m92 | [0m[35m    @property[0m
[30;1m93 | [0m[35m    def is_draft(self) -> bool:[0m
[30;1m94 | [0m[35m        """[0m
[30;1m95 | [0m[35m        Check if the service is in draft mode.[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m        Returns:[0m
[30;1m98 | [0m[35m            A boolean indicating if the service is in draft mode.[0m

[31m--[ [0m[34mMatch #[0m[33m789[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/truss_remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    Args:[0m
[30;1m35 | [0m[35m        service_url: The URL of the service.[0m
[30;1m36 | [0m[35m        is_draft: A boolean indicating if the service is in draft mode.[0m
[30;1m37 | [0m[35m        **kwargs: Additional keyword arguments to initialize the service.[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m790[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/truss_remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m    Attributes:[0m
[30;1m31 | [0m[35m        _service_url: The URL of the service.[0m
[30;1m32 | [0m[35m        _is_draft: A boolean indicating if the service is in draft mode.[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    Args:[0m
[30;1m35 | [0m[35m        service_url: The URL of the service.[0m

[31m--[ [0m[34mMatch #[0m[33m791[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/truss_remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m24 | [0m[35m    """[0m
[30;1m25 | [0m[35m    Define the abstract base class for a TrussService.[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    A TrussService interacts with a service at a given URL and can either be in[0m
[30;1m28 | [0m[35m    draft or non-draft mode.[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m    Attributes:[0m

[31m--[ [0m[34mMatch #[0m[33m792[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/remote_chainlet/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m213 | [0m[35m    if error.exception_module_name is None:[0m
[30;1m214 | [0m[35m        exception_cls = getattr(builtins, error.exception_cls_name, None)[0m
[30;1m215 | [0m[35m    else:[0m
[30;1m216 | [0m[35m        if mod := sys.modules.get(error.exception_module_name):[0m
[30;1m217 | [0m[35m            exception_cls = getattr(mod, error.exception_cls_name, None)[0m
[30;1m218 | [0m[35m[0m
[30;1m219 | [0m[35m    if exception_cls is None:[0m

[31m--[ [0m[34mMatch #[0m[33m793[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/remote_chainlet/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35m[0m
[30;1m141 | [0m[35mdef get_trace_parent() -> Optional[str]:[0m
[30;1m142 | [0m[35m    return _trace_parent_context.get()[0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35mdef pydantic_set_field_dict(obj: pydantic.BaseModel) -> dict[str, pydantic.BaseModel]:[0m

[31m--[ [0m[34mMatch #[0m[33m794[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/remote_chainlet/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m121 | [0m[35m@contextlib.contextmanager[0m
[30;1m122 | [0m[35mdef _trace_parent(request: starlette.requests.Request) -> Iterator[None]:[0m
[30;1m123 | [0m[35m    token = _trace_parent_context.set([0m
[30;1m124 | [0m[35m        request.headers.get(definitions.OTEL_TRACE_PARENT_HEADER_KEY, "")[0m
[30;1m125 | [0m[35m    )[0m
[30;1m126 | [0m[35m    try:[0m
[30;1m127 | [0m[35m        yield[0m

[31m--[ [0m[34mMatch #[0m[33m795[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/remote_chainlet/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m294 | [0m[35m    │   Chainlet-Traceback (most recent call last):[0m
[30;1m295 | [0m[35m    │     File "/packages/itest_chain.py", line 87, in run_remote[0m
[30;1m296 | [0m[35m    │       generated_text = self._replicator.run_remote(data)[0m
[30;1m297 | [0m[35m    │   ValueError: (showing chained remote errors, root error at the bottom)[0m
[30;1m298 | [0m[35m    │   ├─ Error in dependency Chainlet `TextReplicator` (HTTP status 500):[0m
[30;1m299 | [0m[35m    │   │   Chainlet-Traceback (most recent call last):[0m
[30;1m300 | [0m[35m    │   │     File "/packages/itest_chain.py", line 52, in run_remote[0m

[31m--[ [0m[34mMatch #[0m[33m796[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/remote_chainlet/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m289 | [0m[35m        value = self._accumulate_parts(text_parts.parts)[0m
[30;1m290 | [0m[35m      File "/packages/itest_chain.py", line 144, in _accumulate_parts[0m
[30;1m291 | [0m[35m        value += self._text_to_num.run_remote(part)[0m
[30;1m292 | [0m[35m    ValueError: (showing chained remote errors, root error at the bottom)[0m
[30;1m293 | [0m[35m    ├─ Error in dependency Chainlet `TextToNum` (HTTP status 500):[0m
[30;1m294 | [0m[35m    │   Chainlet-Traceback (most recent call last):[0m
[30;1m295 | [0m[35m    │     File "/packages/itest_chain.py", line 87, in run_remote[0m

[31m--[ [0m[34mMatch #[0m[33m797[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/remote_chainlet/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m259 | [0m[35m    last_line = f"╰{last_line[1:]}" if last_line.startswith("│") else last_line[0m
[30;1m260 | [0m[35m    error_format = "\n".join(lines + [last_line])[0m
[30;1m261 | [0m[35m    msg = ([0m
[30;1m262 | [0m[35m        f"(showing chained remote errors, root error at the bottom)\n"[0m
[30;1m263 | [0m[35m        f"├─ {base_msg}\n"[0m
[30;1m264 | [0m[35m        f"{error_format}"[0m
[30;1m265 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m798[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/remote_chainlet/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35mdef _resolve_exception_class(error: definitions.RemoteErrorDetail) -> Type[Exception]:[0m
[30;1m210 | [0m[35m    """Tries to find the exception class in builtins or imported libs,[0m
[30;1m211 | [0m[35m    falls back to `definitions.GenericRemoteError` if not found."""[0m
[30;1m212 | [0m[35m    exception_cls = None[0m
[30;1m213 | [0m[35m    if error.exception_module_name is None:[0m

[31m--[ [0m[34mMatch #[0m[33m799[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/remote_chainlet/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m49 | [0m[35m        # corresponds to Chainlet `name` in the backend. As[0m
[30;1m50 | [0m[35m        # the dynamic Chainlet config is keyed on the backend[0m
[30;1m51 | [0m[35m        # Chainlet name, we have to look up config values by[0m
[30;1m52 | [0m[35m        # using the `display_name` in the service descriptor.[0m
[30;1m53 | [0m[35m        if display_name not in dynamic_chainlet_config:[0m
[30;1m54 | [0m[35m            raise definitions.MissingDependencyError([0m
[30;1m55 | [0m[35m                f"Chainlet '{display_name}' not found in "[0m

[31m--[ [0m[34mMatch #[0m[33m800[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/trt_llm/validation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35mdef _verify_has_class_init_arg(source: str, class_name: str, arg_name: str):[0m
[30;1m19 | [0m[35m    tree = ast.parse(source)[0m
[30;1m20 | [0m[35m    model_class_init_found = False[0m
[30;1m21 | [0m[35m    for node in tree.body:[0m
[30;1m22 | [0m[35m        if isinstance(node, ast.ClassDef) and node.name == class_name:[0m
[30;1m23 | [0m[35m            for child in node.body:[0m
[30;1m24 | [0m[35m                if child.name == "__init__":  # type: ignore[attr-defined][0m

[31m--[ [0m[34mMatch #[0m[33m801[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/remote_chainlet/stub.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m352 | [0m[35m        async def _rpc() -> AsyncIterator[bytes]:[0m
[30;1m353 | [0m[35m            client: aiohttp.ClientSession[0m
[30;1m354 | [0m[35m            async with self._client_async() as client:[0m
[30;1m355 | [0m[35m                response = await client.post([0m
[30;1m356 | [0m[35m                    self._service_descriptor.predict_url, **params[0m
[30;1m357 | [0m[35m                )[0m
[30;1m358 | [0m[35m                await utils.async_response_raise_errors(response, self.name)[0m

[31m--[ [0m[34mMatch #[0m[33m802[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/remote_chainlet/stub.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m325 | [0m[35m        async def _rpc() -> bytes:[0m
[30;1m326 | [0m[35m            client: aiohttp.ClientSession[0m
[30;1m327 | [0m[35m            async with self._client_async() as client:[0m
[30;1m328 | [0m[35m                async with client.post([0m
[30;1m329 | [0m[35m                    self._service_descriptor.predict_url, **params[0m
[30;1m330 | [0m[35m                ) as response:[0m
[30;1m331 | [0m[35m                    await utils.async_response_raise_errors(response, self.name)[0m

[31m--[ [0m[34mMatch #[0m[33m803[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/remote_chainlet/stub.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m290 | [0m[35m        def _rpc() -> bytes:[0m
[30;1m291 | [0m[35m            client: httpx.Client[0m
[30;1m292 | [0m[35m            with self._client_sync() as client:[0m
[30;1m293 | [0m[35m                response = client.post(self._service_descriptor.predict_url, **params)[0m
[30;1m294 | [0m[35m            utils.response_raise_errors(response, self.name)[0m
[30;1m295 | [0m[35m            return response.content[0m
[30;1m296 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m804[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/remote_chainlet/stub.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m373 | [0m[35m[0m
[30;1m374 | [0m[35m[0m
[30;1m375 | [0m[35mdef factory(stub_cls: Type[StubT], context: definitions.DeploymentContext) -> StubT:[0m
[30;1m376 | [0m[35m    # Assumes the stub_cls-name and the name of the service in ``context` match.[0m
[30;1m377 | [0m[35m    return stub_cls([0m
[30;1m378 | [0m[35m        service_descriptor=context.get_service_descriptor(stub_cls.__name__),[0m
[30;1m379 | [0m[35m        api_key=context.get_baseten_api_key(),[0m

[31m--[ [0m[34mMatch #[0m[33m805[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/remote_chainlet/stub.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m125 | [0m[35m    @contextlib.asynccontextmanager[0m
[30;1m126 | [0m[35m    async def _client_async(self) -> AsyncIterator[aiohttp.ClientSession]:[0m
[30;1m127 | [0m[35m        # Check `_client_cycle_needed` before and after locking to avoid[0m
[30;1m128 | [0m[35m        # needing a lock each time the client is accessed.[0m
[30;1m129 | [0m[35m        if self._client_cycle_needed(self._cached_async_client):[0m
[30;1m130 | [0m[35m            async with self._async_lock:[0m
[30;1m131 | [0m[35m                if self._client_cycle_needed(self._cached_async_client):[0m

[31m--[ [0m[34mMatch #[0m[33m806[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/remote_chainlet/stub.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m103 | [0m[35m    @contextlib.contextmanager[0m
[30;1m104 | [0m[35m    def _client_sync(self) -> Iterator[httpx.Client]:[0m
[30;1m105 | [0m[35m        # Check `_client_cycle_needed` before and after locking to avoid[0m
[30;1m106 | [0m[35m        # needing a lock each time the client is accessed.[0m
[30;1m107 | [0m[35m        if self._client_cycle_needed(self._cached_sync_client):[0m
[30;1m108 | [0m[35m            with self._sync_lock:[0m
[30;1m109 | [0m[35m                if self._client_cycle_needed(self._cached_sync_client):[0m

[31m--[ [0m[34mMatch #[0m[33m807[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/remote_chainlet/stub.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mimport json[0m
[30;1m5 | [0m[35mimport logging[0m
[30;1m6 | [0m[35mimport threading[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35mfrom typing import ([0m
[30;1m9 | [0m[35m    Any,[0m
[30;1m10 | [0m[35m    AsyncIterator,[0m
[30;1m11 | [0m[35m    ClassVar,[0m

[31m--[ [0m[34mMatch #[0m[33m808[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/custom_python_dx/my_model.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mserver that you're running it on.[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mThe main method to implement here is:[0m
[30;1m6 | [0m[35m* `predict`: runs every time the model server is called. Include any logic for model[0m
[30;1m7 | [0m[35m  inference and return the model output.[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mSee https://truss.baseten.co/quickstart for more.[0m

[31m--[ [0m[34mMatch #[0m[33m809[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_pyantic_v1/model/model.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35m* `load`: runs exactly once when the model server is spun up or patched and loads the[0m
[30;1m7 | [0m[35m   model onto the model server. Include any logic for initializing your model, such[0m
[30;1m8 | [0m[35m   as downloading model weights and loading the model into memory.[0m
[30;1m9 | [0m[35m* `predict`: runs every time the model server is called. Include any logic for model[0m
[30;1m10 | [0m[35m  inference and return the model output.[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mSee https://truss.baseten.co/quickstart for more.[0m

[31m--[ [0m[34mMatch #[0m[33m810[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/util/download.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35mdef download_from_url_using_requests(URL: str, download_to: Path):[0m
[30;1m77 | [0m[35m    # Streaming download to keep memory usage low[0m
[30;1m78 | [0m[35m    resp = requests.get([0m
[30;1m79 | [0m[35m        URL, allow_redirects=True, stream=True, timeout=BLOB_DOWNLOAD_TIMEOUT_SECS[0m
[30;1m80 | [0m[35m    )[0m
[30;1m81 | [0m[35m    resp.raise_for_status()[0m

[31m--[ [0m[34mMatch #[0m[33m811[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/util/download.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35mdef _b10cp_path() -> Optional[str]:[0m
[30;1m40 | [0m[35m    return os.environ.get(B10CP_PATH_TRUSS_ENV_VAR_NAME)[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35mdef _download_external_data_using_b10cp([0m

[31m--[ [0m[34mMatch #[0m[33m812[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/trtllm-audio/packages/whisper_trt/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m56 | [0m[35m    # This launches a subprocess to decode audio while down-mixing[0m
[30;1m57 | [0m[35m    # and resampling as necessary.  Requires the ffmpeg CLI in PATH.[0m
[30;1m58 | [0m[35m    # fmt: off[0m
[30;1m59 | [0m[35m    cmd = [[0m
[30;1m60 | [0m[35m        "ffmpeg", "-nostdin", "-threads", "0", "-i", file, "-f", "s16le", "-ac",[0m
[30;1m61 | [0m[35m        "1", "-acodec", "pcm_s16le", "-ar",[0m
[30;1m62 | [0m[35m        str(sr), "-"[0m

[31m--[ [0m[34mMatch #[0m[33m813[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/trtllm-audio/packages/whisper_trt/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m3 | [0m[35m#[0m
[30;1m4 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License");[0m
[30;1m5 | [0m[35m# you may not use this file except in compliance with the License.[0m
[30;1m6 | [0m[35m# You may obtain a copy of the License at[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# http://www.apache.org/licenses/LICENSE-2.0[0m
[30;1m9 | [0m[35m#[0m
[30;1m10 | [0m[35m# Unless required by applicable law or agreed to in writing, software[0m

[31m--[ [0m[34mMatch #[0m[33m814[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/deployment/code_gen.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m660 | [0m[35m            )[0m
[30;1m661 | [0m[35m    elif isinstance(image.base_image, str):  # This options is deprecated.[0m
[30;1m662 | [0m[35m        raise NotImplementedError([0m
[30;1m663 | [0m[35m            "Specifying docker base image as string is deprecated"[0m
[30;1m664 | [0m[35m        )[0m
[30;1m665 | [0m[35m[0m
[30;1m666 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m815[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/deployment/code_gen.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m638 | [0m[35m    if not (truss_git or truss_pypy):[0m
[30;1m639 | [0m[35m        truss_pip = f"truss=={truss.version()}"[0m
[30;1m640 | [0m[35m        logging.debug([0m
[30;1m641 | [0m[35m            f"Truss not found in pip requirements, auto-adding: `{truss_pip}`."[0m
[30;1m642 | [0m[35m        )[0m
[30;1m643 | [0m[35m        pip_requirements.add(truss_pip)[0m
[30;1m644 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m816[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/deployment/code_gen.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m600 | [0m[35m[0m
[30;1m601 | [0m[35m[0m
[30;1m602 | [0m[35mdef _make_requirements(image: definitions.DockerImage) -> list[str]:[0m
[30;1m603 | [0m[35m    """Merges file- and list-based requirements and adds truss git if not present."""[0m
[30;1m604 | [0m[35m    pip_requirements: set[str] = set()[0m
[30;1m605 | [0m[35m    if image.pip_requirements_file:[0m
[30;1m606 | [0m[35m        pip_requirements.update([0m

[31m--[ [0m[34mMatch #[0m[33m817[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/deployment/code_gen.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m536 | [0m[35m    )[0m
[30;1m537 | [0m[35m    class_definition: libcst.ClassDef = utils.expect_one([0m
[30;1m538 | [0m[35m        node[0m
[30;1m539 | [0m[35m        for node in skeleton_tree.body[0m
[30;1m540 | [0m[35m        if isinstance(node, libcst.ClassDef) and node.name.value == _MODEL_CLS_NAME[0m
[30;1m541 | [0m[35m    )[0m
[30;1m542 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m818[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/deployment/code_gen.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m535 | [0m[35m        )[0m
[30;1m536 | [0m[35m    )[0m
[30;1m537 | [0m[35m    class_definition: libcst.ClassDef = utils.expect_one([0m
[30;1m538 | [0m[35m        node[0m
[30;1m539 | [0m[35m        for node in skeleton_tree.body[0m
[30;1m540 | [0m[35m        if isinstance(node, libcst.ClassDef) and node.name.value == _MODEL_CLS_NAME[0m
[30;1m541 | [0m[35m    )[0m
[30;1m542 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m819[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/deployment/code_gen.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m527 | [0m[35m    skeleton_tree = libcst.parse_module(_MODEL_SKELETON_FILE.read_text())[0m
[30;1m528 | [0m[35m    imports: set[str] = set([0m
[30;1m529 | [0m[35m        libcst.Module(body=[node]).code[0m
[30;1m530 | [0m[35m        for node in skeleton_tree.body[0m
[30;1m531 | [0m[35m        if isinstance(node, libcst.SimpleStatementLine)[0m
[30;1m532 | [0m[35m        and any([0m
[30;1m533 | [0m[35m            isinstance(stmt, libcst.Import) or isinstance(stmt, libcst.ImportFrom)[0m

[31m--[ [0m[34mMatch #[0m[33m820[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss-chains/truss_chains/deployment/code_gen.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m19 | [0m[35m  entrypoint.py[0m
[30;1m20 | [0m[35m  ...[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m`shared_lib` can only be imported on the remote if its installed as a pip[0m
[30;1m23 | [0m[35mrequirement (site-package), it will not be copied from the local host.[0m
[30;1m24 | [0m[35m"""[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35mimport logging[0m

[31m--[ [0m[34mMatch #[0m[33m821[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/patch/dir_signature.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35m) -> Dict[str, str]:[0m
[30;1m11 | [0m[35m    """Calculate content signature of a filesystem directory.[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m    Sort all files by path, store file path with content hash.[0m
[30;1m14 | [0m[35m    Signatures are meant to track changes in directory. e.g.[0m
[30;1m15 | [0m[35m    A previous signature and the directory can be combined to create[0m
[30;1m16 | [0m[35m    a patch from the previous state.[0m

[31m--[ [0m[34mMatch #[0m[33m822[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/local/local_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m13 | [0m[35m    @staticmethod[0m
[30;1m14 | [0m[35m    def from_dict(d):[0m
[30;1m15 | [0m[35m        return LocalConfig([0m
[30;1m16 | [0m[35m            secrets=d.get("secrets", {}), use_sudo=d.get("use_sudo", False)[0m
[30;1m17 | [0m[35m        )[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m    @staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m823[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/local/local_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m13 | [0m[35m    @staticmethod[0m
[30;1m14 | [0m[35m    def from_dict(d):[0m
[30;1m15 | [0m[35m        return LocalConfig([0m
[30;1m16 | [0m[35m            secrets=d.get("secrets", {}), use_sudo=d.get("use_sudo", False)[0m
[30;1m17 | [0m[35m        )[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m    @staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m824[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_streaming_truss_with_tracing/model/model.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport json[0m
[30;1m2 | [0m[35mimport pathlib[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mfrom typing import Any, Generator, Sequence[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mimport opentelemetry.sdk.resources as resources[0m
[30;1m7 | [0m[35mimport opentelemetry.sdk.trace as sdk_trace[0m

[31m--[ [0m[34mMatch #[0m[33m825[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/patch/calc_patch.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m253 | [0m[35m    prev_config: TrussConfig, new_config: TrussConfig[0m
[30;1m254 | [0m[35m) -> List[Patch]:[0m
[30;1m255 | [0m[35m    """Calculate patch based on changes to config.yaml[0m
[30;1m256 | [0m[35m    If a change has been made to the config, at least one ConfigPatch is created[0m
[30;1m257 | [0m[35m    Additional patches are created for each of the patches that need specific application,[0m
[30;1m258 | [0m[35m    namely patches to the env variables, external package dirs, and/or external data.[0m
[30;1m259 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m826[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/patch/calc_patch.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m49 | [0m[35m        expressed with currently supported patches.[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m        Only standard and relevant truss paths are scanned for changes, rest[0m
[30;1m52 | [0m[35m        ignored. E.g. at the root level, only changes to config.yaml are[0m
[30;1m53 | [0m[35m        checked, any other changes are ignored.[0m
[30;1m54 | [0m[35m    """[0m
[30;1m55 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m827[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/patch/calc_patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m255 | [0m[35m    """Calculate patch based on changes to config.yaml[0m
[30;1m256 | [0m[35m    If a change has been made to the config, at least one ConfigPatch is created[0m
[30;1m257 | [0m[35m    Additional patches are created for each of the patches that need specific application,[0m
[30;1m258 | [0m[35m    namely patches to the env variables, external package dirs, and/or external data.[0m
[30;1m259 | [0m[35m[0m
[30;1m260 | [0m[35m    Empty list means no relevant differences found.[0m
[30;1m261 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m828[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/trtllm-briton/src/extension.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    def __init__(self, *args, **kwargs):[0m
[30;1m38 | [0m[35m        self._config = kwargs["config"][0m
[30;1m39 | [0m[35m        trt_llm_config = self._config.get("trt_llm")[0m
[30;1m40 | [0m[35m        config = TRTLLMConfiguration(**trt_llm_config)[0m
[30;1m41 | [0m[35m        if config.build.speculator:[0m
[30;1m42 | [0m[35m            self._model = SpecDecModel(*args, **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m829[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server/common/errors.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m139 | [0m[35m            last_matching_tb = current_tb[0m
[30;1m140 | [0m[35m        current_tb = current_tb.tb_next[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m    # If a match was found, truncate the traceback at the last occurrence[0m
[30;1m143 | [0m[35m    if last_matching_tb is not None:[0m
[30;1m144 | [0m[35m        return exc_type, exc_value, last_matching_tb  # type: ignore[return-value][0m
[30;1m145 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m830[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server/truss_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m426 | [0m[35m    def start(self):[0m
[30;1m427 | [0m[35m        log_level = ([0m
[30;1m428 | [0m[35m            "DEBUG"[0m
[30;1m429 | [0m[35m            if self._config["runtime"].get("enable_debug_logs", False)[0m
[30;1m430 | [0m[35m            else "INFO"[0m
[30;1m431 | [0m[35m        )[0m
[30;1m432 | [0m[35m        cfg = uvicorn.Config([0m

[31m--[ [0m[34mMatch #[0m[33m831[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/trtllm-audio/model/model.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m37 | [0m[35m        if audio_base64:[0m
[30;1m38 | [0m[35m            binary_data = base64.b64decode(audio_base64.encode("utf-8"))[0m
[30;1m39 | [0m[35m        elif audio_url:[0m
[30;1m40 | [0m[35m            resp = requests.get(audio_url)[0m
[30;1m41 | [0m[35m            binary_data = resp.content[0m
[30;1m42 | [0m[35m        return binary_data, request[0m
[30;1m43 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m832[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/trtllm-audio/model/model.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m    def preprocess(self, request: dict):[0m
[30;1m23 | [0m[35m        audio_base64 = request.get("audio")[0m
[30;1m24 | [0m[35m        audio_url = request.get("url")[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m        if audio_base64 and audio_url:[0m
[30;1m27 | [0m[35m            return {[0m

[31m--[ [0m[34mMatch #[0m[33m833[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/trtllm-audio/model/model.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m20 | [0m[35m        self._model = WhisperModel(str(self._data_dir), max_queue_time=0.050)[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m    def preprocess(self, request: dict):[0m
[30;1m23 | [0m[35m        audio_base64 = request.get("audio")[0m
[30;1m24 | [0m[35m        audio_url = request.get("url")[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m        if audio_base64 and audio_url:[0m

[31m--[ [0m[34mMatch #[0m[33m834[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/trtllm-audio/model/model.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35m            }[0m
[30;1m30 | [0m[35m        if not audio_base64 and not audio_url:[0m
[30;1m31 | [0m[35m            return {[0m
[30;1m32 | [0m[35m                "error": "Please provide either an audio file in base64 string format or a URL to an[0m
[30;1m33 | [0m[35m            }[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m        binary_data = None[0m

[31m--[ [0m[34mMatch #[0m[33m835[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/trtllm-audio/model/model.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m        if audio_base64 and audio_url:[0m
[30;1m27 | [0m[35m            return {[0m
[30;1m28 | [0m[35m                "error": "Only a base64 audio file OR a URL can be passed to the API, not both of th[0m
[30;1m29 | [0m[35m            }[0m
[30;1m30 | [0m[35m        if not audio_base64 and not audio_url:[0m
[30;1m31 | [0m[35m            return {[0m

[31m--[ [0m[34mMatch #[0m[33m836[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/trtllm-audio/model/model.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport requests[0m
[30;1m4 | [0m[35mimport sigint_patch[0m
[30;1m5 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m837[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m5 | [0m[35mfrom application import create_app[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mCONTROL_SERVER_PORT = int(os.environ.get("CONTROL_SERVER_PORT", "8080"))[0m
[30;1m8 | [0m[35mINFERENCE_SERVER_PORT = int(os.environ.get("INFERENCE_SERVER_PORT", "8090"))[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mdef _identify_python_executable_path() -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m838[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m4 | [0m[35mimport uvicorn[0m
[30;1m5 | [0m[35mfrom application import create_app[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mCONTROL_SERVER_PORT = int(os.environ.get("CONTROL_SERVER_PORT", "8080"))[0m
[30;1m8 | [0m[35mINFERENCE_SERVER_PORT = int(os.environ.get("INFERENCE_SERVER_PORT", "8090"))[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m839[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35m    if "PYTHON_EXECUTABLE" in os.environ:[0m
[30;1m13 | [0m[35m        return os.environ["PYTHON_EXECUTABLE"][0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m    raise RuntimeError("Unable to find python, make sure it's installed.")[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35mclass ControlServer:[0m

[31m--[ [0m[34mMatch #[0m[33m840[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m20 | [0m[35mclass AuthService:[0m
[30;1m21 | [0m[35m    def __init__(self, api_key: Optional[str] = None) -> None:[0m
[30;1m22 | [0m[35m        if not api_key:[0m
[30;1m23 | [0m[35m            api_key = os.environ.get("BASETEN_API_KEY", None)[0m
[30;1m24 | [0m[35m        self._api_key = api_key[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    def validate(self) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m841[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_custom_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m29 | [0m[35m        truss_server_addr = "http://localhost:8090"[0m
[30;1m30 | [0m[35m        full_url = f"{truss_server_addr}/v1/models/model:predict"[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m        response = requests.post(full_url, json={})[0m
[30;1m33 | [0m[35m        assert response.status_code == 200[0m
[30;1m34 | [0m[35m        assert response.json() == {[0m
[30;1m35 | [0m[35m            "message": "Hello World",[0m

[31m--[ [0m[34mMatch #[0m[33m842[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/docker_server/proxy.conf.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mserver {[0m
[30;1m2 | [0m[35m    # We use the proxy_read_timeout directive here (instead of proxy_send_timeout) as it sets the ti[0m
[30;1m3 | [0m[35m    listen 8080;[0m
[30;1m4 | [0m[35m    client_max_body_size {{client_max_body_size}};[0m
[30;1m5 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m843[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/docker_server/proxy.conf.jinja[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mserver {[0m
[30;1m2 | [0m[35m    # We use the proxy_read_timeout directive here (instead of proxy_send_timeout) as it sets the ti[0m
[30;1m3 | [0m[35m    listen 8080;[0m
[30;1m4 | [0m[35m    client_max_body_size {{client_max_body_size}};[0m
[30;1m5 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m844[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/util/log_utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m# TODO: add test.[0m
[30;1m7 | [0m[35mclass LogInterceptor(logging.Handler):[0m
[30;1m8 | [0m[35m    """This context manager intercepts logs at root level and allows to retrieve them[0m
[30;1m9 | [0m[35m    later. It uses the formatter of the first root handler (if present).[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m    Specifically it allows different threads to each have an instance of this context[0m

[31m--[ [0m[34mMatch #[0m[33m845[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/helpers/inference_server_starter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35m                logger.info([0m
[30;1m46 | [0m[35m                    f"Pinging {patch_ping_url} for patch with hash {truss_hash}"[0m
[30;1m47 | [0m[35m                )[0m
[30;1m48 | [0m[35m                resp = requests.post(patch_ping_url, json=payload)[0m
[30;1m49 | [0m[35m                resp.raise_for_status()[0m
[30;1m50 | [0m[35m                resp_body = resp.json()[0m
[30;1m51 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m846[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/helpers/inference_server_starter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m29 | [0m[35m    {"is_current": true}[0m
[30;1m30 | [0m[35m    {"accepted": true}[0m
[30;1m31 | [0m[35m    """[0m
[30;1m32 | [0m[35m    patch_ping_url = os.environ.get("PATCH_PING_URL_TRUSS")[0m
[30;1m33 | [0m[35m    if patch_ping_url is None:[0m
[30;1m34 | [0m[35m        inference_server_controller.start()[0m
[30;1m35 | [0m[35m        return[0m

[31m--[ [0m[34mMatch #[0m[33m847[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/control/control/helpers/inference_server_starter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35m    request has been accepted. Acceptance of request means that a patch will be[0m
[30;1m21 | [0m[35m    supplied soon to the truss (by calling of /control/patch endpoint).[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    If we find that our hash is current, we start the inference server[0m
[30;1m24 | [0m[35m    immediately. Otherwise, we delay the start to when the patch is supplied.[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    The goal is to start the inference server as soon as we have the latest[0m

[31m--[ [0m[34mMatch #[0m[33m848[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/server/test_model_wrapper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m    config["runtime"]["streaming_read_timeout"] = 5[0m
[30;1m92 | [0m[35m    model_wrapper = model_wrapper_class(config, sdk_trace.NoOpTracer())[0m
[30;1m93 | [0m[35m    model_wrapper.load()[0m
[30;1m94 | [0m[35m    assert model_wrapper._config.get("runtime").get("streaming_read_timeout") == 5[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m@pytest.mark.anyio[0m

[31m--[ [0m[34mMatch #[0m[33m849[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/server/test_model_wrapper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m    config["runtime"]["streaming_read_timeout"] = 5[0m
[30;1m92 | [0m[35m    model_wrapper = model_wrapper_class(config, sdk_trace.NoOpTracer())[0m
[30;1m93 | [0m[35m    model_wrapper.load()[0m
[30;1m94 | [0m[35m    assert model_wrapper._config.get("runtime").get("streaming_read_timeout") == 5[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m@pytest.mark.anyio[0m

[31m--[ [0m[34mMatch #[0m[33m850[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/server/test_model_wrapper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m233 | [0m[35m    in process, where these modules are loaded dyamically.[0m
[30;1m234 | [0m[35m    """[0m
[30;1m235 | [0m[35m    # These are left over by TrussModuleLoader used by local prediction tests.[0m
[30;1m236 | [0m[35m    # TODO(pankaj) Find a way for TrussModuleLoader to clean up after itself.[0m
[30;1m237 | [0m[35m    _remove_model_load_sys_modules()[0m
[30;1m238 | [0m[35m    yield[0m
[30;1m239 | [0m[35m    _remove_model_load_sys_modules()[0m

[31m--[ [0m[34mMatch #[0m[33m851[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/server/test_model_wrapper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport importlib[0m
[30;1m2 | [0m[35mimport os[0m
[30;1m3 | [0m[35mimport sys[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35mfrom contextlib import contextmanager[0m
[30;1m6 | [0m[35mfrom pathlib import Path[0m
[30;1m7 | [0m[35mfrom typing import Any[0m
[30;1m8 | [0m[35mfrom unittest.mock import MagicMock, Mock, patch[0m

[31m--[ [0m[34mMatch #[0m[33m852[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/templates/server/test_truss_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mimport socket[0m
[30;1m4 | [0m[35mimport sys[0m
[30;1m5 | [0m[35mimport tempfile[0m
[30;1m6 | [0m[35mimport time[0m
[30;1m7 | [0m[35mfrom multiprocessing import Process[0m
[30;1m8 | [0m[35mfrom pathlib import Path[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mimport pytest[0m

[31m--[ [0m[34mMatch #[0m[33m853[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m528 | [0m[35m[0m
[30;1m529 | [0m[35m    def get_all_secrets(self) -> Any:[0m
[30;1m530 | [0m[35m        headers = self._auth_token.header()[0m
[30;1m531 | [0m[35m        resp = requests.get(f"{self._rest_api_url}/v1/secrets", headers=headers)[0m
[30;1m532 | [0m[35m        if not resp.ok:[0m
[30;1m533 | [0m[35m            resp.raise_for_status()[0m
[30;1m534 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m854[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m517 | [0m[35m    def upsert_secret(self, name: str, value: str) -> Any:[0m
[30;1m518 | [0m[35m        headers = self._auth_token.header()[0m
[30;1m519 | [0m[35m        data = {"name": name, "value": value}[0m
[30;1m520 | [0m[35m        resp = requests.post([0m
[30;1m521 | [0m[35m            f"{self._rest_api_url}/v1/secrets", headers=headers, json=data[0m
[30;1m522 | [0m[35m        )[0m
[30;1m523 | [0m[35m        if not resp.ok:[0m

[31m--[ [0m[34mMatch #[0m[33m855[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m504 | [0m[35m[0m
[30;1m505 | [0m[35m    def get_deployment(self, model_id: str, deployment_id: str) -> Any:[0m
[30;1m506 | [0m[35m        headers = self._auth_token.header()[0m
[30;1m507 | [0m[35m        resp = requests.get([0m
[30;1m508 | [0m[35m            f"{self._rest_api_url}/v1/models/{model_id}/deployments/{deployment_id}",[0m
[30;1m509 | [0m[35m            headers=headers,[0m
[30;1m510 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m856[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m        if errors:[0m
[30;1m107 | [0m[35m            message = errors[0]["message"][0m
[30;1m108 | [0m[35m            error_code = errors[0].get("extensions", {}).get("code")[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m            raise ApiError(message, error_code)[0m
[30;1m111 | [0m[35m        return resp_dict[0m

[31m--[ [0m[34mMatch #[0m[33m857[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m        if errors:[0m
[30;1m107 | [0m[35m            message = errors[0]["message"][0m
[30;1m108 | [0m[35m            error_code = errors[0].get("extensions", {}).get("code")[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m            raise ApiError(message, error_code)[0m
[30;1m111 | [0m[35m        return resp_dict[0m

[31m--[ [0m[34mMatch #[0m[33m858[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m101 | [0m[35m            resp.raise_for_status()[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m        resp_dict = resp.json()[0m
[30;1m104 | [0m[35m        errors = resp_dict.get("errors")[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m        if errors:[0m
[30;1m107 | [0m[35m            message = errors[0]["message"][0m

[31m--[ [0m[34mMatch #[0m[33m859[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m89 | [0m[35m    def _post_graphql_query(self, query_string: str) -> dict:[0m
[30;1m90 | [0m[35m        headers = self._auth_token.header()[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m        resp = requests.post([0m
[30;1m93 | [0m[35m            self._graphql_api_url,[0m
[30;1m94 | [0m[35m            data={"query": query_string},[0m
[30;1m95 | [0m[35m            headers=headers,[0m

[31m--[ [0m[34mMatch #[0m[33m860[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m66 | [0m[35m    def __init__(self, remote_url: str, auth_service: AuthService) -> None:[0m
[30;1m67 | [0m[35m        graphql_api_url = f"{remote_url}/graphql/"[0m
[30;1m68 | [0m[35m        # Ensure we strip off trailing '/' to denormalize URLs.[0m
[30;1m69 | [0m[35m        rest_api_url = API_URL_MAPPING.get(remote_url.strip("/"), DEFAULT_API_DOMAIN)[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m        self._remote_url = remote_url[0m
[30;1m72 | [0m[35m        self._graphql_api_url = graphql_api_url[0m

[31m--[ [0m[34mMatch #[0m[33m861[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/remote_factory.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m125 | [0m[35m        # Add any additional params provided by the user in their .trussrc[0m
[30;1m126 | [0m[35m        additional_params = set(configs.keys()) - set(remote_params.keys())[0m
[30;1m127 | [0m[35m        for param in additional_params:[0m
[30;1m128 | [0m[35m            remote_params[param] = configs.get(param)[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m        return remote_class(**remote_params)  # type: ignore[0m

[31m--[ [0m[34mMatch #[0m[33m862[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/remote_factory.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m        remote_class = cls.REGISTRY[configs.pop("remote_provider")][0m
[30;1m121 | [0m[35m        remote_params = {[0m
[30;1m122 | [0m[35m            param: configs.get(param) for param in cls.required_params(remote_class)[0m
[30;1m123 | [0m[35m        }[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m        # Add any additional params provided by the user in their .trussrc[0m

[31m--[ [0m[34mMatch #[0m[33m863[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/remote_factory.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m87 | [0m[35m                f"Remote provider {remote_config['remote_provider']} not found in registry"[0m
[30;1m88 | [0m[35m            )[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m        remote = RemoteFactory.REGISTRY.get(remote_config["remote_provider"])[0m
[30;1m91 | [0m[35m        if remote:[0m
[30;1m92 | [0m[35m            required_params = RemoteFactory.required_params(remote)[0m
[30;1m93 | [0m[35m            missing_params = required_params - set(remote_config.keys())[0m

[31m--[ [0m[34mMatch #[0m[33m864[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/remote_factory.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m17 | [0m[35mfrom truss.remote.baseten import BasetenRemote[0m
[30;1m18 | [0m[35mfrom truss.remote.truss_remote import RemoteConfig, TrussRemote[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35mUSER_TRUSSRC_PATH = Path(os.environ.get("USER_TRUSSRC_PATH", "~/.trussrc")).expanduser()[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mdef load_config() -> ConfigParser:[0m

[31m--[ [0m[34mMatch #[0m[33m865[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/tests/test_data/test_streaming_truss/model/model.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35mfrom typing import Any, Dict, List[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mclass Model:[0m

[31m--[ [0m[34mMatch #[0m[33m866[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/remote.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m537 | [0m[35m        else:[0m
[30;1m538 | [0m[35m            return PatchResult([0m
[30;1m539 | [0m[35m                PatchStatus.SUCCESS,[0m
[30;1m540 | [0m[35m                resp.get([0m
[30;1m541 | [0m[35m                    "success_message", f"Model {model_name} patched successfully."[0m
[30;1m542 | [0m[35m                ),[0m
[30;1m543 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m867[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/remote.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m522 | [0m[35m                PatchStatus.FAILED, f"Failed to patch draft deployment. {e}"[0m
[30;1m523 | [0m[35m            )[0m
[30;1m524 | [0m[35m        if not resp["succeeded"]:[0m
[30;1m525 | [0m[35m            needs_full_deploy = resp.get("needs_full_deploy", None)[0m
[30;1m526 | [0m[35m            if needs_full_deploy:[0m
[30;1m527 | [0m[35m                message = ([0m
[30;1m528 | [0m[35m                    f"Model {model_name} is not able to be patched: `{resp['error']}`. "[0m

[31m--[ [0m[34mMatch #[0m[33m868[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/remote.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m446 | [0m[35m            )[0m
[30;1m447 | [0m[35m[0m
[30;1m448 | [0m[35m        truss_hash = dev_version.get("truss_hash", None)[0m
[30;1m449 | [0m[35m        truss_signature = dev_version.get("truss_signature", None)[0m
[30;1m450 | [0m[35m        if not (truss_hash and truss_signature):[0m
[30;1m451 | [0m[35m            return PatchResult([0m
[30;1m452 | [0m[35m                PatchStatus.FAILED,[0m

[31m--[ [0m[34mMatch #[0m[33m869[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/remote.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m445 | [0m[35m                f"No development deployment found for model: {model_name}.",[0m
[30;1m446 | [0m[35m            )[0m
[30;1m447 | [0m[35m[0m
[30;1m448 | [0m[35m        truss_hash = dev_version.get("truss_hash", None)[0m
[30;1m449 | [0m[35m        truss_signature = dev_version.get("truss_signature", None)[0m
[30;1m450 | [0m[35m        if not (truss_hash and truss_signature):[0m
[30;1m451 | [0m[35m            return PatchResult([0m

[31m--[ [0m[34mMatch #[0m[33m870[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/remote.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m375 | [0m[35m        except KeyError:[0m
[30;1m376 | [0m[35m            raise ValueError("Baseten Service requires a model_identifier")[0m
[30;1m377 | [0m[35m[0m
[30;1m378 | [0m[35m        published = kwargs.get("published", False)[0m
[30;1m379 | [0m[35m        (service_url_path, model_id, model_version_id) = ([0m
[30;1m380 | [0m[35m            self._get_service_url_path_and_model_ids([0m
[30;1m381 | [0m[35m                self._api, model_identifier, published[0m

[31m--[ [0m[34mMatch #[0m[33m871[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000703[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Username[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/remote.py[0m
   Pattern: [32m.userInfo[0m
[30;1m109 | [0m[35m            )[0m
[30;1m110 | [0m[35m        ][0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m    def whoami(self) -> RemoteUser:[0m
[30;1m113 | [0m[35m        resp = self._api._post_graphql_query([0m
[30;1m114 | [0m[35m            "query{organization{workspace_name}user{email}}"[0m
[30;1m115 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m872[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/remote.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m417 | [0m[35m        console.print(f"🚰 Attempting to sync truss at '{watch_path}' with remote")[0m
[30;1m418 | [0m[35m        self.patch(watch_path, truss_ignore_patterns, console, error_console)[0m
[30;1m419 | [0m[35m[0m
[30;1m420 | [0m[35m        console.print(f"👀 Watching for changes to truss at '{watch_path}' ...")[0m
[30;1m421 | [0m[35m        for _ in watch(watch_path, watch_filter=watch_filter, raise_interrupt=False):[0m
[30;1m422 | [0m[35m            self.patch(watch_path, truss_ignore_patterns, console, error_console)[0m
[30;1m423 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m873[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/remote.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m414 | [0m[35m        # disable watchfiles logger[0m
[30;1m415 | [0m[35m        logging.getLogger("watchfiles.main").disabled = True[0m
[30;1m416 | [0m[35m[0m
[30;1m417 | [0m[35m        console.print(f"🚰 Attempting to sync truss at '{watch_path}' with remote")[0m
[30;1m418 | [0m[35m        self.patch(watch_path, truss_ignore_patterns, console, error_console)[0m
[30;1m419 | [0m[35m[0m
[30;1m420 | [0m[35m        console.print(f"👀 Watching for changes to truss at '{watch_path}' ...")[0m

[31m--[ [0m[34mMatch #[0m[33m874[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m515 | [0m[35m[0m
[30;1m516 | [0m[35m        except ReadTimeout:[0m
[30;1m517 | [0m[35m            return PatchResult([0m
[30;1m518 | [0m[35m                PatchStatus.FAILED, "Read Timeout when attempting to patch remote."[0m
[30;1m519 | [0m[35m            )[0m
[30;1m520 | [0m[35m        except Exception as e:[0m
[30;1m521 | [0m[35m            return PatchResult([0m

[31m--[ [0m[34mMatch #[0m[33m875[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m453 | [0m[35m                ([0m
[30;1m454 | [0m[35m                    "Failed to inspect a running remote deployment to watch for "[0m
[30;1m455 | [0m[35m                    "changes.  Ensure that there exists a running remote deployment"[0m
[30;1m456 | [0m[35m                    " before attempting to watch for changes."[0m
[30;1m457 | [0m[35m                ),[0m
[30;1m458 | [0m[35m            )[0m
[30;1m459 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m876[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m451 | [0m[35m            return PatchResult([0m
[30;1m452 | [0m[35m                PatchStatus.FAILED,[0m
[30;1m453 | [0m[35m                ([0m
[30;1m454 | [0m[35m                    "Failed to inspect a running remote deployment to watch for "[0m
[30;1m455 | [0m[35m                    "changes.  Ensure that there exists a running remote deployment"[0m
[30;1m456 | [0m[35m                    " before attempting to watch for changes."[0m
[30;1m457 | [0m[35m                ),[0m

[31m--[ [0m[34mMatch #[0m[33m877[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m373 | [0m[35m        try:[0m
[30;1m374 | [0m[35m            model_identifier = kwargs["model_identifier"][0m
[30;1m375 | [0m[35m        except KeyError:[0m
[30;1m376 | [0m[35m            raise ValueError("Baseten Service requires a model_identifier")[0m
[30;1m377 | [0m[35m[0m
[30;1m378 | [0m[35m        published = kwargs.get("published", False)[0m
[30;1m379 | [0m[35m        (service_url_path, model_id, model_version_id) = ([0m

[31m--[ [0m[34mMatch #[0m[33m878[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m352 | [0m[35m            service_url_path = f"/model_versions/{model_version_id}"[0m
[30;1m353 | [0m[35m        elif isinstance(model_identifier, ModelId):[0m
[30;1m354 | [0m[35m            # TODO(helen): consider making this consistent with getting the[0m
[30;1m355 | [0m[35m            # service via model_name / respect --published in service_url_path.[0m
[30;1m356 | [0m[35m            try:[0m
[30;1m357 | [0m[35m                model = api.get_model_by_id(model_identifier.value)[0m
[30;1m358 | [0m[35m            except ApiError:[0m

[31m--[ [0m[34mMatch #[0m[33m879[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/remote/baseten/remote.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m42 | [0m[35mfrom truss.truss_handle import build as truss_build[0m
[30;1m43 | [0m[35mfrom truss.truss_handle.truss_handle import TrussHandle[0m
[30;1m44 | [0m[35mfrom truss.util.path import is_ignored, load_trussignore_patterns_from_truss_dir[0m
[30;1m45 | [0m[35mfrom watchfiles import watch[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35mclass PatchStatus(enum.Enum):[0m
[30;1m49 | [0m[35m    SUCCESS = enum.auto()[0m

[31m--[ [0m[34mMatch #[0m[33m880[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/truss_handle/patch/hash.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35m) -> str:[0m
[30;1m12 | [0m[35m    """Calculate content based hash of a filesystem directory.[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m    Rough algo: Sort all files by path, then take hash of a content stream, where[0m
[30;1m15 | [0m[35m    we write path hash to the stream followed by hash of content if path is a file.[0m
[30;1m16 | [0m[35m    Note the hash of hash aspect.[0m
[30;1m17 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m881[0m[34m of [0m[33m881[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/truss-0.60.0/truss/templates/server/main.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m5 | [0m[35mCONFIG_FILE = "config.yaml"[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mif __name__ == "__main__":[0m
[30;1m8 | [0m[35m    http_port = int(os.environ.get("INFERENCE_SERVER_PORT", "8080"))[0m
[30;1m9 | [0m[35m    TrussServer(http_port, CONFIG_FILE).start()[0m

881 matches found.
