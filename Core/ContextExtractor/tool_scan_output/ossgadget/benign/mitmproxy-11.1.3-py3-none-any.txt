[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/proxy/layers/quic/_stream_layers.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m632 | [0m[35m        certificate=settings.certificate,[0m
[30;1m633 | [0m[35m        certificate_chain=settings.certificate_chain,[0m
[30;1m634 | [0m[35m        cipher_suites=settings.cipher_suites,[0m
[30;1m635 | [0m[35m        private_key=settings.certificate_private_key,[0m
[30;1m636 | [0m[35m        verify_mode=settings.verify_mode,[0m
[30;1m637 | [0m[35m        max_datagram_frame_size=65536,[0m
[30;1m638 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/proxy/layers/quic/_stream_layers.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m632 | [0m[35m        certificate=settings.certificate,[0m
[30;1m633 | [0m[35m        certificate_chain=settings.certificate_chain,[0m
[30;1m634 | [0m[35m        cipher_suites=settings.cipher_suites,[0m
[30;1m635 | [0m[35m        private_key=settings.certificate_private_key,[0m
[30;1m636 | [0m[35m        verify_mode=settings.verify_mode,[0m
[30;1m637 | [0m[35m        max_datagram_frame_size=65536,[0m
[30;1m638 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/proxy/layers/quic/_client_hello_parser.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m58 | [0m[35m        configuration=QuicConfiguration([0m
[30;1m59 | [0m[35m            is_client=False,[0m
[30;1m60 | [0m[35m            certificate="",[0m
[30;1m61 | [0m[35m            private_key="",[0m
[30;1m62 | [0m[35m            quic_logger=QuicLogger(),[0m
[30;1m63 | [0m[35m        ),[0m
[30;1m64 | [0m[35m        original_destination_connection_id=header.destination_cid,[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.css[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/proxy/layers/modes.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m294 | [0m[35m            yield commands.CloseConnection(self.context.client)[0m
[30;1m295 | [0m[35m        else:[0m
[30;1m296 | [0m[35m            yield commands.SendData([0m
[30;1m297 | [0m[35m                self.context.client, b"\x05\x00\x00\x01\x00\x00\x00\x00\x00\x00"[0m
[30;1m298 | [0m[35m            )[0m
[30;1m299 | [0m[35m            if self.buf:[0m
[30;1m300 | [0m[35m                yield from self.child_layer.handle_event([0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/proxy/layers/modes.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m289 | [0m[35m        err = yield from self.finish_start()[0m
[30;1m290 | [0m[35m        if err:[0m
[30;1m291 | [0m[35m            yield commands.SendData([0m
[30;1m292 | [0m[35m                self.context.client, b"\x05\x04\x00\x01\x00\x00\x00\x00\x00\x00"[0m
[30;1m293 | [0m[35m            )[0m
[30;1m294 | [0m[35m            yield commands.CloseConnection(self.context.client)[0m
[30;1m295 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/proxy/layers/modes.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m142 | [0m[35m            yield commands.SendData([0m
[30;1m143 | [0m[35m                self.context.client,[0m
[30;1m144 | [0m[35m                bytes([SOCKS5_VERSION, reply_code])[0m
[30;1m145 | [0m[35m                + b"\x00\x01\x00\x00\x00\x00\x00\x00",[0m
[30;1m146 | [0m[35m            )[0m
[30;1m147 | [0m[35m        yield commands.CloseConnection(self.context.client)[0m
[30;1m148 | [0m[35m        yield commands.Log(message)[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/proxy/layers/modes.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m222 | [0m[35m            "utf-8", "backslashreplace"[0m
[30;1m223 | [0m[35m        )[0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35m        data = Socks5AuthData(self.context.client, user, password)[0m
[30;1m226 | [0m[35m        yield Socks5AuthHook(data)[0m
[30;1m227 | [0m[35m        if not data.valid:[0m
[30;1m228 | [0m[35m            # The VER field contains the current **version of the subnegotiation**, which is X'01'.[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/proxy/layers/modes.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m218 | [0m[35m        if len(self.buf) < 3 + user_len + pass_len:[0m
[30;1m219 | [0m[35m            return[0m
[30;1m220 | [0m[35m        user = self.buf[2 : (2 + user_len)].decode("utf-8", "backslashreplace")[0m
[30;1m221 | [0m[35m        password = self.buf[(3 + user_len) : (3 + user_len + pass_len)].decode([0m
[30;1m222 | [0m[35m            "utf-8", "backslashreplace"[0m
[30;1m223 | [0m[35m        )[0m
[30;1m224 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/proxy/layers/modes.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m210 | [0m[35m        if len(self.buf) < 3:[0m
[30;1m211 | [0m[35m            return[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m        # Parsing username and password, which is somewhat atrocious[0m
[30;1m214 | [0m[35m        user_len = self.buf[1][0m
[30;1m215 | [0m[35m        if len(self.buf) < 3 + user_len:[0m
[30;1m216 | [0m[35m            return[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/proxy/layers/modes.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m192 | [0m[35m        if method not in self.buf[2 : 2 + n_methods]:[0m
[30;1m193 | [0m[35m            method_str = ([0m
[30;1m194 | [0m[35m                "user/password"[0m
[30;1m195 | [0m[35m                if method == SOCKS5_METHOD_USER_PASSWORD_AUTHENTICATION[0m
[30;1m196 | [0m[35m                else "no"[0m
[30;1m197 | [0m[35m            )[0m
[30;1m198 | [0m[35m            yield from self.socks_err([0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/proxy/layers/modes.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m        if method not in self.buf[2 : 2 + n_methods]:[0m
[30;1m193 | [0m[35m            method_str = ([0m
[30;1m194 | [0m[35m                "user/password"[0m
[30;1m195 | [0m[35m                if method == SOCKS5_METHOD_USER_PASSWORD_AUTHENTICATION[0m
[30;1m196 | [0m[35m                else "no"[0m
[30;1m197 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/proxy/layers/modes.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m183 | [0m[35m            return[0m
[30;1m184 | [0m[35m[0m
[30;1m185 | [0m[35m        if "proxyauth" in self.context.options and self.context.options.proxyauth:[0m
[30;1m186 | [0m[35m            method = SOCKS5_METHOD_USER_PASSWORD_AUTHENTICATION[0m
[30;1m187 | [0m[35m            self.state = self.state_auth[0m
[30;1m188 | [0m[35m        else:[0m
[30;1m189 | [0m[35m            method = SOCKS5_METHOD_NO_AUTHENTICATION_REQUIRED[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/proxy/layers/modes.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m122 | [0m[35m@dataclass[0m
[30;1m123 | [0m[35mclass Socks5AuthHook(StartHook):[0m
[30;1m124 | [0m[35m    """[0m
[30;1m125 | [0m[35m    Mitmproxy has received username/password SOCKS5 credentials.[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m    This hook decides whether they are valid by setting `data.valid`.[0m
[30;1m128 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/proxy/layers/modes.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m115 | [0m[35mclass Socks5AuthData:[0m
[30;1m116 | [0m[35m    client_conn: connection.Client[0m
[30;1m117 | [0m[35m    username: str[0m
[30;1m118 | [0m[35m    password: str[0m
[30;1m119 | [0m[35m    valid: bool = False[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/proxy/layers/modes.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m99 | [0m[35mSOCKS5_VERSION = 0x05[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35mSOCKS5_METHOD_NO_AUTHENTICATION_REQUIRED = 0x00[0m
[30;1m102 | [0m[35mSOCKS5_METHOD_USER_PASSWORD_AUTHENTICATION = 0x02[0m
[30;1m103 | [0m[35mSOCKS5_METHOD_NO_ACCEPTABLE_METHODS = 0xFF[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35mSOCKS5_ATYP_IPV4_ADDRESS = 0x01[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/contrib/kaitaistruct/png.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m47 | [0m[35m    def _read(self):[0m
[30;1m48 | [0m[35m        self.magic = self._io.read_bytes(8)[0m
[30;1m49 | [0m[35m        if not self.magic == b"\x89\x50\x4E\x47\x0D\x0A\x1A\x0A":[0m
[30;1m50 | [0m[35m            raise kaitaistruct.ValidationNotEqualError(b"\x89\x50\x4E\x47\x0D\x0A\x1A\x0A", self.mag[0m
[30;1m51 | [0m[35m        self.ihdr_len = self._io.read_u4be()[0m
[30;1m52 | [0m[35m        if not self.ihdr_len == 13:[0m
[30;1m53 | [0m[35m            raise kaitaistruct.ValidationNotEqualError(13, self.ihdr_len, self._io, u"/seq/1")[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/contrib/kaitaistruct/png.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    def _read(self):[0m
[30;1m48 | [0m[35m        self.magic = self._io.read_bytes(8)[0m
[30;1m49 | [0m[35m        if not self.magic == b"\x89\x50\x4E\x47\x0D\x0A\x1A\x0A":[0m
[30;1m50 | [0m[35m            raise kaitaistruct.ValidationNotEqualError(b"\x89\x50\x4E\x47\x0D\x0A\x1A\x0A", self.mag[0m
[30;1m51 | [0m[35m        self.ihdr_len = self._io.read_u4be()[0m
[30;1m52 | [0m[35m        if not self.ihdr_len == 13:[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/contrib/kaitaistruct/ico.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m86 | [0m[35m            if hasattr(self, '_m_is_png'):[0m
[30;1m87 | [0m[35m                return self._m_is_png[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m            self._m_is_png = self.png_header == b"\x89\x50\x4E\x47\x0D\x0A\x1A\x0A"[0m
[30;1m90 | [0m[35m            return getattr(self, '_m_is_png', None)[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/contrib/wbxml/ASWBXML.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m715 | [0m[35m		page.addToken(0x12, "EmptyFolderContents")[0m
[30;1m716 | [0m[35m		page.addToken(0x13, "DeleteSubFolders")[0m
[30;1m717 | [0m[35m		page.addToken(0x14, "UserName")[0m
[30;1m718 | [0m[35m		page.addToken(0x15, "Password")[0m
[30;1m719 | [0m[35m		page.addToken(0x16, "Move")[0m
[30;1m720 | [0m[35m		page.addToken(0x17, "DstFldId")[0m
[30;1m721 | [0m[35m		page.addToken(0x18, "ConversationId")[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/contrib/wbxml/ASWBXML.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m651 | [0m[35m		page.addToken(0x12, "ReplyMessage")[0m
[30;1m652 | [0m[35m		page.addToken(0x13, "BodyType")[0m
[30;1m653 | [0m[35m		page.addToken(0x14, "DevicePassword")[0m
[30;1m654 | [0m[35m		page.addToken(0x15, "Password")[0m
[30;1m655 | [0m[35m		page.addToken(0x16, "DeviceInformation")[0m
[30;1m656 | [0m[35m		page.addToken(0x17, "Model")[0m
[30;1m657 | [0m[35m		page.addToken(0x18, "IMEI")[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/contrib/wbxml/ASWBXML.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m650 | [0m[35m		page.addToken(0x11, "Enabled")[0m
[30;1m651 | [0m[35m		page.addToken(0x12, "ReplyMessage")[0m
[30;1m652 | [0m[35m		page.addToken(0x13, "BodyType")[0m
[30;1m653 | [0m[35m		page.addToken(0x14, "DevicePassword")[0m
[30;1m654 | [0m[35m		page.addToken(0x15, "Password")[0m
[30;1m655 | [0m[35m		page.addToken(0x16, "DeviceInformation")[0m
[30;1m656 | [0m[35m		page.addToken(0x17, "Model")[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/contrib/wbxml/ASWBXML.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m567 | [0m[35m		page.addToken(0x1A, "LessThan")[0m
[30;1m568 | [0m[35m		page.addToken(0x1B, "GreaterThan")[0m
[30;1m569 | [0m[35m		page.addToken(0x1E, "UserName")[0m
[30;1m570 | [0m[35m		page.addToken(0x1F, "Password")[0m
[30;1m571 | [0m[35m		page.addToken(0x20, "ConversationId")[0m
[30;1m572 | [0m[35m		page.addToken(0x21, "Picture")[0m
[30;1m573 | [0m[35m		page.addToken(0x22, "MaxSize")[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/contrib/wbxml/ASWBXML.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m509 | [0m[35m		page.addToken(0x1D, "RequireDeviceEncryption")[0m
[30;1m510 | [0m[35m		page.addToken(0x1E, "AllowUnsignedApplications")[0m
[30;1m511 | [0m[35m		page.addToken(0x1F, "AllowUnsignedInstallationPackages")[0m
[30;1m512 | [0m[35m		page.addToken(0x20, "MinDevicePasswordComplexCharacters")[0m
[30;1m513 | [0m[35m		page.addToken(0x21, "AllowWiFi")[0m
[30;1m514 | [0m[35m		page.addToken(0x22, "AllowTextMessaging")[0m
[30;1m515 | [0m[35m		page.addToken(0x23, "AllowPOPIMAPEmail")[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/contrib/wbxml/ASWBXML.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m503 | [0m[35m		page.addToken(0x17, "MaxAttachmentSize")[0m
[30;1m504 | [0m[35m		page.addToken(0x18, "AllowSimpleDevicePassword")[0m
[30;1m505 | [0m[35m		page.addToken(0x19, "DevicePasswordExpiration")[0m
[30;1m506 | [0m[35m		page.addToken(0x1A, "DevicePasswordHistory")[0m
[30;1m507 | [0m[35m		page.addToken(0x1B, "AllowStorageCard")[0m
[30;1m508 | [0m[35m		page.addToken(0x1C, "AllowCamera")[0m
[30;1m509 | [0m[35m		page.addToken(0x1D, "RequireDeviceEncryption")[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/contrib/wbxml/ASWBXML.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m502 | [0m[35m		page.addToken(0x16, "MaxDevicePasswordFailedAttempts")[0m
[30;1m503 | [0m[35m		page.addToken(0x17, "MaxAttachmentSize")[0m
[30;1m504 | [0m[35m		page.addToken(0x18, "AllowSimpleDevicePassword")[0m
[30;1m505 | [0m[35m		page.addToken(0x19, "DevicePasswordExpiration")[0m
[30;1m506 | [0m[35m		page.addToken(0x1A, "DevicePasswordHistory")[0m
[30;1m507 | [0m[35m		page.addToken(0x1B, "AllowStorageCard")[0m
[30;1m508 | [0m[35m		page.addToken(0x1C, "AllowCamera")[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/contrib/wbxml/ASWBXML.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m501 | [0m[35m		page.addToken(0x15, "MaxInactivityTimeDeviceLock")[0m
[30;1m502 | [0m[35m		page.addToken(0x16, "MaxDevicePasswordFailedAttempts")[0m
[30;1m503 | [0m[35m		page.addToken(0x17, "MaxAttachmentSize")[0m
[30;1m504 | [0m[35m		page.addToken(0x18, "AllowSimpleDevicePassword")[0m
[30;1m505 | [0m[35m		page.addToken(0x19, "DevicePasswordExpiration")[0m
[30;1m506 | [0m[35m		page.addToken(0x1A, "DevicePasswordHistory")[0m
[30;1m507 | [0m[35m		page.addToken(0x1B, "AllowStorageCard")[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/contrib/wbxml/ASWBXML.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m499 | [0m[35m		page.addToken(0x13, "AttachmentsEnabled")[0m
[30;1m500 | [0m[35m		page.addToken(0x14, "MinDevicePasswordLength")[0m
[30;1m501 | [0m[35m		page.addToken(0x15, "MaxInactivityTimeDeviceLock")[0m
[30;1m502 | [0m[35m		page.addToken(0x16, "MaxDevicePasswordFailedAttempts")[0m
[30;1m503 | [0m[35m		page.addToken(0x17, "MaxAttachmentSize")[0m
[30;1m504 | [0m[35m		page.addToken(0x18, "AllowSimpleDevicePassword")[0m
[30;1m505 | [0m[35m		page.addToken(0x19, "DevicePasswordExpiration")[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/contrib/wbxml/ASWBXML.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m497 | [0m[35m		page.addToken(0x10, "RequireStorageCardEncryption")[0m
[30;1m498 | [0m[35m		page.addToken(0x11, "PasswordRecoveryEnabled")[0m
[30;1m499 | [0m[35m		page.addToken(0x13, "AttachmentsEnabled")[0m
[30;1m500 | [0m[35m		page.addToken(0x14, "MinDevicePasswordLength")[0m
[30;1m501 | [0m[35m		page.addToken(0x15, "MaxInactivityTimeDeviceLock")[0m
[30;1m502 | [0m[35m		page.addToken(0x16, "MaxDevicePasswordFailedAttempts")[0m
[30;1m503 | [0m[35m		page.addToken(0x17, "MaxAttachmentSize")[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/contrib/wbxml/ASWBXML.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m495 | [0m[35m		page.addToken(0x0E, "DevicePasswordEnabled")[0m
[30;1m496 | [0m[35m		page.addToken(0x0F, "AlphanumericDevicePasswordRequired")[0m
[30;1m497 | [0m[35m		page.addToken(0x10, "RequireStorageCardEncryption")[0m
[30;1m498 | [0m[35m		page.addToken(0x11, "PasswordRecoveryEnabled")[0m
[30;1m499 | [0m[35m		page.addToken(0x13, "AttachmentsEnabled")[0m
[30;1m500 | [0m[35m		page.addToken(0x14, "MinDevicePasswordLength")[0m
[30;1m501 | [0m[35m		page.addToken(0x15, "MaxInactivityTimeDeviceLock")[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/contrib/wbxml/ASWBXML.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m493 | [0m[35m		page.addToken(0x0C, "RemoteWipe")[0m
[30;1m494 | [0m[35m		page.addToken(0x0D, "EASProvisionDoc")[0m
[30;1m495 | [0m[35m		page.addToken(0x0E, "DevicePasswordEnabled")[0m
[30;1m496 | [0m[35m		page.addToken(0x0F, "AlphanumericDevicePasswordRequired")[0m
[30;1m497 | [0m[35m		page.addToken(0x10, "RequireStorageCardEncryption")[0m
[30;1m498 | [0m[35m		page.addToken(0x11, "PasswordRecoveryEnabled")[0m
[30;1m499 | [0m[35m		page.addToken(0x13, "AttachmentsEnabled")[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/contrib/wbxml/ASWBXML.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m492 | [0m[35m		page.addToken(0x0B, "Status")[0m
[30;1m493 | [0m[35m		page.addToken(0x0C, "RemoteWipe")[0m
[30;1m494 | [0m[35m		page.addToken(0x0D, "EASProvisionDoc")[0m
[30;1m495 | [0m[35m		page.addToken(0x0E, "DevicePasswordEnabled")[0m
[30;1m496 | [0m[35m		page.addToken(0x0F, "AlphanumericDevicePasswordRequired")[0m
[30;1m497 | [0m[35m		page.addToken(0x10, "RequireStorageCardEncryption")[0m
[30;1m498 | [0m[35m		page.addToken(0x11, "PasswordRecoveryEnabled")[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy-11.1.3.dist-info/METADATA[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m  | [0m[35my/mitmproxy/actions?query=branch%3Amain)[0m
[30;1m  | [0m[35m[![Codacy Badge](https://app.codacy.com/project/badge/Grade/a38b0325dfb944839c0c8da354f70b1b)](https[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/upstream_auth.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m13 | [0m[35m    pattern = re.compile(".+:")[0m
[30;1m14 | [0m[35m    if pattern.search(auth) is None:[0m
[30;1m15 | [0m[35m        raise exceptions.OptionsError("Invalid upstream auth specification: %s" % auth)[0m
[30;1m16 | [0m[35m    return b"Basic" + b" " + base64.b64encode(strutils.always_bytes(auth))[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35mclass UpstreamAuth:[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/upstream_auth.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mimport re[0m
[30;1m3 | [0m[35mfrom typing import Optional[0m
[30;1m4 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/upstream_auth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m36 | [0m[35m            None,[0m
[30;1m37 | [0m[35m            """[0m
[30;1m38 | [0m[35m            Add HTTP Basic authentication to upstream proxy and reverse proxy[0m
[30;1m39 | [0m[35m            requests. Format: username:password.[0m
[30;1m40 | [0m[35m            """,[0m
[30;1m41 | [0m[35m        )[0m
[30;1m42 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/proxy/mode_servers.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m413 | [0m[35m        return textwrap.dedent([0m
[30;1m414 | [0m[35m            f"""[0m
[30;1m415 | [0m[35m            [Interface][0m
[30;1m416 | [0m[35m            PrivateKey = {self.client_key}[0m
[30;1m417 | [0m[35m            Address = 10.0.0.1/32[0m
[30;1m418 | [0m[35m            DNS = 10.0.0.53[0m
[30;1m419 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/proxy/layers/quic/_hooks.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m27 | [0m[35m    certificate_chain: list[x509.Certificate] = field(default_factory=list)[0m
[30;1m28 | [0m[35m    """A list of additional certificates to send to the peer."""[0m
[30;1m29 | [0m[35m    certificate_private_key: ([0m
[30;1m30 | [0m[35m        dsa.DSAPrivateKey | ec.EllipticCurvePrivateKey | rsa.RSAPrivateKey | None[0m
[30;1m31 | [0m[35m    ) = None[0m
[30;1m32 | [0m[35m    """The certificate's private key."""[0m
[30;1m33 | [0m[35m    cipher_suites: list[CipherSuite] | None = None[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/proxy/layers/quic/_hooks.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m27 | [0m[35m    certificate_chain: list[x509.Certificate] = field(default_factory=list)[0m
[30;1m28 | [0m[35m    """A list of additional certificates to send to the peer."""[0m
[30;1m29 | [0m[35m    certificate_private_key: ([0m
[30;1m30 | [0m[35m        dsa.DSAPrivateKey | ec.EllipticCurvePrivateKey | rsa.RSAPrivateKey | None[0m
[30;1m31 | [0m[35m    ) = None[0m
[30;1m32 | [0m[35m    """The certificate's private key."""[0m
[30;1m33 | [0m[35m    cipher_suites: list[CipherSuite] | None = None[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/proxy/layers/quic/_hooks.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m27 | [0m[35m    certificate_chain: list[x509.Certificate] = field(default_factory=list)[0m
[30;1m28 | [0m[35m    """A list of additional certificates to send to the peer."""[0m
[30;1m29 | [0m[35m    certificate_private_key: ([0m
[30;1m30 | [0m[35m        dsa.DSAPrivateKey | ec.EllipticCurvePrivateKey | rsa.RSAPrivateKey | None[0m
[30;1m31 | [0m[35m    ) = None[0m
[30;1m32 | [0m[35m    """The certificate's private key."""[0m
[30;1m33 | [0m[35m    cipher_suites: list[CipherSuite] | None = None[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/proxy/layers/quic/_hooks.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m26 | [0m[35m    """The certificate to use for the connection."""[0m
[30;1m27 | [0m[35m    certificate_chain: list[x509.Certificate] = field(default_factory=list)[0m
[30;1m28 | [0m[35m    """A list of additional certificates to send to the peer."""[0m
[30;1m29 | [0m[35m    certificate_private_key: ([0m
[30;1m30 | [0m[35m        dsa.DSAPrivateKey | ec.EllipticCurvePrivateKey | rsa.RSAPrivateKey | None[0m
[30;1m31 | [0m[35m    ) = None[0m
[30;1m32 | [0m[35m    """The certificate's private key."""[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/dns.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m147 | [0m[35m        if ech is None:[0m
[30;1m148 | [0m[35m            record.params.pop(SVCParamKeys.ECH.value, None)[0m
[30;1m149 | [0m[35m        else:[0m
[30;1m150 | [0m[35m            ech_bytes = base64.b64decode(ech.encode("utf-8"))[0m
[30;1m151 | [0m[35m            record.params[SVCParamKeys.ECH.value] = ech_bytes[0m
[30;1m152 | [0m[35m        self.data = https_records.pack(record)[0m
[30;1m153 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/dns.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m137 | [0m[35m        record = https_records.unpack(self.data)[0m
[30;1m138 | [0m[35m        ech_bytes = record.params.get(SVCParamKeys.ECH.value, None)[0m
[30;1m139 | [0m[35m        if ech_bytes is not None:[0m
[30;1m140 | [0m[35m            return base64.b64encode(ech_bytes).decode("utf-8")[0m
[30;1m141 | [0m[35m        else:[0m
[30;1m142 | [0m[35m            return None[0m
[30;1m143 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/dns.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mfrom __future__ import annotations[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35mimport itertools[0m
[30;1m5 | [0m[35mimport random[0m
[30;1m6 | [0m[35mimport struct[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/onboardingapp/templates/index.html[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m66 | [0m[35m        <li>Double-click the PEM file to open the <samp>Keychain Access</samp> application.</li>[0m
[30;1m67 | [0m[35m        <li>Locate the new certificate "mitmproxy" in the list and double-click it.</li>[0m
[30;1m68 | [0m[35m        <li>Change <samp>Secure Socket Layer (SSL)</samp> to <samp>Always Trust</samp>.</li>[0m
[30;1m69 | [0m[35m        <li>Close the dialog window and enter your password if prompted.</li>[0m
[30;1m70 | [0m[35m    </ol>[0m
[30;1m71 | [0m[35m    <h5>Automated Installation</h5>[0m
[30;1m72 | [0m[35m    <ol>[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/onboardingapp/templates/index.html[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m29 | [0m[35m            Windows user or everyone on the machine. Click <samp>Next</samp>.[0m
[30;1m30 | [0m[35m        </li>[0m
[30;1m31 | [0m[35m        <li>Click <samp>Next</samp> again.</li>[0m
[30;1m32 | [0m[35m        <li>Leave <samp>Password</samp> blank and click <samp>Next</samp>.</li>[0m
[30;1m33 | [0m[35m        <li><span class="text-danger">Select <samp>Place all certificates in the following store</sa[0m
[30;1m34 | [0m[35m            then click <samp>Browse</samp>, and select <samp>Trusted Root Certification Authorities<[0m
[30;1m35 | [0m[35m            Click <samp>OK</samp> and <samp>Next</samp>.[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/proxy/server.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m552 | [0m[35m        def tls_start_client(tls_start: tls.TlsData):[0m
[30;1m553 | [0m[35m            # INSECURE[0m
[30;1m554 | [0m[35m            ssl_context = SSL.Context(SSL.SSLv23_METHOD)[0m
[30;1m555 | [0m[35m            ssl_context.use_privatekey_file([0m
[30;1m556 | [0m[35m                pkg_data.path([0m
[30;1m557 | [0m[35m                    "../test/mitmproxy/data/verificationcerts/trusted-leaf.key"[0m
[30;1m558 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/proxyauth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m284 | [0m[35m        self.conn.search(self.dn_subtree, f"({self.filter_key}={username})")[0m
[30;1m285 | [0m[35m        if self.conn.response:[0m
[30;1m286 | [0m[35m            c = ldap3.Connection([0m
[30;1m287 | [0m[35m                self.server, self.conn.response[0]["dn"], password, auto_bind=True[0m
[30;1m288 | [0m[35m            )[0m
[30;1m289 | [0m[35m            if c:[0m
[30;1m290 | [0m[35m                return True[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/proxyauth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m279 | [0m[35m            raise exceptions.OptionsError(f"Invalid LDAP specification: {spec}")[0m
[30;1m280 | [0m[35m[0m
[30;1m281 | [0m[35m    def __call__(self, username: str, password: str) -> bool:[0m
[30;1m282 | [0m[35m        if not username or not password:[0m
[30;1m283 | [0m[35m            return False[0m
[30;1m284 | [0m[35m        self.conn.search(self.dn_subtree, f"({self.filter_key}={username})")[0m
[30;1m285 | [0m[35m        if self.conn.response:[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/proxyauth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m278 | [0m[35m        except ValueError:[0m
[30;1m279 | [0m[35m            raise exceptions.OptionsError(f"Invalid LDAP specification: {spec}")[0m
[30;1m280 | [0m[35m[0m
[30;1m281 | [0m[35m    def __call__(self, username: str, password: str) -> bool:[0m
[30;1m282 | [0m[35m        if not username or not password:[0m
[30;1m283 | [0m[35m            return False[0m
[30;1m284 | [0m[35m        self.conn.search(self.dn_subtree, f"({self.filter_key}={username})")[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/proxyauth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m208 | [0m[35m            raise exceptions.OptionsError(f"Could not open htpasswd file: {path}")[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m    def __call__(self, username: str, password: str) -> bool:[0m
[30;1m211 | [0m[35m        return self.htpasswd.check_password(username, password)[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35mclass Ldap(Validator):[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/proxyauth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m208 | [0m[35m            raise exceptions.OptionsError(f"Could not open htpasswd file: {path}")[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m    def __call__(self, username: str, password: str) -> bool:[0m
[30;1m211 | [0m[35m        return self.htpasswd.check_password(username, password)[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35mclass Ldap(Validator):[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/proxyauth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m208 | [0m[35m            raise exceptions.OptionsError(f"Could not open htpasswd file: {path}")[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m    def __call__(self, username: str, password: str) -> bool:[0m
[30;1m211 | [0m[35m        return self.htpasswd.check_password(username, password)[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35mclass Ldap(Validator):[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/proxyauth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m207 | [0m[35m        except (ValueError, OSError):[0m
[30;1m208 | [0m[35m            raise exceptions.OptionsError(f"Could not open htpasswd file: {path}")[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m    def __call__(self, username: str, password: str) -> bool:[0m
[30;1m211 | [0m[35m        return self.htpasswd.check_password(username, password)[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/proxyauth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m205 | [0m[35m        try:[0m
[30;1m206 | [0m[35m            self.htpasswd = passlib.apache.HtpasswdFile(path)[0m
[30;1m207 | [0m[35m        except (ValueError, OSError):[0m
[30;1m208 | [0m[35m            raise exceptions.OptionsError(f"Could not open htpasswd file: {path}")[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m    def __call__(self, username: str, password: str) -> bool:[0m
[30;1m211 | [0m[35m        return self.htpasswd.check_password(username, password)[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/proxyauth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m203 | [0m[35m    def __init__(self, proxyauth: str):[0m
[30;1m204 | [0m[35m        path = proxyauth[1:][0m
[30;1m205 | [0m[35m        try:[0m
[30;1m206 | [0m[35m            self.htpasswd = passlib.apache.HtpasswdFile(path)[0m
[30;1m207 | [0m[35m        except (ValueError, OSError):[0m
[30;1m208 | [0m[35m            raise exceptions.OptionsError(f"Could not open htpasswd file: {path}")[0m
[30;1m209 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/proxyauth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m203 | [0m[35m    def __init__(self, proxyauth: str):[0m
[30;1m204 | [0m[35m        path = proxyauth[1:][0m
[30;1m205 | [0m[35m        try:[0m
[30;1m206 | [0m[35m            self.htpasswd = passlib.apache.HtpasswdFile(path)[0m
[30;1m207 | [0m[35m        except (ValueError, OSError):[0m
[30;1m208 | [0m[35m            raise exceptions.OptionsError(f"Could not open htpasswd file: {path}")[0m
[30;1m209 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/proxyauth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m199 | [0m[35m        return self.username == username and self.password == password[0m
[30;1m200 | [0m[35m[0m
[30;1m201 | [0m[35m[0m
[30;1m202 | [0m[35mclass Htpasswd(Validator):[0m
[30;1m203 | [0m[35m    def __init__(self, proxyauth: str):[0m
[30;1m204 | [0m[35m        path = proxyauth[1:][0m
[30;1m205 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/proxyauth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m196 | [0m[35m            raise exceptions.OptionsError("Invalid single-user auth specification.")[0m
[30;1m197 | [0m[35m[0m
[30;1m198 | [0m[35m    def __call__(self, username: str, password: str) -> bool:[0m
[30;1m199 | [0m[35m        return self.username == username and self.password == password[0m
[30;1m200 | [0m[35m[0m
[30;1m201 | [0m[35m[0m
[30;1m202 | [0m[35mclass Htpasswd(Validator):[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/proxyauth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m196 | [0m[35m            raise exceptions.OptionsError("Invalid single-user auth specification.")[0m
[30;1m197 | [0m[35m[0m
[30;1m198 | [0m[35m    def __call__(self, username: str, password: str) -> bool:[0m
[30;1m199 | [0m[35m        return self.username == username and self.password == password[0m
[30;1m200 | [0m[35m[0m
[30;1m201 | [0m[35m[0m
[30;1m202 | [0m[35mclass Htpasswd(Validator):[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/proxyauth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m195 | [0m[35m        except ValueError:[0m
[30;1m196 | [0m[35m            raise exceptions.OptionsError("Invalid single-user auth specification.")[0m
[30;1m197 | [0m[35m[0m
[30;1m198 | [0m[35m    def __call__(self, username: str, password: str) -> bool:[0m
[30;1m199 | [0m[35m        return self.username == username and self.password == password[0m
[30;1m200 | [0m[35m[0m
[30;1m201 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/proxyauth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m191 | [0m[35mclass SingleUser(Validator):[0m
[30;1m192 | [0m[35m    def __init__(self, proxyauth: str):[0m
[30;1m193 | [0m[35m        try:[0m
[30;1m194 | [0m[35m            self.username, self.password = proxyauth.split(":")[0m
[30;1m195 | [0m[35m        except ValueError:[0m
[30;1m196 | [0m[35m            raise exceptions.OptionsError("Invalid single-user auth specification.")[0m
[30;1m197 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/proxyauth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m184 | [0m[35m[0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35mclass AcceptAll(Validator):[0m
[30;1m187 | [0m[35m    def __call__(self, username: str, password: str) -> bool:[0m
[30;1m188 | [0m[35m        return True[0m
[30;1m189 | [0m[35m[0m
[30;1m190 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/proxyauth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m179 | [0m[35m    """Base class for all username/password validators."""[0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35m    @abstractmethod[0m
[30;1m182 | [0m[35m    def __call__(self, username: str, password: str) -> bool:[0m
[30;1m183 | [0m[35m        raise NotImplementedError[0m
[30;1m184 | [0m[35m[0m
[30;1m185 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/proxyauth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35mclass Validator(ABC):[0m
[30;1m179 | [0m[35m    """Base class for all username/password validators."""[0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35m    @abstractmethod[0m
[30;1m182 | [0m[35m    def __call__(self, username: str, password: str) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/proxyauth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m172 | [0m[35m        )[0m
[30;1m173 | [0m[35m    except binascii.Error as e:[0m
[30;1m174 | [0m[35m        raise ValueError(str(e))[0m
[30;1m175 | [0m[35m    return scheme, user, password[0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35mclass Validator(ABC):[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/proxyauth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m167 | [0m[35m    if scheme.lower() != "basic":[0m
[30;1m168 | [0m[35m        raise ValueError("Unknown scheme")[0m
[30;1m169 | [0m[35m    try:[0m
[30;1m170 | [0m[35m        user, password = ([0m
[30;1m171 | [0m[35m            binascii.a2b_base64(authinfo.encode()).decode("utf8", "replace").split(":")[0m
[30;1m172 | [0m[35m        )[0m
[30;1m173 | [0m[35m    except binascii.Error as e:[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/proxyauth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m154 | [0m[35m    """[0m
[30;1m155 | [0m[35m    Craft a basic auth string[0m
[30;1m156 | [0m[35m    """[0m
[30;1m157 | [0m[35m    v = binascii.b2a_base64((username + ":" + password).encode("utf8")).decode("ascii")[0m
[30;1m158 | [0m[35m    return scheme + " " + v[0m
[30;1m159 | [0m[35m[0m
[30;1m160 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/proxyauth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m150 | [0m[35m    )[0m
[30;1m151 | [0m[35m[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35mdef mkauth(username: str, password: str, scheme: str = "basic") -> str:[0m
[30;1m154 | [0m[35m    """[0m
[30;1m155 | [0m[35m    Craft a basic auth string[0m
[30;1m156 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/proxyauth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m103 | [0m[35m            pass[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m        if is_valid:[0m
[30;1m106 | [0m[35m            f.metadata["proxyauth"] = (username, password)[0m
[30;1m107 | [0m[35m            del f.request.headers[auth_header][0m
[30;1m108 | [0m[35m            return True[0m
[30;1m109 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/proxyauth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m98 | [0m[35m        try:[0m
[30;1m99 | [0m[35m            auth_value = f.request.headers.get(auth_header, "")[0m
[30;1m100 | [0m[35m            scheme, username, password = parse_http_basic_auth(auth_value)[0m
[30;1m101 | [0m[35m            is_valid = self.validator(username, password)[0m
[30;1m102 | [0m[35m        except Exception:[0m
[30;1m103 | [0m[35m            pass[0m
[30;1m104 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/proxyauth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m97 | [0m[35m        auth_header = http_auth_header(is_proxy)[0m
[30;1m98 | [0m[35m        try:[0m
[30;1m99 | [0m[35m            auth_value = f.request.headers.get(auth_header, "")[0m
[30;1m100 | [0m[35m            scheme, username, password = parse_http_basic_auth(auth_value)[0m
[30;1m101 | [0m[35m            is_valid = self.validator(username, password)[0m
[30;1m102 | [0m[35m        except Exception:[0m
[30;1m103 | [0m[35m            pass[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/proxyauth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m90 | [0m[35m        """[0m
[30;1m91 | [0m[35m        assert self.validator[0m
[30;1m92 | [0m[35m        username = None[0m
[30;1m93 | [0m[35m        password = None[0m
[30;1m94 | [0m[35m        is_valid = False[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m        is_proxy = is_http_proxy(f)[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/proxyauth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m64 | [0m[35m    def socks5_auth(self, data: modes.Socks5AuthData) -> None:[0m
[30;1m65 | [0m[35m        if self.validator and self.validator(data.username, data.password):[0m
[30;1m66 | [0m[35m            data.valid = True[0m
[30;1m67 | [0m[35m            self.authenticated[data.client_conn] = data.username, data.password[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m    def http_connect(self, f: http.HTTPFlow) -> None:[0m
[30;1m70 | [0m[35m        if self.validator and self.authenticate_http(f):[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/proxyauth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m62 | [0m[35m                self.validator = None[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m    def socks5_auth(self, data: modes.Socks5AuthData) -> None:[0m
[30;1m65 | [0m[35m        if self.validator and self.validator(data.username, data.password):[0m
[30;1m66 | [0m[35m            data.valid = True[0m
[30;1m67 | [0m[35m            self.authenticated[data.client_conn] = data.username, data.password[0m
[30;1m68 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/proxyauth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m51 | [0m[35m                if auth == "any":[0m
[30;1m52 | [0m[35m                    self.validator = AcceptAll()[0m
[30;1m53 | [0m[35m                elif auth.startswith("@"):[0m
[30;1m54 | [0m[35m                    self.validator = Htpasswd(auth)[0m
[30;1m55 | [0m[35m                elif ctx.options.proxyauth.startswith("ldap"):[0m
[30;1m56 | [0m[35m                    self.validator = Ldap(auth)[0m
[30;1m57 | [0m[35m                elif ":" in ctx.options.proxyauth:[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/proxyauth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m40 | [0m[35m            "username:pass",[0m
[30;1m41 | [0m[35m            "any" to accept any user/pass combination,[0m
[30;1m42 | [0m[35m            "@path" to use an Apache htpasswd file,[0m
[30;1m43 | [0m[35m            or "ldap[s]:url_server_ldap[:port]:dn_auth:password:dn_subtree[?search_filter_key=...]" [0m
[30;1m44 | [0m[35m            """,[0m
[30;1m45 | [0m[35m        )[0m
[30;1m46 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/proxyauth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m39 | [0m[35m            Require proxy authentication. Format:[0m
[30;1m40 | [0m[35m            "username:pass",[0m
[30;1m41 | [0m[35m            "any" to accept any user/pass combination,[0m
[30;1m42 | [0m[35m            "@path" to use an Apache htpasswd file,[0m
[30;1m43 | [0m[35m            or "ldap[s]:url_server_ldap[:port]:dn_auth:password:dn_subtree[?search_filter_key=...]" [0m
[30;1m44 | [0m[35m            """,[0m
[30;1m45 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/savehar.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m270 | [0m[35m                if message.is_text:[0m
[30;1m271 | [0m[35m                    data = message.text[0m
[30;1m272 | [0m[35m                else:[0m
[30;1m273 | [0m[35m                    data = base64.b64encode(message.content).decode()[0m
[30;1m274 | [0m[35m                websocket_message = {[0m
[30;1m275 | [0m[35m                    "type": "send" if message.from_client else "receive",[0m
[30;1m276 | [0m[35m                    "time": message.timestamp,[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/savehar.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m204 | [0m[35m            }[0m
[30;1m205 | [0m[35m            if content and strutils.is_mostly_bin(content):[0m
[30;1m206 | [0m[35m                response["content"]["text"] = base64.b64encode(content).decode()[0m
[30;1m207 | [0m[35m                response["content"]["encoding"] = "base64"[0m
[30;1m208 | [0m[35m            else:[0m
[30;1m209 | [0m[35m                text_content = flow.response.get_text(strict=False)[0m
[30;1m210 | [0m[35m                if text_content is None:[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/savehar.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m203 | [0m[35m                "bodySize": response_body_size,[0m
[30;1m204 | [0m[35m            }[0m
[30;1m205 | [0m[35m            if content and strutils.is_mostly_bin(content):[0m
[30;1m206 | [0m[35m                response["content"]["text"] = base64.b64encode(content).decode()[0m
[30;1m207 | [0m[35m                response["content"]["encoding"] = "base64"[0m
[30;1m208 | [0m[35m            else:[0m
[30;1m209 | [0m[35m                text_content = flow.response.get_text(strict=False)[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/savehar.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35m"""Write flow objects to a HAR file"""[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35mimport json[0m
[30;1m5 | [0m[35mimport logging[0m
[30;1m6 | [0m[35mimport zlib[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/contentviews/grpc.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m890 | [0m[35m[0m
[30;1m891 | [0m[35m# hacky fix for mitmproxy issue:[0m
[30;1m892 | [0m[35m#[0m
[30;1m893 | [0m[35m# mitmproxy handles Exceptions in the contenview's __call__ function, by[0m
[30;1m894 | [0m[35m# failing over to 'Raw' view. The intention was to use this behavior to[0m
[30;1m895 | [0m[35m# pass up Exceptions thrown inside the generator function ('format_pbuf'[0m
[30;1m896 | [0m[35m# and 'format_grpc') to the __call__ function.[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/net/tls.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m198 | [0m[35m    # Client Certs[0m
[30;1m199 | [0m[35m    if client_cert:[0m
[30;1m200 | [0m[35m        try:[0m
[30;1m201 | [0m[35m            context.use_privatekey_file(client_cert)[0m
[30;1m202 | [0m[35m            context.use_certificate_chain_file(client_cert)[0m
[30;1m203 | [0m[35m        except SSL.Error as e:[0m
[30;1m204 | [0m[35m            raise RuntimeError(f"Cannot load TLS client certificate: {e}") from e[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/net/tls.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35mlog_master_secret = make_master_secret_logger([0m
[30;1m120 | [0m[35m    os.getenv("MITMPROXY_SSLKEYLOGFILE") or os.getenv("SSLKEYLOGFILE")[0m
[30;1m121 | [0m[35m)[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/utils/asyncio_utils.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m43 | [0m[35m) -> None:[0m
[30;1m44 | [0m[35m    """Set debug info for an externally-spawned task."""[0m
[30;1m45 | [0m[35m    task.created = time.time()  # type: ignore[0m
[30;1m46 | [0m[35m    if __debug__ is True and (test := os.environ.get("PYTEST_CURRENT_TEST", None)):[0m
[30;1m47 | [0m[35m        name = f"{name} [created in {test}]"[0m
[30;1m48 | [0m[35m    task.set_name(name)[0m
[30;1m49 | [0m[35m    if client:[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/webaddons.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m100 | [0m[35m            if not success and not ctx.options.web_password:[0m
[30;1m101 | [0m[35m                logger.info([0m
[30;1m102 | [0m[35m                    f"You can configure a fixed authentication token by setting the `web_password` o[0m
[30;1m103 | [0m[35m                    f"(https://docs.mitmproxy.org/stable/concepts-options/#web_password).",[0m
[30;1m104 | [0m[35m                )[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/webaddons.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m99 | [0m[35m                )[0m
[30;1m100 | [0m[35m            if not success and not ctx.options.web_password:[0m
[30;1m101 | [0m[35m                logger.info([0m
[30;1m102 | [0m[35m                    f"You can configure a fixed authentication token by setting the `web_password` o[0m
[30;1m103 | [0m[35m                    f"(https://docs.mitmproxy.org/stable/concepts-options/#web_password).",[0m
[30;1m104 | [0m[35m                )[0m
[30;1m105 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/webaddons.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m97 | [0m[35m                logger.info([0m
[30;1m98 | [0m[35m                    f"No web browser found. Please open a browser and point it to {master.web_url}",[0m
[30;1m99 | [0m[35m                )[0m
[30;1m100 | [0m[35m            if not success and not ctx.options.web_password:[0m
[30;1m101 | [0m[35m                logger.info([0m
[30;1m102 | [0m[35m                    f"You can configure a fixed authentication token by setting the `web_password` o[0m
[30;1m103 | [0m[35m                    f"(https://docs.mitmproxy.org/stable/concepts-options/#web_password).",[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/webaddons.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m72 | [0m[35m        else:[0m
[30;1m73 | [0m[35m            return hmac.compare_digest([0m
[30;1m74 | [0m[35m                self._password,[0m
[30;1m75 | [0m[35m                password,[0m
[30;1m76 | [0m[35m            )[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/webaddons.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m71 | [0m[35m                return False[0m
[30;1m72 | [0m[35m        else:[0m
[30;1m73 | [0m[35m            return hmac.compare_digest([0m
[30;1m74 | [0m[35m                self._password,[0m
[30;1m75 | [0m[35m                password,[0m
[30;1m76 | [0m[35m            )[0m
[30;1m77 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/webaddons.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m66 | [0m[35m    def is_valid_password(self, password: str) -> bool:[0m
[30;1m67 | [0m[35m        if self._password.startswith("$"):[0m
[30;1m68 | [0m[35m            try:[0m
[30;1m69 | [0m[35m                return self._hasher.verify(self._password, password)[0m
[30;1m70 | [0m[35m            except argon2.exceptions.VerificationError:[0m
[30;1m71 | [0m[35m                return False[0m
[30;1m72 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/webaddons.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m66 | [0m[35m    def is_valid_password(self, password: str) -> bool:[0m
[30;1m67 | [0m[35m        if self._password.startswith("$"):[0m
[30;1m68 | [0m[35m            try:[0m
[30;1m69 | [0m[35m                return self._hasher.verify(self._password, password)[0m
[30;1m70 | [0m[35m            except argon2.exceptions.VerificationError:[0m
[30;1m71 | [0m[35m                return False[0m
[30;1m72 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/webaddons.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m64 | [0m[35m        return f"http://{ctx.options.web_host}:{ctx.options.web_port}/{auth}"[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m    def is_valid_password(self, password: str) -> bool:[0m
[30;1m67 | [0m[35m        if self._password.startswith("$"):[0m
[30;1m68 | [0m[35m            try:[0m
[30;1m69 | [0m[35m                return self._hasher.verify(self._password, password)[0m
[30;1m70 | [0m[35m            except argon2.exceptions.VerificationError:[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/webaddons.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m63 | [0m[35m        # noinspection HttpUrlsUsage[0m
[30;1m64 | [0m[35m        return f"http://{ctx.options.web_host}:{ctx.options.web_port}/{auth}"[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m    def is_valid_password(self, password: str) -> bool:[0m
[30;1m67 | [0m[35m        if self._password.startswith("$"):[0m
[30;1m68 | [0m[35m            try:[0m
[30;1m69 | [0m[35m                return self._hasher.verify(self._password, password)[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/webaddons.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m63 | [0m[35m        # noinspection HttpUrlsUsage[0m
[30;1m64 | [0m[35m        return f"http://{ctx.options.web_host}:{ctx.options.web_port}/{auth}"[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m    def is_valid_password(self, password: str) -> bool:[0m
[30;1m67 | [0m[35m        if self._password.startswith("$"):[0m
[30;1m68 | [0m[35m            try:[0m
[30;1m69 | [0m[35m                return self._hasher.verify(self._password, password)[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/webaddons.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m59 | [0m[35m        if ctx.options.web_password:[0m
[30;1m60 | [0m[35m            auth = ""  # We don't want to print plaintext passwords (and it doesn't work for argon2 [0m
[30;1m61 | [0m[35m        else:[0m
[30;1m62 | [0m[35m            auth = f"?token={self._password}"[0m
[30;1m63 | [0m[35m        # noinspection HttpUrlsUsage[0m
[30;1m64 | [0m[35m        return f"http://{ctx.options.web_host}:{ctx.options.web_port}/{auth}"[0m
[30;1m65 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/webaddons.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m57 | [0m[35m    @property[0m
[30;1m58 | [0m[35m    def web_url(self) -> str:[0m
[30;1m59 | [0m[35m        if ctx.options.web_password:[0m
[30;1m60 | [0m[35m            auth = ""  # We don't want to print plaintext passwords (and it doesn't work for argon2 [0m
[30;1m61 | [0m[35m        else:[0m
[30;1m62 | [0m[35m            auth = f"?token={self._password}"[0m
[30;1m63 | [0m[35m        # noinspection HttpUrlsUsage[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/webaddons.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    @property[0m
[30;1m58 | [0m[35m    def web_url(self) -> str:[0m
[30;1m59 | [0m[35m        if ctx.options.web_password:[0m
[30;1m60 | [0m[35m            auth = ""  # We don't want to print plaintext passwords (and it doesn't work for argon2 [0m
[30;1m61 | [0m[35m        else:[0m
[30;1m62 | [0m[35m            auth = f"?token={self._password}"[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/webaddons.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m52 | [0m[35m                    "Using a plaintext password to protect the mitmweb user interface. "[0m
[30;1m53 | [0m[35m                    "Consider using an argon2 hash for `web_password`  instead."[0m
[30;1m54 | [0m[35m                )[0m
[30;1m55 | [0m[35m            self._password = ctx.options.web_password or secrets.token_hex(16)[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    @property[0m
[30;1m58 | [0m[35m    def web_url(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/webaddons.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m52 | [0m[35m                    "Using a plaintext password to protect the mitmweb user interface. "[0m
[30;1m53 | [0m[35m                    "Consider using an argon2 hash for `web_password`  instead."[0m
[30;1m54 | [0m[35m                )[0m
[30;1m55 | [0m[35m            self._password = ctx.options.web_password or secrets.token_hex(16)[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    @property[0m
[30;1m58 | [0m[35m    def web_url(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/webaddons.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m50 | [0m[35m            elif ctx.options.web_password:[0m
[30;1m51 | [0m[35m                logger.warning([0m
[30;1m52 | [0m[35m                    "Using a plaintext password to protect the mitmweb user interface. "[0m
[30;1m53 | [0m[35m                    "Consider using an argon2 hash for `web_password`  instead."[0m
[30;1m54 | [0m[35m                )[0m
[30;1m55 | [0m[35m            self._password = ctx.options.web_password or secrets.token_hex(16)[0m
[30;1m56 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/webaddons.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m49 | [0m[35m                    )[0m
[30;1m50 | [0m[35m            elif ctx.options.web_password:[0m
[30;1m51 | [0m[35m                logger.warning([0m
[30;1m52 | [0m[35m                    "Using a plaintext password to protect the mitmweb user interface. "[0m
[30;1m53 | [0m[35m                    "Consider using an argon2 hash for `web_password`  instead."[0m
[30;1m54 | [0m[35m                )[0m
[30;1m55 | [0m[35m            self._password = ctx.options.web_password or secrets.token_hex(16)[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/webaddons.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m47 | [0m[35m                    raise exceptions.OptionsError([0m
[30;1m48 | [0m[35m                        "`web_password` starts with `$`, but it's not a valid argon2 hash."[0m
[30;1m49 | [0m[35m                    )[0m
[30;1m50 | [0m[35m            elif ctx.options.web_password:[0m
[30;1m51 | [0m[35m                logger.warning([0m
[30;1m52 | [0m[35m                    "Using a plaintext password to protect the mitmweb user interface. "[0m
[30;1m53 | [0m[35m                    "Consider using an argon2 hash for `web_password`  instead."[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/webaddons.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m45 | [0m[35m                    argon2.extract_parameters(ctx.options.web_password)[0m
[30;1m46 | [0m[35m                except argon2.exceptions.InvalidHashError:[0m
[30;1m47 | [0m[35m                    raise exceptions.OptionsError([0m
[30;1m48 | [0m[35m                        "`web_password` starts with `$`, but it's not a valid argon2 hash."[0m
[30;1m49 | [0m[35m                    )[0m
[30;1m50 | [0m[35m            elif ctx.options.web_password:[0m
[30;1m51 | [0m[35m                logger.warning([0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/webaddons.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m42 | [0m[35m        if "web_password" in updated:[0m
[30;1m43 | [0m[35m            if ctx.options.web_password.startswith("$"):[0m
[30;1m44 | [0m[35m                try:[0m
[30;1m45 | [0m[35m                    argon2.extract_parameters(ctx.options.web_password)[0m
[30;1m46 | [0m[35m                except argon2.exceptions.InvalidHashError:[0m
[30;1m47 | [0m[35m                    raise exceptions.OptionsError([0m
[30;1m48 | [0m[35m                        "`web_password` starts with `$`, but it's not a valid argon2 hash."[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/webaddons.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m    def configure(self, updated) -> None:[0m
[30;1m42 | [0m[35m        if "web_password" in updated:[0m
[30;1m43 | [0m[35m            if ctx.options.web_password.startswith("$"):[0m
[30;1m44 | [0m[35m                try:[0m
[30;1m45 | [0m[35m                    argon2.extract_parameters(ctx.options.web_password)[0m
[30;1m46 | [0m[35m                except argon2.exceptions.InvalidHashError:[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/webaddons.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m39 | [0m[35m        )[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m    def configure(self, updated) -> None:[0m
[30;1m42 | [0m[35m        if "web_password" in updated:[0m
[30;1m43 | [0m[35m            if ctx.options.web_password.startswith("$"):[0m
[30;1m44 | [0m[35m                try:[0m
[30;1m45 | [0m[35m                    argon2.extract_parameters(ctx.options.web_password)[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/webaddons.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m35 | [0m[35m            "Password to protect the mitmweb user interface. "[0m
[30;1m36 | [0m[35m            "Values starting with `$` are interpreted as an argon2 hash, "[0m
[30;1m37 | [0m[35m            "everything else is considered a plaintext password. "[0m
[30;1m38 | [0m[35m            "If no password is provided, a random token is generated on startup.",[0m
[30;1m39 | [0m[35m        )[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m    def configure(self, updated) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/webaddons.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m34 | [0m[35m            "",[0m
[30;1m35 | [0m[35m            "Password to protect the mitmweb user interface. "[0m
[30;1m36 | [0m[35m            "Values starting with `$` are interpreted as an argon2 hash, "[0m
[30;1m37 | [0m[35m            "everything else is considered a plaintext password. "[0m
[30;1m38 | [0m[35m            "If no password is provided, a random token is generated on startup.",[0m
[30;1m39 | [0m[35m        )[0m
[30;1m40 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/webaddons.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m32 | [0m[35m            "web_password",[0m
[30;1m33 | [0m[35m            str,[0m
[30;1m34 | [0m[35m            "",[0m
[30;1m35 | [0m[35m            "Password to protect the mitmweb user interface. "[0m
[30;1m36 | [0m[35m            "Values starting with `$` are interpreted as an argon2 hash, "[0m
[30;1m37 | [0m[35m            "everything else is considered a plaintext password. "[0m
[30;1m38 | [0m[35m            "If no password is provided, a random token is generated on startup.",[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/webaddons.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m    def load(self, loader):[0m
[30;1m31 | [0m[35m        loader.add_option([0m
[30;1m32 | [0m[35m            "web_password",[0m
[30;1m33 | [0m[35m            str,[0m
[30;1m34 | [0m[35m            "",[0m
[30;1m35 | [0m[35m            "Password to protect the mitmweb user interface. "[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/webaddons.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    def __init__(self):[0m
[30;1m27 | [0m[35m        self._password = secrets.token_hex(16)[0m
[30;1m28 | [0m[35m        self._hasher = argon2.PasswordHasher()[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m    def load(self, loader):[0m
[30;1m31 | [0m[35m        loader.add_option([0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/webaddons.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m24 | [0m[35m    _hasher: argon2.PasswordHasher[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    def __init__(self):[0m
[30;1m27 | [0m[35m        self._password = secrets.token_hex(16)[0m
[30;1m28 | [0m[35m        self._hasher = argon2.PasswordHasher()[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m    def load(self, loader):[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/webaddons.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mclass WebAuth:[0m
[30;1m23 | [0m[35m    _password: str[0m
[30;1m24 | [0m[35m    _hasher: argon2.PasswordHasher[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    def __init__(self):[0m
[30;1m27 | [0m[35m        self._password = secrets.token_hex(16)[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/webaddons.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mclass WebAuth:[0m
[30;1m23 | [0m[35m    _password: str[0m
[30;1m24 | [0m[35m    _hasher: argon2.PasswordHasher[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    def __init__(self):[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m643 | [0m[35m        return serialization.load_pem_private_key(data, password)  # type: ignore[0m
[30;1m644 | [0m[35m    except TypeError:[0m
[30;1m645 | [0m[35m        if password is not None:[0m
[30;1m646 | [0m[35m            return load_pem_private_key(data, None)[0m
[30;1m647 | [0m[35m        raise[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m642 | [0m[35m    try:[0m
[30;1m643 | [0m[35m        return serialization.load_pem_private_key(data, password)  # type: ignore[0m
[30;1m644 | [0m[35m    except TypeError:[0m
[30;1m645 | [0m[35m        if password is not None:[0m
[30;1m646 | [0m[35m            return load_pem_private_key(data, None)[0m
[30;1m647 | [0m[35m        raise[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m640 | [0m[35m    if the private key is unencrypted.[0m
[30;1m641 | [0m[35m    """[0m
[30;1m642 | [0m[35m    try:[0m
[30;1m643 | [0m[35m        return serialization.load_pem_private_key(data, password)  # type: ignore[0m
[30;1m644 | [0m[35m    except TypeError:[0m
[30;1m645 | [0m[35m        if password is not None:[0m
[30;1m646 | [0m[35m            return load_pem_private_key(data, None)[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m640 | [0m[35m    if the private key is unencrypted.[0m
[30;1m641 | [0m[35m    """[0m
[30;1m642 | [0m[35m    try:[0m
[30;1m643 | [0m[35m        return serialization.load_pem_private_key(data, password)  # type: ignore[0m
[30;1m644 | [0m[35m    except TypeError:[0m
[30;1m645 | [0m[35m        if password is not None:[0m
[30;1m646 | [0m[35m            return load_pem_private_key(data, None)[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m636 | [0m[35m[0m
[30;1m637 | [0m[35mdef load_pem_private_key(data: bytes, password: bytes | None) -> rsa.RSAPrivateKey:[0m
[30;1m638 | [0m[35m    """[0m
[30;1m639 | [0m[35m    like cryptography's load_pem_private_key, but silently falls back to not using a password[0m
[30;1m640 | [0m[35m    if the private key is unencrypted.[0m
[30;1m641 | [0m[35m    """[0m
[30;1m642 | [0m[35m    try:[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m636 | [0m[35m[0m
[30;1m637 | [0m[35mdef load_pem_private_key(data: bytes, password: bytes | None) -> rsa.RSAPrivateKey:[0m
[30;1m638 | [0m[35m    """[0m
[30;1m639 | [0m[35m    like cryptography's load_pem_private_key, but silently falls back to not using a password[0m
[30;1m640 | [0m[35m    if the private key is unencrypted.[0m
[30;1m641 | [0m[35m    """[0m
[30;1m642 | [0m[35m    try:[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m634 | [0m[35m        return entry[0m
[30;1m635 | [0m[35m[0m
[30;1m636 | [0m[35m[0m
[30;1m637 | [0m[35mdef load_pem_private_key(data: bytes, password: bytes | None) -> rsa.RSAPrivateKey:[0m
[30;1m638 | [0m[35m    """[0m
[30;1m639 | [0m[35m    like cryptography's load_pem_private_key, but silently falls back to not using a password[0m
[30;1m640 | [0m[35m    if the private key is unencrypted.[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m634 | [0m[35m        return entry[0m
[30;1m635 | [0m[35m[0m
[30;1m636 | [0m[35m[0m
[30;1m637 | [0m[35mdef load_pem_private_key(data: bytes, password: bytes | None) -> rsa.RSAPrivateKey:[0m
[30;1m638 | [0m[35m    """[0m
[30;1m639 | [0m[35m    like cryptography's load_pem_private_key, but silently falls back to not using a password[0m
[30;1m640 | [0m[35m    if the private key is unencrypted.[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m634 | [0m[35m        return entry[0m
[30;1m635 | [0m[35m[0m
[30;1m636 | [0m[35m[0m
[30;1m637 | [0m[35mdef load_pem_private_key(data: bytes, password: bytes | None) -> rsa.RSAPrivateKey:[0m
[30;1m638 | [0m[35m    """[0m
[30;1m639 | [0m[35m    like cryptography's load_pem_private_key, but silently falls back to not using a password[0m
[30;1m640 | [0m[35m    if the private key is unencrypted.[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m624 | [0m[35m                    sans,[0m
[30;1m625 | [0m[35m                    organization,[0m
[30;1m626 | [0m[35m                ),[0m
[30;1m627 | [0m[35m                privatekey=self.default_privatekey,[0m
[30;1m628 | [0m[35m                chain_file=self.default_chain_file,[0m
[30;1m629 | [0m[35m                chain_certs=self.default_chain_certs,[0m
[30;1m630 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m624 | [0m[35m                    sans,[0m
[30;1m625 | [0m[35m                    organization,[0m
[30;1m626 | [0m[35m                ),[0m
[30;1m627 | [0m[35m                privatekey=self.default_privatekey,[0m
[30;1m628 | [0m[35m                chain_file=self.default_chain_file,[0m
[30;1m629 | [0m[35m                chain_certs=self.default_chain_certs,[0m
[30;1m630 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m618 | [0m[35m        else:[0m
[30;1m619 | [0m[35m            entry = CertStoreEntry([0m
[30;1m620 | [0m[35m                cert=dummy_cert([0m
[30;1m621 | [0m[35m                    self.default_privatekey,[0m
[30;1m622 | [0m[35m                    self.default_ca._cert,[0m
[30;1m623 | [0m[35m                    commonname,[0m
[30;1m624 | [0m[35m                    sans,[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m557 | [0m[35m                f"This indicates a misconfiguration, see https://docs.mitmproxy.org/stable/concepts-[0m
[30;1m558 | [0m[35m            )[0m
[30;1m559 | [0m[35m[0m
[30;1m560 | [0m[35m        self.add_cert(CertStoreEntry(cert, private_key, path, chain), spec)[0m
[30;1m561 | [0m[35m[0m
[30;1m562 | [0m[35m    def add_cert(self, entry: CertStoreEntry, *names: str) -> None:[0m
[30;1m563 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m542 | [0m[35m                raise ValueError([0m
[30;1m543 | [0m[35m                    f'Private and public keys in "{path.absolute()}" do not match:\n'[0m
[30;1m544 | [0m[35m                    f"{cert.public_key()=}\n"[0m
[30;1m545 | [0m[35m                    f"{private_key.public_key()=}"[0m
[30;1m546 | [0m[35m                )[0m
[30;1m547 | [0m[35m[0m
[30;1m548 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m538 | [0m[35m                    f'Unable to find private key in "{path.absolute()}": {e}'[0m
[30;1m539 | [0m[35m                ) from e[0m
[30;1m540 | [0m[35m        else:[0m
[30;1m541 | [0m[35m            if cert.public_key() != private_key.public_key():[0m
[30;1m542 | [0m[35m                raise ValueError([0m
[30;1m543 | [0m[35m                    f'Private and public keys in "{path.absolute()}" do not match:\n'[0m
[30;1m544 | [0m[35m                    f"{cert.public_key()=}\n"[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m533 | [0m[35m            private_key = load_pem_private_key(raw, password=passphrase)[0m
[30;1m534 | [0m[35m        except ValueError as e:[0m
[30;1m535 | [0m[35m            private_key = self.default_privatekey[0m
[30;1m536 | [0m[35m            if cert.public_key() != private_key.public_key():[0m
[30;1m537 | [0m[35m                raise ValueError([0m
[30;1m538 | [0m[35m                    f'Unable to find private key in "{path.absolute()}": {e}'[0m
[30;1m539 | [0m[35m                ) from e[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m532 | [0m[35m        try:[0m
[30;1m533 | [0m[35m            private_key = load_pem_private_key(raw, password=passphrase)[0m
[30;1m534 | [0m[35m        except ValueError as e:[0m
[30;1m535 | [0m[35m            private_key = self.default_privatekey[0m
[30;1m536 | [0m[35m            if cert.public_key() != private_key.public_key():[0m
[30;1m537 | [0m[35m                raise ValueError([0m
[30;1m538 | [0m[35m                    f'Unable to find private key in "{path.absolute()}": {e}'[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m532 | [0m[35m        try:[0m
[30;1m533 | [0m[35m            private_key = load_pem_private_key(raw, password=passphrase)[0m
[30;1m534 | [0m[35m        except ValueError as e:[0m
[30;1m535 | [0m[35m            private_key = self.default_privatekey[0m
[30;1m536 | [0m[35m            if cert.public_key() != private_key.public_key():[0m
[30;1m537 | [0m[35m                raise ValueError([0m
[30;1m538 | [0m[35m                    f'Unable to find private key in "{path.absolute()}": {e}'[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m530 | [0m[35m        raw = path.read_bytes()[0m
[30;1m531 | [0m[35m        cert = Cert.from_pem(raw)[0m
[30;1m532 | [0m[35m        try:[0m
[30;1m533 | [0m[35m            private_key = load_pem_private_key(raw, password=passphrase)[0m
[30;1m534 | [0m[35m        except ValueError as e:[0m
[30;1m535 | [0m[35m            private_key = self.default_privatekey[0m
[30;1m536 | [0m[35m            if cert.public_key() != private_key.public_key():[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m530 | [0m[35m        raw = path.read_bytes()[0m
[30;1m531 | [0m[35m        cert = Cert.from_pem(raw)[0m
[30;1m532 | [0m[35m        try:[0m
[30;1m533 | [0m[35m            private_key = load_pem_private_key(raw, password=passphrase)[0m
[30;1m534 | [0m[35m        except ValueError as e:[0m
[30;1m535 | [0m[35m            private_key = self.default_privatekey[0m
[30;1m536 | [0m[35m            if cert.public_key() != private_key.public_key():[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m530 | [0m[35m        raw = path.read_bytes()[0m
[30;1m531 | [0m[35m        cert = Cert.from_pem(raw)[0m
[30;1m532 | [0m[35m        try:[0m
[30;1m533 | [0m[35m            private_key = load_pem_private_key(raw, password=passphrase)[0m
[30;1m534 | [0m[35m        except ValueError as e:[0m
[30;1m535 | [0m[35m            private_key = self.default_privatekey[0m
[30;1m536 | [0m[35m            if cert.public_key() != private_key.public_key():[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m478 | [0m[35m        organization = organization or basename[0m
[30;1m479 | [0m[35m        cn = cn or basename[0m
[30;1m480 | [0m[35m[0m
[30;1m481 | [0m[35m        key: rsa.RSAPrivateKeyWithSerialization[0m
[30;1m482 | [0m[35m        ca: x509.Certificate[0m
[30;1m483 | [0m[35m        key, ca = create_ca(organization=organization, cn=cn, key_size=key_size)[0m
[30;1m484 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m444 | [0m[35m        cls, ca_file: Path, dhparam_file: Path, passphrase: bytes | None = None[0m
[30;1m445 | [0m[35m    ) -> "CertStore":[0m
[30;1m446 | [0m[35m        raw = ca_file.read_bytes()[0m
[30;1m447 | [0m[35m        key = load_pem_private_key(raw, passphrase)[0m
[30;1m448 | [0m[35m        dh = cls.load_dhparam(dhparam_file)[0m
[30;1m449 | [0m[35m        certs = x509.load_pem_x509_certificates(raw)[0m
[30;1m450 | [0m[35m        ca = Cert(certs[0])[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m377 | [0m[35m        default_chain_file: Path | None,[0m
[30;1m378 | [0m[35m        dhparams: DHParams,[0m
[30;1m379 | [0m[35m    ):[0m
[30;1m380 | [0m[35m        self.default_privatekey = default_privatekey[0m
[30;1m381 | [0m[35m        self.default_ca = default_ca[0m
[30;1m382 | [0m[35m        self.default_chain_file = default_chain_file[0m
[30;1m383 | [0m[35m        self.default_chain_certs = ([0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m377 | [0m[35m        default_chain_file: Path | None,[0m
[30;1m378 | [0m[35m        dhparams: DHParams,[0m
[30;1m379 | [0m[35m    ):[0m
[30;1m380 | [0m[35m        self.default_privatekey = default_privatekey[0m
[30;1m381 | [0m[35m        self.default_ca = default_ca[0m
[30;1m382 | [0m[35m        self.default_chain_file = default_chain_file[0m
[30;1m383 | [0m[35m        self.default_chain_certs = ([0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m372 | [0m[35m[0m
[30;1m373 | [0m[35m    def __init__([0m
[30;1m374 | [0m[35m        self,[0m
[30;1m375 | [0m[35m        default_privatekey: rsa.RSAPrivateKey,[0m
[30;1m376 | [0m[35m        default_ca: Cert,[0m
[30;1m377 | [0m[35m        default_chain_file: Path | None,[0m
[30;1m378 | [0m[35m        dhparams: DHParams,[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m372 | [0m[35m[0m
[30;1m373 | [0m[35m    def __init__([0m
[30;1m374 | [0m[35m        self,[0m
[30;1m375 | [0m[35m        default_privatekey: rsa.RSAPrivateKey,[0m
[30;1m376 | [0m[35m        default_ca: Cert,[0m
[30;1m377 | [0m[35m        default_chain_file: Path | None,[0m
[30;1m378 | [0m[35m        dhparams: DHParams,[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m362 | [0m[35m    """[0m
[30;1m363 | [0m[35m[0m
[30;1m364 | [0m[35m    STORE_CAP = 100[0m
[30;1m365 | [0m[35m    default_privatekey: rsa.RSAPrivateKey[0m
[30;1m366 | [0m[35m    default_ca: Cert[0m
[30;1m367 | [0m[35m    default_chain_file: Path | None[0m
[30;1m368 | [0m[35m    default_chain_certs: list[Cert][0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m362 | [0m[35m    """[0m
[30;1m363 | [0m[35m[0m
[30;1m364 | [0m[35m    STORE_CAP = 100[0m
[30;1m365 | [0m[35m    default_privatekey: rsa.RSAPrivateKey[0m
[30;1m366 | [0m[35m    default_ca: Cert[0m
[30;1m367 | [0m[35m    default_chain_file: Path | None[0m
[30;1m368 | [0m[35m    default_chain_certs: list[Cert][0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m344 | [0m[35m@dataclass(frozen=True)[0m
[30;1m345 | [0m[35mclass CertStoreEntry:[0m
[30;1m346 | [0m[35m    cert: Cert[0m
[30;1m347 | [0m[35m    privatekey: rsa.RSAPrivateKey[0m
[30;1m348 | [0m[35m    chain_file: Path | None[0m
[30;1m349 | [0m[35m    chain_certs: list[Cert][0m
[30;1m350 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m344 | [0m[35m@dataclass(frozen=True)[0m
[30;1m345 | [0m[35mclass CertStoreEntry:[0m
[30;1m346 | [0m[35m    cert: Cert[0m
[30;1m347 | [0m[35m    privatekey: rsa.RSAPrivateKey[0m
[30;1m348 | [0m[35m    chain_file: Path | None[0m
[30;1m349 | [0m[35m    chain_certs: list[Cert][0m
[30;1m350 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m337 | [0m[35m    # https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.2 states[0m
[30;1m338 | [0m[35m    # that SKI is optional for the leaf cert, so we skip that.[0m
[30;1m339 | [0m[35m[0m
[30;1m340 | [0m[35m    cert = builder.sign(private_key=privkey, algorithm=hashes.SHA256())  # type: ignore[0m
[30;1m341 | [0m[35m    return Cert(cert)[0m
[30;1m342 | [0m[35m[0m
[30;1m343 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m282 | [0m[35m[0m
[30;1m283 | [0m[35m[0m
[30;1m284 | [0m[35mdef dummy_cert([0m
[30;1m285 | [0m[35m    privkey: rsa.RSAPrivateKey,[0m
[30;1m286 | [0m[35m    cacert: x509.Certificate,[0m
[30;1m287 | [0m[35m    commonname: str | None,[0m
[30;1m288 | [0m[35m    sans: Iterable[x509.GeneralName],[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m248 | [0m[35m        critical=False,[0m
[30;1m249 | [0m[35m    )[0m
[30;1m250 | [0m[35m    cert = builder.sign(private_key=private_key, algorithm=hashes.SHA256())  # type: ignore[0m
[30;1m251 | [0m[35m    return private_key, cert[0m
[30;1m252 | [0m[35m[0m
[30;1m253 | [0m[35m[0m
[30;1m254 | [0m[35mdef _fix_legacy_sans(sans: Iterable[x509.GeneralName] | list[str]) -> x509.GeneralNames:[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m247 | [0m[35m        x509.SubjectKeyIdentifier.from_public_key(private_key.public_key()),[0m
[30;1m248 | [0m[35m        critical=False,[0m
[30;1m249 | [0m[35m    )[0m
[30;1m250 | [0m[35m    cert = builder.sign(private_key=private_key, algorithm=hashes.SHA256())  # type: ignore[0m
[30;1m251 | [0m[35m    return private_key, cert[0m
[30;1m252 | [0m[35m[0m
[30;1m253 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m247 | [0m[35m        x509.SubjectKeyIdentifier.from_public_key(private_key.public_key()),[0m
[30;1m248 | [0m[35m        critical=False,[0m
[30;1m249 | [0m[35m    )[0m
[30;1m250 | [0m[35m    cert = builder.sign(private_key=private_key, algorithm=hashes.SHA256())  # type: ignore[0m
[30;1m251 | [0m[35m    return private_key, cert[0m
[30;1m252 | [0m[35m[0m
[30;1m253 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m244 | [0m[35m        critical=True,[0m
[30;1m245 | [0m[35m    )[0m
[30;1m246 | [0m[35m    builder = builder.add_extension([0m
[30;1m247 | [0m[35m        x509.SubjectKeyIdentifier.from_public_key(private_key.public_key()),[0m
[30;1m248 | [0m[35m        critical=False,[0m
[30;1m249 | [0m[35m    )[0m
[30;1m250 | [0m[35m    cert = builder.sign(private_key=private_key, algorithm=hashes.SHA256())  # type: ignore[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m222 | [0m[35m    builder = builder.not_valid_before(now - datetime.timedelta(days=2))[0m
[30;1m223 | [0m[35m    builder = builder.not_valid_after(now + CA_EXPIRY)[0m
[30;1m224 | [0m[35m    builder = builder.issuer_name(name)[0m
[30;1m225 | [0m[35m    builder = builder.public_key(private_key.public_key())[0m
[30;1m226 | [0m[35m    builder = builder.add_extension([0m
[30;1m227 | [0m[35m        x509.BasicConstraints(ca=True, path_length=None), critical=True[0m
[30;1m228 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m206 | [0m[35m) -> tuple[rsa.RSAPrivateKeyWithSerialization, x509.Certificate]:[0m
[30;1m207 | [0m[35m    now = datetime.datetime.now()[0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m    private_key = rsa.generate_private_key([0m
[30;1m210 | [0m[35m        public_exponent=65537,[0m
[30;1m211 | [0m[35m        key_size=key_size,[0m
[30;1m212 | [0m[35m    )  # type: ignore[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m206 | [0m[35m) -> tuple[rsa.RSAPrivateKeyWithSerialization, x509.Certificate]:[0m
[30;1m207 | [0m[35m    now = datetime.datetime.now()[0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m    private_key = rsa.generate_private_key([0m
[30;1m210 | [0m[35m        public_exponent=65537,[0m
[30;1m211 | [0m[35m        key_size=key_size,[0m
[30;1m212 | [0m[35m    )  # type: ignore[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m203 | [0m[35m    organization: str,[0m
[30;1m204 | [0m[35m    cn: str,[0m
[30;1m205 | [0m[35m    key_size: int,[0m
[30;1m206 | [0m[35m) -> tuple[rsa.RSAPrivateKeyWithSerialization, x509.Certificate]:[0m
[30;1m207 | [0m[35m    now = datetime.datetime.now()[0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m    private_key = rsa.generate_private_key([0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/app.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m47 | [0m[35mTRANSPARENT_PNG = ([0m
[30;1m48 | [0m[35m    b"\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x00\x01\x00\x00\x00\x01\x08"[0m
[30;1m49 | [0m[35m    b"\x04\x00\x00\x00\xb5\x1c\x0c\x02\x00\x00\x00\x0bIDATx\xdac\xfc\xff\x07"[0m
[30;1m50 | [0m[35m    b"\x00\x02\x00\x01\xfc\xa8Q\rh\x00\x00\x00\x00IEND\xaeB`\x82"[0m
[30;1m51 | [0m[35m)[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/app.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35mTRANSPARENT_PNG = ([0m
[30;1m48 | [0m[35m    b"\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x00\x01\x00\x00\x00\x01\x08"[0m
[30;1m49 | [0m[35m    b"\x04\x00\x00\x00\xb5\x1c\x0c\x02\x00\x00\x00\x0bIDATx\xdac\xfc\xff\x07"[0m
[30;1m50 | [0m[35m    b"\x00\x02\x00\x01\xfc\xa8Q\rh\x00\x00\x00\x00IEND\xaeB`\x82"[0m
[30;1m51 | [0m[35m)[0m
[30;1m52 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/app.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m45 | [0m[35mfrom mitmproxy.websocket import WebSocketMessage[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35mTRANSPARENT_PNG = ([0m
[30;1m48 | [0m[35m    b"\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x00\x01\x00\x00\x00\x01\x08"[0m
[30;1m49 | [0m[35m    b"\x04\x00\x00\x00\xb5\x1c\x0c\x02\x00\x00\x00\x0bIDATx\xdac\xfc\xff\x07"[0m
[30;1m50 | [0m[35m    b"\x00\x02\x00\x01\xfc\xa8Q\rh\x00\x00\x00\x00IEND\xaeB`\x82"[0m
[30;1m51 | [0m[35m)[0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/app.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m815 | [0m[35m            debug=debug,[0m
[30;1m816 | [0m[35m            autoreload=False,[0m
[30;1m817 | [0m[35m            transforms=[GZipContentAndFlowFiles],[0m
[30;1m818 | [0m[35m            is_valid_password=auth_addon.is_valid_password,[0m
[30;1m819 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/app.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m815 | [0m[35m            debug=debug,[0m
[30;1m816 | [0m[35m            autoreload=False,[0m
[30;1m817 | [0m[35m            transforms=[GZipContentAndFlowFiles],[0m
[30;1m818 | [0m[35m            is_valid_password=auth_addon.is_valid_password,[0m
[30;1m819 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/app.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m339 | [0m[35m        # For mitmweb, we only write a login form for IndexHandler,[0m
[30;1m340 | [0m[35m        # which has additional Sec-Fetch-Mode protections.[0m
[30;1m341 | [0m[35m        if self._is_fetch_mode_navigate():[0m
[30;1m342 | [0m[35m            self.render("login.html", invalid_password=invalid_password)[0m
[30;1m343 | [0m[35m[0m
[30;1m344 | [0m[35m    def get(self):[0m
[30;1m345 | [0m[35m        # Forbid access for non-navigate fetch modes so that they can't obtain xsrf_token.[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/app.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m339 | [0m[35m        # For mitmweb, we only write a login form for IndexHandler,[0m
[30;1m340 | [0m[35m        # which has additional Sec-Fetch-Mode protections.[0m
[30;1m341 | [0m[35m        if self._is_fetch_mode_navigate():[0m
[30;1m342 | [0m[35m            self.render("login.html", invalid_password=invalid_password)[0m
[30;1m343 | [0m[35m[0m
[30;1m344 | [0m[35m    def get(self):[0m
[30;1m345 | [0m[35m        # Forbid access for non-navigate fetch modes so that they can't obtain xsrf_token.[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/app.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m335 | [0m[35m        # Forbid access for non-navigate fetch modes so that they can't obtain xsrf_token.[0m
[30;1m336 | [0m[35m        return self.request.headers.get("Sec-Fetch-Mode", "navigate") == "navigate"[0m
[30;1m337 | [0m[35m[0m
[30;1m338 | [0m[35m    def auth_fail(self, invalid_password: bool) -> None:[0m
[30;1m339 | [0m[35m        # For mitmweb, we only write a login form for IndexHandler,[0m
[30;1m340 | [0m[35m        # which has additional Sec-Fetch-Mode protections.[0m
[30;1m341 | [0m[35m        if self._is_fetch_mode_navigate():[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/app.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m239 | [0m[35m                password = self.get_argument("token", default="")[0m
[30;1m240 | [0m[35m                if not self.settings["is_valid_password"](password):[0m
[30;1m241 | [0m[35m                    self.set_status(403)[0m
[30;1m242 | [0m[35m                    self.auth_fail(bool(password))[0m
[30;1m243 | [0m[35m                    return None[0m
[30;1m244 | [0m[35m                self.set_signed_cookie([0m
[30;1m245 | [0m[35m                    self.AUTH_COOKIE_NAME,[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/app.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m237 | [0m[35m        ) -> R | None:[0m
[30;1m238 | [0m[35m            if not self.current_user:[0m
[30;1m239 | [0m[35m                password = self.get_argument("token", default="")[0m
[30;1m240 | [0m[35m                if not self.settings["is_valid_password"](password):[0m
[30;1m241 | [0m[35m                    self.set_status(403)[0m
[30;1m242 | [0m[35m                    self.auth_fail(bool(password))[0m
[30;1m243 | [0m[35m                    return None[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/app.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m237 | [0m[35m        ) -> R | None:[0m
[30;1m238 | [0m[35m            if not self.current_user:[0m
[30;1m239 | [0m[35m                password = self.get_argument("token", default="")[0m
[30;1m240 | [0m[35m                if not self.settings["is_valid_password"](password):[0m
[30;1m241 | [0m[35m                    self.set_status(403)[0m
[30;1m242 | [0m[35m                    self.auth_fail(bool(password))[0m
[30;1m243 | [0m[35m                    return None[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/app.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m236 | [0m[35m            self: AuthRequestHandler, *args: P.args, **kwargs: P.kwargs[0m
[30;1m237 | [0m[35m        ) -> R | None:[0m
[30;1m238 | [0m[35m            if not self.current_user:[0m
[30;1m239 | [0m[35m                password = self.get_argument("token", default="")[0m
[30;1m240 | [0m[35m                if not self.settings["is_valid_password"](password):[0m
[30;1m241 | [0m[35m                    self.set_status(403)[0m
[30;1m242 | [0m[35m                    self.auth_fail(bool(password))[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/app.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m221 | [0m[35m            if fn is not tornado.web.RequestHandler._unimplemented_method:[0m
[30;1m222 | [0m[35m                setattr(cls, method, AuthRequestHandler._require_auth(fn))[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m    def auth_fail(self, invalid_password: bool) -> None:[0m
[30;1m225 | [0m[35m        """[0m
[30;1m226 | [0m[35m        Will be called when returning a 403.[0m
[30;1m227 | [0m[35m        May write a login form as the response.[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/tlsconfig.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m413 | [0m[35m[0m
[30;1m414 | [0m[35m        # set the certificates[0m
[30;1m415 | [0m[35m        tls_start.settings.certificate = entry.cert._cert[0m
[30;1m416 | [0m[35m        tls_start.settings.certificate_private_key = entry.privatekey[0m
[30;1m417 | [0m[35m        tls_start.settings.certificate_chain = [[0m
[30;1m418 | [0m[35m            cert._cert for cert in (*entry.chain_certs, *extra_chain_certs)[0m
[30;1m419 | [0m[35m        ][0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/tlsconfig.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m413 | [0m[35m[0m
[30;1m414 | [0m[35m        # set the certificates[0m
[30;1m415 | [0m[35m        tls_start.settings.certificate = entry.cert._cert[0m
[30;1m416 | [0m[35m        tls_start.settings.certificate_private_key = entry.privatekey[0m
[30;1m417 | [0m[35m        tls_start.settings.certificate_chain = [[0m
[30;1m418 | [0m[35m            cert._cert for cert in (*entry.chain_certs, *extra_chain_certs)[0m
[30;1m419 | [0m[35m        ][0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/tlsconfig.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m249 | [0m[35m[0m
[30;1m250 | [0m[35m        tls_start.ssl_conn.use_certificate(entry.cert.to_pyopenssl())[0m
[30;1m251 | [0m[35m        tls_start.ssl_conn.use_privatekey([0m
[30;1m252 | [0m[35m            crypto.PKey.from_cryptography_key(entry.privatekey)[0m
[30;1m253 | [0m[35m        )[0m
[30;1m254 | [0m[35m[0m
[30;1m255 | [0m[35m        # Force HTTP/1 for secure web proxies, we currently don't support CONNECT over HTTP/2.[0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/addons/tlsconfig.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m248 | [0m[35m        tls_start.ssl_conn = SSL.Connection(ssl_ctx)[0m
[30;1m249 | [0m[35m[0m
[30;1m250 | [0m[35m        tls_start.ssl_conn.use_certificate(entry.cert.to_pyopenssl())[0m
[30;1m251 | [0m[35m        tls_start.ssl_conn.use_privatekey([0m
[30;1m252 | [0m[35m            crypto.PKey.from_cryptography_key(entry.privatekey)[0m
[30;1m253 | [0m[35m        )[0m
[30;1m254 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/contentviews/mqtt.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m216 | [0m[35m            elif ([0m
[30;1m217 | [0m[35m                self.connect_flags["Password"] and "Password" not in self.payload[0m
[30;1m218 | [0m[35m            ):  # pragma: no cover[0m
[30;1m219 | [0m[35m                self.payload["Password"] = f[0m
[30;1m220 | [0m[35m            else:[0m
[30;1m221 | [0m[35m                raise AssertionError(f"Unknown field in CONNECT payload: {f}")[0m
[30;1m222 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/contentviews/mqtt.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m214 | [0m[35m            ):  # pragma: no cover[0m
[30;1m215 | [0m[35m                self.payload["UserName"] = f.decode("utf-8")[0m
[30;1m216 | [0m[35m            elif ([0m
[30;1m217 | [0m[35m                self.connect_flags["Password"] and "Password" not in self.payload[0m
[30;1m218 | [0m[35m            ):  # pragma: no cover[0m
[30;1m219 | [0m[35m                self.payload["Password"] = f[0m
[30;1m220 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/contentviews/mqtt.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m214 | [0m[35m            ):  # pragma: no cover[0m
[30;1m215 | [0m[35m                self.payload["UserName"] = f.decode("utf-8")[0m
[30;1m216 | [0m[35m            elif ([0m
[30;1m217 | [0m[35m                self.connect_flags["Password"] and "Password" not in self.payload[0m
[30;1m218 | [0m[35m            ):  # pragma: no cover[0m
[30;1m219 | [0m[35m                self.payload["Password"] = f[0m
[30;1m220 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/contentviews/mqtt.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m181 | [0m[35m        self.connect_flags["WillRetain"] = bool([0m
[30;1m182 | [0m[35m            self.variable_headers["ConnectFlags"][0] & 0x20[0m
[30;1m183 | [0m[35m        )[0m
[30;1m184 | [0m[35m        self.connect_flags["Password"] = bool([0m
[30;1m185 | [0m[35m            self.variable_headers["ConnectFlags"][0] & 0x40[0m
[30;1m186 | [0m[35m        )[0m
[30;1m187 | [0m[35m        self.connect_flags["UserName"] = bool([0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/contentviews/mqtt.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m94 | [0m[35mWill Topic: {self.payload.get("WillTopic")}[0m
[30;1m95 | [0m[35mWill Message: {strutils.bytes_to_escaped_str(self.payload.get("WillMessage", b"None"))}[0m
[30;1m96 | [0m[35mUser Name: {self.payload.get("UserName")}[0m
[30;1m97 | [0m[35mPassword: {strutils.bytes_to_escaped_str(self.payload.get("Password", b"None"))}[0m
[30;1m98 | [0m[35m"""[0m
[30;1m99 | [0m[35m        elif self.packet_type == self.SUBSCRIBE:[0m
[30;1m100 | [0m[35m            s += " sent topic filters: "[0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/contentviews/mqtt.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m94 | [0m[35mWill Topic: {self.payload.get("WillTopic")}[0m
[30;1m95 | [0m[35mWill Message: {strutils.bytes_to_escaped_str(self.payload.get("WillMessage", b"None"))}[0m
[30;1m96 | [0m[35mUser Name: {self.payload.get("UserName")}[0m
[30;1m97 | [0m[35mPassword: {strutils.bytes_to_escaped_str(self.payload.get("Password", b"None"))}[0m
[30;1m98 | [0m[35m"""[0m
[30;1m99 | [0m[35m        elif self.packet_type == self.SUBSCRIBE:[0m
[30;1m100 | [0m[35m            s += " sent topic filters: "[0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/log.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m78 | [0m[35m            super().filter(record)[0m
[30;1m79 | [0m[35m            and ([0m
[30;1m80 | [0m[35m                not self._initiated_in_test[0m
[30;1m81 | [0m[35m                or self._initiated_in_test == os.environ.get("PYTEST_CURRENT_TEST")[0m
[30;1m82 | [0m[35m            )[0m
[30;1m83 | [0m[35m        )[0m
[30;1m84 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/log.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m70 | [0m[35mclass MitmLogHandler(logging.Handler):[0m
[30;1m71 | [0m[35m    def __init__(self, *args, **kwargs):[0m
[30;1m72 | [0m[35m        super().__init__(*args, **kwargs)[0m
[30;1m73 | [0m[35m        self._initiated_in_test = os.environ.get("PYTEST_CURRENT_TEST")[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    def filter(self, record: logging.LogRecord) -> bool:[0m
[30;1m76 | [0m[35m        # We can't remove stale handlers here because that would modify .handlers during iteration![0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/platform/osx.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m27 | [0m[35m        else:[0m
[30;1m28 | [0m[35m            raise RuntimeError("Error getting pfctl state: " + repr(e))[0m
[30;1m29 | [0m[35m    else:[0m
[30;1m30 | [0m[35m        insufficient_priv = "sudo: a password is required" in stxt.decode([0m
[30;1m31 | [0m[35m            errors="replace"[0m
[30;1m32 | [0m[35m        )[0m
[30;1m33 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/platform/osx.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m22 | [0m[35m    try:[0m
[30;1m23 | [0m[35m        stxt = subprocess.check_output(STATECMD, stderr=subprocess.STDOUT)[0m
[30;1m24 | [0m[35m    except subprocess.CalledProcessError as e:[0m
[30;1m25 | [0m[35m        if "sudo: a password is required" in e.output.decode(errors="replace"):[0m
[30;1m26 | [0m[35m            insufficient_priv = True[0m
[30;1m27 | [0m[35m        else:[0m
[30;1m28 | [0m[35m            raise RuntimeError("Error getting pfctl state: " + repr(e))[0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/utils/arg_check.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m127 | [0m[35m                "Please use `--proxyauth SPEC` instead.\n"[0m
[30;1m128 | [0m[35m                'SPEC Format: "username:pass", "any" to accept any user/pass combination,\n'[0m
[30;1m129 | [0m[35m                '"@path" to use an Apache htpasswd file, or\n'[0m
[30;1m130 | [0m[35m                '"ldap[s]:url_server_ldap[:port]:dn_auth:password:dn_subtree[?search_filter_key=...][0m
[30;1m131 | [0m[35m                "for LDAP authentication.".format(option)[0m
[30;1m132 | [0m[35m            )[0m
[30;1m133 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/utils/arg_check.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m126 | [0m[35m                "{} is deprecated.\n"[0m
[30;1m127 | [0m[35m                "Please use `--proxyauth SPEC` instead.\n"[0m
[30;1m128 | [0m[35m                'SPEC Format: "username:pass", "any" to accept any user/pass combination,\n'[0m
[30;1m129 | [0m[35m                '"@path" to use an Apache htpasswd file, or\n'[0m
[30;1m130 | [0m[35m                '"ldap[s]:url_server_ldap[:port]:dn_auth:password:dn_subtree[?search_filter_key=...][0m
[30;1m131 | [0m[35m                "for LDAP authentication.".format(option)[0m
[30;1m132 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/utils/arg_check.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m120 | [0m[35m        if option in args:[0m
[30;1m121 | [0m[35m            print(f"{option} has been removed.")[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m    for option in ("--nonanonymous", "--singleuser", "--htpasswd"):[0m
[30;1m124 | [0m[35m        if option in args:[0m
[30;1m125 | [0m[35m            print([0m
[30;1m126 | [0m[35m                "{} is deprecated.\n"[0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/flowfilter.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m50 | [0m[35mfrom mitmproxy import udp[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35mmaybe_ignore_case = ([0m
[30;1m53 | [0m[35m    re.IGNORECASE if os.environ.get("MITMPROXY_CASE_SENSITIVE_FILTERS") != "1" else 0[0m
[30;1m54 | [0m[35m)[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/templates/login.html[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m26 | [0m[35m    <p>To access mitmproxy, please enter the password or authentication token printed in the console[0m
[30;1m27 | [0m[35m    <form method="POST">[0m
[30;1m28 | [0m[35m        <label>[0m
[30;1m29 | [0m[35m            <input type="password" name="token" size="32" placeholder="" />[0m
[30;1m30 | [0m[35m        </label>[0m
[30;1m31 | [0m[35m        {% module xsrf_form_html() %}[0m
[30;1m32 | [0m[35m        <input type="submit" />[0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/templates/login.html[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m23 | [0m[35m    {% else %}[0m
[30;1m24 | [0m[35m    <h1>403 Authentication Required</h1>[0m
[30;1m25 | [0m[35m    {% end %}[0m
[30;1m26 | [0m[35m    <p>To access mitmproxy, please enter the password or authentication token printed in the console[0m
[30;1m27 | [0m[35m    <form method="POST">[0m
[30;1m28 | [0m[35m        <label>[0m
[30;1m29 | [0m[35m            <input type="password" name="token" size="32" placeholder="" />[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/templates/login.html[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m19 | [0m[35m</head>[0m
[30;1m20 | [0m[35m<body>[0m
[30;1m21 | [0m[35m    {% if invalid_password %}[0m
[30;1m22 | [0m[35m    <h1 style="color: darkred">403 Invalid Password</h1>[0m
[30;1m23 | [0m[35m    {% else %}[0m
[30;1m24 | [0m[35m    <h1>403 Authentication Required</h1>[0m
[30;1m25 | [0m[35m    {% end %}[0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/templates/login.html[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m18 | [0m[35m    </style>[0m
[30;1m19 | [0m[35m</head>[0m
[30;1m20 | [0m[35m<body>[0m
[30;1m21 | [0m[35m    {% if invalid_password %}[0m
[30;1m22 | [0m[35m    <h1 style="color: darkred">403 Invalid Password</h1>[0m
[30;1m23 | [0m[35m    {% else %}[0m
[30;1m24 | [0m[35m    <h1>403 Authentication Required</h1>[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/io/har.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m90 | [0m[35m    response_headers = fix_headers(request_json["response"]["headers"])[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m    if content_encoding == "base64":[0m
[30;1m93 | [0m[35m        response_content = base64.b64decode(response_content)[0m
[30;1m94 | [0m[35m    elif isinstance(response_content, str):[0m
[30;1m95 | [0m[35m        # Convert text to bytes, as in `Response.set_text`[0m
[30;1m96 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/io/har.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m89 | [0m[35m    content_encoding = request_json["response"]["content"].get("encoding", None)[0m
[30;1m90 | [0m[35m    response_headers = fix_headers(request_json["response"]["headers"])[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m    if content_encoding == "base64":[0m
[30;1m93 | [0m[35m        response_content = base64.b64decode(response_content)[0m
[30;1m94 | [0m[35m    elif isinstance(response_content, str):[0m
[30;1m95 | [0m[35m        # Convert text to bytes, as in `Response.set_text`[0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/io/har.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35m"""Reads HAR files into flow objects"""[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35mimport logging[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35mfrom datetime import datetime[0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m122 | [0m[35mledComponent:nb,ReactDOMComponentTree:G,ReactDOMEventListener:L}};Cj({findFiberByHostInstance:G.getC[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m},{"fbjs/lib/EventListener":6,"fbjs/lib/ExecutionEnvironment":7,"fbjs/lib/containsNode":8,"fbjs/lib/[0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/console/master.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m212 | [0m[35m        detected_encoding = urwid.detected_encoding.lower()[0m
[30;1m213 | [0m[35m        if os.name != "nt" and detected_encoding and "utf" not in detected_encoding:[0m
[30;1m214 | [0m[35m            print([0m
[30;1m215 | [0m[35m                f"mitmproxy expects a UTF-8 console environment, not {urwid.detected_encoding!r}. "[0m
[30;1m216 | [0m[35m                f"Set your LANG environment variable to something like en_US.UTF-8.",[0m
[30;1m217 | [0m[35m                file=sys.stderr,[0m
[30;1m218 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/console/master.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m171 | [0m[35m        c = ([0m
[30;1m172 | [0m[35m            os.environ.get("MITMPROXY_EDITOR")[0m
[30;1m173 | [0m[35m            or os.environ.get("PAGER")[0m
[30;1m174 | [0m[35m            or os.environ.get("EDITOR")[0m
[30;1m175 | [0m[35m        )[0m
[30;1m176 | [0m[35m        if not c:[0m
[30;1m177 | [0m[35m            c = "less"[0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/console/master.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m170 | [0m[35m        # hm which one should get priority?[0m
[30;1m171 | [0m[35m        c = ([0m
[30;1m172 | [0m[35m            os.environ.get("MITMPROXY_EDITOR")[0m
[30;1m173 | [0m[35m            or os.environ.get("PAGER")[0m
[30;1m174 | [0m[35m            or os.environ.get("EDITOR")[0m
[30;1m175 | [0m[35m        )[0m
[30;1m176 | [0m[35m        if not c:[0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/console/master.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35m        # hm which one should get priority?[0m
[30;1m171 | [0m[35m        c = ([0m
[30;1m172 | [0m[35m            os.environ.get("MITMPROXY_EDITOR")[0m
[30;1m173 | [0m[35m            or os.environ.get("PAGER")[0m
[30;1m174 | [0m[35m            or os.environ.get("EDITOR")[0m
[30;1m175 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/console/master.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m114 | [0m[35m        # based upon https://github.com/pallets/click/blob/main/src/click/_termui_impl.py[0m
[30;1m115 | [0m[35m        if m := os.environ.get("MITMPROXY_EDITOR"):[0m
[30;1m116 | [0m[35m            return m[0m
[30;1m117 | [0m[35m        if m := os.environ.get("EDITOR"):[0m
[30;1m118 | [0m[35m            return m[0m
[30;1m119 | [0m[35m        for editor in "sensible-editor", "nano", "vim":[0m
[30;1m120 | [0m[35m            if shutil.which(editor):[0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/mitmproxy/tools/console/master.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m    def get_editor(self) -> str:[0m
[30;1m114 | [0m[35m        # based upon https://github.com/pallets/click/blob/main/src/click/_termui_impl.py[0m
[30;1m115 | [0m[35m        if m := os.environ.get("MITMPROXY_EDITOR"):[0m
[30;1m116 | [0m[35m            return m[0m
[30;1m117 | [0m[35m        if m := os.environ.get("EDITOR"):[0m
[30;1m118 | [0m[35m            return m[0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000805[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongBinaryStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/mitmproxy/proxy/layers/modes.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){10,}[0m
[30;1m294 | [0m[35m            yield commands.CloseConnection(self.context.client)[0m
[30;1m295 | [0m[35m        else:[0m
[30;1m296 | [0m[35m            yield commands.SendData([0m
[30;1m297 | [0m[35m                self.context.client, b"\x05\x00\x00\x01\x00\x00\x00\x00\x00\x00"[0m
[30;1m298 | [0m[35m            )[0m
[30;1m299 | [0m[35m            if self.buf:[0m
[30;1m300 | [0m[35m                yield from self.child_layer.handle_event([0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000805[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongBinaryStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/mitmproxy/proxy/layers/modes.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){10,}[0m
[30;1m289 | [0m[35m        err = yield from self.finish_start()[0m
[30;1m290 | [0m[35m        if err:[0m
[30;1m291 | [0m[35m            yield commands.SendData([0m
[30;1m292 | [0m[35m                self.context.client, b"\x05\x04\x00\x01\x00\x00\x00\x00\x00\x00"[0m
[30;1m293 | [0m[35m            )[0m
[30;1m294 | [0m[35m            yield commands.CloseConnection(self.context.client)[0m
[30;1m295 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/mitmproxy/contrib/wbxml/ASWBXML.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m526 | [0m[35m		page.addToken(0x2E, "RequireEncryptedSMIMEMessages")[0m
[30;1m527 | [0m[35m		page.addToken(0x2F, "RequireSignedSMIMEAlgorithm")[0m
[30;1m528 | [0m[35m		page.addToken(0x30, "RequireEncryptionSMIMEAlgorithm")[0m
[30;1m529 | [0m[35m		page.addToken(0x31, "AllowSMIMEEncryptionAlgorithmNegotiation")[0m
[30;1m530 | [0m[35m		page.addToken(0x32, "AllowSMIMESoftCerts")[0m
[30;1m531 | [0m[35m		page.addToken(0x33, "AllowBrowser")[0m
[30;1m532 | [0m[35m		page.addToken(0x34, "AllowConsumerEmail")[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/mitmproxy/version.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m22 | [0m[35m        # Check that we're in the mitmproxy repository: https://github.com/mitmproxy/mitmproxy/issue[0m
[30;1m23 | [0m[35m        # cb0e3287090786fad566feb67ac07b8ef361b2c3 is the first mitmproxy commit.[0m
[30;1m24 | [0m[35m        subprocess.run([0m
[30;1m25 | [0m[35m            ["git", "cat-file", "-e", "cb0e3287090786fad566feb67ac07b8ef361b2c3"],[0m
[30;1m26 | [0m[35m            stdout=subprocess.DEVNULL,[0m
[30;1m27 | [0m[35m            stderr=subprocess.DEVNULL,[0m
[30;1m28 | [0m[35m            cwd=here,[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000805[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongBinaryStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/mitmproxy/tools/web/app.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){10,}[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35mTRANSPARENT_PNG = ([0m
[30;1m48 | [0m[35m    b"\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x00\x01\x00\x00\x00\x01\x08"[0m
[30;1m49 | [0m[35m    b"\x04\x00\x00\x00\xb5\x1c\x0c\x02\x00\x00\x00\x0bIDATx\xdac\xfc\xff\x07"[0m
[30;1m50 | [0m[35m    b"\x00\x02\x00\x01\xfc\xa8Q\rh\x00\x00\x00\x00IEND\xaeB`\x82"[0m
[30;1m51 | [0m[35m)[0m
[30;1m52 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m485 | [0m[35m        is_websocket = ([0m
[30;1m486 | [0m[35m            self.flow.response.status_code == 101[0m
[30;1m487 | [0m[35m            and self.flow.response.headers.get("upgrade", "").lower() == "websocket"[0m
[30;1m488 | [0m[35m            and self.flow.request.headers.get("Sec-WebSocket-Version", "").encode()[0m
[30;1m489 | [0m[35m            == wsproto.handshake.WEBSOCKET_VERSION[0m
[30;1m490 | [0m[35m            and self.context.options.websocket[0m
[30;1m491 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m484 | [0m[35m[0m
[30;1m485 | [0m[35m        is_websocket = ([0m
[30;1m486 | [0m[35m            self.flow.response.status_code == 101[0m
[30;1m487 | [0m[35m            and self.flow.response.headers.get("upgrade", "").lower() == "websocket"[0m
[30;1m488 | [0m[35m            and self.flow.request.headers.get("Sec-WebSocket-Version", "").encode()[0m
[30;1m489 | [0m[35m            == wsproto.handshake.WEBSOCKET_VERSION[0m
[30;1m490 | [0m[35m            and self.context.options.websocket[0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m279 | [0m[35m        if (yield from self.check_killed(True)):[0m
[30;1m280 | [0m[35m            return[0m
[30;1m281 | [0m[35m[0m
[30;1m282 | [0m[35m        if self.flow.request.headers.get("expect", "").lower() == "100-continue":[0m
[30;1m283 | [0m[35m            continue_response = http.Response.make(100)[0m
[30;1m284 | [0m[35m            continue_response.headers.clear()[0m
[30;1m285 | [0m[35m            yield SendHttp([0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1163 | [0m[35m                and self.context.client.alpn == b"h2"[0m
[30;1m1164 | [0m[35m                and command.connection.alpn != b"h2"[0m
[30;1m1165 | [0m[35m            ):[0m
[30;1m1166 | [0m[35m                for cmd in waiting[1:]:[0m
[30;1m1167 | [0m[35m                    yield from self.get_connection(cmd, reuse=False)[0m
[30;1m1168 | [0m[35m                break[0m
[30;1m1169 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1149 | [0m[35m        else:[0m
[30;1m1150 | [0m[35m            reply = (command.connection, None)[0m
[30;1m1151 | [0m[35m[0m
[30;1m1152 | [0m[35m        for cmd in waiting:[0m
[30;1m1153 | [0m[35m            stream = self.command_sources.pop(cmd)[0m
[30;1m1154 | [0m[35m            yield from self.event_to_child([0m
[30;1m1155 | [0m[35m                stream, GetHttpConnectionCompleted(cmd, reply)[0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1076 | [0m[35m                            )[0m
[30;1m1077 | [0m[35m                            return[0m
[30;1m1078 | [0m[35m                    else:[0m
[30;1m1079 | [0m[35m                        pass  # the connection is at least half-closed already, we want a new one.[0m
[30;1m1080 | [0m[35m[0m
[30;1m1081 | [0m[35m        context_connection_matches = ([0m
[30;1m1082 | [0m[35m            self.context.server not in self.connections[0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m953 | [0m[35m            try:[0m
[30;1m954 | [0m[35m                conn = self.connections[event.flow.server_conn][0m
[30;1m955 | [0m[35m            except KeyError:[0m
[30;1m956 | [0m[35m                # We have a miss for the server connection, which means we're looking at a connectio[0m
[30;1m957 | [0m[35m                # that is tunneled over another connection (for example: over an upstream HTTP proxy[0m
[30;1m958 | [0m[35m                # We now take the stream associated with the client connection. That won't work for [0m
[30;1m959 | [0m[35m                # but it's good enough for HTTP/1.[0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m296 | [0m[35m    def start_request_stream(self) -> layer.CommandGenerator[None]:[0m
[30;1m297 | [0m[35m        if self.flow.response:[0m
[30;1m298 | [0m[35m            raise NotImplementedError([0m
[30;1m299 | [0m[35m                "Can't set a response and enable streaming at the same time."[0m
[30;1m300 | [0m[35m            )[0m
[30;1m301 | [0m[35m        ok = yield from self.make_server_connection()[0m
[30;1m302 | [0m[35m        if not ok:[0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m260 | [0m[35m            # see https://github.com/mitmproxy/mitmproxy/issues/1759[0m
[30;1m261 | [0m[35m            self.flow.request.authority = ""[0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m        # update host header in reverse proxy mode[0m
[30;1m264 | [0m[35m        if ([0m
[30;1m265 | [0m[35m            isinstance(self.context.client.proxy_mode, ReverseMode)[0m
[30;1m266 | [0m[35m            and not self.context.options.keep_host_header[0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1109 | [0m[35m                stack /= _upstream_proxy.HttpUpstreamProxy.make(context, send_connect)[0m
[30;1m1110 | [0m[35m            if event.tls:[0m
[30;1m1111 | [0m[35m                # Assume that we are in transparent mode and lazily did not open a connection yet.[0m
[30;1m1112 | [0m[35m                # We don't want the IP (which is the address) as the upstream SNI, but the client's [0m
[30;1m1113 | [0m[35m                if ([0m
[30;1m1114 | [0m[35m                    self.mode == HTTPMode.transparent[0m
[30;1m1115 | [0m[35m                    and event.address == self.context.server.address[0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m61 | [0m[35mfrom mitmproxy.proxy.layers import tls[0m
[30;1m62 | [0m[35mfrom mitmproxy.proxy.layers import websocket[0m
[30;1m63 | [0m[35mfrom mitmproxy.proxy.layers.http import _upstream_proxy[0m
[30;1m64 | [0m[35mfrom mitmproxy.proxy.utils import expect[0m
[30;1m65 | [0m[35mfrom mitmproxy.proxy.utils import ReceiveBuffer[0m
[30;1m66 | [0m[35mfrom mitmproxy.utils import human[0m
[30;1m67 | [0m[35mfrom mitmproxy.websocket import WebSocketData[0m
[30;1m68 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport collections[0m
[30;1m2 | [0m[35mimport enum[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mfrom dataclasses import dataclass[0m
[30;1m5 | [0m[35mfrom functools import cached_property[0m
[30;1m6 | [0m[35mfrom logging import DEBUG[0m
[30;1m7 | [0m[35mfrom logging import WARNING[0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_http2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m586 | [0m[35m            status: str | int = "<unknown status>"[0m
[30;1m587 | [0m[35m            try:[0m
[30;1m588 | [0m[35m                status = int(headers[":status"])[0m
[30;1m589 | [0m[35m                reason = status_codes.RESPONSES.get(status, "")[0m
[30;1m590 | [0m[35m            except (KeyError, ValueError):[0m
[30;1m591 | [0m[35m                reason = ""[0m
[30;1m592 | [0m[35m            yield Log(f"Swallowing HTTP/2 informational response: {status} {reason}")[0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_http2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m548 | [0m[35m    def handle_h2_event(self, event: h2.events.Event) -> CommandGenerator[bool]:[0m
[30;1m549 | [0m[35m        if isinstance(event, h2.events.ResponseReceived):[0m
[30;1m550 | [0m[35m            if ([0m
[30;1m551 | [0m[35m                self.streams.get(event.stream_id, None)[0m
[30;1m552 | [0m[35m                is not StreamState.EXPECTING_HEADERS[0m
[30;1m553 | [0m[35m            ):[0m
[30;1m554 | [0m[35m                yield from self.protocol_error(f"Received unexpected HTTP/2 response.")[0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_http2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m475 | [0m[35m        # and HTTP/2 forbids opening a stream on a lower id than what was previously sent (see test_[0m
[30;1m476 | [0m[35m        # To mitigate this, we transparently map the outside's stream id to our stream id.[0m
[30;1m477 | [0m[35m        if isinstance(event, HttpEvent):[0m
[30;1m478 | [0m[35m            ours = self.our_stream_id.get(event.stream_id, None)[0m
[30;1m479 | [0m[35m            if ours is None:[0m
[30;1m480 | [0m[35m                no_free_streams = self.h2_conn.open_outbound_streams >= ([0m
[30;1m481 | [0m[35m                    self.provisional_max_concurrency[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_http2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m414 | [0m[35m            except ValueError as e:[0m
[30;1m415 | [0m[35m                yield from self.protocol_error(f"Invalid HTTP/2 request headers: {e}")[0m
[30;1m416 | [0m[35m                return True[0m
[30;1m417 | [0m[35m            request = http.Request([0m
[30;1m418 | [0m[35m                host=host,[0m
[30;1m419 | [0m[35m                port=port,[0m
[30;1m420 | [0m[35m                method=method,[0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_http2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m217 | [0m[35m            trailers = http.Headers(event.headers)[0m
[30;1m218 | [0m[35m            yield ReceiveHttp(self.ReceiveTrailers(event.stream_id, trailers))[0m
[30;1m219 | [0m[35m        elif isinstance(event, h2.events.StreamEnded):[0m
[30;1m220 | [0m[35m            state = self.streams.get(event.stream_id, None)[0m
[30;1m221 | [0m[35m            if state is StreamState.HEADERS_RECEIVED:[0m
[30;1m222 | [0m[35m                yield ReceiveHttp(self.ReceiveEndOfMessage(event.stream_id))[0m
[30;1m223 | [0m[35m            elif state is StreamState.EXPECTING_HEADERS:[0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_http2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m202 | [0m[35m    def handle_h2_event(self, event: h2.events.Event) -> CommandGenerator[bool]:[0m
[30;1m203 | [0m[35m        """returns true if further processing should be stopped."""[0m
[30;1m204 | [0m[35m        if isinstance(event, h2.events.DataReceived):[0m
[30;1m205 | [0m[35m            state = self.streams.get(event.stream_id, None)[0m
[30;1m206 | [0m[35m            if state is StreamState.HEADERS_RECEIVED:[0m
[30;1m207 | [0m[35m                yield ReceiveHttp(self.ReceiveData(event.stream_id, event.data))[0m
[30;1m208 | [0m[35m            elif state is StreamState.EXPECTING_HEADERS:[0m

[31m--[ [0m[34mMatch #[0m[33m232[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_http2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m138 | [0m[35m                if not self.is_closed(event.stream_id):[0m
[30;1m139 | [0m[35m                    code = {[0m
[30;1m140 | [0m[35m                        status_codes.CLIENT_CLOSED_REQUEST: h2.errors.ErrorCodes.CANCEL,[0m
[30;1m141 | [0m[35m                    }.get(event.code, h2.errors.ErrorCodes.INTERNAL_ERROR)[0m
[30;1m142 | [0m[35m                    stream: h2.stream.H2Stream = self.h2_conn.streams[event.stream_id][0m
[30;1m143 | [0m[35m                    send_error_message = ([0m
[30;1m144 | [0m[35m                        isinstance(event, ResponseProtocolError)[0m

[31m--[ [0m[34mMatch #[0m[33m233[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_http2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m    def is_open_for_us(self, stream_id: int) -> bool:[0m
[30;1m107 | [0m[35m        """Check if we can write to a non-idle stream."""[0m
[30;1m108 | [0m[35m        stream = self.h2_conn.streams.get(stream_id, None)[0m
[30;1m109 | [0m[35m        if ([0m
[30;1m110 | [0m[35m            stream is not None[0m
[30;1m111 | [0m[35m            and stream.state_machine.state[0m

[31m--[ [0m[34mMatch #[0m[33m234[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_http2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m    def is_closed(self, stream_id: int) -> bool:[0m
[30;1m94 | [0m[35m        """Check if a non-idle stream is closed"""[0m
[30;1m95 | [0m[35m        stream = self.h2_conn.streams.get(stream_id, None)[0m
[30;1m96 | [0m[35m        if ([0m
[30;1m97 | [0m[35m            stream is not None[0m
[30;1m98 | [0m[35m            and stream.state_machine.state is not h2.stream.StreamState.CLOSED[0m

[31m--[ [0m[34mMatch #[0m[33m235[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_http2.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m617 | [0m[35m            pseudo_headers[header] = value[0m
[30;1m618 | [0m[35m            i += 1[0m
[30;1m619 | [0m[35m        else:[0m
[30;1m620 | [0m[35m            # Pseudo-headers must be at the start, we are done here.[0m
[30;1m621 | [0m[35m            break[0m
[30;1m622 | [0m[35m[0m
[30;1m623 | [0m[35m    headers = http.Headers(h2_headers[i:])[0m

[31m--[ [0m[34mMatch #[0m[33m236[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_http2.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m597 | [0m[35m            )[0m
[30;1m598 | [0m[35m            return True[0m
[30;1m599 | [0m[35m        elif isinstance(event, h2.events.RemoteSettingsChanged):[0m
[30;1m600 | [0m[35m            # We have received at least one settings from now,[0m
[30;1m601 | [0m[35m            # which means we can rely on the max concurrency in remote_settings[0m
[30;1m602 | [0m[35m            self.provisional_max_concurrency = None[0m
[30;1m603 | [0m[35m            return (yield from super().handle_h2_event(event))[0m

[31m--[ [0m[34mMatch #[0m[33m237[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_http2.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m492 | [0m[35m        for cmd in self._handle_event2(event):[0m
[30;1m493 | [0m[35m            if isinstance(cmd, ReceiveHttp):[0m
[30;1m494 | [0m[35m                cmd.event.stream_id = self.their_stream_id[cmd.event.stream_id][0m
[30;1m495 | [0m[35m            yield cmd[0m
[30;1m496 | [0m[35m[0m
[30;1m497 | [0m[35m        can_resume_queue = self.stream_queue and self.h2_conn.open_outbound_streams < ([0m
[30;1m498 | [0m[35m            self.provisional_max_concurrency[0m
[30;1m499 | [0m[35m            or self.h2_conn.remote_settings.max_concurrent_streams[0m

[31m--[ [0m[34mMatch #[0m[33m238[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_http2.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m489 | [0m[35m                self.their_stream_id[ours] = event.stream_id[0m
[30;1m490 | [0m[35m            event.stream_id = ours[0m
[30;1m491 | [0m[35m[0m
[30;1m492 | [0m[35m        for cmd in self._handle_event2(event):[0m
[30;1m493 | [0m[35m            if isinstance(cmd, ReceiveHttp):[0m
[30;1m494 | [0m[35m                cmd.event.stream_id = self.their_stream_id[cmd.event.stream_id][0m
[30;1m495 | [0m[35m            yield cmd[0m

[31m--[ [0m[34mMatch #[0m[33m239[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_http2.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m27 | [0m[35mfrom ...events import Start[0m
[30;1m28 | [0m[35mfrom ...events import Wakeup[0m
[30;1m29 | [0m[35mfrom ...layer import CommandGenerator[0m
[30;1m30 | [0m[35mfrom ...utils import expect[0m
[30;1m31 | [0m[35mfrom . import RequestData[0m
[30;1m32 | [0m[35mfrom . import RequestEndOfMessage[0m
[30;1m33 | [0m[35mfrom . import RequestHeaders[0m
[30;1m34 | [0m[35mfrom . import RequestProtocolError[0m

[31m--[ [0m[34mMatch #[0m[33m240[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_http2.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport collections[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35mfrom collections.abc import Sequence[0m
[30;1m4 | [0m[35mfrom enum import Enum[0m
[30;1m5 | [0m[35mfrom logging import DEBUG[0m
[30;1m6 | [0m[35mfrom logging import ERROR[0m

[31m--[ [0m[34mMatch #[0m[33m241[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/quic/_stream_layers.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m180 | [0m[35m        if timer is not None:[0m
[30;1m181 | [0m[35m            # smooth wakeups a bit.[0m
[30;1m182 | [0m[35m            smoothed = timer + 0.002[0m
[30;1m183 | [0m[35m            # request a new wakeup if all pending requests trigger at a later time[0m
[30;1m184 | [0m[35m            if not any([0m
[30;1m185 | [0m[35m                existing <= smoothed for existing in self._wakeup_commands.values()[0m
[30;1m186 | [0m[35m            ):[0m

[31m--[ [0m[34mMatch #[0m[33m242[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/quic/_stream_layers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m452 | [0m[35m        try:[0m
[30;1m453 | [0m[35m            header = pull_quic_header(buffer)[0m
[30;1m454 | [0m[35m        except TypeError:[0m
[30;1m455 | [0m[35m            return False, f"Cannot parse QUIC header: Malformed head ({data.hex()})"[0m
[30;1m456 | [0m[35m        except ValueError as e:[0m
[30;1m457 | [0m[35m            return False, f"Cannot parse QUIC header: {e} ({data.hex()})"[0m
[30;1m458 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m243[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/quic/_stream_layers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m180 | [0m[35m        if timer is not None:[0m
[30;1m181 | [0m[35m            # smooth wakeups a bit.[0m
[30;1m182 | [0m[35m            smoothed = timer + 0.002[0m
[30;1m183 | [0m[35m            # request a new wakeup if all pending requests trigger at a later time[0m
[30;1m184 | [0m[35m            if not any([0m
[30;1m185 | [0m[35m                existing <= smoothed for existing in self._wakeup_commands.values()[0m
[30;1m186 | [0m[35m            ):[0m
[30;1m187 | [0m[35m                command = commands.RequestWakeup(timer - now)[0m

[31m--[ [0m[34mMatch #[0m[33m244[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/quic/_stream_layers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m70 | [0m[35m    ) -> None:[0m
[30;1m71 | [0m[35m        super().__init__(context, tunnel_connection=conn, conn=conn)[0m
[30;1m72 | [0m[35m        self.child_layer = layer.NextLayer(self.context, ask_on_start=True)[0m
[30;1m73 | [0m[35m        self._time = time or ctx.master.event_loop.time[0m
[30;1m74 | [0m[35m        self._wakeup_commands: dict[commands.RequestWakeup, float] = dict()[0m
[30;1m75 | [0m[35m        conn.tls = True[0m
[30;1m76 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m245[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/quic/_stream_layers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mfrom __future__ import annotations[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mimport time[0m
[30;1m10 | [0m[35mfrom collections.abc import Callable[0m
[30;1m11 | [0m[35mfrom logging import DEBUG[0m
[30;1m12 | [0m[35mfrom logging import ERROR[0m
[30;1m13 | [0m[35mfrom logging import WARNING[0m

[31m--[ [0m[34mMatch #[0m[33m246[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/quic/_client_hello_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m101 | [0m[35m    traces = quic_logger.to_dict().get("traces")[0m
[30;1m102 | [0m[35m    assert isinstance(traces, list)[0m
[30;1m103 | [0m[35m    for trace in traces:[0m
[30;1m104 | [0m[35m        quic_events = trace.get("events")[0m
[30;1m105 | [0m[35m        for event in quic_events:[0m
[30;1m106 | [0m[35m            if event["name"] == "transport:packet_dropped":[0m
[30;1m107 | [0m[35m                raise ValueError([0m

[31m--[ [0m[34mMatch #[0m[33m247[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/quic/_client_hello_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m    quic_logger = quic._configuration.quic_logger[0m
[30;1m100 | [0m[35m    assert isinstance(quic_logger, QuicLogger)[0m
[30;1m101 | [0m[35m    traces = quic_logger.to_dict().get("traces")[0m
[30;1m102 | [0m[35m    assert isinstance(traces, list)[0m
[30;1m103 | [0m[35m    for trace in traces:[0m
[30;1m104 | [0m[35m        quic_events = trace.get("events")[0m

[31m--[ [0m[34mMatch #[0m[33m248[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/quic/_client_hello_parser.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mfrom __future__ import annotations[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mimport time[0m
[30;1m10 | [0m[35mfrom dataclasses import dataclass[0m
[30;1m11 | [0m[35mfrom typing import Optional[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mfrom aioquic.buffer import Buffer as QuicBuffer[0m

[31m--[ [0m[34mMatch #[0m[33m249[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.css[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m

[31m--[ [0m[34mMatch #[0m[33m250[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.css[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m

[31m--[ [0m[34mMatch #[0m[33m251[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.css[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m

[31m--[ [0m[34mMatch #[0m[33m252[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.css[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m

[31m--[ [0m[34mMatch #[0m[33m253[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/http/http1/read.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m144 | [0m[35m    #        the recipient times out before the indicated number of octets are[0m
[30;1m145 | [0m[35m    #        received, the recipient MUST consider the message to be[0m
[30;1m146 | [0m[35m    #        incomplete and close the connection.[0m
[30;1m147 | [0m[35m    if cl := headers.get("content-length"):[0m
[30;1m148 | [0m[35m        return validate.parse_content_length(cl)[0m
[30;1m149 | [0m[35m    #    6.  If this is a request message and none of the above are true, then[0m
[30;1m150 | [0m[35m    #        the message body length is zero (no message body is present).[0m

[31m--[ [0m[34mMatch #[0m[33m254[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/http/http1/read.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m105 | [0m[35m    #        remove the received Content-Length field prior to forwarding such[0m
[30;1m106 | [0m[35m    #        a message downstream.[0m
[30;1m107 | [0m[35m    #[0m
[30;1m108 | [0m[35m    if te_str := headers.get("transfer-encoding"):[0m
[30;1m109 | [0m[35m        te = validate.parse_transfer_encoding(te_str)[0m
[30;1m110 | [0m[35m        match te:[0m
[30;1m111 | [0m[35m            case "chunked" | "compress,chunked" | "deflate,chunked" | "gzip,chunked":[0m

[31m--[ [0m[34mMatch #[0m[33m255[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/http/http1/read.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m116 | [0m[35m                # These values are valid for responses only (not requests), which is ensured in[0m
[30;1m117 | [0m[35m                # mitmproxy.net.http.validate. If users have explicitly disabled header validation,[0m
[30;1m118 | [0m[35m                # we strive for maximum compatibility with weird clients.[0m
[30;1m119 | [0m[35m                if te == "identity" or "content-length" in headers:[0m
[30;1m120 | [0m[35m                    pass  # Content-Length or 0[0m
[30;1m121 | [0m[35m                else:[0m
[30;1m122 | [0m[35m                    return ([0m

[31m--[ [0m[34mMatch #[0m[33m256[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/http/http1/read.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m106 | [0m[35m    #        a message downstream.[0m
[30;1m107 | [0m[35m    #[0m
[30;1m108 | [0m[35m    if te_str := headers.get("transfer-encoding"):[0m
[30;1m109 | [0m[35m        te = validate.parse_transfer_encoding(te_str)[0m
[30;1m110 | [0m[35m        match te:[0m
[30;1m111 | [0m[35m            case "chunked" | "compress,chunked" | "deflate,chunked" | "gzip,chunked":[0m
[30;1m112 | [0m[35m                return None[0m

[31m--[ [0m[34mMatch #[0m[33m257[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/http/http1/read.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m277 | [0m[35m[0m
[30;1m278 | [0m[35mdef read_response_head(lines: list[bytes]) -> Response:[0m
[30;1m279 | [0m[35m    """[0m
[30;1m280 | [0m[35m    Parse an HTTP response head (response line + headers) from an iterable of lines[0m
[30;1m281 | [0m[35m[0m
[30;1m282 | [0m[35m    Args:[0m
[30;1m283 | [0m[35m        lines: The input lines[0m

[31m--[ [0m[34mMatch #[0m[33m258[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/http/http1/read.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m243 | [0m[35m[0m
[30;1m244 | [0m[35mdef read_request_head(lines: list[bytes]) -> Request:[0m
[30;1m245 | [0m[35m    """[0m
[30;1m246 | [0m[35m    Parse an HTTP request head (request line + headers) from an iterable of lines[0m
[30;1m247 | [0m[35m[0m
[30;1m248 | [0m[35m    Args:[0m
[30;1m249 | [0m[35m        lines: The input lines[0m

[31m--[ [0m[34mMatch #[0m[33m259[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/http/http1/read.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m63 | [0m[35m    else:[0m
[30;1m64 | [0m[35m        headers = response.headers[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m        #    1.  Any response to a HEAD request and any response with a 1xx[0m
[30;1m67 | [0m[35m        #        (Informational), 204 (No Content), or 304 (Not Modified) status[0m
[30;1m68 | [0m[35m        #        code is always terminated by the first empty line after the[0m
[30;1m69 | [0m[35m        #        header fields, regardless of the header fields present in the[0m

[31m--[ [0m[34mMatch #[0m[33m260[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/http/http1/read.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport re[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35mimport typing[0m
[30;1m4 | [0m[35mfrom collections.abc import Iterable[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom mitmproxy.http import Headers[0m

[31m--[ [0m[34mMatch #[0m[33m261[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/tls.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m535 | [0m[35m            # and proxy isn't that interesting to us, we just unset the attributes here and keep the[0m
[30;1m536 | [0m[35m            # session's attributes.[0m
[30;1m537 | [0m[35m            # Alternatively we could create a new Client instance,[0m
[30;1m538 | [0m[35m            # but for now we keep it simple. There is a proof-of-concept at[0m
[30;1m539 | [0m[35m            # https://github.com/mitmproxy/mitmproxy/commit/9b6e2a716888b7787514733b76a5936afa485352[0m
[30;1m540 | [0m[35m            context.client.alpn = None[0m
[30;1m541 | [0m[35m            context.client.cipher = None[0m
[30;1m542 | [0m[35m            context.client.sni = None[0m

[31m--[ [0m[34mMatch #[0m[33m262[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/tls.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m424 | [0m[35m                # This may be happening because the other side send an alert.[0m
[30;1m425 | [0m[35m                # There's somewhat ugly behavior with Firefox on Android here,[0m
[30;1m426 | [0m[35m                # which upon mistrusting a certificate still completes the handshake[0m
[30;1m427 | [0m[35m                # and then sends an alert in the next packet. At this point we have unfortunately[0m
[30;1m428 | [0m[35m                # already fired out `tls_established_client` hook.[0m
[30;1m429 | [0m[35m                yield commands.Log(f"TLS Error: {e}", WARNING)[0m
[30;1m430 | [0m[35m                break[0m

[31m--[ [0m[34mMatch #[0m[33m263[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/tls.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m164 | [0m[35mHTTP_ALPNS = (HTTP3_ALPN, HTTP2_ALPN, *HTTP1_ALPNS)[0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m# We need these classes as hooks can only have one argument at the moment.[0m
[30;1m168 | [0m[35m[0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35m@dataclass[0m

[31m--[ [0m[34mMatch #[0m[33m264[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/tls.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m105 | [0m[35m        record_header = data[offset : offset + 13][0m
[30;1m106 | [0m[35m        if not starts_like_dtls_record(record_header):[0m
[30;1m107 | [0m[35m            raise ValueError(f"Expected DTLS record, got {record_header!r} instead.")[0m
[30;1m108 | [0m[35m        # Length fields starts at 11[0m
[30;1m109 | [0m[35m        record_size = struct.unpack("!H", record_header[11:])[0][0m
[30;1m110 | [0m[35m        if record_size == 0:[0m
[30;1m111 | [0m[35m            raise ValueError("Record must not be empty.")[0m

[31m--[ [0m[34mMatch #[0m[33m265[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/tls.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m640 | [0m[35m        elif ([0m
[30;1m641 | [0m[35m            "('SSL routines', 'tls_early_post_process_client_hello', 'unsupported protocol')"[0m
[30;1m642 | [0m[35m            in err[0m
[30;1m643 | [0m[35m            or "('SSL routines', '', 'unsupported protocol')" in err  # OpenSSL 3+[0m
[30;1m644 | [0m[35m        ):[0m
[30;1m645 | [0m[35m            err = ([0m
[30;1m646 | [0m[35m                f"Client and mitmproxy cannot agree on a TLS version to use. "[0m

[31m--[ [0m[34mMatch #[0m[33m266[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/tls.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m343 | [0m[35m                err = f"The remote server does not speak TLS."[0m
[30;1m344 | [0m[35m            elif last_err in [[0m
[30;1m345 | [0m[35m                ("SSL routines", "ssl3_read_bytes", "tlsv1 alert protocol version"),[0m
[30;1m346 | [0m[35m                ("SSL routines", "", "tlsv1 alert protocol version"),  # OpenSSL 3+[0m
[30;1m347 | [0m[35m            ]:[0m
[30;1m348 | [0m[35m                err = ([0m
[30;1m349 | [0m[35m                    f"The remote server and mitmproxy cannot agree on a TLS version to use. "[0m

[31m--[ [0m[34mMatch #[0m[33m267[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/tls.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m336 | [0m[35m                    ("SSL routines", "ssl3_get_record", "wrong version number"),[0m
[30;1m337 | [0m[35m                    ("SSL routines", "", "wrong version number"),  # OpenSSL 3+[0m
[30;1m338 | [0m[35m                    ("SSL routines", "", "packet length too long"),  # OpenSSL 3+[0m
[30;1m339 | [0m[35m                    ("SSL routines", "", "record layer failure"),  # OpenSSL 3+[0m
[30;1m340 | [0m[35m                ][0m
[30;1m341 | [0m[35m                and data[:4].isascii()[0m
[30;1m342 | [0m[35m            ):[0m

[31m--[ [0m[34mMatch #[0m[33m268[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/tls.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m335 | [0m[35m                in [[0m
[30;1m336 | [0m[35m                    ("SSL routines", "ssl3_get_record", "wrong version number"),[0m
[30;1m337 | [0m[35m                    ("SSL routines", "", "wrong version number"),  # OpenSSL 3+[0m
[30;1m338 | [0m[35m                    ("SSL routines", "", "packet length too long"),  # OpenSSL 3+[0m
[30;1m339 | [0m[35m                    ("SSL routines", "", "record layer failure"),  # OpenSSL 3+[0m
[30;1m340 | [0m[35m                ][0m
[30;1m341 | [0m[35m                and data[:4].isascii()[0m

[31m--[ [0m[34mMatch #[0m[33m269[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/tls.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m334 | [0m[35m                last_err[0m
[30;1m335 | [0m[35m                in [[0m
[30;1m336 | [0m[35m                    ("SSL routines", "ssl3_get_record", "wrong version number"),[0m
[30;1m337 | [0m[35m                    ("SSL routines", "", "wrong version number"),  # OpenSSL 3+[0m
[30;1m338 | [0m[35m                    ("SSL routines", "", "packet length too long"),  # OpenSSL 3+[0m
[30;1m339 | [0m[35m                    ("SSL routines", "", "record layer failure"),  # OpenSSL 3+[0m
[30;1m340 | [0m[35m                ][0m

[31m--[ [0m[34mMatch #[0m[33m270[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/tls.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m326 | [0m[35m                ("SSL routines", "ssl3_read_bytes", "ssl/tls alert bad certificate"),[0m
[30;1m327 | [0m[35m                ("SSL routines", "", "tlsv1 alert unknown ca"),  # OpenSSL 3+[0m
[30;1m328 | [0m[35m                ("SSL routines", "", "sslv3 alert bad certificate"),  # OpenSSL 3+[0m
[30;1m329 | [0m[35m                ("SSL routines", "", "ssl/tls alert bad certificate"),  # OpenSSL 3.2+[0m
[30;1m330 | [0m[35m            ]:[0m
[30;1m331 | [0m[35m                assert isinstance(last_err, tuple)[0m
[30;1m332 | [0m[35m                err = last_err[2][0m

[31m--[ [0m[34mMatch #[0m[33m271[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/tls.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m325 | [0m[35m                ("SSL routines", "ssl3_read_bytes", "sslv3 alert bad certificate"),[0m
[30;1m326 | [0m[35m                ("SSL routines", "ssl3_read_bytes", "ssl/tls alert bad certificate"),[0m
[30;1m327 | [0m[35m                ("SSL routines", "", "tlsv1 alert unknown ca"),  # OpenSSL 3+[0m
[30;1m328 | [0m[35m                ("SSL routines", "", "sslv3 alert bad certificate"),  # OpenSSL 3+[0m
[30;1m329 | [0m[35m                ("SSL routines", "", "ssl/tls alert bad certificate"),  # OpenSSL 3.2+[0m
[30;1m330 | [0m[35m            ]:[0m
[30;1m331 | [0m[35m                assert isinstance(last_err, tuple)[0m

[31m--[ [0m[34mMatch #[0m[33m272[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/tls.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m324 | [0m[35m                ("SSL routines", "ssl3_read_bytes", "tlsv1 alert unknown ca"),[0m
[30;1m325 | [0m[35m                ("SSL routines", "ssl3_read_bytes", "sslv3 alert bad certificate"),[0m
[30;1m326 | [0m[35m                ("SSL routines", "ssl3_read_bytes", "ssl/tls alert bad certificate"),[0m
[30;1m327 | [0m[35m                ("SSL routines", "", "tlsv1 alert unknown ca"),  # OpenSSL 3+[0m
[30;1m328 | [0m[35m                ("SSL routines", "", "sslv3 alert bad certificate"),  # OpenSSL 3+[0m
[30;1m329 | [0m[35m                ("SSL routines", "", "ssl/tls alert bad certificate"),  # OpenSSL 3.2+[0m
[30;1m330 | [0m[35m            ]:[0m

[31m--[ [0m[34mMatch #[0m[33m273[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/tls.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m313 | [0m[35m                    "tls_process_server_certificate",[0m
[30;1m314 | [0m[35m                    "certificate verify failed",[0m
[30;1m315 | [0m[35m                ),[0m
[30;1m316 | [0m[35m                ("SSL routines", "", "certificate verify failed"),  # OpenSSL 3+[0m
[30;1m317 | [0m[35m            ]:[0m
[30;1m318 | [0m[35m                verify_result = SSL._lib.SSL_get_verify_result(self.tls._ssl)  # type: ignore[0m
[30;1m319 | [0m[35m                error = SSL._ffi.string(  # type: ignore[0m

[31m--[ [0m[34mMatch #[0m[33m274[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/tls.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m241 | [0m[35m[0m
[30;1m242 | [0m[35mclass TLSLayer(tunnel.TunnelLayer):[0m
[30;1m243 | [0m[35m    tls: SSL.Connection = None  # type: ignore[0m
[30;1m244 | [0m[35m    """The OpenSSL connection object"""[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m    def __init__(self, context: context.Context, conn: connection.Connection):[0m
[30;1m247 | [0m[35m        super().__init__([0m

[31m--[ [0m[34mMatch #[0m[33m275[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/tls.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35mfrom logging import INFO[0m
[30;1m9 | [0m[35mfrom logging import WARNING[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mfrom OpenSSL import SSL[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mfrom mitmproxy import certs[0m
[30;1m14 | [0m[35mfrom mitmproxy import connection[0m

[31m--[ [0m[34mMatch #[0m[33m276[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/tls.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport struct[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35mimport typing[0m
[30;1m4 | [0m[35mfrom collections.abc import Iterator[0m
[30;1m5 | [0m[35mfrom dataclasses import dataclass[0m
[30;1m6 | [0m[35mfrom logging import DEBUG[0m

[31m--[ [0m[34mMatch #[0m[33m277[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/modes.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35mfrom mitmproxy.proxy import layer[0m
[30;1m14 | [0m[35mfrom mitmproxy.proxy.commands import StartHook[0m
[30;1m15 | [0m[35mfrom mitmproxy.proxy.mode_specs import ReverseMode[0m
[30;1m16 | [0m[35mfrom mitmproxy.proxy.utils import expect[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35mif sys.version_info < (3, 11):[0m
[30;1m19 | [0m[35m    from typing_extensions import assert_never[0m
[30;1m20 | [0m[35melse:[0m

[31m--[ [0m[34mMatch #[0m[33m278[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/dns.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35mfrom mitmproxy.proxy import events[0m
[30;1m11 | [0m[35mfrom mitmproxy.proxy import layer[0m
[30;1m12 | [0m[35mfrom mitmproxy.proxy.context import Context[0m
[30;1m13 | [0m[35mfrom mitmproxy.proxy.utils import expect[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m_LENGTH_LABEL = struct.Struct("!H")[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m279[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/window.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m307 | [0m[35m    def write(self, data):[0m
[30;1m308 | [0m[35m        if common.IS_WINDOWS_OR_WSL:[0m
[30;1m309 | [0m[35m            # replace urwid's SI/SO, which produce artifacts under WSL.[0m
[30;1m310 | [0m[35m            # at some point we may figure out what they actually do.[0m
[30;1m311 | [0m[35m            data = re.sub("[\x0e\x0f]", "", data)[0m
[30;1m312 | [0m[35m        super().write(data)[0m

[31m--[ [0m[34mMatch #[0m[33m280[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/window.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m    def pop(self, *args, **kwargs):[0m
[30;1m106 | [0m[35m        """[0m
[30;1m107 | [0m[35m        Pop off the stack, return True if we're already at the top.[0m
[30;1m108 | [0m[35m        """[0m
[30;1m109 | [0m[35m        if not self.overlay and len(self.stack) == 1:[0m
[30;1m110 | [0m[35m            return True[0m

[31m--[ [0m[34mMatch #[0m[33m281[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/window.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m    def call(self, name, *args, **kwargs):[0m
[30;1m118 | [0m[35m        """[0m
[30;1m119 | [0m[35m        Call a function on both the top window, and the overlay if there is[0m
[30;1m120 | [0m[35m        one. If the widget has a key_responder, we call the function on the[0m
[30;1m121 | [0m[35m        responder instead.[0m
[30;1m122 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m282[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/window.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m    def top_widget(self):[0m
[30;1m91 | [0m[35m        """[0m
[30;1m92 | [0m[35m        The current top widget - either a window or the active overlay.[0m
[30;1m93 | [0m[35m        """[0m
[30;1m94 | [0m[35m        if self.overlay:[0m
[30;1m95 | [0m[35m            return self.overlay[0m

[31m--[ [0m[34mMatch #[0m[33m283[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/window.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m    def top_window(self):[0m
[30;1m85 | [0m[35m        """[0m
[30;1m86 | [0m[35m        The current top window, ignoring overlays.[0m
[30;1m87 | [0m[35m        """[0m
[30;1m88 | [0m[35m        return self.windows[self.stack[-1]][0m
[30;1m89 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m284[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/quickhelp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m"""[0m
[30;1m2 | [0m[35mThis module is reponsible for drawing the quick key help at the bottom of mitmproxy.[0m
[30;1m3 | [0m[35m"""[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mfrom dataclasses import dataclass[0m

[31m--[ [0m[34mMatch #[0m[33m285[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/quickhelp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35m    bottom_items: HelpItems[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m    def make_rows(self, keymap: Keymap) -> tuple[urwid.Columns, urwid.Columns]:[0m
[30;1m47 | [0m[35m        top = _make_row(self.top_label, self.top_items, keymap)[0m
[30;1m48 | [0m[35m        bottom = _make_row(self.bottom_label, self.bottom_items, keymap)[0m
[30;1m49 | [0m[35m        return top, bottom[0m
[30;1m50 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m286[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/keymap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m226 | [0m[35m                        key=v["key"],[0m
[30;1m227 | [0m[35m                        command=v["cmd"],[0m
[30;1m228 | [0m[35m                        contexts=user_ctxs,[0m
[30;1m229 | [0m[35m                        help=v.get("help", None),[0m
[30;1m230 | [0m[35m                    )[0m
[30;1m231 | [0m[35m                except ValueError as e:[0m
[30;1m232 | [0m[35m                    raise KeyBindingError(f"Error reading {p}: {e}") from e[0m

[31m--[ [0m[34mMatch #[0m[33m287[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/keymap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m218 | [0m[35m            except KeyBindingError as e:[0m
[30;1m219 | [0m[35m                raise KeyBindingError(f"Error reading {p}: {e}") from e[0m
[30;1m220 | [0m[35m            for v in vals:[0m
[30;1m221 | [0m[35m                user_ctxs = v.get("ctx", ["global"])[0m
[30;1m222 | [0m[35m                try:[0m
[30;1m223 | [0m[35m                    km._check_contexts(user_ctxs)[0m
[30;1m224 | [0m[35m                    km.remove(v["key"], user_ctxs)[0m

[31m--[ [0m[34mMatch #[0m[33m288[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/keymap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m169 | [0m[35m        Like handle, but ignores global bindings. Returns the key if it has[0m
[30;1m170 | [0m[35m        not been handled, or None.[0m
[30;1m171 | [0m[35m        """[0m
[30;1m172 | [0m[35m        b = self.get(context, key)[0m
[30;1m173 | [0m[35m        if b:[0m
[30;1m174 | [0m[35m            self.executor(b.command)[0m
[30;1m175 | [0m[35m            return None[0m

[31m--[ [0m[34mMatch #[0m[33m289[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/keymap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m158 | [0m[35m        """[0m
[30;1m159 | [0m[35m        Returns the key if it has not been handled, or None.[0m
[30;1m160 | [0m[35m        """[0m
[30;1m161 | [0m[35m        b = self.get(context, key) or self.get("global", key)[0m
[30;1m162 | [0m[35m        if b:[0m
[30;1m163 | [0m[35m            self.executor(b.command)[0m
[30;1m164 | [0m[35m            return None[0m

[31m--[ [0m[34mMatch #[0m[33m290[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/keymap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m158 | [0m[35m        """[0m
[30;1m159 | [0m[35m        Returns the key if it has not been handled, or None.[0m
[30;1m160 | [0m[35m        """[0m
[30;1m161 | [0m[35m        b = self.get(context, key) or self.get("global", key)[0m
[30;1m162 | [0m[35m        if b:[0m
[30;1m163 | [0m[35m            self.executor(b.command)[0m
[30;1m164 | [0m[35m            return None[0m

[31m--[ [0m[34mMatch #[0m[33m291[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/keymap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35m    def get(self, context: str, key: str) -> Binding | None:[0m
[30;1m138 | [0m[35m        if context in self.keys:[0m
[30;1m139 | [0m[35m            return self.keys[context].get(key, None)[0m
[30;1m140 | [0m[35m        return None[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m    @cache[0m

[31m--[ [0m[34mMatch #[0m[33m292[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/keymap.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m112 | [0m[35m        """[0m
[30;1m113 | [0m[35m        self._check_contexts(contexts)[0m
[30;1m114 | [0m[35m        for c in contexts:[0m
[30;1m115 | [0m[35m            b = self.get(c, key)[0m
[30;1m116 | [0m[35m            if b:[0m
[30;1m117 | [0m[35m                self.unbind(b)[0m
[30;1m118 | [0m[35m                b.contexts = [x for x in b.contexts if x != c][0m

[31m--[ [0m[34mMatch #[0m[33m293[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/keymap.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m238 | [0m[35m            if hasattr(v, "problem_mark"):[0m
[30;1m239 | [0m[35m                snip = v.problem_mark.get_snippet()[0m
[30;1m240 | [0m[35m                raise KeyBindingError([0m
[30;1m241 | [0m[35m                    "Key binding config error at line %s:\n%s\n%s"[0m
[30;1m242 | [0m[35m                    % (v.problem_mark.line + 1, snip, v.problem)[0m
[30;1m243 | [0m[35m                )[0m
[30;1m244 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m294[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/keymap.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m    def _check_contexts(self, contexts):[0m
[30;1m79 | [0m[35m        if not contexts:[0m
[30;1m80 | [0m[35m            raise ValueError("Must specify at least one context.")[0m
[30;1m81 | [0m[35m        for c in contexts:[0m
[30;1m82 | [0m[35m            if c not in Contexts:[0m
[30;1m83 | [0m[35m                raise ValueError("Unsupported context: %s" % c)[0m

[31m--[ [0m[34mMatch #[0m[33m295[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/searchable.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m70 | [0m[35m            else:[0m
[30;1m71 | [0m[35m                self.set_highlight(None)[0m
[30;1m72 | [0m[35m                return[0m
[30;1m73 | [0m[35m        # Start search at focus + 1[0m
[30;1m74 | [0m[35m        if backwards:[0m
[30;1m75 | [0m[35m            rng = range(len(self.body) - 1, -1, -1)[0m
[30;1m76 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m296[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/dns/types.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35mdef to_str(type: int) -> str:[0m
[30;1m185 | [0m[35m    return _STRINGS.get(type, f"TYPE({type})")[0m

[31m--[ [0m[34mMatch #[0m[33m297[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/http/url.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m152 | [0m[35m        b"http": 80,[0m
[30;1m153 | [0m[35m        "https": 443,[0m
[30;1m154 | [0m[35m        b"https": 443,[0m
[30;1m155 | [0m[35m    }.get(scheme, None)[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35mdef parse_authority(authority: AnyStr, check: bool) -> tuple[str, int | None]:[0m

[31m--[ [0m[34mMatch #[0m[33m298[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/http/url.py[0m
   Pattern: [32m.hostname[0m
[30;1m55 | [0m[35m        raise ValueError("No hostname given")[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    else:[0m
[30;1m58 | [0m[35m        host = parsed.hostname.encode("idna")[0m
[30;1m59 | [0m[35m        if isinstance(parsed, urllib.parse.ParseResult):[0m
[30;1m60 | [0m[35m            parsed = parsed.encode("ascii")[0m
[30;1m61 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m299[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/http/url.py[0m
   Pattern: [32m.hostname[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m    parsed = urllib.parse.urlparse(url)[0m
[30;1m54 | [0m[35m    if not parsed.hostname:[0m
[30;1m55 | [0m[35m        raise ValueError("No hostname given")[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    else:[0m
[30;1m58 | [0m[35m        host = parsed.hostname.encode("idna")[0m

[31m--[ [0m[34mMatch #[0m[33m300[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/http/url.py[0m
   Pattern: [32m.hostname[0m
[30;1m51 | [0m[35m            url = urllib.parse.urlunsplit(url)[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m    parsed = urllib.parse.urlparse(url)[0m
[30;1m54 | [0m[35m    if not parsed.hostname:[0m
[30;1m55 | [0m[35m        raise ValueError("No hostname given")[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m301[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/http/url.py[0m
   Pattern: [32m.hostname[0m
[30;1m21 | [0m[35m    """[0m
[30;1m22 | [0m[35m    URL-parsing function that checks that[0m
[30;1m23 | [0m[35m        - port is an integer 0-65535[0m
[30;1m24 | [0m[35m        - host is a valid IDNA-encoded hostname with no null-bytes[0m
[30;1m25 | [0m[35m        - path is valid ASCII[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    Args:[0m

[31m--[ [0m[34mMatch #[0m[33m302[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/dns/response_codes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35mdef to_str(response_code: int) -> str:[0m
[30;1m50 | [0m[35m    return _STRINGS.get(response_code, f"RCODE({response_code})")[0m

[31m--[ [0m[34mMatch #[0m[33m303[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/dns/response_codes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35mdef http_equiv_status_code(response_code: int) -> int:[0m
[30;1m46 | [0m[35m    return _CODES.get(response_code, 500)[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35mdef to_str(response_code: int) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m304[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/http/cookies.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m326 | [0m[35m    Considering both 'expires' and 'max-age' parameters.[0m
[30;1m327 | [0m[35m[0m
[30;1m328 | [0m[35m    Returns: timestamp of when the cookie will expire.[0m
[30;1m329 | [0m[35m             None, if no expiration time is set.[0m
[30;1m330 | [0m[35m    """[0m
[30;1m331 | [0m[35m    if "expires" in cookie_attrs:[0m
[30;1m332 | [0m[35m        e = email.utils.parsedate_tz(cookie_attrs["expires"])[0m

[31m--[ [0m[34mMatch #[0m[33m305[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/http/cookies.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m321 | [0m[35m[0m
[30;1m322 | [0m[35mdef get_expiration_ts(cookie_attrs):[0m
[30;1m323 | [0m[35m    """[0m
[30;1m324 | [0m[35m    Determines the time when the cookie will be expired.[0m
[30;1m325 | [0m[35m[0m
[30;1m326 | [0m[35m    Considering both 'expires' and 'max-age' parameters.[0m
[30;1m327 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m306[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/http/cookies.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m291 | [0m[35m    """[0m
[30;1m292 | [0m[35m    Args:[0m
[30;1m293 | [0m[35m        c: A Set-Cookie string[0m
[30;1m294 | [0m[35m        delta: Time delta in seconds[0m
[30;1m295 | [0m[35m    Returns:[0m
[30;1m296 | [0m[35m        A refreshed Set-Cookie string[0m
[30;1m297 | [0m[35m    Raises:[0m

[31m--[ [0m[34mMatch #[0m[33m307[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/http/cookies.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m68 | [0m[35m    """[0m
[30;1m69 | [0m[35m    start: offset to the first quote of the string to be read[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m    A sort of loose super-set of the various quoted string specifications.[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m    RFC6265 disallows backslashes or double quotes within quoted strings.[0m
[30;1m74 | [0m[35m    Prior RFCs use backslashes to escape. This leaves us free to apply[0m

[31m--[ [0m[34mMatch #[0m[33m308[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/http/cookies.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport email.utils[0m
[30;1m2 | [0m[35mimport re[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mfrom collections.abc import Iterable[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom mitmproxy.coretypes import multidict[0m
[30;1m7 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m309[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/dns/classes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mdef to_str(class_: int) -> str:[0m
[30;1m11 | [0m[35m    return _STRINGS.get(class_, f"CLASS({class_})")[0m

[31m--[ [0m[34mMatch #[0m[33m310[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contrib/kaitaistruct/vlq_base128_le.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m24 | [0m[35m      top of it for signed ints[0m
[30;1m25 | [0m[35m      https://avro.apache.org/docs/current/spec.html#binary_encode_primitive[0m
[30;1m26 | [0m[35m    [0m
[30;1m27 | [0m[35m    More information on this encoding is available at https://en.wikipedia.org/wiki/LEB128[0m
[30;1m28 | [0m[35m    [0m
[30;1m29 | [0m[35m    This particular implementation supports serialized values to up 8 bytes long.[0m
[30;1m30 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m311[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contrib/kaitaistruct/vlq_base128_le.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m    * Apache Lucene, where it's called "VInt"[0m
[30;1m22 | [0m[35m      https://lucene.apache.org/core/3_5_0/fileformats.html#VInt[0m
[30;1m23 | [0m[35m    * Apache Avro uses this as a basis for integer encoding, adding ZigZag on[0m
[30;1m24 | [0m[35m      top of it for signed ints[0m
[30;1m25 | [0m[35m      https://avro.apache.org/docs/current/spec.html#binary_encode_primitive[0m
[30;1m26 | [0m[35m    [0m
[30;1m27 | [0m[35m    More information on this encoding is available at https://en.wikipedia.org/wiki/LEB128[0m

[31m--[ [0m[34mMatch #[0m[33m312[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contrib/kaitaistruct/png.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m469 | [0m[35m    class TextChunk(KaitaiStruct):[0m
[30;1m470 | [0m[35m        """Text chunk effectively allows to store key-value string pairs in[0m
[30;1m471 | [0m[35m        PNG container. Both "key" (keyword) and "value" (text) parts are[0m
[30;1m472 | [0m[35m        given in pre-defined subset of iso8859-1 without control[0m
[30;1m473 | [0m[35m        characters.[0m
[30;1m474 | [0m[35m        [0m
[30;1m475 | [0m[35m        .. seealso::[0m
[30;1m476 | [0m[35m           Source - https://www.w3.org/TR/PNG/#11tEXt[0m

[31m--[ [0m[34mMatch #[0m[33m313[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contrib/kaitaistruct/png.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m445 | [0m[35m    class InternationalTextChunk(KaitaiStruct):[0m
[30;1m446 | [0m[35m        """International text chunk effectively allows to store key-value string pairs in[0m
[30;1m447 | [0m[35m        PNG container. Both "key" (keyword) and "value" (text) parts are[0m
[30;1m448 | [0m[35m        given in pre-defined subset of iso8859-1 without control[0m
[30;1m449 | [0m[35m        characters.[0m
[30;1m450 | [0m[35m        [0m
[30;1m451 | [0m[35m        .. seealso::[0m
[30;1m452 | [0m[35m           Source - https://www.w3.org/TR/PNG/#11iTXt[0m

[31m--[ [0m[34mMatch #[0m[33m314[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contrib/kaitaistruct/png.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m10 | [0m[35m    raise Exception("Incompatible Kaitai Struct Python API: 0.9 or later is required, but you have %[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mclass Png(KaitaiStruct):[0m
[30;1m13 | [0m[35m    """Test files for APNG can be found at the following locations:[0m
[30;1m14 | [0m[35m    [0m
[30;1m15 | [0m[35m      * <https://philip.html5.org/tests/apng/tests.html>[0m
[30;1m16 | [0m[35m      * <http://littlesvr.ca/apng/>[0m

[31m--[ [0m[34mMatch #[0m[33m315[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contrib/kaitaistruct/png.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m503 | [0m[35m[0m
[30;1m504 | [0m[35m[0m
[30;1m505 | [0m[35m    class TimeChunk(KaitaiStruct):[0m
[30;1m506 | [0m[35m        """Time chunk stores time stamp of last modification of this image,[0m
[30;1m507 | [0m[35m        up to 1 second precision in UTC timezone.[0m
[30;1m508 | [0m[35m        [0m
[30;1m509 | [0m[35m        .. seealso::[0m

[31m--[ [0m[34mMatch #[0m[33m316[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/types.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m476 | [0m[35m    def get(self, t: type | None, default=None) -> _BaseType | None:[0m
[30;1m477 | [0m[35m        if type(t) in self.typemap:[0m
[30;1m478 | [0m[35m            return self.typemap[type(t)][0m
[30;1m479 | [0m[35m        return self.typemap.get(t, default)[0m
[30;1m480 | [0m[35m[0m
[30;1m481 | [0m[35m[0m
[30;1m482 | [0m[35mCommandTypes = TypeManager([0m

[31m--[ [0m[34mMatch #[0m[33m317[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/types.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m215 | [0m[35m[0m
[30;1m216 | [0m[35m[0m
[30;1m217 | [0m[35mclass _CmdType(_BaseType):[0m
[30;1m218 | [0m[35m    typ = Cmd[0m
[30;1m219 | [0m[35m    display = "cmd"[0m
[30;1m220 | [0m[35m[0m
[30;1m221 | [0m[35m    def completion(self, manager: "CommandManager", t: type, s: str) -> Sequence[str]:[0m
[30;1m222 | [0m[35m        return list(manager.commands.keys())[0m

[31m--[ [0m[34mMatch #[0m[33m318[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contrib/wbxml/ASWBXML.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m850 | [0m[35m		if (stringTableLength != 0):[0m
[30;1m851 | [0m[35m			raise InvalidDataException("WBXML data contains a string table.")[0m
[30;1m852 | [0m[35m[0m
[30;1m853 | [0m[35m		# Now we should be at the body of the data.[0m
[30;1m854 | [0m[35m		# Add the declaration[0m
[30;1m855 | [0m[35m		unusedArray = [GlobalTokens.ENTITY, GlobalTokens.EXT_0, GlobalTokens.EXT_1, GlobalTokens.EXT_2, Gl[0m
[30;1m856 | [0m[35m		[0m

[31m--[ [0m[34mMatch #[0m[33m319[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contrib/wbxml/ASWBXML.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m892 | [0m[35m					strTag = "UNKNOWN_TAG_{0,2:X}".format(token)[0m
[30;1m893 | [0m[35m[0m
[30;1m894 | [0m[35m				newNode = self.xmlDoc.createElement(strTag)[0m
[30;1m895 | [0m[35m				# not sure if this should be set on every node or not[0m
[30;1m896 | [0m[35m				#newNode.setAttribute("xmlns", self.codePages[self.currentCodePage].xmlns)[0m
[30;1m897 | [0m[35m				[0m
[30;1m898 | [0m[35m				currentNode.appendChild(newNode)[0m

[31m--[ [0m[34mMatch #[0m[33m320[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/fonts/fontawesome-webfont.svg[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2 | [0m[35m<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd" >[0m
[30;1m3 | [0m[35m<svg>[0m
[30;1m4 | [0m[35m<metadata>[0m
[30;1m5 | [0m[35mCreated by FontForge 20120731 at Mon Oct 24 17:37:40 2016[0m
[30;1m6 | [0m[35m By ,,,[0m
[30;1m7 | [0m[35mCopyright Dave Gandy 2016. All rights reserved.[0m
[30;1m8 | [0m[35m</metadata>[0m

[31m--[ [0m[34mMatch #[0m[33m321[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/browser.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m151 | [0m[35m            'user_pref("browser.bookmarks.restore_default_bookmarks", false);',[0m
[30;1m152 | [0m[35m            'user_pref("browser.bookmarks.file", "");',[0m
[30;1m153 | [0m[35m        ][0m
[30;1m154 | [0m[35m        for service in ("http", "ssl"):[0m
[30;1m155 | [0m[35m            prefs += [[0m
[30;1m156 | [0m[35m                f'user_pref("network.proxy.{service}", "{host}");',[0m
[30;1m157 | [0m[35m                f'user_pref("network.proxy.{service}_port", {port});',[0m

[31m--[ [0m[34mMatch #[0m[33m322[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/browser.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m105 | [0m[35m        Start an isolated instance of Firefox that points to the currently[0m
[30;1m106 | [0m[35m        running proxy.[0m
[30;1m107 | [0m[35m        """[0m
[30;1m108 | [0m[35m        cmd = find_executable_cmd([0m
[30;1m109 | [0m[35m            "/Applications/Firefox.app/Contents/MacOS/firefox",[0m
[30;1m110 | [0m[35m            r"C:\Program Files\Mozilla Firefox\firefox.exe",[0m
[30;1m111 | [0m[35m            "firefox",[0m

[31m--[ [0m[34mMatch #[0m[33m323[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/browser.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m53 | [0m[35m        Start an isolated instance of Chrome that points to the currently[0m
[30;1m54 | [0m[35m        running proxy.[0m
[30;1m55 | [0m[35m        """[0m
[30;1m56 | [0m[35m        cmd = find_executable_cmd([0m
[30;1m57 | [0m[35m            "/Applications/Google Chrome.app/Contents/MacOS/Google Chrome",[0m
[30;1m58 | [0m[35m            # https://stackoverflow.com/questions/40674914/google-chrome-path-in-windows-10[0m
[30;1m59 | [0m[35m            r"C:\Program Files (x86)\Google\Chrome\Application\chrome.exe",[0m

[31m--[ [0m[34mMatch #[0m[33m324[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy-11.1.3.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m109 | [0m[35m``mitmproxy`` is an interactive, SSL/TLS-capable intercepting proxy with a console[0m
[30;1m110 | [0m[35minterface for HTTP/1, HTTP/2, and WebSockets.[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m``mitmdump`` is the command-line version of mitmproxy. Think tcpdump for HTTP.[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m``mitmweb`` is a web-based interface for mitmproxy.[0m
[30;1m115 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m325[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/master.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m83 | [0m[35m            try:[0m
[30;1m84 | [0m[35m                await self.running()[0m
[30;1m85 | [0m[35m                # Any errors in the final part of startup?[0m
[30;1m86 | [0m[35m                if ec := self.addons.get("errorcheck"):[0m
[30;1m87 | [0m[35m                    await ec.shutdown_if_errored()[0m
[30;1m88 | [0m[35m                    ec.finish()[0m
[30;1m89 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m326[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/master.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m                if self.should_exit.is_set():[0m
[30;1m78 | [0m[35m                    return[0m
[30;1m79 | [0m[35m                # Did bringing up servers fail?[0m
[30;1m80 | [0m[35m                if ec := self.addons.get("errorcheck"):[0m
[30;1m81 | [0m[35m                    await ec.shutdown_if_errored()[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m            try:[0m

[31m--[ [0m[34mMatch #[0m[33m327[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/master.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m            # Can we exit before even bringing up servers?[0m
[30;1m62 | [0m[35m            if ec := self.addons.get("errorcheck"):[0m
[30;1m63 | [0m[35m                await ec.shutdown_if_errored()[0m
[30;1m64 | [0m[35m            if ps := self.addons.get("proxyserver"):[0m
[30;1m65 | [0m[35m                # This may block for some proxy modes, so we also monitor should_exit.[0m
[30;1m66 | [0m[35m                await asyncio.wait([0m
[30;1m67 | [0m[35m                    [[0m

[31m--[ [0m[34mMatch #[0m[33m328[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/master.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m            self.should_exit.clear()[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m            # Can we exit before even bringing up servers?[0m
[30;1m62 | [0m[35m            if ec := self.addons.get("errorcheck"):[0m
[30;1m63 | [0m[35m                await ec.shutdown_if_errored()[0m
[30;1m64 | [0m[35m            if ps := self.addons.get("proxyserver"):[0m
[30;1m65 | [0m[35m                # This may block for some proxy modes, so we also monitor should_exit.[0m

[31m--[ [0m[34mMatch #[0m[33m329[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/master.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m42 | [0m[35m        self._legacy_log_events = log.LegacyLogEvents(self)[0m
[30;1m43 | [0m[35m        self._legacy_log_events.install()[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m        # We expect an active event loop here already because some addons[0m
[30;1m46 | [0m[35m        # may want to spawn tasks during the initial configuration phase,[0m
[30;1m47 | [0m[35m        # which happens before run().[0m
[30;1m48 | [0m[35m        self.event_loop = event_loop or asyncio.get_running_loop()[0m

[31m--[ [0m[34mMatch #[0m[33m330[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/upstream_auth.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mimport re[0m
[30;1m3 | [0m[35mfrom typing import Optional[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mfrom mitmproxy import ctx[0m

[31m--[ [0m[34mMatch #[0m[33m331[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/script.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m200 | [0m[35m            # The machinations below are to ensure that:[0m
[30;1m201 | [0m[35m            #   - Scripts remain in the same order[0m
[30;1m202 | [0m[35m            #   - Scripts are not initialized un-necessarily. If only a[0m
[30;1m203 | [0m[35m            #   script's order in the script list has changed, it is just[0m
[30;1m204 | [0m[35m            #   moved.[0m
[30;1m205 | [0m[35m[0m
[30;1m206 | [0m[35m            current = {}[0m

[31m--[ [0m[34mMatch #[0m[33m332[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/script.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m166 | [0m[35m    @command.command("script.run")[0m
[30;1m167 | [0m[35m    def script_run(self, flows: Sequence[flow.Flow], path: mtypes.Path) -> None:[0m
[30;1m168 | [0m[35m        """[0m
[30;1m169 | [0m[35m        Run a script on the specified flows. The script is configured with[0m
[30;1m170 | [0m[35m        the current options and all lifecycle events for each flow are[0m
[30;1m171 | [0m[35m        simulated. Note that the load event is not invoked.[0m
[30;1m172 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m333[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/script.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m166 | [0m[35m    @command.command("script.run")[0m
[30;1m167 | [0m[35m    def script_run(self, flows: Sequence[flow.Flow], path: mtypes.Path) -> None:[0m
[30;1m168 | [0m[35m        """[0m
[30;1m169 | [0m[35m        Run a script on the specified flows. The script is configured with[0m
[30;1m170 | [0m[35m        the current options and all lifecycle events for each flow are[0m
[30;1m171 | [0m[35m        simulated. Note that the load event is not invoked.[0m
[30;1m172 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m334[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/script.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m137 | [0m[35m            try:[0m
[30;1m138 | [0m[35m                mtime = os.stat(self.fullpath).st_mtime[0m
[30;1m139 | [0m[35m            except FileNotFoundError:[0m
[30;1m140 | [0m[35m                logger.info("Removing script %s" % self.path)[0m
[30;1m141 | [0m[35m                scripts = list(ctx.options.scripts)[0m
[30;1m142 | [0m[35m                scripts.remove(self.path)[0m
[30;1m143 | [0m[35m                ctx.options.update(scripts=scripts)[0m

[31m--[ [0m[34mMatch #[0m[33m335[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/script.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m129 | [0m[35m                ctx.master.addons.invoke_addon_sync(self.ns, hooks.RunningHook())[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m    async def watcher(self):[0m
[30;1m132 | [0m[35m        # Script loading is terminally confused at the moment.[0m
[30;1m133 | [0m[35m        # This here is a stopgap workaround to defer loading.[0m
[30;1m134 | [0m[35m        await asyncio.sleep(0)[0m
[30;1m135 | [0m[35m        last_mtime = 0.0[0m

[31m--[ [0m[34mMatch #[0m[33m336[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/script.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m109 | [0m[35m        return [self.ns] if self.ns else [][0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m    def loadscript(self):[0m
[30;1m112 | [0m[35m        logger.info("Loading script %s" % self.path)[0m
[30;1m113 | [0m[35m        if self.ns:[0m
[30;1m114 | [0m[35m            ctx.master.addons.remove(self.ns)[0m
[30;1m115 | [0m[35m        self.ns = None[0m

[31m--[ [0m[34mMatch #[0m[33m337[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/script.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m66 | [0m[35m    tback = addonmanager.cut_traceback([0m
[30;1m67 | [0m[35m        tback, "_call_with_frames_removed"[0m
[30;1m68 | [0m[35m    )  # module execution from importlib[0m
[30;1m69 | [0m[35m    logger.error(f"error in script {path}", exc_info=(type(exc), exc, tback))[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35mReloadInterval = 1[0m

[31m--[ [0m[34mMatch #[0m[33m338[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/script.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35mdef script_error_handler(path: str, exc: Exception) -> None:[0m
[30;1m59 | [0m[35m    """[0m
[30;1m60 | [0m[35m    Log errors during script loading.[0m
[30;1m61 | [0m[35m    """[0m
[30;1m62 | [0m[35m    tback = exc.__traceback__[0m
[30;1m63 | [0m[35m    tback = addonmanager.cut_traceback([0m

[31m--[ [0m[34mMatch #[0m[33m339[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/script.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m24 | [0m[35m    fullname = "__mitmproxy_script__.{}".format([0m
[30;1m25 | [0m[35m        os.path.splitext(os.path.basename(path))[0][0m
[30;1m26 | [0m[35m    )[0m
[30;1m27 | [0m[35m    # the fullname is not unique among scripts, so if there already is an existing script with said[0m
[30;1m28 | [0m[35m    # fullname, remove it.[0m
[30;1m29 | [0m[35m    sys.modules.pop(fullname, None)[0m
[30;1m30 | [0m[35m    oldpath = sys.path[0m

[31m--[ [0m[34mMatch #[0m[33m340[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/script.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m213 | [0m[35m                if s in current:[0m
[30;1m214 | [0m[35m                    ordered.append(current[s])[0m
[30;1m215 | [0m[35m                else:[0m
[30;1m216 | [0m[35m                    sc = Script(s, True)[0m
[30;1m217 | [0m[35m                    ordered.append(sc)[0m
[30;1m218 | [0m[35m                    newscripts.append(sc)[0m
[30;1m219 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m341[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/script.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m129 | [0m[35m                ctx.master.addons.invoke_addon_sync(self.ns, hooks.RunningHook())[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m    async def watcher(self):[0m
[30;1m132 | [0m[35m        # Script loading is terminally confused at the moment.[0m
[30;1m133 | [0m[35m        # This here is a stopgap workaround to defer loading.[0m
[30;1m134 | [0m[35m        await asyncio.sleep(0)[0m
[30;1m135 | [0m[35m        last_mtime = 0.0[0m

[31m--[ [0m[34mMatch #[0m[33m342[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/command.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m305 | [0m[35m    """[0m
[30;1m306 | [0m[35m    Convert a string to a argument to the appropriate type.[0m
[30;1m307 | [0m[35m    """[0m
[30;1m308 | [0m[35m    t = mitmproxy.types.CommandTypes.get(argtype, None)[0m
[30;1m309 | [0m[35m    if not t:[0m
[30;1m310 | [0m[35m        raise exceptions.CommandError(f"Unsupported argument type: {argtype}")[0m
[30;1m311 | [0m[35m    try:[0m

[31m--[ [0m[34mMatch #[0m[33m343[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/command.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m242 | [0m[35m            if arg_is_unknown_command and command_args_following:[0m
[30;1m243 | [0m[35m                next_params.pop(0)[0m
[30;1m244 | [0m[35m[0m
[30;1m245 | [0m[35m            to = mitmproxy.types.CommandTypes.get(expected.type, None)[0m
[30;1m246 | [0m[35m            valid = False[0m
[30;1m247 | [0m[35m            if to:[0m
[30;1m248 | [0m[35m                try:[0m

[31m--[ [0m[34mMatch #[0m[33m344[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/command.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m149 | [0m[35m        ret = self.func(*bound_args.args, **bound_args.kwargs)[0m
[30;1m150 | [0m[35m        if ret is None and self.return_type is None:[0m
[30;1m151 | [0m[35m            return[0m
[30;1m152 | [0m[35m        typ = mitmproxy.types.CommandTypes.get(self.return_type)[0m
[30;1m153 | [0m[35m        assert typ[0m
[30;1m154 | [0m[35m        if not typ.is_valid(self.manager, typ, ret):[0m
[30;1m155 | [0m[35m            raise exceptions.CommandError([0m

[31m--[ [0m[34mMatch #[0m[33m345[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/command.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m87 | [0m[35m                raise exceptions.CommandError([0m
[30;1m88 | [0m[35m                    f"Argument {name} has an unknown type {t} in {func}."[0m
[30;1m89 | [0m[35m                )[0m
[30;1m90 | [0m[35m        if self.return_type and not mitmproxy.types.CommandTypes.get([0m
[30;1m91 | [0m[35m            self.return_type, None[0m
[30;1m92 | [0m[35m        ):[0m
[30;1m93 | [0m[35m            raise exceptions.CommandError([0m

[31m--[ [0m[34mMatch #[0m[33m346[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/command.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m83 | [0m[35m        # This fails with a CommandException if types are invalid[0m
[30;1m84 | [0m[35m        for name, parameter in self.signature.parameters.items():[0m
[30;1m85 | [0m[35m            t = parameter.annotation[0m
[30;1m86 | [0m[35m            if not mitmproxy.types.CommandTypes.get(parameter.annotation, None):[0m
[30;1m87 | [0m[35m                raise exceptions.CommandError([0m
[30;1m88 | [0m[35m                    f"Argument {name} has an unknown type {t} in {func}."[0m
[30;1m89 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m347[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/command.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m36 | [0m[35m    """[0m
[30;1m37 | [0m[35m    if t == inspect._empty:  # type: ignore[0m
[30;1m38 | [0m[35m        raise exceptions.CommandError("missing type annotation")[0m
[30;1m39 | [0m[35m    to = mitmproxy.types.CommandTypes.get(t, None)[0m
[30;1m40 | [0m[35m    if not to:[0m
[30;1m41 | [0m[35m        raise exceptions.CommandError([0m
[30;1m42 | [0m[35m            "unsupported type: %s" % getattr(t, "__name__", t)[0m

[31m--[ [0m[34mMatch #[0m[33m348[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/command.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m329 | [0m[35m[0m
[30;1m330 | [0m[35mdef argument(name, type):[0m
[30;1m331 | [0m[35m    """[0m
[30;1m332 | [0m[35m    Set the type of a command argument at runtime. This is useful for more[0m
[30;1m333 | [0m[35m    specific types such as mitmproxy.types.Choice, which we cannot annotate[0m
[30;1m334 | [0m[35m    directly as mypy does not like that.[0m
[30;1m335 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m349[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/command.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m142 | [0m[35m[0m
[30;1m143 | [0m[35m    def call(self, args: Sequence[str]) -> Any:[0m
[30;1m144 | [0m[35m        """[0m
[30;1m145 | [0m[35m        Call the command with a list of arguments. At this point, all[0m
[30;1m146 | [0m[35m        arguments are strings.[0m
[30;1m147 | [0m[35m        """[0m
[30;1m148 | [0m[35m        bound_args = self.prepare_args(args)[0m

[31m--[ [0m[34mMatch #[0m[33m350[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addonmanager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m153 | [0m[35m        attribute on the instance, or the lower case class name if that[0m
[30;1m154 | [0m[35m        does not exist.[0m
[30;1m155 | [0m[35m        """[0m
[30;1m156 | [0m[35m        return self.lookup.get(name, None)[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m    def register(self, addon):[0m
[30;1m159 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m351[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addonmanager.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35mdef cut_traceback(tb, func_name):[0m
[30;1m25 | [0m[35m    """[0m
[30;1m26 | [0m[35m    Cut off a traceback at the function with the given name.[0m
[30;1m27 | [0m[35m    The func_name's frame is excluded.[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    Args:[0m

[31m--[ [0m[34mMatch #[0m[33m352[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addonmanager.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35mdef cut_traceback(tb, func_name):[0m
[30;1m25 | [0m[35m    """[0m
[30;1m26 | [0m[35m    Cut off a traceback at the function with the given name.[0m
[30;1m27 | [0m[35m    The func_name's frame is excluded.[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    Args:[0m

[31m--[ [0m[34mMatch #[0m[33m353[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/connection.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m315 | [0m[35m                is ConnectionState.OPEN[0m
[30;1m316 | [0m[35m            )[0m
[30;1m317 | [0m[35m            # assigning the current value is okay, that may be an artifact of calling .set_state().[0m
[30;1m318 | [0m[35m            attr_changed = self.__dict__.get(name) != value[0m
[30;1m319 | [0m[35m            if connection_open and attr_changed:[0m
[30;1m320 | [0m[35m                raise RuntimeError(f"Cannot change server.{name} on open connection.")[0m
[30;1m321 | [0m[35m        return super().__setattr__(name, value)[0m

[31m--[ [0m[34mMatch #[0m[33m354[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/connection.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m311 | [0m[35m    def __setattr__(self, name, value):[0m
[30;1m312 | [0m[35m        if name in ("address", "via"):[0m
[30;1m313 | [0m[35m            connection_open = ([0m
[30;1m314 | [0m[35m                self.__dict__.get("state", ConnectionState.CLOSED)[0m
[30;1m315 | [0m[35m                is ConnectionState.OPEN[0m
[30;1m316 | [0m[35m            )[0m
[30;1m317 | [0m[35m            # assigning the current value is okay, that may be an artifact of calling .set_state().[0m

[31m--[ [0m[34mMatch #[0m[33m355[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/connection.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m# practically speaking we may have IPv6 addresses with flowinfo and scope_id,[0m
[30;1m44 | [0m[35m# but type checking isn't good enough to properly handle tuple unions.[0m
[30;1m45 | [0m[35m# this version at least provides useful type checking messages.[0m
[30;1m46 | [0m[35mAddress = tuple[str, int][0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m356[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/connection.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m285 | [0m[35m    """[0m
[30;1m286 | [0m[35m    *Timestamp:* Connection establishment started.[0m
[30;1m287 | [0m[35m[0m
[30;1m288 | [0m[35m    For IP addresses, this corresponds to sending a TCP SYN; for domains, this corresponds to starti[0m
[30;1m289 | [0m[35m    """[0m
[30;1m290 | [0m[35m    timestamp_tcp_setup: float | None = None[0m
[30;1m291 | [0m[35m    """*Timestamp:* TCP ACK received."""[0m

[31m--[ [0m[34mMatch #[0m[33m357[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/connection.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m271 | [0m[35m    Which of those two will be present depends on the proxy mode and the client.[0m
[30;1m272 | [0m[35m    For explicit proxies, this value will reflect what the client instructs mitmproxy to connect to.[0m
[30;1m273 | [0m[35m    For example, if the client starts off a connection with `CONNECT example.com HTTP/1.1`, it will [0m
[30;1m274 | [0m[35m    For transparent proxies such as WireGuard mode, this value will be an IP address.[0m
[30;1m275 | [0m[35m    """[0m
[30;1m276 | [0m[35m[0m
[30;1m277 | [0m[35m    peername: Address | None = None[0m

[31m--[ [0m[34mMatch #[0m[33m358[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/connection.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m267 | [0m[35m    """[0m
[30;1m268 | [0m[35m    The server's `(host, port)` address tuple.[0m
[30;1m269 | [0m[35m[0m
[30;1m270 | [0m[35m    The host can either be a domain or a plain IP address.[0m
[30;1m271 | [0m[35m    Which of those two will be present depends on the proxy mode and the client.[0m
[30;1m272 | [0m[35m    For explicit proxies, this value will reflect what the client instructs mitmproxy to connect to.[0m
[30;1m273 | [0m[35m    For example, if the client starts off a connection with `CONNECT example.com HTTP/1.1`, it will [0m

[31m--[ [0m[34mMatch #[0m[33m359[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/connection.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport dataclasses[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35mimport uuid[0m
[30;1m4 | [0m[35mimport warnings[0m
[30;1m5 | [0m[35mfrom abc import ABCMeta[0m
[30;1m6 | [0m[35mfrom collections.abc import Sequence[0m

[31m--[ [0m[34mMatch #[0m[33m360[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/options.py[0m
   Pattern: [32m.hostname[0m
[30;1m87 | [0m[35m            transparent mode, it is recommended to use an IP address (range),[0m
[30;1m88 | [0m[35m            not the hostname. In regular mode, only SSL traffic is ignored and[0m
[30;1m89 | [0m[35m            the hostname should be used. The supplied value is interpreted as a[0m
[30;1m90 | [0m[35m            regular expression and matched on the ip or the hostname.[0m
[30;1m91 | [0m[35m            """,[0m
[30;1m92 | [0m[35m        )[0m
[30;1m93 | [0m[35m        self.add_option("allow_hosts", Sequence[str], [], "Opposite of --ignore-hosts.")[0m

[31m--[ [0m[34mMatch #[0m[33m361[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/options.py[0m
   Pattern: [32m.hostname[0m
[30;1m86 | [0m[35m            Ignore host and forward all traffic without processing it. In[0m
[30;1m87 | [0m[35m            transparent mode, it is recommended to use an IP address (range),[0m
[30;1m88 | [0m[35m            not the hostname. In regular mode, only SSL traffic is ignored and[0m
[30;1m89 | [0m[35m            the hostname should be used. The supplied value is interpreted as a[0m
[30;1m90 | [0m[35m            regular expression and matched on the ip or the hostname.[0m
[30;1m91 | [0m[35m            """,[0m
[30;1m92 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m362[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/options.py[0m
   Pattern: [32m.hostname[0m
[30;1m85 | [0m[35m            """[0m
[30;1m86 | [0m[35m            Ignore host and forward all traffic without processing it. In[0m
[30;1m87 | [0m[35m            transparent mode, it is recommended to use an IP address (range),[0m
[30;1m88 | [0m[35m            not the hostname. In regular mode, only SSL traffic is ignored and[0m
[30;1m89 | [0m[35m            the hostname should be used. The supplied value is interpreted as a[0m
[30;1m90 | [0m[35m            regular expression and matched on the ip or the hostname.[0m
[30;1m91 | [0m[35m            """,[0m

[31m--[ [0m[34mMatch #[0m[33m363[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/options.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m57 | [0m[35m            [],[0m
[30;1m58 | [0m[35m            """[0m
[30;1m59 | [0m[35m            SSL certificates of the form "[domain=]path". The domain may include[0m
[30;1m60 | [0m[35m            a wildcard, and is equal to "*" if not specified. The file at path[0m
[30;1m61 | [0m[35m            is a certificate in PEM format. If a private key is included in the[0m
[30;1m62 | [0m[35m            PEM, it is used, else the default key in the conf dir is used. The[0m
[30;1m63 | [0m[35m            PEM file should contain the full certificate chain, with the leaf[0m

[31m--[ [0m[34mMatch #[0m[33m364[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/options.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m87 | [0m[35m            transparent mode, it is recommended to use an IP address (range),[0m
[30;1m88 | [0m[35m            not the hostname. In regular mode, only SSL traffic is ignored and[0m
[30;1m89 | [0m[35m            the hostname should be used. The supplied value is interpreted as a[0m
[30;1m90 | [0m[35m            regular expression and matched on the ip or the hostname.[0m
[30;1m91 | [0m[35m            """,[0m
[30;1m92 | [0m[35m        )[0m
[30;1m93 | [0m[35m        self.add_option("allow_hosts", Sequence[str], [], "Opposite of --ignore-hosts.")[0m

[31m--[ [0m[34mMatch #[0m[33m365[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/options.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m84 | [0m[35m            [],[0m
[30;1m85 | [0m[35m            """[0m
[30;1m86 | [0m[35m            Ignore host and forward all traffic without processing it. In[0m
[30;1m87 | [0m[35m            transparent mode, it is recommended to use an IP address (range),[0m
[30;1m88 | [0m[35m            not the hostname. In regular mode, only SSL traffic is ignored and[0m
[30;1m89 | [0m[35m            the hostname should be used. The supplied value is interpreted as a[0m
[30;1m90 | [0m[35m            regular expression and matched on the ip or the hostname.[0m

[31m--[ [0m[34mMatch #[0m[33m366[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/mode_servers.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m150 | [0m[35m            self.last_exception = None[0m
[30;1m151 | [0m[35m        if listen_addrs:[0m
[30;1m152 | [0m[35m            addrs = " and ".join({human.format_address(a) for a in listen_addrs})[0m
[30;1m153 | [0m[35m            logger.info(f"{self.mode.description} at {addrs} stopped.")[0m
[30;1m154 | [0m[35m        else:[0m
[30;1m155 | [0m[35m            logger.info(f"{self.mode.description} stopped.")[0m
[30;1m156 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m367[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/mode_servers.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m135 | [0m[35m            self.last_exception = None[0m
[30;1m136 | [0m[35m        if self.listen_addrs:[0m
[30;1m137 | [0m[35m            addrs = " and ".join({human.format_address(a) for a in self.listen_addrs})[0m
[30;1m138 | [0m[35m            logger.info(f"{self.mode.description} listening at {addrs}.")[0m
[30;1m139 | [0m[35m        else:[0m
[30;1m140 | [0m[35m            logger.info(f"{self.mode.description} started.")[0m
[30;1m141 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m368[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35mfrom mitmproxy.addons import proxyserver[0m
[30;1m22 | [0m[35mfrom mitmproxy.addons import save[0m
[30;1m23 | [0m[35mfrom mitmproxy.addons import savehar[0m
[30;1m24 | [0m[35mfrom mitmproxy.addons import script[0m
[30;1m25 | [0m[35mfrom mitmproxy.addons import serverplayback[0m
[30;1m26 | [0m[35mfrom mitmproxy.addons import stickyauth[0m
[30;1m27 | [0m[35mfrom mitmproxy.addons import stickycookie[0m
[30;1m28 | [0m[35mfrom mitmproxy.addons import strip_dns_https_records[0m

[31m--[ [0m[34mMatch #[0m[33m369[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mfrom mitmproxy.addons import command_history[0m
[30;1m8 | [0m[35mfrom mitmproxy.addons import comment[0m
[30;1m9 | [0m[35mfrom mitmproxy.addons import core[0m
[30;1m10 | [0m[35mfrom mitmproxy.addons import cut[0m
[30;1m11 | [0m[35mfrom mitmproxy.addons import disable_h2c[0m
[30;1m12 | [0m[35mfrom mitmproxy.addons import dns_resolver[0m
[30;1m13 | [0m[35mfrom mitmproxy.addons import export[0m
[30;1m14 | [0m[35mfrom mitmproxy.addons import maplocal[0m

[31m--[ [0m[34mMatch #[0m[33m370[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/events.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m        return super().__new__(cls)[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m    def __init_subclass__(cls, **kwargs):[0m
[30;1m80 | [0m[35m        command_cls = typing.get_type_hints(cls).get("command", None)[0m
[30;1m81 | [0m[35m        valid_command_subclass = ([0m
[30;1m82 | [0m[35m            isinstance(command_cls, type)[0m
[30;1m83 | [0m[35m            and issubclass(command_cls, commands.Command)[0m

[31m--[ [0m[34mMatch #[0m[33m371[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/events.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m"""[0m
[30;1m2 | [0m[35mWhen IO actions occur at the proxy server, they are passed down to layers as events.[0m
[30;1m3 | [0m[35mEvents represent the only way for layers to receive new data from sockets.[0m
[30;1m4 | [0m[35mThe counterpart to events are commands.[0m
[30;1m5 | [0m[35m"""[0m

[31m--[ [0m[34mMatch #[0m[33m372[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_events.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m10 | [0m[35m    request: http.Request[0m
[30;1m11 | [0m[35m    end_stream: bool[0m
[30;1m12 | [0m[35m    """[0m
[30;1m13 | [0m[35m    If True, we already know at this point that there is no message body. This is useful for HTTP/2,[0m
[30;1m14 | [0m[35m    us to set END_STREAM on headers already (and some servers - Akamai - implicitly expect that).[0m
[30;1m15 | [0m[35m    In either case, this event will nonetheless be followed by RequestEndOfMessage.[0m
[30;1m16 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m373[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_events.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35m    end_stream: bool[0m
[30;1m12 | [0m[35m    """[0m
[30;1m13 | [0m[35m    If True, we already know at this point that there is no message body. This is useful for HTTP/2,[0m
[30;1m14 | [0m[35m    us to set END_STREAM on headers already (and some servers - Akamai - implicitly expect that).[0m
[30;1m15 | [0m[35m    In either case, this event will nonetheless be followed by RequestEndOfMessage.[0m
[30;1m16 | [0m[35m    """[0m
[30;1m17 | [0m[35m    replay_flow: HTTPFlow | None = None[0m

[31m--[ [0m[34mMatch #[0m[33m374[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/command_history.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m    @command.command("commands.history.filter")[0m
[30;1m83 | [0m[35m    def set_filter(self, prefix: str) -> None:[0m
[30;1m84 | [0m[35m        self.filtered_history = [cmd for cmd in self.history if cmd.startswith(prefix)][0m
[30;1m85 | [0m[35m        self.filtered_history.append(prefix)[0m
[30;1m86 | [0m[35m        self.current_index = len(self.filtered_history) - 1[0m
[30;1m87 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m375[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_http1.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m380 | [0m[35m                yield commands.SendData(self.conn, raw)[0m
[30;1m381 | [0m[35m        elif isinstance(event, RequestEndOfMessage):[0m
[30;1m382 | [0m[35m            assert self.request[0m
[30;1m383 | [0m[35m            if "chunked" in self.request.headers.get("transfer-encoding", "").lower():[0m
[30;1m384 | [0m[35m                yield commands.SendData(self.conn, b"0\r\n\r\n")[0m
[30;1m385 | [0m[35m            elif http1.expected_http_body_size(self.request, self.response) == -1:[0m
[30;1m386 | [0m[35m                yield commands.CloseTcpConnection(self.conn, half_close=True)[0m

[31m--[ [0m[34mMatch #[0m[33m376[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_http1.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m372 | [0m[35m            yield commands.SendData(self.conn, raw)[0m
[30;1m373 | [0m[35m        elif isinstance(event, RequestData):[0m
[30;1m374 | [0m[35m            assert self.request[0m
[30;1m375 | [0m[35m            if "chunked" in self.request.headers.get("transfer-encoding", "").lower():[0m
[30;1m376 | [0m[35m                raw = b"%x\r\n%s\r\n" % (len(event.data), event.data)[0m
[30;1m377 | [0m[35m            else:[0m
[30;1m378 | [0m[35m                raw = event.data[0m

[31m--[ [0m[34mMatch #[0m[33m377[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_http1.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m259 | [0m[35m            if ([0m
[30;1m260 | [0m[35m                self.request.method.upper() != "HEAD"[0m
[30;1m261 | [0m[35m                and "chunked"[0m
[30;1m262 | [0m[35m                in self.response.headers.get("transfer-encoding", "").lower()[0m
[30;1m263 | [0m[35m            ):[0m
[30;1m264 | [0m[35m                yield commands.SendData(self.conn, b"0\r\n\r\n")[0m
[30;1m265 | [0m[35m            yield from self.mark_done(response=True)[0m

[31m--[ [0m[34mMatch #[0m[33m378[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_http1.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m247 | [0m[35m            yield commands.SendData(self.conn, raw)[0m
[30;1m248 | [0m[35m        elif isinstance(event, ResponseData):[0m
[30;1m249 | [0m[35m            assert self.response[0m
[30;1m250 | [0m[35m            if "chunked" in self.response.headers.get("transfer-encoding", "").lower():[0m
[30;1m251 | [0m[35m                raw = b"%x\r\n%s\r\n" % (len(event.data), event.data)[0m
[30;1m252 | [0m[35m            else:[0m
[30;1m253 | [0m[35m                raw = event.data[0m

[31m--[ [0m[34mMatch #[0m[33m379[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_http1.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m239 | [0m[35m                # Convert to an HTTP/1 response.[0m
[30;1m240 | [0m[35m                response.http_version = "HTTP/1.1"[0m
[30;1m241 | [0m[35m                # not everyone supports empty reason phrases, so we better make up one.[0m
[30;1m242 | [0m[35m                response.reason = status_codes.RESPONSES.get(response.status_code, "")[0m
[30;1m243 | [0m[35m                # Shall we set a Content-Length header here if there is none?[0m
[30;1m244 | [0m[35m                # For now, let's try to modify as little as possible.[0m
[30;1m245 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m380[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_http1.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m128 | [0m[35m        if isinstance(event, events.DataReceived):[0m
[30;1m129 | [0m[35m            return[0m
[30;1m130 | [0m[35m        elif isinstance(event, events.ConnectionClosed):[0m
[30;1m131 | [0m[35m            # for practical purposes, we assume that a peer which sent at least a FIN[0m
[30;1m132 | [0m[35m            # is not interested in any more data from us, see[0m
[30;1m133 | [0m[35m            # see https://github.com/httpwg/http-core/issues/22[0m
[30;1m134 | [0m[35m            if event.connection.state is not ConnectionState.CLOSED:[0m

[31m--[ [0m[34mMatch #[0m[33m381[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_http1.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35mfrom mitmproxy.proxy import layer[0m
[30;1m32 | [0m[35mfrom mitmproxy.proxy.layers.http._base import ReceiveHttp[0m
[30;1m33 | [0m[35mfrom mitmproxy.proxy.layers.http._base import StreamId[0m
[30;1m34 | [0m[35mfrom mitmproxy.proxy.utils import expect[0m
[30;1m35 | [0m[35mfrom mitmproxy.utils import human[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35mTBodyReader = Union[ChunkedReader, Http10Reader, ContentLengthReader][0m
[30;1m38 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m382[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_http_h2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m104 | [0m[35m                self.stream_buffers[stream_id].append(SendH2Data(data, end_stream))[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m    def send_trailers(self, stream_id: int, trailers: list[tuple[bytes, bytes]]):[0m
[30;1m107 | [0m[35m        if self.stream_buffers.get(stream_id, None):[0m
[30;1m108 | [0m[35m            # Though trailers are not subject to flow control, we need to queue them and send strict[0m
[30;1m109 | [0m[35m            self.stream_trailers[stream_id] = trailers[0m
[30;1m110 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m383[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_http_h2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m            return[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m        if self.stream_buffers.get(stream_id, None):[0m
[30;1m92 | [0m[35m            # We already have some data buffered, let's append.[0m
[30;1m93 | [0m[35m            self.stream_buffers[stream_id].append(SendH2Data(data, end_stream))[0m
[30;1m94 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m384[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tcp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom mitmproxy import connection[0m
[30;1m4 | [0m[35mfrom mitmproxy import flow[0m
[30;1m5 | [0m[35mfrom mitmproxy.coretypes import serializable[0m

[31m--[ [0m[34mMatch #[0m[33m385[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_http3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m248 | [0m[35m        # to support H2<->H3, we need to translate IDs.[0m
[30;1m249 | [0m[35m        # NOTE: We always create bidirectional streams, as we can't safely infer unidirectionality.[0m
[30;1m250 | [0m[35m        if isinstance(event, HttpEvent):[0m
[30;1m251 | [0m[35m            ours = self.our_stream_id.get(event.stream_id, None)[0m
[30;1m252 | [0m[35m            if ours is None:[0m
[30;1m253 | [0m[35m                ours = self.h3_conn.get_next_available_stream_id()[0m
[30;1m254 | [0m[35m                self.our_stream_id[event.stream_id] = ours[0m

[31m--[ [0m[34mMatch #[0m[33m386[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_http3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m212 | [0m[35m            path,[0m
[30;1m213 | [0m[35m            headers,[0m
[30;1m214 | [0m[35m        ) = parse_h2_request_headers(event.headers)[0m
[30;1m215 | [0m[35m        request = http.Request([0m
[30;1m216 | [0m[35m            host=host,[0m
[30;1m217 | [0m[35m            port=port,[0m
[30;1m218 | [0m[35m            method=method,[0m

[31m--[ [0m[34mMatch #[0m[33m387[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_http3.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m258 | [0m[35m        for cmd in super()._handle_event(event):[0m
[30;1m259 | [0m[35m            if isinstance(cmd, ReceiveHttp):[0m
[30;1m260 | [0m[35m                cmd.event.stream_id = self.their_stream_id[cmd.event.stream_id][0m
[30;1m261 | [0m[35m            yield cmd[0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m    def parse_headers(self, event: HeadersReceived) -> RequestHeaders | ResponseHeaders:[0m
[30;1m264 | [0m[35m        # same as HTTP/2[0m
[30;1m265 | [0m[35m        status_code, headers = parse_h2_response_headers(event.headers)[0m

[31m--[ [0m[34mMatch #[0m[33m388[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_http3.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m255 | [0m[35m                self.their_stream_id[ours] = event.stream_id[0m
[30;1m256 | [0m[35m            event.stream_id = ours[0m
[30;1m257 | [0m[35m[0m
[30;1m258 | [0m[35m        for cmd in super()._handle_event(event):[0m
[30;1m259 | [0m[35m            if isinstance(cmd, ReceiveHttp):[0m
[30;1m260 | [0m[35m                cmd.event.stream_id = self.their_stream_id[cmd.event.stream_id][0m
[30;1m261 | [0m[35m            yield cmd[0m

[31m--[ [0m[34mMatch #[0m[33m389[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_http3.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35mfrom mitmproxy.proxy.layers.quic import error_code_to_str[0m
[30;1m40 | [0m[35mfrom mitmproxy.proxy.layers.quic import QuicConnectionClosed[0m
[30;1m41 | [0m[35mfrom mitmproxy.proxy.layers.quic import QuicStreamEvent[0m
[30;1m42 | [0m[35mfrom mitmproxy.proxy.utils import expect[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35mclass Http3Connection(HttpConnection):[0m
[30;1m46 | [0m[35m    h3_conn: LayeredH3Connection[0m

[31m--[ [0m[34mMatch #[0m[33m390[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_http3.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35mfrom abc import abstractmethod[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mfrom aioquic.h3.connection import ErrorCode as H3ErrorCode[0m
[30;1m5 | [0m[35mfrom aioquic.h3.connection import FrameUnexpected as H3FrameUnexpected[0m

[31m--[ [0m[34mMatch #[0m[33m391[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contentviews/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m129 | [0m[35m    http_message = None[0m
[30;1m130 | [0m[35m    if isinstance(message, http.Message):[0m
[30;1m131 | [0m[35m        http_message = message[0m
[30;1m132 | [0m[35m        if ctype := message.headers.get("content-type"):[0m
[30;1m133 | [0m[35m            if ct := http.parse_content_type(ctype):[0m
[30;1m134 | [0m[35m                content_type = f"{ct[0]}/{ct[1]}"[0m
[30;1m135 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m392[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contentviews/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m        enc = "[cannot decode]"[0m
[30;1m119 | [0m[35m    else:[0m
[30;1m120 | [0m[35m        if isinstance(message, http.Message) and content != message.raw_content:[0m
[30;1m121 | [0m[35m            enc = "[decoded {}]".format(message.headers.get("content-encoding"))[0m
[30;1m122 | [0m[35m        else:[0m
[30;1m123 | [0m[35m            enc = ""[0m
[30;1m124 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m393[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35mdef format_error(status_code: int, message: str) -> bytes:[0m
[30;1m44 | [0m[35m    reason = http.status_codes.RESPONSES.get(status_code, "Unknown")[0m
[30;1m45 | [0m[35m    return ([0m
[30;1m46 | [0m[35m        textwrap.dedent([0m
[30;1m47 | [0m[35m            f"""[0m

[31m--[ [0m[34mMatch #[0m[33m394[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/coretypes/multidict.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m    def insert(self, index: int, key: KT, value: VT) -> None:[0m
[30;1m111 | [0m[35m        """[0m
[30;1m112 | [0m[35m        Insert an additional value for the given key at the specified position.[0m
[30;1m113 | [0m[35m        """[0m
[30;1m114 | [0m[35m        item = (key, value)[0m
[30;1m115 | [0m[35m        self.fields = self.fields[:index] + (item,) + self.fields[index:][0m

[31m--[ [0m[34mMatch #[0m[33m395[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/coretypes/multidict.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m    def add(self, key: KT, value: VT) -> None:[0m
[30;1m105 | [0m[35m        """[0m
[30;1m106 | [0m[35m        Add an additional value for the given key at the bottom.[0m
[30;1m107 | [0m[35m        """[0m
[30;1m108 | [0m[35m        self.insert(len(self.fields), key, value)[0m
[30;1m109 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m396[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/export.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m52 | [0m[35m        # see https://github.com/python/cpython/pull/10871[0m
[30;1m53 | [0m[35m        raise exceptions.CommandError("Request content must be valid unicode")[0m
[30;1m54 | [0m[35m    escape_control_chars = {chr(i): f"\\x{i:02x}" for i in range(32)}[0m
[30;1m55 | [0m[35m    escaped_text = "".join(escape_control_chars.get(x, x) for x in text)[0m
[30;1m56 | [0m[35m    if any(char in escape_control_chars for char in text):[0m
[30;1m57 | [0m[35m        # Escaped chars need to be unescaped by the shell to be properly inperpreted by curl and htt[0m
[30;1m58 | [0m[35m        return f'"$(printf {shlex.quote(escaped_text)})"'[0m

[31m--[ [0m[34mMatch #[0m[33m397[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/export.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m29 | [0m[35m    request.headers.pop("content-length")[0m
[30;1m30 | [0m[35m    if request.headers.get("host", "") == request.host:[0m
[30;1m31 | [0m[35m        request.headers.pop("host")[0m
[30;1m32 | [0m[35m    if request.headers.get(":authority", "") == request.host:[0m
[30;1m33 | [0m[35m        request.headers.pop(":authority")[0m
[30;1m34 | [0m[35m    return request[0m
[30;1m35 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m398[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/export.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35mdef pop_headers(request: http.Request) -> http.Request:[0m
[30;1m28 | [0m[35m    # Remove some headers that are redundant for curl/httpie export[0m
[30;1m29 | [0m[35m    request.headers.pop("content-length")[0m
[30;1m30 | [0m[35m    if request.headers.get("host", "") == request.host:[0m
[30;1m31 | [0m[35m        request.headers.pop("host")[0m
[30;1m32 | [0m[35m    if request.headers.get(":authority", "") == request.host:[0m
[30;1m33 | [0m[35m        request.headers.pop(":authority")[0m

[31m--[ [0m[34mMatch #[0m[33m399[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/export.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m108 | [0m[35m    cmd = " ".join(shlex.quote(arg) for arg in args)[0m
[30;1m109 | [0m[35m    if request.content:[0m
[30;1m110 | [0m[35m        cmd += " <<< " + request_content_for_console(request)[0m
[30;1m111 | [0m[35m    return cmd[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35mdef raw_request(f: flow.Flow) -> bytes:[0m
[30;1m115 | [0m[35m    request = cleanup_request(f)[0m

[31m--[ [0m[34mMatch #[0m[33m400[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/export.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m107 | [0m[35m        args.append(f"{k}: {v}")[0m
[30;1m108 | [0m[35m    cmd = " ".join(shlex.quote(arg) for arg in args)[0m
[30;1m109 | [0m[35m    if request.content:[0m
[30;1m110 | [0m[35m        cmd += " <<< " + request_content_for_console(request)[0m
[30;1m111 | [0m[35m    return cmd[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m401[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/export.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m105 | [0m[35m    args = ["http", request.method, url][0m
[30;1m106 | [0m[35m    for k, v in request.headers.items(multi=True):[0m
[30;1m107 | [0m[35m        args.append(f"{k}: {v}")[0m
[30;1m108 | [0m[35m    cmd = " ".join(shlex.quote(arg) for arg in args)[0m
[30;1m109 | [0m[35m    if request.content:[0m
[30;1m110 | [0m[35m        cmd += " <<< " + request_content_for_console(request)[0m
[30;1m111 | [0m[35m    return cmd[0m

[31m--[ [0m[34mMatch #[0m[33m402[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/export.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m169 | [0m[35m            connect to the same IP as in the original request. This helps with[0m
[30;1m170 | [0m[35m            reproducibility in cases where the behaviour depends on the[0m
[30;1m171 | [0m[35m            particular host we are connecting to. Currently this only affects[0m
[30;1m172 | [0m[35m            curl exports.[0m
[30;1m173 | [0m[35m            """,[0m
[30;1m174 | [0m[35m        )[0m
[30;1m175 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m403[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/export.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m166 | [0m[35m            False,[0m
[30;1m167 | [0m[35m            """[0m
[30;1m168 | [0m[35m            When exporting a request as an external command, make an effort to[0m
[30;1m169 | [0m[35m            connect to the same IP as in the original request. This helps with[0m
[30;1m170 | [0m[35m            reproducibility in cases where the behaviour depends on the[0m
[30;1m171 | [0m[35m            particular host we are connecting to. Currently this only affects[0m
[30;1m172 | [0m[35m            curl exports.[0m

[31m--[ [0m[34mMatch #[0m[33m404[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/export.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m98 | [0m[35m    request = pop_headers(request)[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m    # TODO: Once https://github.com/httpie/httpie/issues/414 is implemented, we[0m
[30;1m101 | [0m[35m    # should ensure we always connect to the IP address specified in the flow,[0m
[30;1m102 | [0m[35m    # similar to how it's done in curl_command.[0m
[30;1m103 | [0m[35m    url = request.pretty_url[0m
[30;1m104 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m405[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/export.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35m    escape_control_chars = {chr(i): f"\\x{i:02x}" for i in range(32)}[0m
[30;1m55 | [0m[35m    escaped_text = "".join(escape_control_chars.get(x, x) for x in text)[0m
[30;1m56 | [0m[35m    if any(char in escape_control_chars for char in text):[0m
[30;1m57 | [0m[35m        # Escaped chars need to be unescaped by the shell to be properly inperpreted by curl and htt[0m
[30;1m58 | [0m[35m        return f'"$(printf {shlex.quote(escaped_text)})"'[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    return shlex.quote(escaped_text)[0m

[31m--[ [0m[34mMatch #[0m[33m406[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/utils/data.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m    def path(self, path):[0m
[30;1m25 | [0m[35m        """[0m
[30;1m26 | [0m[35m        Returns a path to the package data housed at 'path' under this[0m
[30;1m27 | [0m[35m        module.Path can be a path to a file, or to a directory.[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m        This function will raise ValueError if the path does not exist.[0m

[31m--[ [0m[34mMatch #[0m[33m407[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/quic/_raw_layers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m120 | [0m[35m        self.refresh_metadata()[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m    def refresh_metadata(self) -> None:[0m
[30;1m123 | [0m[35m        # find the first transport layer[0m
[30;1m124 | [0m[35m        child_layer: layer.Layer | None = self.child_layer[0m
[30;1m125 | [0m[35m        while True:[0m
[30;1m126 | [0m[35m            if isinstance(child_layer, layer.NextLayer):[0m

[31m--[ [0m[34mMatch #[0m[33m408[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/quic/_raw_layers.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom __future__ import annotations[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mimport time[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mfrom aioquic.quic.connection import QuicErrorCode[0m
[30;1m11 | [0m[35mfrom aioquic.quic.connection import stream_is_client_initiated[0m
[30;1m12 | [0m[35mfrom aioquic.quic.connection import stream_is_unidirectional[0m

[31m--[ [0m[34mMatch #[0m[33m409[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contentviews/base.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m36 | [0m[35m        Returns a (description, content generator) tuple.[0m
[30;1m37 | [0m[35m        The content generator yields lists of (style, text) tuples, where each list represents[0m
[30;1m38 | [0m[35m        a single line. ``text`` is a unfiltered string which may need to be escaped,[0m
[30;1m39 | [0m[35m        depending on the used output. For example, it may contain terminal control sequences[0m
[30;1m40 | [0m[35m        or unfiltered HTML.[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m        Except for `data`, implementations must not rely on any given argument to be present.[0m

[31m--[ [0m[34mMatch #[0m[33m410[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/view.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m527 | [0m[35m        Get flow with the given id from the store.[0m
[30;1m528 | [0m[35m        Returns None if the flow is not found.[0m
[30;1m529 | [0m[35m        """[0m
[30;1m530 | [0m[35m        return self._store.get(flow_id)[0m
[30;1m531 | [0m[35m[0m
[30;1m532 | [0m[35m    # View Properties[0m
[30;1m533 | [0m[35m    @command.command("view.properties.length")[0m

[31m--[ [0m[34mMatch #[0m[33m411[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/view.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m394 | [0m[35m        """[0m
[30;1m395 | [0m[35m        updated = [][0m
[30;1m396 | [0m[35m        for f in flows:[0m
[30;1m397 | [0m[35m            current = self.settings[f].get("key", "false")[0m
[30;1m398 | [0m[35m            self.settings[f][key] = "false" if current == "true" else "true"[0m
[30;1m399 | [0m[35m            updated.append(f)[0m
[30;1m400 | [0m[35m        ctx.master.addons.trigger(hooks.UpdateHook(updated))[0m

[31m--[ [0m[34mMatch #[0m[33m412[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/view.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m384 | [0m[35m        """[0m
[30;1m385 | [0m[35m        Get a value from the settings store for the specified flow.[0m
[30;1m386 | [0m[35m        """[0m
[30;1m387 | [0m[35m        return self.settings[flow].get(key, default)[0m
[30;1m388 | [0m[35m[0m
[30;1m389 | [0m[35m    @command.command("view.settings.setval.toggle")[0m
[30;1m390 | [0m[35m    def setvalue_toggle(self, flows: Sequence[mitmproxy.flow.Flow], key: str) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m413[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/view.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m194 | [0m[35m            "view_order",[0m
[30;1m195 | [0m[35m            str,[0m
[30;1m196 | [0m[35m            "time",[0m
[30;1m197 | [0m[35m            "Flow sort order.",[0m
[30;1m198 | [0m[35m            choices=list(map(lambda c: c[1], orders)),[0m
[30;1m199 | [0m[35m        )[0m
[30;1m200 | [0m[35m        loader.add_option([0m

[31m--[ [0m[34mMatch #[0m[33m414[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/view.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m41 | [0m[35m# the sort order changes as the flow progresses through its lifecycle. We[0m
[30;1m42 | [0m[35m# address this through two means:[0m
[30;1m43 | [0m[35m#[0m
[30;1m44 | [0m[35m# - Let order keys cache the sort value by flow ID.[0m
[30;1m45 | [0m[35m#[0m
[30;1m46 | [0m[35m# - Add a facility to refresh items in the list by removing and re-adding them[0m
[30;1m47 | [0m[35m# when they are updated.[0m

[31m--[ [0m[34mMatch #[0m[33m415[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/view.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m# The underlying sorted list implementation expects the sort key to be stable[0m
[30;1m40 | [0m[35m# for the lifetime of the object. However, if we sort by size, for instance,[0m
[30;1m41 | [0m[35m# the sort order changes as the flow progresses through its lifecycle. We[0m
[30;1m42 | [0m[35m# address this through two means:[0m
[30;1m43 | [0m[35m#[0m
[30;1m44 | [0m[35m# - Let order keys cache the sort value by flow ID.[0m

[31m--[ [0m[34mMatch #[0m[33m416[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/view.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m37 | [0m[35mfrom mitmproxy.utils import signals[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m# The underlying sorted list implementation expects the sort key to be stable[0m
[30;1m40 | [0m[35m# for the lifetime of the object. However, if we sort by size, for instance,[0m
[30;1m41 | [0m[35m# the sort order changes as the flow progresses through its lifecycle. We[0m
[30;1m42 | [0m[35m# address this through two means:[0m
[30;1m43 | [0m[35m#[0m

[31m--[ [0m[34mMatch #[0m[33m417[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/view.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m36 | [0m[35mfrom mitmproxy.utils import human[0m
[30;1m37 | [0m[35mfrom mitmproxy.utils import signals[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m# The underlying sorted list implementation expects the sort key to be stable[0m
[30;1m40 | [0m[35m# for the lifetime of the object. However, if we sort by size, for instance,[0m
[30;1m41 | [0m[35m# the sort order changes as the flow progresses through its lifecycle. We[0m
[30;1m42 | [0m[35m# address this through two means:[0m

[31m--[ [0m[34mMatch #[0m[33m418[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/view.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m167 | [0m[35m        self._view = sortedcontainers.SortedListWithKey(key=self.order_key)[0m
[30;1m168 | [0m[35m[0m
[30;1m169 | [0m[35m        # The sig_view* signals broadcast events that affect the view. That is,[0m
[30;1m170 | [0m[35m        # an update to a flow in the store but not in the view does not trigger[0m
[30;1m171 | [0m[35m        # a signal. All signals are called after the view has been updated.[0m
[30;1m172 | [0m[35m        self.sig_view_update = signals.SyncSignal(_signal_with_flow)[0m
[30;1m173 | [0m[35m        self.sig_view_add = signals.SyncSignal(_signal_with_flow)[0m

[31m--[ [0m[34mMatch #[0m[33m419[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/optmanager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m548 | [0m[35m    """[0m
[30;1m549 | [0m[35m    data = parse(text)[0m
[30;1m550 | [0m[35m[0m
[30;1m551 | [0m[35m    scripts = data.get("scripts")[0m
[30;1m552 | [0m[35m    if scripts is not None and cwd is not None:[0m
[30;1m553 | [0m[35m        data["scripts"] = [[0m
[30;1m554 | [0m[35m            str(relative_path(Path(path), relative_to=Path(cwd))) for path in scripts[0m

[31m--[ [0m[34mMatch #[0m[33m420[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/optmanager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m195 | [0m[35m        # This is slightly tricky. We allow attributes to be set on the instance[0m
[30;1m196 | [0m[35m        # until we have an _options attribute. After that, assignment is sent to[0m
[30;1m197 | [0m[35m        # the update function, and will raise an error for unknown options.[0m
[30;1m198 | [0m[35m        opts = self.__dict__.get("_options")[0m
[30;1m199 | [0m[35m        if not opts:[0m
[30;1m200 | [0m[35m            super().__setattr__(attr, value)[0m
[30;1m201 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m421[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/optmanager.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m478 | [0m[35m    """[0m
[30;1m479 | [0m[35m    Dumps an annotated file with all options.[0m
[30;1m480 | [0m[35m    """[0m
[30;1m481 | [0m[35m    # Sort data[0m
[30;1m482 | [0m[35m    s = ruamel.yaml.comments.CommentedMap()[0m
[30;1m483 | [0m[35m    for k in sorted(opts.keys()):[0m
[30;1m484 | [0m[35m        o = opts._options[k][0m

[31m--[ [0m[34mMatch #[0m[33m422[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/optmanager.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m529 | [0m[35m        if hasattr(v, "problem_mark"):[0m
[30;1m530 | [0m[35m            snip = v.problem_mark.get_snippet()[0m
[30;1m531 | [0m[35m            raise exceptions.OptionsError([0m
[30;1m532 | [0m[35m                "Config error at line %s:\n%s\n%s"[0m
[30;1m533 | [0m[35m                % (v.problem_mark.line + 1, snip, getattr(v, "problem", ""))[0m
[30;1m534 | [0m[35m            )[0m
[30;1m535 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m423[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/optmanager.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m220 | [0m[35m[0m
[30;1m221 | [0m[35m    def update_known(self, **kwargs):[0m
[30;1m222 | [0m[35m        """[0m
[30;1m223 | [0m[35m        Update and set all known options from kwargs. Returns a dictionary[0m
[30;1m224 | [0m[35m        of unknown options.[0m
[30;1m225 | [0m[35m        """[0m
[30;1m226 | [0m[35m        known, unknown = {}, {}[0m

[31m--[ [0m[34mMatch #[0m[33m424[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/optmanager.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m194 | [0m[35m    def __setattr__(self, attr, value):[0m
[30;1m195 | [0m[35m        # This is slightly tricky. We allow attributes to be set on the instance[0m
[30;1m196 | [0m[35m        # until we have an _options attribute. After that, assignment is sent to[0m
[30;1m197 | [0m[35m        # the update function, and will raise an error for unknown options.[0m
[30;1m198 | [0m[35m        opts = self.__dict__.get("_options")[0m
[30;1m199 | [0m[35m        if not opts:[0m
[30;1m200 | [0m[35m            super().__setattr__(attr, value)[0m

[31m--[ [0m[34mMatch #[0m[33m425[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contrib/wbxml/ASWBXMLByteQueue.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m50 | [0m[35m    Created to debug the dequeueing of bytes[0m
[30;1m51 | [0m[35m    """[0m
[30;1m52 | [0m[35m    def dequeueAndLog(self):[0m
[30;1m53 | [0m[35m        singleByte = self.get()[0m
[30;1m54 | [0m[35m        self.bytesDequeued += 1[0m
[30;1m55 | [0m[35m        logging.debug("Dequeued byte 0x{0:X} ({1} total)".format(singleByte, self.bytesDequeued))[0m
[30;1m56 | [0m[35m        return singleByte[0m

[31m--[ [0m[34mMatch #[0m[33m426[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/dns.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m135 | [0m[35m    @property[0m
[30;1m136 | [0m[35m    def https_ech(self) -> str | None:[0m
[30;1m137 | [0m[35m        record = https_records.unpack(self.data)[0m
[30;1m138 | [0m[35m        ech_bytes = record.params.get(SVCParamKeys.ECH.value, None)[0m
[30;1m139 | [0m[35m        if ech_bytes is not None:[0m
[30;1m140 | [0m[35m            return base64.b64encode(ech_bytes).decode("utf-8")[0m
[30;1m141 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m427[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/dns.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m110 | [0m[35m    @property[0m
[30;1m111 | [0m[35m    def https_alpn(self) -> tuple[bytes, ...] | None:[0m
[30;1m112 | [0m[35m        record = https_records.unpack(self.data)[0m
[30;1m113 | [0m[35m        alpn_bytes = record.params.get(SVCParamKeys.ALPN.value, None)[0m
[30;1m114 | [0m[35m        if alpn_bytes is not None:[0m
[30;1m115 | [0m[35m            i = 0[0m
[30;1m116 | [0m[35m            ret = [][0m

[31m--[ [0m[34mMatch #[0m[33m428[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/dns.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m207 | [0m[35m    HEADER: ClassVar[struct.Struct] = struct.Struct("!HHHHHH")[0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m    timestamp: float[0m
[30;1m210 | [0m[35m    """The time at which the message was sent or received."""[0m
[30;1m211 | [0m[35m    id: int[0m
[30;1m212 | [0m[35m    """An identifier assigned by the program that generates any kind of query."""[0m
[30;1m213 | [0m[35m    query: bool[0m

[31m--[ [0m[34mMatch #[0m[33m429[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/dns.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mimport itertools[0m
[30;1m5 | [0m[35mimport random[0m
[30;1m6 | [0m[35mimport struct[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35mfrom collections.abc import Iterable[0m
[30;1m9 | [0m[35mfrom dataclasses import dataclass[0m
[30;1m10 | [0m[35mfrom ipaddress import IPv4Address[0m
[30;1m11 | [0m[35mfrom ipaddress import IPv6Address[0m

[31m--[ [0m[34mMatch #[0m[33m430[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/dns.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mfrom __future__ import annotations[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35mimport itertools[0m
[30;1m5 | [0m[35mimport random[0m
[30;1m6 | [0m[35mimport struct[0m
[30;1m7 | [0m[35mimport time[0m

[31m--[ [0m[34mMatch #[0m[33m431[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/dns.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m264 | [0m[35m[0m
[30;1m265 | [0m[35m    @property[0m
[30;1m266 | [0m[35m    def question(self) -> Question | None:[0m
[30;1m267 | [0m[35m        """DNS practically only supports a single question at the[0m
[30;1m268 | [0m[35m        same time, so this is a shorthand for this."""[0m
[30;1m269 | [0m[35m        if len(self.questions) == 1:[0m
[30;1m270 | [0m[35m            return self.questions[0][0m

[31m--[ [0m[34mMatch #[0m[33m432[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/dns.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m207 | [0m[35m    HEADER: ClassVar[struct.Struct] = struct.Struct("!HHHHHH")[0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m    timestamp: float[0m
[30;1m210 | [0m[35m    """The time at which the message was sent or received."""[0m
[30;1m211 | [0m[35m    id: int[0m
[30;1m212 | [0m[35m    """An identifier assigned by the program that generates any kind of query."""[0m
[30;1m213 | [0m[35m    query: bool[0m

[31m--[ [0m[34mMatch #[0m[33m433[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/http/http1/assemble.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35mdef assemble_body(headers, body_chunks, trailers):[0m
[30;1m38 | [0m[35m    if "chunked" in headers.get("transfer-encoding", "").lower():[0m
[30;1m39 | [0m[35m        for chunk in body_chunks:[0m
[30;1m40 | [0m[35m            if chunk:[0m
[30;1m41 | [0m[35m                yield b"%x\r\n%s\r\n" % (len(chunk), chunk)[0m

[31m--[ [0m[34mMatch #[0m[33m434[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/http/http1/assemble.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35m            response.data.headers, [response.data.content], response.data.trailers[0m
[30;1m26 | [0m[35m        )[0m
[30;1m27 | [0m[35m    )[0m
[30;1m28 | [0m[35m    return head + body[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35mdef assemble_response_head(response):[0m

[31m--[ [0m[34mMatch #[0m[33m435[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/http/http1/assemble.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m19 | [0m[35mdef assemble_response(response):[0m
[30;1m20 | [0m[35m    if response.data.content is None:[0m
[30;1m21 | [0m[35m        raise ValueError("Cannot assemble flow with missing content")[0m
[30;1m22 | [0m[35m    head = assemble_response_head(response)[0m
[30;1m23 | [0m[35m    body = b"".join([0m
[30;1m24 | [0m[35m        assemble_body([0m
[30;1m25 | [0m[35m            response.data.headers, [response.data.content], response.data.trailers[0m

[31m--[ [0m[34mMatch #[0m[33m436[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/http/http1/assemble.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35m            request.data.headers, [request.data.content], request.data.trailers[0m
[30;1m8 | [0m[35m        )[0m
[30;1m9 | [0m[35m    )[0m
[30;1m10 | [0m[35m    return head + body[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mdef assemble_request_head(request):[0m

[31m--[ [0m[34mMatch #[0m[33m437[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/http/http1/assemble.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mdef assemble_request(request):[0m
[30;1m2 | [0m[35m    if request.data.content is None:[0m
[30;1m3 | [0m[35m        raise ValueError("Cannot assemble flow with missing content")[0m
[30;1m4 | [0m[35m    head = assemble_request_head(request)[0m
[30;1m5 | [0m[35m    body = b"".join([0m
[30;1m6 | [0m[35m        assemble_body([0m
[30;1m7 | [0m[35m            request.data.headers, [request.data.content], request.data.trailers[0m

[31m--[ [0m[34mMatch #[0m[33m438[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/utils/emoji.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1867 | [0m[35m[0m
[30;1m1868 | [0m[35m    out = io.StringIO()[0m
[30;1m1869 | [0m[35m[0m
[30;1m1870 | [0m[35m    r = requests.get("https://api.github.com/emojis")[0m
[30;1m1871 | [0m[35m    for name, url in r.json().items():[0m
[30;1m1872 | [0m[35m        codepoints = url.rpartition("/")[2].partition(".png")[0].split("-")[0m
[30;1m1873 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m439[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/dumper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m386 | [0m[35m        desc_color = {[0m
[30;1m387 | [0m[35m            "A": "green",[0m
[30;1m388 | [0m[35m            "AAAA": "magenta",[0m
[30;1m389 | [0m[35m        }.get(type, "red")[0m
[30;1m390 | [0m[35m        desc = self.style(desc, fg=desc_color)[0m
[30;1m391 | [0m[35m[0m
[30;1m392 | [0m[35m        name = self.style(f.request.questions[0].name, bold=True)[0m

[31m--[ [0m[34mMatch #[0m[33m440[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/dumper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m356 | [0m[35m                flow_type = ([0m
[30;1m357 | [0m[35m                    f"quic {quic_type} {f.metadata.get('quic_stream_id_client', '')} "[0m
[30;1m358 | [0m[35m                    f"{direction} mitmproxy {direction} "[0m
[30;1m359 | [0m[35m                    f"quic {quic_type} {f.metadata.get('quic_stream_id_server', '')}"[0m
[30;1m360 | [0m[35m                )[0m
[30;1m361 | [0m[35m            else:[0m
[30;1m362 | [0m[35m                flow_type = f.type[0m

[31m--[ [0m[34mMatch #[0m[33m441[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/dumper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m354 | [0m[35m                    quic_type = "dgrams"[0m
[30;1m355 | [0m[35m                # TODO: This should not be metadata, this should be typed attributes.[0m
[30;1m356 | [0m[35m                flow_type = ([0m
[30;1m357 | [0m[35m                    f"quic {quic_type} {f.metadata.get('quic_stream_id_client', '')} "[0m
[30;1m358 | [0m[35m                    f"{direction} mitmproxy {direction} "[0m
[30;1m359 | [0m[35m                    f"quic {quic_type} {f.metadata.get('quic_stream_id_server', '')}"[0m
[30;1m360 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m442[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/dumper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m215 | [0m[35m        if not (flow.response.is_http2 or flow.response.is_http3):[0m
[30;1m216 | [0m[35m            reason = flow.response.reason[0m
[30;1m217 | [0m[35m        else:[0m
[30;1m218 | [0m[35m            reason = http.status_codes.RESPONSES.get(flow.response.status_code, "")[0m
[30;1m219 | [0m[35m        reason = self.style([0m
[30;1m220 | [0m[35m            strutils.escape_control_characters(reason), fg=code_color, bold=True[0m
[30;1m221 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m443[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/dumper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m161 | [0m[35m[0m
[30;1m162 | [0m[35m        pushed = " PUSH_PROMISE" if "h2-pushed-stream" in flow.metadata else ""[0m
[30;1m163 | [0m[35m        method = flow.request.method + pushed[0m
[30;1m164 | [0m[35m        method_color = dict(GET="green", DELETE="red").get(method.upper(), "magenta")[0m
[30;1m165 | [0m[35m        method = self.style([0m
[30;1m166 | [0m[35m            strutils.escape_control_characters(method), fg=method_color, bold=True[0m
[30;1m167 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m444[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/dumper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m112 | [0m[35m    def _colorful(self, line):[0m
[30;1m113 | [0m[35m        yield "    "  # we can already indent here[0m
[30;1m114 | [0m[35m        for style, text in line:[0m
[30;1m115 | [0m[35m            yield self.style(text, **CONTENTVIEW_STYLES.get(style, {}))[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m    def _echo_message([0m
[30;1m118 | [0m[35m        self,[0m

[31m--[ [0m[34mMatch #[0m[33m445[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/onboardingapp/templates/index.html[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m111 | [0m[35m    <h5>Firefox</h5>[0m
[30;1m112 | [0m[35m    <ol>[0m
[30;1m113 | [0m[35m        <li>Open <samp>Options -> Privacy &amp; Security</samp> and click <samp>View Certificates...[0m
[30;1m114 | [0m[35m            at the bottom of the page.</li>[0m
[30;1m115 | [0m[35m        <li>Click <samp>Import...</samp> and select the downloaded certificate.</li>[0m
[30;1m116 | [0m[35m        <li>Enable <samp>Trust this CA to identify websites</samp> and click <samp>OK</samp>.</li>[0m
[30;1m117 | [0m[35m    </ol>[0m

[31m--[ [0m[34mMatch #[0m[33m446[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tls.py[0m
   Pattern: [32m.hostname[0m
[30;1m70 | [0m[35m    def sni(self) -> str | None:[0m
[30;1m71 | [0m[35m        """[0m
[30;1m72 | [0m[35m        The [Server Name Indication](https://en.wikipedia.org/wiki/Server_Name_Indication),[0m
[30;1m73 | [0m[35m        which indicates which hostname the client wants to connect to.[0m
[30;1m74 | [0m[35m        """[0m
[30;1m75 | [0m[35m        if ext := getattr(self._client_hello, "extensions", None):[0m
[30;1m76 | [0m[35m            for extension in ext.extensions:[0m

[31m--[ [0m[34mMatch #[0m[33m447[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tls.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mfrom dataclasses import dataclass[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mfrom kaitaistruct import KaitaiStream[0m
[30;1m5 | [0m[35mfrom OpenSSL import SSL[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mfrom mitmproxy import connection[0m
[30;1m8 | [0m[35mfrom mitmproxy.contrib.kaitaistruct import dtls_client_hello[0m

[31m--[ [0m[34mMatch #[0m[33m448[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/server.py[0m
   Pattern: [32m.hostname[0m
[30;1m185 | [0m[35m            self.log(f"Cannot open connection, no hostname given.")[0m
[30;1m186 | [0m[35m            await self.server_event([0m
[30;1m187 | [0m[35m                events.OpenConnectionCompleted([0m
[30;1m188 | [0m[35m                    command, f"Cannot open connection, no hostname given."[0m
[30;1m189 | [0m[35m                )[0m
[30;1m190 | [0m[35m            )[0m
[30;1m191 | [0m[35m            return[0m

[31m--[ [0m[34mMatch #[0m[33m449[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/server.py[0m
   Pattern: [32m.hostname[0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35m    async def open_connection(self, command: commands.OpenConnection) -> None:[0m
[30;1m184 | [0m[35m        if not command.connection.address:[0m
[30;1m185 | [0m[35m            self.log(f"Cannot open connection, no hostname given.")[0m
[30;1m186 | [0m[35m            await self.server_event([0m
[30;1m187 | [0m[35m                events.OpenConnectionCompleted([0m
[30;1m188 | [0m[35m                    command, f"Cannot open connection, no hostname given."[0m

[31m--[ [0m[34mMatch #[0m[33m450[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m130 | [0m[35m            name=f"client handler",[0m
[30;1m131 | [0m[35m            client=self.client.peername,[0m
[30;1m132 | [0m[35m        )[0m
[30;1m133 | [0m[35m        watch = asyncio_utils.create_task([0m
[30;1m134 | [0m[35m            self.timeout_watchdog.watch(),[0m
[30;1m135 | [0m[35m            name="timeout watchdog",[0m
[30;1m136 | [0m[35m            keep_ref=False,[0m

[31m--[ [0m[34mMatch #[0m[33m451[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m117 | [0m[35m        if self.client.transport_protocol == "tcp":[0m
[30;1m118 | [0m[35m            timeout = TCP_TIMEOUT[0m
[30;1m119 | [0m[35m        else:[0m
[30;1m120 | [0m[35m            timeout = UDP_TIMEOUT[0m
[30;1m121 | [0m[35m        self.timeout_watchdog = TimeoutWatchdog(timeout, self.on_timeout)[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m        self._server_event_lock = asyncio.Lock()[0m

[31m--[ [0m[34mMatch #[0m[33m452[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m115 | [0m[35m        # on protocols that start with a server greeting.[0m
[30;1m116 | [0m[35m        self.layer = layer.NextLayer(context, ask_on_start=True)[0m
[30;1m117 | [0m[35m        if self.client.transport_protocol == "tcp":[0m
[30;1m118 | [0m[35m            timeout = TCP_TIMEOUT[0m
[30;1m119 | [0m[35m        else:[0m
[30;1m120 | [0m[35m            timeout = UDP_TIMEOUT[0m
[30;1m121 | [0m[35m        self.timeout_watchdog = TimeoutWatchdog(timeout, self.on_timeout)[0m

[31m--[ [0m[34mMatch #[0m[33m453[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m55 | [0m[35m    blocker: int[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    def __init__(self, timeout: int, callback: Callable[[], Awaitable]):[0m
[30;1m58 | [0m[35m        self.timeout = timeout[0m
[30;1m59 | [0m[35m        self.callback = callback[0m
[30;1m60 | [0m[35m        self.last_activity = time.time()[0m
[30;1m61 | [0m[35m        self.can_timeout = asyncio.Event()[0m
[30;1m62 | [0m[35m        self.can_timeout.set()[0m

[31m--[ [0m[34mMatch #[0m[33m454[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35mfrom types import TracebackType[0m
[30;1m21 | [0m[35mfrom typing import Literal[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mfrom OpenSSL import SSL[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35mimport mitmproxy_rs[0m
[30;1m26 | [0m[35mfrom mitmproxy import http[0m

[31m--[ [0m[34mMatch #[0m[33m455[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35mimport asyncio[0m
[30;1m12 | [0m[35mimport collections[0m
[30;1m13 | [0m[35mimport logging[0m
[30;1m14 | [0m[35mimport time[0m
[30;1m15 | [0m[35mfrom collections.abc import Awaitable[0m
[30;1m16 | [0m[35mfrom collections.abc import Callable[0m
[30;1m17 | [0m[35mfrom collections.abc import MutableMapping[0m
[30;1m18 | [0m[35mfrom contextlib import contextmanager[0m

[31m--[ [0m[34mMatch #[0m[33m456[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35m    - Spawn one coroutine per client connection and create a reverse proxy layer to example.com[0m
[30;1m6 | [0m[35m    - Process any commands from layer (such as opening a server connection)[0m
[30;1m7 | [0m[35m    - Wait for any IO and send it as events to top layer.[0m
[30;1m8 | [0m[35m"""[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mimport abc[0m

[31m--[ [0m[34mMatch #[0m[33m457[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/proxyauth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m96 | [0m[35m        is_proxy = is_http_proxy(f)[0m
[30;1m97 | [0m[35m        auth_header = http_auth_header(is_proxy)[0m
[30;1m98 | [0m[35m        try:[0m
[30;1m99 | [0m[35m            auth_value = f.request.headers.get(auth_header, "")[0m
[30;1m100 | [0m[35m            scheme, username, password = parse_http_basic_auth(auth_value)[0m
[30;1m101 | [0m[35m            is_valid = self.validator(username, password)[0m
[30;1m102 | [0m[35m        except Exception:[0m

[31m--[ [0m[34mMatch #[0m[33m458[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/udp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35mfrom mitmproxy.proxy.commands import StartHook[0m
[30;1m10 | [0m[35mfrom mitmproxy.proxy.context import Context[0m
[30;1m11 | [0m[35mfrom mitmproxy.proxy.events import MessageInjected[0m
[30;1m12 | [0m[35mfrom mitmproxy.proxy.utils import expect[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m@dataclass[0m
[30;1m16 | [0m[35mclass UdpStartHook(StartHook):[0m

[31m--[ [0m[34mMatch #[0m[33m459[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/asgiapp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m127 | [0m[35m        elif event["type"] == "http.response.body":[0m
[30;1m128 | [0m[35m            assert flow.response[0m
[30;1m129 | [0m[35m            flow.response.content += event.get("body", b"")[0m
[30;1m130 | [0m[35m            if not event.get("more_body", False):[0m
[30;1m131 | [0m[35m                nonlocal sent_response[0m
[30;1m132 | [0m[35m                sent_response = True[0m
[30;1m133 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m460[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/asgiapp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m126 | [0m[35m            flow.response.decode()[0m
[30;1m127 | [0m[35m        elif event["type"] == "http.response.body":[0m
[30;1m128 | [0m[35m            assert flow.response[0m
[30;1m129 | [0m[35m            flow.response.content += event.get("body", b"")[0m
[30;1m130 | [0m[35m            if not event.get("more_body", False):[0m
[30;1m131 | [0m[35m                nonlocal sent_response[0m
[30;1m132 | [0m[35m                sent_response = True[0m

[31m--[ [0m[34mMatch #[0m[33m461[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/asgiapp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m121 | [0m[35m    async def send(event):[0m
[30;1m122 | [0m[35m        if event["type"] == "http.response.start":[0m
[30;1m123 | [0m[35m            flow.response = http.Response.make([0m
[30;1m124 | [0m[35m                event["status"], b"", event.get("headers", [])[0m
[30;1m125 | [0m[35m            )[0m
[30;1m126 | [0m[35m            flow.response.decode()[0m
[30;1m127 | [0m[35m        elif event["type"] == "http.response.body":[0m

[31m--[ [0m[34mMatch #[0m[33m462[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/asgiapp.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m78 | [0m[35m            "version": "3.0",[0m
[30;1m79 | [0m[35m            "spec_version": "2.1",[0m
[30;1m80 | [0m[35m        },[0m
[30;1m81 | [0m[35m        "http_version": HTTP_VERSION_MAP.get(flow.request.http_version, "1.1"),[0m
[30;1m82 | [0m[35m        "method": flow.request.method,[0m
[30;1m83 | [0m[35m        "scheme": flow.request.scheme.upper(),[0m
[30;1m84 | [0m[35m        "path": path,[0m

[31m--[ [0m[34mMatch #[0m[33m463[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/asgiapp.py[0m
   Pattern: [32m.hostname[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mclass ASGIApp:[0m
[30;1m15 | [0m[35m    """[0m
[30;1m16 | [0m[35m    An addon that hosts an ASGI/WSGI HTTP app within mitmproxy, at a specified hostname and port.[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m    Some important caveats:[0m
[30;1m19 | [0m[35m        - This implementation will block and wait until the entire HTTP response is completed before[0m

[31m--[ [0m[34mMatch #[0m[33m464[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/asgiapp.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mclass ASGIApp:[0m
[30;1m15 | [0m[35m    """[0m
[30;1m16 | [0m[35m    An addon that hosts an ASGI/WSGI HTTP app within mitmproxy, at a specified hostname and port.[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m    Some important caveats:[0m
[30;1m19 | [0m[35m        - This implementation will block and wait until the entire HTTP response is completed before[0m

[31m--[ [0m[34mMatch #[0m[33m465[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/asgiapp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m113 | [0m[35m                "body": flow.request.raw_content,[0m
[30;1m114 | [0m[35m            }[0m
[30;1m115 | [0m[35m        else:  # pragma: no cover[0m
[30;1m116 | [0m[35m            # We really don't expect this to be called a second time, but what to do?[0m
[30;1m117 | [0m[35m            # We just wait until the request is done before we continue here with sending a disconne[0m
[30;1m118 | [0m[35m            await done.wait()[0m
[30;1m119 | [0m[35m            return {"type": "http.disconnect"}[0m

[31m--[ [0m[34mMatch #[0m[33m466[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/websocket.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m        # Parse extension headers. We only support deflate at the moment and ignore everything else.[0m
[30;1m104 | [0m[35m        assert self.flow.response  # satisfy type checker[0m
[30;1m105 | [0m[35m        ext_header = self.flow.response.headers.get("Sec-WebSocket-Extensions", "")[0m
[30;1m106 | [0m[35m        if ext_header:[0m
[30;1m107 | [0m[35m            for ext in wsproto.utilities.split_comma_header([0m
[30;1m108 | [0m[35m                ext_header.encode("ascii", "replace")[0m

[31m--[ [0m[34mMatch #[0m[33m467[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/websocket.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m100 | [0m[35m        client_extensions = [][0m
[30;1m101 | [0m[35m        server_extensions = [][0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m        # Parse extension headers. We only support deflate at the moment and ignore everything else.[0m
[30;1m104 | [0m[35m        assert self.flow.response  # satisfy type checker[0m
[30;1m105 | [0m[35m        ext_header = self.flow.response.headers.get("Sec-WebSocket-Extensions", "")[0m
[30;1m106 | [0m[35m        if ext_header:[0m

[31m--[ [0m[34mMatch #[0m[33m468[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/websocket.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m17 | [0m[35mfrom mitmproxy.proxy.commands import StartHook[0m
[30;1m18 | [0m[35mfrom mitmproxy.proxy.context import Context[0m
[30;1m19 | [0m[35mfrom mitmproxy.proxy.events import MessageInjected[0m
[30;1m20 | [0m[35mfrom mitmproxy.proxy.utils import expect[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m@dataclass[0m
[30;1m24 | [0m[35mclass WebsocketStartHook(StartHook):[0m

[31m--[ [0m[34mMatch #[0m[33m469[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/websocket.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35mfrom collections.abc import Iterator[0m
[30;1m3 | [0m[35mfrom dataclasses import dataclass[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mimport wsproto.extensions[0m

[31m--[ [0m[34mMatch #[0m[33m470[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m291 | [0m[35m    def _ask(self):[0m
[30;1m292 | [0m[35m        """[0m
[30;1m293 | [0m[35m        Manually trigger a next_layer hook.[0m
[30;1m294 | [0m[35m        The only use at the moment is to make sure that the top layer is initialized.[0m
[30;1m295 | [0m[35m        """[0m
[30;1m296 | [0m[35m        yield NextLayerHook(self)[0m
[30;1m297 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m471[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m274 | [0m[35m    def _handle_event(self, event: mevents.Event):[0m
[30;1m275 | [0m[35m        self.events.append(event)[0m
[30;1m276 | [0m[35m[0m
[30;1m277 | [0m[35m        # We receive new data. Let's find out if we can determine the next layer now?[0m
[30;1m278 | [0m[35m        if self._ask_on_start and isinstance(event, events.Start):[0m
[30;1m279 | [0m[35m            yield from self._ask()[0m
[30;1m280 | [0m[35m        elif ([0m

[31m--[ [0m[34mMatch #[0m[33m472[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m291 | [0m[35m    def _ask(self):[0m
[30;1m292 | [0m[35m        """[0m
[30;1m293 | [0m[35m        Manually trigger a next_layer hook.[0m
[30;1m294 | [0m[35m        The only use at the moment is to make sure that the top layer is initialized.[0m
[30;1m295 | [0m[35m        """[0m
[30;1m296 | [0m[35m        yield NextLayerHook(self)[0m
[30;1m297 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m473[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/tcp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35mfrom mitmproxy.proxy.commands import StartHook[0m
[30;1m11 | [0m[35mfrom mitmproxy.proxy.context import Context[0m
[30;1m12 | [0m[35mfrom mitmproxy.proxy.events import MessageInjected[0m
[30;1m13 | [0m[35mfrom mitmproxy.proxy.utils import expect[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m@dataclass[0m
[30;1m17 | [0m[35mclass TcpStartHook(StartHook):[0m

[31m--[ [0m[34mMatch #[0m[33m474[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/udp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom mitmproxy import connection[0m
[30;1m4 | [0m[35mfrom mitmproxy import flow[0m
[30;1m5 | [0m[35mfrom mitmproxy.coretypes import serializable[0m

[31m--[ [0m[34mMatch #[0m[33m475[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/consoleaddons.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m375 | [0m[35m            raise exceptions.CommandError([0m
[30;1m376 | [0m[35m                "Part must be either request or response, not %s." % part[0m
[30;1m377 | [0m[35m            )[0m
[30;1m378 | [0m[35m        t = fpart.headers.get("content-type")[0m
[30;1m379 | [0m[35m        content = fpart.get_content(strict=False)[0m
[30;1m380 | [0m[35m        if not content:[0m
[30;1m381 | [0m[35m            raise exceptions.CommandError("No content to view.")[0m

[31m--[ [0m[34mMatch #[0m[33m476[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/consoleaddons.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m631 | [0m[35m        Bind a shortcut key.[0m
[30;1m632 | [0m[35m        """[0m
[30;1m633 | [0m[35m        try:[0m
[30;1m634 | [0m[35m            self.master.keymap.add(key, cmd + " " + " ".join(args), contexts, "")[0m
[30;1m635 | [0m[35m        except ValueError as v:[0m
[30;1m636 | [0m[35m            raise exceptions.CommandError(v)[0m
[30;1m637 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m477[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/consoleaddons.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m356 | [0m[35m    @command.command("console.view.pop")[0m
[30;1m357 | [0m[35m    def view_pop(self) -> None:[0m
[30;1m358 | [0m[35m        """[0m
[30;1m359 | [0m[35m        Pop a view off the console stack. At the top level, this prompts the[0m
[30;1m360 | [0m[35m        user to exit mitmproxy.[0m
[30;1m361 | [0m[35m        """[0m
[30;1m362 | [0m[35m        signals.pop_view_state.send()[0m

[31m--[ [0m[34mMatch #[0m[33m478[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/consoleaddons.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m366 | [0m[35m    def bodyview(self, flow: flow.Flow, part: str) -> None:[0m
[30;1m367 | [0m[35m        """[0m
[30;1m368 | [0m[35m        Spawn an external viewer for a flow request or response body based[0m
[30;1m369 | [0m[35m        on the detected MIME type. We use the mailcap system to find the[0m
[30;1m370 | [0m[35m        correct viewer, and fall back to the programs in $PAGER or $EDITOR[0m
[30;1m371 | [0m[35m        if necessary.[0m
[30;1m372 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m479[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/consoleaddons.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m356 | [0m[35m    @command.command("console.view.pop")[0m
[30;1m357 | [0m[35m    def view_pop(self) -> None:[0m
[30;1m358 | [0m[35m        """[0m
[30;1m359 | [0m[35m        Pop a view off the console stack. At the top level, this prompts the[0m
[30;1m360 | [0m[35m        user to exit mitmproxy.[0m
[30;1m361 | [0m[35m        """[0m
[30;1m362 | [0m[35m        signals.pop_view_state.send()[0m

[31m--[ [0m[34mMatch #[0m[33m480[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/modifyheaders.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m29 | [0m[35m        if self.replacement_str.startswith("@"):[0m
[30;1m30 | [0m[35m            return Path(self.replacement_str[1:]).expanduser().read_bytes()[0m
[30;1m31 | [0m[35m        else:[0m
[30;1m32 | [0m[35m            # We could cache this at some point, but unlikely to be a problem.[0m
[30;1m33 | [0m[35m            return strutils.escaped_str_to_bytes(self.replacement_str)[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m481[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m824 | [0m[35m                response_content_length = None[0m
[30;1m825 | [0m[35m            response_code: int | None = f.response.status_code[0m
[30;1m826 | [0m[35m            response_reason: str | None = f.response.reason[0m
[30;1m827 | [0m[35m            response_content_type = f.response.headers.get("content-type")[0m
[30;1m828 | [0m[35m            if f.response.timestamp_end:[0m
[30;1m829 | [0m[35m                duration = max([0m
[30;1m830 | [0m[35m                    [f.response.timestamp_end - f.request.timestamp_start, 0][0m

[31m--[ [0m[34mMatch #[0m[33m482[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m716 | [0m[35m    status_style = ([0m
[30;1m717 | [0m[35m        "intercepted"[0m
[30;1m718 | [0m[35m        if intercepted[0m
[30;1m719 | [0m[35m        else HTTP_RESPONSE_CODE_STYLE.get(response_code_http_equiv // 100, "code_other")[0m
[30;1m720 | [0m[35m    )[0m
[30;1m721 | [0m[35m    items.append([0m
[30;1m722 | [0m[35m        fcol(fixlen("" if response_code is None else response_code, 9), status_style)[0m

[31m--[ [0m[34mMatch #[0m[33m483[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m552 | [0m[35m[0m
[30;1m553 | [0m[35m    if response_code:[0m
[30;1m554 | [0m[35m        status = str(response_code)[0m
[30;1m555 | [0m[35m        status_style = response_style or HTTP_RESPONSE_CODE_STYLE.get([0m
[30;1m556 | [0m[35m            response_code // 100, "code_other"[0m
[30;1m557 | [0m[35m        )[0m
[30;1m558 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m484[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m529 | [0m[35m    if request_is_push_promise:[0m
[30;1m530 | [0m[35m        method_style = "method_http2_push"[0m
[30;1m531 | [0m[35m    else:[0m
[30;1m532 | [0m[35m        method_style = request_style or HTTP_REQUEST_METHOD_STYLES.get([0m
[30;1m533 | [0m[35m            request_method, "method_other"[0m
[30;1m534 | [0m[35m        )[0m
[30;1m535 | [0m[35m    items.append(fcol(fixlen(request_method, 4), method_style))[0m

[31m--[ [0m[34mMatch #[0m[33m485[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m523 | [0m[35m    else:[0m
[30;1m524 | [0m[35m        request_style = ""[0m
[30;1m525 | [0m[35m[0m
[30;1m526 | [0m[35m    scheme_style = request_style or SCHEME_STYLES.get(request_scheme, "scheme_other")[0m
[30;1m527 | [0m[35m    items.append(fcol(fixlen(request_scheme.upper(), 5), scheme_style))[0m
[30;1m528 | [0m[35m[0m
[30;1m529 | [0m[35m    if request_is_push_promise:[0m

[31m--[ [0m[34mMatch #[0m[33m486[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m455 | [0m[35m        else:[0m
[30;1m456 | [0m[35m            style = ""[0m
[30;1m457 | [0m[35m[0m
[30;1m458 | [0m[35m        status_style = style or HTTP_RESPONSE_CODE_STYLE.get([0m
[30;1m459 | [0m[35m            response_code // 100, "code_other"[0m
[30;1m460 | [0m[35m        )[0m
[30;1m461 | [0m[35m        resp.append(fcol(SYMBOL_RETURN, status_style))[0m

[31m--[ [0m[34mMatch #[0m[33m487[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m424 | [0m[35m        else:[0m
[30;1m425 | [0m[35m            req.append(fcol("  ", "focus"))[0m
[30;1m426 | [0m[35m[0m
[30;1m427 | [0m[35m    method_style = HTTP_REQUEST_METHOD_STYLES.get(request_method, "method_other")[0m
[30;1m428 | [0m[35m    req.append(fcol(request_method, method_style))[0m
[30;1m429 | [0m[35m[0m
[30;1m430 | [0m[35m    if request_is_push_promise:[0m

[31m--[ [0m[34mMatch #[0m[33m488[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m316 | [0m[35m        return [("error", len(url))]  # bad URL[0m
[30;1m317 | [0m[35m    return ([0m
[30;1m318 | [0m[35m        [[0m
[30;1m319 | [0m[35m            (SCHEME_STYLES.get(parts[0], "scheme_other"), len(parts[0]) - 1),[0m
[30;1m320 | [0m[35m            ("url_punctuation", 3),  # ://[0m
[30;1m321 | [0m[35m        ][0m
[30;1m322 | [0m[35m        + colorize_host(parts[2])[0m

[31m--[ [0m[34mMatch #[0m[33m489[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m159 | [0m[35m[0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35mdef render_marker(marker: str) -> str:[0m
[30;1m162 | [0m[35m    rendered = emoji.emoji.get(marker, SYMBOL_MARK)[0m
[30;1m163 | [0m[35m[0m
[30;1m164 | [0m[35m    # The marker can only be one glyph. Some emoji that use zero-width joiners (ZWJ)[0m
[30;1m165 | [0m[35m    # will not be rendered as a single glyph and instead will show[0m

[31m--[ [0m[34mMatch #[0m[33m490[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m141 | [0m[35m    LIST = 2[0m
[30;1m142 | [0m[35m    """The flow list in list format, i.e. potentially multiple rows per flow."""[0m
[30;1m143 | [0m[35m    DETAILVIEW = 3[0m
[30;1m144 | [0m[35m    """The top lines in the detail view."""[0m
[30;1m145 | [0m[35m[0m
[30;1m146 | [0m[35m[0m
[30;1m147 | [0m[35mdef fixlen(s: str, maxlen: int) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m491[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/savehar.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m292 | [0m[35m                "name": name,[0m
[30;1m293 | [0m[35m                "value": value,[0m
[30;1m294 | [0m[35m                "path": attrs.get("path", "/"),[0m
[30;1m295 | [0m[35m                "domain": attrs.get("domain", ""),[0m
[30;1m296 | [0m[35m                "httpOnly": "httpOnly" in attrs,[0m
[30;1m297 | [0m[35m                "secure": "secure" in attrs,[0m
[30;1m298 | [0m[35m            }[0m

[31m--[ [0m[34mMatch #[0m[33m492[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/savehar.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m291 | [0m[35m            cookie = {[0m
[30;1m292 | [0m[35m                "name": name,[0m
[30;1m293 | [0m[35m                "value": value,[0m
[30;1m294 | [0m[35m                "path": attrs.get("path", "/"),[0m
[30;1m295 | [0m[35m                "domain": attrs.get("domain", ""),[0m
[30;1m296 | [0m[35m                "httpOnly": "httpOnly" in attrs,[0m
[30;1m297 | [0m[35m                "secure": "secure" in attrs,[0m

[31m--[ [0m[34mMatch #[0m[33m493[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/savehar.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m256 | [0m[35m        if flow.request.method in ["POST", "PUT", "PATCH"]:[0m
[30;1m257 | [0m[35m            params = self.format_multidict(flow.request.urlencoded_form)[0m
[30;1m258 | [0m[35m            entry["request"]["postData"] = {[0m
[30;1m259 | [0m[35m                "mimeType": flow.request.headers.get("Content-Type", ""),[0m
[30;1m260 | [0m[35m                "text": flow.request.get_text(strict=False),[0m
[30;1m261 | [0m[35m                "params": params,[0m
[30;1m262 | [0m[35m            }[0m

[31m--[ [0m[34mMatch #[0m[33m494[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/savehar.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m198 | [0m[35m                    "compression": response_body_compression,[0m
[30;1m199 | [0m[35m                    "mimeType": flow.response.headers.get("Content-Type", ""),[0m
[30;1m200 | [0m[35m                },[0m
[30;1m201 | [0m[35m                "redirectURL": flow.response.headers.get("Location", ""),[0m
[30;1m202 | [0m[35m                "headersSize": len(str(flow.response.headers)),[0m
[30;1m203 | [0m[35m                "bodySize": response_body_size,[0m
[30;1m204 | [0m[35m            }[0m

[31m--[ [0m[34mMatch #[0m[33m495[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/savehar.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m196 | [0m[35m                "content": {[0m
[30;1m197 | [0m[35m                    "size": response_body_size,[0m
[30;1m198 | [0m[35m                    "compression": response_body_compression,[0m
[30;1m199 | [0m[35m                    "mimeType": flow.response.headers.get("Content-Type", ""),[0m
[30;1m200 | [0m[35m                },[0m
[30;1m201 | [0m[35m                "redirectURL": flow.response.headers.get("Location", ""),[0m
[30;1m202 | [0m[35m                "headersSize": len(str(flow.response.headers)),[0m

[31m--[ [0m[34mMatch #[0m[33m496[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/savehar.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m50 | [0m[35m        entries = [][0m
[30;1m51 | [0m[35m        skipped = 0[0m
[30;1m52 | [0m[35m        # A list of server seen till now is maintained so we can avoid[0m
[30;1m53 | [0m[35m        # using 'connect' time for entries that use an existing connection.[0m
[30;1m54 | [0m[35m        servers_seen: set[Server] = set()[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m        for f in flows:[0m

[31m--[ [0m[34mMatch #[0m[33m497[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/savehar.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m"""Write flow objects to a HAR file"""[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35mimport json[0m
[30;1m5 | [0m[35mimport logging[0m
[30;1m6 | [0m[35mimport zlib[0m
[30;1m7 | [0m[35mfrom collections.abc import Sequence[0m

[31m--[ [0m[34mMatch #[0m[33m498[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/statusbar.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m324 | [0m[35m        listen_addrs: list[str] = list([0m
[30;1m325 | [0m[35m            dict.fromkeys([0m
[30;1m326 | [0m[35m                human.format_address(a)[0m
[30;1m327 | [0m[35m                for a in self.master.addons.get("proxyserver").listen_addrs()[0m
[30;1m328 | [0m[35m            )[0m
[30;1m329 | [0m[35m        )[0m
[30;1m330 | [0m[35m        if listen_addrs:[0m

[31m--[ [0m[34mMatch #[0m[33m499[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/statusbar.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35mclass StatusBar(urwid.WidgetWrap):[0m
[30;1m188 | [0m[35m    REFRESHTIME = 0.5  # Timed refresh time in seconds[0m
[30;1m189 | [0m[35m    keyctx = ""[0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m    def __init__(self, master: mitmproxy.tools.console.master.ConsoleMaster) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m500[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/server_side_events.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m    def response(self, flow: http.HTTPFlow):[0m
[30;1m15 | [0m[35m        assert flow.response[0m
[30;1m16 | [0m[35m        is_sse = flow.response.headers.get("content-type", "").startswith([0m
[30;1m17 | [0m[35m            "text/event-stream"[0m
[30;1m18 | [0m[35m        )[0m
[30;1m19 | [0m[35m        if is_sse and not flow.response.stream:[0m

[31m--[ [0m[34mMatch #[0m[33m501[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/overlay.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m134 | [0m[35m            signals.pop_view_state.send()[0m
[30;1m135 | [0m[35m            return[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35m        binding = self.master.keymap.get("global", key)[0m
[30;1m138 | [0m[35m        # This is extremely awkward. We need a better way to match nav keys only.[0m
[30;1m139 | [0m[35m        if binding and binding.command.startswith("console.nav"):[0m
[30;1m140 | [0m[35m            self.master.keymap.handle("global", key)[0m

[31m--[ [0m[34mMatch #[0m[33m502[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/mode_specs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m102 | [0m[35m        """[0m
[30;1m103 | [0m[35m        head, _, listen_at = spec.rpartition("@")[0m
[30;1m104 | [0m[35m        if not head:[0m
[30;1m105 | [0m[35m            head = listen_at[0m
[30;1m106 | [0m[35m            listen_at = ""[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35m        mode, _, data = head.partition(":")[0m

[31m--[ [0m[34mMatch #[0m[33m503[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/server_spec.py[0m
   Pattern: [32m.hostname[0m
[30;1m64 | [0m[35m    if host.startswith("[") and host.endswith("]"):[0m
[30;1m65 | [0m[35m        host = host[1:-1][0m
[30;1m66 | [0m[35m    if not check.is_valid_host(host):[0m
[30;1m67 | [0m[35m        raise ValueError(f"Invalid hostname: {host}")[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m    if m.group("port"):[0m
[30;1m70 | [0m[35m        port = int(m.group("port"))[0m

[31m--[ [0m[34mMatch #[0m[33m504[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/server_spec.py[0m
   Pattern: [32m.hostname[0m
[30;1m17 | [0m[35m    r"""[0m
[30;1m18 | [0m[35m        ^[0m
[30;1m19 | [0m[35m        (?:(?P<scheme>\w+)://)?  # scheme is optional[0m
[30;1m20 | [0m[35m        (?P<host>[^:/]+|\[.+\])  # hostname can be DNS name, IPv4, or IPv6 address.[0m
[30;1m21 | [0m[35m        (?::(?P<port>\d+))?  #  port is optional[0m
[30;1m22 | [0m[35m        /?  #  we allow a trailing backslash, but no path[0m
[30;1m23 | [0m[35m        $[0m

[31m--[ [0m[34mMatch #[0m[33m505[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contentviews/grpc.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1018 | [0m[35m        - the filter expression '~s' matches all flows with a response[0m
[30;1m1019 | [0m[35m[0m
[30;1m1020 | [0m[35m        In result, for complete flows (with a gRPC message in the request and the response), ParserR[0m
[30;1m1021 | [0m[35m        either be applied to request and response at the same time ('~s') or neither would match req[0m
[30;1m1022 | [0m[35m        response (~q).[0m
[30;1m1023 | [0m[35m[0m
[30;1m1024 | [0m[35m        To distinguish between rules which should be applied to response messages, request messages [0m

[31m--[ [0m[34mMatch #[0m[33m506[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contentviews/grpc.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m165 | [0m[35m                # the Kaitai parser for protobuf support base128 le values up[0m
[30;1m166 | [0m[35m                # to 8 groups (bytes). Due to the nature of the encoding, each[0m
[30;1m167 | [0m[35m                # group attributes 7bit to the resulting value, which give[0m
[30;1m168 | [0m[35m                # a 56 bit value at maximum.[0m
[30;1m169 | [0m[35m                # The values which get encoded into protobuf variable length integers,[0m
[30;1m170 | [0m[35m                # on the other hand, include full 64bit types (int64, uint64, sint64).[0m
[30;1m171 | [0m[35m                # This means, the Kaitai encoder can not cover the full range of[0m

[31m--[ [0m[34mMatch #[0m[33m507[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contentviews/grpc.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1018 | [0m[35m        - the filter expression '~s' matches all flows with a response[0m
[30;1m1019 | [0m[35m[0m
[30;1m1020 | [0m[35m        In result, for complete flows (with a gRPC message in the request and the response), ParserR[0m
[30;1m1021 | [0m[35m        either be applied to request and response at the same time ('~s') or neither would match req[0m
[30;1m1022 | [0m[35m        response (~q).[0m
[30;1m1023 | [0m[35m[0m
[30;1m1024 | [0m[35m        To distinguish between rules which should be applied to response messages, request messages [0m

[31m--[ [0m[34mMatch #[0m[33m508[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/commands.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m64 | [0m[35m        return self.focus_obj, self.index[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m    def set_focus(self, index: int) -> None:[0m
[30;1m67 | [0m[35m        cmd = self.cmds[index][0m
[30;1m68 | [0m[35m        self.index = index[0m
[30;1m69 | [0m[35m        self.focus_obj = self._get(self.index)[0m
[30;1m70 | [0m[35m        command_focus_change.send(cmd.help or "")[0m

[31m--[ [0m[34mMatch #[0m[33m509[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/commands.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m57 | [0m[35m        return self.focus_obj.get_edit_text()[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m    def _get(self, pos):[0m
[30;1m60 | [0m[35m        cmd = self.cmds[pos][0m
[30;1m61 | [0m[35m        return CommandItem(self, cmd, pos == self.index)[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m    def get_focus(self):[0m

[31m--[ [0m[34mMatch #[0m[33m510[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/utils/magisk.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35mdef subject_hash_old(ca: x509.Certificate) -> str:[0m
[30;1m89 | [0m[35m    # Mimics the -subject_hash_old option of openssl used for android certificate names[0m
[30;1m90 | [0m[35m    full_hash = hashlib.md5(ca.subject.public_bytes()).digest()[0m
[30;1m91 | [0m[35m    sho = full_hash[0] | (full_hash[1] << 8) | (full_hash[2] << 16) | full_hash[3] << 24[0m
[30;1m92 | [0m[35m    return hex(sho)[2:][0m

[31m--[ [0m[34mMatch #[0m[33m511[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/utils/magisk.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35mOUTFD=$2[0m
[30;1m65 | [0m[35mZIPFILE=$3[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35mmount /data 2>/dev/null[0m
[30;1m68 | [0m[35m[ -f /data/adb/magisk/util_functions.sh ] || require_new_magisk[0m
[30;1m69 | [0m[35m. /data/adb/magisk/util_functions.sh[0m
[30;1m70 | [0m[35m[ $MAGISK_VER_CODE -lt 20400 ] && require_new_magisk[0m

[31m--[ [0m[34mMatch #[0m[33m512[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/tls.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m247 | [0m[35m        # client has no cert to present, we're notified and proceed as usual.[0m
[30;1m248 | [0m[35m        # Unfortunately, Android seems to have a bug (tested on 4.2.2) - when[0m
[30;1m249 | [0m[35m        # an Android client is asked to present a certificate it does not[0m
[30;1m250 | [0m[35m        # have, it hangs up, which is frankly bogus. Some time down the track[0m
[30;1m251 | [0m[35m        # we may be able to make the proper behaviour the default again, but[0m
[30;1m252 | [0m[35m        # until then we're conservative.[0m
[30;1m253 | [0m[35m        context.set_verify(Verify.VERIFY_PEER.value, accept_all)[0m

[31m--[ [0m[34mMatch #[0m[33m513[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/tls.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m70 | [0m[35m@cache[0m
[30;1m71 | [0m[35mdef is_supported_version(version: Version):[0m
[30;1m72 | [0m[35m    client_ctx = SSL.Context(SSL.TLS_CLIENT_METHOD)[0m
[30;1m73 | [0m[35m    # Without SECLEVEL, recent OpenSSL versions forbid old TLS versions.[0m
[30;1m74 | [0m[35m    # https://github.com/pyca/cryptography/issues/9523[0m
[30;1m75 | [0m[35m    client_ctx.set_cipher_list(b"@SECLEVEL=0:ALL")[0m
[30;1m76 | [0m[35m    client_ctx.set_min_proto_version(version.value)[0m

[31m--[ [0m[34mMatch #[0m[33m514[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/tls.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mimport certifi[0m
[30;1m13 | [0m[35mfrom OpenSSL import crypto[0m
[30;1m14 | [0m[35mfrom OpenSSL import SSL[0m
[30;1m15 | [0m[35mfrom OpenSSL.crypto import X509[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mfrom mitmproxy import certs[0m

[31m--[ [0m[34mMatch #[0m[33m515[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/tls.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35mfrom typing import BinaryIO[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mimport certifi[0m
[30;1m13 | [0m[35mfrom OpenSSL import crypto[0m
[30;1m14 | [0m[35mfrom OpenSSL import SSL[0m
[30;1m15 | [0m[35mfrom OpenSSL.crypto import X509[0m
[30;1m16 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m516[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/utils/asyncio_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m) -> None:[0m
[30;1m44 | [0m[35m    """Set debug info for an externally-spawned task."""[0m
[30;1m45 | [0m[35m    task.created = time.time()  # type: ignore[0m
[30;1m46 | [0m[35m    if __debug__ is True and (test := os.environ.get("PYTEST_CURRENT_TEST", None)):[0m
[30;1m47 | [0m[35m        name = f"{name} [created in {test}]"[0m
[30;1m48 | [0m[35m    task.set_name(name)[0m
[30;1m49 | [0m[35m    if client:[0m

[31m--[ [0m[34mMatch #[0m[33m517[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/utils/asyncio_utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m29 | [0m[35m    set_task_debug_info(t, name=name, client=client)[0m
[30;1m30 | [0m[35m    if keep_ref and not t.done():[0m
[30;1m31 | [0m[35m        # The event loop only keeps weak references to tasks.[0m
[30;1m32 | [0m[35m        # A task that isn’t referenced elsewhere may get garbage collected at any time, even before [0m
[30;1m33 | [0m[35m        _KEEP_ALIVE.add(t)[0m
[30;1m34 | [0m[35m        t.add_done_callback(_KEEP_ALIVE.discard)[0m
[30;1m35 | [0m[35m    return t[0m

[31m--[ [0m[34mMatch #[0m[33m518[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/utils/asyncio_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport asyncio[0m
[30;1m2 | [0m[35mimport os[0m
[30;1m3 | [0m[35mimport sys[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35mfrom collections.abc import Coroutine[0m
[30;1m6 | [0m[35mfrom collections.abc import Iterator[0m
[30;1m7 | [0m[35mfrom contextlib import contextmanager[0m
[30;1m8 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m519[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/flowdetailview.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m117 | [0m[35m            )[0m
[30;1m118 | [0m[35m        parts.append(("Client conn. closed", maybe_timestamp(cc, "timestamp_end")))[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m    if sc is not None and sc.timestamp_start:[0m
[30;1m121 | [0m[35m        parts.append(("Server conn. initiated", maybe_timestamp(sc, "timestamp_start")))[0m
[30;1m122 | [0m[35m        parts.append([0m
[30;1m123 | [0m[35m            ("Server conn. TCP handshake", maybe_timestamp(sc, "timestamp_tcp_setup"))[0m

[31m--[ [0m[34mMatch #[0m[33m520[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/flowdetailview.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m44 | [0m[35m        text.append(urwid.Text([("head", "Metadata:")]))[0m
[30;1m45 | [0m[35m        text.extend(common.format_keyvals(parts, indent=4))[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    if sc is not None and sc.peername:[0m
[30;1m48 | [0m[35m        text.append(urwid.Text([("head", "Server Connection:")]))[0m
[30;1m49 | [0m[35m        parts = [[0m
[30;1m50 | [0m[35m            ("Address", human.format_address(sc.address)),[0m

[31m--[ [0m[34mMatch #[0m[33m521[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/flowdetailview.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m23 | [0m[35mdef flowdetails(state, flow: mitmproxy.flow.Flow):[0m
[30;1m24 | [0m[35m    text = [][0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    sc = flow.server_conn[0m
[30;1m27 | [0m[35m    cc = flow.client_conn[0m
[30;1m28 | [0m[35m    req: http.Request | None[0m
[30;1m29 | [0m[35m    resp: http.Response | None[0m

[31m--[ [0m[34mMatch #[0m[33m522[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/flowdetailview.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m13 | [0m[35m        return human.format_timestamp_with_milli(getattr(base, attr))[0m
[30;1m14 | [0m[35m    else:[0m
[30;1m15 | [0m[35m        # in mitmdump we serialize before a connection is closed.[0m
[30;1m16 | [0m[35m        # loading those flows at a later point shouldn't display "active".[0m
[30;1m17 | [0m[35m        # We also use a ndash (and not a regular dash) so that it is sorted[0m
[30;1m18 | [0m[35m        # after other timestamps. We may need to revisit that in the future if it turns out[0m
[30;1m19 | [0m[35m        # to render ugly in consoles.[0m

[31m--[ [0m[34mMatch #[0m[33m523[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/flowdetailview.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m140 | [0m[35m        parts.append(("Response complete", maybe_timestamp(resp, "timestamp_end")))[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m    if parts:[0m
[30;1m143 | [0m[35m        # sort operations by timestamp[0m
[30;1m144 | [0m[35m        parts = sorted(parts, key=lambda p: p[1])[0m
[30;1m145 | [0m[35m[0m
[30;1m146 | [0m[35m        text.append(urwid.Text([("head", "Timing:")]))[0m

[31m--[ [0m[34mMatch #[0m[33m524[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/coretypes/serializable.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m71 | [0m[35m        fields = [][0m
[30;1m72 | [0m[35m        # noinspection PyDataclass[0m
[30;1m73 | [0m[35m        for field in dataclasses.fields(cls):  # type: ignore[arg-type][0m
[30;1m74 | [0m[35m            if field.metadata.get("serialize", True) is False:[0m
[30;1m75 | [0m[35m                continue[0m
[30;1m76 | [0m[35m            if isinstance(field.type, str):[0m
[30;1m77 | [0m[35m                field.type = hints[field.name][0m

[31m--[ [0m[34mMatch #[0m[33m525[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/utils/typecheck.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m7 | [0m[35m    UnionType = object()  # type: ignore[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mType = typing.Union[[0m
[30;1m10 | [0m[35m    typing.Any  # anything more elaborate really fails with mypy at the moment.[0m
[30;1m11 | [0m[35m][0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m526[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/palettes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m98 | [0m[35m        lst: list[Sequence[str | None]] = [][0m
[30;1m99 | [0m[35m        highback, lowback = None, None[0m
[30;1m100 | [0m[35m        if not transparent:[0m
[30;1m101 | [0m[35m            if self.high and self.high.get("background"):[0m
[30;1m102 | [0m[35m                highback = self.high["background"][1][0m
[30;1m103 | [0m[35m            lowback = self.low["background"][1][0m
[30;1m104 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m527[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/http.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1088 | [0m[35m        resp = cls([0m
[30;1m1089 | [0m[35m            b"HTTP/1.1",[0m
[30;1m1090 | [0m[35m            status_code,[0m
[30;1m1091 | [0m[35m            status_codes.RESPONSES.get(status_code, "").encode(),[0m
[30;1m1092 | [0m[35m            headers,[0m
[30;1m1093 | [0m[35m            None,[0m
[30;1m1094 | [0m[35m            None,[0m

[31m--[ [0m[34mMatch #[0m[33m528[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/http.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1047 | [0m[35m[0m
[30;1m1048 | [0m[35m    def __repr__(self) -> str:[0m
[30;1m1049 | [0m[35m        if self.raw_content:[0m
[30;1m1050 | [0m[35m            ct = self.headers.get("content-type", "unknown content type")[0m
[30;1m1051 | [0m[35m            size = human.pretty_size(len(self.raw_content))[0m
[30;1m1052 | [0m[35m            details = f"{ct}, {size}"[0m
[30;1m1053 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m529[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/http.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m969 | [0m[35m        return [][0m
[30;1m970 | [0m[35m[0m
[30;1m971 | [0m[35m    def _set_multipart_form(self, value: list[tuple[bytes, bytes]]) -> None:[0m
[30;1m972 | [0m[35m        ct = self.headers.get("content-type", "")[0m
[30;1m973 | [0m[35m        is_valid_content_type = ct.lower().startswith("multipart/form-data")[0m
[30;1m974 | [0m[35m        if not is_valid_content_type:[0m
[30;1m975 | [0m[35m            """[0m

[31m--[ [0m[34mMatch #[0m[33m530[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/http.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m962 | [0m[35m        if is_valid_content_type and self.content is not None:[0m
[30;1m963 | [0m[35m            try:[0m
[30;1m964 | [0m[35m                return multipart.decode_multipart([0m
[30;1m965 | [0m[35m                    self.headers.get("content-type"), self.content[0m
[30;1m966 | [0m[35m                )[0m
[30;1m967 | [0m[35m            except ValueError:[0m
[30;1m968 | [0m[35m                pass[0m

[31m--[ [0m[34mMatch #[0m[33m531[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/http.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m957 | [0m[35m[0m
[30;1m958 | [0m[35m    def _get_multipart_form(self) -> list[tuple[bytes, bytes]]:[0m
[30;1m959 | [0m[35m        is_valid_content_type = ([0m
[30;1m960 | [0m[35m            "multipart/form-data" in self.headers.get("content-type", "").lower()[0m
[30;1m961 | [0m[35m        )[0m
[30;1m962 | [0m[35m        if is_valid_content_type and self.content is not None:[0m
[30;1m963 | [0m[35m            try:[0m

[31m--[ [0m[34mMatch #[0m[33m532[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/http.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m923 | [0m[35m    def _get_urlencoded_form(self):[0m
[30;1m924 | [0m[35m        is_valid_content_type = ([0m
[30;1m925 | [0m[35m            "application/x-www-form-urlencoded"[0m
[30;1m926 | [0m[35m            in self.headers.get("content-type", "").lower()[0m
[30;1m927 | [0m[35m        )[0m
[30;1m928 | [0m[35m        if is_valid_content_type:[0m
[30;1m929 | [0m[35m            return tuple(url.decode(self.get_text(strict=False)))[0m

[31m--[ [0m[34mMatch #[0m[33m533[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/http.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m912 | [0m[35m        """[0m
[30;1m913 | [0m[35m        Limits the permissible Accept-Encoding values, based on what we can decode appropriately.[0m
[30;1m914 | [0m[35m        """[0m
[30;1m915 | [0m[35m        accept_encoding = self.headers.get("accept-encoding")[0m
[30;1m916 | [0m[35m        if accept_encoding:[0m
[30;1m917 | [0m[35m            self.headers["accept-encoding"] = ", ".join([0m
[30;1m918 | [0m[35m                e[0m

[31m--[ [0m[34mMatch #[0m[33m534[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/http.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m727 | [0m[35m        if self.is_http2 or self.is_http3:[0m
[30;1m728 | [0m[35m            return self.authority or self.data.headers.get("Host", None)[0m
[30;1m729 | [0m[35m        else:[0m
[30;1m730 | [0m[35m            return self.data.headers.get("Host", None)[0m
[30;1m731 | [0m[35m[0m
[30;1m732 | [0m[35m    @host_header.setter[0m
[30;1m733 | [0m[35m    def host_header(self, val: None | str | bytes) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m535[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/http.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m725 | [0m[35m        *See also:* `Request.authority`,`Request.host`, `Request.pretty_host`[0m
[30;1m726 | [0m[35m        """[0m
[30;1m727 | [0m[35m        if self.is_http2 or self.is_http3:[0m
[30;1m728 | [0m[35m            return self.authority or self.data.headers.get("Host", None)[0m
[30;1m729 | [0m[35m        else:[0m
[30;1m730 | [0m[35m            return self.data.headers.get("Host", None)[0m
[30;1m731 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m536[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/http.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m430 | [0m[35m        content = self.get_content(strict)[0m
[30;1m431 | [0m[35m        if content is None:[0m
[30;1m432 | [0m[35m            return None[0m
[30;1m433 | [0m[35m        enc = infer_content_encoding(self.headers.get("content-type", ""), content)[0m
[30;1m434 | [0m[35m        try:[0m
[30;1m435 | [0m[35m            return cast(str, encoding.decode(content, enc))[0m
[30;1m436 | [0m[35m        except ValueError:[0m

[31m--[ [0m[34mMatch #[0m[33m537[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/http.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m412 | [0m[35m            self.content = cast(bytes, encoding.encode(text, enc))[0m
[30;1m413 | [0m[35m        except ValueError:[0m
[30;1m414 | [0m[35m            # Fall back to UTF-8 and update the content-type header.[0m
[30;1m415 | [0m[35m            ct = parse_content_type(self.headers.get("content-type", "")) or ([0m
[30;1m416 | [0m[35m                "text",[0m
[30;1m417 | [0m[35m                "plain",[0m
[30;1m418 | [0m[35m                {},[0m

[31m--[ [0m[34mMatch #[0m[33m538[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/http.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m406 | [0m[35m        if text is None:[0m
[30;1m407 | [0m[35m            self.content = None[0m
[30;1m408 | [0m[35m            return[0m
[30;1m409 | [0m[35m        enc = infer_content_encoding(self.headers.get("content-type", ""))[0m
[30;1m410 | [0m[35m[0m
[30;1m411 | [0m[35m        try:[0m
[30;1m412 | [0m[35m            self.content = cast(bytes, encoding.encode(text, enc))[0m

[31m--[ [0m[34mMatch #[0m[33m539[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/http.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m387 | [0m[35m        """[0m
[30;1m388 | [0m[35m        if self.raw_content is None:[0m
[30;1m389 | [0m[35m            return None[0m
[30;1m390 | [0m[35m        ce = self.headers.get("content-encoding")[0m
[30;1m391 | [0m[35m        if ce:[0m
[30;1m392 | [0m[35m            try:[0m
[30;1m393 | [0m[35m                content = encoding.decode(self.raw_content, ce)[0m

[31m--[ [0m[34mMatch #[0m[33m540[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/http.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m364 | [0m[35m                f"Message content must be bytes, not {type(value).__name__}. "[0m
[30;1m365 | [0m[35m                "Please use .text if you want to assign a str."[0m
[30;1m366 | [0m[35m            )[0m
[30;1m367 | [0m[35m        ce = self.headers.get("content-encoding")[0m
[30;1m368 | [0m[35m        try:[0m
[30;1m369 | [0m[35m            self.raw_content = encoding.encode(value, ce or "identity")[0m
[30;1m370 | [0m[35m        except ValueError:[0m

[31m--[ [0m[34mMatch #[0m[33m541[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/http.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m802 | [0m[35m    def pretty_host(self) -> str:[0m
[30;1m803 | [0m[35m        """[0m
[30;1m804 | [0m[35m        *Read-only:* Like `Request.host`, but using `Request.host_header` header as an additional (p[0m
[30;1m805 | [0m[35m        This is useful in transparent mode where `Request.host` is only an IP address.[0m
[30;1m806 | [0m[35m[0m
[30;1m807 | [0m[35m        *Warning:* When working in adversarial environments, this may not reflect the actual destina[0m
[30;1m808 | [0m[35m        as the Host header could be spoofed.[0m

[31m--[ [0m[34mMatch #[0m[33m542[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/http.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m701 | [0m[35m        """[0m
[30;1m702 | [0m[35m        Target server for this request. This may be parsed from the raw request[0m
[30;1m703 | [0m[35m        (e.g. from a ``GET http://example.com/ HTTP/1.1`` request line)[0m
[30;1m704 | [0m[35m        or inferred from the proxy mode (e.g. an IP in transparent mode).[0m
[30;1m705 | [0m[35m[0m
[30;1m706 | [0m[35m        Setting the host attribute also updates the host header and authority information, if presen[0m
[30;1m707 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m543[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/http.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport binascii[0m
[30;1m2 | [0m[35mimport json[0m
[30;1m3 | [0m[35mimport os[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35mimport urllib.parse[0m
[30;1m6 | [0m[35mimport warnings[0m
[30;1m7 | [0m[35mfrom collections.abc import Callable[0m
[30;1m8 | [0m[35mfrom collections.abc import Iterable[0m

[31m--[ [0m[34mMatch #[0m[33m544[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/http.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1153 | [0m[35m        The response cookies. A possibly empty `MultiDictView`, where the keys are cookie[0m
[30;1m1154 | [0m[35m        name strings, and values are `(cookie value, attributes)` tuples. Within[0m
[30;1m1155 | [0m[35m        attributes, unary attributes (e.g. `HTTPOnly`) are indicated by a `None` value.[0m
[30;1m1156 | [0m[35m        Modifications to the MultiDictView update `Response.headers`, and vice versa.[0m
[30;1m1157 | [0m[35m[0m
[30;1m1158 | [0m[35m        *Warning:* Changes to `attributes` will not be picked up unless you also reassign[0m
[30;1m1159 | [0m[35m        the `(cookie value, attributes)` tuple directly in the `MultiDictView`.[0m

[31m--[ [0m[34mMatch #[0m[33m545[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/http.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1096 | [0m[35m            time.time(),[0m
[30;1m1097 | [0m[35m        )[0m
[30;1m1098 | [0m[35m[0m
[30;1m1099 | [0m[35m        # Assign this manually to update the content-length header.[0m
[30;1m1100 | [0m[35m        if isinstance(content, bytes):[0m
[30;1m1101 | [0m[35m            resp.content = content[0m
[30;1m1102 | [0m[35m        elif isinstance(content, str):[0m

[31m--[ [0m[34mMatch #[0m[33m546[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/http.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m992 | [0m[35m        If the content-type indicates non-form data or the form could not be parsed, this is set to[0m
[30;1m993 | [0m[35m        an empty `MultiDictView`.[0m
[30;1m994 | [0m[35m[0m
[30;1m995 | [0m[35m        Modifications to the MultiDictView update `Request.content`, and vice versa.[0m
[30;1m996 | [0m[35m        """[0m
[30;1m997 | [0m[35m        return multidict.MultiDictView([0m
[30;1m998 | [0m[35m            self._get_multipart_form, self._set_multipart_form[0m

[31m--[ [0m[34mMatch #[0m[33m547[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/http.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m945 | [0m[35m        If the content-type indicates non-form data or the form could not be parsed, this is set to[0m
[30;1m946 | [0m[35m        an empty `MultiDictView`.[0m
[30;1m947 | [0m[35m[0m
[30;1m948 | [0m[35m        Modifications to the MultiDictView update `Request.content`, and vice versa.[0m
[30;1m949 | [0m[35m        """[0m
[30;1m950 | [0m[35m        return multidict.MultiDictView([0m
[30;1m951 | [0m[35m            self._get_urlencoded_form, self._set_urlencoded_form[0m

[31m--[ [0m[34mMatch #[0m[33m548[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/http.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m864 | [0m[35m        """[0m
[30;1m865 | [0m[35m        The request cookies.[0m
[30;1m866 | [0m[35m        For the most part, this behaves like a dictionary.[0m
[30;1m867 | [0m[35m        Modifications to the MultiDictView update `Request.headers`, and vice versa.[0m
[30;1m868 | [0m[35m        """[0m
[30;1m869 | [0m[35m        return multidict.MultiDictView(self._get_cookies, self._set_cookies)[0m
[30;1m870 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m549[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/http.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m844 | [0m[35m        """[0m
[30;1m845 | [0m[35m        The request query as a mutable mapping view on the request's path.[0m
[30;1m846 | [0m[35m        For the most part, this behaves like a dictionary.[0m
[30;1m847 | [0m[35m        Modifications to the MultiDictView update `Request.path`, and vice versa.[0m
[30;1m848 | [0m[35m        """[0m
[30;1m849 | [0m[35m        return multidict.MultiDictView(self._get_query, self._set_query)[0m
[30;1m850 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m550[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/http.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m763 | [0m[35m        # Update host header[0m
[30;1m764 | [0m[35m        if "Host" in self.data.headers:[0m
[30;1m765 | [0m[35m            self.data.headers["Host"] = val[0m
[30;1m766 | [0m[35m        # Update authority[0m
[30;1m767 | [0m[35m        if self.data.authority:[0m
[30;1m768 | [0m[35m            self.authority = val[0m
[30;1m769 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m551[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/http.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m760 | [0m[35m    def _update_host_and_authority(self) -> None:[0m
[30;1m761 | [0m[35m        val = url.hostport(self.scheme, self.host, self.port)[0m
[30;1m762 | [0m[35m[0m
[30;1m763 | [0m[35m        # Update host header[0m
[30;1m764 | [0m[35m        if "Host" in self.data.headers:[0m
[30;1m765 | [0m[35m            self.data.headers["Host"] = val[0m
[30;1m766 | [0m[35m        # Update authority[0m

[31m--[ [0m[34mMatch #[0m[33m552[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/http.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m621 | [0m[35m        )[0m
[30;1m622 | [0m[35m[0m
[30;1m623 | [0m[35m        req.url = url[0m
[30;1m624 | [0m[35m        # Assign this manually to update the content-length header.[0m
[30;1m625 | [0m[35m        if isinstance(content, bytes):[0m
[30;1m626 | [0m[35m            req.content = content[0m
[30;1m627 | [0m[35m        elif isinstance(content, str):[0m

[31m--[ [0m[34mMatch #[0m[33m553[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/http.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m411 | [0m[35m        try:[0m
[30;1m412 | [0m[35m            self.content = cast(bytes, encoding.encode(text, enc))[0m
[30;1m413 | [0m[35m        except ValueError:[0m
[30;1m414 | [0m[35m            # Fall back to UTF-8 and update the content-type header.[0m
[30;1m415 | [0m[35m            ct = parse_content_type(self.headers.get("content-type", "")) or ([0m
[30;1m416 | [0m[35m                "text",[0m
[30;1m417 | [0m[35m                "plain",[0m

[31m--[ [0m[34mMatch #[0m[33m554[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/master.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m    @property[0m
[30;1m99 | [0m[35m    def web_url(self) -> str:[0m
[30;1m100 | [0m[35m        return cast(webaddons.WebAuth, self.addons.get("webauth")).web_url[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m    async def running(self):[0m
[30;1m103 | [0m[35m        # Register tornado with the current event loop[0m

[31m--[ [0m[34mMatch #[0m[33m555[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/master.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m51 | [0m[35m            errorcheck.ErrorCheck(),[0m
[30;1m52 | [0m[35m        )[0m
[30;1m53 | [0m[35m        self.app = app.Application(self, self.options.web_debug)[0m
[30;1m54 | [0m[35m        self.proxyserver: Proxyserver = self.addons.get("proxyserver")[0m
[30;1m55 | [0m[35m        self.proxyserver.servers.changed.connect(self._sig_servers_changed)[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    def _sig_view_add(self, flow: flow.Flow) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m556[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/master.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m115 | [0m[35m                message += f"\nTry specifying a different port by using `--set web_port={self.option[0m
[30;1m116 | [0m[35m            raise OSError(e.errno, message, e.filename) from e[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m        logger.info(f"Web server listening at {self.web_url}")[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m        return await super().running()[0m

[31m--[ [0m[34mMatch #[0m[33m557[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/clientplayback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m173 | [0m[35m[0m
[30;1m174 | [0m[35m    async def playback(self):[0m
[30;1m175 | [0m[35m        while True:[0m
[30;1m176 | [0m[35m            self.inflight = await self.queue.get()[0m
[30;1m177 | [0m[35m            try:[0m
[30;1m178 | [0m[35m                assert self.inflight[0m
[30;1m179 | [0m[35m                h = ReplayHandler(self.inflight, self.options)[0m

[31m--[ [0m[34mMatch #[0m[33m558[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/clientplayback.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport asyncio[0m
[30;1m4 | [0m[35mimport logging[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35mfrom collections.abc import Sequence[0m
[30;1m7 | [0m[35mfrom types import TracebackType[0m
[30;1m8 | [0m[35mfrom typing import cast[0m
[30;1m9 | [0m[35mfrom typing import Literal[0m

[31m--[ [0m[34mMatch #[0m[33m559[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/webaddons.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m133 | [0m[35m    )[0m
[30;1m134 | [0m[35m    for browser in browsers:[0m
[30;1m135 | [0m[35m        try:[0m
[30;1m136 | [0m[35m            b = webbrowser.get(browser)[0m
[30;1m137 | [0m[35m        except webbrowser.Error:[0m
[30;1m138 | [0m[35m            pass[0m
[30;1m139 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m560[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m535 | [0m[35m            private_key = self.default_privatekey[0m
[30;1m536 | [0m[35m            if cert.public_key() != private_key.public_key():[0m
[30;1m537 | [0m[35m                raise ValueError([0m
[30;1m538 | [0m[35m                    f'Unable to find private key in "{path.absolute()}": {e}'[0m
[30;1m539 | [0m[35m                ) from e[0m
[30;1m540 | [0m[35m        else:[0m
[30;1m541 | [0m[35m            if cert.public_key() != private_key.public_key():[0m

[31m--[ [0m[34mMatch #[0m[33m561[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m270 | [0m[35m        ss: list[x509.GeneralName] = [][0m
[30;1m271 | [0m[35m        for x in cast(list[str], sans):[0m
[30;1m272 | [0m[35m            try:[0m
[30;1m273 | [0m[35m                ip = ipaddress.ip_address(x)[0m
[30;1m274 | [0m[35m            except ValueError:[0m
[30;1m275 | [0m[35m                x = x.encode("idna").decode()[0m
[30;1m276 | [0m[35m                ss.append(x509.DNSName(x))[0m

[31m--[ [0m[34mMatch #[0m[33m562[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/certs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35mfrom typing import Optional[0m
[30;1m14 | [0m[35mfrom typing import Union[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35mimport OpenSSL[0m
[30;1m17 | [0m[35mfrom cryptography import x509[0m
[30;1m18 | [0m[35mfrom cryptography.hazmat.primitives import hashes[0m
[30;1m19 | [0m[35mfrom cryptography.hazmat.primitives import serialization[0m
[30;1m20 | [0m[35mfrom cryptography.hazmat.primitives.asymmetric import dsa[0m

[31m--[ [0m[34mMatch #[0m[33m563[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/block.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35m            bool,[0m
[30;1m21 | [0m[35m            False,[0m
[30;1m22 | [0m[35m            """[0m
[30;1m23 | [0m[35m            Block connections from local (private) IP addresses.[0m
[30;1m24 | [0m[35m            This option does not affect loopback addresses (connections from the local machine),[0m
[30;1m25 | [0m[35m            which are always permitted.[0m
[30;1m26 | [0m[35m            """,[0m

[31m--[ [0m[34mMatch #[0m[33m564[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/block.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35m            bool,[0m
[30;1m13 | [0m[35m            True,[0m
[30;1m14 | [0m[35m            """[0m
[30;1m15 | [0m[35m            Block connections from public IP addresses.[0m
[30;1m16 | [0m[35m            """,[0m
[30;1m17 | [0m[35m        )[0m
[30;1m18 | [0m[35m        loader.add_option([0m

[31m--[ [0m[34mMatch #[0m[33m565[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static_viewer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35mclass StaticViewer:[0m
[30;1m87 | [0m[35m    # TODO: make this a command at some point.[0m
[30;1m88 | [0m[35m    def load(self, loader):[0m
[30;1m89 | [0m[35m        loader.add_option([0m
[30;1m90 | [0m[35m            "web_static_viewer",[0m

[31m--[ [0m[34mMatch #[0m[33m566[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static_viewer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mimport os.path[0m
[30;1m4 | [0m[35mimport pathlib[0m
[30;1m5 | [0m[35mimport shutil[0m
[30;1m6 | [0m[35mimport time[0m
[30;1m7 | [0m[35mfrom collections.abc import Iterable[0m
[30;1m8 | [0m[35mfrom typing import Optional[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mfrom mitmproxy import contentviews[0m

[31m--[ [0m[34mMatch #[0m[33m567[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/serverplayback.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m217 | [0m[35m        if ctx.options.server_replay_use_headers:[0m
[30;1m218 | [0m[35m            headers = [][0m
[30;1m219 | [0m[35m            for i in ctx.options.server_replay_use_headers:[0m
[30;1m220 | [0m[35m                v = r.headers.get(i)[0m
[30;1m221 | [0m[35m                headers.append((i, v))[0m
[30;1m222 | [0m[35m            key.append(headers)[0m
[30;1m223 | [0m[35m        return hashlib.sha256(repr(key).encode("utf8", "surrogateescape")).digest()[0m

[31m--[ [0m[34mMatch #[0m[33m568[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/serverplayback.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m255 | [0m[35m            )[0m
[30;1m256 | [0m[35m        if ctx.options.server_replay_nopop:  # pragma: no cover[0m
[30;1m257 | [0m[35m            logger.error([0m
[30;1m258 | [0m[35m                "server_replay_nopop has been renamed to server_replay_reuse, please update your con[0m
[30;1m259 | [0m[35m            )[0m
[30;1m260 | [0m[35m        if not self.configured and ctx.options.server_replay:[0m
[30;1m261 | [0m[35m            self.configured = True[0m

[31m--[ [0m[34mMatch #[0m[33m569[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/serverplayback.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m251 | [0m[35m        if ctx.options.server_replay_kill_extra:[0m
[30;1m252 | [0m[35m            logger.warning([0m
[30;1m253 | [0m[35m                "server_replay_kill_extra has been deprecated, "[0m
[30;1m254 | [0m[35m                "please update your config to use server_replay_extra='kill'."[0m
[30;1m255 | [0m[35m            )[0m
[30;1m256 | [0m[35m        if ctx.options.server_replay_nopop:  # pragma: no cover[0m
[30;1m257 | [0m[35m            logger.error([0m

[31m--[ [0m[34mMatch #[0m[33m570[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m804 | [0m[35m        self, master: mitmproxy.tools.web.master.WebMaster, debug: bool[0m
[30;1m805 | [0m[35m    ) -> None:[0m
[30;1m806 | [0m[35m        self.master = master[0m
[30;1m807 | [0m[35m        auth_addon: WebAuth = master.addons.get("webauth")[0m
[30;1m808 | [0m[35m        super().__init__([0m
[30;1m809 | [0m[35m            handlers=handlers,  # type: ignore  # https://github.com/tornadoweb/tornado/pull/3455[0m
[30;1m810 | [0m[35m            template_path=os.path.join(os.path.dirname(__file__), "templates"),[0m

[31m--[ [0m[34mMatch #[0m[33m571[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m611 | [0m[35m        flow = self.flow[0m
[30;1m612 | [0m[35m        assert isinstance(flow, (HTTPFlow, TCPFlow, UDPFlow))[0m
[30;1m613 | [0m[35m[0m
[30;1m614 | [0m[35m        if self.request.arguments.get("lines"):[0m
[30;1m615 | [0m[35m            max_lines = int(self.request.arguments["lines"][0])[0m
[30;1m616 | [0m[35m        else:[0m
[30;1m617 | [0m[35m            max_lines = None[0m

[31m--[ [0m[34mMatch #[0m[33m572[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m569 | [0m[35m        message = getattr(self.flow, message)[0m
[30;1m570 | [0m[35m        assert isinstance(self.flow, HTTPFlow)[0m
[30;1m571 | [0m[35m[0m
[30;1m572 | [0m[35m        original_cd = message.headers.get("Content-Disposition", None)[0m
[30;1m573 | [0m[35m        filename = None[0m
[30;1m574 | [0m[35m        if original_cd:[0m
[30;1m575 | [0m[35m            if m := re.search(r'filename=([-\w" .()]+)', original_cd):[0m

[31m--[ [0m[34mMatch #[0m[33m573[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m348 | [0m[35m        else:[0m
[30;1m349 | [0m[35m            raise APIError([0m
[30;1m350 | [0m[35m                status_codes.PRECONDITION_FAILED,[0m
[30;1m351 | [0m[35m                f"Unexpected Sec-Fetch-Mode header: {self.request.headers.get('Sec-Fetch-Mode')}",[0m
[30;1m352 | [0m[35m            )[0m
[30;1m353 | [0m[35m[0m
[30;1m354 | [0m[35m    post = get  # login form[0m

[31m--[ [0m[34mMatch #[0m[33m574[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m333 | [0m[35mclass IndexHandler(RequestHandler):[0m
[30;1m334 | [0m[35m    def _is_fetch_mode_navigate(self) -> bool:[0m
[30;1m335 | [0m[35m        # Forbid access for non-navigate fetch modes so that they can't obtain xsrf_token.[0m
[30;1m336 | [0m[35m        return self.request.headers.get("Sec-Fetch-Mode", "navigate") == "navigate"[0m
[30;1m337 | [0m[35m[0m
[30;1m338 | [0m[35m    def auth_fail(self, invalid_password: bool) -> None:[0m
[30;1m339 | [0m[35m        # For mitmweb, we only write a login form for IndexHandler,[0m

[31m--[ [0m[34mMatch #[0m[33m575[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m285 | [0m[35m[0m
[30;1m286 | [0m[35m    @property[0m
[30;1m287 | [0m[35m    def json(self):[0m
[30;1m288 | [0m[35m        if not self.request.headers.get("Content-Type", "").startswith([0m
[30;1m289 | [0m[35m            "application/json"[0m
[30;1m290 | [0m[35m        ):[0m
[30;1m291 | [0m[35m            raise APIError(400, "Invalid Content-Type, expected application/json.")[0m

[31m--[ [0m[34mMatch #[0m[33m576[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/app.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m80 | [0m[35m        "is_replay": flow.is_replay,[0m
[30;1m81 | [0m[35m        "type": flow.type,[0m
[30;1m82 | [0m[35m        "modified": flow.modified(),[0m
[30;1m83 | [0m[35m        "marked": emoji.get(flow.marked, "🔴") if flow.marked else "",[0m
[30;1m84 | [0m[35m        "comment": flow.comment,[0m
[30;1m85 | [0m[35m        "timestamp_created": flow.timestamp_created,[0m
[30;1m86 | [0m[35m    }[0m

[31m--[ [0m[34mMatch #[0m[33m577[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/app.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m692 | [0m[35m        self.write(optmanager.dump_dicts(self.master.options))[0m
[30;1m693 | [0m[35m[0m
[30;1m694 | [0m[35m    def put(self):[0m
[30;1m695 | [0m[35m        update = self.json[0m
[30;1m696 | [0m[35m        try:[0m
[30;1m697 | [0m[35m            self.master.options.update(**update)[0m
[30;1m698 | [0m[35m        except Exception as err:[0m

[31m--[ [0m[34mMatch #[0m[33m578[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/app.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m643 | [0m[35mclass Commands(RequestHandler):[0m
[30;1m644 | [0m[35m    def get(self) -> None:[0m
[30;1m645 | [0m[35m        commands = {}[0m
[30;1m646 | [0m[35m        for name, cmd in self.master.commands.commands.items():[0m
[30;1m647 | [0m[35m            commands[name] = {[0m
[30;1m648 | [0m[35m                "help": cmd.help,[0m
[30;1m649 | [0m[35m                "parameters": [[0m

[31m--[ [0m[34mMatch #[0m[33m579[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/app.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m532 | [0m[35m                elif a == "comment":[0m
[30;1m533 | [0m[35m                    flow.comment = b[0m
[30;1m534 | [0m[35m                else:[0m
[30;1m535 | [0m[35m                    raise APIError(400, f"Unknown update {a}: {b}")[0m
[30;1m536 | [0m[35m        except APIError:[0m
[30;1m537 | [0m[35m            flow.revert()[0m
[30;1m538 | [0m[35m            raise[0m

[31m--[ [0m[34mMatch #[0m[33m580[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/app.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m526 | [0m[35m                        elif k == "content":[0m
[30;1m527 | [0m[35m                            response.text = v[0m
[30;1m528 | [0m[35m                        else:[0m
[30;1m529 | [0m[35m                            raise APIError(400, f"Unknown update response.{k}: {v}")[0m
[30;1m530 | [0m[35m                elif a == "marked":[0m
[30;1m531 | [0m[35m                    flow.marked = b[0m
[30;1m532 | [0m[35m                elif a == "comment":[0m

[31m--[ [0m[34mMatch #[0m[33m581[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/app.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m503 | [0m[35m                        elif k == "content":[0m
[30;1m504 | [0m[35m                            request.text = v[0m
[30;1m505 | [0m[35m                        else:[0m
[30;1m506 | [0m[35m                            raise APIError(400, f"Unknown update request.{k}: {v}")[0m
[30;1m507 | [0m[35m[0m
[30;1m508 | [0m[35m                elif a == "response" and hasattr(flow, "response"):[0m
[30;1m509 | [0m[35m                    response: mitmproxy.http.Response = flow.response[0m

[31m--[ [0m[34mMatch #[0m[33m582[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/app.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m263 | [0m[35m    application: Application[0m
[30;1m264 | [0m[35m[0m
[30;1m265 | [0m[35m    def write(self, chunk: str | bytes | dict | list):[0m
[30;1m266 | [0m[35m        # Writing arrays on the top level is ok nowadays.[0m
[30;1m267 | [0m[35m        # http://flask.pocoo.org/docs/0.11/security/#json-security[0m
[30;1m268 | [0m[35m        if isinstance(chunk, list):[0m
[30;1m269 | [0m[35m            chunk = tornado.escape.json_encode(chunk)[0m

[31m--[ [0m[34mMatch #[0m[33m583[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/coretypes/bidi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m23 | [0m[35m        raise AttributeError("No such attribute: %s", k)[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m    def get_name(self, n, default=None):[0m
[30;1m26 | [0m[35m        return self.values.get(n, default)[0m

[31m--[ [0m[34mMatch #[0m[33m584[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/next_layer.py[0m
   Pattern: [32m.hostname[0m
[30;1m211 | [0m[35m        """[0m
[30;1m212 | [0m[35m        if not ctx.options.ignore_hosts and not ctx.options.allow_hosts:[0m
[30;1m213 | [0m[35m            return False[0m
[30;1m214 | [0m[35m        # Special handling for wireguard mode: if the hostname is "10.0.0.53", do not ignore the con[0m
[30;1m215 | [0m[35m        if isinstance([0m
[30;1m216 | [0m[35m            context.client.proxy_mode, mode_specs.WireGuardMode[0m
[30;1m217 | [0m[35m        ) and context.server.address == ("10.0.0.53", 53):[0m

[31m--[ [0m[34mMatch #[0m[33m585[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/next_layer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m4 | [0m[35mnext, it calls the `next_layer` hook, which ends up here.[0m
[30;1m5 | [0m[35mFor example, if mitmproxy runs as a regular proxy, we first need to determine if[0m
[30;1m6 | [0m[35mnew clients start with a TLS handshake right away (Secure Web Proxy) or send a plaintext HTTP CONNEC[0m
[30;1m7 | [0m[35mThis addon here peeks at the incoming bytes and then makes a decision based on proxy mode, mitmproxy[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mFor a typical HTTPS request, this addon is called a couple of times: First to determine that we star[0m
[30;1m10 | [0m[35mwhich processes the `CONNECT` request, a second time to determine that the client then starts negoti[0m

[31m--[ [0m[34mMatch #[0m[33m586[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/next_layer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mFor a typical HTTPS request, this addon is called a couple of times: First to determine that we star[0m
[30;1m10 | [0m[35mwhich processes the `CONNECT` request, a second time to determine that the client then starts negoti[0m
[30;1m11 | [0m[35mthird time when we check if the protocol within that TLS stream is actually HTTP or something else.[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mSometimes it's useful to hardcode specific logic in next_layer when one wants to do fancy things.[0m
[30;1m14 | [0m[35mIn that case it's not necessary to modify mitmproxy's source, adding a custom addon with a next_laye[0m

[31m--[ [0m[34mMatch #[0m[33m587[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/next_layer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mThis addon here peeks at the incoming bytes and then makes a decision based on proxy mode, mitmproxy[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mFor a typical HTTPS request, this addon is called a couple of times: First to determine that we star[0m
[30;1m10 | [0m[35mwhich processes the `CONNECT` request, a second time to determine that the client then starts negoti[0m
[30;1m11 | [0m[35mthird time when we check if the protocol within that TLS stream is actually HTTP or something else.[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mSometimes it's useful to hardcode specific logic in next_layer when one wants to do fancy things.[0m

[31m--[ [0m[34mMatch #[0m[33m588[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/dns/https_records.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35mdef _pack_params(params: dict[int, bytes]) -> bytes:[0m
[30;1m91 | [0m[35m    """Converts the service parameters into the raw byte format"""[0m
[30;1m92 | [0m[35m    buffer = bytearray()[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m    for k, v in params.items():[0m

[31m--[ [0m[34mMatch #[0m[33m589[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/dns/https_records.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m81 | [0m[35m    # TargetName (variable length)[0m
[30;1m82 | [0m[35m    target_name, offset = domain_names.unpack_from(data, offset)[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m    # Service Parameters (remaining bytes)[0m
[30;1m85 | [0m[35m    params = _unpack_params(data, offset)[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m    return HTTPSRecord(priority=priority, target_name=target_name, params=params)[0m

[31m--[ [0m[34mMatch #[0m[33m590[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/dns/https_records.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35mdef _unpack_params(data: bytes, offset: int) -> dict[int, bytes]:[0m
[30;1m51 | [0m[35m    """Unpacks the service parameters from the given offset."""[0m
[30;1m52 | [0m[35m    params = {}[0m
[30;1m53 | [0m[35m    while offset < len(data):[0m
[30;1m54 | [0m[35m        param_type = struct.unpack("!H", data[offset : offset + 2])[0][0m

[31m--[ [0m[34mMatch #[0m[33m591[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/tlsconfig.py[0m
   Pattern: [32m.hostname[0m
[30;1m610 | [0m[35m        if conn_context.server.address:[0m
[30;1m611 | [0m[35m            altnames.append(_ip_or_dns_name(conn_context.server.address[0]))[0m
[30;1m612 | [0m[35m[0m
[30;1m613 | [0m[35m        # only keep first occurrence of each hostname[0m
[30;1m614 | [0m[35m        altnames = list(dict.fromkeys(altnames))[0m
[30;1m615 | [0m[35m[0m
[30;1m616 | [0m[35m        # RFC 2818: If a subjectAltName extension of type dNSName is present, that MUST be used as t[0m

[31m--[ [0m[34mMatch #[0m[33m592[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/tlsconfig.py[0m
   Pattern: [32m.hostname[0m
[30;1m370 | [0m[35m                ok = SSL._lib.X509_VERIFY_PARAM_set1_ip(param, ip, len(ip))  # type: ignore[0m
[30;1m371 | [0m[35m                SSL._openssl_assert(ok == 1)  # type: ignore[0m
[30;1m372 | [0m[35m        elif verify is not net_tls.Verify.VERIFY_NONE:[0m
[30;1m373 | [0m[35m            raise ValueError("Cannot validate certificate hostname without SNI")[0m
[30;1m374 | [0m[35m[0m
[30;1m375 | [0m[35m        if server.alpn_offers:[0m
[30;1m376 | [0m[35m            tls_start.ssl_conn.set_alpn_protos(server.alpn_offers)[0m

[31m--[ [0m[34mMatch #[0m[33m593[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/tlsconfig.py[0m
   Pattern: [32m.hostname[0m
[30;1m347 | [0m[35m        if server.sni:[0m
[30;1m348 | [0m[35m            # We need to set SNI + enable hostname verification.[0m
[30;1m349 | [0m[35m            assert isinstance(server.sni, str)[0m
[30;1m350 | [0m[35m            # Manually enable hostname verification on the context object.[0m
[30;1m351 | [0m[35m            # https://wiki.openssl.org/index.php/Hostname_validation[0m
[30;1m352 | [0m[35m            param = SSL._lib.SSL_get0_param(tls_start.ssl_conn._ssl)  # type: ignore[0m
[30;1m353 | [0m[35m            # Matching on the CN is disabled in both Chrome and Firefox, so we disable it, too.[0m

[31m--[ [0m[34mMatch #[0m[33m594[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/tlsconfig.py[0m
   Pattern: [32m.hostname[0m
[30;1m345 | [0m[35m[0m
[30;1m346 | [0m[35m        tls_start.ssl_conn = SSL.Connection(ssl_ctx)[0m
[30;1m347 | [0m[35m        if server.sni:[0m
[30;1m348 | [0m[35m            # We need to set SNI + enable hostname verification.[0m
[30;1m349 | [0m[35m            assert isinstance(server.sni, str)[0m
[30;1m350 | [0m[35m            # Manually enable hostname verification on the context object.[0m
[30;1m351 | [0m[35m            # https://wiki.openssl.org/index.php/Hostname_validation[0m

[31m--[ [0m[34mMatch #[0m[33m595[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/tlsconfig.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m253 | [0m[35m        )[0m
[30;1m254 | [0m[35m[0m
[30;1m255 | [0m[35m        # Force HTTP/1 for secure web proxies, we currently don't support CONNECT over HTTP/2.[0m
[30;1m256 | [0m[35m        # There is a proof-of-concept branch at https://github.com/mhils/mitmproxy/tree/http2-proxy,[0m
[30;1m257 | [0m[35m        # but the complexity outweighs the benefits for now.[0m
[30;1m258 | [0m[35m        if len(tls_start.context.layers) == 2 and isinstance([0m
[30;1m259 | [0m[35m            tls_start.context.layers[0], modes.HttpProxy[0m

[31m--[ [0m[34mMatch #[0m[33m596[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/tlsconfig.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m622 | [0m[35mdef _ip_or_dns_name(val: str) -> x509.GeneralName:[0m
[30;1m623 | [0m[35m    """Convert a string into either an x509.IPAddress or x509.DNSName object."""[0m
[30;1m624 | [0m[35m    try:[0m
[30;1m625 | [0m[35m        ip = ipaddress.ip_address(val)[0m
[30;1m626 | [0m[35m    except ValueError:[0m
[30;1m627 | [0m[35m        return x509.DNSName(val.encode("idna").decode())[0m
[30;1m628 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m597[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/tlsconfig.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m600 | [0m[35m            if upstream_cert.organization:[0m
[30;1m601 | [0m[35m                organization = upstream_cert.organization[0m
[30;1m602 | [0m[35m[0m
[30;1m603 | [0m[35m        # Add SNI or our local IP address.[0m
[30;1m604 | [0m[35m        if conn_context.client.sni:[0m
[30;1m605 | [0m[35m            altnames.append(_ip_or_dns_name(conn_context.client.sni))[0m
[30;1m606 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m598[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/tlsconfig.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m563 | [0m[35m[0m
[30;1m564 | [0m[35m    def _warn_seclevel_missing(self, side: Literal["client", "server"]) -> None:[0m
[30;1m565 | [0m[35m        """[0m
[30;1m566 | [0m[35m        OpenSSL cipher spec need to specify @SECLEVEL for old TLS versions to work,[0m
[30;1m567 | [0m[35m        see https://github.com/pyca/cryptography/issues/9523.[0m
[30;1m568 | [0m[35m        """[0m
[30;1m569 | [0m[35m        if side == "client":[0m

[31m--[ [0m[34mMatch #[0m[33m599[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/tlsconfig.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m557 | [0m[35m                )[0m
[30;1m558 | [0m[35m        elif val not in supported_versions:[0m
[30;1m559 | [0m[35m            logger.warning([0m
[30;1m560 | [0m[35m                f"{attribute} has been set to {val.name}, which is not supported by the current Open[0m
[30;1m561 | [0m[35m                f"The current build only supports the following versions: {supported_versions_str}"[0m
[30;1m562 | [0m[35m            )[0m
[30;1m563 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m600[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/tlsconfig.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m197 | [0m[35m            "ciphers_server",[0m
[30;1m198 | [0m[35m            str | None,[0m
[30;1m199 | [0m[35m            None,[0m
[30;1m200 | [0m[35m            "Set supported ciphers for mitmproxy <-> server connections using OpenSSL syntax.",[0m
[30;1m201 | [0m[35m        )[0m
[30;1m202 | [0m[35m[0m
[30;1m203 | [0m[35m    def tls_clienthello(self, tls_clienthello: tls.ClientHelloData):[0m

[31m--[ [0m[34mMatch #[0m[33m601[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/tlsconfig.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m191 | [0m[35m            "ciphers_client",[0m
[30;1m192 | [0m[35m            str | None,[0m
[30;1m193 | [0m[35m            None,[0m
[30;1m194 | [0m[35m            "Set supported ciphers for client <-> mitmproxy connections using OpenSSL syntax.",[0m
[30;1m195 | [0m[35m        )[0m
[30;1m196 | [0m[35m        loader.add_option([0m
[30;1m197 | [0m[35m            "ciphers_server",[0m

[31m--[ [0m[34mMatch #[0m[33m602[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/tlsconfig.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35mclass TlsConfig:[0m
[30;1m117 | [0m[35m    """[0m
[30;1m118 | [0m[35m    This addon supplies the proxy core with the desired OpenSSL connection objects to negotiate TLS.[0m
[30;1m119 | [0m[35m    """[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m    certstore: certs.CertStore = None  # type: ignore[0m

[31m--[ [0m[34mMatch #[0m[33m603[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/tlsconfig.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m105 | [0m[35m        # We need to mirror this on the client connection.[0m
[30;1m106 | [0m[35m        return SSL.NO_OVERLAPPING_PROTOCOLS[0m
[30;1m107 | [0m[35m    http_alpns = proxy_tls.HTTP_ALPNS if http2 else proxy_tls.HTTP1_ALPNS[0m
[30;1m108 | [0m[35m    # client sends in order of preference, so we are nice and respect that.[0m
[30;1m109 | [0m[35m    for alpn in options:[0m
[30;1m110 | [0m[35m        if alpn in http_alpns:[0m
[30;1m111 | [0m[35m            return alpn[0m

[31m--[ [0m[34mMatch #[0m[33m604[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/tlsconfig.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35mlogger = logging.getLogger(__name__)[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m# We manually need to specify this, otherwise OpenSSL may select a non-HTTP2 cipher by default.[0m
[30;1m31 | [0m[35m# https://ssl-config.mozilla.org/#config=old[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m_DEFAULT_CIPHERS = ([0m

[31m--[ [0m[34mMatch #[0m[33m605[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/tlsconfig.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35mfrom aioquic.tls import CipherSuite[0m
[30;1m12 | [0m[35mfrom cryptography import x509[0m
[30;1m13 | [0m[35mfrom OpenSSL import crypto[0m
[30;1m14 | [0m[35mfrom OpenSSL import SSL[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35mfrom mitmproxy import certs[0m
[30;1m17 | [0m[35mfrom mitmproxy import connection[0m

[31m--[ [0m[34mMatch #[0m[33m606[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/tlsconfig.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35mfrom aioquic.h3.connection import H3_ALPN[0m
[30;1m11 | [0m[35mfrom aioquic.tls import CipherSuite[0m
[30;1m12 | [0m[35mfrom cryptography import x509[0m
[30;1m13 | [0m[35mfrom OpenSSL import crypto[0m
[30;1m14 | [0m[35mfrom OpenSSL import SSL[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35mfrom mitmproxy import certs[0m

[31m--[ [0m[34mMatch #[0m[33m607[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/dns/domain_names.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m141 | [0m[35m    buffer: bytes, offset: int, end_data: int, cached_names: Cache[0m
[30;1m142 | [0m[35m) -> bytes:[0m
[30;1m143 | [0m[35m    # we decompress compression pointers in RDATA by iterating through each byte and checking[0m
[30;1m144 | [0m[35m    # if it has a leading 0b11, if so we try to decompress it and update it in the data variable.[0m
[30;1m145 | [0m[35m    data = bytearray(buffer[offset:end_data])[0m
[30;1m146 | [0m[35m    data_offset = 0[0m
[30;1m147 | [0m[35m    decompress_size = 0[0m

[31m--[ [0m[34mMatch #[0m[33m608[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/dns/domain_names.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m30 | [0m[35m            labels.append(buffer[offset:end_label].decode("idna"))[0m
[30;1m31 | [0m[35m        except UnicodeDecodeError:[0m
[30;1m32 | [0m[35m            raise struct.error([0m
[30;1m33 | [0m[35m                f"unpack encountered an illegal characters at offset {offset}"[0m
[30;1m34 | [0m[35m            )[0m
[30;1m35 | [0m[35m        return _LABEL_SIZE.size + size[0m
[30;1m36 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m609[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/utils/strutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m209 | [0m[35m    control_characters,[0m
[30;1m210 | [0m[35m):[0m
[30;1m211 | [0m[35m    """[0m
[30;1m212 | [0m[35m    Escape all control characters present in special areas with UTF8 symbols[0m
[30;1m213 | [0m[35m    in the private use plane (U+E000 t+ ord(char)).[0m
[30;1m214 | [0m[35m    This is useful so that one can then use regex replacements on the resulting string without[0m
[30;1m215 | [0m[35m    interfering with special areas.[0m

[31m--[ [0m[34mMatch #[0m[33m610[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/utils/strutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m144 | [0m[35m    """[0m
[30;1m145 | [0m[35m    Many editors will silently add a newline to the final line of a[0m
[30;1m146 | [0m[35m    document (I'm looking at you, Vim). This function fixes this common[0m
[30;1m147 | [0m[35m    problem at the risk of removing a hanging newline in the rare cases[0m
[30;1m148 | [0m[35m    where the user actually intends it.[0m
[30;1m149 | [0m[35m    """[0m
[30;1m150 | [0m[35m    if t and t[-1] == "\n":[0m

[31m--[ [0m[34mMatch #[0m[33m611[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/utils/strutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m143 | [0m[35mdef clean_hanging_newline(t):[0m
[30;1m144 | [0m[35m    """[0m
[30;1m145 | [0m[35m    Many editors will silently add a newline to the final line of a[0m
[30;1m146 | [0m[35m    document (I'm looking at you, Vim). This function fixes this common[0m
[30;1m147 | [0m[35m    problem at the risk of removing a hanging newline in the rare cases[0m
[30;1m148 | [0m[35m    where the user actually intends it.[0m
[30;1m149 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m612[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/utils/strutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35mdef escape_control_characters(text: str, keep_spacing=True) -> str:[0m
[30;1m70 | [0m[35m    """[0m
[30;1m71 | [0m[35m    Replace all unicode C1 control characters from the given text with a single "."[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m    Args:[0m
[30;1m74 | [0m[35m        keep_spacing: If True, tabs and newlines will not be replaced.[0m

[31m--[ [0m[34mMatch #[0m[33m613[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/utils/strutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m55 | [0m[35m# with monospace fonts. We are back to "." therefore.[0m
[30;1m56 | [0m[35m_control_char_trans = {[0m
[30;1m57 | [0m[35m    x: ord(".")[0m
[30;1m58 | [0m[35m    for x in range(32)  # x + 0x2400 for unicode control group pictures[0m
[30;1m59 | [0m[35m}[0m
[30;1m60 | [0m[35m_control_char_trans[127] = ord(".")  # 0x2421[0m
[30;1m61 | [0m[35m_control_char_trans_newline = _control_char_trans.copy()[0m

[31m--[ [0m[34mMatch #[0m[33m614[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/utils/strutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m# Translate control characters to "safe" characters. This implementation[0m
[30;1m53 | [0m[35m# initially replaced them with the matching control pictures[0m
[30;1m54 | [0m[35m# (http://unicode.org/charts/PDF/U2400.pdf), but that turned out to render badly[0m
[30;1m55 | [0m[35m# with monospace fonts. We are back to "." therefore.[0m
[30;1m56 | [0m[35m_control_char_trans = {[0m

[31m--[ [0m[34mMatch #[0m[33m615[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/utils/strutils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m49 | [0m[35m        )[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m# Translate control characters to "safe" characters. This implementation[0m
[30;1m53 | [0m[35m# initially replaced them with the matching control pictures[0m
[30;1m54 | [0m[35m# (http://unicode.org/charts/PDF/U2400.pdf), but that turned out to render badly[0m
[30;1m55 | [0m[35m# with monospace fonts. We are back to "." therefore.[0m

[31m--[ [0m[34mMatch #[0m[33m616[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/dns/op_codes.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35mdef to_str(op_code: int) -> str:[0m
[30;1m19 | [0m[35m    return _STRINGS.get(op_code, f"OPCODE({op_code})")[0m

[31m--[ [0m[34mMatch #[0m[33m617[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/dns/op_codes.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35mQUERY = 0[0m
[30;1m2 | [0m[35mIQUERY = 1[0m
[30;1m3 | [0m[35mSTATUS = 2[0m
[30;1m4 | [0m[35mNOTIFY = 4[0m
[30;1m5 | [0m[35mUPDATE = 5[0m
[30;1m6 | [0m[35mDSO = 6[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m_STRINGS = {[0m

[31m--[ [0m[34mMatch #[0m[33m618[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contentviews/mqtt.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m94 | [0m[35mWill Topic: {self.payload.get("WillTopic")}[0m
[30;1m95 | [0m[35mWill Message: {strutils.bytes_to_escaped_str(self.payload.get("WillMessage", b"None"))}[0m
[30;1m96 | [0m[35mUser Name: {self.payload.get("UserName")}[0m
[30;1m97 | [0m[35mPassword: {strutils.bytes_to_escaped_str(self.payload.get("Password", b"None"))}[0m
[30;1m98 | [0m[35m"""[0m
[30;1m99 | [0m[35m        elif self.packet_type == self.SUBSCRIBE:[0m
[30;1m100 | [0m[35m            s += " sent topic filters: "[0m

[31m--[ [0m[34mMatch #[0m[33m619[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contentviews/mqtt.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m93 | [0m[35mClient Id: {self.payload["ClientId"]}[0m
[30;1m94 | [0m[35mWill Topic: {self.payload.get("WillTopic")}[0m
[30;1m95 | [0m[35mWill Message: {strutils.bytes_to_escaped_str(self.payload.get("WillMessage", b"None"))}[0m
[30;1m96 | [0m[35mUser Name: {self.payload.get("UserName")}[0m
[30;1m97 | [0m[35mPassword: {strutils.bytes_to_escaped_str(self.payload.get("Password", b"None"))}[0m
[30;1m98 | [0m[35m"""[0m
[30;1m99 | [0m[35m        elif self.packet_type == self.SUBSCRIBE:[0m

[31m--[ [0m[34mMatch #[0m[33m620[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contentviews/mqtt.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35mClient Id: {self.payload["ClientId"]}[0m
[30;1m94 | [0m[35mWill Topic: {self.payload.get("WillTopic")}[0m
[30;1m95 | [0m[35mWill Message: {strutils.bytes_to_escaped_str(self.payload.get("WillMessage", b"None"))}[0m
[30;1m96 | [0m[35mUser Name: {self.payload.get("UserName")}[0m
[30;1m97 | [0m[35mPassword: {strutils.bytes_to_escaped_str(self.payload.get("Password", b"None"))}[0m
[30;1m98 | [0m[35m"""[0m

[31m--[ [0m[34mMatch #[0m[33m621[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contentviews/mqtt.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m            s += f"""[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35mClient Id: {self.payload["ClientId"]}[0m
[30;1m94 | [0m[35mWill Topic: {self.payload.get("WillTopic")}[0m
[30;1m95 | [0m[35mWill Message: {strutils.bytes_to_escaped_str(self.payload.get("WillMessage", b"None"))}[0m
[30;1m96 | [0m[35mUser Name: {self.payload.get("UserName")}[0m
[30;1m97 | [0m[35mPassword: {strutils.bytes_to_escaped_str(self.payload.get("Password", b"None"))}[0m

[31m--[ [0m[34mMatch #[0m[33m622[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/platform/windows.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m330 | [0m[35m[0m
[30;1m331 | [0m[35m        # If this fails, we most likely have a connection from an external client.[0m
[30;1m332 | [0m[35m        # In this, case we always want to proxy the request.[0m
[30;1m333 | [0m[35m        pid = self.tcp_connections.get(client, None)[0m
[30;1m334 | [0m[35m[0m
[30;1m335 | [0m[35m        if pid not in self.trusted_pids:[0m
[30;1m336 | [0m[35m            self.redirect_request(packet)[0m

[31m--[ [0m[34mMatch #[0m[33m623[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/platform/windows.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m399 | [0m[35m[0m
[30;1m400 | [0m[35m    Limitations:[0m
[30;1m401 | [0m[35m[0m
[30;1m402 | [0m[35m    - We assume that ephemeral TCP ports are not re-used for multiple connections at the same time.[0m
[30;1m403 | [0m[35m    The proxy will fail if an application connects to example.com and example.org from[0m
[30;1m404 | [0m[35m    192.168.0.42:4242 simultaneously. This could be mitigated by introducing unique "meta-addresses"[0m
[30;1m405 | [0m[35m    which mitmproxy sees, but this would remove the correct client info from mitmproxy.[0m

[31m--[ [0m[34mMatch #[0m[33m624[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/platform/windows.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m255 | [0m[35m                self._map[(local_ip, local_port)] = row.dwOwningPid[0m
[30;1m256 | [0m[35m        elif ret == ERROR_INSUFFICIENT_BUFFER:[0m
[30;1m257 | [0m[35m            self._tcp6 = MIB_TCP6TABLE_OWNER_PID(self._tcp6_size.value)[0m
[30;1m258 | [0m[35m            # no need to update size, that's already done.[0m
[30;1m259 | [0m[35m            self._refresh_ipv6()[0m
[30;1m260 | [0m[35m        else:[0m
[30;1m261 | [0m[35m            raise RuntimeError([0m

[31m--[ [0m[34mMatch #[0m[33m625[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/platform/windows.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m232 | [0m[35m                self._map[(local_ip, local_port)] = row.dwOwningPid[0m
[30;1m233 | [0m[35m        elif ret == ERROR_INSUFFICIENT_BUFFER:[0m
[30;1m234 | [0m[35m            self._tcp = MIB_TCPTABLE_OWNER_PID(self._tcp_size.value)[0m
[30;1m235 | [0m[35m            # no need to update size, that's already done.[0m
[30;1m236 | [0m[35m            self._refresh_ipv4()[0m
[30;1m237 | [0m[35m        else:[0m
[30;1m238 | [0m[35m            raise RuntimeError([0m

[31m--[ [0m[34mMatch #[0m[33m626[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/platform/windows.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m499 | [0m[35m[0m
[30;1m500 | [0m[35m        self.client_server_map[client] = (packet.dst_addr, packet.dst_port)[0m
[30;1m501 | [0m[35m[0m
[30;1m502 | [0m[35m        # We do need to inject to an external IP here, 127.0.0.1 does not work.[0m
[30;1m503 | [0m[35m        if packet.address_family == socket.AF_INET:[0m
[30;1m504 | [0m[35m            assert self.ipv4_address[0m
[30;1m505 | [0m[35m            packet.dst_addr = self.ipv4_address[0m

[31m--[ [0m[34mMatch #[0m[33m627[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/platform/windows.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m71 | [0m[35m    def original_addr(self, csock: socket.socket):[0m
[30;1m72 | [0m[35m        ip, port = csock.getpeername()[:2][0m
[30;1m73 | [0m[35m        ip = re.sub(r"^::ffff:(?=\d+.\d+.\d+.\d+$)", "", ip)[0m
[30;1m74 | [0m[35m        ip = ip.split("%", 1)[0][0m
[30;1m75 | [0m[35m        with self.lock:[0m
[30;1m76 | [0m[35m            try:[0m
[30;1m77 | [0m[35m                write((ip, port), self.wfile)[0m

[31m--[ [0m[34mMatch #[0m[33m628[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/platform/windows.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m    def original_addr(self, csock: socket.socket):[0m
[30;1m72 | [0m[35m        ip, port = csock.getpeername()[:2][0m
[30;1m73 | [0m[35m        ip = re.sub(r"^::ffff:(?=\d+.\d+.\d+.\d+$)", "", ip)[0m
[30;1m74 | [0m[35m        ip = ip.split("%", 1)[0][0m
[30;1m75 | [0m[35m        with self.lock:[0m
[30;1m76 | [0m[35m            try:[0m

[31m--[ [0m[34mMatch #[0m[33m629[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/platform/windows.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35mimport socket[0m
[30;1m11 | [0m[35mimport socketserver[0m
[30;1m12 | [0m[35mimport threading[0m
[30;1m13 | [0m[35mimport time[0m
[30;1m14 | [0m[35mfrom collections.abc import Callable[0m
[30;1m15 | [0m[35mfrom io import BufferedIOBase[0m
[30;1m16 | [0m[35mfrom typing import Any[0m
[30;1m17 | [0m[35mfrom typing import cast[0m

[31m--[ [0m[34mMatch #[0m[33m630[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/log.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m243 | [0m[35m    Comparison method for "old" LogEntry log tiers.[0m
[30;1m244 | [0m[35m    Ideally you should use the standard Python logging module instead.[0m
[30;1m245 | [0m[35m    """[0m
[30;1m246 | [0m[35m    return dict(error=0, warn=1, info=2, alert=2, debug=3).get(level)[0m

[31m--[ [0m[34mMatch #[0m[33m631[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/log.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m216 | [0m[35m    def emit(self, record: logging.LogRecord) -> None:[0m
[30;1m217 | [0m[35m        entry = LogEntry([0m
[30;1m218 | [0m[35m            msg=self.format(record),[0m
[30;1m219 | [0m[35m            level=LOGGING_LEVELS_TO_LOGENTRY.get(record.levelno, "error"),[0m
[30;1m220 | [0m[35m        )[0m
[30;1m221 | [0m[35m        self.master.event_loop.call_soon_threadsafe([0m
[30;1m222 | [0m[35m            self.master.addons.trigger,[0m

[31m--[ [0m[34mMatch #[0m[33m632[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/log.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m78 | [0m[35m            super().filter(record)[0m
[30;1m79 | [0m[35m            and ([0m
[30;1m80 | [0m[35m                not self._initiated_in_test[0m
[30;1m81 | [0m[35m                or self._initiated_in_test == os.environ.get("PYTEST_CURRENT_TEST")[0m
[30;1m82 | [0m[35m            )[0m
[30;1m83 | [0m[35m        )[0m
[30;1m84 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m633[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/log.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m70 | [0m[35mclass MitmLogHandler(logging.Handler):[0m
[30;1m71 | [0m[35m    def __init__(self, *args, **kwargs):[0m
[30;1m72 | [0m[35m        super().__init__(*args, **kwargs)[0m
[30;1m73 | [0m[35m        self._initiated_in_test = os.environ.get("PYTEST_CURRENT_TEST")[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    def filter(self, record: logging.LogRecord) -> bool:[0m
[30;1m76 | [0m[35m        # We can't remove stale handlers here because that would modify .handlers during iteration![0m

[31m--[ [0m[34mMatch #[0m[33m634[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/log.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m57 | [0m[35m        if self.colorize:[0m
[30;1m58 | [0m[35m            message = miniclick.style([0m
[30;1m59 | [0m[35m                message,[0m
[30;1m60 | [0m[35m                fg=LOG_COLORS.get(record.levelno),[0m
[30;1m61 | [0m[35m                # dim=(record.levelno <= logging.DEBUG)[0m
[30;1m62 | [0m[35m            )[0m
[30;1m63 | [0m[35m        if client := getattr(record, "client", None):[0m

[31m--[ [0m[34mMatch #[0m[33m635[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/log.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m152 | [0m[35m        """[0m
[30;1m153 | [0m[35m        Log with level alert. Alerts have the same urgency as info, but[0m
[30;1m154 | [0m[35m        signals to interactive tools that the user's attention should be[0m
[30;1m155 | [0m[35m        drawn to the output even if they're not currently looking at the[0m
[30;1m156 | [0m[35m        event log.[0m
[30;1m157 | [0m[35m        """[0m
[30;1m158 | [0m[35m        warnings.warn([0m

[31m--[ [0m[34mMatch #[0m[33m636[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/log.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m17 | [0m[35m"""[0m
[30;1m18 | [0m[35mThe ALERT logging level has the same urgency as info, but[0m
[30;1m19 | [0m[35msignals to interactive tools that the user's attention should be[0m
[30;1m20 | [0m[35mdrawn to the output even if they're not currently looking at the[0m
[30;1m21 | [0m[35mevent log.[0m
[30;1m22 | [0m[35m"""[0m
[30;1m23 | [0m[35mlogging.addLevelName(ALERT, "ALERT")[0m

[31m--[ [0m[34mMatch #[0m[33m637[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/log.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m50 | [0m[35m    default_msec_format = "%s.%03d"[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m    def format(self, record: logging.LogRecord) -> str:[0m
[30;1m53 | [0m[35m        time = self.formatTime(record)[0m
[30;1m54 | [0m[35m        message = record.getMessage()[0m
[30;1m55 | [0m[35m        if record.exc_info:[0m
[30;1m56 | [0m[35m            message = f"{message}\n{self.formatException(record.exc_info)}"[0m

[31m--[ [0m[34mMatch #[0m[33m638[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/log.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m        time = "[%s]"[0m
[30;1m41 | [0m[35m        client = "[%s]"[0m
[30;1m42 | [0m[35m        if colorize:[0m
[30;1m43 | [0m[35m            time = miniclick.style(time, fg="cyan", dim=True)[0m
[30;1m44 | [0m[35m            client = miniclick.style(client, fg="yellow", dim=True)[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m        self.with_client = f"{time}{client} %s"[0m

[31m--[ [0m[34mMatch #[0m[33m639[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/log.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m37 | [0m[35m    def __init__(self, colorize: bool):[0m
[30;1m38 | [0m[35m        super().__init__()[0m
[30;1m39 | [0m[35m        self.colorize = colorize[0m
[30;1m40 | [0m[35m        time = "[%s]"[0m
[30;1m41 | [0m[35m        client = "[%s]"[0m
[30;1m42 | [0m[35m        if colorize:[0m
[30;1m43 | [0m[35m            time = miniclick.style(time, fg="cyan", dim=True)[0m

[31m--[ [0m[34mMatch #[0m[33m640[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/http/validate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m82 | [0m[35m            case b"content-length":[0m
[30;1m83 | [0m[35m                cl.append(value)[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m    if te and cl:[0m
[30;1m86 | [0m[35m        # > A server MAY reject a request that contains both Content-Length and Transfer-Encoding or[0m
[30;1m87 | [0m[35m        # > request in accordance with the Transfer-Encoding alone.[0m
[30;1m88 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m641[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/http/validate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m70 | [0m[35m    Raises a ValueError if they are malformed.[0m
[30;1m71 | [0m[35m    """[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m    te = [][0m
[30;1m74 | [0m[35m    cl = [][0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m    for name, value in message.headers.fields:[0m

[31m--[ [0m[34mMatch #[0m[33m642[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/http/validate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m58 | [0m[35m        te = value.decode()[0m
[30;1m59 | [0m[35m    te = te.lower()[0m
[30;1m60 | [0m[35m    te = re.sub(r"[\t ]*,[\t ]*", ",", te)[0m
[30;1m61 | [0m[35m    if te not in _HTTP_1_1_TRANSFER_ENCODINGS:[0m
[30;1m62 | [0m[35m        raise ValueError(f"unknown transfer-encoding header: {value!r}")[0m
[30;1m63 | [0m[35m    return typing.cast(TransferEncoding, te)[0m
[30;1m64 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m643[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/http/validate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m57 | [0m[35m    else:[0m
[30;1m58 | [0m[35m        te = value.decode()[0m
[30;1m59 | [0m[35m    te = te.lower()[0m
[30;1m60 | [0m[35m    te = re.sub(r"[\t ]*,[\t ]*", ",", te)[0m
[30;1m61 | [0m[35m    if te not in _HTTP_1_1_TRANSFER_ENCODINGS:[0m
[30;1m62 | [0m[35m        raise ValueError(f"unknown transfer-encoding header: {value!r}")[0m
[30;1m63 | [0m[35m    return typing.cast(TransferEncoding, te)[0m

[31m--[ [0m[34mMatch #[0m[33m644[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/http/validate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m56 | [0m[35m        te = value[0m
[30;1m57 | [0m[35m    else:[0m
[30;1m58 | [0m[35m        te = value.decode()[0m
[30;1m59 | [0m[35m    te = te.lower()[0m
[30;1m60 | [0m[35m    te = re.sub(r"[\t ]*,[\t ]*", ",", te)[0m
[30;1m61 | [0m[35m    if te not in _HTTP_1_1_TRANSFER_ENCODINGS:[0m
[30;1m62 | [0m[35m        raise ValueError(f"unknown transfer-encoding header: {value!r}")[0m

[31m--[ [0m[34mMatch #[0m[33m645[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/http/validate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m55 | [0m[35m    if isinstance(value, str):[0m
[30;1m56 | [0m[35m        te = value[0m
[30;1m57 | [0m[35m    else:[0m
[30;1m58 | [0m[35m        te = value.decode()[0m
[30;1m59 | [0m[35m    te = te.lower()[0m
[30;1m60 | [0m[35m    te = re.sub(r"[\t ]*,[\t ]*", ",", te)[0m
[30;1m61 | [0m[35m    if te not in _HTTP_1_1_TRANSFER_ENCODINGS:[0m

[31m--[ [0m[34mMatch #[0m[33m646[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/http/validate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m53 | [0m[35m    if not value.isascii():[0m
[30;1m54 | [0m[35m        raise ValueError(f"invalid transfer-encoding header: {value!r}")[0m
[30;1m55 | [0m[35m    if isinstance(value, str):[0m
[30;1m56 | [0m[35m        te = value[0m
[30;1m57 | [0m[35m    else:[0m
[30;1m58 | [0m[35m        te = value.decode()[0m
[30;1m59 | [0m[35m    te = te.lower()[0m

[31m--[ [0m[34mMatch #[0m[33m647[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m230 | [0m[35m        for f in flows:[0m
[30;1m231 | [0m[35m            p = getattr(f, part, None)[0m
[30;1m232 | [0m[35m            if p:[0m
[30;1m233 | [0m[35m                current_enc = p.headers.get("content-encoding", "identity")[0m
[30;1m234 | [0m[35m                if current_enc == "identity":[0m
[30;1m235 | [0m[35m                    f.backup()[0m
[30;1m236 | [0m[35m                    p.encode(encoding)[0m

[31m--[ [0m[34mMatch #[0m[33m648[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m206 | [0m[35m            p = getattr(f, part, None)[0m
[30;1m207 | [0m[35m            if p:[0m
[30;1m208 | [0m[35m                f.backup()[0m
[30;1m209 | [0m[35m                current_enc = p.headers.get("content-encoding", "identity")[0m
[30;1m210 | [0m[35m                if current_enc == "identity":[0m
[30;1m211 | [0m[35m                    p.encode("deflate")[0m
[30;1m212 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m649[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/http/headers.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m    """[0m
[30;1m43 | [0m[35m    # Use the charset from the header if possible[0m
[30;1m44 | [0m[35m    parsed_content_type = parse_content_type(content_type)[0m
[30;1m45 | [0m[35m    enc = parsed_content_type[2].get("charset") if parsed_content_type else None[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    # Otherwise, infer the encoding[0m
[30;1m48 | [0m[35m    if not enc and "json" in content_type:[0m

[31m--[ [0m[34mMatch #[0m[33m650[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/save.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m@lru_cache[0m
[30;1m26 | [0m[35mdef _path(path: str) -> str:[0m
[30;1m27 | [0m[35m    """Extract the path from a path spec (which may have an extra "+" at the front)"""[0m
[30;1m28 | [0m[35m    if path.startswith("+"):[0m
[30;1m29 | [0m[35m        path = path[1:][0m
[30;1m30 | [0m[35m    return os.path.expanduser(path)[0m

[31m--[ [0m[34mMatch #[0m[33m651[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/save.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35m            """[0m
[30;1m55 | [0m[35m            Stream flows to file as they arrive. Prefix path with + to append.[0m
[30;1m56 | [0m[35m            The full path can use python strftime() formating, missing[0m
[30;1m57 | [0m[35m            directories are created as needed. A new file is opened every time[0m
[30;1m58 | [0m[35m            the formatted string changes.[0m
[30;1m59 | [0m[35m            """,[0m
[30;1m60 | [0m[35m        )[0m
[30;1m61 | [0m[35m        loader.add_option([0m

[31m--[ [0m[34mMatch #[0m[33m652[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/utils/arg_check.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m151 | [0m[35m                "Please use `--set {}=value` instead.\n"[0m
[30;1m152 | [0m[35m                "To show all options and their default values use --options".format([0m
[30;1m153 | [0m[35m                    option,[0m
[30;1m154 | [0m[35m                    REPLACEMENTS.get(option, None)[0m
[30;1m155 | [0m[35m                    or option.lstrip("-").replace("-", "_"),[0m
[30;1m156 | [0m[35m                )[0m
[30;1m157 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m653[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/utils/arg_check.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m    for option in REPLACED.splitlines():[0m
[30;1m135 | [0m[35m        if option in args:[0m
[30;1m136 | [0m[35m            r = REPLACEMENTS.get(option)[0m
[30;1m137 | [0m[35m            if isinstance(r, list):[0m
[30;1m138 | [0m[35m                new_options = r[0m
[30;1m139 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m654[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contrib/kaitaistruct/make.sh[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m#!/usr/bin/env bash[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mset -e[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/image/exif.ksy[0m

[31m--[ [0m[34mMatch #[0m[33m655[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contrib/kaitaistruct/make.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35msercontent.com/kaitai-io/kaitai_struct_formats/master/image/ico.ksy[0m
[30;1m10 | [0m[35mwget -N -P common/ https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/common/v[0m
[30;1m11 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/serialization/googl[0m
[30;1m12 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/network/tls_client_[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mkaitai-struct-compiler --target python --opaque-types=true -I . --python-package . ./*.ksy[0m

[31m--[ [0m[34mMatch #[0m[33m656[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contrib/kaitaistruct/make.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35m https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/image/png.ksy[0m
[30;1m9 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/image/ico.ksy[0m
[30;1m10 | [0m[35mwget -N -P common/ https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/common/v[0m
[30;1m11 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/serialization/googl[0m
[30;1m12 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/network/tls_client_[0m
[30;1m13 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m657[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contrib/kaitaistruct/make.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35m/image/gif.ksy[0m
[30;1m7 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/image/jpeg.ksy[0m
[30;1m8 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/image/png.ksy[0m
[30;1m9 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/image/ico.ksy[0m
[30;1m10 | [0m[35mwget -N -P common/ https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/common/v[0m
[30;1m11 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/serialization/googl[0m

[31m--[ [0m[34mMatch #[0m[33m658[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contrib/kaitaistruct/make.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35mimage/exif.ksy[0m
[30;1m6 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/image/gif.ksy[0m
[30;1m7 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/image/jpeg.ksy[0m
[30;1m8 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/image/png.ksy[0m
[30;1m9 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/image/ico.ksy[0m
[30;1m10 | [0m[35mwget -N -P common/ https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/common/v[0m

[31m--[ [0m[34mMatch #[0m[33m659[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contrib/kaitaistruct/make.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mbash[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mset -e[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/image/exif.ksy[0m
[30;1m6 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/image/gif.ksy[0m
[30;1m7 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/image/jpeg.ksy[0m
[30;1m8 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/image/png.ksy[0m
[30;1m9 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/image/ico.ksy[0m

[31m--[ [0m[34mMatch #[0m[33m660[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contrib/kaitaistruct/make.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mset -e[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/image/exif.ksy[0m
[30;1m6 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/image/gif.ksy[0m
[30;1m7 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/image/jpeg.ksy[0m
[30;1m8 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/image/png.ksy[0m
[30;1m9 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/image/ico.ksy[0m
[30;1m10 | [0m[35mwget -N -P common/ https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/common/v[0m

[31m--[ [0m[34mMatch #[0m[33m661[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contrib/kaitaistruct/make.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mset -e[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/image/exif.ksy[0m
[30;1m6 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/image/gif.ksy[0m
[30;1m7 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/image/jpeg.ksy[0m
[30;1m8 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/image/png.ksy[0m
[30;1m9 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/image/ico.ksy[0m

[31m--[ [0m[34mMatch #[0m[33m662[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contrib/kaitaistruct/make.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35m#!/usr/bin/env bash[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mset -e[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/image/exif.ksy[0m
[30;1m8 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/image/gif.ksy[0m
[30;1m9 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/image/jpeg.ksy[0m
[30;1m10 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/image/png.ksy[0m

[31m--[ [0m[34mMatch #[0m[33m663[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contrib/kaitaistruct/make.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m#!/usr/bin/env bash[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mset -e[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mwget -N https://raw.githubusercontent.com/kaitai-io/kaitai_struct_formats/master/image/exif.ksy[0m

[31m--[ [0m[34mMatch #[0m[33m664[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/flow.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m275 | [0m[35m    @property[0m
[30;1m276 | [0m[35m    def timestamp_start(self) -> float:[0m
[30;1m277 | [0m[35m        """[0m
[30;1m278 | [0m[35m        *Read-only:* Start time of the flow.[0m
[30;1m279 | [0m[35m        Depending on the flow type, this property is an alias for[0m
[30;1m280 | [0m[35m        `mitmproxy.connection.Client.timestamp_start` or `mitmproxy.http.Request.timestamp_start`.[0m
[30;1m281 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m665[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/flow.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport asyncio[0m
[30;1m4 | [0m[35mimport copy[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35mimport uuid[0m
[30;1m7 | [0m[35mfrom dataclasses import dataclass[0m
[30;1m8 | [0m[35mfrom dataclasses import field[0m
[30;1m9 | [0m[35mfrom typing import Any[0m

[31m--[ [0m[34mMatch #[0m[33m666[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/tunnel.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35m            if self.tunnel_connection.state is not connection.ConnectionState.CLOSED:[0m
[30;1m58 | [0m[35m                # we might be in the interesting state here where the connection is already half-clo[0m
[30;1m59 | [0m[35m                # for example because next_layer buffered events and the client disconnected in the [0m
[30;1m60 | [0m[35m                # we still expect a close event to arrive, so we carry on here as normal for now.[0m
[30;1m61 | [0m[35m                self.tunnel_state = TunnelState.ESTABLISHING[0m
[30;1m62 | [0m[35m                yield from self.start_handshake()[0m
[30;1m63 | [0m[35m            yield from self.event_to_child(event)[0m

[31m--[ [0m[34mMatch #[0m[33m667[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/tunnel.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35mfrom enum import auto[0m
[30;1m3 | [0m[35mfrom enum import Enum[0m
[30;1m4 | [0m[35mfrom typing import Union[0m
[30;1m5 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m668[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/cut.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m            elif spec.startswith("header["):[0m
[30;1m55 | [0m[35m                if not current:[0m
[30;1m56 | [0m[35m                    return ""[0m
[30;1m57 | [0m[35m                return current.headers.get(headername(spec), "")[0m
[30;1m58 | [0m[35m            elif isinstance(part, bytes):[0m
[30;1m59 | [0m[35m                return part[0m
[30;1m60 | [0m[35m            elif isinstance(part, bool):[0m

[31m--[ [0m[34mMatch #[0m[33m669[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/cut.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m88 | [0m[35m        cuts: mitmproxy.types.CutSpec,[0m
[30;1m89 | [0m[35m    ) -> mitmproxy.types.Data:[0m
[30;1m90 | [0m[35m        """[0m
[30;1m91 | [0m[35m        Cut data from a set of flows. Cut specifications are attribute paths[0m
[30;1m92 | [0m[35m        from the base of the flow object, with a few conveniences - "port"[0m
[30;1m93 | [0m[35m        and "host" retrieve parts of an address tuple, ".header[key]"[0m
[30;1m94 | [0m[35m        retrieves a header value. Return values converted to strings or[0m

[31m--[ [0m[34mMatch #[0m[33m670[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/cut.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m88 | [0m[35m        cuts: mitmproxy.types.CutSpec,[0m
[30;1m89 | [0m[35m    ) -> mitmproxy.types.Data:[0m
[30;1m90 | [0m[35m        """[0m
[30;1m91 | [0m[35m        Cut data from a set of flows. Cut specifications are attribute paths[0m
[30;1m92 | [0m[35m        from the base of the flow object, with a few conveniences - "port"[0m
[30;1m93 | [0m[35m        and "host" retrieve parts of an address tuple, ".header[key]"[0m
[30;1m94 | [0m[35m        retrieves a header value. Return values converted to strings or[0m

[31m--[ [0m[34mMatch #[0m[33m671[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/cut.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m    if ([0m
[30;1m36 | [0m[35m        isinstance(f, http.HTTPFlow)[0m
[30;1m37 | [0m[35m        and f.websocket[0m
[30;1m38 | [0m[35m        and cut in ("request.content", "response.content")[0m
[30;1m39 | [0m[35m    ):[0m
[30;1m40 | [0m[35m        return f.websocket._get_formatted_messages()[0m
[30;1m41 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m672[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/flowfilter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m50 | [0m[35mfrom mitmproxy import udp[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35mmaybe_ignore_case = ([0m
[30;1m53 | [0m[35m    re.IGNORECASE if os.environ.get("MITMPROXY_CASE_SENSITIVE_FILTERS") != "1" else 0[0m
[30;1m54 | [0m[35m)[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m673[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_upstream_proxy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m        headers = http.Headers()[0m
[30;1m57 | [0m[35m        if self.context.options.http_connect_send_host_header:[0m
[30;1m58 | [0m[35m            headers.insert(0, b"Host", authority)[0m
[30;1m59 | [0m[35m        flow.request = http.Request([0m
[30;1m60 | [0m[35m            host=self.conn.address[0],[0m
[30;1m61 | [0m[35m            port=self.conn.address[1],[0m
[30;1m62 | [0m[35m            method=b"CONNECT",[0m

[31m--[ [0m[34mMatch #[0m[33m674[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_upstream_proxy.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35mfrom logging import DEBUG[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mfrom h11._receivebuffer import ReceiveBuffer[0m
[30;1m5 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m675[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_hooks.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m32 | [0m[35m@dataclass[0m
[30;1m33 | [0m[35mclass HttpResponseHeadersHook(commands.StartHook):[0m
[30;1m34 | [0m[35m    """[0m
[30;1m35 | [0m[35m    HTTP response headers were successfully read. At this point, the body is empty.[0m
[30;1m36 | [0m[35m    """[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m    name = "responseheaders"[0m

[31m--[ [0m[34mMatch #[0m[33m676[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/layers/http/_hooks.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m7 | [0m[35m@dataclass[0m
[30;1m8 | [0m[35mclass HttpRequestHeadersHook(commands.StartHook):[0m
[30;1m9 | [0m[35m    """[0m
[30;1m10 | [0m[35m    HTTP request headers were successfully read. At this point, the body is empty.[0m
[30;1m11 | [0m[35m    """[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m    name = "requestheaders"[0m

[31m--[ [0m[34mMatch #[0m[33m677[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/utils/debug.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m115 | [0m[35m    id2name = {th.ident: th.name for th in threading.enumerate()}[0m
[30;1m116 | [0m[35m    code = [][0m
[30;1m117 | [0m[35m    for threadId, stack in sys._current_frames().items():[0m
[30;1m118 | [0m[35m        code.append("\n# Thread: %s(%d)" % (id2name.get(threadId, ""), threadId))[0m
[30;1m119 | [0m[35m        for filename, lineno, name, line in traceback.extract_stack(stack):[0m
[30;1m120 | [0m[35m            code.append('File: "%s", line %d, in %s' % (filename, lineno, name))[0m
[30;1m121 | [0m[35m            if line:[0m

[31m--[ [0m[34mMatch #[0m[33m678[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/utils/debug.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m102 | [0m[35m                line = linecache.getline([0m
[30;1m103 | [0m[35m                    f.f_code.co_filename, f.f_lineno, f.f_globals[0m
[30;1m104 | [0m[35m                ).strip()[0m
[30;1m105 | [0m[35m                line = f"{line}  # at {os.path.basename(f.f_code.co_filename)}:{f.f_lineno}"[0m
[30;1m106 | [0m[35m                print(f"{asyncio_utils.task_repr(task)}\n    {line}")[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35m        print("****************************************************")[0m

[31m--[ [0m[34mMatch #[0m[33m679[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/utils/debug.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35mfrom collections import Counter[0m
[30;1m11 | [0m[35mfrom contextlib import redirect_stdout[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mfrom OpenSSL import SSL[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mfrom mitmproxy import version[0m
[30;1m16 | [0m[35mfrom mitmproxy.utils import asyncio_utils[0m

[31m--[ [0m[34mMatch #[0m[33m680[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/dns_resolver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m142 | [0m[35m                    ttl=dns.ResourceRecord.DEFAULT_TTL,[0m
[30;1m143 | [0m[35m                    data=ipaddress.ip_address(ip).packed,[0m
[30;1m144 | [0m[35m                )[0m
[30;1m145 | [0m[35m                for ip in ip_addrs[0m
[30;1m146 | [0m[35m            ][0m
[30;1m147 | [0m[35m        )[0m
[30;1m148 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m681[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/commander/commander.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m119 | [0m[35m                parsed = parts[0m
[30;1m120 | [0m[35m            else:[0m
[30;1m121 | [0m[35m                return[0m
[30;1m122 | [0m[35m            ct = mitmproxy.types.CommandTypes.get(type_to_complete, None)[0m
[30;1m123 | [0m[35m            if ct:[0m
[30;1m124 | [0m[35m                self.completion = CompletionState([0m
[30;1m125 | [0m[35m                    completer=ListCompleter([0m

[31m--[ [0m[34mMatch #[0m[33m682[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/commander/commander.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m222 | [0m[35m            prev_cmd = self.cbuf.text[0m
[30;1m223 | [0m[35m            cmd = self.master.commands.execute("commands.history.next")[0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35m            if cmd == "":[0m
[30;1m226 | [0m[35m                if prev_cmd == self.filter_str:[0m
[30;1m227 | [0m[35m                    self.cbuf = CommandBuffer(self.master, prev_cmd)[0m
[30;1m228 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m683[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/commander/commander.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m220 | [0m[35m            self.cbuf = CommandBuffer(self.master, cmd)[0m
[30;1m221 | [0m[35m        elif key == "down" or key == "ctrl n":[0m
[30;1m222 | [0m[35m            prev_cmd = self.cbuf.text[0m
[30;1m223 | [0m[35m            cmd = self.master.commands.execute("commands.history.next")[0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35m            if cmd == "":[0m
[30;1m226 | [0m[35m                if prev_cmd == self.filter_str:[0m

[31m--[ [0m[34mMatch #[0m[33m684[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/commander/commander.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m216 | [0m[35m                self.active_filter = True[0m
[30;1m217 | [0m[35m                self.filter_str = self.cbuf.text[0m
[30;1m218 | [0m[35m                self.master.commands.call("commands.history.filter", self.cbuf.text)[0m
[30;1m219 | [0m[35m            cmd = self.master.commands.execute("commands.history.prev")[0m
[30;1m220 | [0m[35m            self.cbuf = CommandBuffer(self.master, cmd)[0m
[30;1m221 | [0m[35m        elif key == "down" or key == "ctrl n":[0m
[30;1m222 | [0m[35m            prev_cmd = self.cbuf.text[0m

[31m--[ [0m[34mMatch #[0m[33m685[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/commander/commander.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m151 | [0m[35m[0m
[30;1m152 | [0m[35m    def insert(self, k: str) -> None:[0m
[30;1m153 | [0m[35m        """[0m
[30;1m154 | [0m[35m        Inserts text at the cursor.[0m
[30;1m155 | [0m[35m        """[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m        # We don't want to insert a space before the command[0m

[31m--[ [0m[34mMatch #[0m[33m686[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contentviews/css.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport re[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mfrom mitmproxy.contentviews import base[0m
[30;1m5 | [0m[35mfrom mitmproxy.utils import strutils[0m
[30;1m6 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m687[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/eventstore.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m51 | [0m[35m    def emit(self, record: logging.LogRecord) -> None:[0m
[30;1m52 | [0m[35m        entry = LogEntry([0m
[30;1m53 | [0m[35m            msg=self.format(record),[0m
[30;1m54 | [0m[35m            level=log.LOGGING_LEVELS_TO_LOGENTRY.get(record.levelno, "error"),[0m
[30;1m55 | [0m[35m        )[0m
[30;1m56 | [0m[35m        self.event_loop.call_soon_threadsafe(self.callback, entry)[0m

[31m--[ [0m[34mMatch #[0m[33m688[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/utils/human.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport datetime[0m
[30;1m2 | [0m[35mimport functools[0m
[30;1m3 | [0m[35mimport ipaddress[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mSIZE_UNITS = {[0m
[30;1m7 | [0m[35m    "b": 1024**0,[0m
[30;1m8 | [0m[35m    "k": 1024**1,[0m

[31m--[ [0m[34mMatch #[0m[33m689[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m

[31m--[ [0m[34mMatch #[0m[33m690[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m

[31m--[ [0m[34mMatch #[0m[33m691[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m

[31m--[ [0m[34mMatch #[0m[33m692[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m

[31m--[ [0m[34mMatch #[0m[33m693[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m

[31m--[ [0m[34mMatch #[0m[33m694[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m

[31m--[ [0m[34mMatch #[0m[33m695[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m  | [0m[35mw Error()}catch(b){s=b}e()}}catch(b){if(b&&s&&typeof b.stack=="string"){for(var l=b.stack.split(`[0m
[30;1m  | [0m[35m`),h=s.stack.split(`[0m
[30;1m  | [0m[35m`),d=l.length-1,v=h.length-1;1<=d&&0<=v&&l[d]!==h[v];)v--;for(;1<=d&&0<=v;d--,v--)if(l[d]!==h[v]){if[0m

[31m--[ [0m[34mMatch #[0m[33m696[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m  | [0m[35mse{try{throw Error()}catch(b){s=b}e()}}catch(b){if(b&&s&&typeof b.stack=="string"){for(var l=b.stack[0m
[30;1m  | [0m[35m`),h=s.stack.split(`[0m
[30;1m  | [0m[35m`),d=l.length-1,v=h.length-1;1<=d&&0<=v&&l[d]!==h[v];)v--;for(;1<=d&&0<=v;d--,v--)if(l[d]!==h[v]){if[0m

[31m--[ [0m[34mMatch #[0m[33m697[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m

[31m--[ [0m[34mMatch #[0m[33m698[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m699[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m700[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m701[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m702[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m703[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m704[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m705[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m706[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m707[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m708[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m709[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m710[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m711[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m712[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m713[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m714[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m715[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m716[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m717[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m718[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m719[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m720[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m721[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m722[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m723[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m724[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m725[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m726[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m727[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m728[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m729[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m730[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m731[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m732[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/app.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m733[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/proxyserver.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m275 | [0m[35m                    f"Cannot spawn multiple servers on the same address: {dup_addr}"[0m
[30;1m276 | [0m[35m                )[0m
[30;1m277 | [0m[35m[0m
[30;1m278 | [0m[35m            if ctx.options.mode and not ctx.master.addons.get("nextlayer"):[0m
[30;1m279 | [0m[35m                logger.warning("Warning: Running proxyserver without nextlayer addon!")[0m
[30;1m280 | [0m[35m            if any(isinstance(m, mode_specs.TransparentMode) for m in modes):[0m
[30;1m281 | [0m[35m                if platform.original_addr:[0m

[31m--[ [0m[34mMatch #[0m[33m734[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/proxyserver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m293 | [0m[35m                )[0m
[30;1m294 | [0m[35m[0m
[30;1m295 | [0m[35m    async def setup_servers(self) -> bool:[0m
[30;1m296 | [0m[35m        """Setup proxy servers. This may take an indefinite amount of time to complete (e.g. on perm[0m
[30;1m297 | [0m[35m        return await self.servers.update([0m
[30;1m298 | [0m[35m            [mode_specs.ProxyMode.parse(m) for m in ctx.options.mode][0m
[30;1m299 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m735[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/proxyserver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m242 | [0m[35m                    self._connect_addr = None[0m
[30;1m243 | [0m[35m            except ValueError:[0m
[30;1m244 | [0m[35m                raise exceptions.OptionsError([0m
[30;1m245 | [0m[35m                    f"Invalid value for connect_addr: {ctx.options.connect_addr!r}. Specify a valid [0m
[30;1m246 | [0m[35m                )[0m
[30;1m247 | [0m[35m        if "mode" in updated or "server" in updated:[0m
[30;1m248 | [0m[35m            # Make sure that all modes are syntactically valid...[0m

[31m--[ [0m[34mMatch #[0m[33m736[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/proxyserver.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m208 | [0m[35m            "connect_addr",[0m
[30;1m209 | [0m[35m            Optional[str],[0m
[30;1m210 | [0m[35m            None,[0m
[30;1m211 | [0m[35m            """Set the local IP address that mitmproxy should use when connecting to upstream server[0m
[30;1m212 | [0m[35m        )[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35m    def running(self):[0m

[31m--[ [0m[34mMatch #[0m[33m737[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contrib/click/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m103 | [0m[35m                    other way round).[0m
[30;1m104 | [0m[35m    :param strikethrough: if provided this will enable or disable[0m
[30;1m105 | [0m[35m        striking through text.[0m
[30;1m106 | [0m[35m    :param reset: by default a reset-all code is added at the end of the[0m
[30;1m107 | [0m[35m                  string which means that styles do not carry over.  This[0m
[30;1m108 | [0m[35m                  can be disabled to compose styles.[0m
[30;1m109 | [0m[35m    .. versionchanged:: 8.0[0m

[31m--[ [0m[34mMatch #[0m[33m738[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contrib/click/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m55 | [0m[35m    reset: bool = True,[0m
[30;1m56 | [0m[35m) -> str:[0m
[30;1m57 | [0m[35m    """Styles a text with ANSI styles and returns the new string.  By[0m
[30;1m58 | [0m[35m    default the styling is self contained which means that at the end[0m
[30;1m59 | [0m[35m    of the string a reset code is issued.  This can be prevented by[0m
[30;1m60 | [0m[35m    passing ``reset=False``.[0m
[30;1m61 | [0m[35m    Examples::[0m

[31m--[ [0m[34mMatch #[0m[33m739[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m9 | [0m[35mc code.[0m
[30;1m10 | [0m[35m    - Server: the proxy server handles all I/O. This is implemented using `asyncio`, but could be do[0m
[30;1m11 | [0m[35m      The `ConnectionHandler` is subclassed in the `Proxyserver` addon, which handles the communicat[0m
[30;1m12 | [0m[35m      rest of mitmproxy.[0m
[30;1m13 | [0m[35m    - Events: When I/O actions occur at the proxy server, they are passed to the outermost layer as [0m
[30;1m14 | [0m[35m      e.g. `DataReceived` or `ConnectionClosed`.[0m
[30;1m15 | [0m[35m    - Commands: In the other direction, layers can emit commands to higher layers or the proxy serve[0m

[31m--[ [0m[34mMatch #[0m[33m740[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/onboarding.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    async def request(self, f):[0m
[30;1m33 | [0m[35m        if ctx.options.onboarding:[0m
[30;1m34 | [0m[35m            await super().request(f)[0m

[31m--[ [0m[34mMatch #[0m[33m741[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/onboarding.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35m            str,[0m
[30;1m21 | [0m[35m            APP_HOST,[0m
[30;1m22 | [0m[35m            """[0m
[30;1m23 | [0m[35m            Onboarding app domain. For transparent mode, use an IP when a DNS[0m
[30;1m24 | [0m[35m            entry for the app domain is not present.[0m
[30;1m25 | [0m[35m            """,[0m
[30;1m26 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m742[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/io/har.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m115 | [0m[35m    new_flow.response = http.Response([0m
[30;1m116 | [0m[35m        b"HTTP/1.1",[0m
[30;1m117 | [0m[35m        response_code,[0m
[30;1m118 | [0m[35m        http.status_codes.RESPONSES.get(response_code, "").encode(),[0m
[30;1m119 | [0m[35m        response_headers,[0m
[30;1m120 | [0m[35m        response_content,[0m
[30;1m121 | [0m[35m        None,[0m

[31m--[ [0m[34mMatch #[0m[33m743[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/io/har.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m    # Then encode the content, as in `Response.set_content`[0m
[30;1m111 | [0m[35m    response_content = http.encoding.encode([0m
[30;1m112 | [0m[35m        response_content, response_headers.get("content-encoding") or "identity"[0m
[30;1m113 | [0m[35m    )[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m    new_flow.response = http.Response([0m

[31m--[ [0m[34mMatch #[0m[33m744[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/io/har.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m98 | [0m[35m                response_content,[0m
[30;1m99 | [0m[35m                ([0m
[30;1m100 | [0m[35m                    content_encoding[0m
[30;1m101 | [0m[35m                    or infer_content_encoding(response_headers.get("content-type", ""))[0m
[30;1m102 | [0m[35m                ),[0m
[30;1m103 | [0m[35m            )[0m
[30;1m104 | [0m[35m        except ValueError:[0m

[31m--[ [0m[34mMatch #[0m[33m745[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/io/har.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m    # In Firefox HAR files images don't include response bodies[0m
[30;1m88 | [0m[35m    response_content = request_json["response"]["content"].get("text", "")[0m
[30;1m89 | [0m[35m    content_encoding = request_json["response"]["content"].get("encoding", None)[0m
[30;1m90 | [0m[35m    response_headers = fix_headers(request_json["response"]["headers"])[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m    if content_encoding == "base64":[0m

[31m--[ [0m[34mMatch #[0m[33m746[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/io/har.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m    response_code = request_json["response"]["status"][0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m    # In Firefox HAR files images don't include response bodies[0m
[30;1m88 | [0m[35m    response_content = request_json["response"]["content"].get("text", "")[0m
[30;1m89 | [0m[35m    content_encoding = request_json["response"]["content"].get("encoding", None)[0m
[30;1m90 | [0m[35m    response_headers = fix_headers(request_json["response"]["headers"])[0m
[30;1m91 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m747[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/io/har.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m48 | [0m[35m    timestamp_end = timestamp_start + request_json["time"] / 1000.0[0m
[30;1m49 | [0m[35m    request_method = request_json["request"]["method"][0m
[30;1m50 | [0m[35m    request_url = request_json["request"]["url"][0m
[30;1m51 | [0m[35m    server_address = request_json.get("serverIPAddress", None)[0m
[30;1m52 | [0m[35m    request_headers = fix_headers(request_json["request"]["headers"])[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m    http_version_req = request_json["request"]["httpVersion"][0m

[31m--[ [0m[34mMatch #[0m[33m748[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/io/har.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m131 | [0m[35m    new_flow.client_conn.timestamp_start = timestamp_start[0m
[30;1m132 | [0m[35m    new_flow.client_conn.timestamp_end = timestamp_end[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m    # Update HTTP version[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m    match http_version_req:[0m
[30;1m137 | [0m[35m        case "http/2.0":[0m

[31m--[ [0m[34mMatch #[0m[33m749[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/io/har.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m123 | [0m[35m        timestamp_end,[0m
[30;1m124 | [0m[35m    )[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m    # Update timestamps[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    new_flow.request.timestamp_start = timestamp_start[0m
[30;1m129 | [0m[35m    new_flow.request.timestamp_end = timestamp_end[0m

[31m--[ [0m[34mMatch #[0m[33m750[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/io/har.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m64 | [0m[35m    client_conn = connection.Client([0m
[30;1m65 | [0m[35m        peername=("127.0.0.1", 0),[0m
[30;1m66 | [0m[35m        sockname=("127.0.0.1", 0),[0m
[30;1m67 | [0m[35m        # TODO Get time info from HAR File[0m
[30;1m68 | [0m[35m        timestamp_start=time.time(),[0m
[30;1m69 | [0m[35m    )[0m
[30;1m70 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m751[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/io/har.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35mimport logging[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35mfrom datetime import datetime[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mfrom mitmproxy import connection[0m
[30;1m9 | [0m[35mfrom mitmproxy import exceptions[0m

[31m--[ [0m[34mMatch #[0m[33m752[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/io/har.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m"""Reads HAR files into flow objects"""[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35mimport logging[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35mfrom datetime import datetime[0m
[30;1m7 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m753[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/hooks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    def __init_subclass__(cls, **kwargs):[0m
[30;1m35 | [0m[35m        # initialize .name attribute. HttpRequestHook -> http_request[0m
[30;1m36 | [0m[35m        if cls.__dict__.get("name", None) is None:[0m
[30;1m37 | [0m[35m            name = cls.__name__.replace("Hook", "")[0m
[30;1m38 | [0m[35m            cls.name = re.sub("(?!^)([A-Z]+)", r"_\1", name).lower()[0m
[30;1m39 | [0m[35m        if cls.name in all_hooks:[0m

[31m--[ [0m[34mMatch #[0m[33m754[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/hooks.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m88 | [0m[35m@dataclass[0m
[30;1m89 | [0m[35mclass UpdateHook(Hook):[0m
[30;1m90 | [0m[35m    """[0m
[30;1m91 | [0m[35m    Update is called when one or more flow objects have been modified,[0m
[30;1m92 | [0m[35m    usually from a different addon.[0m
[30;1m93 | [0m[35m    """[0m
[30;1m94 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m755[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/hooks.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m80 | [0m[35m@dataclass[0m
[30;1m81 | [0m[35mclass RunningHook(Hook):[0m
[30;1m82 | [0m[35m    """[0m
[30;1m83 | [0m[35m    Called when the proxy is completely up and running. At this point,[0m
[30;1m84 | [0m[35m    you can expect all addons to be loaded and all options to be set.[0m
[30;1m85 | [0m[35m    """[0m
[30;1m86 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m756[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/hooks.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m72 | [0m[35m    the mitmproxy instance, or when mitmproxy itself shuts down. On[0m
[30;1m73 | [0m[35m    shutdown, this event is called after the event loop is[0m
[30;1m74 | [0m[35m    terminated, guaranteeing that it will be the final event an addon[0m
[30;1m75 | [0m[35m    sees. Note that log handlers are shut down at this point, so[0m
[30;1m76 | [0m[35m    calls to log functions will produce no output.[0m
[30;1m77 | [0m[35m    """[0m
[30;1m78 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m757[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/hooks.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m81 | [0m[35mclass RunningHook(Hook):[0m
[30;1m82 | [0m[35m    """[0m
[30;1m83 | [0m[35m    Called when the proxy is completely up and running. At this point,[0m
[30;1m84 | [0m[35m    you can expect all addons to be loaded and all options to be set.[0m
[30;1m85 | [0m[35m    """[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m758[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m  | [0m[35m/invariant"),ReactPropTypesSecret=require("./lib/ReactPropTypesSecret");module.exports=function(){fu[0m
[30;1m  | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m759[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m760[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m761[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m762[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m763[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m764[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m765[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m766[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m767[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m768[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m769[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m770[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m771[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m772[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m773[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m774[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m775[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m776[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m777[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m778[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m779[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m780[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m781[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m782[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m783[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m784[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m785[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m786[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m787[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m788[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m789[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m790[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\.(request|post|get)\([0m

[31m--[ [0m[34mMatch #[0m[33m791[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m

[31m--[ [0m[34mMatch #[0m[33m792[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m

[31m--[ [0m[34mMatch #[0m[33m793[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m

[31m--[ [0m[34mMatch #[0m[33m794[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35mdule.exports=factory;[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35m},{"fbjs/lib/emptyObject":4,"fbjs/lib/invariant":5,"object-assign":35}],3:[function(require,module,e[0m
[30;1m8 | [0m[35m"use strict";var React=require("react"),factory=require("./factory");if(void 0===React)throw Error("[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m},{"./factory":2,"react":"react"}],4:[function(require,module,exports){[0m

[31m--[ [0m[34mMatch #[0m[33m795[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35monNames;ReactPropTypeLocationNames={},module.exports=factory;[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35m},{"fbjs/lib/emptyObject":4,"fbjs/lib/invariant":5,"object-assign":35}],3:[function(require,module,e[0m
[30;1m8 | [0m[35m"use strict";var React=require("react"),factory=require("./factory");if(void 0===React)throw Error("[0m
[30;1m9 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m796[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/web/static/vendor.js[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m

[31m--[ [0m[34mMatch #[0m[33m797[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/io/compat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m503 | [0m[35m[0m
[30;1m504 | [0m[35mdef migrate_flow(flow_data: dict[bytes | str, Any]) -> dict[bytes | str, Any]:[0m
[30;1m505 | [0m[35m    while True:[0m
[30;1m506 | [0m[35m        flow_version = flow_data.get(b"version", flow_data.get("version"))[0m
[30;1m507 | [0m[35m[0m
[30;1m508 | [0m[35m        # Historically, we used the mitmproxy minor version tuple as the flow format version.[0m
[30;1m509 | [0m[35m        if not isinstance(flow_version, int):[0m

[31m--[ [0m[34mMatch #[0m[33m798[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/io/compat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m503 | [0m[35m[0m
[30;1m504 | [0m[35mdef migrate_flow(flow_data: dict[bytes | str, Any]) -> dict[bytes | str, Any]:[0m
[30;1m505 | [0m[35m    while True:[0m
[30;1m506 | [0m[35m        flow_version = flow_data.get(b"version", flow_data.get("version"))[0m
[30;1m507 | [0m[35m[0m
[30;1m508 | [0m[35m        # Historically, we used the mitmproxy minor version tuple as the flow format version.[0m
[30;1m509 | [0m[35m        if not isinstance(flow_version, int):[0m

[31m--[ [0m[34mMatch #[0m[33m799[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/io/compat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m406 | [0m[35m        data[conn].setdefault("transport_protocol", "tcp")[0m
[30;1m407 | [0m[35m[0m
[30;1m408 | [0m[35m        for name in ["peername", "sockname", "address"]:[0m
[30;1m409 | [0m[35m            if data[conn].get(name) and isinstance(data[conn][name][0], bytes):[0m
[30;1m410 | [0m[35m                data[conn][name][0] = data[conn][name][0].decode([0m
[30;1m411 | [0m[35m                    errors="backslashreplace"[0m
[30;1m412 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m800[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/io/compat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m391 | [0m[35mdef convert_18_19(data):[0m
[30;1m392 | [0m[35m    data["version"] = 19[0m
[30;1m393 | [0m[35m    data["client_conn"]["peername"] = data["client_conn"].pop("address", None)[0m
[30;1m394 | [0m[35m    if data["client_conn"].get("timestamp_start") is None:[0m
[30;1m395 | [0m[35m        data["client_conn"]["timestamp_start"] = 0.0[0m
[30;1m396 | [0m[35m    data["client_conn"].pop("tls_extensions")[0m
[30;1m397 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m801[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/io/compat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m370 | [0m[35m[0m
[30;1m371 | [0m[35mdef convert_15_16(data):[0m
[30;1m372 | [0m[35m    data["version"] = 16[0m
[30;1m373 | [0m[35m    data["timestamp_created"] = data.get("request", data["client_conn"])[[0m
[30;1m374 | [0m[35m        "timestamp_start"[0m
[30;1m375 | [0m[35m    ][0m
[30;1m376 | [0m[35m    return data[0m

[31m--[ [0m[34mMatch #[0m[33m802[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/io/compat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m360 | [0m[35m[0m
[30;1m361 | [0m[35mdef convert_14_15(data):[0m
[30;1m362 | [0m[35m    data["version"] = 15[0m
[30;1m363 | [0m[35m    if data.get("websocket", None):[0m
[30;1m364 | [0m[35m        # Add "injected" attribute.[0m
[30;1m365 | [0m[35m        data["websocket"]["messages"] = [[0m
[30;1m366 | [0m[35m            msg + [False] for msg in data["websocket"]["messages"][0m

[31m--[ [0m[34mMatch #[0m[33m803[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/io/compat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m352 | [0m[35m    data["version"] = 14[0m
[30;1m353 | [0m[35m    data["comment"] = ""[0m
[30;1m354 | [0m[35m    # bugfix for https://github.com/mitmproxy/mitmproxy/issues/4576[0m
[30;1m355 | [0m[35m    if data.get("response", None) and data["response"]["timestamp_start"] is None:[0m
[30;1m356 | [0m[35m        data["response"]["timestamp_start"] = data["request"]["timestamp_end"][0m
[30;1m357 | [0m[35m        data["response"]["timestamp_end"] = data["request"]["timestamp_end"] + 1[0m
[30;1m358 | [0m[35m    return data[0m

[31m--[ [0m[34mMatch #[0m[33m804[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/io/compat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m330 | [0m[35m            "closed_by_client": ws_flow["close_sender"] == "client",[0m
[30;1m331 | [0m[35m            "close_code": ws_flow["close_code"],[0m
[30;1m332 | [0m[35m            "close_reason": ws_flow["close_reason"],[0m
[30;1m333 | [0m[35m            "timestamp_end": data.get("server_conn", {}).get("timestamp_end", None),[0m
[30;1m334 | [0m[35m        }[0m
[30;1m335 | [0m[35m[0m
[30;1m336 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m805[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/io/compat.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m330 | [0m[35m            "closed_by_client": ws_flow["close_sender"] == "client",[0m
[30;1m331 | [0m[35m            "close_code": ws_flow["close_code"],[0m
[30;1m332 | [0m[35m            "close_reason": ws_flow["close_reason"],[0m
[30;1m333 | [0m[35m            "timestamp_end": data.get("server_conn", {}).get("timestamp_end", None),[0m
[30;1m334 | [0m[35m        }[0m
[30;1m335 | [0m[35m[0m
[30;1m336 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m806[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/io/compat.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m522 | [0m[35m                "{} cannot read files with flow format version {}{}.".format([0m
[30;1m523 | [0m[35m                    version.MITMPROXY,[0m
[30;1m524 | [0m[35m                    flow_version,[0m
[30;1m525 | [0m[35m                    ", please update mitmproxy" if should_upgrade else "",[0m
[30;1m526 | [0m[35m                )[0m
[30;1m527 | [0m[35m            )[0m
[30;1m528 | [0m[35m    return flow_data[0m

[31m--[ [0m[34mMatch #[0m[33m807[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/termlog.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m    def uninstall(self) -> None:[0m
[30;1m31 | [0m[35m        # uninstall the log dumper.[0m
[30;1m32 | [0m[35m        # This happens at the very very end after done() is completed,[0m
[30;1m33 | [0m[35m        # because we don't want to uninstall while other addons are still logging.[0m
[30;1m34 | [0m[35m        self.logger.uninstall()[0m
[30;1m35 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m808[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/proxy/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m25 | [0m[35m                        "|".join(e.__name__ for e in event_types) or "no events"[0m
[30;1m26 | [0m[35m                    )[0m
[30;1m27 | [0m[35m                    raise AssertionError([0m
[30;1m28 | [0m[35m                        f"Unexpected event type at {f.__qualname__}: "[0m
[30;1m29 | [0m[35m                        f"Expected {event_types_str}, got {event}."[0m
[30;1m30 | [0m[35m                    )[0m
[30;1m31 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m809[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/io/tnetstring.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m164 | [0m[35m    python object.  The file must support the read() method, and this[0m
[30;1m165 | [0m[35m    function promises not to read more data than necessary.[0m
[30;1m166 | [0m[35m    """[0m
[30;1m167 | [0m[35m    #  Read the length prefix one char at a time.[0m
[30;1m168 | [0m[35m    #  Note that the netstring spec explicitly forbids padding zeros.[0m
[30;1m169 | [0m[35m    c = file_handle.read(1)[0m
[30;1m170 | [0m[35m    if c == b"":  # we want to detect this special case.[0m

[31m--[ [0m[34mMatch #[0m[33m810[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/io/tnetstring.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m52 | [0m[35m    This function dumps a python object as a tnetstring.[0m
[30;1m53 | [0m[35m    """[0m
[30;1m54 | [0m[35m    #  This uses a deque to collect output fragments in reverse order,[0m
[30;1m55 | [0m[35m    #  then joins them together at the end.  It's measurably faster[0m
[30;1m56 | [0m[35m    #  than creating all the intermediate strings.[0m
[30;1m57 | [0m[35m    q: collections.deque = collections.deque()[0m
[30;1m58 | [0m[35m    _rdumpq(q, 0, value)[0m

[31m--[ [0m[34mMatch #[0m[33m811[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/io/tnetstring.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m29 | [0m[35mitem from a file or socket without consuming any extra data.[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35mThe tnetstrings specification explicitly states that strings are binary blobs[0m
[30;1m32 | [0m[35mand forbids the use of unicode at the protocol level.[0m
[30;1m33 | [0m[35m**This implementation decodes dictionary keys as surrogate-escaped ASCII**,[0m
[30;1m34 | [0m[35mall other strings are returned as plain bytes.[0m
[30;1m35 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m812[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/io/tnetstring.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m23 | [0m[35m    :load:    load a tnetstring-encoded object from a file[0m
[30;1m24 | [0m[35m    :loads:   load a tnetstring-encoded object from a string[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35mNote that since parsing a tnetstring requires reading all the data into memory[0m
[30;1m27 | [0m[35mat once, there's no efficiency gain from using the file-based versions of these[0m
[30;1m28 | [0m[35mfunctions.  They're only here so you can use load() to read precisely one[0m
[30;1m29 | [0m[35mitem from a file or socket without consuming any extra data.[0m
[30;1m30 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m813[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/platform/linux.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35m    else:[0m
[30;1m30 | [0m[35m        dst = csock.getsockopt(SOL_IPV6, SO_ORIGINAL_DST, 28)[0m
[30;1m31 | [0m[35m        port, raw_ip = struct.unpack_from("!2xH4x16s", dst)[0m
[30;1m32 | [0m[35m        ip = socket.inet_ntop(socket.AF_INET6, raw_ip)[0m
[30;1m33 | [0m[35m    return ip, port[0m

[31m--[ [0m[34mMatch #[0m[33m814[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/platform/linux.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35m        # with buflen=8 doesn't work.[0m
[30;1m26 | [0m[35m        dst = csock.getsockopt(socket.SOL_IP, SO_ORIGINAL_DST, 16)[0m
[30;1m27 | [0m[35m        port, raw_ip = struct.unpack_from("!2xH4s", dst)[0m
[30;1m28 | [0m[35m        ip = socket.inet_ntop(socket.AF_INET, raw_ip)[0m
[30;1m29 | [0m[35m    else:[0m
[30;1m30 | [0m[35m        dst = csock.getsockopt(SOL_IPV6, SO_ORIGINAL_DST, 28)[0m
[30;1m31 | [0m[35m        port, raw_ip = struct.unpack_from("!2xH4x16s", dst)[0m

[31m--[ [0m[34mMatch #[0m[33m815[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/check.py[0m
   Pattern: [32m.hostname[0m
[30;1m28 | [0m[35m        return False[0m
[30;1m29 | [0m[35m    if host_bytes and host_bytes.endswith(b"."):[0m
[30;1m30 | [0m[35m        host_bytes = host_bytes[:-1][0m
[30;1m31 | [0m[35m    # DNS hostname[0m
[30;1m32 | [0m[35m    if all(_label_valid.match(x) for x in host_bytes.split(b".")):[0m
[30;1m33 | [0m[35m        return True[0m
[30;1m34 | [0m[35m    # IPv4/IPv6 address[0m

[31m--[ [0m[34mMatch #[0m[33m816[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/check.py[0m
   Pattern: [32m.hostname[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mdef is_valid_host(host: AnyStr) -> bool:[0m
[30;1m12 | [0m[35m    """[0m
[30;1m13 | [0m[35m    Checks if the passed bytes are a valid DNS hostname or an IPv4/IPv6 address.[0m
[30;1m14 | [0m[35m    """[0m
[30;1m15 | [0m[35m    if isinstance(host, str):[0m
[30;1m16 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m817[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/check.py[0m
   Pattern: [32m.hostname[0m
[30;1m3 | [0m[35mfrom typing import AnyStr[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35m# Allow underscore in host name[0m
[30;1m6 | [0m[35m# Note: This could be a DNS label, a hostname, a FQDN, or an IP[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m_label_valid = re.compile(rb"[A-Z\d\-_]{1,63}$", re.IGNORECASE)[0m
[30;1m9 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m818[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/net/check.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mfrom typing import AnyStr[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35m# Allow underscore in host name[0m
[30;1m6 | [0m[35m# Note: This could be a DNS label, a hostname, a FQDN, or an IP[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m_label_valid = re.compile(rb"[A-Z\d\-_]{1,63}$", re.IGNORECASE)[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m819[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/defaultkeys.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m155 | [0m[35m        "|",[0m
[30;1m156 | [0m[35m        "console.command script.run @focus ",[0m
[30;1m157 | [0m[35m        ["flowlist", "flowview"],[0m
[30;1m158 | [0m[35m        "Run a script on this flow",[0m
[30;1m159 | [0m[35m    )[0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35m    km.add([0m

[31m--[ [0m[34mMatch #[0m[33m820[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/test/tutils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m79 | [0m[35m        timestamp_end=946681201,[0m
[30;1m80 | [0m[35m    )[0m
[30;1m81 | [0m[35m    default.update(kwargs)[0m
[30;1m82 | [0m[35m    return http.Request(**default)  # type: ignore[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35mdef tresp(**kwargs) -> http.Response:[0m

[31m--[ [0m[34mMatch #[0m[33m821[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contentviews/multipart.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35m        # The content_type doesn't have the boundary, so we get it from the header again[0m
[30;1m23 | [0m[35m        headers = getattr(http_message, "headers", None)[0m
[30;1m24 | [0m[35m        if headers:[0m
[30;1m25 | [0m[35m            content_type = headers.get("content-type")[0m
[30;1m26 | [0m[35m        if content_type is None:[0m
[30;1m27 | [0m[35m            return[0m
[30;1m28 | [0m[35m        v = multipart.decode_multipart(content_type, data)[0m

[31m--[ [0m[34mMatch #[0m[33m822[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/master.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m171 | [0m[35m        c = ([0m
[30;1m172 | [0m[35m            os.environ.get("MITMPROXY_EDITOR")[0m
[30;1m173 | [0m[35m            or os.environ.get("PAGER")[0m
[30;1m174 | [0m[35m            or os.environ.get("EDITOR")[0m
[30;1m175 | [0m[35m        )[0m
[30;1m176 | [0m[35m        if not c:[0m
[30;1m177 | [0m[35m            c = "less"[0m

[31m--[ [0m[34mMatch #[0m[33m823[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/master.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m170 | [0m[35m        # hm which one should get priority?[0m
[30;1m171 | [0m[35m        c = ([0m
[30;1m172 | [0m[35m            os.environ.get("MITMPROXY_EDITOR")[0m
[30;1m173 | [0m[35m            or os.environ.get("PAGER")[0m
[30;1m174 | [0m[35m            or os.environ.get("EDITOR")[0m
[30;1m175 | [0m[35m        )[0m
[30;1m176 | [0m[35m        if not c:[0m

[31m--[ [0m[34mMatch #[0m[33m824[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/master.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35m        # hm which one should get priority?[0m
[30;1m171 | [0m[35m        c = ([0m
[30;1m172 | [0m[35m            os.environ.get("MITMPROXY_EDITOR")[0m
[30;1m173 | [0m[35m            or os.environ.get("PAGER")[0m
[30;1m174 | [0m[35m            or os.environ.get("EDITOR")[0m
[30;1m175 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m825[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/master.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m114 | [0m[35m        # based upon https://github.com/pallets/click/blob/main/src/click/_termui_impl.py[0m
[30;1m115 | [0m[35m        if m := os.environ.get("MITMPROXY_EDITOR"):[0m
[30;1m116 | [0m[35m            return m[0m
[30;1m117 | [0m[35m        if m := os.environ.get("EDITOR"):[0m
[30;1m118 | [0m[35m            return m[0m
[30;1m119 | [0m[35m        for editor in "sensible-editor", "nano", "vim":[0m
[30;1m120 | [0m[35m            if shutil.which(editor):[0m

[31m--[ [0m[34mMatch #[0m[33m826[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/master.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m    def get_editor(self) -> str:[0m
[30;1m114 | [0m[35m        # based upon https://github.com/pallets/click/blob/main/src/click/_termui_impl.py[0m
[30;1m115 | [0m[35m        if m := os.environ.get("MITMPROXY_EDITOR"):[0m
[30;1m116 | [0m[35m            return m[0m
[30;1m117 | [0m[35m        if m := os.environ.get("EDITOR"):[0m
[30;1m118 | [0m[35m            return m[0m

[31m--[ [0m[34mMatch #[0m[33m827[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/master.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m175 | [0m[35m        )[0m
[30;1m176 | [0m[35m        if not c:[0m
[30;1m177 | [0m[35m            c = "less"[0m
[30;1m178 | [0m[35m        cmd = shlex.split(c)[0m
[30;1m179 | [0m[35m        cmd.append(name)[0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35m        with self.uistopped():[0m

[31m--[ [0m[34mMatch #[0m[33m828[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/master.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m141 | [0m[35m            c = self.get_hex_editor()[0m
[30;1m142 | [0m[35m        else:[0m
[30;1m143 | [0m[35m            c = self.get_editor()[0m
[30;1m144 | [0m[35m        cmd = shlex.split(c)[0m
[30;1m145 | [0m[35m        cmd.append(name)[0m
[30;1m146 | [0m[35m        with self.uistopped():[0m
[30;1m147 | [0m[35m            try:[0m

[31m--[ [0m[34mMatch #[0m[33m829[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/test/taddons.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m73 | [0m[35m        """[0m
[30;1m74 | [0m[35m        Invoke a command function with a list of string arguments within a command context, mimickin[0m
[30;1m75 | [0m[35m        """[0m
[30;1m76 | [0m[35m        cmd = command.Command(self.master.commands, "test.command", func)[0m
[30;1m77 | [0m[35m        return cmd.call(args)[0m

[31m--[ [0m[34mMatch #[0m[33m830[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/test/taddons.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m66 | [0m[35m        """[0m
[30;1m67 | [0m[35m        Loads a script from path, and returns the enclosed addon.[0m
[30;1m68 | [0m[35m        """[0m
[30;1m69 | [0m[35m        sc = script.Script(path, False)[0m
[30;1m70 | [0m[35m        return sc.addons[0] if sc.addons else None[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m    def command(self, func, *args):[0m

[31m--[ [0m[34mMatch #[0m[33m831[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/test/taddons.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m    def script(self, path):[0m
[30;1m66 | [0m[35m        """[0m
[30;1m67 | [0m[35m        Loads a script from path, and returns the enclosed addon.[0m
[30;1m68 | [0m[35m        """[0m
[30;1m69 | [0m[35m        sc = script.Script(path, False)[0m
[30;1m70 | [0m[35m        return sc.addons[0] if sc.addons else None[0m

[31m--[ [0m[34mMatch #[0m[33m832[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/test/taddons.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35mfrom mitmproxy import eventsequence[0m
[30;1m7 | [0m[35mfrom mitmproxy import hooks[0m
[30;1m8 | [0m[35mfrom mitmproxy.addons import core[0m
[30;1m9 | [0m[35mfrom mitmproxy.addons import script[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mclass context:[0m
[30;1m13 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m833[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/websocket.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35mThis module only defines the classes for individual `WebSocketMessage`s and the `WebSocketData` cont[0m
[30;1m7 | [0m[35m"""[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mimport time[0m
[30;1m10 | [0m[35mimport warnings[0m
[30;1m11 | [0m[35mfrom dataclasses import dataclass[0m
[30;1m12 | [0m[35mfrom dataclasses import field[0m
[30;1m13 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m834[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/tools/console/keybindings.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m15 | [0m[35m        super().__init__(self.get_widget())[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m    def get_widget(self):[0m
[30;1m18 | [0m[35m        cmd = textwrap.dedent(self.binding.command).strip()[0m
[30;1m19 | [0m[35m        parts = [[0m
[30;1m20 | [0m[35m            (4, urwid.Text([("focus", ">> " if self.focused else "   ")])),[0m
[30;1m21 | [0m[35m            (10, urwid.Text([("title", self.binding.key)])),[0m

[31m--[ [0m[34mMatch #[0m[33m835[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/test/tflow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m    messages=True, err=None, close_code=None, close_reason=""[0m
[30;1m68 | [0m[35m) -> http.HTTPFlow:[0m
[30;1m69 | [0m[35m    flow = http.HTTPFlow(tclient_conn(), tserver_conn())[0m
[30;1m70 | [0m[35m    flow.request = http.Request([0m
[30;1m71 | [0m[35m        "example.com",[0m
[30;1m72 | [0m[35m        80,[0m
[30;1m73 | [0m[35m        b"GET",[0m

[31m--[ [0m[34mMatch #[0m[33m836[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contentviews/http3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m            state.message_count += 1[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35m        frames = state.frames.get(flow.messages.index(tcp_message), [])[0m
[30;1m138 | [0m[35m        if not frames:[0m
[30;1m139 | [0m[35m            return ([0m
[30;1m140 | [0m[35m                "HTTP/3",[0m

[31m--[ [0m[34mMatch #[0m[33m837[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/contentviews/http3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m65 | [0m[35m            0x01: "Push Stream",[0m
[30;1m66 | [0m[35m            0x02: "QPACK Encoder Stream",[0m
[30;1m67 | [0m[35m            0x03: "QPACK Decoder Stream",[0m
[30;1m68 | [0m[35m        }.get(self.type, f"0x{self.type:x} Stream")[0m
[30;1m69 | [0m[35m        return [[("header", stream_type)]][0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m838[0m[34m of [0m[33m838[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/mitmproxy/addons/disable_h2c.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m14 | [0m[35m    """[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m    def process_flow(self, f):[0m
[30;1m17 | [0m[35m        if f.request.headers.get("upgrade", "") == "h2c":[0m
[30;1m18 | [0m[35m            logging.warning([0m
[30;1m19 | [0m[35m                "HTTP/2 cleartext connections (h2c upgrade requests) are currently not supported."[0m
[30;1m20 | [0m[35m            )[0m

838 matches found.
