[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m798 | [0m[35m        # with a more complex process than read_image.[0m
[30;1m799 | [0m[35m        for td in self._tiffDirectories:[0m
[30;1m800 | [0m[35m            if td is not None and td is not False and imageKey in td._embeddedImages:[0m
[30;1m801 | [0m[35m                return PIL.Image.open(io.BytesIO(base64.b64decode(td._embeddedImages[imageKey])))[0m
[30;1m802 | [0m[35m        if imageKey in self._associatedImages:[0m
[30;1m803 | [0m[35m            return PIL.Image.fromarray(self._associatedImages[imageKey])[0m
[30;1m804 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m14 | [0m[35m#  limitations under the License.[0m
[30;1m15 | [0m[35m##############################################################################[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mimport base64[0m
[30;1m18 | [0m[35mimport io[0m
[30;1m19 | [0m[35mimport itertools[0m
[30;1m20 | [0m[35mimport json[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m719 | [0m[35m            self._directoryCacheMaxSize = max(20, self.levels * (2 + ([0m
[30;1m720 | [0m[35m                self.metadata.get('IndexRange', {}).get('IndexC', 1))))[0m
[30;1m721 | [0m[35m        key = (dirnum, subdir)[0m
[30;1m722 | [0m[35m        result = self._directoryCache.get(key)[0m
[30;1m723 | [0m[35m        if result is None:[0m
[30;1m724 | [0m[35m            if len(self._directoryCache) >= self._directoryCacheMaxSize:[0m
[30;1m725 | [0m[35m                self._directoryCache = {}[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m717 | [0m[35m        if not hasattr(self, '_directoryCache') or not hasattr(self, '_directoryCacheMaxSize'):[0m
[30;1m718 | [0m[35m            self._directoryCache = {}[0m
[30;1m719 | [0m[35m            self._directoryCacheMaxSize = max(20, self.levels * (2 + ([0m
[30;1m720 | [0m[35m                self.metadata.get('IndexRange', {}).get('IndexC', 1))))[0m
[30;1m721 | [0m[35m        key = (dirnum, subdir)[0m
[30;1m722 | [0m[35m        result = self._directoryCache.get(key)[0m
[30;1m723 | [0m[35m        if result is None:[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m717 | [0m[35m        if not hasattr(self, '_directoryCache') or not hasattr(self, '_directoryCacheMaxSize'):[0m
[30;1m718 | [0m[35m            self._directoryCache = {}[0m
[30;1m719 | [0m[35m            self._directoryCacheMaxSize = max(20, self.levels * (2 + ([0m
[30;1m720 | [0m[35m                self.metadata.get('IndexRange', {}).get('IndexC', 1))))[0m
[30;1m721 | [0m[35m        key = (dirnum, subdir)[0m
[30;1m722 | [0m[35m        result = self._directoryCache.get(key)[0m
[30;1m723 | [0m[35m        if result is None:[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m688 | [0m[35m        try:[0m
[30;1m689 | [0m[35m            if dir is None:[0m
[30;1m690 | [0m[35m                try:[0m
[30;1m691 | [0m[35m                    if not kwargs.get('inSparseFallback'):[0m
[30;1m692 | [0m[35m                        tile, format = self._getTileFromEmptyLevel(x, y, z, **kwargs)[0m
[30;1m693 | [0m[35m                    else:[0m
[30;1m694 | [0m[35m                        raise IOTiffError('Missing z level %d' % z)[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m655 | [0m[35m            if dir:[0m
[30;1m656 | [0m[35m                if hasattr(dir, '_description_record'):[0m
[30;1m657 | [0m[35m                    results['xml' + ([0m
[30;1m658 | [0m[35m                        '' if not results.get('xml') else '_' + str(idx))] = self._xmlToMetadata([0m
[30;1m659 | [0m[35m                            dir._description_record)[0m
[30;1m660 | [0m[35m                for k, v in dir._tiffInfo.items():[0m
[30;1m661 | [0m[35m                    if k == 'imagedescription' and hasattr(dir, '_description_record'):[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m639 | [0m[35m        result = super().getMetadata()[0m
[30;1m640 | [0m[35m        if hasattr(self, '_frames') and len(self._frames) > 1:[0m
[30;1m641 | [0m[35m            result['frames'] = [frame.get('frame', {}) for frame in self._frames][0m
[30;1m642 | [0m[35m            self._addMetadataFrameInformation(result, self._frames[0].get('channels', None))[0m
[30;1m643 | [0m[35m        return result[0m
[30;1m644 | [0m[35m[0m
[30;1m645 | [0m[35m    def getInternalMetadata(self, **kwargs):[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m638 | [0m[35m        """[0m
[30;1m639 | [0m[35m        result = super().getMetadata()[0m
[30;1m640 | [0m[35m        if hasattr(self, '_frames') and len(self._frames) > 1:[0m
[30;1m641 | [0m[35m            result['frames'] = [frame.get('frame', {}) for frame in self._frames][0m
[30;1m642 | [0m[35m            self._addMetadataFrameInformation(result, self._frames[0].get('channels', None))[0m
[30;1m643 | [0m[35m        return result[0m
[30;1m644 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m618 | [0m[35m                    attrList = [attrList][0m
[30;1m619 | [0m[35m                for attr in attrList:[0m
[30;1m620 | [0m[35m                    if 'Array' not in attr:[0m
[30;1m621 | [0m[35m                        values[attr['Name']] = attr.get('text', '')[0m
[30;1m622 | [0m[35m                    else:[0m
[30;1m623 | [0m[35m                        if 'DataObject' in attr['Array']:[0m
[30;1m624 | [0m[35m                            subvalues = self._xmlToMetadata(attr['Array'])[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m597 | [0m[35m        mm_x = pixelInfo.get('mm_x')[0m
[30;1m598 | [0m[35m        mm_y = pixelInfo.get('mm_y')[0m
[30;1m599 | [0m[35m        # Estimate the magnification if we don't have a direct value[0m
[30;1m600 | [0m[35m        mag = pixelInfo.get('magnification') or 0.01 / mm_x if mm_x else None[0m
[30;1m601 | [0m[35m        return {[0m
[30;1m602 | [0m[35m            'magnification': mag,[0m
[30;1m603 | [0m[35m            'mm_x': mm_x,[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m595 | [0m[35m        """[0m
[30;1m596 | [0m[35m        pixelInfo = self._tiffDirectories[-1].pixelInfo[0m
[30;1m597 | [0m[35m        mm_x = pixelInfo.get('mm_x')[0m
[30;1m598 | [0m[35m        mm_y = pixelInfo.get('mm_y')[0m
[30;1m599 | [0m[35m        # Estimate the magnification if we don't have a direct value[0m
[30;1m600 | [0m[35m        mag = pixelInfo.get('magnification') or 0.01 / mm_x if mm_x else None[0m
[30;1m601 | [0m[35m        return {[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m594 | [0m[35m        :return: magnification, width of a pixel in mm, height of a pixel in mm.[0m
[30;1m595 | [0m[35m        """[0m
[30;1m596 | [0m[35m        pixelInfo = self._tiffDirectories[-1].pixelInfo[0m
[30;1m597 | [0m[35m        mm_x = pixelInfo.get('mm_x')[0m
[30;1m598 | [0m[35m        mm_y = pixelInfo.get('mm_y')[0m
[30;1m599 | [0m[35m        # Estimate the magnification if we don't have a direct value[0m
[30;1m600 | [0m[35m        mag = pixelInfo.get('magnification') or 0.01 / mm_x if mm_x else None[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m575 | [0m[35m        try:[0m
[30;1m576 | [0m[35m            xml = topImage._description_record[0m
[30;1m577 | [0m[35m            # Optrascan metadata[0m
[30;1m578 | [0m[35m            scanDetails = xml.get('ScanInfo', xml.get('EncodeInfo'))['ScanDetails'][0m
[30;1m579 | [0m[35m            mag = float(scanDetails['Magnification'])[0m
[30;1m580 | [0m[35m            # In microns; convert to mm[0m
[30;1m581 | [0m[35m            scale = float(scanDetails['PixelResolution']) * 1e-3[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m575 | [0m[35m        try:[0m
[30;1m576 | [0m[35m            xml = topImage._description_record[0m
[30;1m577 | [0m[35m            # Optrascan metadata[0m
[30;1m578 | [0m[35m            scanDetails = xml.get('ScanInfo', xml.get('EncodeInfo'))['ScanDetails'][0m
[30;1m579 | [0m[35m            mag = float(scanDetails['Magnification'])[0m
[30;1m580 | [0m[35m            # In microns; convert to mm[0m
[30;1m581 | [0m[35m            scale = float(scanDetails['PixelResolution']) * 1e-3[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m567 | [0m[35m        :param xml: the xml as a string or bytes object.[0m
[30;1m568 | [0m[35m        :param topImage: the image to add metadata to.[0m
[30;1m569 | [0m[35m        """[0m
[30;1m570 | [0m[35m        if not topImage or topImage.pixelInfo.get('magnificaiton'):[0m
[30;1m571 | [0m[35m            return[0m
[30;1m572 | [0m[35m        topImage.parse_image_description(xml)[0m
[30;1m573 | [0m[35m        if not topImage._description_record:[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m546 | [0m[35m                if image.tobytes()[:6] == b'<?xml ':[0m
[30;1m547 | [0m[35m                    self._parseImageXml(image.tobytes().rsplit(b'>', 1)[0] + b'>', topImage)[0m
[30;1m548 | [0m[35m                    return[0m
[30;1m549 | [0m[35m                image = self._reorient_numpy_image(image, associated._tiffInfo.get('orientation'))[0m
[30;1m550 | [0m[35m                self._associatedImages[id] = image[0m
[30;1m551 | [0m[35m        except (TiffError, AttributeError):[0m
[30;1m552 | [0m[35m            # If we can't validate or read an associated image or it has no[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m529 | [0m[35m            if imageId:[0m
[30;1m530 | [0m[35m                id = imageId[0m
[30;1m531 | [0m[35m            if not id and not mustBeTiled:[0m
[30;1m532 | [0m[35m                id = {1: 'label', 9: 'macro'}.get(associated._tiffInfo.get('subfiletype'))[0m
[30;1m533 | [0m[35m            if not isinstance(id, str):[0m
[30;1m534 | [0m[35m                id = id.decode()[0m
[30;1m535 | [0m[35m            # Only use this as an associated image if the parsed id is[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m529 | [0m[35m            if imageId:[0m
[30;1m530 | [0m[35m                id = imageId[0m
[30;1m531 | [0m[35m            if not id and not mustBeTiled:[0m
[30;1m532 | [0m[35m                id = {1: 'label', 9: 'macro'}.get(associated._tiffInfo.get('subfiletype'))[0m
[30;1m533 | [0m[35m            if not isinstance(id, str):[0m
[30;1m534 | [0m[35m                id = id.decode()[0m
[30;1m535 | [0m[35m            # Only use this as an associated image if the parsed id is[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m517 | [0m[35m        try:[0m
[30;1m518 | [0m[35m            associated = self.getTiffDir(directoryNum, mustBeTiled)[0m
[30;1m519 | [0m[35m            id = ''[0m
[30;1m520 | [0m[35m            desc = associated._tiffInfo.get('imagedescription')[0m
[30;1m521 | [0m[35m            if desc:[0m
[30;1m522 | [0m[35m                id = desc.strip().split(None, 1)[0].lower()[0m
[30;1m523 | [0m[35m                if b'\n' in desc:[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m493 | [0m[35m            for frame in range(len(self._frames)):[0m
[30;1m494 | [0m[35m                dir = self._getDirFromCache(*self._frames[frame]['dirs'][-1])[0m
[30;1m495 | [0m[35m                channels.append(dir._description_record.get([0m
[30;1m496 | [0m[35m                    'PerkinElmer-QPI-ImageDescription', {}).get('Biomarker'))[0m
[30;1m497 | [0m[35m                if channels[-1] is None:[0m
[30;1m498 | [0m[35m                    return[0m
[30;1m499 | [0m[35m            self._frames[0]['channels'] = channels[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m492 | [0m[35m            channels = [][0m
[30;1m493 | [0m[35m            for frame in range(len(self._frames)):[0m
[30;1m494 | [0m[35m                dir = self._getDirFromCache(*self._frames[frame]['dirs'][-1])[0m
[30;1m495 | [0m[35m                channels.append(dir._description_record.get([0m
[30;1m496 | [0m[35m                    'PerkinElmer-QPI-ImageDescription', {}).get('Biomarker'))[0m
[30;1m497 | [0m[35m                if channels[-1] is None:[0m
[30;1m498 | [0m[35m                    return[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m488 | [0m[35m        dir = self._tiffDirectories[-1][0m
[30;1m489 | [0m[35m        if not hasattr(dir, '_description_record'):[0m
[30;1m490 | [0m[35m            return[0m
[30;1m491 | [0m[35m        if dir._description_record.get('PerkinElmer-QPI-ImageDescription', {}).get('Biomarker'):[0m
[30;1m492 | [0m[35m            channels = [][0m
[30;1m493 | [0m[35m            for frame in range(len(self._frames)):[0m
[30;1m494 | [0m[35m                dir = self._getDirFromCache(*self._frames[frame]['dirs'][-1])[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m488 | [0m[35m        dir = self._tiffDirectories[-1][0m
[30;1m489 | [0m[35m        if not hasattr(dir, '_description_record'):[0m
[30;1m490 | [0m[35m            return[0m
[30;1m491 | [0m[35m        if dir._description_record.get('PerkinElmer-QPI-ImageDescription', {}).get('Biomarker'):[0m
[30;1m492 | [0m[35m            channels = [][0m
[30;1m493 | [0m[35m            for frame in range(len(self._frames)):[0m
[30;1m494 | [0m[35m                dir = self._getDirFromCache(*self._frames[frame]['dirs'][-1])[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m483 | [0m[35m    def _checkForVendorSpecificTags(self):[0m
[30;1m484 | [0m[35m        if not hasattr(self, '_frames') or len(self._frames) <= 1:[0m
[30;1m485 | [0m[35m            return[0m
[30;1m486 | [0m[35m        if self._frames[0].get('frame', {}).get('IndexC'):[0m
[30;1m487 | [0m[35m            return[0m
[30;1m488 | [0m[35m        dir = self._tiffDirectories[-1][0m
[30;1m489 | [0m[35m        if not hasattr(dir, '_description_record'):[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m483 | [0m[35m    def _checkForVendorSpecificTags(self):[0m
[30;1m484 | [0m[35m        if not hasattr(self, '_frames') or len(self._frames) <= 1:[0m
[30;1m485 | [0m[35m            return[0m
[30;1m486 | [0m[35m        if self._frames[0].get('frame', {}).get('IndexC'):[0m
[30;1m487 | [0m[35m            return[0m
[30;1m488 | [0m[35m        dir = self._tiffDirectories[-1][0m
[30;1m489 | [0m[35m        if not hasattr(dir, '_description_record'):[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m322 | [0m[35m            tifftools.constants.SampleFormat[sampleformat or 1].name,[0m
[30;1m323 | [0m[35m            bitspersample,[0m
[30;1m324 | [0m[35m        ))[0m
[30;1m325 | [0m[35m        self._bandCount = dir0._tiffInfo.get('samplesperpixel', 1)[0m
[30;1m326 | [0m[35m        info = _cached_read_tiff(self._largeImagePath)[0m
[30;1m327 | [0m[35m        self._info = info[0m
[30;1m328 | [0m[35m        frames = [][0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m317 | [0m[35m            dir0.imageWidth / dir0.tileWidth,[0m
[30;1m318 | [0m[35m            dir0.imageHeight / dir0.tileHeight)) / math.log(2))) + 1)[0m
[30;1m319 | [0m[35m        sampleformat = dir0._tiffInfo.get('sampleformat')[0m
[30;1m320 | [0m[35m        bitspersample = dir0._tiffInfo.get('bitspersample')[0m
[30;1m321 | [0m[35m        self._dtype = np.dtype('%s%d' % ([0m
[30;1m322 | [0m[35m            tifftools.constants.SampleFormat[sampleformat or 1].name,[0m
[30;1m323 | [0m[35m            bitspersample,[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m316 | [0m[35m        self.levels = max(1, int(math.ceil(math.log(max([0m
[30;1m317 | [0m[35m            dir0.imageWidth / dir0.tileWidth,[0m
[30;1m318 | [0m[35m            dir0.imageHeight / dir0.tileHeight)) / math.log(2))) + 1)[0m
[30;1m319 | [0m[35m        sampleformat = dir0._tiffInfo.get('sampleformat')[0m
[30;1m320 | [0m[35m        bitspersample = dir0._tiffInfo.get('bitspersample')[0m
[30;1m321 | [0m[35m        self._dtype = np.dtype('%s%d' % ([0m
[30;1m322 | [0m[35m            tifftools.constants.SampleFormat[sampleformat or 1].name,[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m165 | [0m[35m        self._bandCount = highest._tiffInfo.get('samplesperpixel', 1)[0m
[30;1m166 | [0m[35m        # Sort the directories so that the highest resolution is the last one;[0m
[30;1m167 | [0m[35m        # if a level is missing, put a None value in its place.[0m
[30;1m168 | [0m[35m        self._tiffDirectories = [directories.get(key) for key in[0m
[30;1m169 | [0m[35m                                 range(max(directories.keys()) + 1)][0m
[30;1m170 | [0m[35m        self.tileWidth = highest.tileWidth[0m
[30;1m171 | [0m[35m        self.tileHeight = highest.tileHeight[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m162 | [0m[35m            tifftools.constants.SampleFormat[sampleformat or 1].name,[0m
[30;1m163 | [0m[35m            bitspersample,[0m
[30;1m164 | [0m[35m        ))[0m
[30;1m165 | [0m[35m        self._bandCount = highest._tiffInfo.get('samplesperpixel', 1)[0m
[30;1m166 | [0m[35m        # Sort the directories so that the highest resolution is the last one;[0m
[30;1m167 | [0m[35m        # if a level is missing, put a None value in its place.[0m
[30;1m168 | [0m[35m        self._tiffDirectories = [directories.get(key) for key in[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m157 | [0m[35m            raise TileSourceError(msg)[0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35m        sampleformat = highest._tiffInfo.get('sampleformat')[0m
[30;1m160 | [0m[35m        bitspersample = highest._tiffInfo.get('bitspersample')[0m
[30;1m161 | [0m[35m        self._dtype = np.dtype('%s%d' % ([0m
[30;1m162 | [0m[35m            tifftools.constants.SampleFormat[sampleformat or 1].name,[0m
[30;1m163 | [0m[35m            bitspersample,[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m156 | [0m[35m            msg = 'Tiff image must have at least two levels.'[0m
[30;1m157 | [0m[35m            raise TileSourceError(msg)[0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35m        sampleformat = highest._tiffInfo.get('sampleformat')[0m
[30;1m160 | [0m[35m        bitspersample = highest._tiffInfo.get('bitspersample')[0m
[30;1m161 | [0m[35m        self._dtype = np.dtype('%s%d' % ([0m
[30;1m162 | [0m[35m            tifftools.constants.SampleFormat[sampleformat or 1].name,[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m589 | [0m[35m[0m
[30;1m590 | [0m[35m    def getNativeMagnification(self):[0m
[30;1m591 | [0m[35m        """[0m
[30;1m592 | [0m[35m        Get the magnification at a particular level.[0m
[30;1m593 | [0m[35m[0m
[30;1m594 | [0m[35m        :return: magnification, width of a pixel in mm, height of a pixel in mm.[0m
[30;1m595 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m153 | [0m[35m                    continue[0m
[30;1m154 | [0m[35m            directories[level] = td[0m
[30;1m155 | [0m[35m        if not len(directories) or (len(directories) < 2 and max(directories.keys()) + 1 > 4):[0m
[30;1m156 | [0m[35m            msg = 'Tiff image must have at least two levels.'[0m
[30;1m157 | [0m[35m            raise TileSourceError(msg)[0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35m        sampleformat = highest._tiffInfo.get('sampleformat')[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m3 | [0m[35m#[0m
[30;1m4 | [0m[35m#  Licensed under the Apache License, Version 2.0 ( the "License" );[0m
[30;1m5 | [0m[35m#  you may not use this file except in compliance with the License.[0m
[30;1m6 | [0m[35m#  You may obtain a copy of the License at[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m#    http://www.apache.org/licenses/LICENSE-2.0[0m
[30;1m9 | [0m[35m#[0m
[30;1m10 | [0m[35m#  Unless required by applicable law or agreed to in writing, software[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m793 | [0m[35m        # _associatedImages.  There are some sample files where libtiff's[0m
[30;1m794 | [0m[35m        # read_image fails to read the _associatedImage properly because of[0m
[30;1m795 | [0m[35m        # separated jpeg information.  For the samples we currently have,[0m
[30;1m796 | [0m[35m        # preferring the _embeddedImages is sufficient, but if we find other[0m
[30;1m797 | [0m[35m        # files with seemingly bad associated images, we may need to read them[0m
[30;1m798 | [0m[35m        # with a more complex process than read_image.[0m
[30;1m799 | [0m[35m        for td in self._tiffDirectories:[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m163 | [0m[35m            bitspersample,[0m
[30;1m164 | [0m[35m        ))[0m
[30;1m165 | [0m[35m        self._bandCount = highest._tiffInfo.get('samplesperpixel', 1)[0m
[30;1m166 | [0m[35m        # Sort the directories so that the highest resolution is the last one;[0m
[30;1m167 | [0m[35m        # if a level is missing, put a None value in its place.[0m
[30;1m168 | [0m[35m        self._tiffDirectories = [directories.get(key) for key in[0m
[30;1m169 | [0m[35m                                 range(max(directories.keys()) + 1)][0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m117 | [0m[35m            self.logger.debug(msg)[0m
[30;1m118 | [0m[35m            raise TileSourceError(msg)[0m
[30;1m119 | [0m[35m        # Sort the known directories by image area (width * height).  Given[0m
[30;1m120 | [0m[35m        # equal area, sort by the level.[0m
[30;1m121 | [0m[35m        alldir.sort()[0m
[30;1m122 | [0m[35m        # The highest resolution image is our preferred image[0m
[30;1m123 | [0m[35m        highest = alldir[-1][-1][0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m116 | [0m[35m                self._largeImagePath, lastException)[0m
[30;1m117 | [0m[35m            self.logger.debug(msg)[0m
[30;1m118 | [0m[35m            raise TileSourceError(msg)[0m
[30;1m119 | [0m[35m        # Sort the known directories by image area (width * height).  Given[0m
[30;1m120 | [0m[35m        # equal area, sort by the level.[0m
[30;1m121 | [0m[35m        alldir.sort()[0m
[30;1m122 | [0m[35m        # The highest resolution image is our preferred image[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14 | [0m[35m#  limitations under the License.[0m
[30;1m15 | [0m[35m##############################################################################[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mimport base64[0m
[30;1m18 | [0m[35mimport io[0m
[30;1m19 | [0m[35mimport itertools[0m
[30;1m20 | [0m[35mimport json[0m
[30;1m21 | [0m[35mimport math[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m901 | [0m[35m        Use the underlying _tiffFile to read an image.  But, if it is in a jp2k[0m
[30;1m902 | [0m[35m        encoding, read the raw data and convert it.[0m
[30;1m903 | [0m[35m        """[0m
[30;1m904 | [0m[35m        if self._tiffInfo.get('compression') not in {33003, 33004, 33005, 34712}:[0m
[30;1m905 | [0m[35m            return self._tiffFile.read_image()[0m
[30;1m906 | [0m[35m        output = None[0m
[30;1m907 | [0m[35m        for yidx, y in enumerate(range(0, self.imageHeight, self.tileHeight)):[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m889 | [0m[35m                'MACROIMAGE': 'macro',[0m
[30;1m890 | [0m[35m                'WSI': 'thumbnail',[0m
[30;1m891 | [0m[35m            }[0m
[30;1m892 | [0m[35m            self._embeddedImages[typemap.get(typestr, typestr.lower())] = datastr[0m
[30;1m893 | [0m[35m        try:[0m
[30;1m894 | [0m[35m            self._description_record = etreeToDict(xml)[0m
[30;1m895 | [0m[35m        except Exception:[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m812 | [0m[35m        # Get the whole frame, which is in a JPEG or JPEG 2000 format[0m
[30;1m813 | [0m[35m        frame = self._getJpegFrame(tileNum, True)[0m
[30;1m814 | [0m[35m        # For JP2K, see if we can convert it faster than PIL[0m
[30;1m815 | [0m[35m        if self._tiffInfo.get('compression') in {33003, 33004, 33005, 34712}:[0m
[30;1m816 | [0m[35m            try:[0m
[30;1m817 | [0m[35m                import openjpeg[0m
[30;1m818 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m800 | [0m[35m[0m
[30;1m801 | [0m[35m        imageBuffer = io.BytesIO()[0m
[30;1m802 | [0m[35m[0m
[30;1m803 | [0m[35m        if (self._tiffInfo.get('compression') == libtiff_ctypes.COMPRESSION_JPEG and[0m
[30;1m804 | [0m[35m                not getattr(self, '_completeJpeg', False)):[0m
[30;1m805 | [0m[35m            # Write JPEG Start Of Image marker[0m
[30;1m806 | [0m[35m            imageBuffer.write(b'\xff\xd8')[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m795 | [0m[35m                    33003, 33004, 33005, 34712,[0m
[30;1m796 | [0m[35m                } and ([0m
[30;1m797 | [0m[35m                    self._tiffInfo.get('compression') != libtiff_ctypes.COMPRESSION_JPEG or[0m
[30;1m798 | [0m[35m                    self._tiffInfo.get('photometric') != libtiff_ctypes.PHOTOMETRIC_YCBCR))):[0m
[30;1m799 | [0m[35m            return self._getUncompressedTile(tileNum)[0m
[30;1m800 | [0m[35m[0m
[30;1m801 | [0m[35m        imageBuffer = io.BytesIO()[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m794 | [0m[35m                (asarray and self._tiffInfo.get('compression') not in {[0m
[30;1m795 | [0m[35m                    33003, 33004, 33005, 34712,[0m
[30;1m796 | [0m[35m                } and ([0m
[30;1m797 | [0m[35m                    self._tiffInfo.get('compression') != libtiff_ctypes.COMPRESSION_JPEG or[0m
[30;1m798 | [0m[35m                    self._tiffInfo.get('photometric') != libtiff_ctypes.PHOTOMETRIC_YCBCR))):[0m
[30;1m799 | [0m[35m            return self._getUncompressedTile(tileNum)[0m
[30;1m800 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m791 | [0m[35m                self._tiffInfo.get('bitspersample') != 8 or[0m
[30;1m792 | [0m[35m                self._tiffInfo.get('sampleformat') not in {[0m
[30;1m793 | [0m[35m                    None, libtiff_ctypes.SAMPLEFORMAT_UINT} or[0m
[30;1m794 | [0m[35m                (asarray and self._tiffInfo.get('compression') not in {[0m
[30;1m795 | [0m[35m                    33003, 33004, 33005, 34712,[0m
[30;1m796 | [0m[35m                } and ([0m
[30;1m797 | [0m[35m                    self._tiffInfo.get('compression') != libtiff_ctypes.COMPRESSION_JPEG or[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m789 | [0m[35m                self._tiffInfo.get('compression') not in {[0m
[30;1m790 | [0m[35m                    libtiff_ctypes.COMPRESSION_JPEG, 33003, 33004, 33005, 34712} or[0m
[30;1m791 | [0m[35m                self._tiffInfo.get('bitspersample') != 8 or[0m
[30;1m792 | [0m[35m                self._tiffInfo.get('sampleformat') not in {[0m
[30;1m793 | [0m[35m                    None, libtiff_ctypes.SAMPLEFORMAT_UINT} or[0m
[30;1m794 | [0m[35m                (asarray and self._tiffInfo.get('compression') not in {[0m
[30;1m795 | [0m[35m                    33003, 33004, 33005, 34712,[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m788 | [0m[35m        if (not self._tiffInfo.get('istiled') or[0m
[30;1m789 | [0m[35m                self._tiffInfo.get('compression') not in {[0m
[30;1m790 | [0m[35m                    libtiff_ctypes.COMPRESSION_JPEG, 33003, 33004, 33005, 34712} or[0m
[30;1m791 | [0m[35m                self._tiffInfo.get('bitspersample') != 8 or[0m
[30;1m792 | [0m[35m                self._tiffInfo.get('sampleformat') not in {[0m
[30;1m793 | [0m[35m                    None, libtiff_ctypes.SAMPLEFORMAT_UINT} or[0m
[30;1m794 | [0m[35m                (asarray and self._tiffInfo.get('compression') not in {[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m786 | [0m[35m        tileNum = self._toTileNum(x, y)[0m
[30;1m787 | [0m[35m[0m
[30;1m788 | [0m[35m        if (not self._tiffInfo.get('istiled') or[0m
[30;1m789 | [0m[35m                self._tiffInfo.get('compression') not in {[0m
[30;1m790 | [0m[35m                    libtiff_ctypes.COMPRESSION_JPEG, 33003, 33004, 33005, 34712} or[0m
[30;1m791 | [0m[35m                self._tiffInfo.get('bitspersample') != 8 or[0m
[30;1m792 | [0m[35m                self._tiffInfo.get('sampleformat') not in {[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m785 | [0m[35m        # This raises an InvalidOperationTiffError if the tile doesn't exist[0m
[30;1m786 | [0m[35m        tileNum = self._toTileNum(x, y)[0m
[30;1m787 | [0m[35m[0m
[30;1m788 | [0m[35m        if (not self._tiffInfo.get('istiled') or[0m
[30;1m789 | [0m[35m                self._tiffInfo.get('compression') not in {[0m
[30;1m790 | [0m[35m                    libtiff_ctypes.COMPRESSION_JPEG, 33003, 33004, 33005, 34712} or[0m
[30;1m791 | [0m[35m                self._tiffInfo.get('bitspersample') != 8 or[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m778 | [0m[35m        :rtype: bytes[0m
[30;1m779 | [0m[35m        :raises: InvalidOperationTiffError or IOTiffError[0m
[30;1m780 | [0m[35m        """[0m
[30;1m781 | [0m[35m        if self._tiffInfo.get('orientation') not in {[0m
[30;1m782 | [0m[35m                libtiff_ctypes.ORIENTATION_TOPLEFT,[0m
[30;1m783 | [0m[35m                None}:[0m
[30;1m784 | [0m[35m            return self._getTileRotated(x, y)[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m724 | [0m[35m                libtiff_ctypes.ORIENTATION_RIGHTTOP,[0m
[30;1m725 | [0m[35m                libtiff_ctypes.ORIENTATION_RIGHTBOT}:[0m
[30;1m726 | [0m[35m            tile = tile[:, ::-1][0m
[30;1m727 | [0m[35m        if self._tiffInfo.get('orientation') in {[0m
[30;1m728 | [0m[35m                libtiff_ctypes.ORIENTATION_LEFTTOP,[0m
[30;1m729 | [0m[35m                libtiff_ctypes.ORIENTATION_RIGHTTOP,[0m
[30;1m730 | [0m[35m                libtiff_ctypes.ORIENTATION_RIGHTBOT,[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m718 | [0m[35m                libtiff_ctypes.ORIENTATION_RIGHTBOT,[0m
[30;1m719 | [0m[35m                libtiff_ctypes.ORIENTATION_LEFTBOT}:[0m
[30;1m720 | [0m[35m            tile = tile[::-1, :][0m
[30;1m721 | [0m[35m        if self._tiffInfo.get('orientation') in {[0m
[30;1m722 | [0m[35m                libtiff_ctypes.ORIENTATION_TOPRIGHT,[0m
[30;1m723 | [0m[35m                libtiff_ctypes.ORIENTATION_BOTRIGHT,[0m
[30;1m724 | [0m[35m                libtiff_ctypes.ORIENTATION_RIGHTTOP,[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m712 | [0m[35m        if tile is None:[0m
[30;1m713 | [0m[35m            raise InvalidOperationTiffError([0m
[30;1m714 | [0m[35m                'Tile x=%d, y=%d does not exist' % (x, y))[0m
[30;1m715 | [0m[35m        if self._tiffInfo.get('orientation') in {[0m
[30;1m716 | [0m[35m                libtiff_ctypes.ORIENTATION_BOTRIGHT,[0m
[30;1m717 | [0m[35m                libtiff_ctypes.ORIENTATION_BOTLEFT,[0m
[30;1m718 | [0m[35m                libtiff_ctypes.ORIENTATION_RIGHTBOT,[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m678 | [0m[35m                libtiff_ctypes.ORIENTATION_RIGHTTOP,[0m
[30;1m679 | [0m[35m                libtiff_ctypes.ORIENTATION_RIGHTBOT}:[0m
[30;1m680 | [0m[35m            x0, x1 = iw - x1, iw - x0[0m
[30;1m681 | [0m[35m        if self._tiffInfo.get('orientation') in {[0m
[30;1m682 | [0m[35m                libtiff_ctypes.ORIENTATION_BOTRIGHT,[0m
[30;1m683 | [0m[35m                libtiff_ctypes.ORIENTATION_BOTLEFT,[0m
[30;1m684 | [0m[35m                libtiff_ctypes.ORIENTATION_RIGHTBOT,[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m672 | [0m[35m            iw, ih = ih, iw[0m
[30;1m673 | [0m[35m            tw, th = th, tw[0m
[30;1m674 | [0m[35m            transpose = True[0m
[30;1m675 | [0m[35m        if self._tiffInfo.get('orientation') in {[0m
[30;1m676 | [0m[35m                libtiff_ctypes.ORIENTATION_TOPRIGHT,[0m
[30;1m677 | [0m[35m                libtiff_ctypes.ORIENTATION_BOTRIGHT,[0m
[30;1m678 | [0m[35m                libtiff_ctypes.ORIENTATION_RIGHTTOP,[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m663 | [0m[35m        iw, ih = self._imageWidth, self._imageHeight[0m
[30;1m664 | [0m[35m        tw, th = self._tileWidth, self._tileHeight[0m
[30;1m665 | [0m[35m        transpose = False[0m
[30;1m666 | [0m[35m        if self._tiffInfo.get('orientation') in {[0m
[30;1m667 | [0m[35m                libtiff_ctypes.ORIENTATION_LEFTTOP,[0m
[30;1m668 | [0m[35m                libtiff_ctypes.ORIENTATION_RIGHTTOP,[0m
[30;1m669 | [0m[35m                libtiff_ctypes.ORIENTATION_RIGHTBOT,[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m641 | [0m[35m                'Failed to read from an encoded tile')[0m
[30;1m642 | [0m[35m        if (self._tiffInfo.get('samplesperpixel', 1) == 3 and[0m
[30;1m643 | [0m[35m                self._tiffInfo.get('photometric') == libtiff_ctypes.PHOTOMETRIC_YCBCR):[0m
[30;1m644 | [0m[35m            if self._tiffInfo.get('bitspersample') == 16:[0m
[30;1m645 | [0m[35m                image = np.floor_divide(image, 256).astype(np.uint8)[0m
[30;1m646 | [0m[35m            image = PIL.Image.fromarray(image, 'YCbCr')[0m
[30;1m647 | [0m[35m            image = np.array(image.convert('RGB'))[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m640 | [0m[35m                'Read an unexpected number of bytes from an encoded tile' if readSize >= 0 else[0m
[30;1m641 | [0m[35m                'Failed to read from an encoded tile')[0m
[30;1m642 | [0m[35m        if (self._tiffInfo.get('samplesperpixel', 1) == 3 and[0m
[30;1m643 | [0m[35m                self._tiffInfo.get('photometric') == libtiff_ctypes.PHOTOMETRIC_YCBCR):[0m
[30;1m644 | [0m[35m            if self._tiffInfo.get('bitspersample') == 16:[0m
[30;1m645 | [0m[35m                image = np.floor_divide(image, 256).astype(np.uint8)[0m
[30;1m646 | [0m[35m            image = PIL.Image.fromarray(image, 'YCbCr')[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m639 | [0m[35m            raise IOTiffError([0m
[30;1m640 | [0m[35m                'Read an unexpected number of bytes from an encoded tile' if readSize >= 0 else[0m
[30;1m641 | [0m[35m                'Failed to read from an encoded tile')[0m
[30;1m642 | [0m[35m        if (self._tiffInfo.get('samplesperpixel', 1) == 3 and[0m
[30;1m643 | [0m[35m                self._tiffInfo.get('photometric') == libtiff_ctypes.PHOTOMETRIC_YCBCR):[0m
[30;1m644 | [0m[35m            if self._tiffInfo.get('bitspersample') == 16:[0m
[30;1m645 | [0m[35m                image = np.floor_divide(image, 256).astype(np.uint8)[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m614 | [0m[35m        image = np.empty((th, tw, self._tiffInfo.get('samplesperpixel', 1)),[0m
[30;1m615 | [0m[35m                         dtype=_ctypesFormattbl[format])[0m
[30;1m616 | [0m[35m        imageBuffer = image.ctypes.data_as(ctypes.POINTER(ctypes.c_char))[0m
[30;1m617 | [0m[35m        if self._tiffInfo.get('istiled'):[0m
[30;1m618 | [0m[35m            with self._tileLock:[0m
[30;1m619 | [0m[35m                readSize = libtiff_ctypes.libtiff.TIFFReadEncodedTile([0m
[30;1m620 | [0m[35m                    self._tiffFile, tileNum, imageBuffer, tileSize)[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m611 | [0m[35m            self._tiffInfo.get('bitspersample'),[0m
[30;1m612 | [0m[35m            self._tiffInfo.get('sampleformat') if self._tiffInfo.get([0m
[30;1m613 | [0m[35m                'sampleformat') is not None else libtiff_ctypes.SAMPLEFORMAT_UINT)[0m
[30;1m614 | [0m[35m        image = np.empty((th, tw, self._tiffInfo.get('samplesperpixel', 1)),[0m
[30;1m615 | [0m[35m                         dtype=_ctypesFormattbl[format])[0m
[30;1m616 | [0m[35m        imageBuffer = image.ctypes.data_as(ctypes.POINTER(ctypes.c_char))[0m
[30;1m617 | [0m[35m        if self._tiffInfo.get('istiled'):[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m609 | [0m[35m            tw, th = th, tw[0m
[30;1m610 | [0m[35m        format = ([0m
[30;1m611 | [0m[35m            self._tiffInfo.get('bitspersample'),[0m
[30;1m612 | [0m[35m            self._tiffInfo.get('sampleformat') if self._tiffInfo.get([0m
[30;1m613 | [0m[35m                'sampleformat') is not None else libtiff_ctypes.SAMPLEFORMAT_UINT)[0m
[30;1m614 | [0m[35m        image = np.empty((th, tw, self._tiffInfo.get('samplesperpixel', 1)),[0m
[30;1m615 | [0m[35m                         dtype=_ctypesFormattbl[format])[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m609 | [0m[35m            tw, th = th, tw[0m
[30;1m610 | [0m[35m        format = ([0m
[30;1m611 | [0m[35m            self._tiffInfo.get('bitspersample'),[0m
[30;1m612 | [0m[35m            self._tiffInfo.get('sampleformat') if self._tiffInfo.get([0m
[30;1m613 | [0m[35m                'sampleformat') is not None else libtiff_ctypes.SAMPLEFORMAT_UINT)[0m
[30;1m614 | [0m[35m        image = np.empty((th, tw, self._tiffInfo.get('samplesperpixel', 1)),[0m
[30;1m615 | [0m[35m                         dtype=_ctypesFormattbl[format])[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m608 | [0m[35m                libtiff_ctypes.ORIENTATION_LEFTBOT}:[0m
[30;1m609 | [0m[35m            tw, th = th, tw[0m
[30;1m610 | [0m[35m        format = ([0m
[30;1m611 | [0m[35m            self._tiffInfo.get('bitspersample'),[0m
[30;1m612 | [0m[35m            self._tiffInfo.get('sampleformat') if self._tiffInfo.get([0m
[30;1m613 | [0m[35m                'sampleformat') is not None else libtiff_ctypes.SAMPLEFORMAT_UINT)[0m
[30;1m614 | [0m[35m        image = np.empty((th, tw, self._tiffInfo.get('samplesperpixel', 1)),[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m601 | [0m[35m            stripsCount = min(self._stripsPerTile, self._stripCount - tileNum)[0m
[30;1m602 | [0m[35m            tileSize = stripSize * self._stripsPerTile[0m
[30;1m603 | [0m[35m        tw, th = self._tileWidth, self._tileHeight[0m
[30;1m604 | [0m[35m        if self._tiffInfo.get('orientation') in {[0m
[30;1m605 | [0m[35m                libtiff_ctypes.ORIENTATION_LEFTTOP,[0m
[30;1m606 | [0m[35m                libtiff_ctypes.ORIENTATION_RIGHTTOP,[0m
[30;1m607 | [0m[35m                libtiff_ctypes.ORIENTATION_RIGHTBOT,[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m588 | [0m[35m        :rtype: PIL.Image[0m
[30;1m589 | [0m[35m        :raises: IOTiffError[0m
[30;1m590 | [0m[35m        """[0m
[30;1m591 | [0m[35m        if self._tiffInfo.get('istiled'):[0m
[30;1m592 | [0m[35m            if not hasattr(self, '_uncompressedTileSize'):[0m
[30;1m593 | [0m[35m                with self._tileLock:[0m
[30;1m594 | [0m[35m                    self._uncompressedTileSize = libtiff_ctypes.libtiff.TIFFTileSize([0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m561 | [0m[35m        # If the photometric value is RGB and the JPEG component ids are just[0m
[30;1m562 | [0m[35m        # 0, 1, 2, change the component ids to R, G, B to ensure color space[0m
[30;1m563 | [0m[35m        # information is preserved.[0m
[30;1m564 | [0m[35m        if self._tiffInfo.get('photometric') == libtiff_ctypes.PHOTOMETRIC_RGB:[0m
[30;1m565 | [0m[35m            sof = frameBuffer.raw.find(b'\xff\xc0')[0m
[30;1m566 | [0m[35m            if sof == -1:[0m
[30;1m567 | [0m[35m                sof = frameBuffer.raw.find(b'\xff\xc2')[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m424 | [0m[35m        #         self._tiffFile, pixelX, pixelY, 0, 0) == 0:[0m
[30;1m425 | [0m[35m        #     raise InvalidOperationTiffError([0m
[30;1m426 | [0m[35m        #         'Tile x=%d, y=%d does not exist' % (x, y))[0m
[30;1m427 | [0m[35m        if self._tiffInfo.get('istiled'):[0m
[30;1m428 | [0m[35m            tileNum = pixelX // self._tileWidth + (pixelY // self._tileHeight) * self._tilesAcross[0m
[30;1m429 | [0m[35m        else:[0m
[30;1m430 | [0m[35m            # TIFFComputeStrip with sample=0 is just the row divided by the[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m335 | [0m[35m            self._pixelInfo['mm_y'] = units[info['resolutionunit']] / info['yresolution'][0m
[30;1m336 | [0m[35m        if not self._pixelInfo.get('width') and self._imageWidth:[0m
[30;1m337 | [0m[35m            self._pixelInfo['width'] = self._imageWidth[0m
[30;1m338 | [0m[35m        if not self._pixelInfo.get('height') and self._imageHeight:[0m
[30;1m339 | [0m[35m            self._pixelInfo['height'] = self._imageHeight[0m
[30;1m340 | [0m[35m[0m
[30;1m341 | [0m[35m    @methodcache(key=partial(strhash, '_getJpegTables'))[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m333 | [0m[35m                units.get(info.get('resolutionunit')) and[0m
[30;1m334 | [0m[35m                info.get('yresolution') >= 100):[0m
[30;1m335 | [0m[35m            self._pixelInfo['mm_y'] = units[info['resolutionunit']] / info['yresolution'][0m
[30;1m336 | [0m[35m        if not self._pixelInfo.get('width') and self._imageWidth:[0m
[30;1m337 | [0m[35m            self._pixelInfo['width'] = self._imageWidth[0m
[30;1m338 | [0m[35m        if not self._pixelInfo.get('height') and self._imageHeight:[0m
[30;1m339 | [0m[35m            self._pixelInfo['height'] = self._imageHeight[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m331 | [0m[35m            self._pixelInfo['mm_x'] = units[info['resolutionunit']] / info['xresolution'][0m
[30;1m332 | [0m[35m        if (not self._pixelInfo.get('mm_y') and info.get('yresolution') and[0m
[30;1m333 | [0m[35m                units.get(info.get('resolutionunit')) and[0m
[30;1m334 | [0m[35m                info.get('yresolution') >= 100):[0m
[30;1m335 | [0m[35m            self._pixelInfo['mm_y'] = units[info['resolutionunit']] / info['yresolution'][0m
[30;1m336 | [0m[35m        if not self._pixelInfo.get('width') and self._imageWidth:[0m
[30;1m337 | [0m[35m            self._pixelInfo['width'] = self._imageWidth[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m330 | [0m[35m                info.get('xresolution') >= 100):[0m
[30;1m331 | [0m[35m            self._pixelInfo['mm_x'] = units[info['resolutionunit']] / info['xresolution'][0m
[30;1m332 | [0m[35m        if (not self._pixelInfo.get('mm_y') and info.get('yresolution') and[0m
[30;1m333 | [0m[35m                units.get(info.get('resolutionunit')) and[0m
[30;1m334 | [0m[35m                info.get('yresolution') >= 100):[0m
[30;1m335 | [0m[35m            self._pixelInfo['mm_y'] = units[info['resolutionunit']] / info['yresolution'][0m
[30;1m336 | [0m[35m        if not self._pixelInfo.get('width') and self._imageWidth:[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m330 | [0m[35m                info.get('xresolution') >= 100):[0m
[30;1m331 | [0m[35m            self._pixelInfo['mm_x'] = units[info['resolutionunit']] / info['xresolution'][0m
[30;1m332 | [0m[35m        if (not self._pixelInfo.get('mm_y') and info.get('yresolution') and[0m
[30;1m333 | [0m[35m                units.get(info.get('resolutionunit')) and[0m
[30;1m334 | [0m[35m                info.get('yresolution') >= 100):[0m
[30;1m335 | [0m[35m            self._pixelInfo['mm_y'] = units[info['resolutionunit']] / info['yresolution'][0m
[30;1m336 | [0m[35m        if not self._pixelInfo.get('width') and self._imageWidth:[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m329 | [0m[35m                units.get(info.get('resolutionunit')) and[0m
[30;1m330 | [0m[35m                info.get('xresolution') >= 100):[0m
[30;1m331 | [0m[35m            self._pixelInfo['mm_x'] = units[info['resolutionunit']] / info['xresolution'][0m
[30;1m332 | [0m[35m        if (not self._pixelInfo.get('mm_y') and info.get('yresolution') and[0m
[30;1m333 | [0m[35m                units.get(info.get('resolutionunit')) and[0m
[30;1m334 | [0m[35m                info.get('yresolution') >= 100):[0m
[30;1m335 | [0m[35m            self._pixelInfo['mm_y'] = units[info['resolutionunit']] / info['yresolution'][0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m329 | [0m[35m                units.get(info.get('resolutionunit')) and[0m
[30;1m330 | [0m[35m                info.get('xresolution') >= 100):[0m
[30;1m331 | [0m[35m            self._pixelInfo['mm_x'] = units[info['resolutionunit']] / info['xresolution'][0m
[30;1m332 | [0m[35m        if (not self._pixelInfo.get('mm_y') and info.get('yresolution') and[0m
[30;1m333 | [0m[35m                units.get(info.get('resolutionunit')) and[0m
[30;1m334 | [0m[35m                info.get('yresolution') >= 100):[0m
[30;1m335 | [0m[35m            self._pixelInfo['mm_y'] = units[info['resolutionunit']] / info['yresolution'][0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m327 | [0m[35m        # 96dpi are common defaults, but so are small metric values, too.[0m
[30;1m328 | [0m[35m        if (not self._pixelInfo.get('mm_x') and info.get('xresolution') and[0m
[30;1m329 | [0m[35m                units.get(info.get('resolutionunit')) and[0m
[30;1m330 | [0m[35m                info.get('xresolution') >= 100):[0m
[30;1m331 | [0m[35m            self._pixelInfo['mm_x'] = units[info['resolutionunit']] / info['xresolution'][0m
[30;1m332 | [0m[35m        if (not self._pixelInfo.get('mm_y') and info.get('yresolution') and[0m
[30;1m333 | [0m[35m                units.get(info.get('resolutionunit')) and[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m326 | [0m[35m        # as it is probably just an inaccurate default.  Values like 72dpi and[0m
[30;1m327 | [0m[35m        # 96dpi are common defaults, but so are small metric values, too.[0m
[30;1m328 | [0m[35m        if (not self._pixelInfo.get('mm_x') and info.get('xresolution') and[0m
[30;1m329 | [0m[35m                units.get(info.get('resolutionunit')) and[0m
[30;1m330 | [0m[35m                info.get('xresolution') >= 100):[0m
[30;1m331 | [0m[35m            self._pixelInfo['mm_x'] = units[info['resolutionunit']] / info['xresolution'][0m
[30;1m332 | [0m[35m        if (not self._pixelInfo.get('mm_y') and info.get('yresolution') and[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m326 | [0m[35m        # as it is probably just an inaccurate default.  Values like 72dpi and[0m
[30;1m327 | [0m[35m        # 96dpi are common defaults, but so are small metric values, too.[0m
[30;1m328 | [0m[35m        if (not self._pixelInfo.get('mm_x') and info.get('xresolution') and[0m
[30;1m329 | [0m[35m                units.get(info.get('resolutionunit')) and[0m
[30;1m330 | [0m[35m                info.get('xresolution') >= 100):[0m
[30;1m331 | [0m[35m            self._pixelInfo['mm_x'] = units[info['resolutionunit']] / info['xresolution'][0m
[30;1m332 | [0m[35m        if (not self._pixelInfo.get('mm_y') and info.get('yresolution') and[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m325 | [0m[35m        # If the resolution value is less than a threshold (100), don't use it,[0m
[30;1m326 | [0m[35m        # as it is probably just an inaccurate default.  Values like 72dpi and[0m
[30;1m327 | [0m[35m        # 96dpi are common defaults, but so are small metric values, too.[0m
[30;1m328 | [0m[35m        if (not self._pixelInfo.get('mm_x') and info.get('xresolution') and[0m
[30;1m329 | [0m[35m                units.get(info.get('resolutionunit')) and[0m
[30;1m330 | [0m[35m                info.get('xresolution') >= 100):[0m
[30;1m331 | [0m[35m            self._pixelInfo['mm_x'] = units[info['resolutionunit']] / info['xresolution'][0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m325 | [0m[35m        # If the resolution value is less than a threshold (100), don't use it,[0m
[30;1m326 | [0m[35m        # as it is probably just an inaccurate default.  Values like 72dpi and[0m
[30;1m327 | [0m[35m        # 96dpi are common defaults, but so are small metric values, too.[0m
[30;1m328 | [0m[35m        if (not self._pixelInfo.get('mm_x') and info.get('xresolution') and[0m
[30;1m329 | [0m[35m                units.get(info.get('resolutionunit')) and[0m
[30;1m330 | [0m[35m                info.get('xresolution') >= 100):[0m
[30;1m331 | [0m[35m            self._pixelInfo['mm_x'] = units[info['resolutionunit']] / info['xresolution'][0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m319 | [0m[35m                libtiff_ctypes.ORIENTATION_LEFTBOT}:[0m
[30;1m320 | [0m[35m            self._imageWidth, self._imageHeight = self._imageHeight, self._imageWidth[0m
[30;1m321 | [0m[35m            self._tileWidth, self._tileHeight = self._tileHeight, self._tileWidth[0m
[30;1m322 | [0m[35m        self.parse_image_description(info.get('imagedescription', ''))[0m
[30;1m323 | [0m[35m        # From TIFF specification, tag 0x128, 2 is inches, 3 is centimeters.[0m
[30;1m324 | [0m[35m        units = {2: 25.4, 3: 10}[0m
[30;1m325 | [0m[35m        # If the resolution value is less than a threshold (100), don't use it,[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m312 | [0m[35m            self._stripHeight = self._tileHeight[0m
[30;1m313 | [0m[35m            self._tileHeight = self._stripHeight * self._stripsPerTile[0m
[30;1m314 | [0m[35m            self._stripCount = int(math.ceil(float(self._imageHeight) / self._stripHeight))[0m
[30;1m315 | [0m[35m        if info.get('orientation') in {[0m
[30;1m316 | [0m[35m                libtiff_ctypes.ORIENTATION_LEFTTOP,[0m
[30;1m317 | [0m[35m                libtiff_ctypes.ORIENTATION_RIGHTTOP,[0m
[30;1m318 | [0m[35m                libtiff_ctypes.ORIENTATION_RIGHTBOT,[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m307 | [0m[35m        self._imageWidth = info.get('imagewidth')[0m
[30;1m308 | [0m[35m        self._imageHeight = info.get('imagelength')[0m
[30;1m309 | [0m[35m        self._tilesAcross = (self._imageWidth + self._tileWidth - 1) // self._tileWidth[0m
[30;1m310 | [0m[35m        if not info.get('tilelength'):[0m
[30;1m311 | [0m[35m            self._stripsPerTile = int(max(1, math.ceil(256.0 / self._tileHeight)))[0m
[30;1m312 | [0m[35m            self._stripHeight = self._tileHeight[0m
[30;1m313 | [0m[35m            self._tileHeight = self._stripHeight * self._stripsPerTile[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m305 | [0m[35m        self._tileWidth = info.get('tilewidth') or info.get('imagewidth')[0m
[30;1m306 | [0m[35m        self._tileHeight = info.get('tilelength') or info.get('rowsperstrip')[0m
[30;1m307 | [0m[35m        self._imageWidth = info.get('imagewidth')[0m
[30;1m308 | [0m[35m        self._imageHeight = info.get('imagelength')[0m
[30;1m309 | [0m[35m        self._tilesAcross = (self._imageWidth + self._tileWidth - 1) // self._tileWidth[0m
[30;1m310 | [0m[35m        if not info.get('tilelength'):[0m
[30;1m311 | [0m[35m            self._stripsPerTile = int(max(1, math.ceil(256.0 / self._tileHeight)))[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m304 | [0m[35m        self._tiffInfo = info[0m
[30;1m305 | [0m[35m        self._tileWidth = info.get('tilewidth') or info.get('imagewidth')[0m
[30;1m306 | [0m[35m        self._tileHeight = info.get('tilelength') or info.get('rowsperstrip')[0m
[30;1m307 | [0m[35m        self._imageWidth = info.get('imagewidth')[0m
[30;1m308 | [0m[35m        self._imageHeight = info.get('imagelength')[0m
[30;1m309 | [0m[35m        self._tilesAcross = (self._imageWidth + self._tileWidth - 1) // self._tileWidth[0m
[30;1m310 | [0m[35m        if not info.get('tilelength'):[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m303 | [0m[35m                    info[func.lower()] = value[0m
[30;1m304 | [0m[35m        self._tiffInfo = info[0m
[30;1m305 | [0m[35m        self._tileWidth = info.get('tilewidth') or info.get('imagewidth')[0m
[30;1m306 | [0m[35m        self._tileHeight = info.get('tilelength') or info.get('rowsperstrip')[0m
[30;1m307 | [0m[35m        self._imageWidth = info.get('imagewidth')[0m
[30;1m308 | [0m[35m        self._imageHeight = info.get('imagelength')[0m
[30;1m309 | [0m[35m        self._tilesAcross = (self._imageWidth + self._tileWidth - 1) // self._tileWidth[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m303 | [0m[35m                    info[func.lower()] = value[0m
[30;1m304 | [0m[35m        self._tiffInfo = info[0m
[30;1m305 | [0m[35m        self._tileWidth = info.get('tilewidth') or info.get('imagewidth')[0m
[30;1m306 | [0m[35m        self._tileHeight = info.get('tilelength') or info.get('rowsperstrip')[0m
[30;1m307 | [0m[35m        self._imageWidth = info.get('imagewidth')[0m
[30;1m308 | [0m[35m        self._imageHeight = info.get('imagelength')[0m
[30;1m309 | [0m[35m        self._tilesAcross = (self._imageWidth + self._tileWidth - 1) // self._tileWidth[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m302 | [0m[35m                if value:[0m
[30;1m303 | [0m[35m                    info[func.lower()] = value[0m
[30;1m304 | [0m[35m        self._tiffInfo = info[0m
[30;1m305 | [0m[35m        self._tileWidth = info.get('tilewidth') or info.get('imagewidth')[0m
[30;1m306 | [0m[35m        self._tileHeight = info.get('tilelength') or info.get('rowsperstrip')[0m
[30;1m307 | [0m[35m        self._imageWidth = info.get('imagewidth')[0m
[30;1m308 | [0m[35m        self._imageHeight = info.get('imagelength')[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m302 | [0m[35m                if value:[0m
[30;1m303 | [0m[35m                    info[func.lower()] = value[0m
[30;1m304 | [0m[35m        self._tiffInfo = info[0m
[30;1m305 | [0m[35m        self._tileWidth = info.get('tilewidth') or info.get('imagewidth')[0m
[30;1m306 | [0m[35m        self._tileHeight = info.get('tilelength') or info.get('rowsperstrip')[0m
[30;1m307 | [0m[35m        self._imageWidth = info.get('imagewidth')[0m
[30;1m308 | [0m[35m        self._imageHeight = info.get('imagelength')[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m276 | [0m[35m            msg = 'Only TIFF files with separate Huffman and quantization tables are supported'[0m
[30;1m277 | [0m[35m            raise ValidationTiffError(msg)[0m
[30;1m278 | [0m[35m[0m
[30;1m279 | [0m[35m        if self._tiffInfo.get('compression') == libtiff_ctypes.COMPRESSION_JPEG:[0m
[30;1m280 | [0m[35m            try:[0m
[30;1m281 | [0m[35m                self._getJpegTables()[0m
[30;1m282 | [0m[35m            except IOTiffError:[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m270 | [0m[35m            raise ValidationTiffError(msg)[0m
[30;1m271 | [0m[35m[0m
[30;1m272 | [0m[35m        if (self._tiffInfo.get('compression') == libtiff_ctypes.COMPRESSION_JPEG and[0m
[30;1m273 | [0m[35m                self._tiffInfo.get('jpegtablesmode') !=[0m
[30;1m274 | [0m[35m                libtiff_ctypes.JPEGTABLESMODE_QUANT |[0m
[30;1m275 | [0m[35m                libtiff_ctypes.JPEGTABLESMODE_HUFF):[0m
[30;1m276 | [0m[35m            msg = 'Only TIFF files with separate Huffman and quantization tables are supported'[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m269 | [0m[35m            msg = 'A non-tiled TIFF with strips is required.'[0m
[30;1m270 | [0m[35m            raise ValidationTiffError(msg)[0m
[30;1m271 | [0m[35m[0m
[30;1m272 | [0m[35m        if (self._tiffInfo.get('compression') == libtiff_ctypes.COMPRESSION_JPEG and[0m
[30;1m273 | [0m[35m                self._tiffInfo.get('jpegtablesmode') !=[0m
[30;1m274 | [0m[35m                libtiff_ctypes.JPEGTABLESMODE_QUANT |[0m
[30;1m275 | [0m[35m                libtiff_ctypes.JPEGTABLESMODE_HUFF):[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35m        if self._mustBeTiled is False and ([0m
[30;1m267 | [0m[35m                self._tiffInfo.get('istiled') or[0m
[30;1m268 | [0m[35m                not self._tiffInfo.get('rowsperstrip')):[0m
[30;1m269 | [0m[35m            msg = 'A non-tiled TIFF with strips is required.'[0m
[30;1m270 | [0m[35m            raise ValidationTiffError(msg)[0m
[30;1m271 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m264 | [0m[35m            raise ValidationTiffError(msg)[0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35m        if self._mustBeTiled is False and ([0m
[30;1m267 | [0m[35m                self._tiffInfo.get('istiled') or[0m
[30;1m268 | [0m[35m                not self._tiffInfo.get('rowsperstrip')):[0m
[30;1m269 | [0m[35m            msg = 'A non-tiled TIFF with strips is required.'[0m
[30;1m270 | [0m[35m            raise ValidationTiffError(msg)[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m259 | [0m[35m        if self._mustBeTiled and ([0m
[30;1m260 | [0m[35m                not self._tiffInfo.get('istiled') or[0m
[30;1m261 | [0m[35m                not self._tiffInfo.get('tilewidth') or[0m
[30;1m262 | [0m[35m                not self._tiffInfo.get('tilelength')):[0m
[30;1m263 | [0m[35m            msg = 'A tiled TIFF is required.'[0m
[30;1m264 | [0m[35m            raise ValidationTiffError(msg)[0m
[30;1m265 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m258 | [0m[35m[0m
[30;1m259 | [0m[35m        if self._mustBeTiled and ([0m
[30;1m260 | [0m[35m                not self._tiffInfo.get('istiled') or[0m
[30;1m261 | [0m[35m                not self._tiffInfo.get('tilewidth') or[0m
[30;1m262 | [0m[35m                not self._tiffInfo.get('tilelength')):[0m
[30;1m263 | [0m[35m            msg = 'A tiled TIFF is required.'[0m
[30;1m264 | [0m[35m            raise ValidationTiffError(msg)[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m257 | [0m[35m            raise ValidationTiffError(msg)[0m
[30;1m258 | [0m[35m[0m
[30;1m259 | [0m[35m        if self._mustBeTiled and ([0m
[30;1m260 | [0m[35m                not self._tiffInfo.get('istiled') or[0m
[30;1m261 | [0m[35m                not self._tiffInfo.get('tilewidth') or[0m
[30;1m262 | [0m[35m                not self._tiffInfo.get('tilelength')):[0m
[30;1m263 | [0m[35m            msg = 'A tiled TIFF is required.'[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m243 | [0m[35m                   'interpretation TIFF files are supported')[0m
[30;1m244 | [0m[35m            raise ValidationTiffError(msg)[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m        if self._tiffInfo.get('orientation') not in {[0m
[30;1m247 | [0m[35m                libtiff_ctypes.ORIENTATION_TOPLEFT,[0m
[30;1m248 | [0m[35m                libtiff_ctypes.ORIENTATION_TOPRIGHT,[0m
[30;1m249 | [0m[35m                libtiff_ctypes.ORIENTATION_BOTRIGHT,[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m235 | [0m[35m            msg = 'Only contiguous planar configuration TIFF files are supported'[0m
[30;1m236 | [0m[35m            raise ValidationTiffError(msg)[0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m        if self._tiffInfo.get('photometric') not in {[0m
[30;1m239 | [0m[35m                libtiff_ctypes.PHOTOMETRIC_MINISBLACK,[0m
[30;1m240 | [0m[35m                libtiff_ctypes.PHOTOMETRIC_RGB,[0m
[30;1m241 | [0m[35m                libtiff_ctypes.PHOTOMETRIC_YCBCR}:[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m230 | [0m[35m            raise ValidationTiffError(msg)[0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35m        if (self._tiffInfo.get('planarconfig') != libtiff_ctypes.PLANARCONFIG_CONTIG and[0m
[30;1m233 | [0m[35m                self._tiffInfo.get('photometric') not in {[0m
[30;1m234 | [0m[35m                    libtiff_ctypes.PHOTOMETRIC_MINISBLACK}):[0m
[30;1m235 | [0m[35m            msg = 'Only contiguous planar configuration TIFF files are supported'[0m
[30;1m236 | [0m[35m            raise ValidationTiffError(msg)[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m229 | [0m[35m            msg = 'Only unsigned int sampled TIFF files are supported'[0m
[30;1m230 | [0m[35m            raise ValidationTiffError(msg)[0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35m        if (self._tiffInfo.get('planarconfig') != libtiff_ctypes.PLANARCONFIG_CONTIG and[0m
[30;1m233 | [0m[35m                self._tiffInfo.get('photometric') not in {[0m
[30;1m234 | [0m[35m                    libtiff_ctypes.PHOTOMETRIC_MINISBLACK}):[0m
[30;1m235 | [0m[35m            msg = 'Only contiguous planar configuration TIFF files are supported'[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m221 | [0m[35m            msg = 'Only 8 and 16 bits-per-sample TIFF files are supported'[0m
[30;1m222 | [0m[35m            raise ValidationTiffError(msg)[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m        if self._tiffInfo.get('sampleformat') not in {[0m
[30;1m225 | [0m[35m                None,  # default is still SAMPLEFORMAT_UINT[0m
[30;1m226 | [0m[35m                libtiff_ctypes.SAMPLEFORMAT_UINT,[0m
[30;1m227 | [0m[35m                libtiff_ctypes.SAMPLEFORMAT_INT,[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m217 | [0m[35m            msg = 'Only RGB and greyscale TIFF files are supported'[0m
[30;1m218 | [0m[35m            raise ValidationTiffError(msg)[0m
[30;1m219 | [0m[35m[0m
[30;1m220 | [0m[35m        if self._tiffInfo.get('bitspersample') not in (8, 16, 32, 64):[0m
[30;1m221 | [0m[35m            msg = 'Only 8 and 16 bits-per-sample TIFF files are supported'[0m
[30;1m222 | [0m[35m            raise ValidationTiffError(msg)[0m
[30;1m223 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m213 | [0m[35m        # should only be done if necessary, which would require the conversion[0m
[30;1m214 | [0m[35m        # job to check output and perform subsequent processing as needed.[0m
[30;1m215 | [0m[35m        if (not self._tiffInfo.get('samplesperpixel', 1) or[0m
[30;1m216 | [0m[35m                self._tiffInfo.get('samplesperpixel', 1) < 1):[0m
[30;1m217 | [0m[35m            msg = 'Only RGB and greyscale TIFF files are supported'[0m
[30;1m218 | [0m[35m            raise ValidationTiffError(msg)[0m
[30;1m219 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m212 | [0m[35m        # the create_image.py script, such as flatten or colourspace.  These[0m
[30;1m213 | [0m[35m        # should only be done if necessary, which would require the conversion[0m
[30;1m214 | [0m[35m        # job to check output and perform subsequent processing as needed.[0m
[30;1m215 | [0m[35m        if (not self._tiffInfo.get('samplesperpixel', 1) or[0m
[30;1m216 | [0m[35m                self._tiffInfo.get('samplesperpixel', 1) < 1):[0m
[30;1m217 | [0m[35m            msg = 'Only RGB and greyscale TIFF files are supported'[0m
[30;1m218 | [0m[35m            raise ValidationTiffError(msg)[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m205 | [0m[35m        :raises: ValidationTiffError[0m
[30;1m206 | [0m[35m        """[0m
[30;1m207 | [0m[35m        if not self._mustBeTiled:[0m
[30;1m208 | [0m[35m            if self._mustBeTiled is not None and self._tiffInfo.get('istiled'):[0m
[30;1m209 | [0m[35m                msg = 'Expected a non-tiled TIFF file'[0m
[30;1m210 | [0m[35m                raise ValidationTiffError(msg)[0m
[30;1m211 | [0m[35m        # For any non-supported file, we probably can add a conversion task in[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m549 | [0m[35m            frameStartPos = 2[0m
[30;1m550 | [0m[35m        else:[0m
[30;1m551 | [0m[35m            # VIPS may encode TIFFs with the quantization (but not Huffman)[0m
[30;1m552 | [0m[35m            # tables also at the start of every frame, so locate them for[0m
[30;1m553 | [0m[35m            # removal[0m
[30;1m554 | [0m[35m            # VIPS seems to prefer Baseline DCT, so search for that first[0m
[30;1m555 | [0m[35m            frameStartPos = frameBuffer.raw.find(b'\xff\xc0', 2, -2)[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m3 | [0m[35m#[0m
[30;1m4 | [0m[35m#  Licensed under the Apache License, Version 2.0 ( the "License" );[0m
[30;1m5 | [0m[35m#  you may not use this file except in compliance with the License.[0m
[30;1m6 | [0m[35m#  You may obtain a copy of the License at[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m#    http://www.apache.org/licenses/LICENSE-2.0[0m
[30;1m9 | [0m[35m#[0m
[30;1m10 | [0m[35m#  Unless required by applicable law or agreed to in writing, software[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/tiff_reader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35mexcept ValueError as exc:[0m
[30;1m39 | [0m[35m    # If the python libtiff module doesn't contain a pregenerated module for[0m
[30;1m40 | [0m[35m    # the appropriate version of libtiff, it tries to generate a module from[0m
[30;1m41 | [0m[35m    # the libtiff header file.  If it can't find this file (possibly because it[0m
[30;1m42 | [0m[35m    # is in a virtual environment), it raises a ValueError instead of an[0m
[30;1m43 | [0m[35m    # ImportError.  We convert this to an ImportError, so that we will print a[0m
[30;1m44 | [0m[35m    # more lucid error message and just fail to load this one tile source[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m113[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/large_image_source_tiff/girder_source.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m3 | [0m[35m#[0m
[30;1m4 | [0m[35m#  Licensed under the Apache License, Version 2.0 ( the "License" );[0m
[30;1m5 | [0m[35m#  you may not use this file except in compliance with the License.[0m
[30;1m6 | [0m[35m#  You may obtain a copy of the License at[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m#    http://www.apache.org/licenses/LICENSE-2.0[0m
[30;1m9 | [0m[35m#[0m
[30;1m10 | [0m[35m#  Unless required by applicable law or agreed to in writing, software[0m

113 matches found.
