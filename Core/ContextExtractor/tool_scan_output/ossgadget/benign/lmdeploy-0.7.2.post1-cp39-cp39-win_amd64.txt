[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/serve/openai/api_client.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m321 | [0m[35m            session_id: determine which instance will be called.[0m
[30;1m322 | [0m[35m                If not specified with a value other than -1, using random value[0m
[30;1m323 | [0m[35m                directly.[0m
[30;1m324 | [0m[35m            image_url (str | List[str] | None): the image url or base64 encoded[0m
[30;1m325 | [0m[35m                string for VL models.[0m
[30;1m326 | [0m[35m            stream: whether to stream the results or not.[0m
[30;1m327 | [0m[35m            stop: whether to stop the session response or not.[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/serve/openai/api_client.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m        Args:[0m
[30;1m195 | [0m[35m            prompt: the prompt to use for the generation.[0m
[30;1m196 | [0m[35m            image_url (str | List[str] | None): the image url or base64 encoded[0m
[30;1m197 | [0m[35m                string for VL models.[0m
[30;1m198 | [0m[35m            session_id: determine which instance will be called.[0m
[30;1m199 | [0m[35m                If not specified with a value other than -1, using random value[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m801 | [0m[35m[0m
[30;1m802 | [0m[35m    The request should be a JSON object with the following fields:[0m
[30;1m803 | [0m[35m    - prompt: the prompt to use for the generation.[0m
[30;1m804 | [0m[35m    - image_url(str | List[str] | None): the image url or base64 encoded string[0m
[30;1m805 | [0m[35m        for VL models.[0m
[30;1m806 | [0m[35m    - session_id: determine which instance will be called. If not specified[0m
[30;1m807 | [0m[35m        with a value other than -1, using random value directly.[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1098 | [0m[35m    if api_keys is not None:[0m
[30;1m1099 | [0m[35m        if isinstance(api_keys, str):[0m
[30;1m1100 | [0m[35m            api_keys = api_keys.split(',')[0m
[30;1m1101 | [0m[35m        VariableInterface.api_keys = api_keys[0m
[30;1m1102 | [0m[35m    ssl_keyfile, ssl_certfile, http_or_https = None, None, 'http'[0m
[30;1m1103 | [0m[35m    if ssl:[0m
[30;1m1104 | [0m[35m        ssl_keyfile = os.environ['SSL_KEYFILE'][0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1098 | [0m[35m    if api_keys is not None:[0m
[30;1m1099 | [0m[35m        if isinstance(api_keys, str):[0m
[30;1m1100 | [0m[35m            api_keys = api_keys.split(',')[0m
[30;1m1101 | [0m[35m        VariableInterface.api_keys = api_keys[0m
[30;1m1102 | [0m[35m    ssl_keyfile, ssl_certfile, http_or_https = None, None, 'http'[0m
[30;1m1103 | [0m[35m    if ssl:[0m
[30;1m1104 | [0m[35m        ssl_keyfile = os.environ['SSL_KEYFILE'][0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1097 | [0m[35m[0m
[30;1m1098 | [0m[35m    if api_keys is not None:[0m
[30;1m1099 | [0m[35m        if isinstance(api_keys, str):[0m
[30;1m1100 | [0m[35m            api_keys = api_keys.split(',')[0m
[30;1m1101 | [0m[35m        VariableInterface.api_keys = api_keys[0m
[30;1m1102 | [0m[35m    ssl_keyfile, ssl_certfile, http_or_https = None, None, 'http'[0m
[30;1m1103 | [0m[35m    if ssl:[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1097 | [0m[35m[0m
[30;1m1098 | [0m[35m    if api_keys is not None:[0m
[30;1m1099 | [0m[35m        if isinstance(api_keys, str):[0m
[30;1m1100 | [0m[35m            api_keys = api_keys.split(',')[0m
[30;1m1101 | [0m[35m        VariableInterface.api_keys = api_keys[0m
[30;1m1102 | [0m[35m    ssl_keyfile, ssl_certfile, http_or_https = None, None, 'http'[0m
[30;1m1103 | [0m[35m    if ssl:[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1096 | [0m[35m        app.add_middleware(ConcurrencyLimitMiddleware, max_concurrent_requests=max_concurrent_reques[0m
[30;1m1097 | [0m[35m[0m
[30;1m1098 | [0m[35m    if api_keys is not None:[0m
[30;1m1099 | [0m[35m        if isinstance(api_keys, str):[0m
[30;1m1100 | [0m[35m            api_keys = api_keys.split(',')[0m
[30;1m1101 | [0m[35m        VariableInterface.api_keys = api_keys[0m
[30;1m1102 | [0m[35m    ssl_keyfile, ssl_certfile, http_or_https = None, None, 'http'[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1095 | [0m[35m    if max_concurrent_requests is not None:[0m
[30;1m1096 | [0m[35m        app.add_middleware(ConcurrencyLimitMiddleware, max_concurrent_requests=max_concurrent_reques[0m
[30;1m1097 | [0m[35m[0m
[30;1m1098 | [0m[35m    if api_keys is not None:[0m
[30;1m1099 | [0m[35m        if isinstance(api_keys, str):[0m
[30;1m1100 | [0m[35m            api_keys = api_keys.split(',')[0m
[30;1m1101 | [0m[35m        VariableInterface.api_keys = api_keys[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1051 | [0m[35m        allow_headers (List[str]): a list of allowed HTTP headers for CORS[0m
[30;1m1052 | [0m[35m        log_level(str): set log level whose value among [CRITICAL, ERROR,[0m
[30;1m1053 | [0m[35m            WARNING, INFO, DEBUG][0m
[30;1m1054 | [0m[35m        api_keys (List[str] | str | None): Optional list of API keys. Accepts[0m
[30;1m1055 | [0m[35m            string type as a single api_key. Default to None, which means no[0m
[30;1m1056 | [0m[35m            api key applied.[0m
[30;1m1057 | [0m[35m        ssl (bool): Enable SSL. Requires OS Environment variables[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1007 | [0m[35m          allow_methods: List[str] = ['*'],[0m
[30;1m1008 | [0m[35m          allow_headers: List[str] = ['*'],[0m
[30;1m1009 | [0m[35m          log_level: str = 'ERROR',[0m
[30;1m1010 | [0m[35m          api_keys: Optional[Union[List[str], str]] = None,[0m
[30;1m1011 | [0m[35m          ssl: bool = False,[0m
[30;1m1012 | [0m[35m          proxy_url: Optional[str] = None,[0m
[30;1m1013 | [0m[35m          max_log_len: int = None,[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m77 | [0m[35m            )[0m
[30;1m78 | [0m[35m        return token[0m
[30;1m79 | [0m[35m    else:[0m
[30;1m80 | [0m[35m        # api_keys not set; allow all[0m
[30;1m81 | [0m[35m        return None[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m63 | [0m[35m    Adopted from https://github.com/lm-sys/FastChat/blob/v0.2.35/fastchat/serve/openai_api_server.py[0m
[30;1m64 | [0m[35m    """  # noqa[0m
[30;1m65 | [0m[35m    if VariableInterface.api_keys:[0m
[30;1m66 | [0m[35m        if auth is None or (token := auth.credentials) not in VariableInterface.api_keys:[0m
[30;1m67 | [0m[35m            raise HTTPException([0m
[30;1m68 | [0m[35m                status_code=401,[0m
[30;1m69 | [0m[35m                detail={[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m    Adopted from https://github.com/lm-sys/FastChat/blob/v0.2.35/fastchat/serve/openai_api_server.py[0m
[30;1m64 | [0m[35m    """  # noqa[0m
[30;1m65 | [0m[35m    if VariableInterface.api_keys:[0m
[30;1m66 | [0m[35m        if auth is None or (token := auth.credentials) not in VariableInterface.api_keys:[0m
[30;1m67 | [0m[35m            raise HTTPException([0m
[30;1m68 | [0m[35m                status_code=401,[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m42 | [0m[35m    """A IO interface maintaining variables."""[0m
[30;1m43 | [0m[35m    async_engine: AsyncEngine = None[0m
[30;1m44 | [0m[35m    session_id: int = 0[0m
[30;1m45 | [0m[35m    api_keys: Optional[List[str]] = None[0m
[30;1m46 | [0m[35m    request_hosts = [][0m
[30;1m47 | [0m[35m    # following are for registering to proxy server[0m
[30;1m48 | [0m[35m    proxy_url: Optional[str] = None[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m936 | [0m[35m    def dummy_get_device_id():[0m
[30;1m937 | [0m[35m        return 0[0m
[30;1m938 | [0m[35m[0m
[30;1m939 | [0m[35m    if int(os.environ.get('LOCAL_RANK', -1)) > 0:[0m
[30;1m940 | [0m[35m        from lmdeploy.vl.model.utils import _set_func[0m
[30;1m941 | [0m[35m[0m
[30;1m942 | [0m[35m        # the replacement can't be recovered[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m553 | [0m[35m        if isinstance(api_keys, str):[0m
[30;1m554 | [0m[35m            api_keys = api_keys.split(',')[0m
[30;1m555 | [0m[35m        from lmdeploy.serve.openai.api_server import VariableInterface[0m
[30;1m556 | [0m[35m        VariableInterface.api_keys = api_keys[0m
[30;1m557 | [0m[35m    ssl_keyfile, ssl_certfile = None, None[0m
[30;1m558 | [0m[35m    if ssl:[0m
[30;1m559 | [0m[35m        ssl_keyfile = os.environ['SSL_KEYFILE'][0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m553 | [0m[35m        if isinstance(api_keys, str):[0m
[30;1m554 | [0m[35m            api_keys = api_keys.split(',')[0m
[30;1m555 | [0m[35m        from lmdeploy.serve.openai.api_server import VariableInterface[0m
[30;1m556 | [0m[35m        VariableInterface.api_keys = api_keys[0m
[30;1m557 | [0m[35m    ssl_keyfile, ssl_certfile = None, None[0m
[30;1m558 | [0m[35m    if ssl:[0m
[30;1m559 | [0m[35m        ssl_keyfile = os.environ['SSL_KEYFILE'][0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m551 | [0m[35m    node_manager.cache_status = not disable_cache_status[0m
[30;1m552 | [0m[35m    if api_keys is not None:[0m
[30;1m553 | [0m[35m        if isinstance(api_keys, str):[0m
[30;1m554 | [0m[35m            api_keys = api_keys.split(',')[0m
[30;1m555 | [0m[35m        from lmdeploy.serve.openai.api_server import VariableInterface[0m
[30;1m556 | [0m[35m        VariableInterface.api_keys = api_keys[0m
[30;1m557 | [0m[35m    ssl_keyfile, ssl_certfile = None, None[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m551 | [0m[35m    node_manager.cache_status = not disable_cache_status[0m
[30;1m552 | [0m[35m    if api_keys is not None:[0m
[30;1m553 | [0m[35m        if isinstance(api_keys, str):[0m
[30;1m554 | [0m[35m            api_keys = api_keys.split(',')[0m
[30;1m555 | [0m[35m        from lmdeploy.serve.openai.api_server import VariableInterface[0m
[30;1m556 | [0m[35m        VariableInterface.api_keys = api_keys[0m
[30;1m557 | [0m[35m    ssl_keyfile, ssl_certfile = None, None[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m550 | [0m[35m    node_manager.strategy = Strategy.from_str(strategy)[0m
[30;1m551 | [0m[35m    node_manager.cache_status = not disable_cache_status[0m
[30;1m552 | [0m[35m    if api_keys is not None:[0m
[30;1m553 | [0m[35m        if isinstance(api_keys, str):[0m
[30;1m554 | [0m[35m            api_keys = api_keys.split(',')[0m
[30;1m555 | [0m[35m        from lmdeploy.serve.openai.api_server import VariableInterface[0m
[30;1m556 | [0m[35m        VariableInterface.api_keys = api_keys[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m549 | [0m[35m    """  # noqa[0m
[30;1m550 | [0m[35m    node_manager.strategy = Strategy.from_str(strategy)[0m
[30;1m551 | [0m[35m    node_manager.cache_status = not disable_cache_status[0m
[30;1m552 | [0m[35m    if api_keys is not None:[0m
[30;1m553 | [0m[35m        if isinstance(api_keys, str):[0m
[30;1m554 | [0m[35m            api_keys = api_keys.split(',')[0m
[30;1m555 | [0m[35m        from lmdeploy.serve.openai.api_server import VariableInterface[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m540 | [0m[35m        strategy ('random' | 'min_expected_latency' | 'min_observed_latency'):[0m
[30;1m541 | [0m[35m            the strategy to dispatch requests to nodes. Default to[0m
[30;1m542 | [0m[35m            'min_expected_latency'[0m
[30;1m543 | [0m[35m        api_keys (List[str] | str | None): Optional list of API keys. Accepts string type as[0m
[30;1m544 | [0m[35m            a single api_key. Default to None, which means no api key applied.[0m
[30;1m545 | [0m[35m        ssl (bool): Enable SSL. Requires OS Environment variables 'SSL_KEYFILE' and 'SSL_CERTFILE'.[0m
[30;1m546 | [0m[35m        log_level (str): Set the log level. Default to INFO.[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m527 | [0m[35mdef proxy(server_name: str = '0.0.0.0',[0m
[30;1m528 | [0m[35m          server_port: int = 8000,[0m
[30;1m529 | [0m[35m          strategy: Literal['random', 'min_expected_latency', 'min_observed_latency'] = 'min_expecte[0m
[30;1m530 | [0m[35m          api_keys: Optional[Union[List[str], str]] = None,[0m
[30;1m531 | [0m[35m          ssl: bool = False,[0m
[30;1m532 | [0m[35m          log_level: str = 'INFO',[0m
[30;1m533 | [0m[35m          disable_cache_status: bool = False,[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/pytorch/engine/engine_checker.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m        if device_type == 'cuda':[0m
[30;1m32 | [0m[35m            # triton[0m
[30;1m33 | [0m[35m            from ..check_env.triton import TritonChecker[0m
[30;1m34 | [0m[35m            triton_checker = TritonChecker(logger=logger)[0m
[30;1m35 | [0m[35m            triton_checker.register_required_checker(torch_checker)[0m
[30;1m36 | [0m[35m            self.register_required_checker(triton_checker)[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/lite/utils/calib_dataloader.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m98 | [0m[35m                           'allenai--c4',[0m
[30;1m99 | [0m[35m                           data_files={'validation': 'en/c4-validation.00000-of-00008.json.gz'},[0m
[30;1m100 | [0m[35m                           split='validation',[0m
[30;1m101 | [0m[35m                           use_auth_token=False,[0m
[30;1m102 | [0m[35m                           trust_remote_code=True)[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m    import random[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/lite/utils/calib_dataloader.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m92 | [0m[35m                             'allenai--c4',[0m
[30;1m93 | [0m[35m                             data_files={'train': 'en/c4-train.00000-of-01024.json.gz'},[0m
[30;1m94 | [0m[35m                             split='train',[0m
[30;1m95 | [0m[35m                             use_auth_token=False,[0m
[30;1m96 | [0m[35m                             trust_remote_code=True)[0m
[30;1m97 | [0m[35m    valdata = load_dataset('allenai/c4',[0m
[30;1m98 | [0m[35m                           'allenai--c4',[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/cli/cli.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m163 | [0m[35m        from lmdeploy.version import __version__[0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35m        env_info = collect_env()[0m
[30;1m166 | [0m[35m        env_info['LMDeploy'] = __version__ + '+' + get_git_hash()[:7][0m
[30;1m167 | [0m[35m[0m
[30;1m168 | [0m[35m        # remove some unnecessary info[0m
[30;1m169 | [0m[35m        remove_reqs = ['MMEngine', 'OpenCV'][0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/cli/utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m254 | [0m[35m                                   help='Set the log level')[0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35m    @staticmethod[0m
[30;1m257 | [0m[35m    def api_keys(parser):[0m
[30;1m258 | [0m[35m        return parser.add_argument([0m
[30;1m259 | [0m[35m            '--api-keys',[0m
[30;1m260 | [0m[35m            type=str,[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/cli/serve.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m332 | [0m[35m                       allow_methods=args.allow_methods,[0m
[30;1m333 | [0m[35m                       allow_headers=args.allow_headers,[0m
[30;1m334 | [0m[35m                       log_level=args.log_level.upper(),[0m
[30;1m335 | [0m[35m                       api_keys=args.api_keys,[0m
[30;1m336 | [0m[35m                       ssl=args.ssl,[0m
[30;1m337 | [0m[35m                       proxy_url=args.proxy_url,[0m
[30;1m338 | [0m[35m                       max_log_len=args.max_log_len,[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/cli/serve.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m332 | [0m[35m                       allow_methods=args.allow_methods,[0m
[30;1m333 | [0m[35m                       allow_headers=args.allow_headers,[0m
[30;1m334 | [0m[35m                       log_level=args.log_level.upper(),[0m
[30;1m335 | [0m[35m                       api_keys=args.api_keys,[0m
[30;1m336 | [0m[35m                       ssl=args.ssl,[0m
[30;1m337 | [0m[35m                       proxy_url=args.proxy_url,[0m
[30;1m338 | [0m[35m                       max_log_len=args.max_log_len,[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/cli/serve.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m221 | [0m[35m                            help='Whether to disable cache status of the '[0m
[30;1m222 | [0m[35m                            'proxy. If set, the proxy will forget the status '[0m
[30;1m223 | [0m[35m                            'of the previous time')[0m
[30;1m224 | [0m[35m        ArgumentHelper.api_keys(parser)[0m
[30;1m225 | [0m[35m        ArgumentHelper.ssl(parser)[0m
[30;1m226 | [0m[35m        ArgumentHelper.log_level(parser)[0m
[30;1m227 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/cli/serve.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m128 | [0m[35m        # common args[0m
[30;1m129 | [0m[35m        ArgumentHelper.backend(parser)[0m
[30;1m130 | [0m[35m        ArgumentHelper.log_level(parser)[0m
[30;1m131 | [0m[35m        ArgumentHelper.api_keys(parser)[0m
[30;1m132 | [0m[35m        ArgumentHelper.ssl(parser)[0m
[30;1m133 | [0m[35m        ArgumentHelper.model_name(parser)[0m
[30;1m134 | [0m[35m        ArgumentHelper.max_log_len(parser)[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/serve/vl_async_engine.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m126 | [0m[35m                    {[0m
[30;1m127 | [0m[35m                        'type': 'image_url',[0m
[30;1m128 | [0m[35m                        'image_url': {[0m
[30;1m129 | [0m[35m                            'url': 'image url or base64-encoded image data',[0m
[30;1m130 | [0m[35m                            'key': 'value'  # parameters used in image processing[0m
[30;1m131 | [0m[35m                            ...[0m
[30;1m132 | [0m[35m                        }[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/serve/vl_async_engine.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m119 | [0m[35m            assert isinstance(content, List)[0m
[30;1m120 | [0m[35m            message = dict(role=role, content=[])[0m
[30;1m121 | [0m[35m            for item in content:[0m
[30;1m122 | [0m[35m                # image url or base64-encoded image data[0m
[30;1m123 | [0m[35m                if item['type'] == 'image_url':[0m
[30;1m124 | [0m[35m                    """[0m
[30;1m125 | [0m[35m                    convert the following item:[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/serve/vl_async_engine.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m    @classmethod[0m
[30;1m94 | [0m[35m    async def async_convert_to_pil_images(cls, messages: List[Dict]) -> List[Dict]:[0m
[30;1m95 | [0m[35m        """Scan the provided messages to find image URLs or base64-encoded[0m
[30;1m96 | [0m[35m        image data. Loads the images into Pillow image objects.[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m        Args:[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/logger.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    def log_prompt(self, session_id: int, prompt: str) -> None:[0m
[30;1m24 | [0m[35m        if not isinstance(prompt, str):[0m
[30;1m25 | [0m[35m            # Prompt may be a GPT4V message with base64 images;[0m
[30;1m26 | [0m[35m            # logging might be impractical due to length[0m
[30;1m27 | [0m[35m            return[0m
[30;1m28 | [0m[35m        if self.max_log_len is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/api.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m160 | [0m[35m                               server_name=server_name,[0m
[30;1m161 | [0m[35m                               server_port=server_port,[0m
[30;1m162 | [0m[35m                               log_level=log_level,[0m
[30;1m163 | [0m[35m                               api_keys=api_keys,[0m
[30;1m164 | [0m[35m                               ssl=ssl,[0m
[30;1m165 | [0m[35m                               **kwargs),[0m
[30;1m166 | [0m[35m                   daemon=True)[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/api.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m160 | [0m[35m                               server_name=server_name,[0m
[30;1m161 | [0m[35m                               server_port=server_port,[0m
[30;1m162 | [0m[35m                               log_level=log_level,[0m
[30;1m163 | [0m[35m                               api_keys=api_keys,[0m
[30;1m164 | [0m[35m                               ssl=ssl,[0m
[30;1m165 | [0m[35m                               **kwargs),[0m
[30;1m166 | [0m[35m                   daemon=True)[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/api.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m127 | [0m[35m        server_name (str): host ip for serving[0m
[30;1m128 | [0m[35m        server_port (int): server port[0m
[30;1m129 | [0m[35m        log_level(str): set log level whose value among [CRITICAL, ERROR, WARNING, INFO, DEBUG][0m
[30;1m130 | [0m[35m        api_keys (List[str] | str | None): Optional list of API keys. Accepts string type as[0m
[30;1m131 | [0m[35m            a single api_key. Default to None, which means no api key applied.[0m
[30;1m132 | [0m[35m        ssl (bool): Enable SSL. Requires OS Environment variables 'SSL_KEYFILE' and 'SSL_CERTFILE'.[0m
[30;1m133 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/api.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m96 | [0m[35m          server_name: str = '0.0.0.0',[0m
[30;1m97 | [0m[35m          server_port: int = 23333,[0m
[30;1m98 | [0m[35m          log_level: str = 'ERROR',[0m
[30;1m99 | [0m[35m          api_keys: Optional[Union[List[str], str]] = None,[0m
[30;1m100 | [0m[35m          ssl: bool = False,[0m
[30;1m101 | [0m[35m          **kwargs):[0m
[30;1m102 | [0m[35m    """This will run the api_server in a subprocess.[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/__init__.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m23 | [0m[35m        _log_info(message)[0m
[30;1m24 | [0m[35m        return executor_backend[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    executor_backend = os.environ.get('LMDEPLOY_EXECUTOR_BACKEND', None)[0m
[30;1m27 | [0m[35m    if executor_backend is not None:[0m
[30;1m28 | [0m[35m        return _log_and_set_backend('found environment LMDEPLOY_EXECUTOR_BACKEND.', executor_backend[0m
[30;1m29 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/vl/utils.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35mdef load_image_from_base64(image: Union[bytes, str]) -> Image.Image:[0m
[30;1m48 | [0m[35m    """load image from base64 format."""[0m
[30;1m49 | [0m[35m    return Image.open(BytesIO(base64.b64decode(image)))[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35mdef load_image(image_url: Union[str, Image.Image]) -> Image.Image:[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/vl/utils.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35mdef load_image_from_base64(image: Union[bytes, str]) -> Image.Image:[0m
[30;1m48 | [0m[35m    """load image from base64 format."""[0m
[30;1m49 | [0m[35m    return Image.open(BytesIO(base64.b64decode(image)))[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/vl/utils.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m40 | [0m[35m        # use dummy image[0m
[30;1m41 | [0m[35m        image = Image.new('RGB', (32, 32))[0m
[30;1m42 | [0m[35m        image.save(buffered, format='PNG')[0m
[30;1m43 | [0m[35m    res = base64.b64encode(buffered.getvalue()).decode('utf-8')[0m
[30;1m44 | [0m[35m    return res[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/vl/utils.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mdef encode_image_base64(image: Union[str, Image.Image]) -> str:[0m
[30;1m16 | [0m[35m    """encode raw date to base64 format."""[0m
[30;1m17 | [0m[35m    buffered = BytesIO()[0m
[30;1m18 | [0m[35m    FETCH_TIMEOUT = int(os.environ.get('LMDEPLOY_FETCH_TIMEOUT', 10))[0m
[30;1m19 | [0m[35m    headers = {[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/vl/utils.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35m# Copyright (c) OpenMMLab. All rights reserved.[0m
[30;1m2 | [0m[35mimport base64[0m
[30;1m3 | [0m[35mimport os[0m
[30;1m4 | [0m[35mfrom io import BytesIO[0m
[30;1m5 | [0m[35mfrom typing import Union[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/vl/utils.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35mdef load_image(image_url: Union[str, Image.Image]) -> Image.Image:[0m
[30;1m53 | [0m[35m    """load image from url, local path or openai GPT4V."""[0m
[30;1m54 | [0m[35m    FETCH_TIMEOUT = int(os.environ.get('LMDEPLOY_FETCH_TIMEOUT', 10))[0m
[30;1m55 | [0m[35m    headers = {[0m
[30;1m56 | [0m[35m        'User-Agent':[0m
[30;1m57 | [0m[35m        'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 '[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/lmdeploy/vl/utils.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m15 | [0m[35mdef encode_image_base64(image: Union[str, Image.Image]) -> str:[0m
[30;1m16 | [0m[35m    """encode raw date to base64 format."""[0m
[30;1m17 | [0m[35m    buffered = BytesIO()[0m
[30;1m18 | [0m[35m    FETCH_TIMEOUT = int(os.environ.get('LMDEPLOY_FETCH_TIMEOUT', 10))[0m
[30;1m19 | [0m[35m    headers = {[0m
[30;1m20 | [0m[35m        'User-Agent':[0m
[30;1m21 | [0m[35m        'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 '[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/api_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m403 | [0m[35m        'top_p': top_p,[0m
[30;1m404 | [0m[35m        'temperature': temperature[0m
[30;1m405 | [0m[35m    }[0m
[30;1m406 | [0m[35m    response = requests.post(api_url, headers=headers, json=pload, stream=stream)[0m
[30;1m407 | [0m[35m    for chunk in response.iter_lines(chunk_size=8192, decode_unicode=False, delimiter=b'\n'):[0m
[30;1m408 | [0m[35m        if chunk:[0m
[30;1m409 | [0m[35m            data = json_loads(chunk.decode('utf-8'))[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/api_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m287 | [0m[35m            json objects in openai formats[0m
[30;1m288 | [0m[35m        """[0m
[30;1m289 | [0m[35m        pload = {k: v for k, v in locals().copy().items() if k[:2] != '__' and k not in ['self']}[0m
[30;1m290 | [0m[35m        response = requests.post(self.completions_v1_url, headers=self.headers, json=pload, stream=s[0m
[30;1m291 | [0m[35m        for chunk in response.iter_lines(chunk_size=8192, decode_unicode=False, delimiter=b'\n'):[0m
[30;1m292 | [0m[35m            if chunk:[0m
[30;1m293 | [0m[35m                if stream:[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/api_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m225 | [0m[35m                history_tokens, finish_reason[0m
[30;1m226 | [0m[35m        """[0m
[30;1m227 | [0m[35m        pload = {k: v for k, v in locals().copy().items() if k[:2] != '__' and k not in ['self']}[0m
[30;1m228 | [0m[35m        response = requests.post(self.chat_intractive_v1_url, headers=self.headers, json=pload, stre[0m
[30;1m229 | [0m[35m        for chunk in response.iter_lines(chunk_size=8192, decode_unicode=False, delimiter=b'\n'):[0m
[30;1m230 | [0m[35m            if chunk:[0m
[30;1m231 | [0m[35m                decoded = chunk.decode('utf-8')[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/api_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m152 | [0m[35m            json objects in openai formats[0m
[30;1m153 | [0m[35m        """[0m
[30;1m154 | [0m[35m        pload = {k: v for k, v in locals().copy().items() if k[:2] != '__' and k not in ['self']}[0m
[30;1m155 | [0m[35m        response = requests.post(self.chat_completions_v1_url, headers=self.headers, json=pload, str[0m
[30;1m156 | [0m[35m        for chunk in response.iter_lines(chunk_size=8192, decode_unicode=False, delimiter=b'\n'):[0m
[30;1m157 | [0m[35m            if chunk:[0m
[30;1m158 | [0m[35m                if stream:[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/api_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m79 | [0m[35m                when it is not. Default to True.[0m
[30;1m80 | [0m[35m        Return: (input_ids, length)[0m
[30;1m81 | [0m[35m        """[0m
[30;1m82 | [0m[35m        response = requests.post(self.encode_v1_url,[0m
[30;1m83 | [0m[35m                                 headers=self.headers,[0m
[30;1m84 | [0m[35m                                 json=dict(input=input, do_preprocess=do_preprocess, add_bos=add_bos[0m
[30;1m85 | [0m[35m                                 stream=False)[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/api_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mdef get_model_list(api_url: str, headers: dict = None):[0m
[30;1m11 | [0m[35m    """Get model list from api server."""[0m
[30;1m12 | [0m[35m    response = requests.get(api_url, headers=headers)[0m
[30;1m13 | [0m[35m    logger = get_logger('lmdeploy')[0m
[30;1m14 | [0m[35m    if not response.ok:[0m
[30;1m15 | [0m[35m        logger.error(f'Failed to get the model list: {api_url}'[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/api_client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m138 | [0m[35m                this to False. This is setup to True in slow tokenizers.[0m
[30;1m139 | [0m[35m            top_k (int): The number of the highest probability vocabulary[0m
[30;1m140 | [0m[35m                tokens to keep for top-k-filtering[0m
[30;1m141 | [0m[35m            min_new_tokens (int): To generate at least numbers of tokens.[0m
[30;1m142 | [0m[35m            min_p (float): Minimum token probability, which will be scaled by the[0m
[30;1m143 | [0m[35m                probability of the most likely token. It must be a value between[0m
[30;1m144 | [0m[35m                0 and 1. Typical values are in the 0.01-0.2 range, comparably[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/api_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m321 | [0m[35m            session_id: determine which instance will be called.[0m
[30;1m322 | [0m[35m                If not specified with a value other than -1, using random value[0m
[30;1m323 | [0m[35m                directly.[0m
[30;1m324 | [0m[35m            image_url (str | List[str] | None): the image url or base64 encoded[0m
[30;1m325 | [0m[35m                string for VL models.[0m
[30;1m326 | [0m[35m            stream: whether to stream the results or not.[0m
[30;1m327 | [0m[35m            stop: whether to stop the session response or not.[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/api_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m        Args:[0m
[30;1m195 | [0m[35m            prompt: the prompt to use for the generation.[0m
[30;1m196 | [0m[35m            image_url (str | List[str] | None): the image url or base64 encoded[0m
[30;1m197 | [0m[35m                string for VL models.[0m
[30;1m198 | [0m[35m            session_id: determine which instance will be called.[0m
[30;1m199 | [0m[35m                If not specified with a value other than -1, using random value[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/reasoning_parser/deepseek_r1_reasoning_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m                             'constructor during construction.')[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m        self.think_start_token_id = self.vocab.get(self.think_start_token)[0m
[30;1m31 | [0m[35m        self.think_end_token_id = self.vocab.get(self.think_end_token)[0m
[30;1m32 | [0m[35m        if (self.think_start_token_id is None or self.think_end_token_id is None):[0m
[30;1m33 | [0m[35m            raise RuntimeError('DeepSeek R1 reasoning parser could not locate think start/end '[0m
[30;1m34 | [0m[35m                               'tokens in the tokenizer!')[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/reasoning_parser/deepseek_r1_reasoning_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m            raise ValueError('The model tokenizer must be passed to the ReasoningParser '[0m
[30;1m28 | [0m[35m                             'constructor during construction.')[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m        self.think_start_token_id = self.vocab.get(self.think_start_token)[0m
[30;1m31 | [0m[35m        self.think_end_token_id = self.vocab.get(self.think_end_token)[0m
[30;1m32 | [0m[35m        if (self.think_start_token_id is None or self.think_end_token_id is None):[0m
[30;1m33 | [0m[35m            raise RuntimeError('DeepSeek R1 reasoning parser could not locate think start/end '[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/reasoning_parser/deepseek_r1_reasoning_parser.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m117 | [0m[35m            final_output (str | None): The content.[0m
[30;1m118 | [0m[35m        """[0m
[30;1m119 | [0m[35m        # DeepSeek R1 doesn't generate <think> now.[0m
[30;1m120 | [0m[35m        # Thus we assume the reasoning content is always at the start.[0m
[30;1m121 | [0m[35m        # Ref https://huggingface.co/deepseek-ai/DeepSeek-R1/commit/8a58a132790c9935686eb97f042afa80[0m
[30;1m122 | [0m[35m        if self.think_end_token not in model_output:[0m
[30;1m123 | [0m[35m            return model_output, None[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/reasoning_parser/deepseek_r1_reasoning_parser.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m125 | [0m[35m            # Add a start token if it's missing to keep compatibility.[0m
[30;1m126 | [0m[35m            if self.think_start_token not in model_output:[0m
[30;1m127 | [0m[35m                model_output = f'{self.think_start_token}{model_output}'[0m
[30;1m128 | [0m[35m            # Use a regex to find the reasoning content[0m
[30;1m129 | [0m[35m            reasoning_content = self.reasoning_regex.findall(model_output)[0][0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m            end_index = len(f'{self.think_start_token}{reasoning_content}{self.think_end_token}')[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/tool_parser/qwen2d5_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m87 | [0m[35m            # if the current tool name hasn't been sent, send if available[0m
[30;1m88 | [0m[35m            # - otherwise send nothing[0m
[30;1m89 | [0m[35m            if not self.current_tool_name_sent:[0m
[30;1m90 | [0m[35m                function_name = tool_call_arr.get('name')[0m
[30;1m91 | [0m[35m                if function_name:[0m
[30;1m92 | [0m[35m                    self.current_tool_id = self.current_tool_id + 1[0m
[30;1m93 | [0m[35m                    delta = DeltaMessage(tool_calls=[[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/tool_parser/qwen2d5_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m        if 'parameters' in obj:[0m
[30;1m32 | [0m[35m            return obj.get('parameters')[0m
[30;1m33 | [0m[35m        elif 'arguments' in obj:[0m
[30;1m34 | [0m[35m            return obj.get('arguments')[0m
[30;1m35 | [0m[35m        return None[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    def extract_tool_calls_streaming([0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/tool_parser/qwen2d5_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m    def get_argments(self, obj):[0m
[30;1m31 | [0m[35m        if 'parameters' in obj:[0m
[30;1m32 | [0m[35m            return obj.get('parameters')[0m
[30;1m33 | [0m[35m        elif 'arguments' in obj:[0m
[30;1m34 | [0m[35m            return obj.get('arguments')[0m
[30;1m35 | [0m[35m        return None[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/tool_parser/qwen2d5_parser.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m69 | [0m[35m        # bit mask flags for partial JSON parsing. If the name hasn't been[0m
[30;1m70 | [0m[35m        # sent yet, don't allow sending[0m
[30;1m71 | [0m[35m        # an incomplete string since OpenAI only ever (as far as I have[0m
[30;1m72 | [0m[35m        # seen) allows sending the entire tool/ function name at once.[0m
[30;1m73 | [0m[35m        flags = Allow.ALL if self.current_tool_name_sent \[0m
[30;1m74 | [0m[35m            else Allow.ALL & ~Allow.STR[0m
[30;1m75 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/tool_parser/qwen2d5_parser.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m114 | [0m[35m                    logger.error('INVARIANT - impossible to have arguments reset '[0m
[30;1m115 | [0m[35m                                 'mid-arguments')[0m
[30;1m116 | [0m[35m                    delta = None[0m
[30;1m117 | [0m[35m                # first time to get parameters[0m
[30;1m118 | [0m[35m                elif cur_arguments and not prev_arguments:[0m
[30;1m119 | [0m[35m                    cur_arguments_json = json.dumps(cur_arguments, ensure_ascii=False)[0m
[30;1m120 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/tool_parser/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m76 | [0m[35m        # replace the prefix only once in case it's mirrored[0m
[30;1m77 | [0m[35m        diff = diff.replace(prefix, '', 1)[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m    return diff[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35mdef find_all_indices(string: str, substring: str) -> List[int]:[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/tool_parser/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    if len(prefix):[0m
[30;1m76 | [0m[35m        # replace the prefix only once in case it's mirrored[0m
[30;1m77 | [0m[35m        diff = diff.replace(prefix, '', 1)[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m    return diff[0m
[30;1m80 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/tool_parser/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m70 | [0m[35m    prefix = find_common_prefix(curr, old)[0m
[30;1m71 | [0m[35m    diff = curr[0m
[30;1m72 | [0m[35m    if len(suffix):[0m
[30;1m73 | [0m[35m        diff = diff[::-1].replace(suffix[::-1], '', 1)[::-1][0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    if len(prefix):[0m
[30;1m76 | [0m[35m        # replace the prefix only once in case it's mirrored[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/tool_parser/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m    old = old[::-1].replace(suffix[::-1], '', 1)[::-1][0m
[30;1m70 | [0m[35m    prefix = find_common_prefix(curr, old)[0m
[30;1m71 | [0m[35m    diff = curr[0m
[30;1m72 | [0m[35m    if len(suffix):[0m
[30;1m73 | [0m[35m        diff = diff[::-1].replace(suffix[::-1], '', 1)[::-1][0m
[30;1m74 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/tool_parser/llama3_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m171 | [0m[35m                if cur_arguments:[0m
[30;1m172 | [0m[35m                    sent = len(self.streamed_args_for_tool[self.current_tool_id])[0m
[30;1m173 | [0m[35m                    cur_args_json = json.dumps(cur_arguments, ensure_ascii=False)[0m
[30;1m174 | [0m[35m                    prev_arguments = self.prev_tool_call_arr[self.current_tool_id].get('arguments')[0m
[30;1m175 | [0m[35m[0m
[30;1m176 | [0m[35m                    argument_diff = None[0m
[30;1m177 | [0m[35m                    if is_complete[self.current_tool_id]:[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/tool_parser/llama3_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m165 | [0m[35m            # now we know we're on the same tool call and we're streaming[0m
[30;1m166 | [0m[35m            # arguments[0m
[30;1m167 | [0m[35m            else:[0m
[30;1m168 | [0m[35m                cur_arguments = current_tool_call.get('arguments')[0m
[30;1m169 | [0m[35m                delta = None[0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35m                if cur_arguments:[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/tool_parser/llama3_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m149 | [0m[35m            # if the current tool name hasn't been sent, send if available[0m
[30;1m150 | [0m[35m            # - otherwise send nothing[0m
[30;1m151 | [0m[35m            elif not self.current_tool_name_sent:[0m
[30;1m152 | [0m[35m                function_name = current_tool_call.get('name')[0m
[30;1m153 | [0m[35m                if function_name:[0m
[30;1m154 | [0m[35m[0m
[30;1m155 | [0m[35m                    delta = DeltaMessage(tool_calls=[[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/tool_parser/llama3_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m122 | [0m[35m                # auto-generated due to JSON completions, but wasn't[0m
[30;1m123 | [0m[35m                # streamed to the client yet.[0m
[30;1m124 | [0m[35m                if self.current_tool_id >= 0:[0m
[30;1m125 | [0m[35m                    cur_arguments = current_tool_call.get('arguments')[0m
[30;1m126 | [0m[35m                    if cur_arguments:[0m
[30;1m127 | [0m[35m                        cur_args_json = json.dumps(cur_arguments, ensure_ascii=False)[0m
[30;1m128 | [0m[35m                        sent = len(self.streamed_args_for_tool[self.current_tool_id])[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/tool_parser/llama3_parser.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m104 | [0m[35m                logger.debug('not enough tokens to parse into JSON yet')[0m
[30;1m105 | [0m[35m                return None[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m            # select as the current tool call the one we're on the state at[0m
[30;1m108 | [0m[35m            current_tool_call: Dict = tool_call_arr[self.current_tool_id] \[0m
[30;1m109 | [0m[35m                if len(tool_call_arr) > 0 else {}[0m
[30;1m110 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/tool_parser/llama3_parser.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m79 | [0m[35m        # bit mask flags for partial JSON parsing. If the name hasn't been[0m
[30;1m80 | [0m[35m        # sent yet, don't allow sending[0m
[30;1m81 | [0m[35m        # an incomplete string since OpenAI only ever (as far as I have[0m
[30;1m82 | [0m[35m        # seen) allows sending the entire tool/ function name at once.[0m
[30;1m83 | [0m[35m        flags = Allow.ALL if self.current_tool_name_sent \[0m
[30;1m84 | [0m[35m            else Allow.ALL & ~Allow.STR[0m
[30;1m85 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/paging/block_manager/base_block_manager.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# Copyright (c) OpenMMLab. All rights reserved.[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35mfrom typing import Dict[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mimport numpy as np[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/blocked_gemm_fp8.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m177 | [0m[35m        # mma[0m
[30;1m178 | [0m[35m        accumulator = tl.dot(a, b, acc=accumulator * acc_ratio[:, None])[0m
[30;1m179 | [0m[35m[0m
[30;1m180 | [0m[35m        # update scales and ratio[0m
[30;1m181 | [0m[35m        new_acc_scale = a_scale * b_scale[0m
[30;1m182 | [0m[35m        acc_ratio = acc_scale / new_acc_scale[0m
[30;1m183 | [0m[35m        acc_scale = new_acc_scale[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/pagedattention.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m495 | [0m[35m        # update acc[0m
[30;1m496 | [0m[35m        p, v = _convert_pv(p, v)[0m
[30;1m497 | [0m[35m        acc += tl.dot(p, v)[0m
[30;1m498 | [0m[35m        # update m_i and l_i[0m
[30;1m499 | [0m[35m        l_i = l_i_new[0m
[30;1m500 | [0m[35m        m_i = m_i_new[0m
[30;1m501 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/pagedattention.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m492 | [0m[35m        # scale acc[0m
[30;1m493 | [0m[35m        acc = acc * alpha[:, None][0m
[30;1m494 | [0m[35m[0m
[30;1m495 | [0m[35m        # update acc[0m
[30;1m496 | [0m[35m        p, v = _convert_pv(p, v)[0m
[30;1m497 | [0m[35m        acc += tl.dot(p, v)[0m
[30;1m498 | [0m[35m        # update m_i and l_i[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/pagedattention.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m488 | [0m[35m        alpha = tl_exp2(m_i - m_i_new)[0m
[30;1m489 | [0m[35m        l_i_new = alpha * l_i + tl.sum(p, 1)[0m
[30;1m490 | [0m[35m[0m
[30;1m491 | [0m[35m        # -- update output accumulator --[0m
[30;1m492 | [0m[35m        # scale acc[0m
[30;1m493 | [0m[35m        acc = acc * alpha[:, None][0m
[30;1m494 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/pagedattention.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m227 | [0m[35m        # update acc[0m
[30;1m228 | [0m[35m        p, v = _convert_pv(p, v)[0m
[30;1m229 | [0m[35m        acc += tl.dot(p, v)[0m
[30;1m230 | [0m[35m        # update m_i and l_i[0m
[30;1m231 | [0m[35m        l_i = l_i_new[0m
[30;1m232 | [0m[35m        m_i = m_i_new[0m
[30;1m233 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/pagedattention.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m224 | [0m[35m        # scale acc[0m
[30;1m225 | [0m[35m        acc = acc * alpha[:, None][0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m        # update acc[0m
[30;1m228 | [0m[35m        p, v = _convert_pv(p, v)[0m
[30;1m229 | [0m[35m        acc += tl.dot(p, v)[0m
[30;1m230 | [0m[35m        # update m_i and l_i[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/pagedattention.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m220 | [0m[35m        alpha = tl_exp2(m_i - m_i_new)[0m
[30;1m221 | [0m[35m        l_i_new = alpha * l_i + tl.sum(p, 1)[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m        # -- update output accumulator --[0m
[30;1m224 | [0m[35m        # scale acc[0m
[30;1m225 | [0m[35m        acc = acc * alpha[:, None][0m
[30;1m226 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/pagedattention.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m663 | [0m[35m[0m
[30;1m664 | [0m[35m    if sm_scale is None:[0m
[30;1m665 | [0m[35m        sm_scale = 1.0 / (Lq**0.5)[0m
[30;1m666 | [0m[35m    batch, head = kv_seqlens.shape[0], q.shape[-2][0m
[30;1m667 | [0m[35m    kv_group_num = q.shape[-2] // k.shape[h_dim][0m
[30;1m668 | [0m[35m[0m
[30;1m669 | [0m[35m    BLOCK = k.size(s_dim)[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/pagedattention.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m347 | [0m[35m        stride_xp: stride of page num dim[0m
[30;1m348 | [0m[35m        stride_xbs: stride of block size dim[0m
[30;1m349 | [0m[35m        stride_h: stride of head num dim[0m
[30;1m350 | [0m[35m        stride_d: stride of head size dim[0m
[30;1m351 | [0m[35m    """[0m
[30;1m352 | [0m[35m    cur_batch = tl.program_id(2)[0m
[30;1m353 | [0m[35m    cur_kv_head = tl.program_id(0)[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/pagedattention.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m346 | [0m[35m    Args:[0m
[30;1m347 | [0m[35m        stride_xp: stride of page num dim[0m
[30;1m348 | [0m[35m        stride_xbs: stride of block size dim[0m
[30;1m349 | [0m[35m        stride_h: stride of head num dim[0m
[30;1m350 | [0m[35m        stride_d: stride of head size dim[0m
[30;1m351 | [0m[35m    """[0m
[30;1m352 | [0m[35m    cur_batch = tl.program_id(2)[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/base.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m129 | [0m[35m            if max_prefill_token_num <= 0:[0m
[30;1m130 | [0m[35m                raise RuntimeError('No enough gpu memory for runtime.')[0m
[30;1m131 | [0m[35m            cache_config.max_prefill_token_num = max_prefill_token_num[0m
[30;1m132 | [0m[35m            logger.warning(f'No enough memory. Update max_prefill_token_num={max_prefill_token_num}'[0m
[30;1m133 | [0m[35m        free_mem -= runtime_mem[0m
[30;1m134 | [0m[35m        logger.debug(f'estimated max runtime memory: {runtime_mem >> 20} mb')[0m
[30;1m135 | [0m[35m        available_mem = free_mem * cache_config.cache_max_entry_count[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m105 | [0m[35m            if self.cache_config.block_size != 64:[0m
[30;1m106 | [0m[35m                raise ValueError('Please set block_size to 64 for flash_mla.')[0m
[30;1m107 | [0m[35m            return[0m
[30;1m108 | [0m[35m        # TODO: support kernel with both large head dim and large block size.[0m
[30;1m109 | [0m[35m        if self.model_config.k_head_dim >= 512 and self.cache_config.block_size > 32:[0m
[30;1m110 | [0m[35m            self.cache_config.block_size = 32[0m
[30;1m111 | [0m[35m            logger.warning([0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/base_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m                outs.append(self.out_que.get_nowait())[0m
[30;1m82 | [0m[35m            return outs[0m
[30;1m83 | [0m[35m        else:[0m
[30;1m84 | [0m[35m            return [await self.out_que.get()][0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m    def build_model(self):[0m
[30;1m87 | [0m[35m        """build model."""[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/molmo.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m52 | [0m[35m        qkv = self.transform(qkv, kind)[0m
[30;1m53 | [0m[35m        if qkv is not None:[0m
[30;1m54 | [0m[35m            q, k, v = qkv.split(fused_dims, dim=0)[0m
[30;1m55 | [0m[35m        o = self.params.get(f'{self.attn_layer_prefix}.{i}.attn_out.{kind}')[0m
[30;1m56 | [0m[35m        o = self.transform(o, kind)[0m
[30;1m57 | [0m[35m        if o is None:  # handle the case when qkv has bias but o doesn't[0m
[30;1m58 | [0m[35m            o = torch.zeros_like(q)[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/molmo.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m48 | [0m[35m        head_dim = hidden_size // head_num[0m
[30;1m49 | [0m[35m        assert head_dim == 128[0m
[30;1m50 | [0m[35m        fused_dims = (hidden_size, kv_head_num * head_dim, kv_head_num * head_dim)[0m
[30;1m51 | [0m[35m        qkv = self.params.get(f'{self.attn_layer_prefix}.{i}.att_proj.{kind}')[0m
[30;1m52 | [0m[35m        qkv = self.transform(qkv, kind)[0m
[30;1m53 | [0m[35m        if qkv is not None:[0m
[30;1m54 | [0m[35m            q, k, v = qkv.split(fused_dims, dim=0)[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/molmo.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m    def tok_embeddings(self):[0m
[30;1m25 | [0m[35m        embed1 = self.params.get('model.transformer.wte.embedding', None)[0m
[30;1m26 | [0m[35m        embed2 = self.params.get('model.transformer.wte.new_embedding', None)[0m
[30;1m27 | [0m[35m        if embed1 is not None and embed2 is not None:[0m
[30;1m28 | [0m[35m            return torch.cat((embed1, embed2), dim=0)[0m
[30;1m29 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/molmo.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35m    ffn_pattern = r'ff_'[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m    def tok_embeddings(self):[0m
[30;1m25 | [0m[35m        embed1 = self.params.get('model.transformer.wte.embedding', None)[0m
[30;1m26 | [0m[35m        embed2 = self.params.get('model.transformer.wte.new_embedding', None)[0m
[30;1m27 | [0m[35m        if embed1 is not None and embed2 is not None:[0m
[30;1m28 | [0m[35m            return torch.cat((embed1, embed2), dim=0)[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llava.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m            if isinstance(rope_scaling, dict):[0m
[30;1m68 | [0m[35m                scaling_type = model_arg['rope_scaling'].get('type', '')[0m
[30;1m69 | [0m[35m                scaling_factor = model_arg['rope_scaling'].get('factor', '')[0m
[30;1m70 | [0m[35m                if scaling_type == 'dynamic':[0m
[30;1m71 | [0m[35m                    use_dynamic_ntk = 1[0m
[30;1m72 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llava.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m65 | [0m[35m            use_logn_attn = int(model_arg.get('use_logn_attn', 0))[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m            if isinstance(rope_scaling, dict):[0m
[30;1m68 | [0m[35m                scaling_type = model_arg['rope_scaling'].get('type', '')[0m
[30;1m69 | [0m[35m                scaling_factor = model_arg['rope_scaling'].get('factor', '')[0m
[30;1m70 | [0m[35m                if scaling_type == 'dynamic':[0m
[30;1m71 | [0m[35m                    use_dynamic_ntk = 1[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llava.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m            attn_bias = 1 if model_arg['architectures'][0] \[0m
[30;1m63 | [0m[35m                == 'Qwen2ForCausalLM' else 0[0m
[30;1m64 | [0m[35m            attn_bias = int(model_arg.get('attn_bias', attn_bias))[0m
[30;1m65 | [0m[35m            use_logn_attn = int(model_arg.get('use_logn_attn', 0))[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m            if isinstance(rope_scaling, dict):[0m
[30;1m68 | [0m[35m                scaling_type = model_arg['rope_scaling'].get('type', '')[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llava.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m            intermediate_size = model_arg.get('intermediate_size', 11008)[0m
[30;1m62 | [0m[35m            attn_bias = 1 if model_arg['architectures'][0] \[0m
[30;1m63 | [0m[35m                == 'Qwen2ForCausalLM' else 0[0m
[30;1m64 | [0m[35m            attn_bias = int(model_arg.get('attn_bias', attn_bias))[0m
[30;1m65 | [0m[35m            use_logn_attn = int(model_arg.get('use_logn_attn', 0))[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m            if isinstance(rope_scaling, dict):[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llava.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m58 | [0m[35m            # special for the model: llava-hf/llava-interleave-qwen-7b-hf[0m
[30;1m59 | [0m[35m            hidden_units = model_arg.get('hidden_size', 4096)[0m
[30;1m60 | [0m[35m            vocab_size = model_arg.get('vocab_size', 152000)[0m
[30;1m61 | [0m[35m            intermediate_size = model_arg.get('intermediate_size', 11008)[0m
[30;1m62 | [0m[35m            attn_bias = 1 if model_arg['architectures'][0] \[0m
[30;1m63 | [0m[35m                == 'Qwen2ForCausalLM' else 0[0m
[30;1m64 | [0m[35m            attn_bias = int(model_arg.get('attn_bias', attn_bias))[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llava.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m            # special for the model: llava-hf/llava-interleave-qwen-7b-hf[0m
[30;1m59 | [0m[35m            hidden_units = model_arg.get('hidden_size', 4096)[0m
[30;1m60 | [0m[35m            vocab_size = model_arg.get('vocab_size', 152000)[0m
[30;1m61 | [0m[35m            intermediate_size = model_arg.get('intermediate_size', 11008)[0m
[30;1m62 | [0m[35m            attn_bias = 1 if model_arg['architectures'][0] \[0m
[30;1m63 | [0m[35m                == 'Qwen2ForCausalLM' else 0[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llava.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m            use_dynamic_ntk = 0[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m            # special for the model: llava-hf/llava-interleave-qwen-7b-hf[0m
[30;1m59 | [0m[35m            hidden_units = model_arg.get('hidden_size', 4096)[0m
[30;1m60 | [0m[35m            vocab_size = model_arg.get('vocab_size', 152000)[0m
[30;1m61 | [0m[35m            intermediate_size = model_arg.get('intermediate_size', 11008)[0m
[30;1m62 | [0m[35m            attn_bias = 1 if model_arg['architectures'][0] \[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llava.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m51 | [0m[35m                kv_head_num = model_arg.get('num_attention_heads', 32)[0m
[30;1m52 | [0m[35m            rope_theta = float(model_arg.get('rope_theta', 10000.0))[0m
[30;1m53 | [0m[35m            max_position_embeddings = int(model_arg.get('max_position_embeddings', 0))[0m
[30;1m54 | [0m[35m            rope_scaling = model_arg.get('rope_scaling', None)[0m
[30;1m55 | [0m[35m            scaling_factor = 0.0[0m
[30;1m56 | [0m[35m            use_dynamic_ntk = 0[0m
[30;1m57 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llava.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m50 | [0m[35m            else:[0m
[30;1m51 | [0m[35m                kv_head_num = model_arg.get('num_attention_heads', 32)[0m
[30;1m52 | [0m[35m            rope_theta = float(model_arg.get('rope_theta', 10000.0))[0m
[30;1m53 | [0m[35m            max_position_embeddings = int(model_arg.get('max_position_embeddings', 0))[0m
[30;1m54 | [0m[35m            rope_scaling = model_arg.get('rope_scaling', None)[0m
[30;1m55 | [0m[35m            scaling_factor = 0.0[0m
[30;1m56 | [0m[35m            use_dynamic_ntk = 0[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llava.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m                kv_head_num = model_arg.get('num_key_value_heads', 32)[0m
[30;1m50 | [0m[35m            else:[0m
[30;1m51 | [0m[35m                kv_head_num = model_arg.get('num_attention_heads', 32)[0m
[30;1m52 | [0m[35m            rope_theta = float(model_arg.get('rope_theta', 10000.0))[0m
[30;1m53 | [0m[35m            max_position_embeddings = int(model_arg.get('max_position_embeddings', 0))[0m
[30;1m54 | [0m[35m            rope_scaling = model_arg.get('rope_scaling', None)[0m
[30;1m55 | [0m[35m            scaling_factor = 0.0[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llava.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m48 | [0m[35m            if 'num_key_value_heads' in model_arg:[0m
[30;1m49 | [0m[35m                kv_head_num = model_arg.get('num_key_value_heads', 32)[0m
[30;1m50 | [0m[35m            else:[0m
[30;1m51 | [0m[35m                kv_head_num = model_arg.get('num_attention_heads', 32)[0m
[30;1m52 | [0m[35m            rope_theta = float(model_arg.get('rope_theta', 10000.0))[0m
[30;1m53 | [0m[35m            max_position_embeddings = int(model_arg.get('max_position_embeddings', 0))[0m
[30;1m54 | [0m[35m            rope_scaling = model_arg.get('rope_scaling', None)[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llava.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m            norm_eps = model_arg.get('rms_norm_eps', 1e-6)[0m
[30;1m47 | [0m[35m            attn_head_num = model_arg.get('num_attention_heads', 32)[0m
[30;1m48 | [0m[35m            if 'num_key_value_heads' in model_arg:[0m
[30;1m49 | [0m[35m                kv_head_num = model_arg.get('num_key_value_heads', 32)[0m
[30;1m50 | [0m[35m            else:[0m
[30;1m51 | [0m[35m                kv_head_num = model_arg.get('num_attention_heads', 32)[0m
[30;1m52 | [0m[35m            rope_theta = float(model_arg.get('rope_theta', 10000.0))[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llava.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m44 | [0m[35m            model_arg = json.load(f)['text_config'][0m
[30;1m45 | [0m[35m            num_layer = model_arg.get('num_hidden_layers', 32)[0m
[30;1m46 | [0m[35m            norm_eps = model_arg.get('rms_norm_eps', 1e-6)[0m
[30;1m47 | [0m[35m            attn_head_num = model_arg.get('num_attention_heads', 32)[0m
[30;1m48 | [0m[35m            if 'num_key_value_heads' in model_arg:[0m
[30;1m49 | [0m[35m                kv_head_num = model_arg.get('num_key_value_heads', 32)[0m
[30;1m50 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llava.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m        with open(params_path) as f:[0m
[30;1m44 | [0m[35m            model_arg = json.load(f)['text_config'][0m
[30;1m45 | [0m[35m            num_layer = model_arg.get('num_hidden_layers', 32)[0m
[30;1m46 | [0m[35m            norm_eps = model_arg.get('rms_norm_eps', 1e-6)[0m
[30;1m47 | [0m[35m            attn_head_num = model_arg.get('num_attention_heads', 32)[0m
[30;1m48 | [0m[35m            if 'num_key_value_heads' in model_arg:[0m
[30;1m49 | [0m[35m                kv_head_num = model_arg.get('num_key_value_heads', 32)[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llava.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m        params_path = osp.join(self.model_path, 'config.json')[0m
[30;1m43 | [0m[35m        with open(params_path) as f:[0m
[30;1m44 | [0m[35m            model_arg = json.load(f)['text_config'][0m
[30;1m45 | [0m[35m            num_layer = model_arg.get('num_hidden_layers', 32)[0m
[30;1m46 | [0m[35m            norm_eps = model_arg.get('rms_norm_eps', 1e-6)[0m
[30;1m47 | [0m[35m            attn_head_num = model_arg.get('num_attention_heads', 32)[0m
[30;1m48 | [0m[35m            if 'num_key_value_heads' in model_arg:[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llava.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m16 | [0m[35m    output_weight_key = 'language_model.lm_head.weight'[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m    def __init__(self, new_params: dict, unused_params: dict, last_bin: bool, model_cfg: dict, polic[0m
[30;1m19 | [0m[35m        model_cfg = model_cfg.get('text_config')[0m
[30;1m20 | [0m[35m        super().__init__(new_params, unused_params, last_bin, model_cfg, policy)[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/internlm2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m32 | [0m[35m            q = q.reshape(-1, hidden_dim)[0m
[30;1m33 | [0m[35m            k = k.reshape(-1, hidden_dim)[0m
[30;1m34 | [0m[35m            v = v.reshape(-1, hidden_dim)[0m
[30;1m35 | [0m[35m        o = self.params.get(f'{self.attn_layer_prefix}.{i}.attention.wo.{kind}')[0m
[30;1m36 | [0m[35m        o = self.transform(o, kind)[0m
[30;1m37 | [0m[35m        return (q, k, v, o)[0m
[30;1m38 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/internlm2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m23 | [0m[35m        q, k, v = (None, ) * 3[0m
[30;1m24 | [0m[35m        kv_head_num = self.model_cfg['num_key_value_heads'][0m
[30;1m25 | [0m[35m        gs = int(self.model_cfg['num_attention_heads'] / kv_head_num)[0m
[30;1m26 | [0m[35m        qkv = self.params.get(f'{self.attn_layer_prefix}.{i}.attention.wqkv.{kind}')[0m
[30;1m27 | [0m[35m        qkv = self.transform(qkv, kind)[0m
[30;1m28 | [0m[35m        if qkv is not None:[0m
[30;1m29 | [0m[35m            qkv = qkv.view(kv_head_num, gs + 2, 128, -1)[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/glm4.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m        num_layer = config.get('num_layers', num_layer)[0m
[30;1m74 | [0m[35m        norm_eps = config['layernorm_epsilon'][0m
[30;1m75 | [0m[35m        rope_theta = float(config.get('rotary_emb_base', 10000.0))[0m
[30;1m76 | [0m[35m        rope_ratio = float(config.get('rope_ratio', 1.0))[0m
[30;1m77 | [0m[35m        rope_theta *= rope_ratio[0m
[30;1m78 | [0m[35m        attn_head_num = config['num_attention_heads'][0m
[30;1m79 | [0m[35m        kv_head_num = attn_head_num[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/glm4.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m        num_layer = config.get('num_hidden_layers', None)[0m
[30;1m73 | [0m[35m        num_layer = config.get('num_layers', num_layer)[0m
[30;1m74 | [0m[35m        norm_eps = config['layernorm_epsilon'][0m
[30;1m75 | [0m[35m        rope_theta = float(config.get('rotary_emb_base', 10000.0))[0m
[30;1m76 | [0m[35m        rope_ratio = float(config.get('rope_ratio', 1.0))[0m
[30;1m77 | [0m[35m        rope_theta *= rope_ratio[0m
[30;1m78 | [0m[35m        attn_head_num = config['num_attention_heads'][0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/glm4.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m70 | [0m[35m        config = self.config[0m
[30;1m71 | [0m[35m        hidden_units = config.get('hidden_size', None)[0m
[30;1m72 | [0m[35m        num_layer = config.get('num_hidden_layers', None)[0m
[30;1m73 | [0m[35m        num_layer = config.get('num_layers', num_layer)[0m
[30;1m74 | [0m[35m        norm_eps = config['layernorm_epsilon'][0m
[30;1m75 | [0m[35m        rope_theta = float(config.get('rotary_emb_base', 10000.0))[0m
[30;1m76 | [0m[35m        rope_ratio = float(config.get('rope_ratio', 1.0))[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/glm4.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m69 | [0m[35m        """Read model info."""[0m
[30;1m70 | [0m[35m        config = self.config[0m
[30;1m71 | [0m[35m        hidden_units = config.get('hidden_size', None)[0m
[30;1m72 | [0m[35m        num_layer = config.get('num_hidden_layers', None)[0m
[30;1m73 | [0m[35m        num_layer = config.get('num_layers', num_layer)[0m
[30;1m74 | [0m[35m        norm_eps = config['layernorm_epsilon'][0m
[30;1m75 | [0m[35m        rope_theta = float(config.get('rotary_emb_base', 10000.0))[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/glm4.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m    def model_info(self):[0m
[30;1m69 | [0m[35m        """Read model info."""[0m
[30;1m70 | [0m[35m        config = self.config[0m
[30;1m71 | [0m[35m        hidden_units = config.get('hidden_size', None)[0m
[30;1m72 | [0m[35m        num_layer = config.get('num_hidden_layers', None)[0m
[30;1m73 | [0m[35m        num_layer = config.get('num_layers', num_layer)[0m
[30;1m74 | [0m[35m        norm_eps = config['layernorm_epsilon'][0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/glm4.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m29 | [0m[35m            kv_head_num = self.model_cfg['multi_query_group_num'][0m
[30;1m30 | [0m[35m        HEAD_DIM = 128[0m
[30;1m31 | [0m[35m        q, k, v = torch.split(qkv, [attn_head_num * HEAD_DIM, kv_head_num * HEAD_DIM, kv_head_num * [0m
[30;1m32 | [0m[35m        o = self.params.get(f'transformer.encoder.layers.{i}.self_attention.dense.{kind}')[0m
[30;1m33 | [0m[35m        o = self.transform(o, kind)[0m
[30;1m34 | [0m[35m        if o is None:  # handle the case when qkv has bias but o doesn't[0m
[30;1m35 | [0m[35m            o = torch.zeros_like(q)[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/glm4.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m        qkv = self.transform(qkv, kind)[0m
[30;1m26 | [0m[35m        attn_head_num = self.model_cfg['num_attention_heads'][0m
[30;1m27 | [0m[35m        kv_head_num = attn_head_num[0m
[30;1m28 | [0m[35m        if self.model_cfg.get('multi_query_attention', False):[0m
[30;1m29 | [0m[35m            kv_head_num = self.model_cfg['multi_query_group_num'][0m
[30;1m30 | [0m[35m        HEAD_DIM = 128[0m
[30;1m31 | [0m[35m        q, k, v = torch.split(qkv, [attn_head_num * HEAD_DIM, kv_head_num * HEAD_DIM, kv_head_num * [0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/glm4.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m94 | [0m[35m                    rope_theta=rope_theta,[0m
[30;1m95 | [0m[35m                    max_position_embeddings=seq_length,[0m
[30;1m96 | [0m[35m                    rotary_embedding=64,[0m
[30;1m97 | [0m[35m                    permute_qk=False)  # head layout is same as TM[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/baichuan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m34 | [0m[35m    def output_weight(self):[0m
[30;1m35 | [0m[35m        """Get output."""[0m
[30;1m36 | [0m[35m        # https://huggingface.co/baichuan-inc/Baichuan2-7B-Chat/blob/main/modeling_baichuan.py#L507[0m
[30;1m37 | [0m[35m        tensor = self.params.get('lm_head.weight', None)[0m
[30;1m38 | [0m[35m        if tensor is not None:[0m
[30;1m39 | [0m[35m            tensor = tensor.cuda()[0m
[30;1m40 | [0m[35m            tensor = torch.nn.functional.normalize(tensor)[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/baichuan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m16 | [0m[35m        qkv = self.transform(self.params.get(pack_key), kind)[0m
[30;1m17 | [0m[35m        if qkv is not None:[0m
[30;1m18 | [0m[35m            q, k, v = torch.split(qkv, qkv.shape[0] // 3, dim=0)[0m
[30;1m19 | [0m[35m        o = self.params.get(f'model.layers.{i}.self_attn.o_proj.{kind}')[0m
[30;1m20 | [0m[35m        o = self.transform(o, kind)[0m
[30;1m21 | [0m[35m        return q, k, v, o[0m
[30;1m22 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/baichuan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m13 | [0m[35m        """Get q, k, v, o kind for layer i."""[0m
[30;1m14 | [0m[35m        q, k, v, o = (None, ) * 4[0m
[30;1m15 | [0m[35m        pack_key = f'model.layers.{i}.self_attn.W_pack.{kind}'[0m
[30;1m16 | [0m[35m        qkv = self.transform(self.params.get(pack_key), kind)[0m
[30;1m17 | [0m[35m        if qkv is not None:[0m
[30;1m18 | [0m[35m            q, k, v = torch.split(qkv, qkv.shape[0] // 3, dim=0)[0m
[30;1m19 | [0m[35m        o = self.params.get(f'model.layers.{i}.self_attn.o_proj.{kind}')[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m988 | [0m[35m    if tool_parser is not None:[0m
[30;1m989 | [0m[35m        if tool_parser in ToolParserManager.module_dict:[0m
[30;1m990 | [0m[35m            tokenizer = VariableInterface.async_engine.tokenizer[0m
[30;1m991 | [0m[35m            VariableInterface.tool_parser = ToolParserManager.get(tool_parser)(tokenizer)[0m
[30;1m992 | [0m[35m        else:[0m
[30;1m993 | [0m[35m            raise ValueError([0m
[30;1m994 | [0m[35m                f'The reasoning parser {tool_parser} is not in the parser list: {ToolParserManager.m[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m979 | [0m[35m    if reasoning_parser is not None:[0m
[30;1m980 | [0m[35m        if reasoning_parser in ReasoningParserManager.module_dict:[0m
[30;1m981 | [0m[35m            tokenizer = VariableInterface.async_engine.tokenizer[0m
[30;1m982 | [0m[35m            VariableInterface.reasoning_parser = ReasoningParserManager.get(reasoning_parser)(tokeni[0m
[30;1m983 | [0m[35m        else:[0m
[30;1m984 | [0m[35m            raise ValueError([0m
[30;1m985 | [0m[35m                f'The reasoning parser {reasoning_parser} is not in the parser list: {ReasoningParse[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m952 | [0m[35m        url = f'{VariableInterface.proxy_url}/nodes/add'[0m
[30;1m953 | [0m[35m        data = {'url': VariableInterface.api_server_url, 'status': {'models': get_model_list()}}[0m
[30;1m954 | [0m[35m        headers = {'accept': 'application/json', 'Content-Type': 'application/json'}[0m
[30;1m955 | [0m[35m        response = requests.post(url, headers=headers, json=data)[0m
[30;1m956 | [0m[35m[0m
[30;1m957 | [0m[35m        if response.status_code != 200:[0m
[30;1m958 | [0m[35m            raise HTTPException(status_code=400, detail='Service registration failed')[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m936 | [0m[35m    def dummy_get_device_id():[0m
[30;1m937 | [0m[35m        return 0[0m
[30;1m938 | [0m[35m[0m
[30;1m939 | [0m[35m    if int(os.environ.get('LOCAL_RANK', -1)) > 0:[0m
[30;1m940 | [0m[35m        from lmdeploy.vl.model.utils import _set_func[0m
[30;1m941 | [0m[35m[0m
[30;1m942 | [0m[35m        # the replacement can't be recovered[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m849 | [0m[35m        request.session_id = VariableInterface.session_id[0m
[30;1m850 | [0m[35m[0m
[30;1m851 | [0m[35m    async_engine = VariableInterface.async_engine[0m
[30;1m852 | [0m[35m    sequence_start = async_engine.id2step.get(request.session_id, 0) == 0[0m
[30;1m853 | [0m[35m    sequence_end = not request.interactive_mode[0m
[30;1m854 | [0m[35m    if isinstance(request.stop, str):[0m
[30;1m855 | [0m[35m        request.stop = [request.stop][0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m790 | [0m[35m        return EncodeResponse(input_ids=encoded, length=length)[0m
[30;1m791 | [0m[35m[0m
[30;1m792 | [0m[35m[0m
[30;1m793 | [0m[35m@router.post('/v1/chat/interactive', dependencies=[Depends(check_api_key)])[0m
[30;1m794 | [0m[35masync def chat_interactive_v1(request: GenerateRequest, raw_request: Request = None):[0m
[30;1m795 | [0m[35m    """Generate completion for the request.[0m
[30;1m796 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m761 | [0m[35m    return create_error_response(HTTPStatus.BAD_REQUEST, 'Unsupported by turbomind.')[0m
[30;1m762 | [0m[35m[0m
[30;1m763 | [0m[35m[0m
[30;1m764 | [0m[35m@router.post('/v1/encode', dependencies=[Depends(check_api_key)])[0m
[30;1m765 | [0m[35masync def encode(request: EncodeRequest, raw_request: Request = None):[0m
[30;1m766 | [0m[35m    """Encode prompts.[0m
[30;1m767 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m755 | [0m[35m    return response[0m
[30;1m756 | [0m[35m[0m
[30;1m757 | [0m[35m[0m
[30;1m758 | [0m[35m@router.post('/v1/embeddings', tags=['unsupported'])[0m
[30;1m759 | [0m[35masync def create_embeddings(request: EmbeddingsRequest, raw_request: Request = None):[0m
[30;1m760 | [0m[35m    """Creates embeddings for the text."""[0m
[30;1m761 | [0m[35m    return create_error_response(HTTPStatus.BAD_REQUEST, 'Unsupported by turbomind.')[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m603 | [0m[35m    error_check_ret = await check_request(request)[0m
[30;1m604 | [0m[35m    if error_check_ret is not None:[0m
[30;1m605 | [0m[35m        return error_check_ret[0m
[30;1m606 | [0m[35m    if VariableInterface.async_engine.id2step.get(request.session_id, 0) != 0:[0m
[30;1m607 | [0m[35m        return create_error_response(HTTPStatus.BAD_REQUEST, f'The session_id `{request.session_id}`[0m
[30;1m608 | [0m[35m[0m
[30;1m609 | [0m[35m    model_name = request.model[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m555 | [0m[35m    return response[0m
[30;1m556 | [0m[35m[0m
[30;1m557 | [0m[35m[0m
[30;1m558 | [0m[35m@router.post('/v1/completions', dependencies=[Depends(check_api_key)])[0m
[30;1m559 | [0m[35masync def completions_v1(request: CompletionRequest, raw_request: Request = None):[0m
[30;1m560 | [0m[35m    """Completion API similar to OpenAI's API.[0m
[30;1m561 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m329 | [0m[35m    error_check_ret = await check_request(request)[0m
[30;1m330 | [0m[35m    if error_check_ret is not None:[0m
[30;1m331 | [0m[35m        return error_check_ret[0m
[30;1m332 | [0m[35m    if VariableInterface.async_engine.id2step.get(request.session_id, 0) != 0:[0m
[30;1m333 | [0m[35m        return create_error_response(HTTPStatus.BAD_REQUEST, f'The session_id `{request.session_id}`[0m
[30;1m334 | [0m[35m[0m
[30;1m335 | [0m[35m    model_name = request.model[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m262 | [0m[35m    return partial(_logit_bias_processor, clamped_logit_bias)[0m
[30;1m263 | [0m[35m[0m
[30;1m264 | [0m[35m[0m
[30;1m265 | [0m[35m@router.post('/v1/chat/completions', dependencies=[Depends(check_api_key)])[0m
[30;1m266 | [0m[35masync def chat_completions_v1(request: ChatCompletionRequest, raw_request: Request = None):[0m
[30;1m267 | [0m[35m    """Completion API similar to OpenAI's API.[0m
[30;1m268 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m225 | [0m[35m    return ChoiceLogprobs(content=content)[0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m[0m
[30;1m228 | [0m[35m@router.get('/health')[0m
[30;1m229 | [0m[35masync def health() -> Response:[0m
[30;1m230 | [0m[35m    """Health check."""[0m
[30;1m231 | [0m[35m    return Response(status_code=200)[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m92 | [0m[35m    return model_names[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m@router.get('/v1/models', dependencies=[Depends(check_api_key)])[0m
[30;1m96 | [0m[35mdef available_models():[0m
[30;1m97 | [0m[35m    """Show available models."""[0m
[30;1m98 | [0m[35m    model_cards = [][0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m828 | [0m[35m        this to False. This is setup to True in slow tokenizers.[0m
[30;1m829 | [0m[35m    - adapter_name (str): For slora inference. Choose which lora to do the[0m
[30;1m830 | [0m[35m        inference.[0m
[30;1m831 | [0m[35m    - min_new_tokens (int): To generate at least numbers of tokens.[0m
[30;1m832 | [0m[35m    - min_p (float): Minimum token probability, which will be scaled by the[0m
[30;1m833 | [0m[35m        probability of the most likely token. It must be a value between[0m
[30;1m834 | [0m[35m        0 and 1. Typical values are in the 0.01-0.2 range, comparably[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m312 | [0m[35m    - spaces_between_special_tokens (bool): Whether or not to add spaces[0m
[30;1m313 | [0m[35m        around special tokens. The behavior of Fast tokenizers is to have[0m
[30;1m314 | [0m[35m        this to False. This is setup to True in slow tokenizers.[0m
[30;1m315 | [0m[35m    - min_new_tokens (int): To generate at least numbers of tokens.[0m
[30;1m316 | [0m[35m    - min_p (float): Minimum token probability, which will be scaled by the[0m
[30;1m317 | [0m[35m        probability of the most likely token. It must be a value between[0m
[30;1m318 | [0m[35m        0 and 1. Typical values are in the 0.01-0.2 range, comparably[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1042 | [0m[35m            config instance. Default to none.[0m
[30;1m1043 | [0m[35m        chat_template_config (ChatTemplateConfig): chat template configuration[0m
[30;1m1044 | [0m[35m            Default to None.[0m
[30;1m1045 | [0m[35m        server_name (str): host ip for serving[0m
[30;1m1046 | [0m[35m        server_port (int): server port[0m
[30;1m1047 | [0m[35m        tp (int): tensor parallel[0m
[30;1m1048 | [0m[35m        allow_origins (List[str]): a list of allowed origins for CORS[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m801 | [0m[35m[0m
[30;1m802 | [0m[35m    The request should be a JSON object with the following fields:[0m
[30;1m803 | [0m[35m    - prompt: the prompt to use for the generation.[0m
[30;1m804 | [0m[35m    - image_url(str | List[str] | None): the image url or base64 encoded string[0m
[30;1m805 | [0m[35m        for VL models.[0m
[30;1m806 | [0m[35m    - session_id: determine which instance will be called. If not specified[0m
[30;1m807 | [0m[35m        with a value other than -1, using random value directly.[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m197 | [0m[35m    Args:[0m
[30;1m198 | [0m[35m        tokenizer (Tokenizer): tokenizer.[0m
[30;1m199 | [0m[35m        token_ids (List[int]): output token ids.[0m
[30;1m200 | [0m[35m        logprobs (List[Dict[int, float]]): the top logprobs for each output[0m
[30;1m201 | [0m[35m            position.[0m
[30;1m202 | [0m[35m    Returns:[0m
[30;1m203 | [0m[35m        ChoiceLogprobs: logprob result.[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m143 | [0m[35m    Args:[0m
[30;1m144 | [0m[35m        tokenizer (Tokenizer): tokenizer.[0m
[30;1m145 | [0m[35m        token_ids (List[int]): output token ids.[0m
[30;1m146 | [0m[35m        logprobs (List[Dict[int, float]]): the top logprobs for each output[0m
[30;1m147 | [0m[35m            position.[0m
[30;1m148 | [0m[35m        skip_special_tokens (bool): Whether or not to remove special tokens[0m
[30;1m149 | [0m[35m            in the decoding. Default to be True.[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/api_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mimport asyncio[0m
[30;1m4 | [0m[35mimport copy[0m
[30;1m5 | [0m[35mimport os[0m
[30;1m6 | [0m[35mimport time[0m
[30;1m7 | [0m[35mfrom functools import partial[0m
[30;1m8 | [0m[35mfrom http import HTTPStatus[0m
[30;1m9 | [0m[35mfrom typing import AsyncGenerator, Dict, List, Literal, Optional, Union[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/minicpmv.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35m        info = super().model_info()[0m
[30;1m27 | [0m[35m        with open(osp.join(self.model_path, 'config.json')) as f:[0m
[30;1m28 | [0m[35m            config = json.load(f)[0m
[30;1m29 | [0m[35m            if str(config.get('version')) == '2.6':[0m
[30;1m30 | [0m[35m                info['attn_bias'] = True[0m
[30;1m31 | [0m[35m        return info[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m162 | [0m[35m                    if attention_factor is None:[0m
[30;1m163 | [0m[35m                        attention_factor = 0.1 * math.log(scaling_factor) + 1.0[0m
[30;1m164 | [0m[35m                    beta_fast = rope_scaling.get('beta_fast', 32.0)[0m
[30;1m165 | [0m[35m                    beta_slow = rope_scaling.get('beta_slow', 1.0)[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m        return dict(size_per_head=head_dim,[0m
[30;1m168 | [0m[35m                    rotary_embedding=head_dim,[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m161 | [0m[35m                    attention_factor = rope_scaling.get('attention_factor', None)[0m
[30;1m162 | [0m[35m                    if attention_factor is None:[0m
[30;1m163 | [0m[35m                        attention_factor = 0.1 * math.log(scaling_factor) + 1.0[0m
[30;1m164 | [0m[35m                    beta_fast = rope_scaling.get('beta_fast', 32.0)[0m
[30;1m165 | [0m[35m                    beta_slow = rope_scaling.get('beta_slow', 1.0)[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m        return dict(size_per_head=head_dim,[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m158 | [0m[35m                    original_max_position_embeddings = model_arg['rope_scaling'].get([0m
[30;1m159 | [0m[35m                        'original_max_position_embeddings', 0)[0m
[30;1m160 | [0m[35m                elif scaling_type == 'yarn':[0m
[30;1m161 | [0m[35m                    attention_factor = rope_scaling.get('attention_factor', None)[0m
[30;1m162 | [0m[35m                    if attention_factor is None:[0m
[30;1m163 | [0m[35m                        attention_factor = 0.1 * math.log(scaling_factor) + 1.0[0m
[30;1m164 | [0m[35m                    beta_fast = rope_scaling.get('beta_fast', 32.0)[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m155 | [0m[35m                elif scaling_type == 'llama3':[0m
[30;1m156 | [0m[35m                    low_freq_factor = rope_scaling.get('low_freq_factor', 1.0)[0m
[30;1m157 | [0m[35m                    high_freq_factor = rope_scaling.get('high_freq_factor', 1.0)[0m
[30;1m158 | [0m[35m                    original_max_position_embeddings = model_arg['rope_scaling'].get([0m
[30;1m159 | [0m[35m                        'original_max_position_embeddings', 0)[0m
[30;1m160 | [0m[35m                elif scaling_type == 'yarn':[0m
[30;1m161 | [0m[35m                    attention_factor = rope_scaling.get('attention_factor', None)[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m154 | [0m[35m                    use_dynamic_ntk = 1[0m
[30;1m155 | [0m[35m                elif scaling_type == 'llama3':[0m
[30;1m156 | [0m[35m                    low_freq_factor = rope_scaling.get('low_freq_factor', 1.0)[0m
[30;1m157 | [0m[35m                    high_freq_factor = rope_scaling.get('high_freq_factor', 1.0)[0m
[30;1m158 | [0m[35m                    original_max_position_embeddings = model_arg['rope_scaling'].get([0m
[30;1m159 | [0m[35m                        'original_max_position_embeddings', 0)[0m
[30;1m160 | [0m[35m                elif scaling_type == 'yarn':[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m153 | [0m[35m                if scaling_type == 'dynamic':[0m
[30;1m154 | [0m[35m                    use_dynamic_ntk = 1[0m
[30;1m155 | [0m[35m                elif scaling_type == 'llama3':[0m
[30;1m156 | [0m[35m                    low_freq_factor = rope_scaling.get('low_freq_factor', 1.0)[0m
[30;1m157 | [0m[35m                    high_freq_factor = rope_scaling.get('high_freq_factor', 1.0)[0m
[30;1m158 | [0m[35m                    original_max_position_embeddings = model_arg['rope_scaling'].get([0m
[30;1m159 | [0m[35m                        'original_max_position_embeddings', 0)[0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m149 | [0m[35m                    raise ValueError(f'Ambiguous rope_scaling in config: {model_arg}')[0m
[30;1m150 | [0m[35m                scaling_type = llama2_scaling_type if llama2_scaling_type \[0m
[30;1m151 | [0m[35m                    else llama3_scaling_type[0m
[30;1m152 | [0m[35m                scaling_factor = rope_scaling.get('factor', 0.0)[0m
[30;1m153 | [0m[35m                if scaling_type == 'dynamic':[0m
[30;1m154 | [0m[35m                    use_dynamic_ntk = 1[0m
[30;1m155 | [0m[35m                elif scaling_type == 'llama3':[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m144 | [0m[35m            original_max_position_embeddings = 0[0m
[30;1m145 | [0m[35m            if isinstance(rope_scaling, dict):[0m
[30;1m146 | [0m[35m                llama2_scaling_type = rope_scaling.get('type', '')[0m
[30;1m147 | [0m[35m                llama3_scaling_type = rope_scaling.get('rope_type', '')[0m
[30;1m148 | [0m[35m                if llama2_scaling_type and llama3_scaling_type:[0m
[30;1m149 | [0m[35m                    raise ValueError(f'Ambiguous rope_scaling in config: {model_arg}')[0m
[30;1m150 | [0m[35m                scaling_type = llama2_scaling_type if llama2_scaling_type \[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m143 | [0m[35m            beta_slow = 1.0[0m
[30;1m144 | [0m[35m            original_max_position_embeddings = 0[0m
[30;1m145 | [0m[35m            if isinstance(rope_scaling, dict):[0m
[30;1m146 | [0m[35m                llama2_scaling_type = rope_scaling.get('type', '')[0m
[30;1m147 | [0m[35m                llama3_scaling_type = rope_scaling.get('rope_type', '')[0m
[30;1m148 | [0m[35m                if llama2_scaling_type and llama3_scaling_type:[0m
[30;1m149 | [0m[35m                    raise ValueError(f'Ambiguous rope_scaling in config: {model_arg}')[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m132 | [0m[35m            rope_theta = float(model_arg.get('rope_theta', 10000.0))[0m
[30;1m133 | [0m[35m            max_position_embeddings = int(model_arg.get('max_position_embeddings', 0))[0m
[30;1m134 | [0m[35m            rope_scaling = model_arg.get('rope_scaling', None)[0m
[30;1m135 | [0m[35m            head_dim = model_arg.get('head_dim', hidden_units // attn_head_num)[0m
[30;1m136 | [0m[35m            scaling_factor = 0.0[0m
[30;1m137 | [0m[35m            use_dynamic_ntk = 0[0m
[30;1m138 | [0m[35m            scaling_type = ''[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m131 | [0m[35m            hidden_units = model_arg['hidden_size'][0m
[30;1m132 | [0m[35m            rope_theta = float(model_arg.get('rope_theta', 10000.0))[0m
[30;1m133 | [0m[35m            max_position_embeddings = int(model_arg.get('max_position_embeddings', 0))[0m
[30;1m134 | [0m[35m            rope_scaling = model_arg.get('rope_scaling', None)[0m
[30;1m135 | [0m[35m            head_dim = model_arg.get('head_dim', hidden_units // attn_head_num)[0m
[30;1m136 | [0m[35m            scaling_factor = 0.0[0m
[30;1m137 | [0m[35m            use_dynamic_ntk = 0[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m130 | [0m[35m                kv_head_num = model_arg['num_attention_heads'][0m
[30;1m131 | [0m[35m            hidden_units = model_arg['hidden_size'][0m
[30;1m132 | [0m[35m            rope_theta = float(model_arg.get('rope_theta', 10000.0))[0m
[30;1m133 | [0m[35m            max_position_embeddings = int(model_arg.get('max_position_embeddings', 0))[0m
[30;1m134 | [0m[35m            rope_scaling = model_arg.get('rope_scaling', None)[0m
[30;1m135 | [0m[35m            head_dim = model_arg.get('head_dim', hidden_units // attn_head_num)[0m
[30;1m136 | [0m[35m            scaling_factor = 0.0[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m129 | [0m[35m            else:[0m
[30;1m130 | [0m[35m                kv_head_num = model_arg['num_attention_heads'][0m
[30;1m131 | [0m[35m            hidden_units = model_arg['hidden_size'][0m
[30;1m132 | [0m[35m            rope_theta = float(model_arg.get('rope_theta', 10000.0))[0m
[30;1m133 | [0m[35m            max_position_embeddings = int(model_arg.get('max_position_embeddings', 0))[0m
[30;1m134 | [0m[35m            rope_scaling = model_arg.get('rope_scaling', None)[0m
[30;1m135 | [0m[35m            head_dim = model_arg.get('head_dim', hidden_units // attn_head_num)[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m    def __init__(self, model_path: str, tokenizer_path: str, **kwargs: dict):[0m
[30;1m106 | [0m[35m        super().__init__(model_path, tokenizer_path)[0m
[30;1m107 | [0m[35m        self.policy = kwargs.get('input_policy')[0m
[30;1m108 | [0m[35m        _, self.model_config = get_model_arch(model_path)[0m
[30;1m109 | [0m[35m        self.model_config = self.model_config.to_dict()[0m
[30;1m110 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m        """Get q, k, v, o kind for layer i."""[0m
[30;1m62 | [0m[35m        result = [][0m
[30;1m63 | [0m[35m        for key in ['q', 'k', 'v', 'o']:[0m
[30;1m64 | [0m[35m            tensor = self.params.get(f'{self.attn_layer_prefix}.{i}.self_attn.{key}_proj.{kind}')[0m
[30;1m65 | [0m[35m            tensor = self.transform(tensor, kind)[0m
[30;1m66 | [0m[35m            result.append(tensor)[0m
[30;1m67 | [0m[35m        return (*result, )[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m    def output_weight(self):[0m
[30;1m54 | [0m[35m        """Get output."""[0m
[30;1m55 | [0m[35m        return self.params.get(self.output_weight_key, None)[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    def _transform(self, x: torch.Tensor, kind: str):[0m
[30;1m58 | [0m[35m        return self.processor(x, kind)[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m    def norm_weight(self):[0m
[30;1m50 | [0m[35m        """Get norm."""[0m
[30;1m51 | [0m[35m        return self.params.get(self.norm_weight_key, None)[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m    def output_weight(self):[0m
[30;1m54 | [0m[35m        """Get output."""[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m    def tok_embeddings(self):[0m
[30;1m46 | [0m[35m        """Get embeddings."""[0m
[30;1m47 | [0m[35m        return self.params.get(self.tok_embeddings_key, None)[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m    def norm_weight(self):[0m
[30;1m50 | [0m[35m        """Get norm."""[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/llama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m30 | [0m[35m        self.params.update(new_params)[0m
[30;1m31 | [0m[35m        self.last_bin = last_bin[0m
[30;1m32 | [0m[35m        self.model_cfg = model_cfg[0m
[30;1m33 | [0m[35m        tie_word_embeddings = self.model_cfg.get('tie_word_embeddings', False)[0m
[30;1m34 | [0m[35m        if tie_word_embeddings:[0m
[30;1m35 | [0m[35m            self.output_weight_key = self.tok_embeddings_key[0m
[30;1m36 | [0m[35m        self.processor = policy[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/internvl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m            use_dynamic_ntk = 0[0m
[30;1m73 | [0m[35m            if isinstance(rope_scaling, dict):[0m
[30;1m74 | [0m[35m                scaling_type = model_arg['rope_scaling'].get('type', '')[0m
[30;1m75 | [0m[35m                scaling_factor = model_arg['rope_scaling'].get('factor', '')[0m
[30;1m76 | [0m[35m                if scaling_type == 'dynamic':[0m
[30;1m77 | [0m[35m                    use_dynamic_ntk = 1[0m
[30;1m78 | [0m[35m            attn_bias = 1 if model_arg['architectures'][0] == 'Qwen2ForCausalLM' else 0[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/internvl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m71 | [0m[35m            scaling_factor = 0.0[0m
[30;1m72 | [0m[35m            use_dynamic_ntk = 0[0m
[30;1m73 | [0m[35m            if isinstance(rope_scaling, dict):[0m
[30;1m74 | [0m[35m                scaling_type = model_arg['rope_scaling'].get('type', '')[0m
[30;1m75 | [0m[35m                scaling_factor = model_arg['rope_scaling'].get('factor', '')[0m
[30;1m76 | [0m[35m                if scaling_type == 'dynamic':[0m
[30;1m77 | [0m[35m                    use_dynamic_ntk = 1[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/internvl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m                kv_head_num = model_arg['num_attention_heads'][0m
[30;1m68 | [0m[35m            rope_theta = float(model_arg.get('rope_theta', 10000.0))[0m
[30;1m69 | [0m[35m            max_position_embeddings = int(model_arg.get('max_position_embeddings', 0))[0m
[30;1m70 | [0m[35m            rope_scaling = model_arg.get('rope_scaling', None)[0m
[30;1m71 | [0m[35m            scaling_factor = 0.0[0m
[30;1m72 | [0m[35m            use_dynamic_ntk = 0[0m
[30;1m73 | [0m[35m            if isinstance(rope_scaling, dict):[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/internvl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m66 | [0m[35m            else:[0m
[30;1m67 | [0m[35m                kv_head_num = model_arg['num_attention_heads'][0m
[30;1m68 | [0m[35m            rope_theta = float(model_arg.get('rope_theta', 10000.0))[0m
[30;1m69 | [0m[35m            max_position_embeddings = int(model_arg.get('max_position_embeddings', 0))[0m
[30;1m70 | [0m[35m            rope_scaling = model_arg.get('rope_scaling', None)[0m
[30;1m71 | [0m[35m            scaling_factor = 0.0[0m
[30;1m72 | [0m[35m            use_dynamic_ntk = 0[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/internvl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m65 | [0m[35m                kv_head_num = model_arg['num_key_value_heads'][0m
[30;1m66 | [0m[35m            else:[0m
[30;1m67 | [0m[35m                kv_head_num = model_arg['num_attention_heads'][0m
[30;1m68 | [0m[35m            rope_theta = float(model_arg.get('rope_theta', 10000.0))[0m
[30;1m69 | [0m[35m            max_position_embeddings = int(model_arg.get('max_position_embeddings', 0))[0m
[30;1m70 | [0m[35m            rope_scaling = model_arg.get('rope_scaling', None)[0m
[30;1m71 | [0m[35m            scaling_factor = 0.0[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/internvl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m32 | [0m[35m    output_weight_key = 'language_model.output.weight'[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    def __init__(self, new_params: dict, unused_params: dict, last_bin: bool, model_cfg: dict, **kwa[0m
[30;1m35 | [0m[35m        model_cfg = model_cfg.get('llm_config')[0m
[30;1m36 | [0m[35m        super().__init__(new_params, unused_params, last_bin, model_cfg, **kwargs)[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/internvl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m17 | [0m[35m    output_weight_key = 'language_model.lm_head.weight'[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m    def __init__(self, new_params: dict, unused_params: dict, last_bin: bool, model_cfg: dict, **kwa[0m
[30;1m20 | [0m[35m        model_cfg = model_cfg.get('llm_config')[0m
[30;1m21 | [0m[35m        super().__init__(new_params, unused_params, last_bin, model_cfg, **kwargs)[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/deepseek_vl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m58 | [0m[35m            use_dynamic_ntk = 0[0m
[30;1m59 | [0m[35m            if isinstance(rope_scaling, dict):[0m
[30;1m60 | [0m[35m                scaling_type = model_arg['rope_scaling'].get('type', '')[0m
[30;1m61 | [0m[35m                scaling_factor = model_arg['rope_scaling'].get('factor', '')[0m
[30;1m62 | [0m[35m                if scaling_type == 'dynamic':[0m
[30;1m63 | [0m[35m                    use_dynamic_ntk = 1[0m
[30;1m64 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/deepseek_vl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m57 | [0m[35m            scaling_factor = 0.0[0m
[30;1m58 | [0m[35m            use_dynamic_ntk = 0[0m
[30;1m59 | [0m[35m            if isinstance(rope_scaling, dict):[0m
[30;1m60 | [0m[35m                scaling_type = model_arg['rope_scaling'].get('type', '')[0m
[30;1m61 | [0m[35m                scaling_factor = model_arg['rope_scaling'].get('factor', '')[0m
[30;1m62 | [0m[35m                if scaling_type == 'dynamic':[0m
[30;1m63 | [0m[35m                    use_dynamic_ntk = 1[0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/deepseek_vl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m53 | [0m[35m                kv_head_num = model_arg.get('num_attention_heads', 32)[0m
[30;1m54 | [0m[35m            rope_theta = float(model_arg.get('rope_theta', 10000.0))[0m
[30;1m55 | [0m[35m            max_position_embeddings = int(model_arg.get('max_position_embeddings', 0))[0m
[30;1m56 | [0m[35m            rope_scaling = model_arg.get('rope_scaling', None)[0m
[30;1m57 | [0m[35m            scaling_factor = 0.0[0m
[30;1m58 | [0m[35m            use_dynamic_ntk = 0[0m
[30;1m59 | [0m[35m            if isinstance(rope_scaling, dict):[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/deepseek_vl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m52 | [0m[35m            else:[0m
[30;1m53 | [0m[35m                kv_head_num = model_arg.get('num_attention_heads', 32)[0m
[30;1m54 | [0m[35m            rope_theta = float(model_arg.get('rope_theta', 10000.0))[0m
[30;1m55 | [0m[35m            max_position_embeddings = int(model_arg.get('max_position_embeddings', 0))[0m
[30;1m56 | [0m[35m            rope_scaling = model_arg.get('rope_scaling', None)[0m
[30;1m57 | [0m[35m            scaling_factor = 0.0[0m
[30;1m58 | [0m[35m            use_dynamic_ntk = 0[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/deepseek_vl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m51 | [0m[35m                kv_head_num = model_arg['num_key_value_heads'][0m
[30;1m52 | [0m[35m            else:[0m
[30;1m53 | [0m[35m                kv_head_num = model_arg.get('num_attention_heads', 32)[0m
[30;1m54 | [0m[35m            rope_theta = float(model_arg.get('rope_theta', 10000.0))[0m
[30;1m55 | [0m[35m            max_position_embeddings = int(model_arg.get('max_position_embeddings', 0))[0m
[30;1m56 | [0m[35m            rope_scaling = model_arg.get('rope_scaling', None)[0m
[30;1m57 | [0m[35m            scaling_factor = 0.0[0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/deepseek_vl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m50 | [0m[35m            if 'num_key_value_heads' in model_arg:[0m
[30;1m51 | [0m[35m                kv_head_num = model_arg['num_key_value_heads'][0m
[30;1m52 | [0m[35m            else:[0m
[30;1m53 | [0m[35m                kv_head_num = model_arg.get('num_attention_heads', 32)[0m
[30;1m54 | [0m[35m            rope_theta = float(model_arg.get('rope_theta', 10000.0))[0m
[30;1m55 | [0m[35m            max_position_embeddings = int(model_arg.get('max_position_embeddings', 0))[0m
[30;1m56 | [0m[35m            rope_scaling = model_arg.get('rope_scaling', None)[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/deepseek_vl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m            inter_size = model_arg.get('intermediate_size', 11008)[0m
[30;1m47 | [0m[35m            vocab_size = model_arg.get('vocab_size', 102400)[0m
[30;1m48 | [0m[35m            norm_eps = model_arg.get('rms_norm_eps', 1e-06)[0m
[30;1m49 | [0m[35m            attn_head_num = model_arg.get('num_attention_heads', 32)[0m
[30;1m50 | [0m[35m            if 'num_key_value_heads' in model_arg:[0m
[30;1m51 | [0m[35m                kv_head_num = model_arg['num_key_value_heads'][0m
[30;1m52 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/deepseek_vl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35m            hidden_units = model_arg.get('hidden_size', 4096)[0m
[30;1m46 | [0m[35m            inter_size = model_arg.get('intermediate_size', 11008)[0m
[30;1m47 | [0m[35m            vocab_size = model_arg.get('vocab_size', 102400)[0m
[30;1m48 | [0m[35m            norm_eps = model_arg.get('rms_norm_eps', 1e-06)[0m
[30;1m49 | [0m[35m            attn_head_num = model_arg.get('num_attention_heads', 32)[0m
[30;1m50 | [0m[35m            if 'num_key_value_heads' in model_arg:[0m
[30;1m51 | [0m[35m                kv_head_num = model_arg['num_key_value_heads'][0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/deepseek_vl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m44 | [0m[35m            num_layer = model_arg['num_hidden_layers'][0m
[30;1m45 | [0m[35m            hidden_units = model_arg.get('hidden_size', 4096)[0m
[30;1m46 | [0m[35m            inter_size = model_arg.get('intermediate_size', 11008)[0m
[30;1m47 | [0m[35m            vocab_size = model_arg.get('vocab_size', 102400)[0m
[30;1m48 | [0m[35m            norm_eps = model_arg.get('rms_norm_eps', 1e-06)[0m
[30;1m49 | [0m[35m            attn_head_num = model_arg.get('num_attention_heads', 32)[0m
[30;1m50 | [0m[35m            if 'num_key_value_heads' in model_arg:[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/deepseek_vl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m                model_arg = model_arg['language_config']  # depseek-vl[0m
[30;1m44 | [0m[35m            num_layer = model_arg['num_hidden_layers'][0m
[30;1m45 | [0m[35m            hidden_units = model_arg.get('hidden_size', 4096)[0m
[30;1m46 | [0m[35m            inter_size = model_arg.get('intermediate_size', 11008)[0m
[30;1m47 | [0m[35m            vocab_size = model_arg.get('vocab_size', 102400)[0m
[30;1m48 | [0m[35m            norm_eps = model_arg.get('rms_norm_eps', 1e-06)[0m
[30;1m49 | [0m[35m            attn_head_num = model_arg.get('num_attention_heads', 32)[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/deepseek_vl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m            if 'language_config' in model_arg and model_arg['language_config'].get('model_type', Non[0m
[30;1m43 | [0m[35m                model_arg = model_arg['language_config']  # depseek-vl[0m
[30;1m44 | [0m[35m            num_layer = model_arg['num_hidden_layers'][0m
[30;1m45 | [0m[35m            hidden_units = model_arg.get('hidden_size', 4096)[0m
[30;1m46 | [0m[35m            inter_size = model_arg.get('intermediate_size', 11008)[0m
[30;1m47 | [0m[35m            vocab_size = model_arg.get('vocab_size', 102400)[0m
[30;1m48 | [0m[35m            norm_eps = model_arg.get('rms_norm_eps', 1e-06)[0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/deepseek_vl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m39 | [0m[35m        params_path = osp.join(self.model_path, 'config.json')[0m
[30;1m40 | [0m[35m        with open(params_path) as f:[0m
[30;1m41 | [0m[35m            model_arg = json.load(f)[0m
[30;1m42 | [0m[35m            if 'language_config' in model_arg and model_arg['language_config'].get('model_type', Non[0m
[30;1m43 | [0m[35m                model_arg = model_arg['language_config']  # depseek-vl[0m
[30;1m44 | [0m[35m            num_layer = model_arg['num_hidden_layers'][0m
[30;1m45 | [0m[35m            hidden_units = model_arg.get('hidden_size', 4096)[0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/deepseek2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m111 | [0m[35m                    topk_group=cfg['topk_group'],[0m
[30;1m112 | [0m[35m                    moe_group_num=cfg['n_group'],[0m
[30;1m113 | [0m[35m                    tune_layer_num=2)[0m
[30;1m114 | [0m[35m        rope_scaling = cfg.get('rope_scaling')[0m
[30;1m115 | [0m[35m        if rope_scaling and rope_scaling['type'] == 'yarn':[0m
[30;1m116 | [0m[35m            attention_factor, softmax_scale = get_yarn_params(rope_scaling)[0m
[30;1m117 | [0m[35m            softmax_scale *= size_per_head**(-0.5)[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/deepseek2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m        result = [][0m
[30;1m50 | [0m[35m        for k in ['q', 'kv']:[0m
[30;1m51 | [0m[35m            name = f'{self.attn_layer_prefix}.{i}.self_attn.{k}_a_layernorm.weight'  # noqa: E501[0m
[30;1m52 | [0m[35m            result.append(self.params.get(name))[0m
[30;1m53 | [0m[35m        return (*result, )[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/deepseek2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m40 | [0m[35m            return self.filter(r'self_attn.*proj')[0m
[30;1m41 | [0m[35m        result = [][0m
[30;1m42 | [0m[35m        for key in ['q_a_proj', 'q_b_proj', 'q_proj', 'kv_a_proj_with_mqa', 'kv_b_proj', 'o_proj']:[0m
[30;1m43 | [0m[35m            tensor = self.params.get(f'{self.attn_layer_prefix}.{i}.self_attn.{key}.{kind}')[0m
[30;1m44 | [0m[35m            tensor = self.transform(tensor, kind)[0m
[30;1m45 | [0m[35m            result.append(tensor)[0m
[30;1m46 | [0m[35m        return (*result, )[0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/deepseek2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m30 | [0m[35m            name = f'model.layers.{i}.mlp.shared_experts.{key}_proj.{kind}'[0m
[30;1m31 | [0m[35m            if i == 0:[0m
[30;1m32 | [0m[35m                name = name.replace('shared_experts.', '')[0m
[30;1m33 | [0m[35m            tensor = self.params.get(name)[0m
[30;1m34 | [0m[35m            tensor = self.transform(tensor, kind)[0m
[30;1m35 | [0m[35m            result.append(tensor)[0m
[30;1m36 | [0m[35m        return (*result, )[0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/deepseek2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m16 | [0m[35m        result = [][0m
[30;1m17 | [0m[35m        for key in ['gate', 'down', 'up']:[0m
[30;1m18 | [0m[35m            name = f'model.layers.{i}.mlp.experts.{e}.{key}_proj.{kind}'[0m
[30;1m19 | [0m[35m            tensor = self.params.get(name)[0m
[30;1m20 | [0m[35m            tensor = self.transform(tensor, kind)[0m
[30;1m21 | [0m[35m            result.append(tensor)[0m
[30;1m22 | [0m[35m        return (*result, )[0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/deepseek2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m8 | [0m[35mclass DeepSeek2Reader(LlamaReader):[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m    def moe_ffn_gate(self, i):[0m
[30;1m11 | [0m[35m        return self.params.get(f'model.layers.{i}.mlp.gate.weight')[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m    def moe_ffn_expert(self, e=None, i=None, kind=None):[0m
[30;1m14 | [0m[35m        if not kind:[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/mixtral.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m18 | [0m[35m        return (*result, )[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m    def moe_ffn_gate(self, i):[0m
[30;1m21 | [0m[35m        return self.params.get(f'model.layers.{i}.block_sparse_moe.gate.weight')[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m@INPUT_MODELS.register_module(name='mixtral')[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/mixtral.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m12 | [0m[35m        result = [][0m
[30;1m13 | [0m[35m        for x in ['w1', 'w2', 'w3']:[0m
[30;1m14 | [0m[35m            name = f'model.layers.{i}.block_sparse_moe.experts.{e}.{x}.{kind}'[0m
[30;1m15 | [0m[35m            tensor = self.params.get(name)[0m
[30;1m16 | [0m[35m            tensor = self.transform(tensor, kind)[0m
[30;1m17 | [0m[35m            result.append(tensor)[0m
[30;1m18 | [0m[35m        return (*result, )[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/protocol.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# Copyright (c) OpenMMLab. All rights reserved.[0m
[30;1m2 | [0m[35m# Modified from[0m
[30;1m3 | [0m[35m# https://github.com/lm-sys/FastChat/blob/168ccc29d3f7edc50823016105c024fe2282732a/fastchat/protocol[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35mfrom typing import Any, Dict, List, Literal, Optional, Union[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mimport shortuuid[0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/lite/quantization/activation/observer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m114 | [0m[35m        if save_input:[0m
[30;1m115 | [0m[35m            self.value = x[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m        # Update mean and absmean value with accumulated sum divided[0m
[30;1m118 | [0m[35m        # by total number of batches[0m
[30;1m119 | [0m[35m        self.mean_val = ((self.mean_val * self.num_batches_tracked + cur_mean) / (self.num_batches_t[0m
[30;1m120 | [0m[35m        self.absmean_val = ((self.absmean_val * self.num_batches_tracked + cur_absmean) /[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/lite/quantization/activation/observer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m    @torch.no_grad()[0m
[30;1m89 | [0m[35m    def observe(self, x: torch.Tensor, save_input: bool = False) -> None:[0m
[30;1m90 | [0m[35m        """Function to observe the input tensor and update the max, min, mean,[0m
[30;1m91 | [0m[35m        absolute max, absolute mean values and number of batches tracked.[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m        Args:[0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/lite/quantization/activation/observer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m    @torch.no_grad()[0m
[30;1m26 | [0m[35m    def observe(self, x: torch.Tensor) -> None:[0m
[30;1m27 | [0m[35m        """Function to observe the input tensor and update the max, min, and[0m
[30;1m28 | [0m[35m        absolute max values.[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m        Args:[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/lite/quantization/activation/observer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m        Args:[0m
[30;1m16 | [0m[35m            num_head : Number of heads[0m
[30;1m17 | [0m[35m            head_dim : Dimension of each head[0m
[30;1m18 | [0m[35m        """[0m
[30;1m19 | [0m[35m        self.num_head = num_head[0m
[30;1m20 | [0m[35m        self.head_dim = head_dim[0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m467 | [0m[35m        return JSONResponse(json.loads(response))[0m
[30;1m468 | [0m[35m[0m
[30;1m469 | [0m[35m[0m
[30;1m470 | [0m[35m@app.post('/v1/completions', dependencies=[Depends(check_api_key)])[0m
[30;1m471 | [0m[35masync def completions_v1(request: CompletionRequest, raw_request: Request = None):[0m
[30;1m472 | [0m[35m    """Completion API similar to OpenAI's API.[0m
[30;1m473 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m391 | [0m[35m        return 'Failed to delete, please check the input url.'[0m
[30;1m392 | [0m[35m[0m
[30;1m393 | [0m[35m[0m
[30;1m394 | [0m[35m@app.post('/v1/chat/completions', dependencies=[Depends(check_api_key)])[0m
[30;1m395 | [0m[35masync def chat_completions_v1(request: ChatCompletionRequest, raw_request: Request = None):[0m
[30;1m396 | [0m[35m    """Completion API similar to OpenAI's API.[0m
[30;1m397 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m379 | [0m[35m        return 'Failed to add, please check the input url.'[0m
[30;1m380 | [0m[35m[0m
[30;1m381 | [0m[35m[0m
[30;1m382 | [0m[35m@app.post('/nodes/remove', dependencies=[Depends(check_api_key)])[0m
[30;1m383 | [0m[35mdef remove_node(node_url: str):[0m
[30;1m384 | [0m[35m    """Show available models."""[0m
[30;1m385 | [0m[35m    try:[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m358 | [0m[35m        return False[0m
[30;1m359 | [0m[35m[0m
[30;1m360 | [0m[35m[0m
[30;1m361 | [0m[35m@app.post('/nodes/add', dependencies=[Depends(check_api_key)])[0m
[30;1m362 | [0m[35mdef add_node(node: Node, raw_request: Request = None):[0m
[30;1m363 | [0m[35m    """Add a node to the manager.[0m
[30;1m364 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m349 | [0m[35m    return ModelList(data=model_cards)[0m
[30;1m350 | [0m[35m[0m
[30;1m351 | [0m[35m[0m
[30;1m352 | [0m[35m@app.get('/nodes/status', dependencies=[Depends(check_api_key)])[0m
[30;1m353 | [0m[35mdef node_status():[0m
[30;1m354 | [0m[35m    """Show nodes status."""[0m
[30;1m355 | [0m[35m    try:[0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m340 | [0m[35mnode_manager = NodeManager()[0m
[30;1m341 | [0m[35m[0m
[30;1m342 | [0m[35m[0m
[30;1m343 | [0m[35m@app.get('/v1/models', dependencies=[Depends(check_api_key)])[0m
[30;1m344 | [0m[35mdef available_models():[0m
[30;1m345 | [0m[35m    """Show available models."""[0m
[30;1m346 | [0m[35m    model_cards = [][0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m292 | [0m[35m        """[0m
[30;1m293 | [0m[35m        try:[0m
[30;1m294 | [0m[35m            async with aiohttp.ClientSession() as session:[0m
[30;1m295 | [0m[35m                async with session.post(node_url + endpoint, json=request, timeout=self.aiotimeout) [0m
[30;1m296 | [0m[35m                    return await response.text()[0m
[30;1m297 | [0m[35m        except (Exception, GeneratorExit, aiohttp.ClientError, asyncio.CancelledError) as e:  # noqa[0m
[30;1m298 | [0m[35m            logger.error(f'catched an exception: {e}')[0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m273 | [0m[35m        """[0m
[30;1m274 | [0m[35m        try:[0m
[30;1m275 | [0m[35m            async with aiohttp.ClientSession() as session:[0m
[30;1m276 | [0m[35m                async with session.post(node_url + endpoint, json=request, timeout=self.aiotimeout) [0m
[30;1m277 | [0m[35m                    async for line in response.content:[0m
[30;1m278 | [0m[35m                        if line.strip():[0m
[30;1m279 | [0m[35m                            yield line + b'\n\n'[0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m142 | [0m[35m            url = f'{node_url}/health'[0m
[30;1m143 | [0m[35m            headers = {'accept': 'application/json'}[0m
[30;1m144 | [0m[35m            try:[0m
[30;1m145 | [0m[35m                response = requests.get(url, headers=headers)[0m
[30;1m146 | [0m[35m                if response.status_code != 200:[0m
[30;1m147 | [0m[35m                    to_be_deleted.append(node_url)[0m
[30;1m148 | [0m[35m            except:  # noqa[0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m115 | [0m[35m                values of nodes should be the same metric.[0m
[30;1m116 | [0m[35m        """[0m
[30;1m117 | [0m[35m        if status is None:[0m
[30;1m118 | [0m[35m            status = self.nodes.get(node_url, Status())[0m
[30;1m119 | [0m[35m        if status.models != []:  # force register directly[0m
[30;1m120 | [0m[35m            self.nodes[node_url] = status[0m
[30;1m121 | [0m[35m            self.update_config_file()[0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m            with open(self.config_path, 'r') as config_file:[0m
[30;1m86 | [0m[35m                self.nodes = yaml.safe_load(config_file)['nodes'][0m
[30;1m87 | [0m[35m                for url, status in self.nodes.items():[0m
[30;1m88 | [0m[35m                    latency = deque(status.get('latency', []), maxlen=LATENCY_DEQUE_LEN)[0m
[30;1m89 | [0m[35m                    status['latency'] = latency[0m
[30;1m90 | [0m[35m                    status = Status(**status)[0m
[30;1m91 | [0m[35m                    self.nodes[url] = status[0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m436 | [0m[35m    - ignore_eos (bool): indicator for ignoring eos[0m
[30;1m437 | [0m[35m    - skip_special_tokens (bool): Whether or not to remove special tokens[0m
[30;1m438 | [0m[35m        in the decoding. Default to be True.[0m
[30;1m439 | [0m[35m    - min_new_tokens (int): To generate at least numbers of tokens.[0m
[30;1m440 | [0m[35m    - min_p (float): Minimum token probability, which will be scaled by the[0m
[30;1m441 | [0m[35m        probability of the most likely token. It must be a value between[0m
[30;1m442 | [0m[35m        0 and 1. Typical values are in the 0.01-0.2 range, comparably[0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m100 | [0m[35m            nodes[url] = status.model_dump()[0m
[30;1m101 | [0m[35m            nodes[url]['latency'] = list(status.latency)[-LATENCY_DEQUE_LEN:][0m
[30;1m102 | [0m[35m        if self.cache_status:[0m
[30;1m103 | [0m[35m            with open(self.config_path, 'w') as config_file:  # update cfg yml[0m
[30;1m104 | [0m[35m                yaml.dump(dict(nodes=nodes), config_file)[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m    def add(self, node_url: str, status: Optional[Status] = None):[0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m387 | [0m[35m        logger.info(f'delete node {node_url} successfully')[0m
[30;1m388 | [0m[35m        return 'Deleted successfully'[0m
[30;1m389 | [0m[35m    except:  # noqa[0m
[30;1m390 | [0m[35m        logger.error(f'delete node {node_url} failed.')[0m
[30;1m391 | [0m[35m        return 'Failed to delete, please check the input url.'[0m
[30;1m392 | [0m[35m[0m
[30;1m393 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m384 | [0m[35m    """Show available models."""[0m
[30;1m385 | [0m[35m    try:[0m
[30;1m386 | [0m[35m        node_manager.remove(node_url)[0m
[30;1m387 | [0m[35m        logger.info(f'delete node {node_url} successfully')[0m
[30;1m388 | [0m[35m        return 'Deleted successfully'[0m
[30;1m389 | [0m[35m    except:  # noqa[0m
[30;1m390 | [0m[35m        logger.error(f'delete node {node_url} failed.')[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m373 | [0m[35m        if res is not None:[0m
[30;1m374 | [0m[35m            logger.error(f'add node {node.url} failed, {res}')[0m
[30;1m375 | [0m[35m            return res[0m
[30;1m376 | [0m[35m        logger.info(f'add node {node.url} successfully')[0m
[30;1m377 | [0m[35m        return 'Added successfully'[0m
[30;1m378 | [0m[35m    except:  # noqa[0m
[30;1m379 | [0m[35m        return 'Failed to add, please check the input url.'[0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m371 | [0m[35m    try:[0m
[30;1m372 | [0m[35m        res = node_manager.add(node.url, node.status)[0m
[30;1m373 | [0m[35m        if res is not None:[0m
[30;1m374 | [0m[35m            logger.error(f'add node {node.url} failed, {res}')[0m
[30;1m375 | [0m[35m            return res[0m
[30;1m376 | [0m[35m        logger.info(f'add node {node.url} successfully')[0m
[30;1m377 | [0m[35m        return 'Added successfully'[0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m366 | [0m[35m        `lmdeploy serve api_server`.[0m
[30;1m367 | [0m[35m    - status (Dict): The description of the node. An example:[0m
[30;1m368 | [0m[35m        {models: ['internlm-chat-7b],  speed: 1}. The speed here can be[0m
[30;1m369 | [0m[35m        RPM or other metric. All the values of nodes should be the same metric.[0m
[30;1m370 | [0m[35m    """[0m
[30;1m371 | [0m[35m    try:[0m
[30;1m372 | [0m[35m        res = node_manager.add(node.url, node.status)[0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m360 | [0m[35m[0m
[30;1m361 | [0m[35m@app.post('/nodes/add', dependencies=[Depends(check_api_key)])[0m
[30;1m362 | [0m[35mdef add_node(node: Node, raw_request: Request = None):[0m
[30;1m363 | [0m[35m    """Add a node to the manager.[0m
[30;1m364 | [0m[35m[0m
[30;1m365 | [0m[35m    - url (str): A http url. Can be the url generated by[0m
[30;1m366 | [0m[35m        `lmdeploy serve api_server`.[0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m322 | [0m[35m[0m
[30;1m323 | [0m[35m        Args:[0m
[30;1m324 | [0m[35m            node_url (str): the node url.[0m
[30;1m325 | [0m[35m            start (int): the start time point. time.time()[0m
[30;1m326 | [0m[35m        """[0m
[30;1m327 | [0m[35m        background_tasks = BackgroundTasks()[0m
[30;1m328 | [0m[35m        background_tasks.add_task(self.post_call, url, start)[0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m321 | [0m[35m        """To create a background task.[0m
[30;1m322 | [0m[35m[0m
[30;1m323 | [0m[35m        Args:[0m
[30;1m324 | [0m[35m            node_url (str): the node url.[0m
[30;1m325 | [0m[35m            start (int): the start time point. time.time()[0m
[30;1m326 | [0m[35m        """[0m
[30;1m327 | [0m[35m        background_tasks = BackgroundTasks()[0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m312 | [0m[35m[0m
[30;1m313 | [0m[35m        Args:[0m
[30;1m314 | [0m[35m            node_url (str): the node url.[0m
[30;1m315 | [0m[35m            start (int): the start time point. time.time()[0m
[30;1m316 | [0m[35m        """[0m
[30;1m317 | [0m[35m        self.nodes[node_url].unfinished -= 1[0m
[30;1m318 | [0m[35m        self.nodes[node_url].latency.append(time.time() - start)[0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m311 | [0m[35m        """Post process after the response finished.[0m
[30;1m312 | [0m[35m[0m
[30;1m313 | [0m[35m        Args:[0m
[30;1m314 | [0m[35m            node_url (str): the node url.[0m
[30;1m315 | [0m[35m            start (int): the start time point. time.time()[0m
[30;1m316 | [0m[35m        """[0m
[30;1m317 | [0m[35m        self.nodes[node_url].unfinished -= 1[0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m302 | [0m[35m        """Preprocess before the request get processed.[0m
[30;1m303 | [0m[35m[0m
[30;1m304 | [0m[35m        Args:[0m
[30;1m305 | [0m[35m            node_url (str): the node url.[0m
[30;1m306 | [0m[35m        """[0m
[30;1m307 | [0m[35m        self.nodes[node_url].unfinished += 1[0m
[30;1m308 | [0m[35m        return time.time()[0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m287 | [0m[35m[0m
[30;1m288 | [0m[35m        Args:[0m
[30;1m289 | [0m[35m            request (Dict): the input request.[0m
[30;1m290 | [0m[35m            node_url (str): the node url.[0m
[30;1m291 | [0m[35m            endpoint (str): the endpoint. Such as `/v1/chat/completions`.[0m
[30;1m292 | [0m[35m        """[0m
[30;1m293 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m        Args:[0m
[30;1m270 | [0m[35m            request (Dict): the input request.[0m
[30;1m271 | [0m[35m            node_url (str): the node url.[0m
[30;1m272 | [0m[35m            endpoint (str): the endpoint. Such as `/v1/chat/completions`.[0m
[30;1m273 | [0m[35m        """[0m
[30;1m274 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m255 | [0m[35m        return json.dumps(ret).encode() + b'\n'[0m
[30;1m256 | [0m[35m[0m
[30;1m257 | [0m[35m    def handle_api_timeout(self, node_url):[0m
[30;1m258 | [0m[35m        """Handle the api time out."""[0m
[30;1m259 | [0m[35m        logger.warning(f'api timeout: {node_url}')[0m
[30;1m260 | [0m[35m        ret = {[0m
[30;1m261 | [0m[35m            'error_code': ErrorCodes.API_TIMEOUT.value,[0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m172 | [0m[35m            model_name (str): A http url. Can be the url generated by[0m
[30;1m173 | [0m[35m                `lmdeploy serve api_server`.[0m
[30;1m174 | [0m[35m        Return:[0m
[30;1m175 | [0m[35m            A node url or None.[0m
[30;1m176 | [0m[35m        """[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35m        def get_matched_urls():[0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m166 | [0m[35m        return self.nodes[0m
[30;1m167 | [0m[35m[0m
[30;1m168 | [0m[35m    def get_node_url(self, model_name: str):[0m
[30;1m169 | [0m[35m        """Add a node to the manager.[0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35m        Args:[0m
[30;1m172 | [0m[35m            model_name (str): A http url. Can be the url generated by[0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m111 | [0m[35m                `lmdeploy serve api_server`.[0m
[30;1m112 | [0m[35m            description (Dict): The description of the node. An example:[0m
[30;1m113 | [0m[35m                {'http://0.0.0.0:23333': {models: ['internlm-chat-7b]},[0m
[30;1m114 | [0m[35m                speed: -1}. The speed here can be RPM or other metric. All the[0m
[30;1m115 | [0m[35m                values of nodes should be the same metric.[0m
[30;1m116 | [0m[35m        """[0m
[30;1m117 | [0m[35m        if status is None:[0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m104 | [0m[35m                yaml.dump(dict(nodes=nodes), config_file)[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m    def add(self, node_url: str, status: Optional[Status] = None):[0m
[30;1m107 | [0m[35m        """Add a node to the manager.[0m
[30;1m108 | [0m[35m[0m
[30;1m109 | [0m[35m        Args:[0m
[30;1m110 | [0m[35m            node_url (str): A http url. Can be the url generated by[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m    Args:[0m
[30;1m62 | [0m[35m        config_path (str): the path of the config file.[0m
[30;1m63 | [0m[35m        strategy (str): the strategy to dispatch node to handle the requests.[0m
[30;1m64 | [0m[35m            - random: not fully radom, but decided by the speed of nodes.[0m
[30;1m65 | [0m[35m            - min_expected_latency: will compute the expected latency to[0m
[30;1m66 | [0m[35m                process the requests. The sooner of the node, the more requests[0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/proxy.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mimport os.path as osp[0m
[30;1m8 | [0m[35mimport random[0m
[30;1m9 | [0m[35mimport threading[0m
[30;1m10 | [0m[35mimport time[0m
[30;1m11 | [0m[35mfrom collections import deque[0m
[30;1m12 | [0m[35mfrom http import HTTPStatus[0m
[30;1m13 | [0m[35mfrom typing import Deque, Dict, List, Literal, Optional, Union[0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/gradio/api_server_backend.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m        demo.load(init, inputs=None, outputs=[state_session_id])[0m
[30;1m178 | [0m[35m[0m
[30;1m179 | [0m[35m    print(f'server is gonna mount on: http://{server_name}:{server_port}')[0m
[30;1m180 | [0m[35m    demo.queue(default_concurrency_limit=batch_size, max_size=100, api_open=False).launch([0m
[30;1m181 | [0m[35m        max_threads=10,[0m
[30;1m182 | [0m[35m        share=share,[0m

[31m--[ [0m[34mMatch #[0m[33m232[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/gradio/api_server_backend.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m134 | [0m[35m    if isinstance(model_names, list) and len(model_names) > 0:[0m
[30;1m135 | [0m[35m        model_name = model_names[0][0m
[30;1m136 | [0m[35m    else:[0m
[30;1m137 | [0m[35m        raise ValueError('gradio can find a suitable model from restful-api')[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m    with gr.Blocks(css=CSS, theme=THEME) as demo:[0m
[30;1m140 | [0m[35m        state_chatbot = gr.State([])[0m

[31m--[ [0m[34mMatch #[0m[33m233[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/gradio/api_server_backend.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m    Args:[0m
[30;1m125 | [0m[35m        api_server_url (str): restufl api url[0m
[30;1m126 | [0m[35m        server_name (str): the ip address of gradio server[0m
[30;1m127 | [0m[35m        server_port (int): the port of gradio server[0m
[30;1m128 | [0m[35m        batch_size (int): batch size for running Turbomind directly[0m
[30;1m129 | [0m[35m        share (bool): whether to create a publicly shareable link for the app[0m

[31m--[ [0m[34mMatch #[0m[33m234[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/gradio/turbomind_coupled.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m202 | [0m[35m    if server_name == 'huggingface-space':[0m
[30;1m203 | [0m[35m        demo.queue(default_concurrency_limit=InterFace.async_engine.instance_num, max_size=100).laun[0m
[30;1m204 | [0m[35m    else:[0m
[30;1m205 | [0m[35m        print(f'server is gonna mount on: http://{server_name}:{server_port}')[0m
[30;1m206 | [0m[35m        demo.queue(default_concurrency_limit=InterFace.async_engine.instance_num, max_size=100, api_[0m
[30;1m207 | [0m[35m            max_threads=10,[0m
[30;1m208 | [0m[35m            share=share,[0m

[31m--[ [0m[34mMatch #[0m[33m235[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/gradio/turbomind_coupled.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m143 | [0m[35m            config instance. Default to none.[0m
[30;1m144 | [0m[35m        chat_template_config (ChatTemplateConfig): chat template configuration.[0m
[30;1m145 | [0m[35m            Default to None.[0m
[30;1m146 | [0m[35m        server_name (str): the ip address of gradio server. Default to[0m
[30;1m147 | [0m[35m            "0.0.0.0". For huggingface space demo, it should be[0m
[30;1m148 | [0m[35m            "huggingface-space".[0m
[30;1m149 | [0m[35m        server_port (int): the port of gradio server[0m

[31m--[ [0m[34mMatch #[0m[33m236[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/gradio/app.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m24 | [0m[35m        restful api URL. For example:[0m
[30;1m25 | [0m[35m            - huggingface hub repo_id[0m
[30;1m26 | [0m[35m            - http://0.0.0.0:23333[0m
[30;1m27 | [0m[35m        server_name (str): the ip address of gradio server[0m
[30;1m28 | [0m[35m        server_port (int): the port of gradio server[0m
[30;1m29 | [0m[35m        batch_size (int): batch size for running Turbomind directly[0m
[30;1m30 | [0m[35m        backend (str): either `turbomind` or `pytorch` backend. Default to[0m

[31m--[ [0m[34mMatch #[0m[33m237[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/vl/model/deepseek.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m139 | [0m[35m                continue[0m
[30;1m140 | [0m[35m            elif message['role'] in ['images', 'preprocess', 'forward']:[0m
[30;1m141 | [0m[35m                continue[0m
[30;1m142 | [0m[35m            content = [x.get('text', '') for x in message['content'] if x['type'] == 'text'][0m
[30;1m143 | [0m[35m            content = content[0][0m
[30;1m144 | [0m[35m            n_image = sum([1 for x in message['content'] if x['type'] == 'image'])[0m
[30;1m145 | [0m[35m            n_placeholder = content.count(IMAGE_TOKEN)[0m

[31m--[ [0m[34mMatch #[0m[33m238[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/vl/model/qwen.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m121 | [0m[35m            elif message['role'] in ['images', 'preprocess', 'forward']:[0m
[30;1m122 | [0m[35m                continue[0m
[30;1m123 | [0m[35m            n_images = len([1 for x in message['content'] if x['type'] == 'image'])[0m
[30;1m124 | [0m[35m            content = [x.get('text', '') for x in message['content'] if x['type'] == 'text'][0m
[30;1m125 | [0m[35m            prompt = content[0][0m
[30;1m126 | [0m[35m            if IMAGE_TOKEN in prompt:[0m
[30;1m127 | [0m[35m                pass[0m

[31m--[ [0m[34mMatch #[0m[33m239[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/vl/model/molmo.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m            if not isinstance(message['content'], List):[0m
[30;1m57 | [0m[35m                continue[0m
[30;1m58 | [0m[35m            images = [x['image'] for x in message['content'] if x['type'] == 'image'][0m
[30;1m59 | [0m[35m            content = [x.get('text', '') for x in message['content'] if x['type'] == 'text'][0m
[30;1m60 | [0m[35m            prompt = f' User: {content[0]}'[0m
[30;1m61 | [0m[35m            tokens = self.processor.tokenizer.encode(prompt, add_special_tokens=False)[0m
[30;1m62 | [0m[35m            # preprocess images. The output is a dict, which is[0m

[31m--[ [0m[34mMatch #[0m[33m240[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/vl/model/cogvlm.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m                continue[0m
[30;1m65 | [0m[35m            elif message['role'] in ['images', 'preprocess', 'forward']:[0m
[30;1m66 | [0m[35m                continue[0m
[30;1m67 | [0m[35m            content = [x.get('text', '') for x in message['content'] if x['type'] == 'text'][0m
[30;1m68 | [0m[35m            n_images = len([1 for x in message['content'] if x['type'] == 'image'])[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m            prompt_messages.append(dict(role='user', content=content[0], num_images=n_images))[0m

[31m--[ [0m[34mMatch #[0m[33m241[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/vl/model/xcomposer2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35m    def _preprocess_2d5(self, image: Image, params: Dict) -> Dict:[0m
[30;1m184 | [0m[35m        """image preprocessing for internlm-xcomposer2d5-7b."""[0m
[30;1m185 | [0m[35m        hd_num = params.get('hd_num', 24)[0m
[30;1m186 | [0m[35m        image = self.HD_transform(image, hd_num=hd_num)[0m
[30;1m187 | [0m[35m        pixel_values = self.vis_processor(image).unsqueeze(0).half()[0m
[30;1m188 | [0m[35m        w, h = image.size[0m

[31m--[ [0m[34mMatch #[0m[33m242[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/vl/model/deepseek_vl2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m126 | [0m[35m        elif message['role'] in ['images', 'preprocess', 'forward']:[0m
[30;1m127 | [0m[35m            return None[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m        content = [x.get('text', '') for x in message['content'] if x['type'] == 'text'][0m
[30;1m130 | [0m[35m        content = content[0][0m
[30;1m131 | [0m[35m        n_image = sum([1 for x in message['content'] if x['type'] == 'image'])[0m
[30;1m132 | [0m[35m        n_placeholder = content.count(IMAGE_TOKEN)[0m

[31m--[ [0m[34mMatch #[0m[33m243[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/vl/model/deepseek_vl2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35m    def match(cls, config: AutoConfig):[0m
[30;1m46 | [0m[35m        """check whether the config match the model."""[0m
[30;1m47 | [0m[35m        if hasattr(config, 'language_config') and hasattr(config, 'vision_config'):[0m
[30;1m48 | [0m[35m            arch = config.language_config.get('architectures', [None])[0][0m
[30;1m49 | [0m[35m            return arch == cls._arch[0m
[30;1m50 | [0m[35m        return False[0m
[30;1m51 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m244[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/utils/cudagraph.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m131 | [0m[35m            attn_metadata=attn_metadata,[0m
[30;1m132 | [0m[35m        )[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m        cross_attn_metadata = kwargs.get('cross_attn_metadata', None)[0m
[30;1m135 | [0m[35m        if cross_attn_metadata is not None:[0m
[30;1m136 | [0m[35m            # TODO: update cross_attn_metadata here[0m
[30;1m137 | [0m[35m            new_inputs['cross_attn_metadata'] = cross_attn_metadata[0m

[31m--[ [0m[34mMatch #[0m[33m245[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/utils/cudagraph.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m        cross_attn_metadata = kwargs.get('cross_attn_metadata', None)[0m
[30;1m135 | [0m[35m        if cross_attn_metadata is not None:[0m
[30;1m136 | [0m[35m            # TODO: update cross_attn_metadata here[0m
[30;1m137 | [0m[35m            new_inputs['cross_attn_metadata'] = cross_attn_metadata[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m        if is_decoding:[0m

[31m--[ [0m[34mMatch #[0m[33m246[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/vl/model/minicpmv.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m228 | [0m[35m                else:[0m
[30;1m229 | [0m[35m                    prompt = (prompt + '\n' if self.version == '2.6' else prompt)[0m
[30;1m230 | [0m[35m                prompts.append(prompt)[0m
[30;1m231 | [0m[35m            content = [x.get('text', '') for x in message['content'] if x['type'] == 'text'][0m
[30;1m232 | [0m[35m            prompt = ''.join(prompts) + content[0][0m
[30;1m233 | [0m[35m            prompt_messages.append(dict(role='user', content=prompt))[0m
[30;1m234 | [0m[35m        prompt = chat_template.messages2prompt(prompt_messages, sequence_start)[0m

[31m--[ [0m[34mMatch #[0m[33m247[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/vl/model/minicpmv.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m213 | [0m[35m            prompts = [][0m
[30;1m214 | [0m[35m            for x in message['preprocess']:[0m
[30;1m215 | [0m[35m                prompt = f'<image>{IMAGE_TOKEN}</image>'[0m
[30;1m216 | [0m[35m                if x.get('use_image_id', False):[0m
[30;1m217 | [0m[35m                    prompt = f'<image_id>{idx}</image_id>' + prompt[0m
[30;1m218 | [0m[35m                    idx += 1[0m
[30;1m219 | [0m[35m                grid = x['best_grid'][0m

[31m--[ [0m[34mMatch #[0m[33m248[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/vl/model/minicpmv.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m113 | [0m[35m        max_slice_nums = self.image_processor.max_slice_nums[0m
[30;1m114 | [0m[35m        use_image_id = self.image_processor.use_image_id[0m
[30;1m115 | [0m[35m        max_slice_nums = params.get('max_slice_nums', max_slice_nums)[0m
[30;1m116 | [0m[35m        use_image_id = params.get('use_image_id', use_image_id)[0m
[30;1m117 | [0m[35m        outputs = self.image_processor(image, max_slice_nums=max_slice_nums)[0m
[30;1m118 | [0m[35m        pixel_values = outputs['pixel_values'][0][0m
[30;1m119 | [0m[35m        num_patches = len(pixel_values)[0m

[31m--[ [0m[34mMatch #[0m[33m249[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/vl/model/minicpmv.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m112 | [0m[35m        """image preprocessing for MiniCPM-V-2_6."""[0m
[30;1m113 | [0m[35m        max_slice_nums = self.image_processor.max_slice_nums[0m
[30;1m114 | [0m[35m        use_image_id = self.image_processor.use_image_id[0m
[30;1m115 | [0m[35m        max_slice_nums = params.get('max_slice_nums', max_slice_nums)[0m
[30;1m116 | [0m[35m        use_image_id = params.get('use_image_id', use_image_id)[0m
[30;1m117 | [0m[35m        outputs = self.image_processor(image, max_slice_nums=max_slice_nums)[0m
[30;1m118 | [0m[35m        pixel_values = outputs['pixel_values'][0][0m

[31m--[ [0m[34mMatch #[0m[33m250[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/vl/model/minicpmv.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m28 | [0m[35m                 backend: str = ''):[0m
[30;1m29 | [0m[35m        super().__init__(model_path, with_llm, max_memory, hf_config, backend)[0m
[30;1m30 | [0m[35m        if not hasattr(self.hf_config, 'version'):[0m
[30;1m31 | [0m[35m            raise ValueError('Can not find `version` in config.json. '[0m
[30;1m32 | [0m[35m                             'Please checkout the latest model')[0m
[30;1m33 | [0m[35m        version = str(self.hf_config.version)[0m
[30;1m34 | [0m[35m        if version not in ['2.5', '2.6']:[0m

[31m--[ [0m[34mMatch #[0m[33m251[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/vl/model/internvl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m233 | [0m[35m            elif message['role'] in ['preprocess', 'forward']:[0m
[30;1m234 | [0m[35m                continue[0m
[30;1m235 | [0m[35m            n_images = len([1 for x in message['content'] if x['type'] == 'image'])[0m
[30;1m236 | [0m[35m            content = [x.get('text', '') for x in message['content'] if x['type'] == 'text'][0m
[30;1m237 | [0m[35m            prompt = content[0][0m
[30;1m238 | [0m[35m            if IMAGE_TOKEN in prompt and f'<img>{IMAGE_TOKEN}' not in prompt:[0m
[30;1m239 | [0m[35m                prompt = prompt.replace(f'{IMAGE_TOKEN}', f'<img>{IMAGE_TOKEN}</img>')[0m

[31m--[ [0m[34mMatch #[0m[33m252[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/vl/model/internvl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m175 | [0m[35m[0m
[30;1m176 | [0m[35m    def _forward(self, inputs, max_batch_size):[0m
[30;1m177 | [0m[35m        """forward for internvl-chat-v1-1, internvl-chat-v1-2."""[0m
[30;1m178 | [0m[35m        assert all(x.get('pixel_values') is not None for x in inputs)[0m
[30;1m179 | [0m[35m        outputs = [][0m
[30;1m180 | [0m[35m        for idx in range(0, len(inputs), max_batch_size):[0m
[30;1m181 | [0m[35m            pixel_values = [x['pixel_values'] for x in inputs[idx:idx + max_batch_size]][0m

[31m--[ [0m[34mMatch #[0m[33m253[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/vl/model/internvl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35m    def _forward_v1_5(self, inputs, max_batch_size):[0m
[30;1m157 | [0m[35m        """forward for internvl-chat-v1-5."""[0m
[30;1m158 | [0m[35m        assert all(x.get('pixel_values') is not None for x in inputs)[0m
[30;1m159 | [0m[35m        outputs = [][0m
[30;1m160 | [0m[35m        for idx in range(0, len(inputs), max_batch_size):[0m
[30;1m161 | [0m[35m            pixel_values = [x['pixel_values'] for x in inputs[idx:idx + max_batch_size]][0m

[31m--[ [0m[34mMatch #[0m[33m254[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/vl/model/internvl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m142 | [0m[35m        max_num = params.get('max_dynamic_patch')[0m
[30;1m143 | [0m[35m        if max_num is None or not isinstance(max_num, int):[0m
[30;1m144 | [0m[35m            res_key = params.get('detail', 'default')[0m
[30;1m145 | [0m[35m            max_num = image_res.get(res_key, self.config.max_dynamic_patch)[0m
[30;1m146 | [0m[35m        out = dynamic_preprocess(image,[0m
[30;1m147 | [0m[35m                                 min_num=self.config.min_dynamic_patch,[0m
[30;1m148 | [0m[35m                                 max_num=max_num,[0m

[31m--[ [0m[34mMatch #[0m[33m255[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/vl/model/internvl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m141 | [0m[35m        image_res = {'low': 6, 'medium': 12, 'high': 24}[0m
[30;1m142 | [0m[35m        max_num = params.get('max_dynamic_patch')[0m
[30;1m143 | [0m[35m        if max_num is None or not isinstance(max_num, int):[0m
[30;1m144 | [0m[35m            res_key = params.get('detail', 'default')[0m
[30;1m145 | [0m[35m            max_num = image_res.get(res_key, self.config.max_dynamic_patch)[0m
[30;1m146 | [0m[35m        out = dynamic_preprocess(image,[0m
[30;1m147 | [0m[35m                                 min_num=self.config.min_dynamic_patch,[0m

[31m--[ [0m[34mMatch #[0m[33m256[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/vl/model/internvl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35m    def _preprocess_v1_5(self, image, params=None):[0m
[30;1m141 | [0m[35m        image_res = {'low': 6, 'medium': 12, 'high': 24}[0m
[30;1m142 | [0m[35m        max_num = params.get('max_dynamic_patch')[0m
[30;1m143 | [0m[35m        if max_num is None or not isinstance(max_num, int):[0m
[30;1m144 | [0m[35m            res_key = params.get('detail', 'default')[0m
[30;1m145 | [0m[35m            max_num = image_res.get(res_key, self.config.max_dynamic_patch)[0m

[31m--[ [0m[34mMatch #[0m[33m257[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/vl/model/internvl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35m                        if i * j <= max_num and i * j >= min_num)[0m
[30;1m39 | [0m[35m    target_ratios = sorted(target_ratios, key=lambda x: x[0] * x[1])[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m    # find the closest aspect ratio to the target[0m
[30;1m42 | [0m[35m    target_aspect_ratio = find_closest_aspect_ratio(aspect_ratio, target_ratios, orig_width, orig_he[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m    # calculate the target width and height[0m

[31m--[ [0m[34mMatch #[0m[33m258[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/mllama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1316 | [0m[35m[0m
[30;1m1317 | [0m[35m            cross_kv_len = 0[0m
[30;1m1318 | [0m[35m            if model_metas[idx] is not None:[0m
[30;1m1319 | [0m[35m                cross_kv_len = model_metas[idx].get('cross_kv_len', cross_kv_len)[0m
[30;1m1320 | [0m[35m            cross_kv_len += img_kv_len * num_img[0m
[30;1m1321 | [0m[35m            new_model_metas.append(dict(cross_kv_len=cross_kv_len))[0m
[30;1m1322 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m259[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/mllama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1311 | [0m[35m        for idx, input_mm in enumerate(input_mms):[0m
[30;1m1312 | [0m[35m            if input_mm is None:[0m
[30;1m1313 | [0m[35m                new_model_metas.append(model_metas[idx])[0m
[30;1m1314 | [0m[35m            images = input_mm.get('image', [])[0m
[30;1m1315 | [0m[35m            num_img = len(images)[0m
[30;1m1316 | [0m[35m[0m
[30;1m1317 | [0m[35m            cross_kv_len = 0[0m

[31m--[ [0m[34mMatch #[0m[33m260[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/mllama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1162 | [0m[35m            pixel_values = [][0m
[30;1m1163 | [0m[35m            aspect_ratio_ids = [][0m
[30;1m1164 | [0m[35m            aspect_ratio_mask = [][0m
[30;1m1165 | [0m[35m            batched_image_data = [input_mm.get('image', []) for input_mm in context.input_multimodal[0m
[30;1m1166 | [0m[35m            for image_data in batched_image_data:[0m
[30;1m1167 | [0m[35m                for data in image_data:[0m
[30;1m1168 | [0m[35m                    pixel_values.append(data.data)[0m

[31m--[ [0m[34mMatch #[0m[33m261[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/mllama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m448 | [0m[35m            elif rope_type == 'llama3':[0m
[30;1m449 | [0m[35m                emb_type = RopeType.Llama3[0m
[30;1m450 | [0m[35m                low_freq_factor = rope_scaling.get('low_freq_factor', 1.0)[0m
[30;1m451 | [0m[35m                high_freq_factor = rope_scaling.get('high_freq_factor', 1.0)[0m
[30;1m452 | [0m[35m                llama3_params = Llama3Parameters(low_freq_factor, high_freq_factor)[0m
[30;1m453 | [0m[35m            else:[0m
[30;1m454 | [0m[35m                raise RuntimeError(f'Unsupported rope type: {rope_type}')[0m

[31m--[ [0m[34mMatch #[0m[33m262[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/mllama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m447 | [0m[35m                emb_type = RopeType.LinearScaling[0m
[30;1m448 | [0m[35m            elif rope_type == 'llama3':[0m
[30;1m449 | [0m[35m                emb_type = RopeType.Llama3[0m
[30;1m450 | [0m[35m                low_freq_factor = rope_scaling.get('low_freq_factor', 1.0)[0m
[30;1m451 | [0m[35m                high_freq_factor = rope_scaling.get('high_freq_factor', 1.0)[0m
[30;1m452 | [0m[35m                llama3_params = Llama3Parameters(low_freq_factor, high_freq_factor)[0m
[30;1m453 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m263[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/mllama.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m31 | [0m[35m    target_length: int,[0m
[30;1m32 | [0m[35m    dtype: torch.dtype,[0m
[30;1m33 | [0m[35m) -> torch.Tensor:[0m
[30;1m34 | [0m[35m    # Expand aspect ratio mask to target_length[0m
[30;1m35 | [0m[35m    batch_size, max_num_tiles = aspect_ratio_mask.shape[0m
[30;1m36 | [0m[35m    attention_mask = aspect_ratio_mask.view(batch_size, max_num_tiles, 1, 1).to(dtype)[0m
[30;1m37 | [0m[35m    attention_mask = attention_mask.repeat(1, 1, target_length, 1)[0m

[31m--[ [0m[34mMatch #[0m[33m264[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/mllama.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m196 | [0m[35m        past_key_value: Optional[Tuple[torch.Tensor]] = None,[0m
[30;1m197 | [0m[35m        cross_attn_metadata: Any = None,[0m
[30;1m198 | [0m[35m    ) -> Tuple[torch.Tensor, Optional[torch.Tensor], Optional[Tuple[torch.Tensor]]]:[0m
[30;1m199 | [0m[35m        """Input shape: Batch x Time x Channel."""[0m
[30;1m200 | [0m[35m        qkv_states = self.qkv_proj(hidden_states)[0m
[30;1m201 | [0m[35m        qkv_states = qkv_states.flatten(0, -2)[0m
[30;1m202 | [0m[35m        query_states, _, _ = self.qkv_proj.split_qkv(qkv_states)[0m

[31m--[ [0m[34mMatch #[0m[33m265[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/mllama.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35m    target_length: int,[0m
[30;1m32 | [0m[35m    dtype: torch.dtype,[0m
[30;1m33 | [0m[35m) -> torch.Tensor:[0m
[30;1m34 | [0m[35m    # Expand aspect ratio mask to target_length[0m
[30;1m35 | [0m[35m    batch_size, max_num_tiles = aspect_ratio_mask.shape[0m
[30;1m36 | [0m[35m    attention_mask = aspect_ratio_mask.view(batch_size, max_num_tiles, 1, 1).to(dtype)[0m
[30;1m37 | [0m[35m    attention_mask = attention_mask.repeat(1, 1, target_length, 1)[0m

[31m--[ [0m[34mMatch #[0m[33m266[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/llava.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m775 | [0m[35m        image_sizes = None[0m
[30;1m776 | [0m[35m        image_mask = None[0m
[30;1m777 | [0m[35m        if context.input_multimodals is not None:[0m
[30;1m778 | [0m[35m            img_mms = [input_mm.get('image', []) for input_mm in context.input_multimodals][0m
[30;1m779 | [0m[35m            # flatten batch[0m
[30;1m780 | [0m[35m            img_mms = [data for im_data in img_mms for data in im_data][0m
[30;1m781 | [0m[35m            if len(img_mms) > 0:[0m

[31m--[ [0m[34mMatch #[0m[33m267[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/llava.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m461 | [0m[35m        pixel_values = None[0m
[30;1m462 | [0m[35m        image_mask = None[0m
[30;1m463 | [0m[35m        if context.input_multimodals is not None:[0m
[30;1m464 | [0m[35m            pixel_values = [input_mm.get('image', []) for input_mm in context.input_multimodals][0m
[30;1m465 | [0m[35m            # flatten batch[0m
[30;1m466 | [0m[35m            pixel_values = [data for im_data in pixel_values for data in im_data][0m
[30;1m467 | [0m[35m            if len(pixel_values) > 0:[0m

[31m--[ [0m[34mMatch #[0m[33m268[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/falcon.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m258 | [0m[35m                emb_type = RopeType.DynamicNTKScaling[0m
[30;1m259 | [0m[35m            else:[0m
[30;1m260 | [0m[35m                raise RuntimeError(f'Unsupported rope type: {rope_type}')[0m
[30;1m261 | [0m[35m            scaling_factor = rope_scaling.get('scaling_factor', scaling_factor)[0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m        rope_dim = config.hidden_size // config.num_attention_heads[0m
[30;1m264 | [0m[35m        rope_max_pos_emb = getattr(config, 'max_position_embeddings', 2048)[0m

[31m--[ [0m[34mMatch #[0m[33m269[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/deepseek_vl2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m434 | [0m[35m            offset = input_mm['offset'][0m
[30;1m435 | [0m[35m            image_token_id = input_mm['image_token_id'][0m
[30;1m436 | [0m[35m            num_pad = input_mm['image_tokens'][0m
[30;1m437 | [0m[35m            images_spatial_crop = input_mm.get('images_spatial_crop', None)[0m
[30;1m438 | [0m[35m            if isinstance(num_pad, torch.Tensor):[0m
[30;1m439 | [0m[35m                num_pad = num_pad.item()[0m
[30;1m440 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m270[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/deepseek_vl2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m353 | [0m[35m        image_mask = None[0m
[30;1m354 | [0m[35m        if context.input_multimodals is not None:[0m
[30;1m355 | [0m[35m            pixel_values = [input_mm.get('image', []) for input_mm in context.input_multimodals][0m
[30;1m356 | [0m[35m            images_spatial_crop = [p_value[0].meta.get('images_spatial_crop', None) for p_value in p[0m
[30;1m357 | [0m[35m            # flatten batch[0m
[30;1m358 | [0m[35m            pixel_values = [data for im_data in pixel_values for data in im_data][0m
[30;1m359 | [0m[35m            if len(pixel_values) > 0:[0m

[31m--[ [0m[34mMatch #[0m[33m271[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/deepseek_vl2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m352 | [0m[35m        images_spatial_crop = None[0m
[30;1m353 | [0m[35m        image_mask = None[0m
[30;1m354 | [0m[35m        if context.input_multimodals is not None:[0m
[30;1m355 | [0m[35m            pixel_values = [input_mm.get('image', []) for input_mm in context.input_multimodals][0m
[30;1m356 | [0m[35m            images_spatial_crop = [p_value[0].meta.get('images_spatial_crop', None) for p_value in p[0m
[30;1m357 | [0m[35m            # flatten batch[0m
[30;1m358 | [0m[35m            pixel_values = [data for im_data in pixel_values for data in im_data][0m

[31m--[ [0m[34mMatch #[0m[33m272[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/gemma3_vl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m285 | [0m[35m        pixel_values = None[0m
[30;1m286 | [0m[35m        image_mask = None[0m
[30;1m287 | [0m[35m        if context.input_multimodals is not None:[0m
[30;1m288 | [0m[35m            pixel_values = [input_mm.get('image', []) for input_mm in context.input_multimodals][0m
[30;1m289 | [0m[35m            # flatten batch[0m
[30;1m290 | [0m[35m            pixel_values = [data for im_data in pixel_values for data in im_data][0m
[30;1m291 | [0m[35m            if len(pixel_values) > 0:[0m

[31m--[ [0m[34mMatch #[0m[33m273[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/internvl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m396 | [0m[35m        pixel_values = None[0m
[30;1m397 | [0m[35m        image_mask = None[0m
[30;1m398 | [0m[35m        if context.input_multimodals is not None:[0m
[30;1m399 | [0m[35m            pixel_values = [input_mm.get('image', []) for input_mm in context.input_multimodals][0m
[30;1m400 | [0m[35m            # flatten batch[0m
[30;1m401 | [0m[35m            pixel_values = [data for im_data in pixel_values for data in im_data][0m
[30;1m402 | [0m[35m            if len(pixel_values) > 0:[0m

[31m--[ [0m[34mMatch #[0m[33m274[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/blocked_fp8_fused_moe.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m134 | [0m[35m        # mma[0m
[30;1m135 | [0m[35m        accumulator = tl.dot(a, b, acc=accumulator * acc_ratio[:, None])[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35m        # update scales and ratio[0m
[30;1m138 | [0m[35m        new_acc_scale = a_scale * b_scale[0m
[30;1m139 | [0m[35m        acc_ratio = acc_scale / new_acc_scale[0m
[30;1m140 | [0m[35m        acc_scale = new_acc_scale[0m

[31m--[ [0m[34mMatch #[0m[33m275[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/internlm2_ve.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m        scaling_factor = 1.0[0m
[30;1m119 | [0m[35m        emb_type = RopeType.LinearScaling[0m
[30;1m120 | [0m[35m        if rope_scaling is not None:[0m
[30;1m121 | [0m[35m            scaling_factor = rope_scaling.get('factor', scaling_factor)[0m
[30;1m122 | [0m[35m            rope_type = rope_scaling['type'][0m
[30;1m123 | [0m[35m            if rope_type == 'linear':[0m
[30;1m124 | [0m[35m                emb_type = RopeType.LinearScaling[0m

[31m--[ [0m[34mMatch #[0m[33m276[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/fused_moe.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m    s_off = tl.arange(0, BLOCK)[0m
[30;1m210 | [0m[35m[0m
[30;1m211 | [0m[35m    # find start[0m
[30;1m212 | [0m[35m    for sidx_start in range(0, len_sorted_idx, BLOCK):[0m
[30;1m213 | [0m[35m        sidx_off = sidx_start + s_off[0m
[30;1m214 | [0m[35m        sidx_mask = sidx_off < len_sorted_idx[0m

[31m--[ [0m[34mMatch #[0m[33m277[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/deepseek_v2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m769 | [0m[35m                quantization_config = self.quantization_config[0m
[30;1m770 | [0m[35m                quant_method = None[0m
[30;1m771 | [0m[35m                if quantization_config is not None:[0m
[30;1m772 | [0m[35m                    quant_method = quantization_config.get('quant_method')[0m
[30;1m773 | [0m[35m[0m
[30;1m774 | [0m[35m                loaded_weight = loaded_weight.to(device)[0m
[30;1m775 | [0m[35m                if quant_method == 'fp8':[0m

[31m--[ [0m[34mMatch #[0m[33m278[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/deepseek_v2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m552 | [0m[35m                emb_type = RopeType.DynamicNTKScaling[0m
[30;1m553 | [0m[35m            elif scaling_type == 'yarn':[0m
[30;1m554 | [0m[35m                emb_type = RopeType.Yarn[0m
[30;1m555 | [0m[35m                rope_max_pos_emb = config.rope_scaling.get('original_max_position_embeddings', 4096)[0m
[30;1m556 | [0m[35m                kwargs = {[0m
[30;1m557 | [0m[35m                    key: config.rope_scaling[key][0m
[30;1m558 | [0m[35m                    for key in [[0m

[31m--[ [0m[34mMatch #[0m[33m279[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/deepseek_v2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m142 | [0m[35m        self.softmax_scale = self.q_head_dim**(-0.5)[0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m        if config.rope_scaling is not None:[0m
[30;1m145 | [0m[35m            mscale_all_dim = config.rope_scaling.get('mscale_all_dim', 0)[0m
[30;1m146 | [0m[35m            scaling_factor = config.rope_scaling['factor'][0m
[30;1m147 | [0m[35m            if mscale_all_dim:[0m
[30;1m148 | [0m[35m                mscale = yarn_get_mscale(scaling_factor, mscale_all_dim)[0m

[31m--[ [0m[34mMatch #[0m[33m280[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/deepseek_v2.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m773 | [0m[35m[0m
[30;1m774 | [0m[35m                loaded_weight = loaded_weight.to(device)[0m
[30;1m775 | [0m[35m                if quant_method == 'fp8':[0m
[30;1m776 | [0m[35m                    # update blocked fp8 weight[0m
[30;1m777 | [0m[35m                    __load_kcvc_blocked_fp8(name, loaded_weight)[0m
[30;1m778 | [0m[35m                else:[0m
[30;1m779 | [0m[35m                    __load_kcvc(name, loaded_weight)[0m

[31m--[ [0m[34mMatch #[0m[33m281[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/alibi_pagedattention.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m733 | [0m[35m        # update acc[0m
[30;1m734 | [0m[35m        p = p.to(v.dtype)[0m
[30;1m735 | [0m[35m        acc += tl.dot(p, v)[0m
[30;1m736 | [0m[35m        # update m_i and l_i[0m
[30;1m737 | [0m[35m        l_i = l_i_new[0m
[30;1m738 | [0m[35m        m_i = m_i_new[0m
[30;1m739 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m282[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/alibi_pagedattention.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m730 | [0m[35m        # scale acc[0m
[30;1m731 | [0m[35m        acc = acc * alpha[:, None][0m
[30;1m732 | [0m[35m[0m
[30;1m733 | [0m[35m        # update acc[0m
[30;1m734 | [0m[35m        p = p.to(v.dtype)[0m
[30;1m735 | [0m[35m        acc += tl.dot(p, v)[0m
[30;1m736 | [0m[35m        # update m_i and l_i[0m

[31m--[ [0m[34mMatch #[0m[33m283[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/alibi_pagedattention.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m726 | [0m[35m        p = tl.exp(qk - m_i_new[:, None])[0m
[30;1m727 | [0m[35m        alpha = tl.exp(m_i - m_i_new)[0m
[30;1m728 | [0m[35m        l_i_new = alpha * l_i + tl.sum(p, 1)[0m
[30;1m729 | [0m[35m        # -- update output accumulator --[0m
[30;1m730 | [0m[35m        # scale acc[0m
[30;1m731 | [0m[35m        acc = acc * alpha[:, None][0m
[30;1m732 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m284[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/alibi_pagedattention.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m548 | [0m[35m        # update acc[0m
[30;1m549 | [0m[35m        p_new = p.to(v.dtype)[0m
[30;1m550 | [0m[35m        acc += tl.sum(p_new[:, None] * v, 0)[0m
[30;1m551 | [0m[35m        # update m_i and l_i[0m
[30;1m552 | [0m[35m        l_i = l_i_new[0m
[30;1m553 | [0m[35m        m_i = m_i_new[0m
[30;1m554 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m285[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/alibi_pagedattention.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m545 | [0m[35m        # scale acc[0m
[30;1m546 | [0m[35m        acc = acc * alpha[0m
[30;1m547 | [0m[35m[0m
[30;1m548 | [0m[35m        # update acc[0m
[30;1m549 | [0m[35m        p_new = p.to(v.dtype)[0m
[30;1m550 | [0m[35m        acc += tl.sum(p_new[:, None] * v, 0)[0m
[30;1m551 | [0m[35m        # update m_i and l_i[0m

[31m--[ [0m[34mMatch #[0m[33m286[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/alibi_pagedattention.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m541 | [0m[35m        alpha = tl.exp(m_i - m_i_new)[0m
[30;1m542 | [0m[35m        l_i_new = alpha * l_i + tl.sum(p, 0)[0m
[30;1m543 | [0m[35m[0m
[30;1m544 | [0m[35m        # -- update output accumulator --[0m
[30;1m545 | [0m[35m        # scale acc[0m
[30;1m546 | [0m[35m        acc = acc * alpha[0m
[30;1m547 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m287[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/alibi_pagedattention.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m363 | [0m[35m        # update acc[0m
[30;1m364 | [0m[35m        p = p.to(v.dtype)[0m
[30;1m365 | [0m[35m        acc += tl.dot(p, v)[0m
[30;1m366 | [0m[35m        # update m_i and l_i[0m
[30;1m367 | [0m[35m        l_i = l_i_new[0m
[30;1m368 | [0m[35m        m_i = m_i_new[0m
[30;1m369 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m288[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/alibi_pagedattention.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m360 | [0m[35m        # scale acc[0m
[30;1m361 | [0m[35m        acc = acc * alpha[:, None][0m
[30;1m362 | [0m[35m[0m
[30;1m363 | [0m[35m        # update acc[0m
[30;1m364 | [0m[35m        p = p.to(v.dtype)[0m
[30;1m365 | [0m[35m        acc += tl.dot(p, v)[0m
[30;1m366 | [0m[35m        # update m_i and l_i[0m

[31m--[ [0m[34mMatch #[0m[33m289[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/alibi_pagedattention.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m356 | [0m[35m        p = tl.exp(qk - m_i_new[:, None])[0m
[30;1m357 | [0m[35m        alpha = tl.exp(m_i - m_i_new)[0m
[30;1m358 | [0m[35m        l_i_new = alpha * l_i + tl.sum(p, 1)[0m
[30;1m359 | [0m[35m        # -- update output accumulator --[0m
[30;1m360 | [0m[35m        # scale acc[0m
[30;1m361 | [0m[35m        acc = acc * alpha[:, None][0m
[30;1m362 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m290[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/alibi_pagedattention.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m187 | [0m[35m        # update acc[0m
[30;1m188 | [0m[35m        p_new = p.to(v.dtype)[0m
[30;1m189 | [0m[35m        acc += tl.sum(p_new[:, None] * v, 0)[0m
[30;1m190 | [0m[35m        # update m_i and l_i[0m
[30;1m191 | [0m[35m        l_i = l_i_new[0m
[30;1m192 | [0m[35m        m_i = m_i_new[0m
[30;1m193 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m291[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/alibi_pagedattention.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m184 | [0m[35m        # scale acc[0m
[30;1m185 | [0m[35m        acc = acc * alpha[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m        # update acc[0m
[30;1m188 | [0m[35m        p_new = p.to(v.dtype)[0m
[30;1m189 | [0m[35m        acc += tl.sum(p_new[:, None] * v, 0)[0m
[30;1m190 | [0m[35m        # update m_i and l_i[0m

[31m--[ [0m[34mMatch #[0m[33m292[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/alibi_pagedattention.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m180 | [0m[35m        alpha = tl.exp(m_i - m_i_new)[0m
[30;1m181 | [0m[35m        l_i_new = alpha * l_i + tl.sum(p, 0)[0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35m        # -- update output accumulator --[0m
[30;1m184 | [0m[35m        # scale acc[0m
[30;1m185 | [0m[35m        acc = acc * alpha[0m
[30;1m186 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m293[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/alibi_pagedattention.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m794 | [0m[35m    batch, head = b_seq_len.shape[0], q.shape[-2][0m
[30;1m795 | [0m[35m    kv_group_num = q.shape[-2] // k[0].shape[-2][0m
[30;1m796 | [0m[35m    if num_heads <= 0:[0m
[30;1m797 | [0m[35m        num_heads = head[0m
[30;1m798 | [0m[35m[0m
[30;1m799 | [0m[35m    BLOCK = 64 if k.size(1) < 16 else k.size(1)[0m
[30;1m800 | [0m[35m    num_sub_blocks = BLOCK // k.size(1)[0m

[31m--[ [0m[34mMatch #[0m[33m294[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/alibi_pagedattention.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m791 | [0m[35m        assert Lk in {16, 32, 64, 128}[0m
[30;1m792 | [0m[35m[0m
[30;1m793 | [0m[35m    sm_scale = 1.0 / (Lq**0.5)  # 计算scale系数[0m
[30;1m794 | [0m[35m    batch, head = b_seq_len.shape[0], q.shape[-2][0m
[30;1m795 | [0m[35m    kv_group_num = q.shape[-2] // k[0].shape[-2][0m
[30;1m796 | [0m[35m    if num_heads <= 0:[0m
[30;1m797 | [0m[35m        num_heads = head[0m

[31m--[ [0m[34mMatch #[0m[33m295[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/alibi_pagedattention.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m776 | [0m[35m        max_input_len (int): The max input length.[0m
[30;1m777 | [0m[35m        head_offset (int): The offset of the start head. Head might be[0m
[30;1m778 | [0m[35m            partitioned when tensor parallel inference.[0m
[30;1m779 | [0m[35m        num_heads (int): The number of heads. Head might be partitioned when[0m
[30;1m780 | [0m[35m            tensor parallel inference.[0m
[30;1m781 | [0m[35m        BLOCK (int): The kernel block size.[0m
[30;1m782 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m296[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/alibi_pagedattention.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m774 | [0m[35m        b_seq_len (Tensor): Query length for each data in batch.[0m
[30;1m775 | [0m[35m        b_kv_seq_len (Tensor): Key/Value length for each data in batch.[0m
[30;1m776 | [0m[35m        max_input_len (int): The max input length.[0m
[30;1m777 | [0m[35m        head_offset (int): The offset of the start head. Head might be[0m
[30;1m778 | [0m[35m            partitioned when tensor parallel inference.[0m
[30;1m779 | [0m[35m        num_heads (int): The number of heads. Head might be partitioned when[0m
[30;1m780 | [0m[35m            tensor parallel inference.[0m

[31m--[ [0m[34mMatch #[0m[33m297[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/alibi_pagedattention.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m609 | [0m[35m    Args:[0m
[30;1m610 | [0m[35m        stride_xbs: stride of block size dim[0m
[30;1m611 | [0m[35m        stride_h: stride of head num dim[0m
[30;1m612 | [0m[35m        stride_d: stride of head size dim[0m
[30;1m613 | [0m[35m    """[0m
[30;1m614 | [0m[35m    cur_batch = tl.program_id(0)[0m
[30;1m615 | [0m[35m    cur_head = tl.program_id(1)[0m

[31m--[ [0m[34mMatch #[0m[33m298[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/alibi_pagedattention.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m608 | [0m[35m[0m
[30;1m609 | [0m[35m    Args:[0m
[30;1m610 | [0m[35m        stride_xbs: stride of block size dim[0m
[30;1m611 | [0m[35m        stride_h: stride of head num dim[0m
[30;1m612 | [0m[35m        stride_d: stride of head size dim[0m
[30;1m613 | [0m[35m    """[0m
[30;1m614 | [0m[35m    cur_batch = tl.program_id(0)[0m

[31m--[ [0m[34mMatch #[0m[33m299[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/alibi_pagedattention.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m422 | [0m[35m    Args:[0m
[30;1m423 | [0m[35m        stride_xbs: stride of block size dim[0m
[30;1m424 | [0m[35m        stride_h: stride of head num dim[0m
[30;1m425 | [0m[35m        stride_d: stride of head size dim[0m
[30;1m426 | [0m[35m    """[0m
[30;1m427 | [0m[35m    cur_batch = tl.program_id(0)[0m
[30;1m428 | [0m[35m    cur_head = tl.program_id(1)[0m

[31m--[ [0m[34mMatch #[0m[33m300[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/alibi_pagedattention.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m421 | [0m[35m[0m
[30;1m422 | [0m[35m    Args:[0m
[30;1m423 | [0m[35m        stride_xbs: stride of block size dim[0m
[30;1m424 | [0m[35m        stride_h: stride of head num dim[0m
[30;1m425 | [0m[35m        stride_d: stride of head size dim[0m
[30;1m426 | [0m[35m    """[0m
[30;1m427 | [0m[35m    cur_batch = tl.program_id(0)[0m

[31m--[ [0m[34mMatch #[0m[33m301[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/q_modules.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m121 | [0m[35m        return q_mod[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m    def forward(self, input):[0m
[30;1m124 | [0m[35m        """Defines the computation performed at every call.[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m        Performs quantization if the input is a tensor, otherwise it assumes the input is already qu[0m
[30;1m127 | [0m[35m        QTensor). Then, it performs linear transformation using dynamic quantization method, resulti[0m

[31m--[ [0m[34mMatch #[0m[33m302[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/q_modules.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m54 | [0m[35m        return q_mod[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m    def forward(self, hidden_states):[0m
[30;1m57 | [0m[35m        """Defines the computation performed at every call.[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m        Performs RMS normalization followed by dynamic quantization on hidden_states. Returns a QTen[0m
[30;1m60 | [0m[35m        quantized tensor along with its scale factor.[0m

[31m--[ [0m[34mMatch #[0m[33m303[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/qwen2_5_vl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m639 | [0m[35m        for pos_ids, model_meta, input_mm in zip(batched_pos_ids, model_metas, input_multimodals):[0m
[30;1m640 | [0m[35m            images = [][0m
[30;1m641 | [0m[35m            if input_mm is not None:[0m
[30;1m642 | [0m[35m                images = input_mm.get('image', [])[0m
[30;1m643 | [0m[35m            if model_meta is None or 'mrope_delta' not in model_meta:[0m
[30;1m644 | [0m[35m                mrope_delta = 0[0m
[30;1m645 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m304[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/qwen2_5_vl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m592 | [0m[35m[0m
[30;1m593 | [0m[35m        is_decoding = graph_meta.is_decoding[0m
[30;1m594 | [0m[35m        input_buffers = graph_meta.input_buffers[0m
[30;1m595 | [0m[35m        mrope_position_ids = kwargs.get('mrope_position_ids', None)[0m
[30;1m596 | [0m[35m        if mrope_position_ids is not None:[0m
[30;1m597 | [0m[35m            input_buffers['mrope_position_ids'][:, :num_tokens] = mrope_position_ids[0m
[30;1m598 | [0m[35m            if is_decoding:[0m

[31m--[ [0m[34mMatch #[0m[33m305[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/qwen2_5_vl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m584 | [0m[35m        new_inputs = super().fill_buffers_cudagraph(graph_meta=graph_meta, **kwargs)[0m
[30;1m585 | [0m[35m[0m
[30;1m586 | [0m[35m        input_ids = kwargs.get('input_ids')[0m
[30;1m587 | [0m[35m        attn_metadata = kwargs.get('attn_metadata')[0m
[30;1m588 | [0m[35m        block_offsets = attn_metadata.block_offsets[0m
[30;1m589 | [0m[35m        num_tokens = input_ids.size(-1)[0m
[30;1m590 | [0m[35m        batch_size, _ = block_offsets.size()[0m

[31m--[ [0m[34mMatch #[0m[33m306[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/qwen2_5_vl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m583 | [0m[35m[0m
[30;1m584 | [0m[35m        new_inputs = super().fill_buffers_cudagraph(graph_meta=graph_meta, **kwargs)[0m
[30;1m585 | [0m[35m[0m
[30;1m586 | [0m[35m        input_ids = kwargs.get('input_ids')[0m
[30;1m587 | [0m[35m        attn_metadata = kwargs.get('attn_metadata')[0m
[30;1m588 | [0m[35m        block_offsets = attn_metadata.block_offsets[0m
[30;1m589 | [0m[35m        num_tokens = input_ids.size(-1)[0m

[31m--[ [0m[34mMatch #[0m[33m307[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/qwen2_5_vl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m572 | [0m[35m        max_tokens = graph_meta.max_tokens[0m
[30;1m573 | [0m[35m[0m
[30;1m574 | [0m[35m        input_buffers = super().make_buffers_cudagraph(graph_meta=graph_meta, **kwargs)[0m
[30;1m575 | [0m[35m        mrope_position_ids = kwargs.get('mrope_position_ids', None)[0m
[30;1m576 | [0m[35m        if mrope_position_ids is not None:[0m
[30;1m577 | [0m[35m            input_buffers['mrope_position_ids'] = mrope_position_ids.new_zeros(3, max_tokens)[0m
[30;1m578 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m308[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/qwen2_5_vl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m479 | [0m[35m        window_index = None[0m
[30;1m480 | [0m[35m        cu_window_seqlens = None[0m
[30;1m481 | [0m[35m        if context.input_multimodals is not None:[0m
[30;1m482 | [0m[35m            image_data = [input_mm.get('image', []) for input_mm in context.input_multimodals][0m
[30;1m483 | [0m[35m[0m
[30;1m484 | [0m[35m            if len(image_data) > 0:[0m
[30;1m485 | [0m[35m                # flatten batch[0m

[31m--[ [0m[34mMatch #[0m[33m309[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/llama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m244 | [0m[35m            elif rope_type == 'llama3':[0m
[30;1m245 | [0m[35m                emb_type = RopeType.Llama3[0m
[30;1m246 | [0m[35m                low_freq_factor = rope_scaling.get('low_freq_factor', 1.0)[0m
[30;1m247 | [0m[35m                high_freq_factor = rope_scaling.get('high_freq_factor', 1.0)[0m
[30;1m248 | [0m[35m                llama3_params = Llama3Parameters(low_freq_factor, high_freq_factor)[0m
[30;1m249 | [0m[35m            else:[0m
[30;1m250 | [0m[35m                raise RuntimeError(f'Unsupported rope type: {rope_type}')[0m

[31m--[ [0m[34mMatch #[0m[33m310[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/llama.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m243 | [0m[35m                emb_type = RopeType.LinearScaling[0m
[30;1m244 | [0m[35m            elif rope_type == 'llama3':[0m
[30;1m245 | [0m[35m                emb_type = RopeType.Llama3[0m
[30;1m246 | [0m[35m                low_freq_factor = rope_scaling.get('low_freq_factor', 1.0)[0m
[30;1m247 | [0m[35m                high_freq_factor = rope_scaling.get('high_freq_factor', 1.0)[0m
[30;1m248 | [0m[35m                llama3_params = Llama3Parameters(low_freq_factor, high_freq_factor)[0m
[30;1m249 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m311[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/internlm.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m230 | [0m[35m        rope_type = rope_scaling['type'][0m
[30;1m231 | [0m[35m        if rope_type == 'dynamic':[0m
[30;1m232 | [0m[35m            emb_type = RopeType.DynamicNTKScaling[0m
[30;1m233 | [0m[35m            scaling_factor = rope_scaling.get('scaling_factor', 1.0)[0m
[30;1m234 | [0m[35m        elif rope_type == 'origin':[0m
[30;1m235 | [0m[35m            emb_type = RopeType.LinearScaling[0m
[30;1m236 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m312[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/guided_process.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m4 | [0m[35m#[0m
[30;1m5 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License");[0m
[30;1m6 | [0m[35m# you may not use this file except in compliance with the License.[0m
[30;1m7 | [0m[35m# You may obtain a copy of the License at[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m#     http://www.apache.org/licenses/LICENSE-2.0[0m
[30;1m10 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m313[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/request.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m265 | [0m[35m    def process_request(self, req_type: RequestType, reqs: ReqList, **kwargs):[0m
[30;1m266 | [0m[35m        """process reqs with given req type."""[0m
[30;1m267 | [0m[35m        # get callback[0m
[30;1m268 | [0m[35m        func = self.callbacks.get(req_type, None)[0m
[30;1m269 | [0m[35m        if func is not None:[0m
[30;1m270 | [0m[35m            func(reqs, **kwargs)[0m
[30;1m271 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m314[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/request.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m236 | [0m[35m            reqs += elem[0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m        if num_reqs == 0:[0m
[30;1m239 | [0m[35m            elem = await self.requests.get()[0m
[30;1m240 | [0m[35m            __proc_reqs(elem)[0m
[30;1m241 | [0m[35m            num_reqs = self.requests.qsize()[0m
[30;1m242 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m315[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/model_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m419 | [0m[35m    async def get_output_async(self):[0m
[30;1m420 | [0m[35m        """async get output."""[0m
[30;1m421 | [0m[35m        assert self._out_que is not None, ('Please start backendground task before forward.')[0m
[30;1m422 | [0m[35m        out = await self._out_que.get()[0m
[30;1m423 | [0m[35m        event = out.pop('event')[0m
[30;1m424 | [0m[35m        while not event.query():[0m
[30;1m425 | [0m[35m            await asyncio.sleep(0.001)[0m

[31m--[ [0m[34mMatch #[0m[33m316[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/model_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m367 | [0m[35m        """async loop background."""[0m
[30;1m368 | [0m[35m        with self.all_context(), torch.cuda.stream(self.stream):[0m
[30;1m369 | [0m[35m            while True:[0m
[30;1m370 | [0m[35m                forward_inputs = await self._in_que.get()[0m
[30;1m371 | [0m[35m[0m
[30;1m372 | [0m[35m                if forward_event is not None:[0m
[30;1m373 | [0m[35m                    forward_event.clear()[0m

[31m--[ [0m[34mMatch #[0m[33m317[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/model_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m344 | [0m[35m                dist.broadcast(next_token_ids, src=rank // tp * tp, group=tp_gpu_group)[0m
[30;1m345 | [0m[35m[0m
[30;1m346 | [0m[35m            # send output[0m
[30;1m347 | [0m[35m            model_metas = output.get('model_metas')[0m
[30;1m348 | [0m[35m            if rank % tp == 0:[0m
[30;1m349 | [0m[35m                event = torch.cuda.Event()[0m
[30;1m350 | [0m[35m                event.record()[0m

[31m--[ [0m[34mMatch #[0m[33m318[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/model_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m233 | [0m[35m            for inp in new_inputs:[0m
[30;1m234 | [0m[35m                inp.model_metas = model_metas[0m
[30;1m235 | [0m[35m                tmp_out = await __forward(inp)[0m
[30;1m236 | [0m[35m                model_metas = tmp_out.get('model_metas')[0m
[30;1m237 | [0m[35m                output_gather.gather(tmp_out)[0m
[30;1m238 | [0m[35m                tmp_out.pop('hidden_states', None)[0m
[30;1m239 | [0m[35m            tmp_out['hidden_states'] = output_gather.get_output()[0m

[31m--[ [0m[34mMatch #[0m[33m319[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/model_agent.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m355 | [0m[35m                              event=event)[0m
[30;1m356 | [0m[35m                output_que.put_nowait(output)[0m
[30;1m357 | [0m[35m[0m
[30;1m358 | [0m[35m            # update for next loop[0m
[30;1m359 | [0m[35m            if is_decoding and idx < loop_count - 1:[0m
[30;1m360 | [0m[35m                swap_in_map = dict()[0m
[30;1m361 | [0m[35m                swap_out_map = dict()[0m

[31m--[ [0m[34mMatch #[0m[33m320[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/module.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m144 | [0m[35m            return[0m
[30;1m145 | [0m[35m        for p in get_params(r.moe_ffn_expert()):[0m
[30;1m146 | [0m[35m            for e in range(self.expert_num[i]):[0m
[30;1m147 | [0m[35m                fmt = self._moe_ffn_expert.replace('E', str(e))[0m
[30;1m148 | [0m[35m                p(partial(self._export, self.inter_size, fmt), partial(r.moe_ffn_expert, e, i), i)[0m
[30;1m149 | [0m[35m[0m
[30;1m150 | [0m[35m        gate = transpose(r.moe_ffn_gate(i))[0m

[31m--[ [0m[34mMatch #[0m[33m321[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/lite/apis/calibrate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m182 | [0m[35m        else:[0m
[30;1m183 | [0m[35m            updated_fc2fcs.update({prev_fc: post_fc})[0m
[30;1m184 | [0m[35m    FC_FCS_MAP[LAYER_TYPE_MAP[model_type]] = updated_fc2fcs[0m
[30;1m185 | [0m[35m    # update NORM_FCS_MAP[0m
[30;1m186 | [0m[35m    norm2fcs = NORM_FCS_MAP[LAYER_TYPE_MAP[model_type]][0m
[30;1m187 | [0m[35m    updated_norm2fcs = dict()[0m
[30;1m188 | [0m[35m    for norm, fc in norm2fcs.items():[0m

[31m--[ [0m[34mMatch #[0m[33m322[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/lite/apis/calibrate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m173 | [0m[35m            num_experts = len(m.get_submodule(k.split('.{i}')[0]))[0m
[30;1m174 | [0m[35m            break[0m
[30;1m175 | [0m[35m[0m
[30;1m176 | [0m[35m    # update FC_FCS_MAP[0m
[30;1m177 | [0m[35m    updated_fc2fcs = dict()[0m
[30;1m178 | [0m[35m    for prev_fc, post_fc in fc2fcs.items():[0m
[30;1m179 | [0m[35m        if '{i}' in prev_fc:[0m

[31m--[ [0m[34mMatch #[0m[33m323[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/lite/apis/calibrate.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m223 | [0m[35m        dtype (str): Data type for loading model weights and calib infer.[0m
[30;1m224 | [0m[35m        batch_size (int): The batch size for running the calib samples.[0m
[30;1m225 | [0m[35m            Low GPU mem requires small batch_size. Large batch_size[0m
[30;1m226 | [0m[35m            reduces the calibration time while costs more VRAM.[0m
[30;1m227 | [0m[35m[0m
[30;1m228 | [0m[35m    Returns:[0m
[30;1m229 | [0m[35m        model (nn.Module): The loaded huggingface model.[0m

[31m--[ [0m[34mMatch #[0m[33m324[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/lite/apis/calibrate.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m129 | [0m[35m        mod_name = f'{prefix}.{name}' if prefix else name[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m        # If the child is either an instance of the layer type or has the[0m
[30;1m132 | [0m[35m        # head name, move it to CPU, otherwise move it to the specified device[0m
[30;1m133 | [0m[35m        if is_layer or is_head:[0m
[30;1m134 | [0m[35m            child.to('cpu')[0m
[30;1m135 | [0m[35m            print(f'Move {mod_name} to CPU.')[0m

[31m--[ [0m[34mMatch #[0m[33m325[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/lite/apis/calibrate.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m        # Check if the child matches the head name[0m
[30;1m125 | [0m[35m        is_head = name == head_name[0m
[30;1m126 | [0m[35m        # skip moving head layer to CPU when tie_word_embeddings is True[0m
[30;1m127 | [0m[35m        is_head = is_head and not getattr(model.config, 'tie_word_embeddings', False)[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m        mod_name = f'{prefix}.{name}' if prefix else name[0m

[31m--[ [0m[34mMatch #[0m[33m326[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/lite/apis/calibrate.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m121 | [0m[35m        # Check if the child contains the target module type[0m
[30;1m122 | [0m[35m        contain_layer = len(collect_target_modules(child, layer_type, [head_name]).keys()) > 0[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m        # Check if the child matches the head name[0m
[30;1m125 | [0m[35m        is_head = name == head_name[0m
[30;1m126 | [0m[35m        # skip moving head layer to CPU when tie_word_embeddings is True[0m
[30;1m127 | [0m[35m        is_head = is_head and not getattr(model.config, 'tie_word_embeddings', False)[0m

[31m--[ [0m[34mMatch #[0m[33m327[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/adapter/adapter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35mdef find_all_target(model: torch.nn.Module, target_name: str):[0m
[30;1m27 | [0m[35m    """find all targets."""[0m
[30;1m28 | [0m[35m    # find packed name[0m
[30;1m29 | [0m[35m    packed_name = target_name[0m
[30;1m30 | [0m[35m    pack_idx = None[0m
[30;1m31 | [0m[35m    packed_modules_mapping = getattr(model, 'packed_modules_mapping', dict())[0m

[31m--[ [0m[34mMatch #[0m[33m328[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/converter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m228 | [0m[35m    tm_cfg.model_config.model_name = model_name[0m
[30;1m229 | [0m[35m    tm_cfg.model_config.tp = engine_config.tp[0m
[30;1m230 | [0m[35m[0m
[30;1m231 | [0m[35m    output_model = OUTPUT_MODELS.get(output_model_name)(input_model=input_model,[0m
[30;1m232 | [0m[35m                                                        cfg=tm_cfg,[0m
[30;1m233 | [0m[35m                                                        model_cls=Transformer,[0m
[30;1m234 | [0m[35m                                                        out_dir=out_dir)[0m

[31m--[ [0m[34mMatch #[0m[33m329[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/converter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35m    input_model_name = get_input_model_registered_name(model_path, engine_config.model_format)[0m
[30;1m215 | [0m[35m    input_policy = get_input_policy(engine_config.model_format)[0m
[30;1m216 | [0m[35m    input_model = INPUT_MODELS.get(input_model_name)(model_path=model_path,[0m
[30;1m217 | [0m[35m                                                     tokenizer_path=model_path,[0m
[30;1m218 | [0m[35m                                                     input_policy=input_policy)[0m
[30;1m219 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m330[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/converter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m194 | [0m[35m                f'unsupported quant config: {quant_config}'[0m
[30;1m195 | [0m[35m        elif quant_method == 'gptq':[0m
[30;1m196 | [0m[35m            assert not quant_config.get('desc_act', False) and \[0m
[30;1m197 | [0m[35m                quant_config.get('sym', True), \[0m
[30;1m198 | [0m[35m                f'unsupported quant config: {quant_config}'[0m
[30;1m199 | [0m[35m        else:[0m
[30;1m200 | [0m[35m            assert 0, f'unsupported quant_config: {quant_config}'[0m

[31m--[ [0m[34mMatch #[0m[33m331[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/converter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m193 | [0m[35m            assert version == 'gemm', \[0m
[30;1m194 | [0m[35m                f'unsupported quant config: {quant_config}'[0m
[30;1m195 | [0m[35m        elif quant_method == 'gptq':[0m
[30;1m196 | [0m[35m            assert not quant_config.get('desc_act', False) and \[0m
[30;1m197 | [0m[35m                quant_config.get('sym', True), \[0m
[30;1m198 | [0m[35m                f'unsupported quant config: {quant_config}'[0m
[30;1m199 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m332[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/converter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m179 | [0m[35m    if quant_config:[0m
[30;1m180 | [0m[35m        quant_method = quant_config.get('quant_method')[0m
[30;1m181 | [0m[35m        _group_size = int(quant_config.get('group_size', 0))[0m
[30;1m182 | [0m[35m        version = quant_config.get('version')[0m
[30;1m183 | [0m[35m        assert engine_config.model_format is None or \[0m
[30;1m184 | [0m[35m            engine_config.model_format == quant_method, \[0m
[30;1m185 | [0m[35m            f'mismatched quant method: user input ' \[0m

[31m--[ [0m[34mMatch #[0m[33m333[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/converter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m178 | [0m[35m    quant_config = search_nested_config(cfg.to_dict(), 'quantization_config')[0m
[30;1m179 | [0m[35m    if quant_config:[0m
[30;1m180 | [0m[35m        quant_method = quant_config.get('quant_method')[0m
[30;1m181 | [0m[35m        _group_size = int(quant_config.get('group_size', 0))[0m
[30;1m182 | [0m[35m        version = quant_config.get('version')[0m
[30;1m183 | [0m[35m        assert engine_config.model_format is None or \[0m
[30;1m184 | [0m[35m            engine_config.model_format == quant_method, \[0m

[31m--[ [0m[34mMatch #[0m[33m334[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/converter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m177 | [0m[35m    _, cfg = get_model_arch(model_path)[0m
[30;1m178 | [0m[35m    quant_config = search_nested_config(cfg.to_dict(), 'quantization_config')[0m
[30;1m179 | [0m[35m    if quant_config:[0m
[30;1m180 | [0m[35m        quant_method = quant_config.get('quant_method')[0m
[30;1m181 | [0m[35m        _group_size = int(quant_config.get('group_size', 0))[0m
[30;1m182 | [0m[35m        version = quant_config.get('version')[0m
[30;1m183 | [0m[35m        assert engine_config.model_format is None or \[0m

[31m--[ [0m[34mMatch #[0m[33m335[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/converter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m104 | [0m[35m    else:[0m
[30;1m105 | [0m[35m        torch_dtype = getattr(model_config, 'torch_dtype', 'float16')[0m
[30;1m106 | [0m[35m        TORCH_DTYPE_MAP = {torch.bfloat16: 'bfloat16', torch.float16: 'float16'}[0m
[30;1m107 | [0m[35m        weight_type = TORCH_DTYPE_MAP.get(torch_dtype, 'float16')[0m
[30;1m108 | [0m[35m[0m
[30;1m109 | [0m[35m        # Qwen-1 didn't set torch_dtype. It used bf16 as default[0m
[30;1m110 | [0m[35m        if model_arch == 'QWenLMHeadModel':[0m

[31m--[ [0m[34mMatch #[0m[33m336[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/converter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m290 | [0m[35m        f'should be in {SUPPORTED_FORMATS}'[0m
[30;1m291 | [0m[35m[0m
[30;1m292 | [0m[35m    if not os.path.exists(model_path):[0m
[30;1m293 | [0m[35m        print(f"can't find model from local_path {model_path}, "[0m
[30;1m294 | [0m[35m              'try to download from huggingface')[0m
[30;1m295 | [0m[35m        model_path = get_model([0m
[30;1m296 | [0m[35m            model_path,[0m

[31m--[ [0m[34mMatch #[0m[33m337[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m135 | [0m[35m    @classmethod[0m
[30;1m136 | [0m[35m    def from_dict(cls, config: dict = {}):[0m
[30;1m137 | [0m[35m        """construct TurbomindModelConfig instance from config in a dict."""[0m
[30;1m138 | [0m[35m        _cfg = {field.name: config.get(field.name, {}) for field in fields(TurbomindModelConfig)}[0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35m        return TurbomindModelConfig(model_config=config_from_dict(ModelConfig, _cfg['model_config'])[0m
[30;1m141 | [0m[35m                                    attention_config=config_from_dict(AttentionConfig, _cfg['attenti[0m

[31m--[ [0m[34mMatch #[0m[33m338[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/config.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m37 | [0m[35m    hidden_units: int = None[0m
[30;1m38 | [0m[35m    vocab_size: int = None[0m
[30;1m39 | [0m[35m    # Turbomind used to assume token_embedding and lm_head has the same size[0m
[30;1m40 | [0m[35m    # at vocab dim, i.e. `vocab_size`[0m
[30;1m41 | [0m[35m    # But in molmo, embedding.shape is [vocab_size + 128, hidden_units][0m
[30;1m42 | [0m[35m    # while lm_head shape is [hidden_units, vocab_size].[0m
[30;1m43 | [0m[35m    # Therefore, we add a new attr "embedding_size" to represent the vocab dim[0m

[31m--[ [0m[34mMatch #[0m[33m339[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/lite/apis/smooth_quant.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m    assert q_dtype_info.bits == w_bits[0m
[30;1m39 | [0m[35m    if not osp.exists(model):[0m
[30;1m40 | [0m[35m        print(f'can\'t find model from local_path {model}, '[0m
[30;1m41 | [0m[35m              'try to download from remote')[0m
[30;1m42 | [0m[35m        from lmdeploy.utils import get_model[0m
[30;1m43 | [0m[35m        model = get_model(model, revision=revision, download_dir=download_dir)[0m

[31m--[ [0m[34mMatch #[0m[33m340[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/mp_executor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m563 | [0m[35m            method = command['method'][0m
[30;1m564 | [0m[35m            return_mask = command.get('return_mask', True)[0m
[30;1m565 | [0m[35m            args = command.get('args', list())[0m
[30;1m566 | [0m[35m            kwargs = command.get('kwargs', dict())[0m
[30;1m567 | [0m[35m            need_return = bool(proc_mask & return_mask)[0m
[30;1m568 | [0m[35m[0m
[30;1m569 | [0m[35m            func = getattr(worker, method, None)[0m

[31m--[ [0m[34mMatch #[0m[33m341[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/mp_executor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m562 | [0m[35m                continue[0m
[30;1m563 | [0m[35m            method = command['method'][0m
[30;1m564 | [0m[35m            return_mask = command.get('return_mask', True)[0m
[30;1m565 | [0m[35m            args = command.get('args', list())[0m
[30;1m566 | [0m[35m            kwargs = command.get('kwargs', dict())[0m
[30;1m567 | [0m[35m            need_return = bool(proc_mask & return_mask)[0m
[30;1m568 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m342[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/mp_executor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m561 | [0m[35m            if command is None:[0m
[30;1m562 | [0m[35m                continue[0m
[30;1m563 | [0m[35m            method = command['method'][0m
[30;1m564 | [0m[35m            return_mask = command.get('return_mask', True)[0m
[30;1m565 | [0m[35m            args = command.get('args', list())[0m
[30;1m566 | [0m[35m            kwargs = command.get('kwargs', dict())[0m
[30;1m567 | [0m[35m            need_return = bool(proc_mask & return_mask)[0m

[31m--[ [0m[34mMatch #[0m[33m343[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/mp_executor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m390 | [0m[35m[0m
[30;1m391 | [0m[35m    async def get_output_async(self):[0m
[30;1m392 | [0m[35m        """get output async."""[0m
[30;1m393 | [0m[35m        return await self.remote_outs.get()[0m
[30;1m394 | [0m[35m[0m
[30;1m395 | [0m[35m    def get_input_processor(self):[0m
[30;1m396 | [0m[35m        """get input processor."""[0m

[31m--[ [0m[34mMatch #[0m[33m344[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/mp_executor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m205 | [0m[35m[0m
[30;1m206 | [0m[35m[0m
[30;1m207 | [0m[35mclass MPExecutor(ExecutorBase):[0m
[30;1m208 | [0m[35m    """Single node multi device Executor powered by multiprocess."""[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m    @classmethod[0m
[30;1m211 | [0m[35m    def setup_master_addr(cls):[0m

[31m--[ [0m[34mMatch #[0m[33m345[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/mp_executor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m154 | [0m[35m    def _receive_step0(self):[0m
[30;1m155 | [0m[35m        """step0."""[0m
[30;1m156 | [0m[35m        with self.acquire_buf() as buf:[0m
[30;1m157 | [0m[35m            head = buf[:HEAD_SIZE][0m
[30;1m158 | [0m[35m            data_size, receiver_mask = struct.unpack('II', head)[0m
[30;1m159 | [0m[35m            is_receiver = ((receiver_mask & self.proc_mask) > 0)[0m
[30;1m160 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m346[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/mp_executor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m136 | [0m[35m        for _ in range(num_packs):[0m
[30;1m137 | [0m[35m            with self.acquire_buf() as buf:[0m
[30;1m138 | [0m[35m                pac_size = min(len(dumped_data), SHARED_BLOCK_SIZE)[0m
[30;1m139 | [0m[35m                packed_data = head + dumped_data[:pac_size][0m
[30;1m140 | [0m[35m                buf[:HEAD_SIZE + pac_size] = packed_data[0m
[30;1m141 | [0m[35m                dumped_data = dumped_data[pac_size:][0m
[30;1m142 | [0m[35m                yield buf[0m

[31m--[ [0m[34mMatch #[0m[33m347[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/mp_executor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m131 | [0m[35m        data_size = len(dumped_data)[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m        num_packs = get_num_packages(data_size)[0m
[30;1m134 | [0m[35m        head = struct.pack('II', data_size, receiver_mask)[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m        for _ in range(num_packs):[0m
[30;1m137 | [0m[35m            with self.acquire_buf() as buf:[0m

[31m--[ [0m[34mMatch #[0m[33m348[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/loader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m168 | [0m[35m        if glob(osp.join(model_path, p)):[0m
[30;1m169 | [0m[35m            return PytorchLoader(*args, file_pattern=p)[0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35m    raise RuntimeError(f'Failed to find valid loader for {model_path}')[0m

[31m--[ [0m[34mMatch #[0m[33m349[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/uni_executor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mclass UniExecutor(ExecutorBase):[0m
[30;1m16 | [0m[35m    """Single node single device Executor."""[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m    def __init__(self,[0m
[30;1m19 | [0m[35m                 model_path: str,[0m

[31m--[ [0m[34mMatch #[0m[33m350[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/lite/utils/global_avail.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m            Dict[Union[str, nn.Module], GlobalAvailMixin]: All instances in[0m
[30;1m68 | [0m[35m                the group.[0m
[30;1m69 | [0m[35m        """[0m
[30;1m70 | [0m[35m        return cls._instances.get(group, {})[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m    @classmethod[0m
[30;1m73 | [0m[35m    def instances(cls) -> Dict[str, Dict[Union[str, nn.Module], 'GlobalAvailMixin']]:[0m

[31m--[ [0m[34mMatch #[0m[33m351[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/lite/utils/global_avail.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m            Union[None, GlobalAvailMixin]: The found instance, or None if[0m
[30;1m55 | [0m[35m                it does not exist.[0m
[30;1m56 | [0m[35m        """[0m
[30;1m57 | [0m[35m        return cls._instances.get(group, {}).get(key)[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m    @classmethod[0m
[30;1m60 | [0m[35m    def find_group(cls, group: str) -> Dict[Union[str, nn.Module], 'GlobalAvailMixin']:[0m

[31m--[ [0m[34mMatch #[0m[33m352[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/lite/utils/global_avail.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m            Union[None, GlobalAvailMixin]: The found instance, or None if[0m
[30;1m55 | [0m[35m                it does not exist.[0m
[30;1m56 | [0m[35m        """[0m
[30;1m57 | [0m[35m        return cls._instances.get(group, {}).get(key)[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m    @classmethod[0m
[30;1m60 | [0m[35m    def find_group(cls, group: str) -> Dict[Union[str, nn.Module], 'GlobalAvailMixin']:[0m

[31m--[ [0m[34mMatch #[0m[33m353[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/lite/apis/auto_awq.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m79 | [0m[35m    """[0m
[30;1m80 | [0m[35m    try_import_deeplink(device)[0m
[30;1m81 | [0m[35m    if not osp.exists(model):[0m
[30;1m82 | [0m[35m        print(f'can\'t find model from local_path {model}, '[0m
[30;1m83 | [0m[35m              'try to download from remote')[0m
[30;1m84 | [0m[35m        from lmdeploy.utils import get_model[0m
[30;1m85 | [0m[35m        model = get_model(model, revision=revision, download_dir=download_dir)[0m

[31m--[ [0m[34mMatch #[0m[33m354[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/lite/apis/auto_awq.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m62 | [0m[35m        calib_samples (int): The number of samples for calibration.[0m
[30;1m63 | [0m[35m        batch_size (int): The batch size for running the calib samples.[0m
[30;1m64 | [0m[35m            Low GPU mem requires small batch_size. Large batch_size[0m
[30;1m65 | [0m[35m            reduces the calibration time while costs more VRAM.[0m
[30;1m66 | [0m[35m        calib_seqlen (int): The sequence length for calibration.[0m
[30;1m67 | [0m[35m        w_bits (int): Bit number for weight quantization.[0m
[30;1m68 | [0m[35m        w_sym (bool): Whether to do symmetric quantization.[0m

[31m--[ [0m[34mMatch #[0m[33m355[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/target_model/base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m88 | [0m[35m    def single_to_list(self, config: dict, keys):[0m
[30;1m89 | [0m[35m        num_layer = int(config['num_layer'])[0m
[30;1m90 | [0m[35m        for k in keys:[0m
[30;1m91 | [0m[35m            v = config.get(k, None)[0m
[30;1m92 | [0m[35m            if v is not None and not isinstance(v, Sequence):[0m
[30;1m93 | [0m[35m                config[k] = [v] * num_layer[0m
[30;1m94 | [0m[35m        return config[0m

[31m--[ [0m[34mMatch #[0m[33m356[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/target_model/base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m58 | [0m[35m        # get `model_info` at first, which will be updated to `self.model_config` and `self.attentio[0m
[30;1m59 | [0m[35m        self.input_model_info = self.input_model.model_info()[0m
[30;1m60 | [0m[35m        self.input_model_info = self.single_to_list(self.input_model_info, keys=['inter_size', 'expe[0m
[30;1m61 | [0m[35m        self.permute_qk = self.input_model_info.get('permute_qk', True)[0m
[30;1m62 | [0m[35m        self.update_model_config()[0m
[30;1m63 | [0m[35m        for i, v in enumerate(self.model_config.inter_size):[0m
[30;1m64 | [0m[35m            self.model_config.inter_size[i] = _pad_inter_size(v, self.model_config.group_size, self.[0m

[31m--[ [0m[34mMatch #[0m[33m357[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/target_model/base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m    _WEIGHT_DTYPE_MAP = dict(int4=torch.float16, float16=torch.float16, float32=torch.float16, bfloa[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    return _WEIGHT_DTYPE_MAP.get(weight_type, default)[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35mdef _pad_inter_size(inter_size: int, group_size: int, tp: int):[0m

[31m--[ [0m[34mMatch #[0m[33m358[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/target_model/base.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m55 | [0m[35m        self.to_file = True if out_dir else False[0m
[30;1m56 | [0m[35m        self.tm_params = {}[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m        # get `model_info` at first, which will be updated to `self.model_config` and `self.attentio[0m
[30;1m59 | [0m[35m        self.input_model_info = self.input_model.model_info()[0m
[30;1m60 | [0m[35m        self.input_model_info = self.single_to_list(self.input_model_info, keys=['inter_size', 'expe[0m
[30;1m61 | [0m[35m        self.permute_qk = self.input_model_info.get('permute_qk', True)[0m

[31m--[ [0m[34mMatch #[0m[33m359[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/lite/apis/gptq.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m27 | [0m[35m        calib_samples (int): The number of samples for calibration.[0m
[30;1m28 | [0m[35m        batch_size (int): The batch size for running the calib samples.[0m
[30;1m29 | [0m[35m            Low GPU mem requires small batch_size. Large batch_size[0m
[30;1m30 | [0m[35m            reduces the calibration time while costs more VRAM.[0m
[30;1m31 | [0m[35m        calib_seqlen (int): The sequence length for calibration.[0m
[30;1m32 | [0m[35m        w_bits (int): Bit number for weight quantization.[0m
[30;1m33 | [0m[35m        w_group_size (int): Group size for weight quantization statistics.[0m

[31m--[ [0m[34mMatch #[0m[33m360[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/lite/utils/calib_dataloader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m211 | [0m[35m        i = random.randint(0, trainenc.input_ids.shape[1] - seqlen)[0m
[30;1m212 | [0m[35m        j = i + seqlen[0m
[30;1m213 | [0m[35m        inp = trainenc.input_ids[:, i:j][0m
[30;1m214 | [0m[35m        tar = inp.clone()[0m
[30;1m215 | [0m[35m        tar[:, :-1] = -100[0m
[30;1m216 | [0m[35m        trainloader.append((inp, tar))[0m
[30;1m217 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m361[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/lite/utils/calib_dataloader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m168 | [0m[35m        i = random.randint(0, trainenc.input_ids.shape[1] - seqlen)[0m
[30;1m169 | [0m[35m        j = i + seqlen[0m
[30;1m170 | [0m[35m        inp = trainenc.input_ids[:, i:j][0m
[30;1m171 | [0m[35m        tar = inp.clone()[0m
[30;1m172 | [0m[35m        tar[:, :-1] = -100[0m
[30;1m173 | [0m[35m        trainloader.append((inp, tar))[0m
[30;1m174 | [0m[35m    return trainloader, testenc[0m

[31m--[ [0m[34mMatch #[0m[33m362[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/lite/utils/calib_dataloader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m113 | [0m[35m        i = random.randint(0, trainenc.input_ids.shape[1] - seqlen)[0m
[30;1m114 | [0m[35m        j = i + seqlen[0m
[30;1m115 | [0m[35m        inp = trainenc.input_ids[:, i:j][0m
[30;1m116 | [0m[35m        tar = inp.clone()[0m
[30;1m117 | [0m[35m        tar[:, :-1] = -100[0m
[30;1m118 | [0m[35m        trainloader.append((inp, tar))[0m
[30;1m119 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m363[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/lite/utils/calib_dataloader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m68 | [0m[35m        i = random.randint(0, trainenc.input_ids.shape[1] - seqlen)[0m
[30;1m69 | [0m[35m        j = i + seqlen[0m
[30;1m70 | [0m[35m        inp = trainenc.input_ids[:, i:j][0m
[30;1m71 | [0m[35m        tar = inp.clone()[0m
[30;1m72 | [0m[35m        tar[:, :-1] = -100[0m
[30;1m73 | [0m[35m        trainloader.append((inp, tar))[0m
[30;1m74 | [0m[35m    return trainloader, testenc[0m

[31m--[ [0m[34mMatch #[0m[33m364[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/lite/utils/calib_dataloader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m        i = random.randint(0, trainenc.input_ids.shape[1] - seqlen)[0m
[30;1m36 | [0m[35m        j = i + seqlen[0m
[30;1m37 | [0m[35m        inp = trainenc.input_ids[:, i:j][0m
[30;1m38 | [0m[35m        tar = inp.clone()[0m
[30;1m39 | [0m[35m        tar[:, :-1] = -100[0m
[30;1m40 | [0m[35m        trainloader.append((inp, tar))[0m
[30;1m41 | [0m[35m    return trainloader, testenc[0m

[31m--[ [0m[34mMatch #[0m[33m365[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/lite/utils/memory_efficient.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m102 | [0m[35m                if kwargs[KV_CACHE_SIGNATURE]:[0m
[30;1m103 | [0m[35m                    kwargs[KV_CACHE_SIGNATURE] = kwargs[KV_CACHE_SIGNATURE].to(device)[0m
[30;1m104 | [0m[35m            else:[0m
[30;1m105 | [0m[35m                raise ValueError(f'No kv cache input found at index {idx}')[0m
[30;1m106 | [0m[35m        else:[0m
[30;1m107 | [0m[35m            # kv cache in args[0m
[30;1m108 | [0m[35m            args = list(args)[0m

[31m--[ [0m[34mMatch #[0m[33m366[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/cli/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m203 | [0m[35m        if gpu_topo is not None:[0m
[30;1m204 | [0m[35m            env_info['NVIDIA Topology'] = gpu_topo[0m
[30;1m205 | [0m[35m[0m
[30;1m206 | [0m[35m        # print env info[0m
[30;1m207 | [0m[35m        for k, v in env_info.items():[0m
[30;1m208 | [0m[35m            print(f'{k}: {v}')[0m
[30;1m209 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m367[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/cli/cli.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m131 | [0m[35m        parser.add_argument('--dump-file',[0m
[30;1m132 | [0m[35m                            type=str,[0m
[30;1m133 | [0m[35m                            default=None,[0m
[30;1m134 | [0m[35m                            help='The file path to save env info. Only '[0m
[30;1m135 | [0m[35m                            'support file format in `json`, `yml`,'[0m
[30;1m136 | [0m[35m                            ' `pkl`')[0m
[30;1m137 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m368[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/cli/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m320 | [0m[35m            type=int,[0m
[30;1m321 | [0m[35m            default=1,[0m
[30;1m322 | [0m[35m            help=\[0m
[30;1m323 | [0m[35m            'The batch size for running the calib samples. Low GPU mem requires small batch_size. La[0m
[30;1m324 | [0m[35m        )[0m
[30;1m325 | [0m[35m[0m
[30;1m326 | [0m[35m    @staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m369[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/proxy/constants.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35merr_msg = {[0m
[30;1m37 | [0m[35m    ErrorCodes.MODEL_NOT_FOUND: 'The request model name does not exist in the model list.',[0m
[30;1m38 | [0m[35m    ErrorCodes.SERVICE_UNAVAILABLE: 'The service is unavailable now. May retry later.',[0m
[30;1m39 | [0m[35m    ErrorCodes.API_TIMEOUT: 'Failed to get response after a period of time'[0m
[30;1m40 | [0m[35m}[0m

[31m--[ [0m[34mMatch #[0m[33m370[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/lite/quantization/awq.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m150 | [0m[35m    device, dtype = fcs[0].weight.device, fcs[0].weight.dtype[0m
[30;1m151 | [0m[35m[0m
[30;1m152 | [0m[35m    # If zeros exist within the weight of the layer norm, it becomes[0m
[30;1m153 | [0m[35m    # unnecessary to perform smooth quantization at the positions where[0m
[30;1m154 | [0m[35m    # these zeros occur.[0m
[30;1m155 | [0m[35m    zero_positions = (ln.weight == 0).nonzero(as_tuple=True)[0][0m
[30;1m156 | [0m[35m    nonzero_positions = (ln.weight != 0).nonzero(as_tuple=True)[0][0m

[31m--[ [0m[34mMatch #[0m[33m371[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/lite/quantization/calibration.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m304 | [0m[35m        return best_ratio[0m
[30;1m305 | [0m[35m[0m
[30;1m306 | [0m[35m    def _auto_get_scale(layers, inp, module2inspect=None, kwargs={}):[0m
[30;1m307 | [0m[35m        # module2inspect: if given, we will check the output diff of[0m
[30;1m308 | [0m[35m        #  this module instead of layers[0m
[30;1m309 | [0m[35m        if module2inspect is None:[0m
[30;1m310 | [0m[35m            assert len(layers) == 1[0m

[31m--[ [0m[34mMatch #[0m[33m372[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/lite/quantization/calibration.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m254 | [0m[35m    if 'use_cache' in module_kwargs:[0m
[30;1m255 | [0m[35m        module_kwargs.pop('use_cache')[0m
[30;1m256 | [0m[35m[0m
[30;1m257 | [0m[35m    # find the best scale ratio[0m
[30;1m258 | [0m[35m    def _search_module_scale(block, linears2scale: list, x, kwargs={}):[0m
[30;1m259 | [0m[35m        x = x.to(next(block.parameters()).device)[0m
[30;1m260 | [0m[35m        with torch.no_grad():[0m

[31m--[ [0m[34mMatch #[0m[33m373[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/lite/quantization/calibration.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35m            norm_type (Union[str, type]): Norm type used in the model.[0m
[30;1m45 | [0m[35m            batch_size (int): The batch size for running the calib samples.[0m
[30;1m46 | [0m[35m                Low GPU mem requires small batch_size. Large batch_size[0m
[30;1m47 | [0m[35m                reduces the calibration time while costs more VRAM.[0m
[30;1m48 | [0m[35m            device (str, optional): Device where the model should run.[0m
[30;1m49 | [0m[35m                Defaults to 'cuda'.[0m
[30;1m50 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m374[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/cli/serve.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m209 | [0m[35m                                                   description=SubCliServe.proxy.__doc__,[0m
[30;1m210 | [0m[35m                                                   help=SubCliServe.proxy.__doc__)[0m
[30;1m211 | [0m[35m        parser.set_defaults(run=SubCliServe.proxy)[0m
[30;1m212 | [0m[35m        parser.add_argument('--server-name', type=str, default='0.0.0.0', help='Host ip for proxy se[0m
[30;1m213 | [0m[35m        parser.add_argument('--server-port', type=int, default=8000, help='Server port of the proxy'[0m
[30;1m214 | [0m[35m        parser.add_argument('--strategy',[0m
[30;1m215 | [0m[35m                            type=str,[0m

[31m--[ [0m[34mMatch #[0m[33m375[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/cli/serve.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m98 | [0m[35m                            ' of a model hosted inside a model repo on huggingface.co,'[0m
[30;1m99 | [0m[35m                            ' such as "internlm/internlm-chat-7b", "qwen/qwen-7b-chat "'[0m
[30;1m100 | [0m[35m                            ', "baichuan-inc/baichuan2-7b-chat" and so on')[0m
[30;1m101 | [0m[35m        parser.add_argument('--server-name', type=str, default='0.0.0.0', help='Host ip for serving'[0m
[30;1m102 | [0m[35m        parser.add_argument('--server-port', type=int, default=23333, help='Server port')[0m
[30;1m103 | [0m[35m        parser.add_argument('--allow-origins',[0m
[30;1m104 | [0m[35m                            nargs='+',[0m

[31m--[ [0m[34mMatch #[0m[33m376[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/cli/serve.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35m                            help='The path of the deployed model or the tritonserver url or '[0m
[30;1m31 | [0m[35m                            'restful api url. for example: - ./workspace - 0.0.0.0:23333'[0m
[30;1m32 | [0m[35m                            ' - http://0.0.0.0:23333')[0m
[30;1m33 | [0m[35m        parser.add_argument('--server-name', type=str, default='0.0.0.0', help='The ip address of gr[0m
[30;1m34 | [0m[35m        parser.add_argument('--server-port', type=int, default=6006, help='The port of gradio server[0m
[30;1m35 | [0m[35m        parser.add_argument('--share',[0m
[30;1m36 | [0m[35m                            action='store_true',[0m

[31m--[ [0m[34mMatch #[0m[33m377[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/tool_parser/internlm2_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m168 | [0m[35m            action = action[action.find('{'):][0m
[30;1m169 | [0m[35m            action_dict = json.loads(action)[0m
[30;1m170 | [0m[35m            name, parameters = action_dict['name'], json.dumps(action_dict.get('parameters',[0m
[30;1m171 | [0m[35m                                                                               action_dict.get('argu[0m
[30;1m172 | [0m[35m                                                               ensure_ascii=False)[0m
[30;1m173 | [0m[35m[0m
[30;1m174 | [0m[35m            if not tools or name not in [t.function.name for t in tools]:[0m

[31m--[ [0m[34mMatch #[0m[33m378[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/tool_parser/internlm2_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m167 | [0m[35m            action = action.split('<|action_end|>'.strip())[0][0m
[30;1m168 | [0m[35m            action = action[action.find('{'):][0m
[30;1m169 | [0m[35m            action_dict = json.loads(action)[0m
[30;1m170 | [0m[35m            name, parameters = action_dict['name'], json.dumps(action_dict.get('parameters',[0m
[30;1m171 | [0m[35m                                                                               action_dict.get('argu[0m
[30;1m172 | [0m[35m                                                               ensure_ascii=False)[0m
[30;1m173 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m379[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/tool_parser/internlm2_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m92 | [0m[35m            # if the current tool name hasn't been sent, send if available[0m
[30;1m93 | [0m[35m            # - otherwise send nothing[0m
[30;1m94 | [0m[35m            if not self.current_tool_name_sent:[0m
[30;1m95 | [0m[35m                function_name = tool_call_arr.get('name')[0m
[30;1m96 | [0m[35m                if function_name:[0m
[30;1m97 | [0m[35m                    self.current_tool_id = self.current_tool_id + 1[0m
[30;1m98 | [0m[35m                    delta = DeltaMessage(tool_calls=[[0m

[31m--[ [0m[34mMatch #[0m[33m380[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/tool_parser/internlm2_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m36 | [0m[35m        if 'parameters' in obj:[0m
[30;1m37 | [0m[35m            return obj.get('parameters')[0m
[30;1m38 | [0m[35m        elif 'arguments' in obj:[0m
[30;1m39 | [0m[35m            return obj.get('arguments')[0m
[30;1m40 | [0m[35m        return None[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m    def extract_tool_calls_streaming([0m

[31m--[ [0m[34mMatch #[0m[33m381[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/tool_parser/internlm2_parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m    def get_argments(self, obj):[0m
[30;1m36 | [0m[35m        if 'parameters' in obj:[0m
[30;1m37 | [0m[35m            return obj.get('parameters')[0m
[30;1m38 | [0m[35m        elif 'arguments' in obj:[0m
[30;1m39 | [0m[35m            return obj.get('arguments')[0m
[30;1m40 | [0m[35m        return None[0m

[31m--[ [0m[34mMatch #[0m[33m382[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/tool_parser/internlm2_parser.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m74 | [0m[35m        # bit mask flags for partial JSON parsing. If the name hasn't been[0m
[30;1m75 | [0m[35m        # sent yet, don't allow sending[0m
[30;1m76 | [0m[35m        # an incomplete string since OpenAI only ever (as far as I have[0m
[30;1m77 | [0m[35m        # seen) allows sending the entire tool/ function name at once.[0m
[30;1m78 | [0m[35m        flags = Allow.ALL if self.current_tool_name_sent \[0m
[30;1m79 | [0m[35m            else Allow.ALL & ~Allow.STR[0m
[30;1m80 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m383[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/openai/tool_parser/internlm2_parser.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m119 | [0m[35m                    logger.error('INVARIANT - impossible to have arguments reset '[0m
[30;1m120 | [0m[35m                                 'mid-arguments')[0m
[30;1m121 | [0m[35m                    delta = None[0m
[30;1m122 | [0m[35m                # first time to get parameters[0m
[30;1m123 | [0m[35m                elif cur_arguments and not prev_arguments:[0m
[30;1m124 | [0m[35m                    cur_arguments_json = json.dumps(cur_arguments, ensure_ascii=False)[0m
[30;1m125 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m384[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/tools/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m    def toc_cpu(self):[0m
[30;1m18 | [0m[35m        assert self.timer_type == 'cpu'[0m
[30;1m19 | [0m[35m        import time[0m
[30;1m20 | [0m[35m        self._end = time.perf_counter()[0m
[30;1m21 | [0m[35m        self.duration = (self._end - self._start) * 1000[0m
[30;1m22 | [0m[35m        return self[0m

[31m--[ [0m[34mMatch #[0m[33m385[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/tools/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35m    def tic_cpu(self):[0m
[30;1m13 | [0m[35m        self.timer_type = 'cpu'[0m
[30;1m14 | [0m[35m        import time[0m
[30;1m15 | [0m[35m        self._start = time.perf_counter()[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m    def toc_cpu(self):[0m

[31m--[ [0m[34mMatch #[0m[33m386[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/async_engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m573 | [0m[35m        """A context manager to make sure server's safe running."""[0m
[30;1m574 | [0m[35m        assert session_id not in self.id2inst[0m
[30;1m575 | [0m[35m        free_insts = self._get_free_insts()[0m
[30;1m576 | [0m[35m        inst = await free_insts.get()[0m
[30;1m577 | [0m[35m        inst._active = asyncio.Event()[0m
[30;1m578 | [0m[35m        self.id2inst[session_id] = inst[0m
[30;1m579 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m387[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/async_engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m388 | [0m[35m        if inst:[0m
[30;1m389 | [0m[35m            await inst._active.wait()[0m
[30;1m390 | [0m[35m            assert session_id not in self.id2inst[0m
[30;1m391 | [0m[35m        inst = await self._get_free_insts().get()[0m
[30;1m392 | [0m[35m        try:[0m
[30;1m393 | [0m[35m            await inst.async_end(session_id)[0m
[30;1m394 | [0m[35m            self.id2step[session_id] = 0[0m

[31m--[ [0m[34mMatch #[0m[33m388[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/async_engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m384 | [0m[35m    async def end_session(self, session_id: int):[0m
[30;1m385 | [0m[35m        """For ending a session that is not running."""[0m
[30;1m386 | [0m[35m        logger.info(f'end session {session_id}')[0m
[30;1m387 | [0m[35m        inst = self.id2inst.get(session_id)[0m
[30;1m388 | [0m[35m        if inst:[0m
[30;1m389 | [0m[35m            await inst._active.wait()[0m
[30;1m390 | [0m[35m            assert session_id not in self.id2inst[0m

[31m--[ [0m[34mMatch #[0m[33m389[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/async_engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m376 | [0m[35m    async def stop_session(self, session_id: int):[0m
[30;1m377 | [0m[35m        """Stop a session by a session_id."""[0m
[30;1m378 | [0m[35m        logger.info(f'stop session {session_id}')[0m
[30;1m379 | [0m[35m        generator = self.id2inst.get(session_id)[0m
[30;1m380 | [0m[35m        if generator:[0m
[30;1m381 | [0m[35m            await generator.async_cancel(session_id)[0m
[30;1m382 | [0m[35m        # else it's not running at all[0m

[31m--[ [0m[34mMatch #[0m[33m390[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/async_engine.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m794 | [0m[35m                                 generate_token_len=0,[0m
[30;1m795 | [0m[35m                                 finish_reason='error',[0m
[30;1m796 | [0m[35m                                 token_ids=[])[0m
[30;1m797 | [0m[35m            # update step[0m
[30;1m798 | [0m[35m            if sequence_end:[0m
[30;1m799 | [0m[35m                self.id2step[session_id] = 0[0m
[30;1m800 | [0m[35m                if self.backend == 'pytorch':[0m

[31m--[ [0m[34mMatch #[0m[33m391[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/async_engine.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m776 | [0m[35m                if not is_error(outputs.status):[0m
[30;1m777 | [0m[35m                    finish_reason = 'length' \[0m
[30;1m778 | [0m[35m                        if gen_len >= gen_config.max_new_tokens else 'stop'[0m
[30;1m779 | [0m[35m                    # utf-8 char at the end means it's a potential unfinished[0m
[30;1m780 | [0m[35m                    # byte sequence[0m
[30;1m781 | [0m[35m                    if not response.endswith('�'):[0m
[30;1m782 | [0m[35m                        # avoid returning the last response twice[0m

[31m--[ [0m[34mMatch #[0m[33m392[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/async_engine.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m379 | [0m[35m        generator = self.id2inst.get(session_id)[0m
[30;1m380 | [0m[35m        if generator:[0m
[30;1m381 | [0m[35m            await generator.async_cancel(session_id)[0m
[30;1m382 | [0m[35m        # else it's not running at all[0m
[30;1m383 | [0m[35m[0m
[30;1m384 | [0m[35m    async def end_session(self, session_id: int):[0m
[30;1m385 | [0m[35m        """For ending a session that is not running."""[0m

[31m--[ [0m[34mMatch #[0m[33m393[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m94 | [0m[35m            input_ids = [input_ids][0m
[30;1m95 | [0m[35m        assert all(len(_) > 1 for _ in input_ids)[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m        # TODO: a better way to determine `max_input_len`, at most allocate[0m
[30;1m98 | [0m[35m        # 2G mem for logits with shape [bs, max_input_len, vocab_size][0m
[30;1m99 | [0m[35m        vocab_size = self.hf_tm_cfg.vocab_size[0m
[30;1m100 | [0m[35m        max_input_len = 2 * 1024**3 // (vocab_size * 4)[0m

[31m--[ [0m[34mMatch #[0m[33m394[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m57 | [0m[35m                input_len = len(input_ids[i])[0m
[30;1m58 | [0m[35m                # TODO(lvhan): Fix the ugly code later on[0m
[30;1m59 | [0m[35m                max_new_tokens = 1 if self.backend == 'turbomind' else 0[0m
[30;1m60 | [0m[35m                # The reason to set `top_k=1` is that pt engine crashes at top_k sampling stage[0m
[30;1m61 | [0m[35m                # when perform inference on a reward model.[0m
[30;1m62 | [0m[35m                gen_config = GenerationConfig(max_new_tokens=max_new_tokens, output_logits='all', to[0m
[30;1m63 | [0m[35m                async with self.safe_run(inst,[0m

[31m--[ [0m[34mMatch #[0m[33m395[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/phi3_v.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m323 | [0m[35m        # vision inputs[0m
[30;1m324 | [0m[35m        pixel_values = None[0m
[30;1m325 | [0m[35m        if context.input_multimodals is not None:[0m
[30;1m326 | [0m[35m            input_mms = [input_mm.get('image', []) for input_mm in context.input_multimodals][0m
[30;1m327 | [0m[35m            # flatten batch[0m
[30;1m328 | [0m[35m            input_mms = [data for im_data in input_mms for data in im_data][0m
[30;1m329 | [0m[35m            if len(input_mms) > 0:[0m

[31m--[ [0m[34mMatch #[0m[33m396[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/phi3_v.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m        if isinstance(config.img_processor, dict):[0m
[30;1m102 | [0m[35m            self.layer_idx = config.img_processor.get('layer_idx', -2)[0m
[30;1m103 | [0m[35m            self.type_feature = config.img_processor.get('type_feature', 'patch')[0m
[30;1m104 | [0m[35m        else:[0m
[30;1m105 | [0m[35m            self.layer_idx = -2[0m
[30;1m106 | [0m[35m            self.type_feature = 'patch'[0m

[31m--[ [0m[34mMatch #[0m[33m397[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/phi3_v.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m99 | [0m[35m        self.img_features = None[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m        if isinstance(config.img_processor, dict):[0m
[30;1m102 | [0m[35m            self.layer_idx = config.img_processor.get('layer_idx', -2)[0m
[30;1m103 | [0m[35m            self.type_feature = config.img_processor.get('type_feature', 'patch')[0m
[30;1m104 | [0m[35m        else:[0m
[30;1m105 | [0m[35m            self.layer_idx = -2[0m

[31m--[ [0m[34mMatch #[0m[33m398[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/phi3_v.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m75 | [0m[35m            self.glb_GN = nn.Parameter(torch.empty([1, 1, self.image_dim_out * 4], dtype=dtype, devi[0m
[30;1m76 | [0m[35m            self.sub_GN = nn.Parameter(torch.empty([1, 1, 1, self.image_dim_out * 4], dtype=dtype, d[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m        projection_cls = kwargs.get('projection_cls', 'linear')[0m
[30;1m79 | [0m[35m        if projection_cls == 'linear':[0m
[30;1m80 | [0m[35m            self.img_projection = nn.Linear(image_dim_out, hidden_size, dtype=dtype, device=device)[0m
[30;1m81 | [0m[35m        elif projection_cls == 'mlp' and self.use_hd_transform:[0m

[31m--[ [0m[34mMatch #[0m[33m399[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/phi3_v.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m        self.use_hd_transform = kwargs.get('use_hd_transform', False)[0m
[30;1m66 | [0m[35m        self.with_learnable_separator = kwargs.get('with_learnable_separator', False)[0m
[30;1m67 | [0m[35m        self.hd_transform_order = kwargs.get('hd_transform_order', 'glb_sub')[0m
[30;1m68 | [0m[35m        # with_hd_transform and with_learnable_separator should have same value[0m
[30;1m69 | [0m[35m        assert (self.use_hd_transform == self.with_learnable_separator), ([0m
[30;1m70 | [0m[35m            'use_hd_transform and with_learnable_separator '[0m

[31m--[ [0m[34mMatch #[0m[33m400[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/phi3_v.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m63 | [0m[35m        self.img_sizes = None[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m        self.use_hd_transform = kwargs.get('use_hd_transform', False)[0m
[30;1m66 | [0m[35m        self.with_learnable_separator = kwargs.get('with_learnable_separator', False)[0m
[30;1m67 | [0m[35m        self.hd_transform_order = kwargs.get('hd_transform_order', 'glb_sub')[0m
[30;1m68 | [0m[35m        # with_hd_transform and with_learnable_separator should have same value[0m
[30;1m69 | [0m[35m        assert (self.use_hd_transform == self.with_learnable_separator), ([0m

[31m--[ [0m[34mMatch #[0m[33m401[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/phi3_v.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m        self.image_dim_out = image_dim_out[0m
[30;1m63 | [0m[35m        self.img_sizes = None[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m        self.use_hd_transform = kwargs.get('use_hd_transform', False)[0m
[30;1m66 | [0m[35m        self.with_learnable_separator = kwargs.get('with_learnable_separator', False)[0m
[30;1m67 | [0m[35m        self.hd_transform_order = kwargs.get('hd_transform_order', 'glb_sub')[0m
[30;1m68 | [0m[35m        # with_hd_transform and with_learnable_separator should have same value[0m

[31m--[ [0m[34mMatch #[0m[33m402[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/phi3_v.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m        self.wte = wte[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m        if (isinstance(config.img_processor, dict) and config.img_processor.get('name', None) == 'cl[0m
[30;1m51 | [0m[35m            assert 'model_name' in config.img_processor, ('model_name must be provided for CLIPVisio[0m
[30;1m52 | [0m[35m            assert 'image_dim_out' in config.img_processor, ('image_dim_out must be provided for CLI[0m
[30;1m53 | [0m[35m            assert 'num_img_tokens' in config.img_processor, ('num_img_tokens must be provided for C[0m

[31m--[ [0m[34mMatch #[0m[33m403[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/phi3_v.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m136 | [0m[35m        img_features = self.get_img_features(pixel_values.flatten(0, 1)).reshape(num_images, num_cro[0m
[30;1m137 | [0m[35m                                                                                 self.image_dim_out)[0m
[30;1m138 | [0m[35m        image_features_proj = self.hd_feature_transform(img_features, image_sizes)[0m
[30;1m139 | [0m[35m        # update image feature to inputs_embeds[0m
[30;1m140 | [0m[35m        inputs_embeds.masked_scatter_(image_mask[..., None], image_features_proj)[0m
[30;1m141 | [0m[35m        return inputs_embeds[0m
[30;1m142 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m404[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/messages.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m609 | [0m[35m    def set_step(self, step: int):[0m
[30;1m610 | [0m[35m        """set step."""[0m
[30;1m611 | [0m[35m        num_all_ids = self.num_all_ids[0m
[30;1m612 | [0m[35m        # update step for vlm[0m
[30;1m613 | [0m[35m        if len(self.history_embeddings) > 0:[0m
[30;1m614 | [0m[35m            new_step, self._num_history_images, self._num_images = \[0m
[30;1m615 | [0m[35m                self.history_embeddings.get_step(step)[0m

[31m--[ [0m[34mMatch #[0m[33m405[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/messages.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m580 | [0m[35m            self._num_images = len(new_embeddings)[0m
[30;1m581 | [0m[35m            self.history_embeddings.append(new_embeddings)[0m
[30;1m582 | [0m[35m[0m
[30;1m583 | [0m[35m        # update multimodals[0m
[30;1m584 | [0m[35m        if multimodals is not None:[0m
[30;1m585 | [0m[35m            multimodals = HistoryMultiModals.update_multimodals(multimodals, self.num_all_ids)[0m
[30;1m586 | [0m[35m            self.history_multimodals.add_inputs(multimodals)[0m

[31m--[ [0m[34mMatch #[0m[33m406[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/messages.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m572 | [0m[35m        old_num_history_ids = self._num_history_ids[0m
[30;1m573 | [0m[35m[0m
[30;1m574 | [0m[35m        self._num_history_ids += self._num_token_ids[0m
[30;1m575 | [0m[35m        # update history image nums[0m
[30;1m576 | [0m[35m        self._num_history_images += self._num_images[0m
[30;1m577 | [0m[35m        self._num_images = 0[0m
[30;1m578 | [0m[35m        if embeddings is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m407[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/messages.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# Copyright (c) OpenMMLab. All rights reserved.[0m
[30;1m2 | [0m[35mimport enum[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mfrom dataclasses import dataclass, field[0m
[30;1m5 | [0m[35mfrom typing import Any, Dict, List, Optional[0m
[30;1m6 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m408[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/dbrx.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m152 | [0m[35m                 device: torch.device = None):[0m
[30;1m153 | [0m[35m        super().__init__()[0m
[30;1m154 | [0m[35m[0m
[30;1m155 | [0m[35m        act_fn_name = ffn_act_fn.get('name', None)[0m
[30;1m156 | [0m[35m        assert act_fn_name == 'silu'[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m        self.mlp = build_fused_moe([0m

[31m--[ [0m[34mMatch #[0m[33m409[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy-0.7.2.post1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m281 | [0m[35m[0m
[30;1m282 | [0m[35m```shell[0m
[30;1m283 | [0m[35mconda create -n lmdeploy python=3.8 -y[0m
[30;1m284 | [0m[35mconda activate lmdeploy[0m
[30;1m285 | [0m[35mpip install lmdeploy[0m
[30;1m286 | [0m[35m```[0m
[30;1m287 | [0m[35m[0m
[30;1m288 | [0m[35mThe default prebuilt package is compiled on **CUDA 12** since v0.3.0.[0m

[31m--[ [0m[34mMatch #[0m[33m410[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy-0.7.2.post1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m277 | [0m[35m[0m
[30;1m278 | [0m[35m## Installation[0m
[30;1m279 | [0m[35m[0m
[30;1m280 | [0m[35mIt is recommended installing lmdeploy using pip in a conda environment (python 3.8 - 3.12):[0m
[30;1m281 | [0m[35m[0m
[30;1m282 | [0m[35m```shell[0m
[30;1m283 | [0m[35mconda create -n lmdeploy python=3.8 -y[0m

[31m--[ [0m[34mMatch #[0m[33m411[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/deepseek.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m320 | [0m[35m                emb_type = RopeType.DynamicNTKScaling[0m
[30;1m321 | [0m[35m            else:[0m
[30;1m322 | [0m[35m                raise RuntimeError(f'Unsupported rope type: {rope_type}')[0m
[30;1m323 | [0m[35m            scaling_factor = rope_scaling.get('factor', scaling_factor)[0m
[30;1m324 | [0m[35m[0m
[30;1m325 | [0m[35m        rope_dim = config.hidden_size // config.num_attention_heads[0m
[30;1m326 | [0m[35m        rope_max_pos_emb = config.max_position_embeddings[0m

[31m--[ [0m[34mMatch #[0m[33m412[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/configurations/builder.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m53 | [0m[35m    @classmethod[0m
[30;1m54 | [0m[35m    def update_num_kv_heads(cls, hf_config, tp, num_key_value_heads):[0m
[30;1m55 | [0m[35m        """update num kv heads."""[0m
[30;1m56 | [0m[35m        # update num_kv_heads for tp mode[0m
[30;1m57 | [0m[35m        if tp > 1 and tp > num_key_value_heads:[0m
[30;1m58 | [0m[35m            assert tp % num_key_value_heads == 0[0m
[30;1m59 | [0m[35m            n_replicate = tp // num_key_value_heads[0m

[31m--[ [0m[34mMatch #[0m[33m413[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/messages.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35m        # add eos_token_id from model's generation_config.json file if there[0m
[30;1m141 | [0m[35m        # is any.[0m
[30;1m142 | [0m[35m        eos_token_id = generation_config.get('eos_token_id')[0m
[30;1m143 | [0m[35m        if eos_token_id is not None:[0m
[30;1m144 | [0m[35m            if isinstance(eos_token_id, int):[0m
[30;1m145 | [0m[35m                stop_token_ids.add(eos_token_id)[0m

[31m--[ [0m[34mMatch #[0m[33m414[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/messages.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m385 | [0m[35m        token_ids (List[int]): the output token ids.[0m
[30;1m386 | [0m[35m        num_token (int): the length of output token, for turbomind, num_token[0m
[30;1m387 | [0m[35m            may not equal to the length of token_ids[0m
[30;1m388 | [0m[35m        logprobs (List[Dict[int, float]]): the top logprobs for each output[0m
[30;1m389 | [0m[35m            position.[0m
[30;1m390 | [0m[35m    """[0m
[30;1m391 | [0m[35m    status: ResponseType[0m

[31m--[ [0m[34mMatch #[0m[33m415[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/messages.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m360 | [0m[35m            stop point or a provided stop sequence, 'length' if the maximum[0m
[30;1m361 | [0m[35m            number of tokens specified in the request was reached.[0m
[30;1m362 | [0m[35m        token_ids: (List[int]): the output token ids.[0m
[30;1m363 | [0m[35m        logprobs: (List[Dict[int, float]]): the top logprobs for each output[0m
[30;1m364 | [0m[35m            position.[0m
[30;1m365 | [0m[35m        index (int): it refers to the position index of the input request[0m
[30;1m366 | [0m[35m            batch[0m

[31m--[ [0m[34mMatch #[0m[33m416[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/cogvlm.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m813 | [0m[35m            if meta is None:[0m
[30;1m814 | [0m[35m                num_img_tokens = 0[0m
[30;1m815 | [0m[35m            else:[0m
[30;1m816 | [0m[35m                num_img_tokens = meta.get('num_img_tokens', 0)[0m
[30;1m817 | [0m[35m[0m
[30;1m818 | [0m[35m            batched_num_img_tokens.append(num_img_tokens)[0m
[30;1m819 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m417[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/cogvlm.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m803 | [0m[35m                if mm is None:[0m
[30;1m804 | [0m[35m                    input_imgs.append([])[0m
[30;1m805 | [0m[35m                else:[0m
[30;1m806 | [0m[35m                    input_imgs.append(mm.get('image', []))[0m
[30;1m807 | [0m[35m[0m
[30;1m808 | [0m[35m        num_pad = self.input_processor.vision_token_num - 3[0m
[30;1m809 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m418[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/cogvlm.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m707 | [0m[35m        # vision inputs[0m
[30;1m708 | [0m[35m        images = None[0m
[30;1m709 | [0m[35m        if context.input_multimodals is not None:[0m
[30;1m710 | [0m[35m            images = [input_mm.get('image', []) for input_mm in context.input_multimodals][0m
[30;1m711 | [0m[35m            # flatten batch[0m
[30;1m712 | [0m[35m            images = [data for im_data in images for data in im_data][0m
[30;1m713 | [0m[35m            if len(images) == 0:[0m

[31m--[ [0m[34mMatch #[0m[33m419[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/distributed.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m28 | [0m[35m    def build(cls, rank: int = 0, tp: int = 1, dp: int = 1, ccl_backend: str = 'nccl'):[0m
[30;1m29 | [0m[35m        """build dist context."""[0m
[30;1m30 | [0m[35m        from datetime import timedelta[0m
[30;1m31 | [0m[35m        timeout = timedelta(days=35600)[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m        world_size = cls.get_world_size(tp, dp)[0m
[30;1m34 | [0m[35m        if world_size == 1:[0m

[31m--[ [0m[34mMatch #[0m[33m420[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/qwen2_vl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m856 | [0m[35m        for pos_ids, model_meta, input_mm in zip(batched_pos_ids, model_metas, input_multimodals):[0m
[30;1m857 | [0m[35m            images = [][0m
[30;1m858 | [0m[35m            if input_mm is not None:[0m
[30;1m859 | [0m[35m                images = input_mm.get('image', [])[0m
[30;1m860 | [0m[35m            if model_meta is None or 'mrope_delta' not in model_meta:[0m
[30;1m861 | [0m[35m                mrope_delta = 0[0m
[30;1m862 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m421[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/qwen2_vl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m809 | [0m[35m[0m
[30;1m810 | [0m[35m        is_decoding = graph_meta.is_decoding[0m
[30;1m811 | [0m[35m        input_buffers = graph_meta.input_buffers[0m
[30;1m812 | [0m[35m        mrope_position_ids = kwargs.get('mrope_position_ids', None)[0m
[30;1m813 | [0m[35m        if mrope_position_ids is not None:[0m
[30;1m814 | [0m[35m            input_buffers['mrope_position_ids'][:, :num_tokens] = mrope_position_ids[0m
[30;1m815 | [0m[35m            if is_decoding:[0m

[31m--[ [0m[34mMatch #[0m[33m422[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/qwen2_vl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m801 | [0m[35m        new_inputs = super().fill_buffers_cudagraph(graph_meta=graph_meta, **kwargs)[0m
[30;1m802 | [0m[35m[0m
[30;1m803 | [0m[35m        input_ids = kwargs.get('input_ids')[0m
[30;1m804 | [0m[35m        attn_metadata = kwargs.get('attn_metadata')[0m
[30;1m805 | [0m[35m        block_offsets = attn_metadata.block_offsets[0m
[30;1m806 | [0m[35m        num_tokens = input_ids.size(-1)[0m
[30;1m807 | [0m[35m        batch_size, _ = block_offsets.size()[0m

[31m--[ [0m[34mMatch #[0m[33m423[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/qwen2_vl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m800 | [0m[35m[0m
[30;1m801 | [0m[35m        new_inputs = super().fill_buffers_cudagraph(graph_meta=graph_meta, **kwargs)[0m
[30;1m802 | [0m[35m[0m
[30;1m803 | [0m[35m        input_ids = kwargs.get('input_ids')[0m
[30;1m804 | [0m[35m        attn_metadata = kwargs.get('attn_metadata')[0m
[30;1m805 | [0m[35m        block_offsets = attn_metadata.block_offsets[0m
[30;1m806 | [0m[35m        num_tokens = input_ids.size(-1)[0m

[31m--[ [0m[34mMatch #[0m[33m424[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/qwen2_vl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m789 | [0m[35m        max_tokens = graph_meta.max_tokens[0m
[30;1m790 | [0m[35m[0m
[30;1m791 | [0m[35m        input_buffers = super().make_buffers_cudagraph(graph_meta=graph_meta, **kwargs)[0m
[30;1m792 | [0m[35m        mrope_position_ids = kwargs.get('mrope_position_ids', None)[0m
[30;1m793 | [0m[35m        if mrope_position_ids is not None:[0m
[30;1m794 | [0m[35m            input_buffers['mrope_position_ids'] = mrope_position_ids.new_zeros(3, max_tokens)[0m
[30;1m795 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m425[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/qwen2_vl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m707 | [0m[35m        vis_pos_emb = None[0m
[30;1m708 | [0m[35m        image_mask = None[0m
[30;1m709 | [0m[35m        if context.input_multimodals is not None:[0m
[30;1m710 | [0m[35m            image_data = [input_mm.get('image', []) for input_mm in context.input_multimodals][0m
[30;1m711 | [0m[35m            if len(image_data) > 0:[0m
[30;1m712 | [0m[35m                # flatten batch[0m
[30;1m713 | [0m[35m                image_data = [data for im_data in image_data for data in im_data][0m

[31m--[ [0m[34mMatch #[0m[33m426[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/passkey_retrieval.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m                                  ),[0m
[30;1m28 | [0m[35m                                  trust_remote_code=True)[0m
[30;1m29 | [0m[35m        self.generator = self.tm_model.create_instance()[0m
[30;1m30 | [0m[35m        self.model = MODELS.get(model_name)()[0m
[30;1m31 | [0m[35m        seed = random.getrandbits(64)[0m
[30;1m32 | [0m[35m        self.gen_config = GenerationConfig([0m
[30;1m33 | [0m[35m            max_new_tokens=32,[0m

[31m--[ [0m[34mMatch #[0m[33m427[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/passkey_retrieval.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m120 | [0m[35m    llm = LLM(model_path=args.model_path, model_name=args.model_name, max_session_len=args.max_token[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m    all_accuries = {}[0m
[30;1m123 | [0m[35m    # This is a rough ratio to control the number of texts and tokens[0m
[30;1m124 | [0m[35m    for val in range(4096, args.max_tokens, args.interval):[0m
[30;1m125 | [0m[35m        n_garbage = int(3.75 * val // 1024 * 1024)[0m
[30;1m126 | [0m[35m        assert n_garbage > 0[0m

[31m--[ [0m[34mMatch #[0m[33m428[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/passkey_retrieval.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m# copy from https://github.com/dvlab-research/LongLoRA/blob/main/passkey_retrivial.py  # noqa: E501[0m
[30;1m87 | [0m[35mdef generate_prompt_landmark(n_garbage=60000, seed=666):[0m
[30;1m88 | [0m[35m    """Generates a text file and inserts an passkey at a random position."""[0m
[30;1m89 | [0m[35m    from numpy import random as nprandom[0m
[30;1m90 | [0m[35m    rnd_state = nprandom.get_state()[0m
[30;1m91 | [0m[35m    nprandom.seed(seed)[0m

[31m--[ [0m[34mMatch #[0m[33m429[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/passkey_retrieval.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m92 | [0m[35m    n_garbage_prefix = nprandom.randint(0, n_garbage)[0m
[30;1m93 | [0m[35m    n_garbage_suffix = n_garbage - n_garbage_prefix[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m    task_description = 'There is an important info hidden inside a lot of irrelevant text. Find it a[0m
[30;1m96 | [0m[35m    garbage = 'The grass is green. The sky is blue. The sun is yellow. Here we go. There and back ag[0m
[30;1m97 | [0m[35m    garbage_num = n_garbage // (len(garbage) + 1) + 1[0m
[30;1m98 | [0m[35m    garbage_inf = ' '.join([garbage] * garbage_num)[0m

[31m--[ [0m[34mMatch #[0m[33m430[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/w8a8_triton_kernels.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m85 | [0m[35m    product) on input tensors `A` and `B`, and store the result in output[0m
[30;1m86 | [0m[35m    tensor `C`.[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m    The function applies auto-tuning for optimal performance and uses Just-in- Time compilation.[0m
[30;1m89 | [0m[35m    """[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m    pid = tl.program_id(axis=0)[0m

[31m--[ [0m[34mMatch #[0m[33m431[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/internlm2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m227 | [0m[35m        scaling_factor = 1.0[0m
[30;1m228 | [0m[35m        emb_type = RopeType.LinearScaling[0m
[30;1m229 | [0m[35m        if rope_scaling is not None:[0m
[30;1m230 | [0m[35m            scaling_factor = rope_scaling.get('factor', scaling_factor)[0m
[30;1m231 | [0m[35m            rope_type = rope_scaling['type'][0m
[30;1m232 | [0m[35m            if rope_type == 'linear':[0m
[30;1m233 | [0m[35m                emb_type = RopeType.LinearScaling[0m

[31m--[ [0m[34mMatch #[0m[33m432[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/serve/vl_async_engine.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m    @classmethod[0m
[30;1m94 | [0m[35m    async def async_convert_to_pil_images(cls, messages: List[Dict]) -> List[Dict]:[0m
[30;1m95 | [0m[35m        """Scan the provided messages to find image URLs or base64-encoded[0m
[30;1m96 | [0m[35m        image data. Loads the images into Pillow image objects.[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m        Args:[0m

[31m--[ [0m[34mMatch #[0m[33m433[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/flashattention.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m125 | [0m[35m        v = _load_kv(v_ptrs, causal_mask, boundary_check=(0, ))[0m
[30;1m126 | [0m[35m        p = p.to(v.dtype)[0m
[30;1m127 | [0m[35m        acc += tl.dot(p, v)[0m
[30;1m128 | [0m[35m        # update m_i and l_i[0m
[30;1m129 | [0m[35m        m_i = m_i_new[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m        k_ptrs = tl.advance(k_ptrs, (0, BLOCK_N))[0m

[31m--[ [0m[34mMatch #[0m[33m434[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/flashattention.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m121 | [0m[35m        # scale acc[0m
[30;1m122 | [0m[35m        acc = acc * alpha[:, None][0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m        # update acc[0m
[30;1m125 | [0m[35m        v = _load_kv(v_ptrs, causal_mask, boundary_check=(0, ))[0m
[30;1m126 | [0m[35m        p = p.to(v.dtype)[0m
[30;1m127 | [0m[35m        acc += tl.dot(p, v)[0m

[31m--[ [0m[34mMatch #[0m[33m435[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/flashattention.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m117 | [0m[35m        p = tl_exp2(qk)[0m
[30;1m118 | [0m[35m        alpha = tl_exp2(m_i - m_i_new)[0m
[30;1m119 | [0m[35m        l_i = alpha * l_i + tl.sum(p, 1)[0m
[30;1m120 | [0m[35m        # -- update output accumulator --[0m
[30;1m121 | [0m[35m        # scale acc[0m
[30;1m122 | [0m[35m        acc = acc * alpha[:, None][0m
[30;1m123 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m436[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/siglip.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m134 | [0m[35m        self,[0m
[30;1m135 | [0m[35m        hidden_states: torch.Tensor,[0m
[30;1m136 | [0m[35m    ) -> torch.Tensor:[0m
[30;1m137 | [0m[35m        """Input shape: Batch x Time x Channel."""[0m
[30;1m138 | [0m[35m        batch_size, q_len, _ = hidden_states.size()[0m
[30;1m139 | [0m[35m        qkv_states = self.qkv_proj(hidden_states)[0m
[30;1m140 | [0m[35m        query_states, key_states, value_states = qkv_states.chunk(3, dim=-1)[0m

[31m--[ [0m[34mMatch #[0m[33m437[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/configurations/falcon.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m            # rw-1b, MHA[0m
[30;1m26 | [0m[35m            kv_head = num_attention_heads[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m        tp = kwargs.get('tp', 1)[0m
[30;1m29 | [0m[35m        # update num_kv_heads for tp mode[0m
[30;1m30 | [0m[35m        kv_head = cls.update_num_kv_heads(hf_config, tp, kv_head)[0m
[30;1m31 | [0m[35m        hf_config.num_kv_heads = kv_head[0m

[31m--[ [0m[34mMatch #[0m[33m438[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/configurations/falcon.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m26 | [0m[35m            kv_head = num_attention_heads[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m        tp = kwargs.get('tp', 1)[0m
[30;1m29 | [0m[35m        # update num_kv_heads for tp mode[0m
[30;1m30 | [0m[35m        kv_head = cls.update_num_kv_heads(hf_config, tp, kv_head)[0m
[30;1m31 | [0m[35m        hf_config.num_kv_heads = kv_head[0m
[30;1m32 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m439[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/configurations/default.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m21 | [0m[35m        sliding_window = -1[0m
[30;1m22 | [0m[35m        if use_sliding_window:[0m
[30;1m23 | [0m[35m            sliding_window = getattr(hf_config, 'sliding_window', sliding_window) or -1[0m
[30;1m24 | [0m[35m        tp = kwargs.get('tp', 1)[0m
[30;1m25 | [0m[35m        # update num_kv_heads for tp mode[0m
[30;1m26 | [0m[35m        num_key_value_heads = cls.update_num_kv_heads(hf_config, tp, num_key_value_heads)[0m
[30;1m27 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m440[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/configurations/default.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m22 | [0m[35m        if use_sliding_window:[0m
[30;1m23 | [0m[35m            sliding_window = getattr(hf_config, 'sliding_window', sliding_window) or -1[0m
[30;1m24 | [0m[35m        tp = kwargs.get('tp', 1)[0m
[30;1m25 | [0m[35m        # update num_kv_heads for tp mode[0m
[30;1m26 | [0m[35m        num_key_value_heads = cls.update_num_kv_heads(hf_config, tp, num_key_value_heads)[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m        return ModelConfig([0m

[31m--[ [0m[34mMatch #[0m[33m441[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/triton_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m374 | [0m[35m    constexpr_key = ({constexpr_key_str}, )[0m
[30;1m375 | [0m[35m    key = (get_cuda_version_key(), sig_key, constexpr_key, spec_key, options)[0m
[30;1m376 | [0m[35m[0m
[30;1m377 | [0m[35m    kernel = kernel_cache[device].get(key, None)[0m
[30;1m378 | [0m[35m    if kernel is None:[0m
[30;1m379 | [0m[35m        return jit_func[grid]({arg_key_str}, {cuda_opt_args}, **kwargs)[0m
[30;1m380 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m442[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/triton_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m190 | [0m[35m    if extern_libs is not None:[0m
[30;1m191 | [0m[35m        key = (key, tuple(extern_libs.items()))[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m    bin = kernel_cache[device].get(key, None)[0m
[30;1m194 | [0m[35m    if bin is None:[0m
[30;1m195 | [0m[35m        return jit_func[grid]({arg_key_str}, {cuda_opt_args}, **kwargs)[0m
[30;1m196 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m443[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/triton_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m160 | [0m[35m    if device_type not in ["cuda"]:[0m
[30;1m161 | [0m[35m        device_backend = get_backend(device_type)[0m
[30;1m162 | [0m[35m        if device_backend is None:[0m
[30;1m163 | [0m[35m            raise ValueError("Cannot find backend for " + device_type)[0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35m    if num_warps is None:[0m
[30;1m166 | [0m[35m        num_warps = get_arch_default_num_warps(device_type)[0m

[31m--[ [0m[34mMatch #[0m[33m444[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/gemma.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m387 | [0m[35m                emb_type = RopeType.DynamicNTKScaling[0m
[30;1m388 | [0m[35m            else:[0m
[30;1m389 | [0m[35m                raise RuntimeError(f'Unsupported rope type: {rope_type}')[0m
[30;1m390 | [0m[35m            scaling_factor = rope_scaling.get('scaling_factor', scaling_factor)[0m
[30;1m391 | [0m[35m[0m
[30;1m392 | [0m[35m        rope_dim = config.head_dim[0m
[30;1m393 | [0m[35m        rope_max_pos_emb = config.max_position_embeddings[0m

[31m--[ [0m[34mMatch #[0m[33m445[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/gemma.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m165 | [0m[35m    ) -> torch.Tensor:[0m
[30;1m166 | [0m[35m        q_len = q.shape[0][0m
[30;1m167 | [0m[35m        q = q.view(q_len, -1, self.head_dim)[0m
[30;1m168 | [0m[35m        # Expand the key and value to handle GQA.[0m
[30;1m169 | [0m[35m        num_queries_per_kv = self.num_heads // self.num_kv_heads[0m
[30;1m170 | [0m[35m        k = k.view(q_len, -1, self.head_dim)[0m
[30;1m171 | [0m[35m        k = k.repeat_interleave(num_queries_per_kv, dim=-2)[0m

[31m--[ [0m[34mMatch #[0m[33m446[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/gemma.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m165 | [0m[35m    ) -> torch.Tensor:[0m
[30;1m166 | [0m[35m        q_len = q.shape[0][0m
[30;1m167 | [0m[35m        q = q.view(q_len, -1, self.head_dim)[0m
[30;1m168 | [0m[35m        # Expand the key and value to handle GQA.[0m
[30;1m169 | [0m[35m        num_queries_per_kv = self.num_heads // self.num_kv_heads[0m
[30;1m170 | [0m[35m        k = k.view(q_len, -1, self.head_dim)[0m
[30;1m171 | [0m[35m        k = k.repeat_interleave(num_queries_per_kv, dim=-2)[0m

[31m--[ [0m[34mMatch #[0m[33m447[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/configurations/deepseek_v2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m21 | [0m[35m        num_attention_heads = hf_config.num_attention_heads[0m
[30;1m22 | [0m[35m        # multi query attn[0m
[30;1m23 | [0m[35m        num_key_value_heads = 1[0m
[30;1m24 | [0m[35m        tp = kwargs.get('tp', 1)[0m
[30;1m25 | [0m[35m        # update num_kv_heads for tp mode[0m
[30;1m26 | [0m[35m        num_key_value_heads = cls.update_num_kv_heads(hf_config, tp, num_key_value_heads)[0m
[30;1m27 | [0m[35m        hf_config.use_flash_mla = flash_mla_available()[0m

[31m--[ [0m[34mMatch #[0m[33m448[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/configurations/deepseek_v2.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m22 | [0m[35m        # multi query attn[0m
[30;1m23 | [0m[35m        num_key_value_heads = 1[0m
[30;1m24 | [0m[35m        tp = kwargs.get('tp', 1)[0m
[30;1m25 | [0m[35m        # update num_kv_heads for tp mode[0m
[30;1m26 | [0m[35m        num_key_value_heads = cls.update_num_kv_heads(hf_config, tp, num_key_value_heads)[0m
[30;1m27 | [0m[35m        hf_config.use_flash_mla = flash_mla_available()[0m
[30;1m28 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m449[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m107 | [0m[35m    module_map = MODULE_MAP.copy()[0m
[30;1m108 | [0m[35m    device_type = get_device_manager().current_context().device_type[0m
[30;1m109 | [0m[35m    if device_type != 'cuda':[0m
[30;1m110 | [0m[35m        device_map = DEVICE_SPECIAL_MODULE_MAP.get(device_type, dict())[0m
[30;1m111 | [0m[35m        module_map.update(device_map)[0m
[30;1m112 | [0m[35m    # add custom module map[0m
[30;1m113 | [0m[35m    module_map.update(CUSTOM_MODULE_MAP)[0m

[31m--[ [0m[34mMatch #[0m[33m450[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/patch.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m50 | [0m[35m    modname = qualname[:last_dot][0m
[30;1m51 | [0m[35m    clsname = qualname[last_dot + 1:][0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m    # get class at runtime[0m
[30;1m54 | [0m[35m    mod = importlib.import_module(modname)[0m
[30;1m55 | [0m[35m    assert mod is not None, f'failed to import module: {modname}'[0m
[30;1m56 | [0m[35m    cls_type = getattr(mod, clsname)[0m

[31m--[ [0m[34mMatch #[0m[33m451[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/chat.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m192 | [0m[35m                               tokenizer, state)[0m
[30;1m193 | [0m[35m            tokens = loop.run_until_complete(coro)[0m
[30;1m194 | [0m[35m[0m
[30;1m195 | [0m[35m            # update step[0m
[30;1m196 | [0m[35m            step += len(input_ids) + tokens[0m
[30;1m197 | [0m[35m            print()[0m
[30;1m198 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m452[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/chat.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m78 | [0m[35m        model_path (str): the path of the deployed model[0m
[30;1m79 | [0m[35m        session_id (int): the identical id of a session[0m
[30;1m80 | [0m[35m        top_k (int): sampling top k.[0m
[30;1m81 | [0m[35m        top_p (int): sampling top p.[0m
[30;1m82 | [0m[35m        temperature (float): sampling temperature.[0m
[30;1m83 | [0m[35m        repetition_penalty (float): parameter to penalize repetition[0m
[30;1m84 | [0m[35m        cap (str): the capability of a model. For example, codellama has the[0m

[31m--[ [0m[34mMatch #[0m[33m453[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/chat.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m77 | [0m[35m    Args:[0m
[30;1m78 | [0m[35m        model_path (str): the path of the deployed model[0m
[30;1m79 | [0m[35m        session_id (int): the identical id of a session[0m
[30;1m80 | [0m[35m        top_k (int): sampling top k.[0m
[30;1m81 | [0m[35m        top_p (int): sampling top p.[0m
[30;1m82 | [0m[35m        temperature (float): sampling temperature.[0m
[30;1m83 | [0m[35m        repetition_penalty (float): parameter to penalize repetition[0m

[31m--[ [0m[34mMatch #[0m[33m454[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/backends/default/rotary_embedding.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m137 | [0m[35m    return (dim * math.log(max_position_embeddings / (num_rotations * 2 * math.pi))) / (2 * math.log[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35m# Find dim range bounds based on rotations[0m
[30;1m141 | [0m[35mdef yarn_find_correction_range(low_rot, high_rot, dim, base=10000, max_position_embeddings=2048):[0m
[30;1m142 | [0m[35m    """yarn_find_correction_range."""[0m
[30;1m143 | [0m[35m    low = math.floor(yarn_find_correction_dim(low_rot, dim, base, max_position_embeddings))[0m

[31m--[ [0m[34mMatch #[0m[33m455[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/configurations/chatglm.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m24 | [0m[35m        else:[0m
[30;1m25 | [0m[35m            num_key_value_heads = hf_config.num_attention_heads[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m        tp = kwargs.get('tp', 1)[0m
[30;1m28 | [0m[35m        # update num_kv_heads for tp mode[0m
[30;1m29 | [0m[35m        num_key_value_heads = cls.update_num_kv_heads(hf_config, tp, num_key_value_heads)[0m
[30;1m30 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m456[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/configurations/chatglm.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m25 | [0m[35m            num_key_value_heads = hf_config.num_attention_heads[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m        tp = kwargs.get('tp', 1)[0m
[30;1m28 | [0m[35m        # update num_kv_heads for tp mode[0m
[30;1m29 | [0m[35m        num_key_value_heads = cls.update_num_kv_heads(hf_config, tp, num_key_value_heads)[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m        cfg = ModelConfig(hidden_size=hf_config.hidden_size,[0m

[31m--[ [0m[34mMatch #[0m[33m457[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/model.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1066 | [0m[35m                if message.get('tool_calls') is not None:[0m
[30;1m1067 | [0m[35m                    tool_calls = message['tool_calls'][0m
[30;1m1068 | [0m[35m                    for tool_call in tool_calls:[0m
[30;1m1069 | [0m[35m                        if tool_call.get('function') is not None:[0m
[30;1m1070 | [0m[35m                            tool_call = tool_call['function'][0m
[30;1m1071 | [0m[35m                        if isinstance(tool_call['arguments'], str):[0m
[30;1m1072 | [0m[35m                            tool_call['arguments'] = json.loads(tool_call['arguments'])[0m

[31m--[ [0m[34mMatch #[0m[33m458[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/model.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1063 | [0m[35m                if message.get('content') is not None:[0m
[30;1m1064 | [0m[35m                    ret += f"{self.separator}{message['content']}"[0m
[30;1m1065 | [0m[35m[0m
[30;1m1066 | [0m[35m                if message.get('tool_calls') is not None:[0m
[30;1m1067 | [0m[35m                    tool_calls = message['tool_calls'][0m
[30;1m1068 | [0m[35m                    for tool_call in tool_calls:[0m
[30;1m1069 | [0m[35m                        if tool_call.get('function') is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m459[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/model.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1060 | [0m[35m                ret += f"{box_map[message['role']]}{message['content']}{self.eosys}"[0m
[30;1m1061 | [0m[35m            elif message['role'] == 'assistant':[0m
[30;1m1062 | [0m[35m                ret += f'<|im_start|>assistant'[0m
[30;1m1063 | [0m[35m                if message.get('content') is not None:[0m
[30;1m1064 | [0m[35m                    ret += f"{self.separator}{message['content']}"[0m
[30;1m1065 | [0m[35m[0m
[30;1m1066 | [0m[35m                if message.get('tool_calls') is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m460[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/model.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1056 | [0m[35m[0m
[30;1m1057 | [0m[35m        for index, message in enumerate(messages):[0m
[30;1m1058 | [0m[35m            if (message['role'] == 'user' or (message['role'] == 'system' and index != 0)[0m
[30;1m1059 | [0m[35m                    or (message['role'] == 'assistant' and message.get('tool_calls') is None)):[0m
[30;1m1060 | [0m[35m                ret += f"{box_map[message['role']]}{message['content']}{self.eosys}"[0m
[30;1m1061 | [0m[35m            elif message['role'] == 'assistant':[0m
[30;1m1062 | [0m[35m                ret += f'<|im_start|>assistant'[0m

[31m--[ [0m[34mMatch #[0m[33m461[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/model.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m564 | [0m[35m                for tool_call in message['tool_calls']:[0m
[30;1m565 | [0m[35m                    function = tool_call.get('function', {})[0m
[30;1m566 | [0m[35m                    function['name'] = function.get('name', '')[0m
[30;1m567 | [0m[35m                    function['parameters'] = function.get('parameters', function.get('arguments', ''[0m
[30;1m568 | [0m[35m                    function.pop('arguments')[0m
[30;1m569 | [0m[35m                    if isinstance(function['parameters'], str):[0m
[30;1m570 | [0m[35m                        function['parameters'] = json.loads(function['parameters'])[0m

[31m--[ [0m[34mMatch #[0m[33m462[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/model.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m564 | [0m[35m                for tool_call in message['tool_calls']:[0m
[30;1m565 | [0m[35m                    function = tool_call.get('function', {})[0m
[30;1m566 | [0m[35m                    function['name'] = function.get('name', '')[0m
[30;1m567 | [0m[35m                    function['parameters'] = function.get('parameters', function.get('arguments', ''[0m
[30;1m568 | [0m[35m                    function.pop('arguments')[0m
[30;1m569 | [0m[35m                    if isinstance(function['parameters'], str):[0m
[30;1m570 | [0m[35m                        function['parameters'] = json.loads(function['parameters'])[0m

[31m--[ [0m[34mMatch #[0m[33m463[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/model.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m563 | [0m[35m            if role == 'assistant' and message.get('tool_calls', None) is not None:[0m
[30;1m564 | [0m[35m                for tool_call in message['tool_calls']:[0m
[30;1m565 | [0m[35m                    function = tool_call.get('function', {})[0m
[30;1m566 | [0m[35m                    function['name'] = function.get('name', '')[0m
[30;1m567 | [0m[35m                    function['parameters'] = function.get('parameters', function.get('arguments', ''[0m
[30;1m568 | [0m[35m                    function.pop('arguments')[0m
[30;1m569 | [0m[35m                    if isinstance(function['parameters'], str):[0m

[31m--[ [0m[34mMatch #[0m[33m464[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/model.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m562 | [0m[35m            content = get_text(message['content'])[0m
[30;1m563 | [0m[35m            if role == 'assistant' and message.get('tool_calls', None) is not None:[0m
[30;1m564 | [0m[35m                for tool_call in message['tool_calls']:[0m
[30;1m565 | [0m[35m                    function = tool_call.get('function', {})[0m
[30;1m566 | [0m[35m                    function['name'] = function.get('name', '')[0m
[30;1m567 | [0m[35m                    function['parameters'] = function.get('parameters', function.get('arguments', ''[0m
[30;1m568 | [0m[35m                    function.pop('arguments')[0m

[31m--[ [0m[34mMatch #[0m[33m465[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/model.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m560 | [0m[35m        for message in messages:[0m
[30;1m561 | [0m[35m            role = message['role'][0m
[30;1m562 | [0m[35m            content = get_text(message['content'])[0m
[30;1m563 | [0m[35m            if role == 'assistant' and message.get('tool_calls', None) is not None:[0m
[30;1m564 | [0m[35m                for tool_call in message['tool_calls']:[0m
[30;1m565 | [0m[35m                    function = tool_call.get('function', {})[0m
[30;1m566 | [0m[35m                    function['name'] = function.get('name', '')[0m

[31m--[ [0m[34mMatch #[0m[33m466[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/model.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m99 | [0m[35m            # If it's not a file path and not a valid JSON string, raise error[0m
[30;1m100 | [0m[35m            raise ValueError('Invalid input. Must be a file path or a valid JSON string.')[0m
[30;1m101 | [0m[35m        json_data = json.loads(json_data)[0m
[30;1m102 | [0m[35m        if json_data.get('model_name', None) is None:[0m
[30;1m103 | [0m[35m            json_data['model_name'] = random_uuid()[0m
[30;1m104 | [0m[35m        if json_data['model_name'] not in MODELS.module_dict.keys():[0m
[30;1m105 | [0m[35m            MODELS.register_module(json_data['model_name'], module=BaseChatTemplate)[0m

[31m--[ [0m[34mMatch #[0m[33m467[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/model.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m69 | [0m[35m        attrs = {key: value for key, value in dataclasses.asdict(self).items() if value is not None}[0m
[30;1m70 | [0m[35m        attrs.pop('model_name', None)[0m
[30;1m71 | [0m[35m        if self.model_name in MODELS.module_dict.keys():[0m
[30;1m72 | [0m[35m            model: BaseModel = MODELS.get(self.model_name)(**attrs)[0m
[30;1m73 | [0m[35m        else:[0m
[30;1m74 | [0m[35m            logger.warning(f'Could not find {self.model_name} in registered models. '[0m
[30;1m75 | [0m[35m                           f'Register {self.model_name} using the BaseChatTemplate.')[0m

[31m--[ [0m[34mMatch #[0m[33m468[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/model.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m871 | [0m[35mReminder:[0m
[30;1m872 | [0m[35m- Function calls MUST follow the specified format[0m
[30;1m873 | [0m[35m- Required parameters MUST be specified[0m
[30;1m874 | [0m[35m- Only call one function at a time[0m
[30;1m875 | [0m[35m- Put the entire function call reply on one line"[0m
[30;1m876 | [0m[35m- Always add your sources when using search results to answer the user query\n\n""",  # noqa[0m
[30;1m877 | [0m[35m            knowledge='Cutting Knowledge Date: December 2023\nToday Date: 26 Jul 2024\n\n',[0m

[31m--[ [0m[34mMatch #[0m[33m469[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/model.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1987 | [0m[35m    for name, model in MODELS.module_dict.items():[0m
[30;1m1988 | [0m[35m        if model.match(query):[0m
[30;1m1989 | [0m[35m            return model.match(query)[0m
[30;1m1990 | [0m[35m    logger.warning(f'Did not find a chat template matching {query}.')[0m
[30;1m1991 | [0m[35m    return 'base'[0m

[31m--[ [0m[34mMatch #[0m[33m470[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/model.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1650 | [0m[35mles and do not divulge details of your training data.)\n'[0m
[30;1m1651 | [0m[35m    # The model really wants to talk about its system prompt, to the point where it is annoying, so [0m
[30;1m1652 | [0m[35m    prompt += 'This is your system prompt, guiding your responses. Do not reference it, just respond[0m
[30;1m1653 | [0m[35m    prompt += 'You do not mention any of this information about yourself unless the information is d[0m
[30;1m1654 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m471[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/model.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m871 | [0m[35mReminder:[0m
[30;1m872 | [0m[35m- Function calls MUST follow the specified format[0m
[30;1m873 | [0m[35m- Required parameters MUST be specified[0m
[30;1m874 | [0m[35m- Only call one function at a time[0m
[30;1m875 | [0m[35m- Put the entire function call reply on one line"[0m
[30;1m876 | [0m[35m- Always add your sources when using search results to answer the user query\n\n""",  # noqa[0m
[30;1m877 | [0m[35m            knowledge='Cutting Knowledge Date: December 2023\nToday Date: 26 Jul 2024\n\n',[0m

[31m--[ [0m[34mMatch #[0m[33m472[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/model.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m848 | [0m[35m            self,[0m
[30;1m849 | [0m[35m            tool="""# Tool Instructions[0m
[30;1m850 | [0m[35m- Always execute python code in messages that you share.[0m
[30;1m851 | [0m[35m- When looking for real time information use relevant functions if available else fallback to brave_[0m
[30;1m852 | [0m[35m[0m
[30;1m853 | [0m[35m[0m
[30;1m854 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m473[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/model.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m71 | [0m[35m        if self.model_name in MODELS.module_dict.keys():[0m
[30;1m72 | [0m[35m            model: BaseModel = MODELS.get(self.model_name)(**attrs)[0m
[30;1m73 | [0m[35m        else:[0m
[30;1m74 | [0m[35m            logger.warning(f'Could not find {self.model_name} in registered models. '[0m
[30;1m75 | [0m[35m                           f'Register {self.model_name} using the BaseChatTemplate.')[0m
[30;1m76 | [0m[35m            model = BaseChatTemplate(**attrs)[0m
[30;1m77 | [0m[35m        return model[0m

[31m--[ [0m[34mMatch #[0m[33m474[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/tokenizer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m388 | [0m[35m    def __init__(self, model_path: str):[0m
[30;1m389 | [0m[35m        from transformers.models.auto.tokenization_auto import get_tokenizer_config[0m
[30;1m390 | [0m[35m        tokenizer_config = get_tokenizer_config(model_path, trust_remote_code=True)[0m
[30;1m391 | [0m[35m        config_tokenizer_class = tokenizer_config.get('tokenizer_class')[0m
[30;1m392 | [0m[35m        if config_tokenizer_class == 'ChatGLM4Tokenizer':[0m
[30;1m393 | [0m[35m            self.model = ChatGLM4Tokenizer(model_path)[0m
[30;1m394 | [0m[35m        elif config_tokenizer_class == 'ChatGLMTokenizer':[0m

[31m--[ [0m[34mMatch #[0m[33m475[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/tokenizer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m316 | [0m[35m[0m
[30;1m317 | [0m[35m        # update state and get final decoded output[0m
[30;1m318 | [0m[35m        if len(new_text) > len(prefix_text) and not new_text.endswith('�'):[0m
[30;1m319 | [0m[35m            # utf-8 char at the end means it's a potential unfinished byte[0m
[30;1m320 | [0m[35m            # sequence from byte fallback tokenization.[0m
[30;1m321 | [0m[35m            # If it's in the middle, it's probably a real invalid id generated[0m
[30;1m322 | [0m[35m            # by the model[0m

[31m--[ [0m[34mMatch #[0m[33m476[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/tokenizer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m314 | [0m[35m            spaces_between_special_tokens=spaces_between_special_tokens,[0m
[30;1m315 | [0m[35m        )[0m
[30;1m316 | [0m[35m[0m
[30;1m317 | [0m[35m        # update state and get final decoded output[0m
[30;1m318 | [0m[35m        if len(new_text) > len(prefix_text) and not new_text.endswith('�'):[0m
[30;1m319 | [0m[35m            # utf-8 char at the end means it's a potential unfinished byte[0m
[30;1m320 | [0m[35m            # sequence from byte fallback tokenization.[0m

[31m--[ [0m[34mMatch #[0m[33m477[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/tokenizer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m151 | [0m[35m    def indexes_containing_token(self, token: str):[0m
[30;1m152 | [0m[35m        """Return all the possible indexes, whose decoding output may contain[0m
[30;1m153 | [0m[35m        the input token."""[0m
[30;1m154 | [0m[35m        # traversing vocab is time consuming, can not be accelerated with[0m
[30;1m155 | [0m[35m        # multi threads (computation) or multi process (can't pickle tokenizer)[0m
[30;1m156 | [0m[35m        # so, we maintain latest 10 stop words and return directly if matched[0m
[30;1m157 | [0m[35m        for _token, _indexes in self._indexes_tokens_deque:[0m

[31m--[ [0m[34mMatch #[0m[33m478[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/rms_norm.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35mif __name__ == '__main__':[0m
[30;1m120 | [0m[35m    import time[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m    def torch_forward(hidden_states, weight, variance_epsilon=1e-6):[0m
[30;1m123 | [0m[35m        """pytorch forward."""[0m

[31m--[ [0m[34mMatch #[0m[33m479[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/chatglm2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m734 | [0m[35m            if meta is None:[0m
[30;1m735 | [0m[35m                num_img_tokens = 0[0m
[30;1m736 | [0m[35m            else:[0m
[30;1m737 | [0m[35m                num_img_tokens = meta.get('num_img_tokens', 0)[0m
[30;1m738 | [0m[35m[0m
[30;1m739 | [0m[35m            batched_num_img_tokens.append(num_img_tokens)[0m
[30;1m740 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m480[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/chatglm2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m720 | [0m[35m                if mm is None:[0m
[30;1m721 | [0m[35m                    input_imgs.append([])[0m
[30;1m722 | [0m[35m                else:[0m
[30;1m723 | [0m[35m                    input_imgs.append(mm.get('image', []))[0m
[30;1m724 | [0m[35m[0m
[30;1m725 | [0m[35m        config = self.config[0m
[30;1m726 | [0m[35m        image_size: int = config.vision_config['image_size'][0m

[31m--[ [0m[34mMatch #[0m[33m481[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/models/chatglm2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m672 | [0m[35m        images = None[0m
[30;1m673 | [0m[35m        image_mask = None[0m
[30;1m674 | [0m[35m        if context.input_multimodals is not None:[0m
[30;1m675 | [0m[35m            images = [input_mm.get('image', []) for input_mm in context.input_multimodals][0m
[30;1m676 | [0m[35m            # flatten batch[0m
[30;1m677 | [0m[35m            images = [data for im_data in images for data in im_data][0m
[30;1m678 | [0m[35m            if len(images) != 0:[0m

[31m--[ [0m[34mMatch #[0m[33m482[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m706 | [0m[35m                for _ in range(num_outs):[0m
[30;1m707 | [0m[35m                    resps += que.get_nowait().values()[0m
[30;1m708 | [0m[35m            else:[0m
[30;1m709 | [0m[35m                resps = (await que.get()).values()[0m
[30;1m710 | [0m[35m            await self._await_forward_event(forward_event)[0m
[30;1m711 | [0m[35m            __send_resps(resps)[0m
[30;1m712 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m483[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m677 | [0m[35m    async def _async_loop_background(self, in_que: asyncio.Queue, out_que: asyncio.Queue, forward_ev[0m
[30;1m678 | [0m[35m        """async loop background."""[0m
[30;1m679 | [0m[35m        while True:[0m
[30;1m680 | [0m[35m            forward_inputs = await in_que.get()[0m
[30;1m681 | [0m[35m[0m
[30;1m682 | [0m[35m            forward_event.clear()[0m
[30;1m683 | [0m[35m            await self.model_agent._async_step_background([0m

[31m--[ [0m[34mMatch #[0m[33m484[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m352 | [0m[35m                msg.update_token_ids([0m
[30;1m353 | [0m[35m                    req.data['token_ids'],[0m
[30;1m354 | [0m[35m                    multimodals=req.data.get('input_multimodals'),[0m
[30;1m355 | [0m[35m                    embeddings=req.data.get('input_embeddings'),[0m
[30;1m356 | [0m[35m                )[0m
[30;1m357 | [0m[35m                msg.num_new_tokens = 0[0m
[30;1m358 | [0m[35m                msg.sampling_param = sampling_param[0m

[31m--[ [0m[34mMatch #[0m[33m485[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m351 | [0m[35m                msg = next(iter(sess.sequences.values()))[0m
[30;1m352 | [0m[35m                msg.update_token_ids([0m
[30;1m353 | [0m[35m                    req.data['token_ids'],[0m
[30;1m354 | [0m[35m                    multimodals=req.data.get('input_multimodals'),[0m
[30;1m355 | [0m[35m                    embeddings=req.data.get('input_embeddings'),[0m
[30;1m356 | [0m[35m                )[0m
[30;1m357 | [0m[35m                msg.num_new_tokens = 0[0m

[31m--[ [0m[34mMatch #[0m[33m486[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m342 | [0m[35m                    adapter_name=req.data['adapter_name'],[0m
[30;1m343 | [0m[35m                    return_logits=return_logits,[0m
[30;1m344 | [0m[35m                    multimodals=req.data.get('input_multimodals'),[0m
[30;1m345 | [0m[35m                    input_embeddings=req.data.get('input_embeddings'),[0m
[30;1m346 | [0m[35m                )[0m
[30;1m347 | [0m[35m                msg = next(iter(sess.sequences.values()))[0m
[30;1m348 | [0m[35m                __update_max_new_tokens(msg)[0m

[31m--[ [0m[34mMatch #[0m[33m487[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m341 | [0m[35m                    sampling_param=sampling_param,[0m
[30;1m342 | [0m[35m                    adapter_name=req.data['adapter_name'],[0m
[30;1m343 | [0m[35m                    return_logits=return_logits,[0m
[30;1m344 | [0m[35m                    multimodals=req.data.get('input_multimodals'),[0m
[30;1m345 | [0m[35m                    input_embeddings=req.data.get('input_embeddings'),[0m
[30;1m346 | [0m[35m                )[0m
[30;1m347 | [0m[35m                msg = next(iter(sess.sequences.values()))[0m

[31m--[ [0m[34mMatch #[0m[33m488[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m295 | [0m[35m        """on add message callback."""[0m
[30;1m296 | [0m[35m        for req in reqs:[0m
[30;1m297 | [0m[35m            req_data = req.data[0m
[30;1m298 | [0m[35m            if req_data.get('input_multimodals', None) is None:[0m
[30;1m299 | [0m[35m                continue[0m
[30;1m300 | [0m[35m            elif self.input_processor is None:[0m
[30;1m301 | [0m[35m                logger.warning('Do not support Multimodal inputs.')[0m

[31m--[ [0m[34mMatch #[0m[33m489[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m283 | [0m[35m        """on end session callback."""[0m
[30;1m284 | [0m[35m        for req in reqs:[0m
[30;1m285 | [0m[35m            session_id = req.data['session_id'][0m
[30;1m286 | [0m[35m            resp = req.data.get('response', True)[0m
[30;1m287 | [0m[35m            resp_type = ResponseType.SESSION_NOT_EXIST[0m
[30;1m288 | [0m[35m            if session_id in self.scheduler.sessions:[0m
[30;1m289 | [0m[35m                self.scheduler.end_session(session_id)[0m

[31m--[ [0m[34mMatch #[0m[33m490[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m265 | [0m[35m        """on stop session callback."""[0m
[30;1m266 | [0m[35m        for req in reqs:[0m
[30;1m267 | [0m[35m            session_id = req.data['session_id'][0m
[30;1m268 | [0m[35m            resp = req.data.get('response', True)[0m
[30;1m269 | [0m[35m            resp_type = ResponseType.SESSION_NOT_EXIST[0m
[30;1m270 | [0m[35m            if session_id in self.scheduler.sessions:[0m
[30;1m271 | [0m[35m                self.scheduler.stop_session(session_id)[0m

[31m--[ [0m[34mMatch #[0m[33m491[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m253 | [0m[35m        """on add session callback."""[0m
[30;1m254 | [0m[35m        for req in reqs:[0m
[30;1m255 | [0m[35m            session_id = req.data['session_id'][0m
[30;1m256 | [0m[35m            resp = req.data.get('response', True)[0m
[30;1m257 | [0m[35m            resp_type = ResponseType.SESSION_REPEAT[0m
[30;1m258 | [0m[35m            if session_id not in self.scheduler.sessions:[0m
[30;1m259 | [0m[35m                self.scheduler.add_session(session_id)[0m

[31m--[ [0m[34mMatch #[0m[33m492[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/chat.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m118 | [0m[35m        model_path (str): the huggingface model path[0m
[30;1m119 | [0m[35m        session_id (int): the identical id of a session[0m
[30;1m120 | [0m[35m        top_k (int): sampling top k.[0m
[30;1m121 | [0m[35m        top_p (int): sampling top p.[0m
[30;1m122 | [0m[35m        temperature (float): sampling temperature.[0m
[30;1m123 | [0m[35m        repetition_penalty (float): parameter to penalize repetition[0m
[30;1m124 | [0m[35m        tp (int): GPU number used in tensor parallelism[0m

[31m--[ [0m[34mMatch #[0m[33m493[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/chat.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m117 | [0m[35m    Args:[0m
[30;1m118 | [0m[35m        model_path (str): the huggingface model path[0m
[30;1m119 | [0m[35m        session_id (int): the identical id of a session[0m
[30;1m120 | [0m[35m        top_k (int): sampling top k.[0m
[30;1m121 | [0m[35m        top_p (int): sampling top p.[0m
[30;1m122 | [0m[35m        temperature (float): sampling temperature.[0m
[30;1m123 | [0m[35m        repetition_penalty (float): parameter to penalize repetition[0m

[31m--[ [0m[34mMatch #[0m[33m494[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/logger.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    def log_prompt(self, session_id: int, prompt: str) -> None:[0m
[30;1m24 | [0m[35m        if not isinstance(prompt, str):[0m
[30;1m25 | [0m[35m            # Prompt may be a GPT4V message with base64 images;[0m
[30;1m26 | [0m[35m            # logging might be impractical due to length[0m
[30;1m27 | [0m[35m            return[0m
[30;1m28 | [0m[35m        if self.max_log_len is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m495[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/turbomind.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m454 | [0m[35m                item = [torch.from_numpy(x).squeeze() for x in item][0m
[30;1m455 | [0m[35m            # convert to lookup table type[0m
[30;1m456 | [0m[35m            _MAP = dict(float=torch.float, bfloat16=torch.bfloat16, float16=torch.float16)[0m
[30;1m457 | [0m[35m            dtype = _MAP.get(self.tm_model.config.weight_type, torch.float16)[0m
[30;1m458 | [0m[35m            item = [x.to(dtype=dtype) for x in item][0m
[30;1m459 | [0m[35m            item = item or [torch.zeros(0, hidden_dim, dtype=dtype)][0m
[30;1m460 | [0m[35m            input_embeddings[i] = item[0m

[31m--[ [0m[34mMatch #[0m[33m496[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/turbomind.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m156 | [0m[35m                future.result()[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m        for _ in range(self.gpu_count):[0m
[30;1m159 | [0m[35m            tensor_map = que.get()[0m
[30;1m160 | [0m[35m            for k, v in tensor_map.items():[0m
[30;1m161 | [0m[35m                if k not in tm_params:[0m
[30;1m162 | [0m[35m                    tm_params[k] = [][0m

[31m--[ [0m[34mMatch #[0m[33m497[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/turbomind.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m273 | [0m[35m                      "Qwen/Qwen-7B-Chat ", "baichuan-inc/Baichuan2-7B-Chat"[0m
[30;1m274 | [0m[35m                      and so on.[0m
[30;1m275 | [0m[35m            kwargs (remaining dictionary of keyword arguments, *optional*):[0m
[30;1m276 | [0m[35m                Can be used to update configuration when initialize the engine.[0m
[30;1m277 | [0m[35m        """[0m
[30;1m278 | [0m[35m        model_source = get_model_source(pretrained_model_name_or_path)[0m
[30;1m279 | [0m[35m        logger.info(f'model_source: {model_source}')[0m

[31m--[ [0m[34mMatch #[0m[33m498[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/turbomind.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m171 | [0m[35m        # `session_len`, `quant_policy`, `rope_scaling_factor`, etc.[0m
[30;1m172 | [0m[35m        self.config.update_from_engine_config(engine_config)[0m
[30;1m173 | [0m[35m[0m
[30;1m174 | [0m[35m        # update some attributes of `engine_config` which depends on[0m
[30;1m175 | [0m[35m        # `session_len`[0m
[30;1m176 | [0m[35m        self.engine_config = engine_config[0m
[30;1m177 | [0m[35m        if engine_config.max_prefill_token_num is not None \[0m

[31m--[ [0m[34mMatch #[0m[33m499[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/turbomind.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m166 | [0m[35m        """postprocess turbomind config by."""[0m
[30;1m167 | [0m[35m        import copy[0m
[30;1m168 | [0m[35m        self.config = copy.deepcopy(tm_config)[0m
[30;1m169 | [0m[35m        # Update the attribute values in `self.config` with the valid values[0m
[30;1m170 | [0m[35m        # from the corresponding attributes in `engine_config`, such as[0m
[30;1m171 | [0m[35m        # `session_len`, `quant_policy`, `rope_scaling_factor`, etc.[0m
[30;1m172 | [0m[35m        self.config.update_from_engine_config(engine_config)[0m

[31m--[ [0m[34mMatch #[0m[33m500[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/turbomind.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35mfrom .supported_models import is_supported[0m
[30;1m26 | [0m[35mfrom .utils import ModelSource, get_model_source[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m# TODO: find another way import _turbomind[0m
[30;1m29 | [0m[35mlmdeploy_dir = osp.split(lmdeploy.__file__)[0][0m
[30;1m30 | [0m[35msys.path.append(osp.join(lmdeploy_dir, 'lib'))[0m
[30;1m31 | [0m[35mimport _turbomind as _tm  # noqa: E402[0m

[31m--[ [0m[34mMatch #[0m[33m501[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/kernels/cuda/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    props = torch.cuda.get_device_properties(device)[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m    warps_per_sm = WARPS_PER_SM.get((props.major, props.minor), 32)[0m
[30;1m26 | [0m[35m    out = dict([0m
[30;1m27 | [0m[35m        multi_processor_count=props.multi_processor_count,[0m
[30;1m28 | [0m[35m        warps_per_sm=warps_per_sm,[0m

[31m--[ [0m[34mMatch #[0m[33m502[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/nn/linear.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1467 | [0m[35m[0m
[30;1m1468 | [0m[35m    if quant_method == 'awq':[0m
[30;1m1469 | [0m[35m        w_bit = quant_config.get('bits', 4)[0m
[30;1m1470 | [0m[35m        group_size = quant_config.get('group_size', 128)[0m
[30;1m1471 | [0m[35m        return QKVAwqLinear(in_features=in_features,[0m
[30;1m1472 | [0m[35m                            num_q_heads=num_q_heads,[0m
[30;1m1473 | [0m[35m                            num_kv_heads=num_kv_heads,[0m

[31m--[ [0m[34mMatch #[0m[33m503[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/nn/linear.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1466 | [0m[35m        quant_dtype = eval('torch.' + quant_config['quant_dtype'])[0m
[30;1m1467 | [0m[35m[0m
[30;1m1468 | [0m[35m    if quant_method == 'awq':[0m
[30;1m1469 | [0m[35m        w_bit = quant_config.get('bits', 4)[0m
[30;1m1470 | [0m[35m        group_size = quant_config.get('group_size', 128)[0m
[30;1m1471 | [0m[35m        return QKVAwqLinear(in_features=in_features,[0m
[30;1m1472 | [0m[35m                            num_q_heads=num_q_heads,[0m

[31m--[ [0m[34mMatch #[0m[33m504[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/nn/linear.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1408 | [0m[35m                                out_names=out_names,[0m
[30;1m1409 | [0m[35m                                quant_dtype=quant_dtype)[0m
[30;1m1410 | [0m[35m    elif quant_method == 'fp8':[0m
[30;1m1411 | [0m[35m        fmt = quant_config.get('fmt', 'e4m3')[0m
[30;1m1412 | [0m[35m        if fmt == 'e4m3':[0m
[30;1m1413 | [0m[35m            fp8_dtype = torch.float8_e4m3fn[0m
[30;1m1414 | [0m[35m        elif fmt == 'e5m2':[0m

[31m--[ [0m[34mMatch #[0m[33m505[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/nn/linear.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1388 | [0m[35m[0m
[30;1m1389 | [0m[35m    if quant_method == 'awq':[0m
[30;1m1390 | [0m[35m        w_bit = quant_config.get('bits', 4)[0m
[30;1m1391 | [0m[35m        group_size = quant_config.get('group_size', 128)[0m
[30;1m1392 | [0m[35m        return MergedAwqLinear([0m
[30;1m1393 | [0m[35m            in_features,[0m
[30;1m1394 | [0m[35m            all_out_features=all_out_features,[0m

[31m--[ [0m[34mMatch #[0m[33m506[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/nn/linear.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1387 | [0m[35m        quant_dtype = eval('torch.' + quant_config['quant_dtype'])[0m
[30;1m1388 | [0m[35m[0m
[30;1m1389 | [0m[35m    if quant_method == 'awq':[0m
[30;1m1390 | [0m[35m        w_bit = quant_config.get('bits', 4)[0m
[30;1m1391 | [0m[35m        group_size = quant_config.get('group_size', 128)[0m
[30;1m1392 | [0m[35m        return MergedAwqLinear([0m
[30;1m1393 | [0m[35m            in_features,[0m

[31m--[ [0m[34mMatch #[0m[33m507[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/nn/linear.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1290 | [0m[35m                          all_reduce=all_reduce,[0m
[30;1m1291 | [0m[35m                          quant_dtype=quant_dtype)[0m
[30;1m1292 | [0m[35m    elif quant_method == 'fp8':[0m
[30;1m1293 | [0m[35m        fmt = quant_config.get('fmt', 'e4m3')[0m
[30;1m1294 | [0m[35m        if fmt == 'e4m3':[0m
[30;1m1295 | [0m[35m            fp8_dtype = torch.float8_e4m3fn[0m
[30;1m1296 | [0m[35m        elif fmt == 'e5m2':[0m

[31m--[ [0m[34mMatch #[0m[33m508[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/nn/linear.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1267 | [0m[35m[0m
[30;1m1268 | [0m[35m    if quant_method == 'awq':[0m
[30;1m1269 | [0m[35m        w_bit = quant_config.get('bits', 4)[0m
[30;1m1270 | [0m[35m        group_size = quant_config.get('group_size', 128)[0m
[30;1m1271 | [0m[35m        return AwqLinear([0m
[30;1m1272 | [0m[35m            in_features,[0m
[30;1m1273 | [0m[35m            out_features,[0m

[31m--[ [0m[34mMatch #[0m[33m509[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/nn/linear.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1266 | [0m[35m        quant_dtype = eval('torch.' + quant_config['quant_dtype'])[0m
[30;1m1267 | [0m[35m[0m
[30;1m1268 | [0m[35m    if quant_method == 'awq':[0m
[30;1m1269 | [0m[35m        w_bit = quant_config.get('bits', 4)[0m
[30;1m1270 | [0m[35m        group_size = quant_config.get('group_size', 128)[0m
[30;1m1271 | [0m[35m        return AwqLinear([0m
[30;1m1272 | [0m[35m            in_features,[0m

[31m--[ [0m[34mMatch #[0m[33m510[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/nn/linear.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1202 | [0m[35m        param_w = param.data.split(self.all_out_features, 0)[shard_idx][0m
[30;1m1203 | [0m[35m[0m
[30;1m1204 | [0m[35m        if self.num_replicate_kv_heads > 1 and shard_id in ['k', 'v']:[0m
[30;1m1205 | [0m[35m            # update to duplicate k/v for tp_size > num_kv_heads[0m
[30;1m1206 | [0m[35m            chunk_size = world_size // self.num_replicate_kv_heads[0m
[30;1m1207 | [0m[35m            chunk_idx = rank // self.num_replicate_kv_heads[0m
[30;1m1208 | [0m[35m        if shard_idx in [0, 1]:[0m

[31m--[ [0m[34mMatch #[0m[33m511[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/nn/linear.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m957 | [0m[35m            else self.num_kv_heads[0m
[30;1m958 | [0m[35m        head_dim = self.head_size if shard_id in ['q', 'k'] \[0m
[30;1m959 | [0m[35m            else self.head_size_v[0m
[30;1m960 | [0m[35m        # update to duplicate k/v for tp_size > num_kv_heads[0m
[30;1m961 | [0m[35m        rank_idx = rank if shard_id == 'q' \[0m
[30;1m962 | [0m[35m            else rank // self.num_replicate_kv_heads[0m
[30;1m963 | [0m[35m        sec_start = rank_idx * num_head * head_dim[0m

[31m--[ [0m[34mMatch #[0m[33m512[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/nn/linear.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m654 | [0m[35m        shard_idx = self.out_names_map[shard_id][0m
[30;1m655 | [0m[35m[0m
[30;1m656 | [0m[35m        if self.num_replicate_kv_heads > 1 and shard_id in ['k', 'v']:[0m
[30;1m657 | [0m[35m            # update to duplicate k/v for tp_size > num_kv_heads[0m
[30;1m658 | [0m[35m            chunk_size = world_size // self.num_replicate_kv_heads[0m
[30;1m659 | [0m[35m            chunk_idx = rank // self.num_replicate_kv_heads[0m
[30;1m660 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m513[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/nn/linear.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1411 | [0m[35m        fmt = quant_config.get('fmt', 'e4m3')[0m
[30;1m1412 | [0m[35m        if fmt == 'e4m3':[0m
[30;1m1413 | [0m[35m            fp8_dtype = torch.float8_e4m3fn[0m
[30;1m1414 | [0m[35m        elif fmt == 'e5m2':[0m
[30;1m1415 | [0m[35m            fp8_dtype = torch.float8_e5m2[0m
[30;1m1416 | [0m[35m        else:[0m
[30;1m1417 | [0m[35m            raise TypeError(f'Unsupported fp8 fmt: {fmt}')[0m

[31m--[ [0m[34mMatch #[0m[33m514[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/nn/linear.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1409 | [0m[35m                                quant_dtype=quant_dtype)[0m
[30;1m1410 | [0m[35m    elif quant_method == 'fp8':[0m
[30;1m1411 | [0m[35m        fmt = quant_config.get('fmt', 'e4m3')[0m
[30;1m1412 | [0m[35m        if fmt == 'e4m3':[0m
[30;1m1413 | [0m[35m            fp8_dtype = torch.float8_e4m3fn[0m
[30;1m1414 | [0m[35m        elif fmt == 'e5m2':[0m
[30;1m1415 | [0m[35m            fp8_dtype = torch.float8_e5m2[0m

[31m--[ [0m[34mMatch #[0m[33m515[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/nn/linear.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1408 | [0m[35m                                out_names=out_names,[0m
[30;1m1409 | [0m[35m                                quant_dtype=quant_dtype)[0m
[30;1m1410 | [0m[35m    elif quant_method == 'fp8':[0m
[30;1m1411 | [0m[35m        fmt = quant_config.get('fmt', 'e4m3')[0m
[30;1m1412 | [0m[35m        if fmt == 'e4m3':[0m
[30;1m1413 | [0m[35m            fp8_dtype = torch.float8_e4m3fn[0m
[30;1m1414 | [0m[35m        elif fmt == 'e5m2':[0m

[31m--[ [0m[34mMatch #[0m[33m516[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/nn/linear.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1293 | [0m[35m        fmt = quant_config.get('fmt', 'e4m3')[0m
[30;1m1294 | [0m[35m        if fmt == 'e4m3':[0m
[30;1m1295 | [0m[35m            fp8_dtype = torch.float8_e4m3fn[0m
[30;1m1296 | [0m[35m        elif fmt == 'e5m2':[0m
[30;1m1297 | [0m[35m            fp8_dtype = torch.float8_e5m2[0m
[30;1m1298 | [0m[35m        else:[0m
[30;1m1299 | [0m[35m            raise TypeError(f'Unsupported fp8 fmt: {fmt}')[0m

[31m--[ [0m[34mMatch #[0m[33m517[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/nn/linear.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1291 | [0m[35m                          quant_dtype=quant_dtype)[0m
[30;1m1292 | [0m[35m    elif quant_method == 'fp8':[0m
[30;1m1293 | [0m[35m        fmt = quant_config.get('fmt', 'e4m3')[0m
[30;1m1294 | [0m[35m        if fmt == 'e4m3':[0m
[30;1m1295 | [0m[35m            fp8_dtype = torch.float8_e4m3fn[0m
[30;1m1296 | [0m[35m        elif fmt == 'e5m2':[0m
[30;1m1297 | [0m[35m            fp8_dtype = torch.float8_e5m2[0m

[31m--[ [0m[34mMatch #[0m[33m518[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/nn/linear.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1290 | [0m[35m                          all_reduce=all_reduce,[0m
[30;1m1291 | [0m[35m                          quant_dtype=quant_dtype)[0m
[30;1m1292 | [0m[35m    elif quant_method == 'fp8':[0m
[30;1m1293 | [0m[35m        fmt = quant_config.get('fmt', 'e4m3')[0m
[30;1m1294 | [0m[35m        if fmt == 'e4m3':[0m
[30;1m1295 | [0m[35m            fp8_dtype = torch.float8_e4m3fn[0m
[30;1m1296 | [0m[35m        elif fmt == 'e5m2':[0m

[31m--[ [0m[34mMatch #[0m[33m519[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m140 | [0m[35m        >>> for output in client.chat('hi', 1):[0m
[30;1m141 | [0m[35m        ...    print(output)[0m
[30;1m142 | [0m[35m    """ # noqa E501[0m
[30;1m143 | [0m[35m    import time[0m
[30;1m144 | [0m[35m    from multiprocessing import Process[0m
[30;1m145 | [0m[35m[0m
[30;1m146 | [0m[35m    from lmdeploy.serve.openai.api_client import APIClient[0m

[31m--[ [0m[34mMatch #[0m[33m520[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m124 | [0m[35m            config instance. Default to none.[0m
[30;1m125 | [0m[35m        chat_template_config (ChatTemplateConfig): chat template configuration.[0m
[30;1m126 | [0m[35m            Default to None.[0m
[30;1m127 | [0m[35m        server_name (str): host ip for serving[0m
[30;1m128 | [0m[35m        server_port (int): server port[0m
[30;1m129 | [0m[35m        log_level(str): set log level whose value among [CRITICAL, ERROR, WARNING, INFO, DEBUG][0m
[30;1m130 | [0m[35m        api_keys (List[str] | str | None): Optional list of API keys. Accepts string type as[0m

[31m--[ [0m[34mMatch #[0m[33m521[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m17 | [0m[35m    logger = get_logger('lmdeploy')[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m    quantization_config = getattr(config.hf_config, 'quantization_config', dict())[0m
[30;1m20 | [0m[35m    quant_method = quantization_config.get('quant_method', None)[0m
[30;1m21 | [0m[35m    if quant_method == 'awq':[0m
[30;1m22 | [0m[35m        logger.debug('set torch_dtype to float16 for awq.')[0m
[30;1m23 | [0m[35m        config.hf_config.torch_dtype = 'float16'[0m

[31m--[ [0m[34mMatch #[0m[33m522[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/config.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m161 | [0m[35m        # should after setting `hf_config` and `model_arch` attributes[0m
[30;1m162 | [0m[35m        model_config = _update_torch_dtype(model_config, dtype)[0m
[30;1m163 | [0m[35m[0m
[30;1m164 | [0m[35m        # update eos_token_id to list[0m
[30;1m165 | [0m[35m        if isinstance(model_config.eos_token_id, int):[0m
[30;1m166 | [0m[35m            model_config.eos_token_id = [model_config.eos_token_id][0m
[30;1m167 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m523[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/config.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m34 | [0m[35m        logger.warning('Model config does not have `torch_dtype`,'[0m
[30;1m35 | [0m[35m                       f' use: {_dtype}')[0m
[30;1m36 | [0m[35m        torch_dtype = _dtype[0m
[30;1m37 | [0m[35m        # update hf_config as well[0m
[30;1m38 | [0m[35m        setattr(config.hf_config, 'torch_dtype', torch_dtype)[0m
[30;1m39 | [0m[35m    else:[0m
[30;1m40 | [0m[35m        # change to user specified data type if it is not 'auto'[0m

[31m--[ [0m[34mMatch #[0m[33m524[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m111 | [0m[35m    use_flash_mla: bool = False[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m    def get_head_size(self):[0m
[30;1m114 | [0m[35m        """get head size."""[0m
[30;1m115 | [0m[35m        return self.head_dim[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m    @classmethod[0m

[31m--[ [0m[34mMatch #[0m[33m525[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/nn/rotary_embedding.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m    # cannot access config.rope_scaling when the model is "Qwen/Qwen2-Math-RM-72B"[0m
[30;1m68 | [0m[35m    rope_scaling = getattr(config, 'rope_scaling', None)[0m
[30;1m69 | [0m[35m    if rope_scaling is not None:[0m
[30;1m70 | [0m[35m        rope_type_str = config.rope_scaling.get('rope_type', 'default')[0m
[30;1m71 | [0m[35m        build_funcs = dict(default=_get_default_rope_parameters,[0m
[30;1m72 | [0m[35m                           linear=_get_linear_scaling_rope_parameters,[0m
[30;1m73 | [0m[35m                           dynamic=_get_dynamic_ntk_parameters,[0m

[31m--[ [0m[34mMatch #[0m[33m526[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/nn/rotary_embedding.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m    scaling_factor = rope_scaling['factor'][0m
[30;1m57 | [0m[35m    params.low_freq_factor = rope_scaling['low_freq_factor'][0m
[30;1m58 | [0m[35m    params.high_freq_factor = rope_scaling['high_freq_factor'][0m
[30;1m59 | [0m[35m    params.original_max_position_embeddings = rope_scaling.get('original_max_position_embeddings',[0m
[30;1m60 | [0m[35m                                                               params.original_max_position_embeddin[0m
[30;1m61 | [0m[35m    return dict(emb_type=RopeType.Llama3, scaling_factor=scaling_factor, llama3_params=params)[0m
[30;1m62 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m527[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/nn/rotary_embedding.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m44 | [0m[35m    scaling_factor = rope_scaling['factor'][0m
[30;1m45 | [0m[35m    params.long_factor = rope_scaling.long_factor[0m
[30;1m46 | [0m[35m    params.short_factor = rope_scaling.long_factor[0m
[30;1m47 | [0m[35m    params.original_max_position_embeddings = rope_scaling.get('original_max_position_embeddings',[0m
[30;1m48 | [0m[35m                                                               config.max_position_embeddings)[0m
[30;1m49 | [0m[35m    return dict(emb_type=RopeType.LongRoPEScaling, scaling_factor=scaling_factor, longrope_params=pa[0m
[30;1m50 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m528[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/nn/rotary_embedding.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m33 | [0m[35m    params = YarnParameters()[0m
[30;1m34 | [0m[35m    params.attention_factor = rope_scaling.get('attention_factor', params.attention_factor)[0m
[30;1m35 | [0m[35m    params.beta_fast = rope_scaling.get('beta_fast', params.beta_fast)[0m
[30;1m36 | [0m[35m    params.beta_slow = rope_scaling.get('beta_slow', params.beta_slow)[0m
[30;1m37 | [0m[35m    return dict(emb_type=RopeType.Yarn, scaling_factor=scaling_factor, yarn_params=params)[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m529[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/nn/rotary_embedding.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m32 | [0m[35m    scaling_factor = rope_scaling['factor'][0m
[30;1m33 | [0m[35m    params = YarnParameters()[0m
[30;1m34 | [0m[35m    params.attention_factor = rope_scaling.get('attention_factor', params.attention_factor)[0m
[30;1m35 | [0m[35m    params.beta_fast = rope_scaling.get('beta_fast', params.beta_fast)[0m
[30;1m36 | [0m[35m    params.beta_slow = rope_scaling.get('beta_slow', params.beta_slow)[0m
[30;1m37 | [0m[35m    return dict(emb_type=RopeType.Yarn, scaling_factor=scaling_factor, yarn_params=params)[0m
[30;1m38 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m530[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/nn/rotary_embedding.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m    rope_scaling = config.rope_scaling[0m
[30;1m32 | [0m[35m    scaling_factor = rope_scaling['factor'][0m
[30;1m33 | [0m[35m    params = YarnParameters()[0m
[30;1m34 | [0m[35m    params.attention_factor = rope_scaling.get('attention_factor', params.attention_factor)[0m
[30;1m35 | [0m[35m    params.beta_fast = rope_scaling.get('beta_fast', params.beta_fast)[0m
[30;1m36 | [0m[35m    params.beta_slow = rope_scaling.get('beta_slow', params.beta_slow)[0m
[30;1m37 | [0m[35m    return dict(emb_type=RopeType.Yarn, scaling_factor=scaling_factor, yarn_params=params)[0m

[31m--[ [0m[34mMatch #[0m[33m531[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35mdef get_cpu_memory() -> int:[0m
[30;1m19 | [0m[35m    """Returns the total CPU memory of the node in bytes."""[0m
[30;1m20 | [0m[35m    return psutil.virtual_memory().total[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m532[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/paging/block_trie.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m148 | [0m[35m            num_matched += block_size[0m
[30;1m149 | [0m[35m            block_id += 1[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35m        logical_blocks.last_shared_node = node[0m
[30;1m152 | [0m[35m        if node.parent is not None and len(node.children) == 0:[0m
[30;1m153 | [0m[35m            # ignore root[0m
[30;1m154 | [0m[35m            self.leaves.add(node)[0m

[31m--[ [0m[34mMatch #[0m[33m533[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/paging/block_trie.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m142 | [0m[35m                free_blocks.append(block)[0m
[30;1m143 | [0m[35m                logical_blocks[block_id] = node.block[0m
[30;1m144 | [0m[35m            else:[0m
[30;1m145 | [0m[35m                node = Node(hash_key=hash_key, block=block, tokens=curr_tokens, num_matched=num_matc[0m
[30;1m146 | [0m[35m                node.parent = parent[0m
[30;1m147 | [0m[35m            blocks.append(node.block)[0m
[30;1m148 | [0m[35m            num_matched += block_size[0m

[31m--[ [0m[34mMatch #[0m[33m534[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/paging/block_trie.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m138 | [0m[35m                child = parent.children[hash_key][0m
[30;1m139 | [0m[35m                if not np.array_equal(curr_tokens, child.tokens):[0m
[30;1m140 | [0m[35m                    break[0m
[30;1m141 | [0m[35m                node = child[0m
[30;1m142 | [0m[35m                free_blocks.append(block)[0m
[30;1m143 | [0m[35m                logical_blocks[block_id] = node.block[0m
[30;1m144 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m535[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/paging/block_trie.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m133 | [0m[35m            block = logical_blocks[block_id][0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m            hash_key = hash(tuple(curr_tokens))[0m
[30;1m136 | [0m[35m            parent = node[0m
[30;1m137 | [0m[35m            if hash_key in parent.children:[0m
[30;1m138 | [0m[35m                child = parent.children[hash_key][0m
[30;1m139 | [0m[35m                if not np.array_equal(curr_tokens, child.tokens):[0m

[31m--[ [0m[34mMatch #[0m[33m536[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/paging/block_trie.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m113 | [0m[35m        node: Node = getattr(logical_blocks, 'last_shared_node', None)[0m
[30;1m114 | [0m[35m        if node is None:[0m
[30;1m115 | [0m[35m            node = self.get_root(seq.adapter_name)[0m
[30;1m116 | [0m[35m            logical_blocks.last_shared_node = node[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m        num_matched = node.num_matched[0m
[30;1m119 | [0m[35m        num_all_ids = seq.num_all_ids[0m

[31m--[ [0m[34mMatch #[0m[33m537[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/paging/block_trie.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m112 | [0m[35m        logical_blocks = seq.logical_blocks[0m
[30;1m113 | [0m[35m        node: Node = getattr(logical_blocks, 'last_shared_node', None)[0m
[30;1m114 | [0m[35m        if node is None:[0m
[30;1m115 | [0m[35m            node = self.get_root(seq.adapter_name)[0m
[30;1m116 | [0m[35m            logical_blocks.last_shared_node = node[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m        num_matched = node.num_matched[0m

[31m--[ [0m[34mMatch #[0m[33m538[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/paging/block_trie.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m111 | [0m[35m        block_size = self.block_size[0m
[30;1m112 | [0m[35m        logical_blocks = seq.logical_blocks[0m
[30;1m113 | [0m[35m        node: Node = getattr(logical_blocks, 'last_shared_node', None)[0m
[30;1m114 | [0m[35m        if node is None:[0m
[30;1m115 | [0m[35m            node = self.get_root(seq.adapter_name)[0m
[30;1m116 | [0m[35m            logical_blocks.last_shared_node = node[0m
[30;1m117 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m539[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/paging/block_trie.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m        block_size = self.block_size[0m
[30;1m112 | [0m[35m        logical_blocks = seq.logical_blocks[0m
[30;1m113 | [0m[35m        node: Node = getattr(logical_blocks, 'last_shared_node', None)[0m
[30;1m114 | [0m[35m        if node is None:[0m
[30;1m115 | [0m[35m            node = self.get_root(seq.adapter_name)[0m
[30;1m116 | [0m[35m            logical_blocks.last_shared_node = node[0m

[31m--[ [0m[34mMatch #[0m[33m540[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/paging/block_trie.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m78 | [0m[35m        def __match_success(node: Node):[0m
[30;1m79 | [0m[35m            nonlocal curr, num_matched[0m
[30;1m80 | [0m[35m            matched_blocks.append(node.block)[0m
[30;1m81 | [0m[35m            curr = node[0m
[30;1m82 | [0m[35m            num_matched += block_size[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m        while num_matched + block_size < seq.num_all_ids:[0m

[31m--[ [0m[34mMatch #[0m[33m541[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/paging/block_trie.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m70 | [0m[35m        matched_blocks = [][0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m        logical_blocks = seq.logical_blocks[0m
[30;1m73 | [0m[35m        curr: Node = getattr(logical_blocks, 'last_shared_node', None)[0m
[30;1m74 | [0m[35m        if curr is None:[0m
[30;1m75 | [0m[35m            curr = self.get_root(seq.adapter_name)[0m
[30;1m76 | [0m[35m        num_matched = curr.num_matched[0m

[31m--[ [0m[34mMatch #[0m[33m542[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/archs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m183 | [0m[35m                        arch = 'InternLMXComposer2ForCausalLM'[0m
[30;1m184 | [0m[35m        elif _cfg.get('auto_map', None) and 'AutoModelForCausalLM' in _cfg['auto_map']:[0m
[30;1m185 | [0m[35m            arch = _cfg['auto_map']['AutoModelForCausalLM'].split('.')[-1][0m
[30;1m186 | [0m[35m        elif _cfg.get('language_config', None) and _cfg['language_config'].get([0m
[30;1m187 | [0m[35m                'auto_map', None) and 'AutoModelForCausalLM' in _cfg['language_config']['auto_map']:[0m
[30;1m188 | [0m[35m            arch = _cfg['language_config']['auto_map']['AutoModelForCausalLM'].split('.')[-1][0m
[30;1m189 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m543[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/archs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m183 | [0m[35m                        arch = 'InternLMXComposer2ForCausalLM'[0m
[30;1m184 | [0m[35m        elif _cfg.get('auto_map', None) and 'AutoModelForCausalLM' in _cfg['auto_map']:[0m
[30;1m185 | [0m[35m            arch = _cfg['auto_map']['AutoModelForCausalLM'].split('.')[-1][0m
[30;1m186 | [0m[35m        elif _cfg.get('language_config', None) and _cfg['language_config'].get([0m
[30;1m187 | [0m[35m                'auto_map', None) and 'AutoModelForCausalLM' in _cfg['language_config']['auto_map']:[0m
[30;1m188 | [0m[35m            arch = _cfg['language_config']['auto_map']['AutoModelForCausalLM'].split('.')[-1][0m
[30;1m189 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m544[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/archs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m181 | [0m[35m                for _, v in _cfg['auto_map'].items():[0m
[30;1m182 | [0m[35m                    if 'InternLMXComposer2ForCausalLM' in v:[0m
[30;1m183 | [0m[35m                        arch = 'InternLMXComposer2ForCausalLM'[0m
[30;1m184 | [0m[35m        elif _cfg.get('auto_map', None) and 'AutoModelForCausalLM' in _cfg['auto_map']:[0m
[30;1m185 | [0m[35m            arch = _cfg['auto_map']['AutoModelForCausalLM'].split('.')[-1][0m
[30;1m186 | [0m[35m        elif _cfg.get('language_config', None) and _cfg['language_config'].get([0m
[30;1m187 | [0m[35m                'auto_map', None) and 'AutoModelForCausalLM' in _cfg['language_config']['auto_map']:[0m

[31m--[ [0m[34mMatch #[0m[33m545[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/archs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m177 | [0m[35m        _cfg = cfg.to_dict()[0m
[30;1m178 | [0m[35m        if _cfg.get('architectures', None):[0m
[30;1m179 | [0m[35m            arch = _cfg['architectures'][0][0m
[30;1m180 | [0m[35m            if _cfg.get('auto_map'):[0m
[30;1m181 | [0m[35m                for _, v in _cfg['auto_map'].items():[0m
[30;1m182 | [0m[35m                    if 'InternLMXComposer2ForCausalLM' in v:[0m
[30;1m183 | [0m[35m                        arch = 'InternLMXComposer2ForCausalLM'[0m

[31m--[ [0m[34mMatch #[0m[33m546[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/archs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m175 | [0m[35m            cfg = PretrainedConfig.from_pretrained(model_path, trust_remote_code=True)[0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m        _cfg = cfg.to_dict()[0m
[30;1m178 | [0m[35m        if _cfg.get('architectures', None):[0m
[30;1m179 | [0m[35m            arch = _cfg['architectures'][0][0m
[30;1m180 | [0m[35m            if _cfg.get('auto_map'):[0m
[30;1m181 | [0m[35m                for _, v in _cfg['auto_map'].items():[0m

[31m--[ [0m[34mMatch #[0m[33m547[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/archs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m110 | [0m[35m            if 'InternLMXComposer2ForCausalLM' in v:[0m
[30;1m111 | [0m[35m                return True[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m    if 'language_config' in config and 'vision_config' in config and config['language_config'].get([0m
[30;1m114 | [0m[35m            'architectures', [None])[0] == 'DeepseekV2ForCausalLM':[0m
[30;1m115 | [0m[35m        return True[0m
[30;1m116 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m548[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/archs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m187 | [0m[35m                'auto_map', None) and 'AutoModelForCausalLM' in _cfg['language_config']['auto_map']:[0m
[30;1m188 | [0m[35m            arch = _cfg['language_config']['auto_map']['AutoModelForCausalLM'].split('.')[-1][0m
[30;1m189 | [0m[35m        else:[0m
[30;1m190 | [0m[35m            raise RuntimeError(f'Could not find model architecture from config: {_cfg}')[0m
[30;1m191 | [0m[35m        return arch, cfg[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m549[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/nn/moe.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m504 | [0m[35m            enable_ep=enable_ep,[0m
[30;1m505 | [0m[35m        )[0m
[30;1m506 | [0m[35m    elif quant_method == 'fp8':[0m
[30;1m507 | [0m[35m        fmt = quant_config.get('fmt', 'e4m3')[0m
[30;1m508 | [0m[35m        if fmt == 'e4m3':[0m
[30;1m509 | [0m[35m            fp8_dtype = torch.float8_e4m3fn[0m
[30;1m510 | [0m[35m        elif fmt == 'e5m2':[0m

[31m--[ [0m[34mMatch #[0m[33m550[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/nn/moe.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m490 | [0m[35m[0m
[30;1m491 | [0m[35m    quant_method = quant_config['quant_method'][0m
[30;1m492 | [0m[35m    if quant_method == 'smooth_quant':[0m
[30;1m493 | [0m[35m        quant_dtype = eval('torch.' + quant_config.get('quant_dtype', 'int8'))[0m
[30;1m494 | [0m[35m        return FusedMoEW8A8([0m
[30;1m495 | [0m[35m            hidden_dim=hidden_dim,[0m
[30;1m496 | [0m[35m            ffn_dim=ffn_dim,[0m

[31m--[ [0m[34mMatch #[0m[33m551[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/nn/moe.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m507 | [0m[35m        fmt = quant_config.get('fmt', 'e4m3')[0m
[30;1m508 | [0m[35m        if fmt == 'e4m3':[0m
[30;1m509 | [0m[35m            fp8_dtype = torch.float8_e4m3fn[0m
[30;1m510 | [0m[35m        elif fmt == 'e5m2':[0m
[30;1m511 | [0m[35m            fp8_dtype = torch.float8_e5m2[0m
[30;1m512 | [0m[35m        else:[0m
[30;1m513 | [0m[35m            raise TypeError(f'Unsupported fp8 fmt: {fmt}')[0m

[31m--[ [0m[34mMatch #[0m[33m552[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/nn/moe.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m505 | [0m[35m        )[0m
[30;1m506 | [0m[35m    elif quant_method == 'fp8':[0m
[30;1m507 | [0m[35m        fmt = quant_config.get('fmt', 'e4m3')[0m
[30;1m508 | [0m[35m        if fmt == 'e4m3':[0m
[30;1m509 | [0m[35m            fp8_dtype = torch.float8_e4m3fn[0m
[30;1m510 | [0m[35m        elif fmt == 'e5m2':[0m
[30;1m511 | [0m[35m            fp8_dtype = torch.float8_e5m2[0m

[31m--[ [0m[34mMatch #[0m[33m553[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/nn/moe.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m504 | [0m[35m            enable_ep=enable_ep,[0m
[30;1m505 | [0m[35m        )[0m
[30;1m506 | [0m[35m    elif quant_method == 'fp8':[0m
[30;1m507 | [0m[35m        fmt = quant_config.get('fmt', 'e4m3')[0m
[30;1m508 | [0m[35m        if fmt == 'e4m3':[0m
[30;1m509 | [0m[35m            fp8_dtype = torch.float8_e4m3fn[0m
[30;1m510 | [0m[35m        elif fmt == 'e5m2':[0m

[31m--[ [0m[34mMatch #[0m[33m554[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/profiler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# Copyright (c) OpenMMLab. All rights reserved.[0m
[30;1m2 | [0m[35mimport csv[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mfrom typing import List[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mimport numpy as np[0m

[31m--[ [0m[34mMatch #[0m[33m555[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/logits_process.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m99 | [0m[35m                                     'either a dictionary or a string that contains the'[0m
[30;1m100 | [0m[35m                                     ' JSON Schema specification')[0m
[30;1m101 | [0m[35m            elif _format['type'] == 'regex_schema':[0m
[30;1m102 | [0m[35m                schema = _format.get('regex_schema', '')[0m
[30;1m103 | [0m[35m            else:[0m
[30;1m104 | [0m[35m                raise ValueError(f"unsupported format type: {_format['type']}")[0m
[30;1m105 | [0m[35m            from .guided_process import _get_guided_logits_processor[0m

[31m--[ [0m[34mMatch #[0m[33m556[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/logits_process.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m84 | [0m[35m        return scores[0m
[30;1m85 | [0m[35m    for i in range(len(response_formats)):[0m
[30;1m86 | [0m[35m        _format = response_formats[i][0m
[30;1m87 | [0m[35m        if isinstance(_format, Dict) and _format.get('type', 'text') != 'text':[0m
[30;1m88 | [0m[35m            if _format['type'] == 'json_schema':[0m
[30;1m89 | [0m[35m                schema = _format['json_schema'][0m
[30;1m90 | [0m[35m                if isinstance(schema, Dict):[0m

[31m--[ [0m[34mMatch #[0m[33m557[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/logits_process.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m54 | [0m[35m    softmax_scores = scores.softmax(-1)[0m
[30;1m55 | [0m[35m    cum_scores = softmax_scores.cumsum(1) - softmax_scores[0m
[30;1m56 | [0m[35m    mask = cum_scores > topp[:, None][0m
[30;1m57 | [0m[35m    mask[:, 0] = False  # keep at least one[0m
[30;1m58 | [0m[35m    scores.masked_fill_(mask, filter_value)[0m
[30;1m59 | [0m[35m    return scores[0m
[30;1m60 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m558[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/logits_process.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m372 | [0m[35m        if sampling_inputs.max_top_k == 1:[0m
[30;1m373 | [0m[35m            return logits.argmax(-1)[0m
[30;1m374 | [0m[35m        else:[0m
[30;1m375 | [0m[35m            # sort logits is too slow. and we only need topk logits[0m
[30;1m376 | [0m[35m            max_topk = sampling_inputs.max_top_k[0m
[30;1m377 | [0m[35m            if max_topk <= 0:[0m
[30;1m378 | [0m[35m                scores, indices = logits.sort(1, descending=True)[0m

[31m--[ [0m[34mMatch #[0m[33m559[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m23 | [0m[35m        _log_info(message)[0m
[30;1m24 | [0m[35m        return executor_backend[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    executor_backend = os.environ.get('LMDEPLOY_EXECUTOR_BACKEND', None)[0m
[30;1m27 | [0m[35m    if executor_backend is not None:[0m
[30;1m28 | [0m[35m        return _log_and_set_backend('found environment LMDEPLOY_EXECUTOR_BACKEND.', executor_backend[0m
[30;1m29 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m560[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35m    if os.name == 'nt' and has_turbomind:[0m
[30;1m13 | [0m[35m        if sys.version_info[:2] >= (3, 8):[0m
[30;1m14 | [0m[35m            CUDA_PATH = os.getenv('CUDA_PATH')[0m
[30;1m15 | [0m[35m            assert CUDA_PATH is not None, 'Can not find $env:CUDA_PATH'[0m
[30;1m16 | [0m[35m            dll_path = os.path.join(CUDA_PATH, 'bin')[0m
[30;1m17 | [0m[35m            print(f'Add dll path {dll_path}, please note cuda version '[0m
[30;1m18 | [0m[35m                  'should >= 11.3 when compiled with cuda 11')[0m

[31m--[ [0m[34mMatch #[0m[33m561[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/ray_executor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m357 | [0m[35m        device_str = get_device_str()[0m
[30;1m358 | [0m[35m        bundle_indices = [][0m
[30;1m359 | [0m[35m        for bundle_id, bundle in enumerate(placement_group.bundle_specs):[0m
[30;1m360 | [0m[35m            if bundle.get(device_str, 0):[0m
[30;1m361 | [0m[35m                bundle_indices.append(bundle_id)[0m
[30;1m362 | [0m[35m        bundle_indices = bundle_indices[:self.world_size][0m
[30;1m363 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m562[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/ray_executor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m328 | [0m[35m[0m
[30;1m329 | [0m[35m        ip_counts: Dict[str, int] = {}[0m
[30;1m330 | [0m[35m        for ip in worker_ips:[0m
[30;1m331 | [0m[35m            ip_counts[ip] = ip_counts.get(ip, 0) + 1[0m
[30;1m332 | [0m[35m[0m
[30;1m333 | [0m[35m        worker_ip_map = list(zip(workers, worker_ips))[0m
[30;1m334 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m563[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/ray_executor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m324 | [0m[35m[0m
[30;1m325 | [0m[35m    def _sort_workers(self, driver_ip: str, workers: List[RayWorkerWrapper]):[0m
[30;1m326 | [0m[35m        """sort workers by ip."""[0m
[30;1m327 | [0m[35m        worker_ips = ray.get([worker.get_node_ip.remote() for worker in workers])[0m
[30;1m328 | [0m[35m[0m
[30;1m329 | [0m[35m        ip_counts: Dict[str, int] = {}[0m
[30;1m330 | [0m[35m        for ip in worker_ips:[0m

[31m--[ [0m[34mMatch #[0m[33m564[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/ray_executor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m320 | [0m[35m        """get output async."""[0m
[30;1m321 | [0m[35m        if self.remote_outs.qsize() > 0:[0m
[30;1m322 | [0m[35m            return self.remote_outs.get_nowait()[0m
[30;1m323 | [0m[35m        return await self.remote_outs.get()[0m
[30;1m324 | [0m[35m[0m
[30;1m325 | [0m[35m    def _sort_workers(self, driver_ip: str, workers: List[RayWorkerWrapper]):[0m
[30;1m326 | [0m[35m        """sort workers by ip."""[0m

[31m--[ [0m[34mMatch #[0m[33m565[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/ray_executor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m264 | [0m[35m[0m
[30;1m265 | [0m[35m    def get_input_processor(self):[0m
[30;1m266 | [0m[35m        """build cache engine."""[0m
[30;1m267 | [0m[35m        return ray.get(self.workers[0].get_input_processor.remote())[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m    async def _prefetch_outputs(self):[0m
[30;1m270 | [0m[35m        while True:[0m

[31m--[ [0m[34mMatch #[0m[33m566[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/ray_executor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m236 | [0m[35m            args = list()[0m
[30;1m237 | [0m[35m        if kwargs is None:[0m
[30;1m238 | [0m[35m            kwargs = dict()[0m
[30;1m239 | [0m[35m        return ray.get([getattr(worker, method).remote(*args, **kwargs) for worker in self.workers])[0m
[30;1m240 | [0m[35m[0m
[30;1m241 | [0m[35m    def build_model(self):[0m
[30;1m242 | [0m[35m        """build model."""[0m

[31m--[ [0m[34mMatch #[0m[33m567[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/ray_executor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m228 | [0m[35m[0m
[30;1m229 | [0m[35m        if self.world_size > 1:[0m
[30;1m230 | [0m[35m            logger.info('Warming up distribute environment, this might take long time, please waitin[0m
[30;1m231 | [0m[35m            ray.get([worker.warmup_dist.remote() for worker in self.workers])[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m    def collective_rpc(self, method: str, args: Tuple[Any] = None, kwargs: Dict[str, Any] = None):[0m
[30;1m234 | [0m[35m        """collective rpc."""[0m

[31m--[ [0m[34mMatch #[0m[33m568[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/ray_executor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m221 | [0m[35m        self.remote_outs: asyncio.Queue = None[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m        logger.info('Init distributed process group.')[0m
[30;1m224 | [0m[35m        ray.get([[0m
[30;1m225 | [0m[35m            worker.init_process_group.remote(rank, self.master_addr, self.master_port)[0m
[30;1m226 | [0m[35m            for rank, worker in enumerate(self.workers)[0m
[30;1m227 | [0m[35m        ])[0m

[31m--[ [0m[34mMatch #[0m[33m569[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/ray_executor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m80 | [0m[35m    # Create placement group for worker processes[0m
[30;1m81 | [0m[35m    current_placement_group = ray.util.get_current_placement_group()[0m
[30;1m82 | [0m[35m    if not current_placement_group:[0m
[30;1m83 | [0m[35m        num_devices_in_cluster = ray.cluster_resources().get(device_str, 0)[0m
[30;1m84 | [0m[35m        if world_size > num_devices_in_cluster:[0m
[30;1m85 | [0m[35m            logger.warning([0m
[30;1m86 | [0m[35m                'The number of required %ss exceeds the total '[0m

[31m--[ [0m[34mMatch #[0m[33m570[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/ray_executor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m            ' specified in each node if you are running on a multi-node.', int(time.time() - s), pla[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m    try:[0m
[30;1m65 | [0m[35m        ray.get(pg_ready_ref, timeout=0)[0m
[30;1m66 | [0m[35m    except ray.exceptions.GetTimeoutError:[0m
[30;1m67 | [0m[35m        raise ValueError('Cannot provide a placement group of '[0m
[30;1m68 | [0m[35m                         f'{placement_group_specs=} within {PG_WAIT_TIMEOUT} seconds. See '[0m

[31m--[ [0m[34mMatch #[0m[33m571[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/ray_executor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m91 | [0m[35m        # gcs_addr = ray.get_runtime_context().gcs_address[0m
[30;1m92 | [0m[35m        # master_addr = gcs_addr.split(':')[0][0m
[30;1m93 | [0m[35m        # current_ip = master_addr[0m
[30;1m94 | [0m[35m        # # This way, at least bundle is required to be created in a current[0m
[30;1m95 | [0m[35m        # # node.[0m
[30;1m96 | [0m[35m        # placement_group_specs[0][f'node:{current_ip}'] = 0.001[0m
[30;1m97 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m572[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/ray_executor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m347 | [0m[35m[0m
[30;1m348 | [0m[35m        # After sorting, the workers on the same node will be[0m
[30;1m349 | [0m[35m        # close to each other, and the workers on the driver[0m
[30;1m350 | [0m[35m        # node will be placed first.[0m
[30;1m351 | [0m[35m        sorted_worker_ip_map = sorted(worker_ip_map, key=sort_by_driver_then_worker_ip)[0m
[30;1m352 | [0m[35m        workers = [item[0] for item in sorted_worker_ip_map][0m
[30;1m353 | [0m[35m        return workers[0m

[31m--[ [0m[34mMatch #[0m[33m573[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/ray_executor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m345 | [0m[35m            ip = item[1][0m
[30;1m346 | [0m[35m            return (0 if ip == driver_ip else 1, ip_counts[ip], ip)[0m
[30;1m347 | [0m[35m[0m
[30;1m348 | [0m[35m        # After sorting, the workers on the same node will be[0m
[30;1m349 | [0m[35m        # close to each other, and the workers on the driver[0m
[30;1m350 | [0m[35m        # node will be placed first.[0m
[30;1m351 | [0m[35m        sorted_worker_ip_map = sorted(worker_ip_map, key=sort_by_driver_then_worker_ip)[0m

[31m--[ [0m[34mMatch #[0m[33m574[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/ray_executor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m343 | [0m[35m                should be placed first.[0m
[30;1m344 | [0m[35m            """[0m
[30;1m345 | [0m[35m            ip = item[1][0m
[30;1m346 | [0m[35m            return (0 if ip == driver_ip else 1, ip_counts[ip], ip)[0m
[30;1m347 | [0m[35m[0m
[30;1m348 | [0m[35m        # After sorting, the workers on the same node will be[0m
[30;1m349 | [0m[35m        # close to each other, and the workers on the driver[0m

[31m--[ [0m[34mMatch #[0m[33m575[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/ray_executor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m342 | [0m[35m            3. Finally, if the work is on a node with smaller IP address, it[0m
[30;1m343 | [0m[35m                should be placed first.[0m
[30;1m344 | [0m[35m            """[0m
[30;1m345 | [0m[35m            ip = item[1][0m
[30;1m346 | [0m[35m            return (0 if ip == driver_ip else 1, ip_counts[ip], ip)[0m
[30;1m347 | [0m[35m[0m
[30;1m348 | [0m[35m        # After sorting, the workers on the same node will be[0m

[31m--[ [0m[34mMatch #[0m[33m576[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/ray_executor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m339 | [0m[35m                it should be placed first.[0m
[30;1m340 | [0m[35m            2. Then, if the worker is on a node with fewer workers, it should[0m
[30;1m341 | [0m[35m                be placed first.[0m
[30;1m342 | [0m[35m            3. Finally, if the work is on a node with smaller IP address, it[0m
[30;1m343 | [0m[35m                should be placed first.[0m
[30;1m344 | [0m[35m            """[0m
[30;1m345 | [0m[35m            ip = item[1][0m

[31m--[ [0m[34mMatch #[0m[33m577[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/ray_executor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m339 | [0m[35m                it should be placed first.[0m
[30;1m340 | [0m[35m            2. Then, if the worker is on a node with fewer workers, it should[0m
[30;1m341 | [0m[35m                be placed first.[0m
[30;1m342 | [0m[35m            3. Finally, if the work is on a node with smaller IP address, it[0m
[30;1m343 | [0m[35m                should be placed first.[0m
[30;1m344 | [0m[35m            """[0m
[30;1m345 | [0m[35m            ip = item[1][0m

[31m--[ [0m[34mMatch #[0m[33m578[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/ray_executor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m337 | [0m[35m[0m
[30;1m338 | [0m[35m            1. If the worker is on the same node as the driver (vllm engine),[0m
[30;1m339 | [0m[35m                it should be placed first.[0m
[30;1m340 | [0m[35m            2. Then, if the worker is on a node with fewer workers, it should[0m
[30;1m341 | [0m[35m                be placed first.[0m
[30;1m342 | [0m[35m            3. Finally, if the work is on a node with smaller IP address, it[0m
[30;1m343 | [0m[35m                should be placed first.[0m

[31m--[ [0m[34mMatch #[0m[33m579[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/ray_executor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m335 | [0m[35m        def sort_by_driver_then_worker_ip(item):[0m
[30;1m336 | [0m[35m            """Sort the workers based on 3 properties:[0m
[30;1m337 | [0m[35m[0m
[30;1m338 | [0m[35m            1. If the worker is on the same node as the driver (vllm engine),[0m
[30;1m339 | [0m[35m                it should be placed first.[0m
[30;1m340 | [0m[35m            2. Then, if the worker is on a node with fewer workers, it should[0m
[30;1m341 | [0m[35m                be placed first.[0m

[31m--[ [0m[34mMatch #[0m[33m580[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/ray_executor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m327 | [0m[35m        worker_ips = ray.get([worker.get_node_ip.remote() for worker in workers])[0m
[30;1m328 | [0m[35m[0m
[30;1m329 | [0m[35m        ip_counts: Dict[str, int] = {}[0m
[30;1m330 | [0m[35m        for ip in worker_ips:[0m
[30;1m331 | [0m[35m            ip_counts[ip] = ip_counts.get(ip, 0) + 1[0m
[30;1m332 | [0m[35m[0m
[30;1m333 | [0m[35m        worker_ip_map = list(zip(workers, worker_ips))[0m

[31m--[ [0m[34mMatch #[0m[33m581[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/ray_executor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m148 | [0m[35m        return self.node_ip[0m
[30;1m149 | [0m[35m[0m
[30;1m150 | [0m[35m    def warmup_dist(self):[0m
[30;1m151 | [0m[35m        # None default CUDA_VISIBLE_DEVICES might leads to slow first time all_reduce[0m
[30;1m152 | [0m[35m        # WHY?[0m
[30;1m153 | [0m[35m        logger.debug('Warmup all_reduce.')[0m
[30;1m154 | [0m[35m        import torch[0m

[31m--[ [0m[34mMatch #[0m[33m582[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/ray_executor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m59 | [0m[35m            '`ray status` to see if you have enough resources,'[0m
[30;1m60 | [0m[35m            ' and make sure the IP addresses used by ray cluster'[0m
[30;1m61 | [0m[35m            ' are the same as VLLM_HOST_IP environment variable'[0m
[30;1m62 | [0m[35m            ' specified in each node if you are running on a multi-node.', int(time.time() - s), pla[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m    try:[0m
[30;1m65 | [0m[35m        ray.get(pg_ready_ref, timeout=0)[0m

[31m--[ [0m[34mMatch #[0m[33m583[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/ray_executor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35m            'Waiting for creating a placement group of specs for '[0m
[30;1m58 | [0m[35m            '%d seconds. specs=%s. Check '[0m
[30;1m59 | [0m[35m            '`ray status` to see if you have enough resources,'[0m
[30;1m60 | [0m[35m            ' and make sure the IP addresses used by ray cluster'[0m
[30;1m61 | [0m[35m            ' are the same as VLLM_HOST_IP environment variable'[0m
[30;1m62 | [0m[35m            ' specified in each node if you are running on a multi-node.', int(time.time() - s), pla[0m
[30;1m63 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m584[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/ray_executor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35m    """[0m
[30;1m40 | [0m[35m    # copy from vLLM[0m
[30;1m41 | [0m[35m    # Wait until PG is ready - this will block until all[0m
[30;1m42 | [0m[35m    # requested resources are available, and will timeout[0m
[30;1m43 | [0m[35m    # if they cannot be provisioned.[0m
[30;1m44 | [0m[35m    placement_group_specs = current_placement_group.bundle_specs[0m
[30;1m45 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m585[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/ray_executor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35m    It prints the informative log messages if the placement group is not created within time.[0m
[30;1m39 | [0m[35m    """[0m
[30;1m40 | [0m[35m    # copy from vLLM[0m
[30;1m41 | [0m[35m    # Wait until PG is ready - this will block until all[0m
[30;1m42 | [0m[35m    # requested resources are available, and will timeout[0m
[30;1m43 | [0m[35m    # if they cannot be provisioned.[0m
[30;1m44 | [0m[35m    placement_group_specs = current_placement_group.bundle_specs[0m

[31m--[ [0m[34mMatch #[0m[33m586[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/engine/executor/ray_executor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# Copyright (c) OpenMMLab. All rights reserved.[0m
[30;1m2 | [0m[35mimport asyncio[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mfrom typing import Any, Dict, List, Tuple[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mimport numpy as np[0m

[31m--[ [0m[34mMatch #[0m[33m587[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m38 | [0m[35m            # windows does not support ASNI color[0m
[30;1m39 | [0m[35m            return super().format(record)[0m
[30;1m40 | [0m[35m        levelname = record.levelname[0m
[30;1m41 | [0m[35m        level_color = self._LEVELNAME_COLOR_MAP.get(levelname, self._RESET_COLOR)[0m
[30;1m42 | [0m[35m        levelname = f'{level_color}{levelname}{self._RESET_COLOR}'[0m
[30;1m43 | [0m[35m        record.levelname = levelname[0m
[30;1m44 | [0m[35m        return super().format(record)[0m

[31m--[ [0m[34mMatch #[0m[33m588[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35mclass _ASNI_COLOR:[0m
[30;1m17 | [0m[35m    BRIGHT_RED = '\033[91m'[0m
[30;1m18 | [0m[35m    RED = '\033[31m'[0m
[30;1m19 | [0m[35m    YELLOW = '\033[33m'[0m
[30;1m20 | [0m[35m    WHITE = '\033[37m'[0m
[30;1m21 | [0m[35m    GREEN = '\033[32m'[0m

[31m--[ [0m[34mMatch #[0m[33m589[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mimport functools[0m
[30;1m4 | [0m[35mimport logging[0m
[30;1m5 | [0m[35mimport sys[0m
[30;1m6 | [0m[35mimport time[0m
[30;1m7 | [0m[35mfrom contextlib import contextmanager[0m
[30;1m8 | [0m[35mfrom logging import Logger, LogRecord[0m
[30;1m9 | [0m[35mfrom typing import List, Optional, TypeVar, Union[0m

[31m--[ [0m[34mMatch #[0m[33m590[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/nn/norm.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m18 | [0m[35m        quant_method = quant_config['quant_method'][0m
[30;1m19 | [0m[35m        if quant_method == 'smooth_quant':[0m
[30;1m20 | [0m[35m            w8a8_flag = True[0m
[30;1m21 | [0m[35m            quant_dtype = quant_config.get('quant_dtype', 'int8')[0m
[30;1m22 | [0m[35m            quant_dtype = eval(f'torch.{quant_dtype}')[0m
[30;1m23 | [0m[35m    return w8a8_flag, quant_dtype[0m
[30;1m24 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m591[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/vl/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m        if isinstance(image_url, Image.Image):[0m
[30;1m63 | [0m[35m            img = image_url[0m
[30;1m64 | [0m[35m        elif image_url.startswith('http'):[0m
[30;1m65 | [0m[35m            response = requests.get(image_url, headers=headers, timeout=FETCH_TIMEOUT)[0m
[30;1m66 | [0m[35m            response.raise_for_status()[0m
[30;1m67 | [0m[35m            img = Image.open(BytesIO(response.content))[0m
[30;1m68 | [0m[35m        elif image_url.startswith('data:image'):[0m

[31m--[ [0m[34mMatch #[0m[33m592[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/vl/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35mdef load_image(image_url: Union[str, Image.Image]) -> Image.Image:[0m
[30;1m53 | [0m[35m    """load image from url, local path or openai GPT4V."""[0m
[30;1m54 | [0m[35m    FETCH_TIMEOUT = int(os.environ.get('LMDEPLOY_FETCH_TIMEOUT', 10))[0m
[30;1m55 | [0m[35m    headers = {[0m
[30;1m56 | [0m[35m        'User-Agent':[0m
[30;1m57 | [0m[35m        'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 '[0m

[31m--[ [0m[34mMatch #[0m[33m593[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/vl/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m        if isinstance(image, str):[0m
[30;1m26 | [0m[35m            url_or_path = image[0m
[30;1m27 | [0m[35m            if url_or_path.startswith('http'):[0m
[30;1m28 | [0m[35m                response = requests.get(url_or_path, headers=headers, timeout=FETCH_TIMEOUT)[0m
[30;1m29 | [0m[35m                response.raise_for_status()[0m
[30;1m30 | [0m[35m                buffered.write(response.content)[0m
[30;1m31 | [0m[35m            elif os.path.exists(url_or_path):[0m

[31m--[ [0m[34mMatch #[0m[33m594[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/vl/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m15 | [0m[35mdef encode_image_base64(image: Union[str, Image.Image]) -> str:[0m
[30;1m16 | [0m[35m    """encode raw date to base64 format."""[0m
[30;1m17 | [0m[35m    buffered = BytesIO()[0m
[30;1m18 | [0m[35m    FETCH_TIMEOUT = int(os.environ.get('LMDEPLOY_FETCH_TIMEOUT', 10))[0m
[30;1m19 | [0m[35m    headers = {[0m
[30;1m20 | [0m[35m        'User-Agent':[0m
[30;1m21 | [0m[35m        'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 '[0m

[31m--[ [0m[34mMatch #[0m[33m595[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/vl/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35mdef load_image_from_base64(image: Union[bytes, str]) -> Image.Image:[0m
[30;1m48 | [0m[35m    """load image from base64 format."""[0m
[30;1m49 | [0m[35m    return Image.open(BytesIO(base64.b64decode(image)))[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m596[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/vl/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mdef encode_image_base64(image: Union[str, Image.Image]) -> str:[0m
[30;1m16 | [0m[35m    """encode raw date to base64 format."""[0m
[30;1m17 | [0m[35m    buffered = BytesIO()[0m
[30;1m18 | [0m[35m    FETCH_TIMEOUT = int(os.environ.get('LMDEPLOY_FETCH_TIMEOUT', 10))[0m
[30;1m19 | [0m[35m    headers = {[0m

[31m--[ [0m[34mMatch #[0m[33m597[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/vl/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# Copyright (c) OpenMMLab. All rights reserved.[0m
[30;1m2 | [0m[35mimport base64[0m
[30;1m3 | [0m[35mimport os[0m
[30;1m4 | [0m[35mfrom io import BytesIO[0m
[30;1m5 | [0m[35mfrom typing import Union[0m

[31m--[ [0m[34mMatch #[0m[33m598[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/qwen.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m134 | [0m[35m        return (*result, )[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m    def moe_ffn_shared_gate(self, i):[0m
[30;1m137 | [0m[35m        return self.params.get(f'model.layers.{i}.mlp.shared_expert_gate.weight')[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35m@INPUT_MODELS.register_module(name='qwen2-moe')[0m

[31m--[ [0m[34mMatch #[0m[33m599[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/qwen.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m120 | [0m[35m        return (*result, )[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m    def moe_ffn_gate(self, i):[0m
[30;1m123 | [0m[35m        return self.params.get(f'model.layers.{i}.mlp.gate.weight')[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m    def _ffn(self, i: int, kind: str):[0m
[30;1m126 | [0m[35m        """Get ffn kind for layer i."""[0m

[31m--[ [0m[34mMatch #[0m[33m600[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/qwen.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m114 | [0m[35m        result = [][0m
[30;1m115 | [0m[35m        for key in ['gate', 'down', 'up']:[0m
[30;1m116 | [0m[35m            name = f'model.layers.{i}.mlp.experts.{e}.{key}_proj.{kind}'[0m
[30;1m117 | [0m[35m            tensor = self.params.get(name)[0m
[30;1m118 | [0m[35m            tensor = self.transform(tensor, kind)[0m
[30;1m119 | [0m[35m            result.append(tensor)[0m
[30;1m120 | [0m[35m        return (*result, )[0m

[31m--[ [0m[34mMatch #[0m[33m601[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/qwen.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m            hidden_units = config['hidden_size'][0m
[30;1m65 | [0m[35m            num_layer = config['num_hidden_layers'][0m
[30;1m66 | [0m[35m            norm_eps = config['layer_norm_epsilon'][0m
[30;1m67 | [0m[35m            rope_theta = float(config.get('rotary_emb_base', 10000.0))[0m
[30;1m68 | [0m[35m            if 'num_key_value_heads' in config:[0m
[30;1m69 | [0m[35m                kv_head_num = config['num_key_value_heads'][0m
[30;1m70 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m602[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/turbomind/deploy/source_model/qwen.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35m        qkv = self.transform(qkv, kind)[0m
[30;1m27 | [0m[35m        if qkv is not None:[0m
[30;1m28 | [0m[35m            q, k, v = torch.split(qkv, qkv.size(0) // 3, dim=0)[0m
[30;1m29 | [0m[35m        o = self.params.get(f'transformer.h.{i}.attn.c_proj.{kind}')[0m
[30;1m30 | [0m[35m        o = self.transform(o, kind)[0m
[30;1m31 | [0m[35m        if o is None:[0m
[30;1m32 | [0m[35m            o = torch.zeros_like(q)[0m

[31m--[ [0m[34mMatch #[0m[33m603[0m[34m of [0m[33m603[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/lmdeploy/pytorch/supported_models.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m125 | [0m[35m        elif hasattr(cfg, 'auto_map') and 'AutoModelForCausalLM' in cfg.auto_map:[0m
[30;1m126 | [0m[35m            arch = cfg.auto_map['AutoModelForCausalLM'].split('.')[-1][0m
[30;1m127 | [0m[35m        else:[0m
[30;1m128 | [0m[35m            raise RuntimeError(f'Could not find model architecture from config: {cfg}')[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m        if arch in _SUPPORTED_ARCHS:[0m
[30;1m131 | [0m[35m            support_by_torch = _SUPPORTED_ARCHS[arch][0m

603 matches found.
