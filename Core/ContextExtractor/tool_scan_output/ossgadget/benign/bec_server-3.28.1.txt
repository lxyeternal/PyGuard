[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_bundler/test_scan_bundler.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m  | [0m[35mscan_type\xabfermat_scan\xa9parameter\x82\xa4args\x82\xa4samx\x92\xfe\x02\xa4samy\x92\xfe\x02\xa6kwa[0m
[30;1m  | [0m[35m                                    "RID": "cd8fc68f-fe65-4031-9a37-e0e7ba9df542",[0m
[30;1m  | [0m[35m                                    "scan_motors": ["samx", "samy"],[0m
[30;1m  | [0m[35m                                    "readout_priority": {[0m
[30;1m  | [0m[35m                                        "monitored": ["samx", "samy"],[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_bundler/test_scan_bundler.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m242 | [0m[35m: [True],[0m
[30;1m243 | [0m[35m                            "request_blocks": [[0m
[30;1m244 | [0m[35m                                {[0m
[30;1m245 | [0m[35m                                    "msg": b"\x84\xa8msg_type\xa4scan\xa7content\x83\xa9scan_type\xa[0m
[30;1m246 | [0m[35m                                    "RID": "cd8fc68f-fe65-4031-9a37-e0e7ba9df542",[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/bec_server-3.28.1/.gitignore[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m110 | [0m[35m# pipenv[0m
[30;1m111 | [0m[35m#   According to pypa/pipenv#598, it is recommended to include Pipfile.lock in version control.[0m
[30;1m112 | [0m[35m#   However, in case of collaboration, if having platform-specific dependencies or dependencies[0m
[30;1m113 | [0m[35m#   having no cross-platform support, pipenv may install dependencies that don't work, or not[0m
[30;1m114 | [0m[35m#   install all needed dependencies.[0m
[30;1m115 | [0m[35m#Pipfile.lock[0m
[30;1m116 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/bec_server-3.28.1/.gitignore[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m108 | [0m[35m# .python-version[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m# pipenv[0m
[30;1m111 | [0m[35m#   According to pypa/pipenv#598, it is recommended to include Pipfile.lock in version control.[0m
[30;1m112 | [0m[35m#   However, in case of collaboration, if having platform-specific dependencies or dependencies[0m
[30;1m113 | [0m[35m#   having no cross-platform support, pipenv may install dependencies that don't work, or not[0m
[30;1m114 | [0m[35m#   install all needed dependencies.[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/scilog/scilog.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m36 | [0m[35m        """get a new scilog token"""[0m
[30;1m37 | [0m[35m        response = requests.post([0m
[30;1m38 | [0m[35m            f"{self.host}/users/login",[0m
[30;1m39 | [0m[35m            json={"principal": self.user, "password": self.user_secret},[0m
[30;1m40 | [0m[35m            timeout=5,[0m
[30;1m41 | [0m[35m        )[0m
[30;1m42 | [0m[35m        if response.ok:[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/scilog/scilog.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m66 | [0m[35m            self.set_bec_token(token)[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m    def _load_environment(self):[0m
[30;1m69 | [0m[35m        env_base = self.scihub.config.service_config.get("scilog", {}).get("env_file")[0m
[30;1m70 | [0m[35m        if not env_base:[0m
[30;1m71 | [0m[35m            return[0m
[30;1m72 | [0m[35m        env_file = os.path.join(env_base, ".env")[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/bec_server-3.28.1/bec_server/bec_server_utils/subprocess_launch.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m38 | [0m[35m    for ii, service_info in enumerate(services.items()):[0m
[30;1m39 | [0m[35m        service, service_config = service_info[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m        if os.environ.get("CONDA_DEFAULT_ENV"):[0m
[30;1m42 | [0m[35m            cmd = f"{os.environ['CONDA_EXE']} run -n {os.environ['CONDA_DEFAULT_ENV']} --no-capture-[0m
[30;1m43 | [0m[35m        else:[0m
[30;1m44 | [0m[35m            cmd = service_config.command[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\.get\(.*(fromhex|decode)[0m
[30;1m258 | [0m[35m[0m
[30;1m259 | [0m[35m        # extract name from 'public/<scan_id>/file/<name>'[0m
[30;1m260 | [0m[35m        names = [msg.decode().split("/")[-1] for msg in msgs][0m
[30;1m261 | [0m[35m        file_msgs = [self.connector.get(msg.decode()) for msg in msgs][0m
[30;1m262 | [0m[35m        if not file_msgs:[0m
[30;1m263 | [0m[35m            return[0m
[30;1m264 | [0m[35m        for name, file_msg in zip(names, file_msgs):[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/atlas/atlas_connector.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m76 | [0m[35m            # self.redis_atlas._redis_conn.connection_pool.connection_kwargs["username"] = ([0m
[30;1m77 | [0m[35m            #     f"ingestor_{self.deployment_name}"[0m
[30;1m78 | [0m[35m            # )[0m
[30;1m79 | [0m[35m            # self.redis_atlas._redis_conn.connection_pool.connection_kwargs["password"] = ([0m
[30;1m80 | [0m[35m            #     self.atlas_key[0m
[30;1m81 | [0m[35m            # )[0m
[30;1m82 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/atlas/atlas_connector.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m63 | [0m[35m        try:[0m
[30;1m64 | [0m[35m            if self.redis_atlas is None:[0m
[30;1m65 | [0m[35m                self.redis_atlas = RedisConnector([0m
[30;1m66 | [0m[35m                    self.host, username=f"ingestor_{self.deployment_name}", password=self.atlas_key[0m
[30;1m67 | [0m[35m                )[0m
[30;1m68 | [0m[35m            # pylint: disable=protected-access[0m
[30;1m69 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/atlas/atlas_connector.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m101 | [0m[35m        )[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m    def _load_environment(self):[0m
[30;1m104 | [0m[35m        env_base = self.scihub.config.service_config.get("atlas", {}).get("env_file", "")[0m
[30;1m105 | [0m[35m        env_file = os.path.join(env_base, ".env")[0m
[30;1m106 | [0m[35m        if not os.path.exists(env_file):[0m
[30;1m107 | [0m[35m            # check if there is an env file in the parent directory[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scihub/test_scilog_connector.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m36 | [0m[35m                ),[0m
[30;1m37 | [0m[35m            )[0m
[30;1m38 | [0m[35m            scilog.shutdown()[0m
[30;1m39 | [0m[35m            mock_dotenv_values.assert_called_once()[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scihub/test_atlas_connector.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m17 | [0m[35m                    "ATLAS_KEY": "dummy_key",[0m
[30;1m18 | [0m[35m                }[0m
[30;1m19 | [0m[35m                atlas_connector._load_environment()[0m
[30;1m20 | [0m[35m                mock_dotenv_values.assert_called_once()[0m
[30;1m21 | [0m[35m                mock_update_config.assert_called_once_with([0m
[30;1m22 | [0m[35m                    ATLAS_HOST="dummy_host",[0m
[30;1m23 | [0m[35m                    ATLAS_DEPLOYMENT="dummy_deployment",[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scan_server_queue.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m667 | [0m[35m    req_block_queue.scan_queue.queue_manager.parent.dataset_number = 5[0m
[30;1m668 | [0m[35m    rbl = RequestBlockMock(scan_queue_msg, "scan_id")[0m
[30;1m669 | [0m[35m    rbl.is_scan = is_scan[0m
[30;1m670 | [0m[35m    dataset_id_on_hold = scan_queue_msg.metadata.get("dataset_id_on_hold")[0m
[30;1m671 | [0m[35m    req_block_queue.active_rb = rbl[0m
[30;1m672 | [0m[35m    req_block_queue.increase_scan_number()[0m
[30;1m673 | [0m[35m    if is_scan and rbl.scan_def_id is None:[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scan_server_queue.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m585 | [0m[35m    rbl = RequestBlockMock(scan_queue_msg, scan_id)[0m
[30;1m586 | [0m[35m    rbl.scan = mock.MagicMock()[0m
[30;1m587 | [0m[35m    scan_def_id = scan_queue_msg.metadata.get("scan_def_id")[0m
[30;1m588 | [0m[35m    if rbl.msg.metadata.get("scan_def_id") in req_block_queue.scan_def_ids:[0m
[30;1m589 | [0m[35m        req_block_queue._update_point_id(rbl)[0m
[30;1m590 | [0m[35m        assert rbl.scan.point_id == req_block_queue.scan_def_ids[scan_def_id]["point_id"][0m
[30;1m591 | [0m[35m        return[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scan_server_queue.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m584 | [0m[35m    }[0m
[30;1m585 | [0m[35m    rbl = RequestBlockMock(scan_queue_msg, scan_id)[0m
[30;1m586 | [0m[35m    rbl.scan = mock.MagicMock()[0m
[30;1m587 | [0m[35m    scan_def_id = scan_queue_msg.metadata.get("scan_def_id")[0m
[30;1m588 | [0m[35m    if rbl.msg.metadata.get("scan_def_id") in req_block_queue.scan_def_ids:[0m
[30;1m589 | [0m[35m        req_block_queue._update_point_id(rbl)[0m
[30;1m590 | [0m[35m        assert rbl.scan.point_id == req_block_queue.scan_def_ids[scan_def_id]["point_id"][0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scan_server_queue.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m536 | [0m[35m    rbl = RequestBlockMock(scan_queue_msg, scan_id)[0m
[30;1m537 | [0m[35m    if rbl.msg.metadata.get("scan_def_id") in req_block_queue.scan_def_ids:[0m
[30;1m538 | [0m[35m        req_block_queue._update_scan_def_id(rbl)[0m
[30;1m539 | [0m[35m        scan_def_id = scan_queue_msg.metadata.get("scan_def_id")[0m
[30;1m540 | [0m[35m        assert rbl.scan_id == req_block_queue.scan_def_ids[scan_def_id]["scan_id"][0m
[30;1m541 | [0m[35m        return[0m
[30;1m542 | [0m[35m    req_block_queue._update_scan_def_id(rbl)[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scan_server_queue.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m534 | [0m[35m    req_block_queue = RequestBlockQueue(mock.MagicMock(), mock.MagicMock())[0m
[30;1m535 | [0m[35m    req_block_queue.scan_def_ids["existing_scan_def_id"] = {"scan_id": "existing_scan_id"}[0m
[30;1m536 | [0m[35m    rbl = RequestBlockMock(scan_queue_msg, scan_id)[0m
[30;1m537 | [0m[35m    if rbl.msg.metadata.get("scan_def_id") in req_block_queue.scan_def_ids:[0m
[30;1m538 | [0m[35m        req_block_queue._update_scan_def_id(rbl)[0m
[30;1m539 | [0m[35m        scan_def_id = scan_queue_msg.metadata.get("scan_def_id")[0m
[30;1m540 | [0m[35m        assert rbl.scan_id == req_block_queue.scan_def_ids[scan_def_id]["scan_id"][0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scan_server_queue.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m285 | [0m[35m        )[0m
[30;1m286 | [0m[35m        assert len(queue_manager.connector.message_sent) == 1[0m
[30;1m287 | [0m[35m        assert ([0m
[30;1m288 | [0m[35m            queue_manager.connector.message_sent[0].get("queue")[0m
[30;1m289 | [0m[35m            == MessageEndpoints.scan_queue_status()[0m
[30;1m290 | [0m[35m        )[0m
[30;1m291 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scan_server_queue.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m252 | [0m[35m        "msg": messages.VariableMessage(value=1, metadata={}),[0m
[30;1m253 | [0m[35m    } in queue_manager.connector.message_sent[0m
[30;1m254 | [0m[35m    assert ([0m
[30;1m255 | [0m[35m        queue_manager.connector.message_sent[0].get("queue") == MessageEndpoints.scan_queue_status()[0m
[30;1m256 | [0m[35m    )[0m
[30;1m257 | [0m[35m[0m
[30;1m258 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scan_server_queue.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m227 | [0m[35m    wait_to_reach_state(queue_manager, "primary", ScanQueueStatus.RUNNING)[0m
[30;1m228 | [0m[35m    assert len(queue_manager.connector.message_sent) == 1[0m
[30;1m229 | [0m[35m    assert ([0m
[30;1m230 | [0m[35m        queue_manager.connector.message_sent[0].get("queue") == MessageEndpoints.scan_queue_status()[0m
[30;1m231 | [0m[35m    )[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scan_server_queue.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m215 | [0m[35m    wait_to_reach_state(queue_manager, "primary", ScanQueueStatus.PAUSED)[0m
[30;1m216 | [0m[35m    assert len(queue_manager.connector.message_sent) == 1[0m
[30;1m217 | [0m[35m    assert ([0m
[30;1m218 | [0m[35m        queue_manager.connector.message_sent[0].get("queue") == MessageEndpoints.scan_queue_status()[0m
[30;1m219 | [0m[35m    )[0m
[30;1m220 | [0m[35m[0m
[30;1m221 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scan_server_queue.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m203 | [0m[35m    wait_to_reach_state(queue_manager, "primary", ScanQueueStatus.PAUSED)[0m
[30;1m204 | [0m[35m    assert len(queue_manager.connector.message_sent) == 1[0m
[30;1m205 | [0m[35m    assert ([0m
[30;1m206 | [0m[35m        queue_manager.connector.message_sent[0].get("queue") == MessageEndpoints.scan_queue_status()[0m
[30;1m207 | [0m[35m    )[0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1175 | [0m[35m    )[0m
[30;1m1176 | [0m[35m[0m
[30;1m1177 | [0m[35m    args = unpack_scan_args(scan_msg.content.get("parameter", {}).get("args", []))[0m
[30;1m1178 | [0m[35m    kwargs = scan_msg.content.get("parameter", {}).get("kwargs", {})[0m
[30;1m1179 | [0m[35m    request = FermatSpiralScan([0m
[30;1m1180 | [0m[35m        *args, device_manager=device_manager, parameter=scan_msg.content["parameter"], **kwargs[0m
[30;1m1181 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1175 | [0m[35m    )[0m
[30;1m1176 | [0m[35m[0m
[30;1m1177 | [0m[35m    args = unpack_scan_args(scan_msg.content.get("parameter", {}).get("args", []))[0m
[30;1m1178 | [0m[35m    kwargs = scan_msg.content.get("parameter", {}).get("kwargs", {})[0m
[30;1m1179 | [0m[35m    request = FermatSpiralScan([0m
[30;1m1180 | [0m[35m        *args, device_manager=device_manager, parameter=scan_msg.content["parameter"], **kwargs[0m
[30;1m1181 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1174 | [0m[35m        queue="primary",[0m
[30;1m1175 | [0m[35m    )[0m
[30;1m1176 | [0m[35m[0m
[30;1m1177 | [0m[35m    args = unpack_scan_args(scan_msg.content.get("parameter", {}).get("args", []))[0m
[30;1m1178 | [0m[35m    kwargs = scan_msg.content.get("parameter", {}).get("kwargs", {})[0m
[30;1m1179 | [0m[35m    request = FermatSpiralScan([0m
[30;1m1180 | [0m[35m        *args, device_manager=device_manager, parameter=scan_msg.content["parameter"], **kwargs[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1174 | [0m[35m        queue="primary",[0m
[30;1m1175 | [0m[35m    )[0m
[30;1m1176 | [0m[35m[0m
[30;1m1177 | [0m[35m    args = unpack_scan_args(scan_msg.content.get("parameter", {}).get("args", []))[0m
[30;1m1178 | [0m[35m    kwargs = scan_msg.content.get("parameter", {}).get("kwargs", {})[0m
[30;1m1179 | [0m[35m    request = FermatSpiralScan([0m
[30;1m1180 | [0m[35m        *args, device_manager=device_manager, parameter=scan_msg.content["parameter"], **kwargs[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1085 | [0m[35m[0m
[30;1m1086 | [0m[35m    for ii, dev in enumerate(request.scan_motors):[0m
[30;1m1087 | [0m[35m        low_limit, high_limit = ([0m
[30;1m1088 | [0m[35m            request.device_manager.devices[dev]._config["deviceConfig"].get("limits", [0, 0])[0m
[30;1m1089 | [0m[35m        )[0m
[30;1m1090 | [0m[35m        for pos in request.positions:[0m
[30;1m1091 | [0m[35m            pos_axis = pos[ii][0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1076 | [0m[35m        50,[0m
[30;1m1077 | [0m[35m    ][0m
[30;1m1078 | [0m[35m    request.device_manager.devices["samy"]._config["deviceConfig"]["limits"] = [5, -5][0m
[30;1m1079 | [0m[35m    assert request.device_manager.devices["samy"]._config["deviceConfig"].get("limits", [0, 0]) == [[0m
[30;1m1080 | [0m[35m        5,[0m
[30;1m1081 | [0m[35m        -5,[0m
[30;1m1082 | [0m[35m    ][0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1071 | [0m[35m    )[0m
[30;1m1072 | [0m[35m[0m
[30;1m1073 | [0m[35m    assert request.scan_motors == ["samx", "samy"][0m
[30;1m1074 | [0m[35m    assert request.device_manager.devices["samy"]._config["deviceConfig"].get("limits", [0, 0]) == [[0m
[30;1m1075 | [0m[35m        -50,[0m
[30;1m1076 | [0m[35m        50,[0m
[30;1m1077 | [0m[35m    ][0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1042 | [0m[35m        queue="primary",[0m
[30;1m1043 | [0m[35m    )[0m
[30;1m1044 | [0m[35m    args = unpack_scan_args(scan_msg.content.get("parameter", {}).get("args", []))[0m
[30;1m1045 | [0m[35m    kwargs = scan_msg.content.get("parameter", {}).get("kwargs", {})[0m
[30;1m1046 | [0m[35m[0m
[30;1m1047 | [0m[35m    request = FermatSpiralScan([0m
[30;1m1048 | [0m[35m        *args, device_manager=device_manager, parameter=scan_msg.content["parameter"], **kwargs[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1042 | [0m[35m        queue="primary",[0m
[30;1m1043 | [0m[35m    )[0m
[30;1m1044 | [0m[35m    args = unpack_scan_args(scan_msg.content.get("parameter", {}).get("args", []))[0m
[30;1m1045 | [0m[35m    kwargs = scan_msg.content.get("parameter", {}).get("kwargs", {})[0m
[30;1m1046 | [0m[35m[0m
[30;1m1047 | [0m[35m    request = FermatSpiralScan([0m
[30;1m1048 | [0m[35m        *args, device_manager=device_manager, parameter=scan_msg.content["parameter"], **kwargs[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1041 | [0m[35m        parameter={"args": {"samx": (-5, 5), "samy": (-5, 5)}, "kwargs": {"step": 3}},[0m
[30;1m1042 | [0m[35m        queue="primary",[0m
[30;1m1043 | [0m[35m    )[0m
[30;1m1044 | [0m[35m    args = unpack_scan_args(scan_msg.content.get("parameter", {}).get("args", []))[0m
[30;1m1045 | [0m[35m    kwargs = scan_msg.content.get("parameter", {}).get("kwargs", {})[0m
[30;1m1046 | [0m[35m[0m
[30;1m1047 | [0m[35m    request = FermatSpiralScan([0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1041 | [0m[35m        parameter={"args": {"samx": (-5, 5), "samy": (-5, 5)}, "kwargs": {"step": 3}},[0m
[30;1m1042 | [0m[35m        queue="primary",[0m
[30;1m1043 | [0m[35m    )[0m
[30;1m1044 | [0m[35m    args = unpack_scan_args(scan_msg.content.get("parameter", {}).get("args", []))[0m
[30;1m1045 | [0m[35m    kwargs = scan_msg.content.get("parameter", {}).get("kwargs", {})[0m
[30;1m1046 | [0m[35m[0m
[30;1m1047 | [0m[35m    request = FermatSpiralScan([0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1025 | [0m[35m        queue="primary",[0m
[30;1m1026 | [0m[35m    )[0m
[30;1m1027 | [0m[35m    args = unpack_scan_args(scan_msg.content.get("parameter", {}).get("args", []))[0m
[30;1m1028 | [0m[35m    kwargs = scan_msg.content.get("parameter", {}).get("kwargs", {})[0m
[30;1m1029 | [0m[35m    request = FermatSpiralScan([0m
[30;1m1030 | [0m[35m        *args, device_manager=device_manager, parameter=scan_msg.content["parameter"], **kwargs[0m
[30;1m1031 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1025 | [0m[35m        queue="primary",[0m
[30;1m1026 | [0m[35m    )[0m
[30;1m1027 | [0m[35m    args = unpack_scan_args(scan_msg.content.get("parameter", {}).get("args", []))[0m
[30;1m1028 | [0m[35m    kwargs = scan_msg.content.get("parameter", {}).get("kwargs", {})[0m
[30;1m1029 | [0m[35m    request = FermatSpiralScan([0m
[30;1m1030 | [0m[35m        *args, device_manager=device_manager, parameter=scan_msg.content["parameter"], **kwargs[0m
[30;1m1031 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1024 | [0m[35m        parameter={"args": {"samx": (-5, 5), "samy": (-5, 5)}, "kwargs": {"step": 3}},[0m
[30;1m1025 | [0m[35m        queue="primary",[0m
[30;1m1026 | [0m[35m    )[0m
[30;1m1027 | [0m[35m    args = unpack_scan_args(scan_msg.content.get("parameter", {}).get("args", []))[0m
[30;1m1028 | [0m[35m    kwargs = scan_msg.content.get("parameter", {}).get("kwargs", {})[0m
[30;1m1029 | [0m[35m    request = FermatSpiralScan([0m
[30;1m1030 | [0m[35m        *args, device_manager=device_manager, parameter=scan_msg.content["parameter"], **kwargs[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1024 | [0m[35m        parameter={"args": {"samx": (-5, 5), "samy": (-5, 5)}, "kwargs": {"step": 3}},[0m
[30;1m1025 | [0m[35m        queue="primary",[0m
[30;1m1026 | [0m[35m    )[0m
[30;1m1027 | [0m[35m    args = unpack_scan_args(scan_msg.content.get("parameter", {}).get("args", []))[0m
[30;1m1028 | [0m[35m    kwargs = scan_msg.content.get("parameter", {}).get("kwargs", {})[0m
[30;1m1029 | [0m[35m    request = FermatSpiralScan([0m
[30;1m1030 | [0m[35m        *args, device_manager=device_manager, parameter=scan_msg.content["parameter"], **kwargs[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m887 | [0m[35m        queue="primary",[0m
[30;1m888 | [0m[35m    )[0m
[30;1m889 | [0m[35m    args = unpack_scan_args(scan_msg.content.get("parameter", {}).get("args", []))[0m
[30;1m890 | [0m[35m    kwargs = scan_msg.content.get("parameter", {}).get("kwargs", {})[0m
[30;1m891 | [0m[35m    request = FermatSpiralScan([0m
[30;1m892 | [0m[35m        *args, device_manager=device_manager, parameter=scan_msg.content["parameter"], **kwargs[0m
[30;1m893 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m887 | [0m[35m        queue="primary",[0m
[30;1m888 | [0m[35m    )[0m
[30;1m889 | [0m[35m    args = unpack_scan_args(scan_msg.content.get("parameter", {}).get("args", []))[0m
[30;1m890 | [0m[35m    kwargs = scan_msg.content.get("parameter", {}).get("kwargs", {})[0m
[30;1m891 | [0m[35m    request = FermatSpiralScan([0m
[30;1m892 | [0m[35m        *args, device_manager=device_manager, parameter=scan_msg.content["parameter"], **kwargs[0m
[30;1m893 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m886 | [0m[35m        parameter={"args": {"samx": (-5, 5), "samy": (-5, 5)}, "kwargs": {"step": 3}},[0m
[30;1m887 | [0m[35m        queue="primary",[0m
[30;1m888 | [0m[35m    )[0m
[30;1m889 | [0m[35m    args = unpack_scan_args(scan_msg.content.get("parameter", {}).get("args", []))[0m
[30;1m890 | [0m[35m    kwargs = scan_msg.content.get("parameter", {}).get("kwargs", {})[0m
[30;1m891 | [0m[35m    request = FermatSpiralScan([0m
[30;1m892 | [0m[35m        *args, device_manager=device_manager, parameter=scan_msg.content["parameter"], **kwargs[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m886 | [0m[35m        parameter={"args": {"samx": (-5, 5), "samy": (-5, 5)}, "kwargs": {"step": 3}},[0m
[30;1m887 | [0m[35m        queue="primary",[0m
[30;1m888 | [0m[35m    )[0m
[30;1m889 | [0m[35m    args = unpack_scan_args(scan_msg.content.get("parameter", {}).get("args", []))[0m
[30;1m890 | [0m[35m    kwargs = scan_msg.content.get("parameter", {}).get("kwargs", {})[0m
[30;1m891 | [0m[35m    request = FermatSpiralScan([0m
[30;1m892 | [0m[35m        *args, device_manager=device_manager, parameter=scan_msg.content["parameter"], **kwargs[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m866 | [0m[35m    scan_instructions = list(scan.run())[0m
[30;1m867 | [0m[35m    scan_uid = scan_instructions[0].metadata.get("scan_id")[0m
[30;1m868 | [0m[35m    for ii, _ in enumerate(reference_scan_list):[0m
[30;1m869 | [0m[35m        if reference_scan_list[ii].metadata.get("scan_id") is not None:[0m
[30;1m870 | [0m[35m            reference_scan_list[ii].metadata["scan_id"] = scan_uid[0m
[30;1m871 | [0m[35m        scan_instructions[ii].metadata.pop("device_instr_id", None)[0m
[30;1m872 | [0m[35m        if scan_instructions[ii].device and isinstance(scan_instructions[ii].device, list):[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m864 | [0m[35m    scan = scan_assembler(Acquire, parameter=scan_msg.content.get("parameter"))[0m
[30;1m865 | [0m[35m[0m
[30;1m866 | [0m[35m    scan_instructions = list(scan.run())[0m
[30;1m867 | [0m[35m    scan_uid = scan_instructions[0].metadata.get("scan_id")[0m
[30;1m868 | [0m[35m    for ii, _ in enumerate(reference_scan_list):[0m
[30;1m869 | [0m[35m        if reference_scan_list[ii].metadata.get("scan_id") is not None:[0m
[30;1m870 | [0m[35m            reference_scan_list[ii].metadata["scan_id"] = scan_uid[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m861 | [0m[35m)[0m
[30;1m862 | [0m[35mdef test_acquire(scan_msg, reference_scan_list, scan_assembler):[0m
[30;1m863 | [0m[35m[0m
[30;1m864 | [0m[35m    scan = scan_assembler(Acquire, parameter=scan_msg.content.get("parameter"))[0m
[30;1m865 | [0m[35m[0m
[30;1m866 | [0m[35m    scan_instructions = list(scan.run())[0m
[30;1m867 | [0m[35m    scan_uid = scan_instructions[0].metadata.get("scan_id")[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m748 | [0m[35m            if msg.action == "rpc":[0m
[30;1m749 | [0m[35m                msg.metadata.pop("rpc_id", None)[0m
[30;1m750 | [0m[35m                msg.parameter.pop("rpc_id", None)[0m
[30;1m751 | [0m[35m            if msg.metadata.get("device_instr_id"):[0m
[30;1m752 | [0m[35m                diid_list.append(msg.metadata.pop("device_instr_id"))[0m
[30;1m753 | [0m[35m            if msg.device and isinstance(msg.device, list):[0m
[30;1m754 | [0m[35m                msg.device = sorted(msg.device)[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m738 | [0m[35m[0m
[30;1m739 | [0m[35m        msg_list = list(request.run())[0m
[30;1m740 | [0m[35m[0m
[30;1m741 | [0m[35m        scan_uid = msg_list[0].metadata.get("scan_id")[0m
[30;1m742 | [0m[35m        diid_list = [][0m
[30;1m743 | [0m[35m        for ii, msg in enumerate(msg_list):[0m
[30;1m744 | [0m[35m            if msg is None:[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m523 | [0m[35m    args = unpack_scan_args(scan_msg.content.get("parameter").get("args"))[0m
[30;1m524 | [0m[35m    kwargs = scan_msg.content.get("parameter").get("kwargs")[0m
[30;1m525 | [0m[35m    scan = scan_assembler([0m
[30;1m526 | [0m[35m        FermatSpiralScan, *args, parameter=scan_msg.content.get("parameter"), **kwargs[0m
[30;1m527 | [0m[35m    )[0m
[30;1m528 | [0m[35m[0m
[30;1m529 | [0m[35m    def offset_mock():[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m521 | [0m[35mdef test_fermat_scan(scan_msg, reference_scan_list, scan_assembler):[0m
[30;1m522 | [0m[35m[0m
[30;1m523 | [0m[35m    args = unpack_scan_args(scan_msg.content.get("parameter").get("args"))[0m
[30;1m524 | [0m[35m    kwargs = scan_msg.content.get("parameter").get("kwargs")[0m
[30;1m525 | [0m[35m    scan = scan_assembler([0m
[30;1m526 | [0m[35m        FermatSpiralScan, *args, parameter=scan_msg.content.get("parameter"), **kwargs[0m
[30;1m527 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m521 | [0m[35mdef test_fermat_scan(scan_msg, reference_scan_list, scan_assembler):[0m
[30;1m522 | [0m[35m[0m
[30;1m523 | [0m[35m    args = unpack_scan_args(scan_msg.content.get("parameter").get("args"))[0m
[30;1m524 | [0m[35m    kwargs = scan_msg.content.get("parameter").get("kwargs")[0m
[30;1m525 | [0m[35m    scan = scan_assembler([0m
[30;1m526 | [0m[35m        FermatSpiralScan, *args, parameter=scan_msg.content.get("parameter"), **kwargs[0m
[30;1m527 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m520 | [0m[35m)[0m
[30;1m521 | [0m[35mdef test_fermat_scan(scan_msg, reference_scan_list, scan_assembler):[0m
[30;1m522 | [0m[35m[0m
[30;1m523 | [0m[35m    args = unpack_scan_args(scan_msg.content.get("parameter").get("args"))[0m
[30;1m524 | [0m[35m    kwargs = scan_msg.content.get("parameter").get("kwargs")[0m
[30;1m525 | [0m[35m    scan = scan_assembler([0m
[30;1m526 | [0m[35m        FermatSpiralScan, *args, parameter=scan_msg.content.get("parameter"), **kwargs[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m520 | [0m[35m)[0m
[30;1m521 | [0m[35mdef test_fermat_scan(scan_msg, reference_scan_list, scan_assembler):[0m
[30;1m522 | [0m[35m[0m
[30;1m523 | [0m[35m    args = unpack_scan_args(scan_msg.content.get("parameter").get("args"))[0m
[30;1m524 | [0m[35m    kwargs = scan_msg.content.get("parameter").get("kwargs")[0m
[30;1m525 | [0m[35m    scan = scan_assembler([0m
[30;1m526 | [0m[35m        FermatSpiralScan, *args, parameter=scan_msg.content.get("parameter"), **kwargs[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m467 | [0m[35m            msg_list.append(step)[0m
[30;1m468 | [0m[35m    scan_uid = msg_list[0].metadata.get("scan_id")[0m
[30;1m469 | [0m[35m    for ii, _ in enumerate(reference_scan_list):[0m
[30;1m470 | [0m[35m        if reference_scan_list[ii].metadata.get("scan_id") is not None:[0m
[30;1m471 | [0m[35m            reference_scan_list[ii].metadata["scan_id"] = scan_uid[0m
[30;1m472 | [0m[35m    assert msg_list == reference_scan_list[0m
[30;1m473 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m465 | [0m[35m        if step:[0m
[30;1m466 | [0m[35m            step.metadata.pop("device_instr_id", None)[0m
[30;1m467 | [0m[35m            msg_list.append(step)[0m
[30;1m468 | [0m[35m    scan_uid = msg_list[0].metadata.get("scan_id")[0m
[30;1m469 | [0m[35m    for ii, _ in enumerate(reference_scan_list):[0m
[30;1m470 | [0m[35m        if reference_scan_list[ii].metadata.get("scan_id") is not None:[0m
[30;1m471 | [0m[35m            reference_scan_list[ii].metadata["scan_id"] = scan_uid[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m458 | [0m[35m    def offset_mock():[0m
[30;1m459 | [0m[35m        yield None[0m
[30;1m460 | [0m[35m[0m
[30;1m461 | [0m[35m    scan = scan_assembler(Scan, parameter=scan_msg.content.get("parameter"))[0m
[30;1m462 | [0m[35m[0m
[30;1m463 | [0m[35m    scan._set_position_offset = offset_mock[0m
[30;1m464 | [0m[35m    for step in scan.run():[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m288 | [0m[35m    msg_list = [][0m
[30;1m289 | [0m[35m[0m
[30;1m290 | [0m[35m    s = scan_assembler([0m
[30;1m291 | [0m[35m        UpdatedMove, parameter=mv_msg.content.get("parameter"), metadata=mv_msg.metadata[0m
[30;1m292 | [0m[35m    )[0m
[30;1m293 | [0m[35m[0m
[30;1m294 | [0m[35m    with mock.patch.object(s.stubs, "_get_result_from_status") as mock_get_from_rpc:[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m133 | [0m[35m    def offset_mock():[0m
[30;1m134 | [0m[35m        yield None[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m    s = scan_assembler(Move, parameter=mv_msg.content.get("parameter"))[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m    s._set_position_offset = offset_mock[0m
[30;1m139 | [0m[35m    msg_list_reference = [][0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/device_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m676 | [0m[35m            if method == "read":[0m
[30;1m677 | [0m[35m                old_msg = self.connector.get(MessageEndpoints.device_read(device_root))[0m
[30;1m678 | [0m[35m            elif method == "read_configuration":[0m
[30;1m679 | [0m[35m                old_msg = self.connector.get([0m
[30;1m680 | [0m[35m                    MessageEndpoints.device_read_configuration(device_root)[0m
[30;1m681 | [0m[35m                )[0m
[30;1m682 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/device_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m674 | [0m[35m                f"Failed to run {method} on device {device_root}. Trying to load an old value."[0m
[30;1m675 | [0m[35m            )[0m
[30;1m676 | [0m[35m            if method == "read":[0m
[30;1m677 | [0m[35m                old_msg = self.connector.get(MessageEndpoints.device_read(device_root))[0m
[30;1m678 | [0m[35m            elif method == "read_configuration":[0m
[30;1m679 | [0m[35m                old_msg = self.connector.get([0m
[30;1m680 | [0m[35m                    MessageEndpoints.device_read_configuration(device_root)[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/device_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m661 | [0m[35m            metadata={},[0m
[30;1m662 | [0m[35m        )[0m
[30;1m663 | [0m[35m        device_root = device.split(".")[0][0m
[30;1m664 | [0m[35m        ds_dev = self.device_manager.devices.get(device_root)[0m
[30;1m665 | [0m[35m[0m
[30;1m666 | [0m[35m        if ds_dev.on_failure == OnFailure.RETRY:[0m
[30;1m667 | [0m[35m            # try to read it again, may have been only a glitch[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/device_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m634 | [0m[35m        signal_container = [][0m
[30;1m635 | [0m[35m        for dev in devices:[0m
[30;1m636 | [0m[35m            self.device_manager.devices.get(dev).metadata = metadata[0m
[30;1m637 | [0m[35m            obj = self.device_manager.devices.get(dev).obj[0m
[30;1m638 | [0m[35m            try:[0m
[30;1m639 | [0m[35m                signals = obj.read_configuration()[0m
[30;1m640 | [0m[35m                signal_container.append(signals)[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/device_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m633 | [0m[35m        pipe = self.connector.pipeline()[0m
[30;1m634 | [0m[35m        signal_container = [][0m
[30;1m635 | [0m[35m        for dev in devices:[0m
[30;1m636 | [0m[35m            self.device_manager.devices.get(dev).metadata = metadata[0m
[30;1m637 | [0m[35m            obj = self.device_manager.devices.get(dev).obj[0m
[30;1m638 | [0m[35m            try:[0m
[30;1m639 | [0m[35m                signals = obj.read_configuration()[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/device_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m604 | [0m[35m        for dev in devices:[0m
[30;1m605 | [0m[35m            device_root = dev.split(".")[0][0m
[30;1m606 | [0m[35m            self.device_manager.devices.get(device_root).metadata = metadata[0m
[30;1m607 | [0m[35m            obj = self.device_manager.devices.get(device_root).obj[0m
[30;1m608 | [0m[35m            try:[0m
[30;1m609 | [0m[35m                signals = obj.read()[0m
[30;1m610 | [0m[35m                signal_container.append(signals)[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/device_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m603 | [0m[35m        signal_container = [][0m
[30;1m604 | [0m[35m        for dev in devices:[0m
[30;1m605 | [0m[35m            device_root = dev.split(".")[0][0m
[30;1m606 | [0m[35m            self.device_manager.devices.get(device_root).metadata = metadata[0m
[30;1m607 | [0m[35m            obj = self.device_manager.devices.get(device_root).obj[0m
[30;1m608 | [0m[35m            try:[0m
[30;1m609 | [0m[35m                signals = obj.read()[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/device_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m558 | [0m[35m            elif obj.kind in [Kind.normal, Kind.hinted]:[0m
[30;1m559 | [0m[35m                self._read_device(status.instruction)[0m
[30;1m560 | [0m[35m[0m
[30;1m561 | [0m[35m        if status.instruction.metadata.get("response"):[0m
[30;1m562 | [0m[35m            # if the user requested a response on a single status object, we need to send it[0m
[30;1m563 | [0m[35m            # to the device_req_status_container[0m
[30;1m564 | [0m[35m            dev_msg = messages.DeviceReqStatusMessage([0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/device_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m479 | [0m[35m        child_access = None[0m
[30;1m480 | [0m[35m        if "." in device_name:[0m
[30;1m481 | [0m[35m            device_name, child_access = device_name.split(".", 1)[0m
[30;1m482 | [0m[35m        device_obj = self.device_manager.devices.get(device_name)[0m
[30;1m483 | [0m[35m        if device_obj.read_only:[0m
[30;1m484 | [0m[35m            raise DisabledDeviceError([0m
[30;1m485 | [0m[35m                f"Setting the device {device_obj.name} is currently disabled."[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/device_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m456 | [0m[35m        self.requests_handler.add_request(instr, num_status_objects=len(devices))[0m
[30;1m457 | [0m[35m        num_status_objects = 0[0m
[30;1m458 | [0m[35m        for dev in devices:[0m
[30;1m459 | [0m[35m            obj = self.device_manager.devices.get(dev).obj[0m
[30;1m460 | [0m[35m            if not hasattr(obj, "complete"):[0m
[30;1m461 | [0m[35m                continue[0m
[30;1m462 | [0m[35m            num_status_objects += 1[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/device_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m431 | [0m[35m[0m
[30;1m432 | [0m[35m        obj = self.device_manager.devices.get(instr.content["device"]).obj[0m
[30;1m433 | [0m[35m        kickoff_args = inspect.getfullargspec(obj.kickoff).args[0m
[30;1m434 | [0m[35m        kickoff_parameter = instr.content["parameter"].get("configure", {})[0m
[30;1m435 | [0m[35m        if len(kickoff_args) > 1:[0m
[30;1m436 | [0m[35m            obj.kickoff(metadata=instr.metadata, **kickoff_parameter)[0m
[30;1m437 | [0m[35m            self.requests_handler.add_request(instr, num_status_objects=0, done=True, success=True)[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/device_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m429 | [0m[35m    def _kickoff_device(self, instr: messages.DeviceInstructionMessage) -> None:[0m
[30;1m430 | [0m[35m        logger.debug(f"Kickoff device: {instr}")[0m
[30;1m431 | [0m[35m[0m
[30;1m432 | [0m[35m        obj = self.device_manager.devices.get(instr.content["device"]).obj[0m
[30;1m433 | [0m[35m        kickoff_args = inspect.getfullargspec(obj.kickoff).args[0m
[30;1m434 | [0m[35m        kickoff_parameter = instr.content["parameter"].get("configure", {})[0m
[30;1m435 | [0m[35m        if len(kickoff_args) > 1:[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/device_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m418 | [0m[35m            devices = [devices][0m
[30;1m419 | [0m[35m        self.requests_handler.add_request(instr, num_status_objects=len(devices))[0m
[30;1m420 | [0m[35m        for dev in devices:[0m
[30;1m421 | [0m[35m            obj = self.device_manager.devices.get(dev)[0m
[30;1m422 | [0m[35m            obj.metadata = instr.metadata[0m
[30;1m423 | [0m[35m            status = obj.obj.trigger()[0m
[30;1m424 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/device_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m290 | [0m[35m            devices = [devices][0m
[30;1m291 | [0m[35m        for dev in devices:[0m
[30;1m292 | [0m[35m            device_root = dev.split(".")[0][0m
[30;1m293 | [0m[35m            self.device_manager.devices.get(device_root).metadata = instr.metadata[0m
[30;1m294 | [0m[35m[0m
[30;1m295 | [0m[35m    def on_stop_all_devices(self, msg, **_kwargs) -> None:[0m
[30;1m296 | [0m[35m        """callback for receiving scan modifications / interceptions"""[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/device_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m94 | [0m[35m        Args:[0m
[30;1m95 | [0m[35m            instr_id(str): The ID of the instruction.[0m
[30;1m96 | [0m[35m        """[0m
[30;1m97 | [0m[35m        return self._storage.get(instr_id)[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m    def patch_num_status_objects([0m
[30;1m100 | [0m[35m        self, instr: messages.DeviceInstructionMessage, num_status_objects: int[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/device_server.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35m    def _update_instruction(self, instr_id: str) -> None:[0m
[30;1m182 | [0m[35m        """[0m
[30;1m183 | [0m[35m        Update the instruction in the storage.[0m
[30;1m184 | [0m[35m[0m
[30;1m185 | [0m[35m        Args:[0m
[30;1m186 | [0m[35m            instr_id(str): The ID of the instruction.[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/device_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m648 | [0m[35m            )[0m
[30;1m649 | [0m[35m        pipe.execute()[0m
[30;1m650 | [0m[35m        logger.debug([0m
[30;1m651 | [0m[35m            f"Elapsed time for reading and updating status info: {(time.time()-start)*1000} ms"[0m
[30;1m652 | [0m[35m        )[0m
[30;1m653 | [0m[35m        return signal_container[0m
[30;1m654 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/device_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m624 | [0m[35m            )[0m
[30;1m625 | [0m[35m        pipe.execute()[0m
[30;1m626 | [0m[35m        logger.debug([0m
[30;1m627 | [0m[35m            f"Elapsed time for reading and updating status info: {(time.time()-start)*1000} ms"[0m
[30;1m628 | [0m[35m        )[0m
[30;1m629 | [0m[35m        return signal_container[0m
[30;1m630 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/device_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m[0m
[30;1m239 | [0m[35mclass DeviceServer(RPCMixin, BECService):[0m
[30;1m240 | [0m[35m    """DeviceServer using ophyd as a service[0m
[30;1m241 | [0m[35m    This class is intended to provide a thin wrapper around ophyd and the devicemanager. It acts as [0m
[30;1m242 | [0m[35m    """[0m
[30;1m243 | [0m[35m[0m
[30;1m244 | [0m[35m    def __init__(self, config, connector_cls: type[RedisConnector]) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/device_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mimport enum[0m
[30;1m4 | [0m[35mimport inspect[0m
[30;1m5 | [0m[35mimport threading[0m
[30;1m6 | [0m[35mimport time[0m
[30;1m7 | [0m[35mimport traceback[0m
[30;1m8 | [0m[35mfrom concurrent.futures import ThreadPoolExecutor[0m
[30;1m9 | [0m[35mfrom typing import TYPE_CHECKING[0m
[30;1m10 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/bec_server_utils/service_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m127 | [0m[35m            while True:[0m
[30;1m128 | [0m[35m                r = redis.from_url(f"redis://{redis_host_port}")[0m
[30;1m129 | [0m[35m                try:[0m
[30;1m130 | [0m[35m                    answer = r.ping() if key is None else r.get(key)[0m
[30;1m131 | [0m[35m                except redis.exceptions.ConnectionError:[0m
[30;1m132 | [0m[35m                    time.sleep(0.1)[0m
[30;1m133 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/bec_server_utils/service_handler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m104 | [0m[35m        except Exception:[0m
[30;1m105 | [0m[35m            default_interface = "tmux"[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m        # FIXME: auth error for systemctl prevents it from being used. For now, default to tmux[0m
[30;1m108 | [0m[35m        default_interface = "tmux"[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m        # check if we are on MacOS and if so, check if we have iTerm2 installed[0m
[30;1m111 | [0m[35m        if sys.platform == "darwin":[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/bec_server_utils/service_handler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m104 | [0m[35m        except Exception:[0m
[30;1m105 | [0m[35m            default_interface = "tmux"[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m        # FIXME: auth error for systemctl prevents it from being used. For now, default to tmux[0m
[30;1m108 | [0m[35m        default_interface = "tmux"[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m        # check if we are on MacOS and if so, check if we have iTerm2 installed[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/bec_server_utils/service_handler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m94 | [0m[35m            self._detect_available_interfaces()[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m    def _detect_available_interfaces(self):[0m
[30;1m97 | [0m[35m        # check if the systemctl command "bec_server" is available[0m
[30;1m98 | [0m[35m        try:[0m
[30;1m99 | [0m[35m            out = subprocess.run(["systemctl", "list-unit-files", "bec-server.service"], check=True)[0m
[30;1m100 | [0m[35m            if out.returncode == 0:[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/bec_server_utils/service_handler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m55 | [0m[35mclass ServiceHandler:[0m
[30;1m56 | [0m[35m    """[0m
[30;1m57 | [0m[35m    Service handler for the BEC server. This class is used to start, stop and restart the BEC server[0m
[30;1m58 | [0m[35m    Depending on the platform, the server is launched in a tmux session or in an iTerm2 session.[0m
[30;1m59 | [0m[35m    """[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m    SERVICES = {[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/bec_server_utils/service_handler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35mclass ServiceHandler:[0m
[30;1m56 | [0m[35m    """[0m
[30;1m57 | [0m[35m    Service handler for the BEC server. This class is used to start, stop and restart the BEC server[0m
[30;1m58 | [0m[35m    Depending on the platform, the server is launched in a tmux session or in an iTerm2 session.[0m
[30;1m59 | [0m[35m    """[0m
[30;1m60 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/bec_server_utils/service_handler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mimport functools[0m
[30;1m3 | [0m[35mimport subprocess[0m
[30;1m4 | [0m[35mimport sys[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35mfrom dataclasses import dataclass, field[0m
[30;1m7 | [0m[35mfrom string import Template[0m
[30;1m8 | [0m[35mfrom typing import Callable, Literal, Union[0m
[30;1m9 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_device_server/test_device_manager_ds.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m203 | [0m[35m        metadata={"user_info": "my_info"},[0m
[30;1m204 | [0m[35m    )[0m
[30;1m205 | [0m[35m    msg = connected_connector.get(MessageEndpoints.file_event(name="eiger"))[0m
[30;1m206 | [0m[35m    msg2 = connected_connector.get(MessageEndpoints.public_file(scan_id="12345", name="eiger"))[0m
[30;1m207 | [0m[35m    assert msg == msg2[0m
[30;1m208 | [0m[35m    assert msg.content["file_path"] == "test_file_path"[0m
[30;1m209 | [0m[35m    assert msg.content["done"] is True[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_device_server/test_device_manager_ds.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m202 | [0m[35m        hinted_h5_entries={"my_entry": "entry/data/data"},[0m
[30;1m203 | [0m[35m        metadata={"user_info": "my_info"},[0m
[30;1m204 | [0m[35m    )[0m
[30;1m205 | [0m[35m    msg = connected_connector.get(MessageEndpoints.file_event(name="eiger"))[0m
[30;1m206 | [0m[35m    msg2 = connected_connector.get(MessageEndpoints.public_file(scan_id="12345", name="eiger"))[0m
[30;1m207 | [0m[35m    assert msg == msg2[0m
[30;1m208 | [0m[35m    assert msg.content["file_path"] == "test_file_path"[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_device_server/test_device_manager_ds.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m121 | [0m[35m    assert "signals" in msg.content[0m
[30;1m122 | [0m[35m    assert "idata" in msg.content["signals"][0m
[30;1m123 | [0m[35m    assert "edata" in msg.content["signals"][0m
[30;1m124 | [0m[35m    msg = connected_connector.get(MessageEndpoints.device_status("samx"))[0m
[30;1m125 | [0m[35m    assert msg.metadata["scan_id"] == "12345"[0m
[30;1m126 | [0m[35m    assert msg.content["device"] == "samx"[0m
[30;1m127 | [0m[35m    assert msg.content["status"] == 20[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_device_server/test_device_manager_ds.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m117 | [0m[35m        value={"data": {"idata": np.random.rand(20), "edata": np.random.rand(20)}},[0m
[30;1m118 | [0m[35m        metadata={"scan_id": "test_scan_id"},[0m
[30;1m119 | [0m[35m    )[0m
[30;1m120 | [0m[35m    msg = connected_connector.get(MessageEndpoints.device_read("samx"))[0m
[30;1m121 | [0m[35m    assert "signals" in msg.content[0m
[30;1m122 | [0m[35m    assert "idata" in msg.content["signals"][0m
[30;1m123 | [0m[35m    assert "edata" in msg.content["signals"][0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_device_server/test_device_manager_ds.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport copy[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35mfrom unittest import mock[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mimport numpy as np[0m
[30;1m6 | [0m[35mimport pytest[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/merged_dicts.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m29 | [0m[35m    """[0m
[30;1m30 | [0m[35m    for key, value in update.items():[0m
[30;1m31 | [0m[35m        if isinstance(value, collections.abc.Mapping):[0m
[30;1m32 | [0m[35m            target[key] = nested_update(target.get(key, {}), value)[0m
[30;1m33 | [0m[35m            continue[0m
[30;1m34 | [0m[35m        target[key] = value[0m
[30;1m35 | [0m[35m    return target[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/merged_dicts.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35mdef nested_update(target: dict, update: dict):[0m
[30;1m26 | [0m[35m    """[0m
[30;1m27 | [0m[35m    update a nested dictionary[0m
[30;1m28 | [0m[35m    similar to dict.update() but without overwriting nested structures[0m
[30;1m29 | [0m[35m    """[0m
[30;1m30 | [0m[35m    for key, value in update.items():[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/dap_service_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m157 | [0m[35m            success=success, data=data, error=error, dap_request=dap_request_msg, metadata=metadata[0m
[30;1m158 | [0m[35m        )[0m
[30;1m159 | [0m[35m        self.connector.set_and_publish([0m
[30;1m160 | [0m[35m            MessageEndpoints.dap_response(metadata.get("RID")), dap_response_msg, expire=60[0m
[30;1m161 | [0m[35m        )[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m    def start(self, client: BECClient) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/dap_service_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m88 | [0m[35m            self.client.callbacks.remove(self.continuous_dap["id"])[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m        dap_config = dap_request_msg.content["config"][0m
[30;1m91 | [0m[35m        if not dap_config.get("auto_run"):[0m
[30;1m92 | [0m[35m            return[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m        config = dap_request_msg.content["config"][0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/dap_service_manager.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m260 | [0m[35m        """[0m
[30;1m261 | [0m[35m        for key in keys:[0m
[30;1m262 | [0m[35m            if key not in service:[0m
[30;1m263 | [0m[35m                raise ValueError(f"Invalid service {service}. Must have a {key} key.")[0m
[30;1m264 | [0m[35m[0m
[30;1m265 | [0m[35m    def publish_available_services(self):[0m
[30;1m266 | [0m[35m        """send all available dap services to the broker"""[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/dap_service_manager.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m252 | [0m[35m        Check if the service keys exists.[0m
[30;1m253 | [0m[35m[0m
[30;1m254 | [0m[35m        Args:[0m
[30;1m255 | [0m[35m            service (dict): Service[0m
[30;1m256 | [0m[35m            keys (list): Keys[0m
[30;1m257 | [0m[35m[0m
[30;1m258 | [0m[35m        Returns:[0m
[30;1m259 | [0m[35m            bool: True if the keys exists[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/dap_service_manager.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m252 | [0m[35m        Check if the service keys exists.[0m
[30;1m253 | [0m[35m[0m
[30;1m254 | [0m[35m        Args:[0m
[30;1m255 | [0m[35m            service (dict): Service[0m
[30;1m256 | [0m[35m            keys (list): Keys[0m
[30;1m257 | [0m[35m[0m
[30;1m258 | [0m[35m        Returns:[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/dap_service_manager.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m249 | [0m[35m[0m
[30;1m250 | [0m[35m    def _check_service_keys_exists(self, service: dict, keys: list) -> bool:[0m
[30;1m251 | [0m[35m        """[0m
[30;1m252 | [0m[35m        Check if the service keys exists.[0m
[30;1m253 | [0m[35m[0m
[30;1m254 | [0m[35m        Args:[0m
[30;1m255 | [0m[35m            service (dict): Service[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/dap_service_manager.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m230 | [0m[35m        """[0m
[30;1m231 | [0m[35m        for service_name, service in provided_services.items():[0m
[30;1m232 | [0m[35m            if not isinstance(service, dict):[0m
[30;1m233 | [0m[35m                raise ValueError(f"Invalid service {service_name}: {service}. Must be a dict.")[0m
[30;1m234 | [0m[35m            self._check_service_keys_exists([0m
[30;1m235 | [0m[35m                service,[0m
[30;1m236 | [0m[35m                [[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/dap_service_manager.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m228 | [0m[35m        Args:[0m
[30;1m229 | [0m[35m            provided_services (dict): Provided services[0m
[30;1m230 | [0m[35m        """[0m
[30;1m231 | [0m[35m        for service_name, service in provided_services.items():[0m
[30;1m232 | [0m[35m            if not isinstance(service, dict):[0m
[30;1m233 | [0m[35m                raise ValueError(f"Invalid service {service_name}: {service}. Must be a dict.")[0m
[30;1m234 | [0m[35m            self._check_service_keys_exists([0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/dap_service_manager.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m181 | [0m[35m        Update the available dap services.[0m
[30;1m182 | [0m[35m        """[0m
[30;1m183 | [0m[35m        for service in self.services:[0m
[30;1m184 | [0m[35m            self.dap_services[service.__name__] = service[0m
[30;1m185 | [0m[35m            provided_services = service.get_provided_services()[0m
[30;1m186 | [0m[35m            self._validate_provided_services(provided_services)[0m
[30;1m187 | [0m[35m            self.available_dap_services.update(service.get_provided_services())[0m
[30;1m188 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/dap_service_manager.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m180 | [0m[35m        """[0m
[30;1m181 | [0m[35m        Update the available dap services.[0m
[30;1m182 | [0m[35m        """[0m
[30;1m183 | [0m[35m        for service in self.services:[0m
[30;1m184 | [0m[35m            self.dap_services[service.__name__] = service[0m
[30;1m185 | [0m[35m            provided_services = service.get_provided_services()[0m
[30;1m186 | [0m[35m            self._validate_provided_services(provided_services)[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/dap_service_manager.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m178 | [0m[35m[0m
[30;1m179 | [0m[35m    def update_available_dap_services(self):[0m
[30;1m180 | [0m[35m        """[0m
[30;1m181 | [0m[35m        Update the available dap services.[0m
[30;1m182 | [0m[35m        """[0m
[30;1m183 | [0m[35m        for service in self.services:[0m
[30;1m184 | [0m[35m            self.dap_services[service.__name__] = service[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/async_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m397 | [0m[35m                value = np.concatenate([signal_group["value"][row_index], value])[0m
[30;1m398 | [0m[35m                signal_group["value"][row_index] = value[0m
[30;1m399 | [0m[35m        else:[0m
[30;1m400 | [0m[35m            col_index = self.cursor[signal_group.name].get(row_index, 0)[0m
[30;1m401 | [0m[35m            if col_index + len(value) > max_shape[1]:[0m
[30;1m402 | [0m[35m                self.connector.raise_alarm([0m
[30;1m403 | [0m[35m                    severity=Alarms.WARNING,[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/async_writer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m414 | [0m[35m    def write_timestamp_data(self, signal_group, value):[0m
[30;1m415 | [0m[35m        """[0m
[30;1m416 | [0m[35m        Write the timestamp data to the file.[0m
[30;1m417 | [0m[35m        Timestamp data is always written as a 1D array, irrespective of the async update type.[0m
[30;1m418 | [0m[35m[0m
[30;1m419 | [0m[35m        Args:[0m
[30;1m420 | [0m[35m            signal_group (h5py.Group): The group to write the data to[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/async_writer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m349 | [0m[35m                severity=Alarms.WARNING,[0m
[30;1m350 | [0m[35m                alarm_type="ValueError",[0m
[30;1m351 | [0m[35m                source={"device": signal_group.name},[0m
[30;1m352 | [0m[35m                msg=f"Invalid max_shape for async update type 'add_slice': {max_shape}. max_shape ca[0m
[30;1m353 | [0m[35m                metadata={},[0m
[30;1m354 | [0m[35m            )[0m
[30;1m355 | [0m[35m            return[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/async_writer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m344 | [0m[35m        max_shape: tuple = async_update["max_shape"][0m
[30;1m345 | [0m[35m[0m
[30;1m346 | [0m[35m        if len(max_shape) != 2:[0m
[30;1m347 | [0m[35m            # We currently only support 2D datasets for the 'add_slice' async update type[0m
[30;1m348 | [0m[35m            self.connector.raise_alarm([0m
[30;1m349 | [0m[35m                severity=Alarms.WARNING,[0m
[30;1m350 | [0m[35m                alarm_type="ValueError",[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/async_writer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m336 | [0m[35m        Write the value data to the file using the 'add_slice' async update type.[0m
[30;1m337 | [0m[35m[0m
[30;1m338 | [0m[35m        Args:[0m
[30;1m339 | [0m[35m            async_update (dict): The async update metadata[0m
[30;1m340 | [0m[35m            signal_group (h5py.Group): The group to write the data to[0m
[30;1m341 | [0m[35m            value (Any): The value data to write[0m
[30;1m342 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/async_writer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m333 | [0m[35m[0m
[30;1m334 | [0m[35m    def _write_value_add_slice(self, async_update: dict, signal_group: h5py.Group, value: Any):[0m
[30;1m335 | [0m[35m        """[0m
[30;1m336 | [0m[35m        Write the value data to the file using the 'add_slice' async update type.[0m
[30;1m337 | [0m[35m[0m
[30;1m338 | [0m[35m        Args:[0m
[30;1m339 | [0m[35m            async_update (dict): The async update metadata[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/async_writer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m276 | [0m[35m        Write the value data to the file using the 'add' async update type.[0m
[30;1m277 | [0m[35m[0m
[30;1m278 | [0m[35m        Args:[0m
[30;1m279 | [0m[35m            async_update (dict): The async update metadata[0m
[30;1m280 | [0m[35m            signal_group (h5py.Group): The group to write the data to[0m
[30;1m281 | [0m[35m            value (Any): The value data to write[0m
[30;1m282 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/async_writer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m273 | [0m[35m[0m
[30;1m274 | [0m[35m    def _write_value_add(self, async_update: dict, signal_group: h5py.Group, value: Any):[0m
[30;1m275 | [0m[35m        """[0m
[30;1m276 | [0m[35m        Write the value data to the file using the 'add' async update type.[0m
[30;1m277 | [0m[35m[0m
[30;1m278 | [0m[35m        Args:[0m
[30;1m279 | [0m[35m            async_update (dict): The async update metadata[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/async_writer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m267 | [0m[35m                severity=Alarms.WARNING,[0m
[30;1m268 | [0m[35m                alarm_type="ValueError",[0m
[30;1m269 | [0m[35m                source={"device": signal_group.name},[0m
[30;1m270 | [0m[35m                msg=f"Unknown async update type: {update_type}. Data will not be written.",[0m
[30;1m271 | [0m[35m                metadata={},[0m
[30;1m272 | [0m[35m            )[0m
[30;1m273 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/async_writer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m243 | [0m[35m        ###############[0m
[30;1m244 | [0m[35m        if not isinstance(async_update, dict):[0m
[30;1m245 | [0m[35m            logger.warning([0m
[30;1m246 | [0m[35m                f"Invalid async update metadata: {async_update}. Please transition your device to th[0m
[30;1m247 | [0m[35m            )[0m
[30;1m248 | [0m[35m            if async_update == "extend":[0m
[30;1m249 | [0m[35m                async_update = {"type": "add", "max_shape": [None]}[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/async_writer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m243 | [0m[35m        ###############[0m
[30;1m244 | [0m[35m        if not isinstance(async_update, dict):[0m
[30;1m245 | [0m[35m            logger.warning([0m
[30;1m246 | [0m[35m                f"Invalid async update metadata: {async_update}. Please transition your device to th[0m
[30;1m247 | [0m[35m            )[0m
[30;1m248 | [0m[35m            if async_update == "extend":[0m
[30;1m249 | [0m[35m                async_update = {"type": "add", "max_shape": [None]}[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/async_writer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m239 | [0m[35m        if isinstance(value, list):[0m
[30;1m240 | [0m[35m            value = np.array(value)[0m
[30;1m241 | [0m[35m[0m
[30;1m242 | [0m[35m        # TODO: remove once all devices have been transitioned to the new async update format[0m
[30;1m243 | [0m[35m        ###############[0m
[30;1m244 | [0m[35m        if not isinstance(async_update, dict):[0m
[30;1m245 | [0m[35m            logger.warning([0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/async_writer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m33 | [0m[35m    - add_slice: Appends a slice of data to the existing dataset. The slice is defined by the index [0m
[30;1m34 | [0m[35m    - replace: Replaces the existing dataset with the new data. Note that data is only written after[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m    To change the async update type, the device must send the async update metadata with the data. T[0m
[30;1m37 | [0m[35m    with the following structure:[0m
[30;1m38 | [0m[35m    {[0m
[30;1m39 | [0m[35m        "type": "add" | "add_slice" | "replace",[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/async_writer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m33 | [0m[35m    - add_slice: Appends a slice of data to the existing dataset. The slice is defined by the index [0m
[30;1m34 | [0m[35m    - replace: Replaces the existing dataset with the new data. Note that data is only written after[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m    To change the async update type, the device must send the async update metadata with the data. T[0m
[30;1m37 | [0m[35m    with the following structure:[0m
[30;1m38 | [0m[35m    {[0m
[30;1m39 | [0m[35m        "type": "add" | "add_slice" | "replace",[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/async_writer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m    The writer supports the following async update types:[0m
[30;1m32 | [0m[35m    - add: Appends data to the existing dataset. The data is always appended to the first axis.[0m
[30;1m33 | [0m[35m    - add_slice: Appends a slice of data to the existing dataset. The slice is defined by the index [0m
[30;1m34 | [0m[35m    - replace: Replaces the existing dataset with the new data. Note that data is only written after[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m    To change the async update type, the device must send the async update metadata with the data. T[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/async_writer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m28 | [0m[35m    """[0m
[30;1m29 | [0m[35m    Async writer for writing async device data during the scan.[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m    The writer supports the following async update types:[0m
[30;1m32 | [0m[35m    - add: Appends data to the existing dataset. The data is always appended to the first axis.[0m
[30;1m33 | [0m[35m    - add_slice: Appends a slice of data to the existing dataset. The slice is defined by the index [0m
[30;1m34 | [0m[35m    - replace: Replaces the existing dataset with the new data. Note that data is only written after[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/async_writer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m127 | [0m[35m            # self.register_async_callbacks()[0m
[30;1m128 | [0m[35m            while not self.shutdown_event.is_set():[0m
[30;1m129 | [0m[35m                self.poll_and_write_data()[0m
[30;1m130 | [0m[35m            # run one last time to get any remaining data[0m
[30;1m131 | [0m[35m            self.poll_and_write_data(final=True)[0m
[30;1m132 | [0m[35m            # self.send_file_message(done=True, successful=True)[0m
[30;1m133 | [0m[35m            logger.info(f"Finished writing async data file {self.file_path}")[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/async_writer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m88 | [0m[35m        Poll the redis stream for new data.[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m        Args:[0m
[30;1m91 | [0m[35m            poll_timeout (int, optional): The time to wait for new data before returning. Defaults t[0m
[30;1m92 | [0m[35m                it waits indefinitely. If set to None, it returns immediately.[0m
[30;1m93 | [0m[35m        """[0m
[30;1m94 | [0m[35m        # pylint: disable=protected-access[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/atlas/atlas_metadata_handler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m    def update_scan_status(self, msg: dict) -> None:[0m
[30;1m47 | [0m[35m        """[0m
[30;1m48 | [0m[35m        Update the scan status in Atlas[0m
[30;1m49 | [0m[35m        """[0m
[30;1m50 | [0m[35m        self.atlas_connector.ingest_data(msg)[0m
[30;1m51 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/atlas/atlas_metadata_handler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m41 | [0m[35m        # pylint: disable=broad-except[0m
[30;1m42 | [0m[35m        except Exception:[0m
[30;1m43 | [0m[35m            content = traceback.format_exc()[0m
[30;1m44 | [0m[35m            logger.exception(f"Failed to update scan status: {content}")[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m    def update_scan_status(self, msg: dict) -> None:[0m
[30;1m47 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1623 | [0m[35m    def _get_flyer_status(self) -> list:[0m
[30;1m1624 | [0m[35m        connector = self.device_manager.connector[0m
[30;1m1625 | [0m[35m        connector.get(MessageEndpoints.device_readback(self.flyer))[0m
[30;1m1626 | [0m[35m        return connector.get(MessageEndpoints.device_readback(self.flyer))[0m
[30;1m1627 | [0m[35m[0m
[30;1m1628 | [0m[35m    def scan_core(self):[0m
[30;1m1629 | [0m[35m        yield from self.stubs.set(device=self.flyer, value=self.positions[0][0])[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1622 | [0m[35m[0m
[30;1m1623 | [0m[35m    def _get_flyer_status(self) -> list:[0m
[30;1m1624 | [0m[35m        connector = self.device_manager.connector[0m
[30;1m1625 | [0m[35m        connector.get(MessageEndpoints.device_readback(self.flyer))[0m
[30;1m1626 | [0m[35m        return connector.get(MessageEndpoints.device_readback(self.flyer))[0m
[30;1m1627 | [0m[35m[0m
[30;1m1628 | [0m[35m    def scan_core(self):[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1245 | [0m[35m            if cont_motor_positions > self.positions[self.point_id][0]:[0m
[30;1m1246 | [0m[35m                raise ScanAbortion([0m
[30;1m1247 | [0m[35m                    f"Skipped point {self.point_id + 1}:"[0m
[30;1m1248 | [0m[35m                    f"Consider reducing speed {self.device_manager.devices[self.scan_motors[0]].velo[0m
[30;1m1249 | [0m[35m                    f"increasing the atol {self.atol}, or increasing the offset {self.offset}"[0m
[30;1m1250 | [0m[35m                )[0m
[30;1m1251 | [0m[35m        # not needed, but for clarity[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1234 | [0m[35m            if not cont_motor_positions:[0m
[30;1m1235 | [0m[35m                continue[0m
[30;1m1236 | [0m[35m[0m
[30;1m1237 | [0m[35m            cont_motor_positions = cont_motor_positions[self.scan_motors[0]].get("value")[0m
[30;1m1238 | [0m[35m            logger.debug(f"Current position of {self.scan_motors[0]}: {cont_motor_positions}")[0m
[30;1m1239 | [0m[35m            # TODO: consider the alternative, which triggers a readout for each point right after th[0m
[30;1m1240 | [0m[35m            # if cont_motor_positions > self.positions[self.point_id][0]:[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m790 | [0m[35m        for dev in self.scan_motors:[0m
[30;1m791 | [0m[35m            val = yield from self.stubs.send_rpc_and_wait(dev, "read")[0m
[30;1m792 | [0m[35m            obj = self.device_manager.devices[dev][0m
[30;1m793 | [0m[35m            self.start_pos.append(val[obj.full_name].get("value"))[0m
[30;1m794 | [0m[35m        if not self.relative:[0m
[30;1m795 | [0m[35m            return[0m
[30;1m796 | [0m[35m        self.positions += self.start_pos[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m741 | [0m[35m            *self.parameter.get("args"),[0m
[30;1m742 | [0m[35m            rpc_id=self.parameter.get("rpc_id"),[0m
[30;1m743 | [0m[35m            metadata=self.metadata,[0m
[30;1m744 | [0m[35m            **self.parameter.get("kwargs"),[0m
[30;1m745 | [0m[35m        )[0m
[30;1m746 | [0m[35m        self.stubs._status_registry.pop(status._device_instr_id)[0m
[30;1m747 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m739 | [0m[35m            self.parameter.get("device"),[0m
[30;1m740 | [0m[35m            self.parameter.get("func"),[0m
[30;1m741 | [0m[35m            *self.parameter.get("args"),[0m
[30;1m742 | [0m[35m            rpc_id=self.parameter.get("rpc_id"),[0m
[30;1m743 | [0m[35m            metadata=self.metadata,[0m
[30;1m744 | [0m[35m            **self.parameter.get("kwargs"),[0m
[30;1m745 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m738 | [0m[35m        status = yield from self.stubs.send_rpc([0m
[30;1m739 | [0m[35m            self.parameter.get("device"),[0m
[30;1m740 | [0m[35m            self.parameter.get("func"),[0m
[30;1m741 | [0m[35m            *self.parameter.get("args"),[0m
[30;1m742 | [0m[35m            rpc_id=self.parameter.get("rpc_id"),[0m
[30;1m743 | [0m[35m            metadata=self.metadata,[0m
[30;1m744 | [0m[35m            **self.parameter.get("kwargs"),[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m737 | [0m[35m        # different to calling self.device_rpc, this procedure will not wait for a reply and therefo[0m
[30;1m738 | [0m[35m        status = yield from self.stubs.send_rpc([0m
[30;1m739 | [0m[35m            self.parameter.get("device"),[0m
[30;1m740 | [0m[35m            self.parameter.get("func"),[0m
[30;1m741 | [0m[35m            *self.parameter.get("args"),[0m
[30;1m742 | [0m[35m            rpc_id=self.parameter.get("rpc_id"),[0m
[30;1m743 | [0m[35m            metadata=self.metadata,[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m736 | [0m[35m    def run(self):[0m
[30;1m737 | [0m[35m        # different to calling self.device_rpc, this procedure will not wait for a reply and therefo[0m
[30;1m738 | [0m[35m        status = yield from self.stubs.send_rpc([0m
[30;1m739 | [0m[35m            self.parameter.get("device"),[0m
[30;1m740 | [0m[35m            self.parameter.get("func"),[0m
[30;1m741 | [0m[35m            *self.parameter.get("args"),[0m
[30;1m742 | [0m[35m            rpc_id=self.parameter.get("rpc_id"),[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m679 | [0m[35m    #     connector.lrange([0m
[30;1m680 | [0m[35m    #         MessageEndpoints.device_req_status_container(self.metadata["RID"]), 0, -1, pipe[0m
[30;1m681 | [0m[35m    #     )[0m
[30;1m682 | [0m[35m    #     connector.get(MessageEndpoints.device_readback(self.flyer), pipe)[0m
[30;1m683 | [0m[35m    #     return connector.execute_pipeline(pipe)[0m
[30;1m684 | [0m[35m[0m
[30;1m685 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m489 | [0m[35m        for dev in self.scan_motors:[0m
[30;1m490 | [0m[35m            val = yield from self.stubs.send_rpc_and_wait(dev, "read")[0m
[30;1m491 | [0m[35m            obj = self.device_manager.devices[dev][0m
[30;1m492 | [0m[35m            self.start_pos.append(val[obj.full_name].get("value"))[0m
[30;1m493 | [0m[35m        if self.relative and len(self.start_pos) > 0:[0m
[30;1m494 | [0m[35m            self.positions += self.start_pos[0m
[30;1m495 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m296 | [0m[35m        """[0m
[30;1m297 | [0m[35m        if len(self.caller_args) == 0:[0m
[30;1m298 | [0m[35m            return[0m
[30;1m299 | [0m[35m        if self.arg_bundle_size.get("bundle"):[0m
[30;1m300 | [0m[35m            self.scan_motors = list(self.caller_args.keys())[0m
[30;1m301 | [0m[35m            return[0m
[30;1m302 | [0m[35m        for motor in self.caller_args:[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m213 | [0m[35m        self._shutdown_event = threading.Event()[0m
[30;1m214 | [0m[35m        self.parameter = parameter if parameter is not None else {}[0m
[30;1m215 | [0m[35m        self.caller_args = self.parameter.get("args", {})[0m
[30;1m216 | [0m[35m        self.caller_kwargs = self.parameter.get("kwargs", {})[0m
[30;1m217 | [0m[35m        self.metadata = metadata[0m
[30;1m218 | [0m[35m        self.device_manager = device_manager[0m
[30;1m219 | [0m[35m        self.connector = device_manager.connector[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m212 | [0m[35m        self.scan_id = scan_id[0m
[30;1m213 | [0m[35m        self._shutdown_event = threading.Event()[0m
[30;1m214 | [0m[35m        self.parameter = parameter if parameter is not None else {}[0m
[30;1m215 | [0m[35m        self.caller_args = self.parameter.get("args", {})[0m
[30;1m216 | [0m[35m        self.caller_kwargs = self.parameter.get("kwargs", {})[0m
[30;1m217 | [0m[35m        self.metadata = metadata[0m
[30;1m218 | [0m[35m        self.device_manager = device_manager[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1656 | [0m[35m[0m
[30;1m1657 | [0m[35m    def __init__(self, exp_time: float = 0, burst_at_each_point: int = 1, **kwargs):[0m
[30;1m1658 | [0m[35m        """[0m
[30;1m1659 | [0m[35m        A simple acquisition at the current position.[0m
[30;1m1660 | [0m[35m[0m
[30;1m1661 | [0m[35m        Args:[0m
[30;1m1662 | [0m[35m            exp_time (float): exposure time in s[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1587 | [0m[35m            device (Device): monitored device[0m
[30;1m1588 | [0m[35m            start (float): start position of the monitored device[0m
[30;1m1589 | [0m[35m            stop (float): stop position of the monitored device[0m
[30;1m1590 | [0m[35m            min_update (float): minimum update interval in seconds[0m
[30;1m1591 | [0m[35m            relative (bool): if True, the motor will be moved relative to its current position. Defa[0m
[30;1m1592 | [0m[35m[0m
[30;1m1593 | [0m[35m        Returns:[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1581 | [0m[35m        **kwargs,[0m
[30;1m1582 | [0m[35m    ):[0m
[30;1m1583 | [0m[35m        """[0m
[30;1m1584 | [0m[35m        Readout all primary devices at each update of the monitored device.[0m
[30;1m1585 | [0m[35m[0m
[30;1m1586 | [0m[35m        Args:[0m
[30;1m1587 | [0m[35m            device (Device): monitored device[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1581 | [0m[35m        **kwargs,[0m
[30;1m1582 | [0m[35m    ):[0m
[30;1m1583 | [0m[35m        """[0m
[30;1m1584 | [0m[35m        Readout all primary devices at each update of the monitored device.[0m
[30;1m1585 | [0m[35m[0m
[30;1m1586 | [0m[35m        Args:[0m
[30;1m1587 | [0m[35m            device (Device): monitored device[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1530 | [0m[35m        **kwargs,[0m
[30;1m1531 | [0m[35m    ):[0m
[30;1m1532 | [0m[35m        """[0m
[30;1m1533 | [0m[35m        Trigger and readout devices at a fixed interval.[0m
[30;1m1534 | [0m[35m        Note that the interval time cannot be less than the exposure time.[0m
[30;1m1535 | [0m[35m        The effective "sleep" time between points is[0m
[30;1m1536 | [0m[35m            sleep_time = interval - exp_time[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1364 | [0m[35m            number_of_rings (int): number of rings[0m
[30;1m1365 | [0m[35m            number_pos (int): number of positions in the first ring[0m
[30;1m1366 | [0m[35m            relative (bool): if True, the motors will be moved relative to their current position. D[0m
[30;1m1367 | [0m[35m            burst_at_each_point (int): number of exposures at each point. Default is 1.[0m
[30;1m1368 | [0m[35m[0m
[30;1m1369 | [0m[35m        Returns:[0m
[30;1m1370 | [0m[35m            ScanReport[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1150 | [0m[35m[0m
[30;1m1151 | [0m[35m    def _calculate_atol(self):[0m
[30;1m1152 | [0m[35m        """Utility function to calculate the tolerance for the scan if not provided.[0m
[30;1m1153 | [0m[35m        The tolerance is calculated at 10% of the step size, however, we take into consideration[0m
[30;1m1154 | [0m[35m        that EPICs typically only updates the position with 100ms intervals, which defines a lower l[0m
[30;1m1155 | [0m[35m        """[0m
[30;1m1156 | [0m[35m        update_freq = 10  # Hz for Epics[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1097 | [0m[35m            exp_time (float): exposure time in seconds. Default is 0.[0m
[30;1m1098 | [0m[35m            steps (int): number of steps. Default is 10.[0m
[30;1m1099 | [0m[35m            relative (bool): if True, the motors will be moved relative to their current position. D[0m
[30;1m1100 | [0m[35m            burst_at_each_point (int): number of exposures at each point. Default is 1.[0m
[30;1m1101 | [0m[35m            offset (float): offset in motor units. Default is 1.[0m
[30;1m1102 | [0m[35m            atol (float): absolute tolerance for position check. Default is 0.5.[0m
[30;1m1103 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1085 | [0m[35m     acquiring data at predefined positions. The scan will abort if the motor moves too fast to acqu[0m
[30;1m1086 | [0m[35m        given absolute tolerance.[0m
[30;1m1087 | [0m[35m        If no offset is provided, the offset is calculated as 0.5*acc_time*target_velocity.[0m
[30;1m1088 | [0m[35m        If no atol is provided, the atol is calculated at 10% of the step size, however, we take int[0m
[30;1m1089 | [0m[35m        that EPICs typically only updates the position with 100ms intervals, which defines a lower l[0m
[30;1m1090 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1082 | [0m[35m    ):[0m
[30;1m1083 | [0m[35m        """[0m
[30;1m1084 | [0m[35m        A continuous line scan. Use this scan if you want to move a motor continuously from start to[0m
[30;1m1085 | [0m[35m        acquiring data at predefined positions. The scan will abort if the motor moves too fast to a[0m
[30;1m1086 | [0m[35m        given absolute tolerance.[0m
[30;1m1087 | [0m[35m        If no offset is provided, the offset is calculated as 0.5*acc_time*target_velocity.[0m
[30;1m1088 | [0m[35m        If no atol is provided, the atol is calculated at 10% of the step size, however, we take int[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1027 | [0m[35m            number_of_rings (int): number of rings[0m
[30;1m1028 | [0m[35m            pos_in_first_ring (int): number of positions in the first ring[0m
[30;1m1029 | [0m[35m            relative (bool): if True, the motors will be moved relative to their current position. D[0m
[30;1m1030 | [0m[35m            burst_at_each_point (int): number of exposures at each point. Default is 1.[0m
[30;1m1031 | [0m[35m[0m
[30;1m1032 | [0m[35m        Returns:[0m
[30;1m1033 | [0m[35m            ScanReport[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1016 | [0m[35m        **kwargs,[0m
[30;1m1017 | [0m[35m    ):[0m
[30;1m1018 | [0m[35m        """[0m
[30;1m1019 | [0m[35m        A scan following a round shell-like pattern with increasing number of points in each ring. T[0m
[30;1m1020 | [0m[35m        The user defines the inner and outer radius, the number of rings and the number of positions[0m
[30;1m1021 | [0m[35m[0m
[30;1m1022 | [0m[35m        Args:[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m950 | [0m[35m (float): exposure time in seconds. Default is 0.[0m
[30;1m951 | [0m[35m            settling_time (float): settling time in seconds. Default is 0.[0m
[30;1m952 | [0m[35m            relative (bool): if True, the motors will be moved relative to their current position. D[0m
[30;1m953 | [0m[35m            burst_at_each_point (int): number of exposures at each point. Default is 1.[0m
[30;1m954 | [0m[35m            spiral_type (float): Angular offset (e.g. 0, 0.25,... ) in radians that determines the s[0m
[30;1m955 | [0m[35m            optim_trajectory (str): trajectory optimization method. Default is None. Options are "co[0m
[30;1m956 | [0m[35m[0m
[30;1m957 | [0m[35m        Returns:[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m880 | [0m[35m            exp_time (float): exposure time in seconds. Default is 0.[0m
[30;1m881 | [0m[35m            settling_time (float): settling time in seconds. Default is 0.[0m
[30;1m882 | [0m[35m            relative (bool): if True, the motors will be moved relative to their current position. D[0m
[30;1m883 | [0m[35m            burst_at_each_point (int): number of exposures at each point. Default is 1.[0m
[30;1m884 | [0m[35m            snaked (bool): if True, the scan will be snaked. Default is True.[0m
[30;1m885 | [0m[35m[0m
[30;1m886 | [0m[35m        Returns:[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m687 | [0m[35m    """[0m
[30;1m688 | [0m[35m    Fly scan base class for all asynchronous fly scans. An asynchronous fly scan is a scan where the[0m
[30;1m689 | [0m[35m    not synced with the monitored devices.[0m
[30;1m690 | [0m[35m    Classes inheriting from AsyncFlyScanBase must at least implement the scan_core method.[0m
[30;1m691 | [0m[35m    """[0m
[30;1m692 | [0m[35m[0m
[30;1m693 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m620 | [0m[35m    """[0m
[30;1m621 | [0m[35m    Fly scan base class for all synchronous fly scans. A synchronous fly scan is a scan where the fl[0m
[30;1m622 | [0m[35m    synced with the monitored devices.[0m
[30;1m623 | [0m[35m    Classes inheriting from SyncFlyScanBase must at least implement the scan_core method and the mon[0m
[30;1m624 | [0m[35m    """[0m
[30;1m625 | [0m[35m[0m
[30;1m626 | [0m[35m    scan_type = "fly"[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1839 | [0m[35m[0m
[30;1m1840 | [0m[35m        Args:[0m
[30;1m1841 | [0m[35m            *args: devices[0m
[30;1m1842 | [0m[35m            exp_time: exposure time in s[0m
[30;1m1843 | [0m[35m            steps: number of steps (please note: 5 steps == 6 positions)[0m
[30;1m1844 | [0m[35m            relative: Start from an absolute or relative position[0m
[30;1m1845 | [0m[35m            burst_at_each_point: number of acquisition per point[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1769 | [0m[35m[0m
[30;1m1770 | [0m[35m        Args:[0m
[30;1m1771 | [0m[35m            *args: devices[0m
[30;1m1772 | [0m[35m            exp_time: exposure time in s[0m
[30;1m1773 | [0m[35m            steps: number of steps (please note: 5 steps == 6 positions)[0m
[30;1m1774 | [0m[35m            relative: Start from an absolute or relative position[0m
[30;1m1775 | [0m[35m            burst_at_each_point: number of acquisition per point[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1728 | [0m[35m[0m
[30;1m1729 | [0m[35m        Args:[0m
[30;1m1730 | [0m[35m            *args (Device, float, float): pairs of device / start position / end position[0m
[30;1m1731 | [0m[35m            exp_time (float): exposure time in s. Default: 0[0m
[30;1m1732 | [0m[35m            steps (int): number of steps. Default: 10[0m
[30;1m1733 | [0m[35m            relative (bool): if True, the start and end positions are relative to the current positi[0m
[30;1m1734 | [0m[35m            burst_at_each_point (int): number of acquisition per point. Default: 1[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1659 | [0m[35m        A simple acquisition at the current position.[0m
[30;1m1660 | [0m[35m[0m
[30;1m1661 | [0m[35m        Args:[0m
[30;1m1662 | [0m[35m            exp_time (float): exposure time in s[0m
[30;1m1663 | [0m[35m            burst_at_each_point: number of acquisition per point[0m
[30;1m1664 | [0m[35m[0m
[30;1m1665 | [0m[35m        Returns:[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1538 | [0m[35m        Args:[0m
[30;1m1539 | [0m[35m            points: number of points[0m
[30;1m1540 | [0m[35m            interval: time interval between points[0m
[30;1m1541 | [0m[35m            exp_time: exposure time in s[0m
[30;1m1542 | [0m[35m            burst_at_each_point: number of acquisition per point[0m
[30;1m1543 | [0m[35m[0m
[30;1m1544 | [0m[35m        Returns:[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1537 | [0m[35m[0m
[30;1m1538 | [0m[35m        Args:[0m
[30;1m1539 | [0m[35m            points: number of points[0m
[30;1m1540 | [0m[35m            interval: time interval between points[0m
[30;1m1541 | [0m[35m            exp_time: exposure time in s[0m
[30;1m1542 | [0m[35m            burst_at_each_point: number of acquisition per point[0m
[30;1m1543 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1532 | [0m[35m        """[0m
[30;1m1533 | [0m[35m        Trigger and readout devices at a fixed interval.[0m
[30;1m1534 | [0m[35m        Note that the interval time cannot be less than the exposure time.[0m
[30;1m1535 | [0m[35m        The effective "sleep" time between points is[0m
[30;1m1536 | [0m[35m            sleep_time = interval - exp_time[0m
[30;1m1537 | [0m[35m[0m
[30;1m1538 | [0m[35m        Args:[0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1531 | [0m[35m    ):[0m
[30;1m1532 | [0m[35m        """[0m
[30;1m1533 | [0m[35m        Trigger and readout devices at a fixed interval.[0m
[30;1m1534 | [0m[35m        Note that the interval time cannot be less than the exposure time.[0m
[30;1m1535 | [0m[35m        The effective "sleep" time between points is[0m
[30;1m1536 | [0m[35m            sleep_time = interval - exp_time[0m
[30;1m1537 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1455 | [0m[35m            width_2 (float): width of region of interest for motor_2[0m
[30;1m1456 | [0m[35m            dr (float): shell width. Default is 1.[0m
[30;1m1457 | [0m[35m            nth (int): number of points in the first shell. Default is 5.[0m
[30;1m1458 | [0m[35m            exp_time (float): exposure time in seconds. Default is 0.[0m
[30;1m1459 | [0m[35m            relative (bool): Start from an absolute or relative position. Default is False.[0m
[30;1m1460 | [0m[35m            burst_at_each_point (int): number of acquisition per point. Default is 1.[0m
[30;1m1461 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1276 | [0m[35m            motor (DeviceBase): motor to move continuously from start to stop position[0m
[30;1m1277 | [0m[35m            start (float): start position[0m
[30;1m1278 | [0m[35m            stop (float): stop position[0m
[30;1m1279 | [0m[35m            exp_time (float): exposure time in seconds. Default is 0.[0m
[30;1m1280 | [0m[35m            relative (bool): if True, the motor will be moved relative to its current position. Defa[0m
[30;1m1281 | [0m[35m[0m
[30;1m1282 | [0m[35m        Returns:[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1195 | [0m[35m        self.time_per_step = self.dist_step / self.motor_velocity[0m
[30;1m1196 | [0m[35m        if self.time_per_step < self.exp_time:[0m
[30;1m1197 | [0m[35m            raise ScanAbortion([0m
[30;1m1198 | [0m[35m                f"Motor {self.device} is moving too fast. Time per step: {self.time_per_step:.03f} <[0m
[30;1m1199 | [0m[35m                + f" Consider reducing speed {self.motor_velocity} or reducing exp_time {self.exp_ti[0m
[30;1m1200 | [0m[35m            )[0m
[30;1m1201 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1094 | [0m[35m            device (DeviceBase): motor to move continuously from start to stop position[0m
[30;1m1095 | [0m[35m            start (float): start position[0m
[30;1m1096 | [0m[35m            stop (float): stop position[0m
[30;1m1097 | [0m[35m            exp_time (float): exposure time in seconds. Default is 0.[0m
[30;1m1098 | [0m[35m            steps (int): number of steps. Default is 10.[0m
[30;1m1099 | [0m[35m            relative (bool): if True, the motors will be moved relative to their current position. D[0m
[30;1m1100 | [0m[35m            burst_at_each_point (int): number of exposures at each point. Default is 1.[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m948 | [0m[35m            stop_motor2 (float): end position motor 2[0m
[30;1m949 | [0m[35m            step (float): step size in motor units. Default is 0.1.[0m
[30;1m950 | [0m[35m            exp_time (float): exposure time in seconds. Default is 0.[0m
[30;1m951 | [0m[35m            settling_time (float): settling time in seconds. Default is 0.[0m
[30;1m952 | [0m[35m            relative (bool): if True, the motors will be moved relative to their current position. D[0m
[30;1m953 | [0m[35m            burst_at_each_point (int): number of exposures at each point. Default is 1.[0m
[30;1m954 | [0m[35m            spiral_type (float): Angular offset (e.g. 0, 0.25,... ) in radians that determines the s[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m947 | [0m[35m            start_motor2 (float): start position motor 2[0m
[30;1m948 | [0m[35m            stop_motor2 (float): end position motor 2[0m
[30;1m949 | [0m[35m            step (float): step size in motor units. Default is 0.1.[0m
[30;1m950 | [0m[35m            exp_time (float): exposure time in seconds. Default is 0.[0m
[30;1m951 | [0m[35m            settling_time (float): settling time in seconds. Default is 0.[0m
[30;1m952 | [0m[35m            relative (bool): if True, the motors will be moved relative to their current position. D[0m
[30;1m953 | [0m[35m            burst_at_each_point (int): number of exposures at each point. Default is 1.[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m878 | [0m[35m        Args:[0m
[30;1m879 | [0m[35m            *args (Device, float, float, int): pairs of device / start / stop / steps arguments[0m
[30;1m880 | [0m[35m            exp_time (float): exposure time in seconds. Default is 0.[0m
[30;1m881 | [0m[35m            settling_time (float): settling time in seconds. Default is 0.[0m
[30;1m882 | [0m[35m            relative (bool): if True, the motors will be moved relative to their current position. D[0m
[30;1m883 | [0m[35m            burst_at_each_point (int): number of exposures at each point. Default is 1.[0m
[30;1m884 | [0m[35m            snaked (bool): if True, the scan will be snaked. Default is True.[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m877 | [0m[35m[0m
[30;1m878 | [0m[35m        Args:[0m
[30;1m879 | [0m[35m            *args (Device, float, float, int): pairs of device / start / stop / steps arguments[0m
[30;1m880 | [0m[35m            exp_time (float): exposure time in seconds. Default is 0.[0m
[30;1m881 | [0m[35m            settling_time (float): settling time in seconds. Default is 0.[0m
[30;1m882 | [0m[35m            relative (bool): if True, the motors will be moved relative to their current position. D[0m
[30;1m883 | [0m[35m            burst_at_each_point (int): number of exposures at each point. Default is 1.[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scans.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mimport ast[0m
[30;1m4 | [0m[35mimport enum[0m
[30;1m5 | [0m[35mimport threading[0m
[30;1m6 | [0m[35mimport time[0m
[30;1m7 | [0m[35mimport uuid[0m
[30;1m8 | [0m[35mfrom abc import ABC, abstractmethod[0m
[30;1m9 | [0m[35mfrom typing import TYPE_CHECKING, Any, Literal[0m
[30;1m10 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/atlas/config_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m294 | [0m[35m        Returns:[0m
[30;1m295 | [0m[35m            list: List of device configs[0m
[30;1m296 | [0m[35m        """[0m
[30;1m297 | [0m[35m        config = self.device_manager.connector.get(MessageEndpoints.device_config())[0m
[30;1m298 | [0m[35m        return config.content["resource"][0m
[30;1m299 | [0m[35m[0m
[30;1m300 | [0m[35m    def set_config_in_redis(self, config):[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/atlas/config_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m190 | [0m[35m        time_step = 0.05[0m
[30;1m191 | [0m[35m        elapsed_time = 0[0m
[30;1m192 | [0m[35m        while True:[0m
[30;1m193 | [0m[35m            msg = self.connector.get(MessageEndpoints.device_config_request_response(RID))[0m
[30;1m194 | [0m[35m            if msg:[0m
[30;1m195 | [0m[35m                return msg.content["accepted"], msg[0m
[30;1m196 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/atlas/config_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m112 | [0m[35m        self.send_config(reload_msg)[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m    def _convert_to_db_config(self, name: str, config: dict) -> None:[0m
[30;1m115 | [0m[35m        if not config.get("deviceConfig"):[0m
[30;1m116 | [0m[35m            config["deviceConfig"] = {}[0m
[30;1m117 | [0m[35m        config["name"] = name[0m
[30;1m118 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/atlas/config_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m65 | [0m[35m        msg = messages.RequestResponseMessage([0m
[30;1m66 | [0m[35m            accepted=accepted, message=error_msg, metadata=metadata[0m
[30;1m67 | [0m[35m        )[0m
[30;1m68 | [0m[35m        request_id = metadata.get("RID")[0m
[30;1m69 | [0m[35m        self.connector.set([0m
[30;1m70 | [0m[35m            MessageEndpoints.device_config_request_response(request_id), msg, expire=60[0m
[30;1m71 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/atlas/config_handler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m196 | [0m[35m[0m
[30;1m197 | [0m[35m            if elapsed_time > timeout:[0m
[30;1m198 | [0m[35m                raise TimeoutError([0m
[30;1m199 | [0m[35m                    "Reached timeout whilst waiting for a device server config reply."[0m
[30;1m200 | [0m[35m                )[0m
[30;1m201 | [0m[35m[0m
[30;1m202 | [0m[35m            time.sleep(time_step)[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/atlas/config_handler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m186 | [0m[35m        self.connector.send(MessageEndpoints.device_server_config_request(), msg)[0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35m    def _wait_for_device_server_update(self, RID: str, timeout_time=30) -> bool:[0m
[30;1m189 | [0m[35m        timeout = timeout_time[0m
[30;1m190 | [0m[35m        time_step = 0.05[0m
[30;1m191 | [0m[35m        elapsed_time = 0[0m
[30;1m192 | [0m[35m        while True:[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/atlas/config_handler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mfrom __future__ import annotations[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport os[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35mimport traceback[0m
[30;1m6 | [0m[35mimport uuid[0m
[30;1m7 | [0m[35mfrom typing import TYPE_CHECKING[0m
[30;1m8 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/atlas/config_handler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m252 | [0m[35m        Update the device config in redis[0m
[30;1m253 | [0m[35m[0m
[30;1m254 | [0m[35m        Args:[0m
[30;1m255 | [0m[35m            device (DeviceBase): Device to update[0m
[30;1m256 | [0m[35m        """[0m
[30;1m257 | [0m[35m        config = self.get_config_from_redis()[0m
[30;1m258 | [0m[35m        index = next([0m
[30;1m259 | [0m[35m            index for index, dev_conf in enumerate(config) if dev_conf["name"] == device.name[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/atlas/config_handler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m249 | [0m[35m[0m
[30;1m250 | [0m[35m    def update_config_in_redis(self, device: DeviceBase):[0m
[30;1m251 | [0m[35m        """[0m
[30;1m252 | [0m[35m        Update the device config in redis[0m
[30;1m253 | [0m[35m[0m
[30;1m254 | [0m[35m        Args:[0m
[30;1m255 | [0m[35m            device (DeviceBase): Device to update[0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/atlas/config_handler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m236 | [0m[35m        ][0m
[30;1m237 | [0m[35m        for key in dev_config:[0m
[30;1m238 | [0m[35m            if key not in available_keys:[0m
[30;1m239 | [0m[35m                raise DeviceConfigError(f"Unknown update key {key}.")[0m
[30;1m240 | [0m[35m[0m
[30;1m241 | [0m[35m            self._validate_update({key: dev_config[key]})[0m
[30;1m242 | [0m[35m            device._config[key] = dev_config[key][0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/atlas/config_handler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m220 | [0m[35m            self._update_device_server(request_id, {device.name: dev_config})[0m
[30;1m221 | [0m[35m            updated, msg = self._wait_for_device_server_update(request_id)[0m
[30;1m222 | [0m[35m            if not updated:[0m
[30;1m223 | [0m[35m                raise DeviceConfigError(f"Failed to update device {device.name}. {msg.message}")[0m
[30;1m224 | [0m[35m            dev_config.pop("enabled")[0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m        if not dev_config:[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/atlas/config_handler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m209 | [0m[35m            self._update_device_server(request_id, {device.name: dev_config})[0m
[30;1m210 | [0m[35m            updated, msg = self._wait_for_device_server_update(request_id)[0m
[30;1m211 | [0m[35m            if not updated:[0m
[30;1m212 | [0m[35m                raise DeviceConfigError(f"Failed to update device {device.name}. {msg.message}")[0m
[30;1m213 | [0m[35m            device._config["deviceConfig"].update(dev_config["deviceConfig"])[0m
[30;1m214 | [0m[35m            dev_config.pop("deviceConfig")[0m
[30;1m215 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/atlas/config_handler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m154 | [0m[35m        self._update_device_server(rid, dev_configs, action="remove")[0m
[30;1m155 | [0m[35m        accepted, server_response_msg = self._wait_for_device_server_update(rid)[0m
[30;1m156 | [0m[35m        if accepted:[0m
[30;1m157 | [0m[35m            # update config in redis[0m
[30;1m158 | [0m[35m            self.remove_devices_from_redis(dev_configs)[0m
[30;1m159 | [0m[35m            self.send_config_request_reply(accepted=True, error_msg=None, metadata=msg.metadata)[0m
[30;1m160 | [0m[35m            self.send_config(msg)[0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/atlas/config_handler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m131 | [0m[35m        self._update_device_server(rid, dev_configs, action="add")[0m
[30;1m132 | [0m[35m        accepted, server_response_msg = self._wait_for_device_server_update(rid)[0m
[30;1m133 | [0m[35m        if accepted:[0m
[30;1m134 | [0m[35m            # update config in redis[0m
[30;1m135 | [0m[35m            self.add_devices_to_redis(dev_configs)[0m
[30;1m136 | [0m[35m            self.send_config_request_reply(accepted=True, error_msg=None, metadata=msg.metadata)[0m
[30;1m137 | [0m[35m            self.send_config(msg)[0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/atlas/config_handler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m103 | [0m[35m            self.send_config(reload_msg)[0m
[30;1m104 | [0m[35m            return[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m        # the server failed to update the config and flushed the config[0m
[30;1m107 | [0m[35m        self.send_config_request_reply([0m
[30;1m108 | [0m[35m            accepted=accepted,[0m
[30;1m109 | [0m[35m            error_msg=f"{server_response_msg.message} Error during loading. The config will be flush[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/atlas/config_handler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m        msg.metadata["updated_config"] = True[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m        # update the devices in the device server[0m
[30;1m86 | [0m[35m        # if the server fails, the config is wrong[0m
[30;1m87 | [0m[35m        request_id = str(uuid.uuid4())[0m
[30;1m88 | [0m[35m        self._update_device_server(request_id, config, action="reload")[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_device_server/test_device_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m541 | [0m[35m        ) as trigger:[0m
[30;1m542 | [0m[35m            device_server._trigger_device(instr)[0m
[30;1m543 | [0m[35m            trigger.assert_called_once()[0m
[30;1m544 | [0m[35m        assert device_server.device_manager.devices.get(dev).metadata == instr.metadata[0m
[30;1m545 | [0m[35m[0m
[30;1m546 | [0m[35m[0m
[30;1m547 | [0m[35m@pytest.mark.parametrize([0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_device_server/test_device_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m537 | [0m[35m        devices = [devices][0m
[30;1m538 | [0m[35m    for dev in devices:[0m
[30;1m539 | [0m[35m        with mock.patch.object([0m
[30;1m540 | [0m[35m            device_server.device_manager.devices.get(dev).obj, "trigger"[0m
[30;1m541 | [0m[35m        ) as trigger:[0m
[30;1m542 | [0m[35m            device_server._trigger_device(instr)[0m
[30;1m543 | [0m[35m            trigger.assert_called_once()[0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_device_server/test_device_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m402 | [0m[35m    device_server = device_server_mock[0m
[30;1m403 | [0m[35m    complete_mock = mock.MagicMock()[0m
[30;1m404 | [0m[35m    device = instr.content["device"][0m
[30;1m405 | [0m[35m    oph_device = device_server.device_manager.devices.get(device)[0m
[30;1m406 | [0m[35m    if device is not None:[0m
[30;1m407 | [0m[35m        oph_device.obj.complete = complete_mock[0m
[30;1m408 | [0m[35m    device_server._complete_device(instr)[0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_device_server/test_device_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m95 | [0m[35m    device_server._update_device_metadata(instr)[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m    for dev in devices:[0m
[30;1m98 | [0m[35m        assert device_server.device_manager.devices.get(dev).metadata == instr.metadata[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m@pytest.mark.parametrize("device_manager_class", [DeviceManagerDS])[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_bundler/test_scan_bundler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m619 | [0m[35m        with mock.patch.object(sb, "_send_scan_point") as send_point:[0m
[30;1m620 | [0m[35m            sb.sync_storage[scan_id]["info"] = {"monitor_sync": "flyer"}[0m
[30;1m621 | [0m[35m            sb._fly_scan_update(scan_id, device, signal, metadata)[0m
[30;1m622 | [0m[35m            point_id = metadata.get("point_id")[0m
[30;1m623 | [0m[35m            if point_id:[0m
[30;1m624 | [0m[35m                update_signals.assert_called_once_with(scan_id, point_id)[0m
[30;1m625 | [0m[35m                send_point.assert_called_once_with(scan_id, point_id)[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_bundler/test_scan_bundler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m543 | [0m[35m                return[0m
[30;1m544 | [0m[35m[0m
[30;1m545 | [0m[35m            assert sb.sync_storage[scan_id][point_id] == {[0m
[30;1m546 | [0m[35m                **sb.sync_storage[scan_id].get(point_id, {}),[0m
[30;1m547 | [0m[35m                **dev,[0m
[30;1m548 | [0m[35m            }[0m
[30;1m549 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_bundler/test_scan_bundler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m519 | [0m[35m    metadata = scan_msg.metadata[0m
[30;1m520 | [0m[35m    scan_id = metadata.get("scan_id")[0m
[30;1m521 | [0m[35m    device = "samx"[0m
[30;1m522 | [0m[35m    signal = scan_msg.content.get("signals")[0m
[30;1m523 | [0m[35m    sb.sync_storage[scan_id] = {"info": {}, "status": "open", "sent": set()}[0m
[30;1m524 | [0m[35m    scan_motors = list(set(sb.device_manager.devices[m] for m in ["samx", "samy"]))[0m
[30;1m525 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_bundler/test_scan_bundler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m517 | [0m[35m    sb = scan_bundler_mock[0m
[30;1m518 | [0m[35m[0m
[30;1m519 | [0m[35m    metadata = scan_msg.metadata[0m
[30;1m520 | [0m[35m    scan_id = metadata.get("scan_id")[0m
[30;1m521 | [0m[35m    device = "samx"[0m
[30;1m522 | [0m[35m    signal = scan_msg.content.get("signals")[0m
[30;1m523 | [0m[35m    sb.sync_storage[scan_id] = {"info": {}, "status": "open", "sent": set()}[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_bundler/test_scan_bundler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m456 | [0m[35m            scan_msg[0m
[30;1m457 | [0m[35m        )  # The sb.device_manager.devices[m] will crash if m is not a motor in devices[0m
[30;1m458 | [0m[35m[0m
[30;1m459 | [0m[35m        if scan_msg.content.get("status") != "open":[0m
[30;1m460 | [0m[35m            return[0m
[30;1m461 | [0m[35m        assert sb.scan_motors[scan_id] == scan_motors[0m
[30;1m462 | [0m[35m        assert sb.sync_storage[scan_id] == {"info": scan_info, "status": "open", "sent": set()}[0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_bundler/test_scan_bundler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m365 | [0m[35m                else:[0m
[30;1m366 | [0m[35m                    init_mock.assert_not_called()[0m
[30;1m367 | [0m[35m[0m
[30;1m368 | [0m[35m                if scan_msg.content.get("status") != "open":[0m
[30;1m369 | [0m[35m                    status_mock.assert_called_once_with(scan_msg)[0m
[30;1m370 | [0m[35m                else:[0m
[30;1m371 | [0m[35m                    status_mock.assert_not_called()[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_bundler/test_scan_bundler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m283 | [0m[35m    sb = scan_bundler_mock[0m
[30;1m284 | [0m[35m    msg = MessageObject("", queue_msg)[0m
[30;1m285 | [0m[35m    sb._scan_queue_callback(msg)[0m
[30;1m286 | [0m[35m    assert sb.current_queue == queue_msg.content["queue"]["primary"].get("info")[0m
[30;1m287 | [0m[35m[0m
[30;1m288 | [0m[35m[0m
[30;1m289 | [0m[35m@pytest.mark.parametrize([0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scihub/test_atlas_forwarder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport pytest[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mfrom bec_lib import messages[0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_stubs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m494 | [0m[35m        msg = self.connector.get(MessageEndpoints.device_progress(device))[0m
[30;1m495 | [0m[35m        if not msg:[0m
[30;1m496 | [0m[35m            return None[0m
[30;1m497 | [0m[35m        matching_RID = msg.metadata.get("RID") == RID[0m
[30;1m498 | [0m[35m        if not matching_RID:[0m
[30;1m499 | [0m[35m            return None[0m
[30;1m500 | [0m[35m        if not isinstance(msg, messages.ProgressMessage):[0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_stubs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m491 | [0m[35m            float: reported progress value[0m
[30;1m492 | [0m[35m[0m
[30;1m493 | [0m[35m        """[0m
[30;1m494 | [0m[35m        msg = self.connector.get(MessageEndpoints.device_progress(device))[0m
[30;1m495 | [0m[35m        if not msg:[0m
[30;1m496 | [0m[35m            return None[0m
[30;1m497 | [0m[35m        matching_RID = msg.metadata.get("RID") == RID[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_stubs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m760 | [0m[35m            >>> # Trigger all devices and wait for the completion[0m
[30;1m761 | [0m[35m            >>> yield from self.stubs.trigger()[0m
[30;1m762 | [0m[35m[0m
[30;1m763 | [0m[35m            >>> # Trigger all devices and wait for the completion with a minimum wait time of 0.1 se[0m
[30;1m764 | [0m[35m            >>> yield from self.stubs.trigger(min_wait=0.1)[0m
[30;1m765 | [0m[35m[0m
[30;1m766 | [0m[35m            >>> # Trigger all devices and do not wait for the completion immediately[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_stubs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m750 | [0m[35m        On the device server, `trigger` will call the `trigger` method of the device.[0m
[30;1m751 | [0m[35m[0m
[30;1m752 | [0m[35m        Args:[0m
[30;1m753 | [0m[35m            min_wait (float, optional): Minimum wait time in seconds. Can be used to wait for at lea[0m
[30;1m754 | [0m[35m            wait (bool, optional): If True, the trigger command will wait for the completion of the [0m
[30;1m755 | [0m[35m[0m
[30;1m756 | [0m[35m        Returns:[0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_stubs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m190 | [0m[35m            logger_wait (int, optional): Time in seconds before logging the remaining status objects[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m        Raises:[0m
[30;1m193 | [0m[35m            TimeoutError: Raised if the timeout is reached.[0m
[30;1m194 | [0m[35m            DeviceInstructionError: Raised if the instruction failed.[0m
[30;1m195 | [0m[35m[0m
[30;1m196 | [0m[35m        Returns:[0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_stubs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m187 | [0m[35m        Args:[0m
[30;1m188 | [0m[35m            min_wait (float, optional): Minimum wait time in seconds. Defaults to None.[0m
[30;1m189 | [0m[35m            timeout (float, optional): Timeout in seconds. Defaults to None.[0m
[30;1m190 | [0m[35m            logger_wait (int, optional): Time in seconds before logging the remaining status objects[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m        Raises:[0m
[30;1m193 | [0m[35m            TimeoutError: Raised if the timeout is reached.[0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_stubs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m        Args:[0m
[30;1m188 | [0m[35m            min_wait (float, optional): Minimum wait time in seconds. Defaults to None.[0m
[30;1m189 | [0m[35m            timeout (float, optional): Timeout in seconds. Defaults to None.[0m
[30;1m190 | [0m[35m            logger_wait (int, optional): Time in seconds before logging the remaining status objects[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m        Raises:[0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_stubs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m        Args:[0m
[30;1m188 | [0m[35m            min_wait (float, optional): Minimum wait time in seconds. Defaults to None.[0m
[30;1m189 | [0m[35m            timeout (float, optional): Timeout in seconds. Defaults to None.[0m
[30;1m190 | [0m[35m            logger_wait (int, optional): Time in seconds before logging the remaining status objects[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m        Raises:[0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_stubs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m185 | [0m[35m        Wait for the completion of the status object.[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m        Args:[0m
[30;1m188 | [0m[35m            min_wait (float, optional): Minimum wait time in seconds. Defaults to None.[0m
[30;1m189 | [0m[35m            timeout (float, optional): Timeout in seconds. Defaults to None.[0m
[30;1m190 | [0m[35m            logger_wait (int, optional): Time in seconds before logging the remaining status objects[0m
[30;1m191 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_stubs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35mimport concurrent[0m
[30;1m9 | [0m[35mimport concurrent.futures[0m
[30;1m10 | [0m[35mimport threading[0m
[30;1m11 | [0m[35mimport time[0m
[30;1m12 | [0m[35mimport uuid[0m
[30;1m13 | [0m[35mfrom collections.abc import Callable[0m
[30;1m14 | [0m[35mfrom typing import TYPE_CHECKING, Any, Generator, Literal[0m
[30;1m15 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_stubs.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m750 | [0m[35m        On the device server, `trigger` will call the `trigger` method of the device.[0m
[30;1m751 | [0m[35m[0m
[30;1m752 | [0m[35m        Args:[0m
[30;1m753 | [0m[35m            min_wait (float, optional): Minimum wait time in seconds. Can be used to wait for at lea[0m
[30;1m754 | [0m[35m            wait (bool, optional): If True, the trigger command will wait for the completion of the [0m
[30;1m755 | [0m[35m[0m
[30;1m756 | [0m[35m        Returns:[0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_stubs.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m678 | [0m[35mall the `read` method of the device.[0m
[30;1m679 | [0m[35m[0m
[30;1m680 | [0m[35m        Args:[0m
[30;1m681 | [0m[35m            device (list[str], str, optional): Device name. Can be a list of devices or a single dev[0m
[30;1m682 | [0m[35m            point_id (int, optional): point_id to assign this reading to point within the scan. If N[0m
[30;1m683 | [0m[35m                the cache without assigning the read to a specific point. Defaults to None.[0m
[30;1m684 | [0m[35m            group (Literal["scan_motor", "monitored", None], optional): Device group. Can be used in[0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_stubs.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m331 | [0m[35m      Sending an RPC to a device often creates a strong coupling between the scan and the device.[0m
[30;1m332 | [0m[35m            While this can be useful in some cases, it is recommended to implement the desired devic[0m
[30;1m333 | [0m[35m            functionality on the device itself and simply rely on the generic scan stubs to control [0m
[30;1m334 | [0m[35m            This helps to keep the scan logic clean and the device-specific logic on the device. Mor[0m
[30;1m335 | [0m[35m            the device-specific logic is implemented on the device, it can be used in any scan witho[0m
[30;1m336 | [0m[35m            re-implement the logic in the scan.[0m
[30;1m337 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_stubs.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m247 | [0m[35m[0m
[30;1m248 | [0m[35mclass ScanStubs:[0m
[30;1m249 | [0m[35m    """[0m
[30;1m250 | [0m[35m    Scan stubs are commands that can be used to control devices during a scan. They typically yield [0m
[30;1m251 | [0m[35m    consumed by the scan worker and potentially forwarded to the device server.[0m
[30;1m252 | [0m[35m    """[0m
[30;1m253 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_stubs.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m"""[0m
[30;1m2 | [0m[35mScan stubs are commands that can be used to control devices during a scan. They typically yield devi[0m
[30;1m3 | [0m[35mconsumed by the scan worker and potentially forwarded to the device server.[0m
[30;1m4 | [0m[35m"""[0m
[30;1m5 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scan_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m282 | [0m[35m            "on_request": [],[0m
[30;1m283 | [0m[35m        }[0m
[30;1m284 | [0m[35m        open_scan_msg = list(rb.scan.open_scan())[0][0m
[30;1m285 | [0m[35m        worker._initialize_scan_info(rb, open_scan_msg, msg.content["parameter"].get("num_points"))[0m
[30;1m286 | [0m[35m[0m
[30;1m287 | [0m[35m        assert worker.current_scan_info["RID"] == "something"[0m
[30;1m288 | [0m[35m        assert worker.current_scan_info["scan_number"] == 2[0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scan_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m194 | [0m[35m                        worker.open_scan(instr)[0m
[30;1m195 | [0m[35m[0m
[30;1m196 | [0m[35m                        if not scan_id:[0m
[30;1m197 | [0m[35m                            assert worker.scan_id == instr.metadata.get("scan_id")[0m
[30;1m198 | [0m[35m                            assert worker.scan_motors == [[0m
[30;1m199 | [0m[35m                                worker.device_manager.devices["samx"],[0m
[30;1m200 | [0m[35m                                worker.device_manager.devices["samy"],[0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scan_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m179 | [0m[35m    if "point_id" in instr.metadata:[0m
[30;1m180 | [0m[35m        worker.max_point_id = instr.metadata["point_id"][0m
[30;1m181 | [0m[35m[0m
[30;1m182 | [0m[35m    assert worker.parent.connector.get(MessageEndpoints.scan_number()) == None[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m    with mock.patch.object(worker, "current_instruction_queue_item") as queue_mock:[0m
[30;1m185 | [0m[35m        with mock.patch.object(worker, "_initialize_scan_info") as init_mock:[0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_plugins/otf_scan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m87 | [0m[35m        self.flyer_positions = self.caller_args[self.flyer][0m
[30;1m88 | [0m[35m        self._current_scan_motor_index = 0[0m
[30;1m89 | [0m[35m        self._scan_motor_direction = 1[0m
[30;1m90 | [0m[35m        self.ramp_rate = self.caller_kwargs.get("ramp_rate", self.default_ramp_rate)[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m    def _calculate_positions(self) -> None:[0m
[30;1m93 | [0m[35m        self.positions = [[pos] for pos in self.caller_args[self.energy_motor]][0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_plugins/otf_scan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m24 | [0m[35m        self.scan_motors = [][0m
[30;1m25 | [0m[35m        self.num_pos = 0[0m
[30;1m26 | [0m[35m        self.mono = self.caller_kwargs.get("mono", "mono")[0m
[30;1m27 | [0m[35m        self.otf_device = self.caller_kwargs.get("otf", "otf")[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    def pre_scan(self):[0m
[30;1m30 | [0m[35m        yield None[0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_plugins/otf_scan.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m23 | [0m[35m        self.axis = [][0m
[30;1m24 | [0m[35m        self.scan_motors = [][0m
[30;1m25 | [0m[35m        self.num_pos = 0[0m
[30;1m26 | [0m[35m        self.mono = self.caller_kwargs.get("mono", "mono")[0m
[30;1m27 | [0m[35m        self.otf_device = self.caller_kwargs.get("otf", "otf")[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    def pre_scan(self):[0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_plugins/otf_scan.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom bec_lib.logger import bec_logger[0m
[30;1m4 | [0m[35mfrom bec_server.scan_server.scans import ScanArgType, ScanBase, SyncFlyScanBase[0m
[30;1m5 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/dap_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m    @property[0m
[30;1m31 | [0m[35m    def _service_id(self):[0m
[30;1m32 | [0m[35m        return f"{'_'.join([service.__name__ for service in self._provided_services])}"[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    def start(self):[0m
[30;1m35 | [0m[35m        if not self._provided_services:[0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m241 | [0m[35m        )[0m
[30;1m242 | [0m[35m        diid = instr.metadata.get("device_instr_id")[0m
[30;1m243 | [0m[35m        request = self.requests_handler.get_request(diid)[0m
[30;1m244 | [0m[35m        if request and not request.get("status_objects"):[0m
[30;1m245 | [0m[35m            self.requests_handler.set_finished(diid, success=False, error_message=error_traceback)[0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m239 | [0m[35m                device=instr.content["device"], return_val=None, out=exc_formatted, success=False[0m
[30;1m240 | [0m[35m            ),[0m
[30;1m241 | [0m[35m        )[0m
[30;1m242 | [0m[35m        diid = instr.metadata.get("device_instr_id")[0m
[30;1m243 | [0m[35m        request = self.requests_handler.get_request(diid)[0m
[30;1m244 | [0m[35m        if request and not request.get("status_objects"):[0m
[30;1m245 | [0m[35m            self.requests_handler.set_finished(diid, success=False, error_message=error_traceback)[0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m234 | [0m[35m        logger.info(f"Received exception: {exc_formatted}, {exc}")[0m
[30;1m235 | [0m[35m        instr_params = instr.content.get("parameter")[0m
[30;1m236 | [0m[35m        self.connector.set([0m
[30;1m237 | [0m[35m            MessageEndpoints.device_rpc(instr_params.get("rpc_id")),[0m
[30;1m238 | [0m[35m            messages.DeviceRPCMessage([0m
[30;1m239 | [0m[35m                device=instr.content["device"], return_val=None, out=exc_formatted, success=False[0m
[30;1m240 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m232 | [0m[35m            "traceback": error_traceback,[0m
[30;1m233 | [0m[35m        }[0m
[30;1m234 | [0m[35m        logger.info(f"Received exception: {exc_formatted}, {exc}")[0m
[30;1m235 | [0m[35m        instr_params = instr.content.get("parameter")[0m
[30;1m236 | [0m[35m        self.connector.set([0m
[30;1m237 | [0m[35m            MessageEndpoints.device_rpc(instr_params.get("rpc_id")),[0m
[30;1m238 | [0m[35m            messages.DeviceRPCMessage([0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m209 | [0m[35m        ):[0m
[30;1m210 | [0m[35m            return self._rpc_read_configuration_and_return(instr)[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m        if instr_params.get("kwargs", {}).get("_set_property"):[0m
[30;1m213 | [0m[35m            return self._handle_rpc_property_set(instr)[0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m        return self._handle_misc_rpc(instr)[0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m209 | [0m[35m        ):[0m
[30;1m210 | [0m[35m            return self._rpc_read_configuration_and_return(instr)[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m        if instr_params.get("kwargs", {}).get("_set_property"):[0m
[30;1m213 | [0m[35m            return self._handle_rpc_property_set(instr)[0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m        return self._handle_misc_rpc(instr)[0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m204 | [0m[35m            # buffered value in redis[0m
[30;1m205 | [0m[35m            return self._handle_rpc_read(instr)[0m
[30;1m206 | [0m[35m[0m
[30;1m207 | [0m[35m        if instr_params.get("func") == "read_configuration" or instr_params.get("func").endswith([0m
[30;1m208 | [0m[35m            ".read_configuration"[0m
[30;1m209 | [0m[35m        ):[0m
[30;1m210 | [0m[35m            return self._rpc_read_configuration_and_return(instr)[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m204 | [0m[35m            # buffered value in redis[0m
[30;1m205 | [0m[35m            return self._handle_rpc_read(instr)[0m
[30;1m206 | [0m[35m[0m
[30;1m207 | [0m[35m        if instr_params.get("func") == "read_configuration" or instr_params.get("func").endswith([0m
[30;1m208 | [0m[35m            ".read_configuration"[0m
[30;1m209 | [0m[35m        ):[0m
[30;1m210 | [0m[35m            return self._rpc_read_configuration_and_return(instr)[0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35m        instr_params = instr.content.get("parameter")[0m
[30;1m201 | [0m[35m[0m
[30;1m202 | [0m[35m        if instr_params.get("func") == "read" or instr_params.get("func").endswith(".read"):[0m
[30;1m203 | [0m[35m            # handle ophyd read. This is a special case because we also want to update the[0m
[30;1m204 | [0m[35m            # buffered value in redis[0m
[30;1m205 | [0m[35m            return self._handle_rpc_read(instr)[0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35m        instr_params = instr.content.get("parameter")[0m
[30;1m201 | [0m[35m[0m
[30;1m202 | [0m[35m        if instr_params.get("func") == "read" or instr_params.get("func").endswith(".read"):[0m
[30;1m203 | [0m[35m            # handle ophyd read. This is a special case because we also want to update the[0m
[30;1m204 | [0m[35m            # buffered value in redis[0m
[30;1m205 | [0m[35m            return self._handle_rpc_read(instr)[0m

[31m--[ [0m[34mMatch #[0m[33m232[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m197 | [0m[35m            Any: Result of RPC instruction[0m
[30;1m198 | [0m[35m        """[0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35m        instr_params = instr.content.get("parameter")[0m
[30;1m201 | [0m[35m[0m
[30;1m202 | [0m[35m        if instr_params.get("func") == "read" or instr_params.get("func").endswith(".read"):[0m
[30;1m203 | [0m[35m            # handle ophyd read. This is a special case because we also want to update the[0m

[31m--[ [0m[34mMatch #[0m[33m233[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m178 | [0m[35m            # convert namedtuple to dict[0m
[30;1m179 | [0m[35m            res = {[0m
[30;1m180 | [0m[35m                "type": "namedtuple",[0m
[30;1m181 | [0m[35m                "RID": instr.metadata.get("RID"),[0m
[30;1m182 | [0m[35m                "fields": res._fields,[0m
[30;1m183 | [0m[35m                "values": res._asdict(),[0m
[30;1m184 | [0m[35m            }[0m

[31m--[ [0m[34mMatch #[0m[33m234[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m168 | [0m[35m            self.requests_handler.add_status_object(instr.metadata["device_instr_id"], res)[0m
[30;1m169 | [0m[35m            res = {[0m
[30;1m170 | [0m[35m                "type": "status",[0m
[30;1m171 | [0m[35m                "RID": instr.metadata.get("RID"),[0m
[30;1m172 | [0m[35m                "success": res.success,[0m
[30;1m173 | [0m[35m                "timeout": res.timeout,[0m
[30;1m174 | [0m[35m                "done": res.done,[0m

[31m--[ [0m[34mMatch #[0m[33m235[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m159 | [0m[35m        elif instr_params.get("func").endswith(".get"):[0m
[30;1m160 | [0m[35m            obj = rgetattr([0m
[30;1m161 | [0m[35m                self.device_manager.devices[device_root].obj,[0m
[30;1m162 | [0m[35m                instr_params.get("func").split(".get")[0],[0m
[30;1m163 | [0m[35m            )[0m
[30;1m164 | [0m[35m            self._update_cache(obj, instr)[0m
[30;1m165 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m236[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m156 | [0m[35m                instr_params.get("func").split(".put")[0],[0m
[30;1m157 | [0m[35m            )[0m
[30;1m158 | [0m[35m            self._update_cache(obj, instr)[0m
[30;1m159 | [0m[35m        elif instr_params.get("func").endswith(".get"):[0m
[30;1m160 | [0m[35m            obj = rgetattr([0m
[30;1m161 | [0m[35m                self.device_manager.devices[device_root].obj,[0m
[30;1m162 | [0m[35m                instr_params.get("func").split(".get")[0],[0m

[31m--[ [0m[34mMatch #[0m[33m237[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m153 | [0m[35m        elif instr_params.get("func").endswith(".put"):[0m
[30;1m154 | [0m[35m            obj = rgetattr([0m
[30;1m155 | [0m[35m                self.device_manager.devices[device_root].obj,[0m
[30;1m156 | [0m[35m                instr_params.get("func").split(".put")[0],[0m
[30;1m157 | [0m[35m            )[0m
[30;1m158 | [0m[35m            self._update_cache(obj, instr)[0m
[30;1m159 | [0m[35m        elif instr_params.get("func").endswith(".get"):[0m

[31m--[ [0m[34mMatch #[0m[33m238[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m150 | [0m[35m        if instr_params.get("func") in ["put", "get"]:[0m
[30;1m151 | [0m[35m            obj = self.device_manager.devices[device_root].obj[0m
[30;1m152 | [0m[35m            self._update_cache(obj, instr)[0m
[30;1m153 | [0m[35m        elif instr_params.get("func").endswith(".put"):[0m
[30;1m154 | [0m[35m            obj = rgetattr([0m
[30;1m155 | [0m[35m                self.device_manager.devices[device_root].obj,[0m
[30;1m156 | [0m[35m                instr_params.get("func").split(".put")[0],[0m

[31m--[ [0m[34mMatch #[0m[33m239[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m147 | [0m[35m        res = self._get_result_from_rpc(rpc_var, instr_params)[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m        # update the cache for value-updating functions[0m
[30;1m150 | [0m[35m        if instr_params.get("func") in ["put", "get"]:[0m
[30;1m151 | [0m[35m            obj = self.device_manager.devices[device_root].obj[0m
[30;1m152 | [0m[35m            self._update_cache(obj, instr)[0m
[30;1m153 | [0m[35m        elif instr_params.get("func").endswith(".put"):[0m

[31m--[ [0m[34mMatch #[0m[33m240[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m143 | [0m[35m        instr_params = instr.content.get("parameter")[0m
[30;1m144 | [0m[35m        device_root = instr.content["device"].split(".")[0][0m
[30;1m145 | [0m[35m        obj = self.device_manager.devices[device_root].obj[0m
[30;1m146 | [0m[35m        rpc_var = rgetattr(obj, instr_params.get("func"))[0m
[30;1m147 | [0m[35m        res = self._get_result_from_rpc(rpc_var, instr_params)[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m        # update the cache for value-updating functions[0m

[31m--[ [0m[34mMatch #[0m[33m241[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m140 | [0m[35m        setattr(obj, property_name, instr_params.get("args")[0])[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m    def _handle_misc_rpc(self, instr: messages.DeviceInstructionMessage) -> Any:[0m
[30;1m143 | [0m[35m        instr_params = instr.content.get("parameter")[0m
[30;1m144 | [0m[35m        device_root = instr.content["device"].split(".")[0][0m
[30;1m145 | [0m[35m        obj = self.device_manager.devices[device_root].obj[0m
[30;1m146 | [0m[35m        rpc_var = rgetattr(obj, instr_params.get("func"))[0m

[31m--[ [0m[34mMatch #[0m[33m242[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m137 | [0m[35m        obj = self.device_manager.devices[device_root].obj[0m
[30;1m138 | [0m[35m        if sub_access:[0m
[30;1m139 | [0m[35m            obj = rgetattr(obj, ".".join(sub_access))[0m
[30;1m140 | [0m[35m        setattr(obj, property_name, instr_params.get("args")[0])[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m    def _handle_misc_rpc(self, instr: messages.DeviceInstructionMessage) -> Any:[0m
[30;1m143 | [0m[35m        instr_params = instr.content.get("parameter")[0m

[31m--[ [0m[34mMatch #[0m[33m243[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m128 | [0m[35m    def _handle_rpc_property_set(self, instr: messages.DeviceInstructionMessage) -> None:[0m
[30;1m129 | [0m[35m        instr_params = instr.content.get("parameter")[0m
[30;1m130 | [0m[35m        device_root = instr.content["device"].split(".")[0][0m
[30;1m131 | [0m[35m        sub_access = instr_params.get("func").split(".")[0m
[30;1m132 | [0m[35m        property_name = sub_access[-1][0m
[30;1m133 | [0m[35m        if len(sub_access) > 1:[0m
[30;1m134 | [0m[35m            sub_access = sub_access[0:-1][0m

[31m--[ [0m[34mMatch #[0m[33m244[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m126 | [0m[35m        return self._rpc_read_and_return(instr)[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    def _handle_rpc_property_set(self, instr: messages.DeviceInstructionMessage) -> None:[0m
[30;1m129 | [0m[35m        instr_params = instr.content.get("parameter")[0m
[30;1m130 | [0m[35m        device_root = instr.content["device"].split(".")[0][0m
[30;1m131 | [0m[35m        sub_access = instr_params.get("func").split(".")[0m
[30;1m132 | [0m[35m        property_name = sub_access[-1][0m

[31m--[ [0m[34mMatch #[0m[33m245[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m114 | [0m[35m        else:[0m
[30;1m115 | [0m[35m            obj = rgetattr([0m
[30;1m116 | [0m[35m                self.device_manager.devices[device_root].obj,[0m
[30;1m117 | [0m[35m                instr_params.get("func").split(".read")[0],[0m
[30;1m118 | [0m[35m            )[0m
[30;1m119 | [0m[35m        if hasattr(obj, "kind"):[0m
[30;1m120 | [0m[35m            if obj.kind not in [ophyd.Kind.omitted, ophyd.Kind.config]:[0m

[31m--[ [0m[34mMatch #[0m[33m246[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m109 | [0m[35m    def _handle_rpc_read(self, instr: messages.DeviceInstructionMessage) -> Any:[0m
[30;1m110 | [0m[35m        instr_params = instr.content.get("parameter")[0m
[30;1m111 | [0m[35m        device_root = instr.content["device"].split(".")[0][0m
[30;1m112 | [0m[35m        if instr_params.get("func") == "read":[0m
[30;1m113 | [0m[35m            obj = self.device_manager.devices[device_root].obj[0m
[30;1m114 | [0m[35m        else:[0m
[30;1m115 | [0m[35m            obj = rgetattr([0m

[31m--[ [0m[34mMatch #[0m[33m247[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m107 | [0m[35m        return res[0m
[30;1m108 | [0m[35m[0m
[30;1m109 | [0m[35m    def _handle_rpc_read(self, instr: messages.DeviceInstructionMessage) -> Any:[0m
[30;1m110 | [0m[35m        instr_params = instr.content.get("parameter")[0m
[30;1m111 | [0m[35m        device_root = instr.content["device"].split(".")[0][0m
[30;1m112 | [0m[35m        if instr_params.get("func") == "read":[0m
[30;1m113 | [0m[35m            obj = self.device_manager.devices[device_root].obj[0m

[31m--[ [0m[34mMatch #[0m[33m248[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m87 | [0m[35m        if request and not request.get("status_objects"):[0m
[30;1m88 | [0m[35m            self.requests_handler.set_finished(diid, success=True, result=res)[0m
[30;1m89 | [0m[35m        self.connector.set([0m
[30;1m90 | [0m[35m            MessageEndpoints.device_rpc(instr_params.get("rpc_id")),[0m
[30;1m91 | [0m[35m            messages.DeviceRPCMessage([0m
[30;1m92 | [0m[35m                device=device, return_val=res, out=result.getvalue(), success=True[0m
[30;1m93 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m249[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m84 | [0m[35m        request = self.requests_handler.get_request(diid)[0m
[30;1m85 | [0m[35m        # if the request was already resolved by a status object,[0m
[30;1m86 | [0m[35m        # we won't find it in the requests_handler[0m
[30;1m87 | [0m[35m        if request and not request.get("status_objects"):[0m
[30;1m88 | [0m[35m            self.requests_handler.set_finished(diid, success=True, result=res)[0m
[30;1m89 | [0m[35m        self.connector.set([0m
[30;1m90 | [0m[35m            MessageEndpoints.device_rpc(instr_params.get("rpc_id")),[0m

[31m--[ [0m[34mMatch #[0m[33m250[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m80 | [0m[35m        res: Any,[0m
[30;1m81 | [0m[35m        result: StringIO,[0m
[30;1m82 | [0m[35m    ):[0m
[30;1m83 | [0m[35m        diid = instr.metadata.get("device_instr_id")[0m
[30;1m84 | [0m[35m        request = self.requests_handler.get_request(diid)[0m
[30;1m85 | [0m[35m        # if the request was already resolved by a status object,[0m
[30;1m86 | [0m[35m        # we won't find it in the requests_handler[0m

[31m--[ [0m[34mMatch #[0m[33m251[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m        if not is_serializable(res):[0m
[30;1m60 | [0m[35m            if isinstance(res, ophyd.StatusBase):[0m
[30;1m61 | [0m[35m                return res[0m
[30;1m62 | [0m[35m            if isinstance(res, list) and instr_params.get("func") in ["stage", "unstage"]:[0m
[30;1m63 | [0m[35m                # pylint: disable=protected-access[0m
[30;1m64 | [0m[35m                return [obj._staged for obj in res][0m
[30;1m65 | [0m[35m            res = None[0m

[31m--[ [0m[34mMatch #[0m[33m252[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35m    def _get_result_from_rpc(self, rpc_var: Any, instr_params: dict) -> Any:[0m
[30;1m46 | [0m[35m        if callable(rpc_var):[0m
[30;1m47 | [0m[35m            args = tuple(instr_params.get("args", ()))[0m
[30;1m48 | [0m[35m            kwargs = instr_params.get("kwargs", {})[0m
[30;1m49 | [0m[35m            if args and kwargs:[0m
[30;1m50 | [0m[35m                res = rpc_var(*args, **kwargs)[0m
[30;1m51 | [0m[35m            elif args:[0m

[31m--[ [0m[34mMatch #[0m[33m253[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m    def _get_result_from_rpc(self, rpc_var: Any, instr_params: dict) -> Any:[0m
[30;1m46 | [0m[35m        if callable(rpc_var):[0m
[30;1m47 | [0m[35m            args = tuple(instr_params.get("args", ()))[0m
[30;1m48 | [0m[35m            kwargs = instr_params.get("kwargs", {})[0m
[30;1m49 | [0m[35m            if args and kwargs:[0m
[30;1m50 | [0m[35m                res = rpc_var(*args, **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m254[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m        with redirect_stdout(result):[0m
[30;1m32 | [0m[35m            try:[0m
[30;1m33 | [0m[35m                self.requests_handler.add_request(instr, num_status_objects=1)[0m
[30;1m34 | [0m[35m                instr_params = instr.content.get("parameter")[0m
[30;1m35 | [0m[35m                device = instr.content["device"][0m
[30;1m36 | [0m[35m                self._assert_device_is_enabled(instr)[0m
[30;1m37 | [0m[35m                res = self.process_rpc_instruction(instr)[0m

[31m--[ [0m[34mMatch #[0m[33m255[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m200 | [0m[35m        instr_params = instr.content.get("parameter")[0m
[30;1m201 | [0m[35m[0m
[30;1m202 | [0m[35m        if instr_params.get("func") == "read" or instr_params.get("func").endswith(".read"):[0m
[30;1m203 | [0m[35m            # handle ophyd read. This is a special case because we also want to update the[0m
[30;1m204 | [0m[35m            # buffered value in redis[0m
[30;1m205 | [0m[35m            return self._handle_rpc_read(instr)[0m
[30;1m206 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m256[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m146 | [0m[35m        rpc_var = rgetattr(obj, instr_params.get("func"))[0m
[30;1m147 | [0m[35m        res = self._get_result_from_rpc(rpc_var, instr_params)[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m        # update the cache for value-updating functions[0m
[30;1m150 | [0m[35m        if instr_params.get("func") in ["put", "get"]:[0m
[30;1m151 | [0m[35m            obj = self.device_manager.devices[device_root].obj[0m
[30;1m152 | [0m[35m            self._update_cache(obj, instr)[0m

[31m--[ [0m[34mMatch #[0m[33m257[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/rpc_mixin.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m83 | [0m[35m        diid = instr.metadata.get("device_instr_id")[0m
[30;1m84 | [0m[35m        request = self.requests_handler.get_request(diid)[0m
[30;1m85 | [0m[35m        # if the request was already resolved by a status object,[0m
[30;1m86 | [0m[35m        # we won't find it in the requests_handler[0m
[30;1m87 | [0m[35m        if request and not request.get("status_objects"):[0m
[30;1m88 | [0m[35m            self.requests_handler.set_finished(diid, success=True, result=res)[0m
[30;1m89 | [0m[35m        self.connector.set([0m

[31m--[ [0m[34mMatch #[0m[33m258[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_guard.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m186 | [0m[35m        mod_msg = msg[0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35m        if mod_msg.content.get("action") == "restart":[0m
[30;1m189 | [0m[35m            RID = mod_msg.content["parameter"].get("RID")[0m
[30;1m190 | [0m[35m            if RID:[0m
[30;1m191 | [0m[35m                mod_msg.metadata["RID"] = RID[0m
[30;1m192 | [0m[35m                self._send_scan_request_response(ScanStatus(), mod_msg.metadata)[0m

[31m--[ [0m[34mMatch #[0m[33m259[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_guard.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m185 | [0m[35m        """[0m
[30;1m186 | [0m[35m        mod_msg = msg[0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35m        if mod_msg.content.get("action") == "restart":[0m
[30;1m189 | [0m[35m            RID = mod_msg.content["parameter"].get("RID")[0m
[30;1m190 | [0m[35m            if RID:[0m
[30;1m191 | [0m[35m                mod_msg.metadata["RID"] = RID[0m

[31m--[ [0m[34mMatch #[0m[33m260[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_guard.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m105 | [0m[35m                if not self.device_manager.devices[dev].enabled:[0m
[30;1m106 | [0m[35m                    raise ScanRejection(f"Device {dev} is not enabled.")[0m
[30;1m107 | [0m[35m            return[0m
[30;1m108 | [0m[35m        motor_args = request.content["parameter"].get("args")[0m
[30;1m109 | [0m[35m        if not motor_args:[0m
[30;1m110 | [0m[35m            return[0m
[30;1m111 | [0m[35m        for motor in motor_args:[0m

[31m--[ [0m[34mMatch #[0m[33m261[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_guard.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m82 | [0m[35m        if scan_type == "device_rpc":[0m
[30;1m83 | [0m[35m            # ensure that the requested rpc is allowed for this particular device[0m
[30;1m84 | [0m[35m            params = request.content.get("parameter")[0m
[30;1m85 | [0m[35m            if not self._device_rpc_is_valid(device=params.get("device"), func=params.get("func")):[0m
[30;1m86 | [0m[35m                raise ScanRejection(f"Rejected rpc: {request.content}")[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m    def _device_rpc_is_valid(self, device: str, func: str) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m262[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_guard.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m82 | [0m[35m        if scan_type == "device_rpc":[0m
[30;1m83 | [0m[35m            # ensure that the requested rpc is allowed for this particular device[0m
[30;1m84 | [0m[35m            params = request.content.get("parameter")[0m
[30;1m85 | [0m[35m            if not self._device_rpc_is_valid(device=params.get("device"), func=params.get("func")):[0m
[30;1m86 | [0m[35m                raise ScanRejection(f"Rejected rpc: {request.content}")[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m    def _device_rpc_is_valid(self, device: str, func: str) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m263[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_guard.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m        if scan_type == "device_rpc":[0m
[30;1m83 | [0m[35m            # ensure that the requested rpc is allowed for this particular device[0m
[30;1m84 | [0m[35m            params = request.content.get("parameter")[0m
[30;1m85 | [0m[35m            if not self._device_rpc_is_valid(device=params.get("device"), func=params.get("func")):[0m
[30;1m86 | [0m[35m                raise ScanRejection(f"Rejected rpc: {request.content}")[0m
[30;1m87 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m264[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_guard.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m    def _check_valid_scan(self, request) -> None:[0m
[30;1m77 | [0m[35m        avail_scans = self.connector.get(MessageEndpoints.available_scans())[0m
[30;1m78 | [0m[35m        scan_type = request.content.get("scan_type")[0m
[30;1m79 | [0m[35m        if scan_type not in avail_scans.resource:[0m
[30;1m80 | [0m[35m            raise ScanRejection(f"Unknown scan type {scan_type}.")[0m
[30;1m81 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m265[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_guard.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m74 | [0m[35m            raise ScanRejection("Invalid request.")[0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m    def _check_valid_scan(self, request) -> None:[0m
[30;1m77 | [0m[35m        avail_scans = self.connector.get(MessageEndpoints.available_scans())[0m
[30;1m78 | [0m[35m        scan_type = request.content.get("scan_type")[0m
[30;1m79 | [0m[35m        if scan_type not in avail_scans.resource:[0m
[30;1m80 | [0m[35m            raise ScanRejection(f"Unknown scan type {scan_type}.")[0m

[31m--[ [0m[34mMatch #[0m[33m266[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/bluesky_emitter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m120 | [0m[35m            time.sleep(0.01)[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m        bls_event = {[0m
[30;1m123 | [0m[35m            "descriptor": metadata["descriptor"].get("uid"),[0m
[30;1m124 | [0m[35m            "time": time.time(),[0m
[30;1m125 | [0m[35m            "seq_num": point_id,[0m
[30;1m126 | [0m[35m            "uid": str(uuid.uuid4()),[0m

[31m--[ [0m[34mMatch #[0m[33m267[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/bluesky_emitter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m116 | [0m[35m        # }[0m
[30;1m117 | [0m[35m        sb = self.scan_bundler[0m
[30;1m118 | [0m[35m        metadata = self.bluesky_metadata[scan_id][0m
[30;1m119 | [0m[35m        while not metadata.get("descriptor"):[0m
[30;1m120 | [0m[35m            time.sleep(0.01)[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m        bls_event = {[0m

[31m--[ [0m[34mMatch #[0m[33m268[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/bluesky_emitter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m63 | [0m[35m            "name": "primary",[0m
[30;1m64 | [0m[35m            "hints": {"samx": {"fields": ["samx"]}, "samy": {"fields": ["samy"]}},[0m
[30;1m65 | [0m[35m            "object_keys": {[0m
[30;1m66 | [0m[35m                dev.name: [val for val in dev._info.get("signals", {})][0m
[30;1m67 | [0m[35m                for dev in sb.monitored_devices[scan_id]["devices"][0m
[30;1m68 | [0m[35m            },[0m
[30;1m69 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m269[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/bluesky_emitter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m        signals = {}[0m
[30;1m50 | [0m[35m        for dev in sb.monitored_devices[scan_id]["devices"]:[0m
[30;1m51 | [0m[35m            # copied from bluesky/callbacks/stream.py:[0m
[30;1m52 | [0m[35m            signals[dev.name] = sb.device_manager.devices[dev.name]._info.get("describe", {})[0m
[30;1m53 | [0m[35m        return signals[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m    def _get_descriptor_document(self, scan_id) -> dict:[0m

[31m--[ [0m[34mMatch #[0m[33m270[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/bluesky_emitter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mfrom __future__ import annotations[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mimport uuid[0m
[30;1m5 | [0m[35mfrom typing import TYPE_CHECKING[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mimport msgpack[0m

[31m--[ [0m[34mMatch #[0m[33m271[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_queue.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1008 | [0m[35m                self.queue_group_is_closed = True[0m
[30;1m1009 | [0m[35m                raise StopIteration[0m
[30;1m1010 | [0m[35m            if instr.content.get("action") == "close_scan_def":[0m
[30;1m1011 | [0m[35m                scan_def_id = instr.metadata.get("scan_def_id")[0m
[30;1m1012 | [0m[35m                if scan_def_id in self.queue.scan_def_ids:[0m
[30;1m1013 | [0m[35m                    self.queue.scan_def_ids.pop(scan_def_id)[0m
[30;1m1014 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m272[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_queue.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1007 | [0m[35m            if instr.content.get("action") == "close_scan_group":[0m
[30;1m1008 | [0m[35m                self.queue_group_is_closed = True[0m
[30;1m1009 | [0m[35m                raise StopIteration[0m
[30;1m1010 | [0m[35m            if instr.content.get("action") == "close_scan_def":[0m
[30;1m1011 | [0m[35m                scan_def_id = instr.metadata.get("scan_def_id")[0m
[30;1m1012 | [0m[35m                if scan_def_id in self.queue.scan_def_ids:[0m
[30;1m1013 | [0m[35m                    self.queue.scan_def_ids.pop(scan_def_id)[0m

[31m--[ [0m[34mMatch #[0m[33m273[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_queue.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1004 | [0m[35m            # instr = next(self.__getattribute__(queue))[0m
[30;1m1005 | [0m[35m            if not instr:[0m
[30;1m1006 | [0m[35m                return None[0m
[30;1m1007 | [0m[35m            if instr.content.get("action") == "close_scan_group":[0m
[30;1m1008 | [0m[35m                self.queue_group_is_closed = True[0m
[30;1m1009 | [0m[35m                raise StopIteration[0m
[30;1m1010 | [0m[35m            if instr.content.get("action") == "close_scan_def":[0m

[31m--[ [0m[34mMatch #[0m[33m274[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_queue.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m812 | [0m[35m            "_close_interactive_scan",[0m
[30;1m813 | [0m[35m        ]:[0m
[30;1m814 | [0m[35m            self.scan_queue.queue_manager.parent.scan_number += 1[0m
[30;1m815 | [0m[35m            if not rbl.msg.metadata.get("dataset_id_on_hold"):[0m
[30;1m816 | [0m[35m                self.scan_queue.queue_manager.parent.dataset_number += 1[0m
[30;1m817 | [0m[35m        return[0m
[30;1m818 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m275[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_queue.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m666 | [0m[35m[0m
[30;1m667 | [0m[35m    @property[0m
[30;1m668 | [0m[35m    def scan_def_id(self):[0m
[30;1m669 | [0m[35m        return self.msg.metadata.get("scan_def_id")[0m
[30;1m670 | [0m[35m[0m
[30;1m671 | [0m[35m    @property[0m
[30;1m672 | [0m[35m    def metadata(self):[0m

[31m--[ [0m[34mMatch #[0m[33m276[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_queue.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m567 | [0m[35m            logger.info("Waiting for worker to become active.")[0m
[30;1m568 | [0m[35m            time.sleep(0.1)[0m
[30;1m569 | [0m[35m        target_group = msg.metadata.get("queue_group")[0m
[30;1m570 | [0m[35m        scan_def_id = msg.metadata.get("scan_def_id")[0m
[30;1m571 | [0m[35m        logger.debug(f"Inserting new queue message {msg}")[0m
[30;1m572 | [0m[35m        instruction_queue = None[0m
[30;1m573 | [0m[35m        queue_exists = False[0m

[31m--[ [0m[34mMatch #[0m[33m277[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_queue.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m566 | [0m[35m        while self.worker_status == InstructionQueueStatus.STOPPED:[0m
[30;1m567 | [0m[35m            logger.info("Waiting for worker to become active.")[0m
[30;1m568 | [0m[35m            time.sleep(0.1)[0m
[30;1m569 | [0m[35m        target_group = msg.metadata.get("queue_group")[0m
[30;1m570 | [0m[35m        scan_def_id = msg.metadata.get("scan_def_id")[0m
[30;1m571 | [0m[35m        logger.debug(f"Inserting new queue message {msg}")[0m
[30;1m572 | [0m[35m        instruction_queue = None[0m

[31m--[ [0m[34mMatch #[0m[33m278[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_queue.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m392 | [0m[35m                )[0m
[30;1m393 | [0m[35m            with console.capture() as capture:[0m
[30;1m394 | [0m[35m                console.print(table)[0m
[30;1m395 | [0m[35m            queue_tables.append(capture.get())[0m
[30;1m396 | [0m[35m[0m
[30;1m397 | [0m[35m        return queue_tables[0m
[30;1m398 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m279[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_queue.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m318 | [0m[35m        instruction_queue = self._wait_for_queue_to_appear_in_history(scan_id, queue)[0m
[30;1m319 | [0m[35m        self._lock.acquire()[0m
[30;1m320 | [0m[35m        scan_msg = instruction_queue.scan_msgs[0][0m
[30;1m321 | [0m[35m        RID = parameter.get("RID")[0m
[30;1m322 | [0m[35m        if RID:[0m
[30;1m323 | [0m[35m            scan_msg.metadata["RID"] = RID[0m
[30;1m324 | [0m[35m        self.queues[queue].worker_status = InstructionQueueStatus.RUNNING[0m

[31m--[ [0m[34mMatch #[0m[33m280[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_queue.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m232 | [0m[35m            logger.info(f"Scan interception: {scan_mod_msg}")[0m
[30;1m233 | [0m[35m            action = scan_mod_msg.content["action"][0m
[30;1m234 | [0m[35m            parameter = scan_mod_msg.content["parameter"][0m
[30;1m235 | [0m[35m            queue = scan_mod_msg.content.get("queue", "primary")[0m
[30;1m236 | [0m[35m            getattr(self, f"set_{action}")([0m
[30;1m237 | [0m[35m                scan_id=scan_mod_msg.content["scan_id"], queue=queue, parameter=parameter[0m
[30;1m238 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m281[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_queue.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m127 | [0m[35m        scan_msg = msg.value[0m
[30;1m128 | [0m[35m        logger.info(f"Receiving scan: {scan_msg.content}")[0m
[30;1m129 | [0m[35m        # instructions = parent.scan_assembler.assemble_device_instructions(scan_msg)[0m
[30;1m130 | [0m[35m        queue = scan_msg.content.get("queue", "primary")[0m
[30;1m131 | [0m[35m        parent.add_to_queue(queue, scan_msg)[0m
[30;1m132 | [0m[35m        parent.send_queue_status()[0m
[30;1m133 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m282[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_queue.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m332 | [0m[35m        return self.queues[queue].queue[0].active_request_block.scan_id[0m
[30;1m333 | [0m[35m[0m
[30;1m334 | [0m[35m    def _wait_for_queue_to_appear_in_history(self, scan_id, queue, timeout=10):[0m
[30;1m335 | [0m[35m        timeout_time = timeout[0m
[30;1m336 | [0m[35m        elapsed_time = 0[0m
[30;1m337 | [0m[35m        while True:[0m
[30;1m338 | [0m[35m            if elapsed_time > timeout_time:[0m
[30;1m339 | [0m[35m                raise TimeoutError([0m

[31m--[ [0m[34mMatch #[0m[33m283[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_queue.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m188 | [0m[35m                queue.insert(idx + 1, queue_item)[0m
[30;1m189 | [0m[35m[0m
[30;1m190 | [0m[35m            if msg.action == "move_top":[0m
[30;1m191 | [0m[35m                # move the scan to the top of the queue[0m
[30;1m192 | [0m[35m                queue.remove(queue_item)[0m
[30;1m193 | [0m[35m                queue.insert(0, queue_item)[0m
[30;1m194 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m284[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_queue.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mimport collections[0m
[30;1m4 | [0m[35mimport functools[0m
[30;1m5 | [0m[35mimport threading[0m
[30;1m6 | [0m[35mimport time[0m
[30;1m7 | [0m[35mimport traceback[0m
[30;1m8 | [0m[35mimport uuid[0m
[30;1m9 | [0m[35mfrom enum import Enum[0m
[30;1m10 | [0m[35mfrom typing import TYPE_CHECKING, Deque[0m

[31m--[ [0m[34mMatch #[0m[33m285[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_queue.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m905 | [0m[35m    @status.setter[0m
[30;1m906 | [0m[35m    def status(self, val: InstructionQueueStatus) -> None:[0m
[30;1m907 | [0m[35m        """update the status of the instruction queue. By doing so, it will[0m
[30;1m908 | [0m[35m        also update its worker and publish the updated queue."""[0m
[30;1m909 | [0m[35m        logger.info([0m
[30;1m910 | [0m[35m            f"Setting status of instruction queue {self.queue_id} to {val.name} from thread {threadi[0m
[30;1m911 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m286[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_queue.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m862 | [0m[35mclass InstructionQueueItem:[0m
[30;1m863 | [0m[35m    """The InstructionQueueItem contains and manages the request blocks for a queue item.[0m
[30;1m864 | [0m[35m    While an InstructionQueueItem can be comprised of multiple requests,[0m
[30;1m865 | [0m[35m    it will always have at max one scan_number / scan_id.[0m
[30;1m866 | [0m[35m[0m
[30;1m867 | [0m[35m    Raises:[0m
[30;1m868 | [0m[35m        StopIteration: _description_[0m

[31m--[ [0m[34mMatch #[0m[33m287[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_queue.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m521 | [0m[35m                return self.active_instruction_queue[0m
[30;1m522 | [0m[35m[0m
[30;1m523 | [0m[35m    def _next_instruction_queue(self) -> bool:[0m
[30;1m524 | [0m[35m        """get the next instruction queue from the queue. If no update is available, it will return [0m
[30;1m525 | [0m[35m        with self._lock:[0m
[30;1m526 | [0m[35m            try:[0m
[30;1m527 | [0m[35m                aiq = self.active_instruction_queue[0m

[31m--[ [0m[34mMatch #[0m[33m288[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/default_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m110 | [0m[35m        control = entry.create_group("sample")[0m
[30;1m111 | [0m[35m        control.attrs["NX_class"] = "NXsample"[0m
[30;1m112 | [0m[35m        control.create_dataset(name="name", data=self.data.get("samplename"))[0m
[30;1m113 | [0m[35m        control.create_dataset(name="description", data=self.data.get("sample_description"))[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m        # /entry/instrument[0m
[30;1m116 | [0m[35m        instrument = entry.create_group("instrument")[0m

[31m--[ [0m[34mMatch #[0m[33m289[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/default_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m109 | [0m[35m        # /entry/sample[0m
[30;1m110 | [0m[35m        control = entry.create_group("sample")[0m
[30;1m111 | [0m[35m        control.attrs["NX_class"] = "NXsample"[0m
[30;1m112 | [0m[35m        control.create_dataset(name="name", data=self.data.get("samplename"))[0m
[30;1m113 | [0m[35m        control.create_dataset(name="description", data=self.data.get("sample_description"))[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m        # /entry/instrument[0m

[31m--[ [0m[34mMatch #[0m[33m290[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/default_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m75 | [0m[35m        entry = self.storage.create_group("entry")[0m
[30;1m76 | [0m[35m        entry.attrs["NX_class"] = "NXentry"[0m
[30;1m77 | [0m[35m        entry.attrs["start_time"] = self.info_storage.get("start_time")[0m
[30;1m78 | [0m[35m        entry.attrs["end_time"] = self.info_storage.get("end_time")[0m
[30;1m79 | [0m[35m        entry.attrs["version"] = 1.0[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m        # /entry/collection[0m

[31m--[ [0m[34mMatch #[0m[33m291[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/default_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m74 | [0m[35m        # /entry[0m
[30;1m75 | [0m[35m        entry = self.storage.create_group("entry")[0m
[30;1m76 | [0m[35m        entry.attrs["NX_class"] = "NXentry"[0m
[30;1m77 | [0m[35m        entry.attrs["start_time"] = self.info_storage.get("start_time")[0m
[30;1m78 | [0m[35m        entry.attrs["end_time"] = self.info_storage.get("end_time")[0m
[30;1m79 | [0m[35m        entry.attrs["version"] = 1.0[0m
[30;1m80 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m292[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/default_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m        if isinstance(self.data.get(name), list) and isinstance(self.data[name][0], dict):[0m
[30;1m56 | [0m[35m            return [sub_data.get(name, {}).get("value", default) for sub_data in self.data[name]][0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m        return self.data.get(name, {}).get(name, {}).get("value", default)[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    def format(self) -> None:[0m
[30;1m61 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m293[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/default_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m        if isinstance(self.data.get(name), list) and isinstance(self.data[name][0], dict):[0m
[30;1m56 | [0m[35m            return [sub_data.get(name, {}).get("value", default) for sub_data in self.data[name]][0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m        return self.data.get(name, {}).get(name, {}).get("value", default)[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    def format(self) -> None:[0m
[30;1m61 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m294[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/default_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m        if isinstance(self.data.get(name), list) and isinstance(self.data[name][0], dict):[0m
[30;1m56 | [0m[35m            return [sub_data.get(name, {}).get("value", default) for sub_data in self.data[name]][0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m        return self.data.get(name, {}).get(name, {}).get("value", default)[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    def format(self) -> None:[0m
[30;1m61 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m295[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/default_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m53 | [0m[35m            default (Any, optional): Default value. Defaults to None.[0m
[30;1m54 | [0m[35m        """[0m
[30;1m55 | [0m[35m        if isinstance(self.data.get(name), list) and isinstance(self.data[name][0], dict):[0m
[30;1m56 | [0m[35m            return [sub_data.get(name, {}).get("value", default) for sub_data in self.data[name]][0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m        return self.data.get(name, {}).get(name, {}).get("value", default)[0m
[30;1m59 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m296[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/default_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m53 | [0m[35m            default (Any, optional): Default value. Defaults to None.[0m
[30;1m54 | [0m[35m        """[0m
[30;1m55 | [0m[35m        if isinstance(self.data.get(name), list) and isinstance(self.data[name][0], dict):[0m
[30;1m56 | [0m[35m            return [sub_data.get(name, {}).get("value", default) for sub_data in self.data[name]][0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m        return self.data.get(name, {}).get(name, {}).get("value", default)[0m
[30;1m59 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m297[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/default_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m52 | [0m[35m            name (str): Entry name[0m
[30;1m53 | [0m[35m            default (Any, optional): Default value. Defaults to None.[0m
[30;1m54 | [0m[35m        """[0m
[30;1m55 | [0m[35m        if isinstance(self.data.get(name), list) and isinstance(self.data[name][0], dict):[0m
[30;1m56 | [0m[35m            return [sub_data.get(name, {}).get("value", default) for sub_data in self.data[name]][0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m        return self.data.get(name, {}).get(name, {}).get("value", default)[0m

[31m--[ [0m[34mMatch #[0m[33m298[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/default_writer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m107 | [0m[35m            entry.create_soft_link(name="data", target="/entry/instrument/eiger_4")[0m
[30;1m108 | [0m[35m[0m
[30;1m109 | [0m[35m        # /entry/sample[0m
[30;1m110 | [0m[35m        control = entry.create_group("sample")[0m
[30;1m111 | [0m[35m        control.attrs["NX_class"] = "NXsample"[0m
[30;1m112 | [0m[35m        control.create_dataset(name="name", data=self.data.get("samplename"))[0m
[30;1m113 | [0m[35m        control.create_dataset(name="description", data=self.data.get("sample_description"))[0m

[31m--[ [0m[34mMatch #[0m[33m299[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/default_writer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m98 | [0m[35m        configuration.attrs["NX_class"] = "NXcollection"[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m        # /entry/control[0m
[30;1m101 | [0m[35m        control = entry.create_group("control")[0m
[30;1m102 | [0m[35m        control.attrs["NX_class"] = "NXmonitor"[0m
[30;1m103 | [0m[35m        control.create_dataset(name="mode", data="monitor")[0m
[30;1m104 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m300[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/.gitignore[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m174 | [0m[35m[0m
[30;1m175 | [0m[35m# PyCharm[0m
[30;1m176 | [0m[35m#  JetBrains specific template is maintained in a separate JetBrains.gitignore that can[0m
[30;1m177 | [0m[35m#  be found at https://github.com/github/gitignore/blob/main/Global/JetBrains.gitignore[0m
[30;1m178 | [0m[35m#  and can be added to the global gitignore or merged into this file.  For a more nuclear[0m
[30;1m179 | [0m[35m#  option (not recommended) you can uncomment the following to ignore the entire idea folder.[0m
[30;1m180 | [0m[35m#.idea/[0m

[31m--[ [0m[34mMatch #[0m[33m301[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/.gitignore[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m43 | [0m[35mMANIFEST[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m# PyInstaller[0m
[30;1m46 | [0m[35m#  Usually these files are written by a python script from a template[0m
[30;1m47 | [0m[35m#  before PyInstaller builds the exe, so as to inject date/other infos into it.[0m
[30;1m48 | [0m[35m*.manifest[0m
[30;1m49 | [0m[35m*.spec[0m

[31m--[ [0m[34mMatch #[0m[33m302[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/service_handler/service_handler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m33 | [0m[35m            parent.on_restart()[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m    def on_restart(self):[0m
[30;1m36 | [0m[35m        logger.info("Restarting services through service handler")[0m
[30;1m37 | [0m[35m        subprocess.run(f"{self.command} restart", shell=True, check=True, start_new_session=True)[0m

[31m--[ [0m[34mMatch #[0m[33m303[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_gui_models.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m222 | [0m[35m                arg_group = GUIArgGroup([0m
[30;1m223 | [0m[35m                    bundle=scan_cls.arg_bundle_size.get("bundle"),[0m
[30;1m224 | [0m[35m                    min=scan_cls.arg_bundle_size.get("min"),[0m
[30;1m225 | [0m[35m                    max=scan_cls.arg_bundle_size.get("max"),[0m
[30;1m226 | [0m[35m                    arg_inputs=arg_input,[0m
[30;1m227 | [0m[35m                )[0m
[30;1m228 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m304[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_gui_models.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m221 | [0m[35m            if hasattr(scan_cls, "arg_bundle_size"):[0m
[30;1m222 | [0m[35m                arg_group = GUIArgGroup([0m
[30;1m223 | [0m[35m                    bundle=scan_cls.arg_bundle_size.get("bundle"),[0m
[30;1m224 | [0m[35m                    min=scan_cls.arg_bundle_size.get("min"),[0m
[30;1m225 | [0m[35m                    max=scan_cls.arg_bundle_size.get("max"),[0m
[30;1m226 | [0m[35m                    arg_inputs=arg_input,[0m
[30;1m227 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m305[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_gui_models.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m220 | [0m[35m            arg_input = scan_cls.arg_input[0m
[30;1m221 | [0m[35m            if hasattr(scan_cls, "arg_bundle_size"):[0m
[30;1m222 | [0m[35m                arg_group = GUIArgGroup([0m
[30;1m223 | [0m[35m                    bundle=scan_cls.arg_bundle_size.get("bundle"),[0m
[30;1m224 | [0m[35m                    min=scan_cls.arg_bundle_size.get("min"),[0m
[30;1m225 | [0m[35m                    max=scan_cls.arg_bundle_size.get("max"),[0m
[30;1m226 | [0m[35m                    arg_inputs=arg_input,[0m

[31m--[ [0m[34mMatch #[0m[33m306[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_gui_models.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m133 | [0m[35m        if v is not None:[0m
[30;1m134 | [0m[35m            return v[0m
[30;1m135 | [0m[35m        signature = context_signature.get()[0m
[30;1m136 | [0m[35m        name = values.data.get("name", None)[0m
[30;1m137 | [0m[35m        if name is None:[0m
[30;1m138 | [0m[35m            raise PydanticCustomError([0m
[30;1m139 | [0m[35m                "missing argument name",[0m

[31m--[ [0m[34mMatch #[0m[33m307[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_gui_models.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m132 | [0m[35m            return v[0m
[30;1m133 | [0m[35m        if v is not None:[0m
[30;1m134 | [0m[35m            return v[0m
[30;1m135 | [0m[35m        signature = context_signature.get()[0m
[30;1m136 | [0m[35m        name = values.data.get("name", None)[0m
[30;1m137 | [0m[35m        if name is None:[0m
[30;1m138 | [0m[35m            raise PydanticCustomError([0m

[31m--[ [0m[34mMatch #[0m[33m308[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_gui_models.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m107 | [0m[35m    def validate_display_name(cls, v, values):[0m
[30;1m108 | [0m[35m        if v is not None:[0m
[30;1m109 | [0m[35m            return v[0m
[30;1m110 | [0m[35m        name = values.data.get("name", None)[0m
[30;1m111 | [0m[35m        if name is None:[0m
[30;1m112 | [0m[35m            raise PydanticCustomError([0m
[30;1m113 | [0m[35m                "missing argument name",[0m

[31m--[ [0m[34mMatch #[0m[33m309[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_gui_models.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m78 | [0m[35m            return v[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m        docstring = context_docstring.get()[0m
[30;1m81 | [0m[35m        name = values.data.get("name", None)[0m
[30;1m82 | [0m[35m        if name is None:[0m
[30;1m83 | [0m[35m            raise PydanticCustomError([0m
[30;1m84 | [0m[35m                "missing argument name",[0m

[31m--[ [0m[34mMatch #[0m[33m310[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_gui_models.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m        if v is not None:[0m
[30;1m78 | [0m[35m            return v[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m        docstring = context_docstring.get()[0m
[30;1m81 | [0m[35m        name = values.data.get("name", None)[0m
[30;1m82 | [0m[35m        if name is None:[0m
[30;1m83 | [0m[35m            raise PydanticCustomError([0m

[31m--[ [0m[34mMatch #[0m[33m311[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_gui_models.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m            return v[0m
[30;1m57 | [0m[35m        signature = context_signature.get()[0m
[30;1m58 | [0m[35m        if v is None:[0m
[30;1m59 | [0m[35m            name = values.data.get("name", None)[0m
[30;1m60 | [0m[35m            if name is None:[0m
[30;1m61 | [0m[35m                raise PydanticCustomError([0m
[30;1m62 | [0m[35m                    "missing argument name",[0m

[31m--[ [0m[34mMatch #[0m[33m312[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_gui_models.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m        # args cannot be validated with the current implementation of signature of scans[0m
[30;1m55 | [0m[35m        if values.data["arg"]:[0m
[30;1m56 | [0m[35m            return v[0m
[30;1m57 | [0m[35m        signature = context_signature.get()[0m
[30;1m58 | [0m[35m        if v is None:[0m
[30;1m59 | [0m[35m            name = values.data.get("name", None)[0m
[30;1m60 | [0m[35m            if name is None:[0m

[31m--[ [0m[34mMatch #[0m[33m313[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_gui_models.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m38 | [0m[35m        # args cannot be validated with the current implementation of signature of scans[0m
[30;1m39 | [0m[35m        if values.data["arg"]:[0m
[30;1m40 | [0m[35m            return v[0m
[30;1m41 | [0m[35m        signature = context_signature.get()[0m
[30;1m42 | [0m[35m        available_args = [entry["name"] for entry in signature][0m
[30;1m43 | [0m[35m        if v not in available_args:[0m
[30;1m44 | [0m[35m            raise PydanticCustomError([0m

[31m--[ [0m[34mMatch #[0m[33m314[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m98 | [0m[35m    @property[0m
[30;1m99 | [0m[35m    def dataset_number(self) -> int:[0m
[30;1m100 | [0m[35m        """get the current dataset number"""[0m
[30;1m101 | [0m[35m        msg = self.connector.get(MessageEndpoints.dataset_number())[0m
[30;1m102 | [0m[35m        if msg is None:[0m
[30;1m103 | [0m[35m            logger.warning("Failed to retrieve dataset number from redis.")[0m
[30;1m104 | [0m[35m            return -1[0m

[31m--[ [0m[34mMatch #[0m[33m315[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m    @property[0m
[30;1m78 | [0m[35m    def scan_number(self) -> int:[0m
[30;1m79 | [0m[35m        """get the current scan number"""[0m
[30;1m80 | [0m[35m        msg = self.connector.get(MessageEndpoints.scan_number())[0m
[30;1m81 | [0m[35m        if msg is None:[0m
[30;1m82 | [0m[35m            logger.warning("Failed to retrieve scan number from redis.")[0m
[30;1m83 | [0m[35m            return -1[0m

[31m--[ [0m[34mMatch #[0m[33m316[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m69 | [0m[35m    @staticmethod[0m
[30;1m70 | [0m[35m    def _alarm_callback(msg, parent: ScanServer, **_kwargs):[0m
[30;1m71 | [0m[35m        msg = msg.value[0m
[30;1m72 | [0m[35m        queue = msg.metadata.get("queue", "primary")[0m
[30;1m73 | [0m[35m        if Alarms(msg.content["severity"]) == Alarms.MAJOR:[0m
[30;1m74 | [0m[35m            logger.info(f"Received alarm: {msg}")[0m
[30;1m75 | [0m[35m            parent.queue_manager.set_abort(queue=queue)[0m

[31m--[ [0m[34mMatch #[0m[33m317[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m63 | [0m[35m    def _reset_scan_number(self):[0m
[30;1m64 | [0m[35m        if self.connector.get(MessageEndpoints.scan_number()) is None:[0m
[30;1m65 | [0m[35m            self.scan_number = 1[0m
[30;1m66 | [0m[35m        if self.connector.get(MessageEndpoints.dataset_number()) is None:[0m
[30;1m67 | [0m[35m            self.dataset_number = 1[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m    @staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m318[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m        self.connector.register(MessageEndpoints.alarm(), cb=self._alarm_callback, parent=self)[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m    def _reset_scan_number(self):[0m
[30;1m64 | [0m[35m        if self.connector.get(MessageEndpoints.scan_number()) is None:[0m
[30;1m65 | [0m[35m            self.scan_number = 1[0m
[30;1m66 | [0m[35m        if self.connector.get(MessageEndpoints.dataset_number()) is None:[0m
[30;1m67 | [0m[35m            self.dataset_number = 1[0m

[31m--[ [0m[34mMatch #[0m[33m319[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/devices/config_update_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m96 | [0m[35m                if "limits" in dev_config["deviceConfig"]:[0m
[30;1m97 | [0m[35m                    limits = {[0m
[30;1m98 | [0m[35m                        "low": {"value": device.obj.low_limit_travel.get()},[0m
[30;1m99 | [0m[35m                        "high": {"value": device.obj.high_limit_travel.get()},[0m
[30;1m100 | [0m[35m                    }[0m
[30;1m101 | [0m[35m                    self.device_manager.connector.set_and_publish([0m
[30;1m102 | [0m[35m                        MessageEndpoints.device_limits(device.name),[0m

[31m--[ [0m[34mMatch #[0m[33m320[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/devices/config_update_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m                if "limits" in dev_config["deviceConfig"]:[0m
[30;1m97 | [0m[35m                    limits = {[0m
[30;1m98 | [0m[35m                        "low": {"value": device.obj.low_limit_travel.get()},[0m
[30;1m99 | [0m[35m                        "high": {"value": device.obj.high_limit_travel.get()},[0m
[30;1m100 | [0m[35m                    }[0m
[30;1m101 | [0m[35m                    self.device_manager.connector.set_and_publish([0m

[31m--[ [0m[34mMatch #[0m[33m321[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/devices/config_update_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m74 | [0m[35m        msg = messages.RequestResponseMessage([0m
[30;1m75 | [0m[35m            accepted=accepted, message=error_msg, metadata=metadata[0m
[30;1m76 | [0m[35m        )[0m
[30;1m77 | [0m[35m        RID = metadata.get("RID")[0m
[30;1m78 | [0m[35m        self.device_manager.connector.set([0m
[30;1m79 | [0m[35m            MessageEndpoints.device_config_request_response(RID), msg, expire=60[0m
[30;1m80 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m322[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/scilog/scilog.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m66 | [0m[35m            self.set_bec_token(token)[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m    def _load_environment(self):[0m
[30;1m69 | [0m[35m        env_base = self.scihub.config.service_config.get("scilog", {}).get("env_file")[0m
[30;1m70 | [0m[35m        if not env_base:[0m
[30;1m71 | [0m[35m            return[0m
[30;1m72 | [0m[35m        env_file = os.path.join(env_base, ".env")[0m

[31m--[ [0m[34mMatch #[0m[33m323[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/scilog/scilog.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m66 | [0m[35m            self.set_bec_token(token)[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m    def _load_environment(self):[0m
[30;1m69 | [0m[35m        env_base = self.scihub.config.service_config.get("scilog", {}).get("env_file")[0m
[30;1m70 | [0m[35m        if not env_base:[0m
[30;1m71 | [0m[35m            return[0m
[30;1m72 | [0m[35m        env_file = os.path.join(env_base, ".env")[0m

[31m--[ [0m[34mMatch #[0m[33m324[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/scilog/scilog.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m    def get_token(self) -> str:[0m
[30;1m36 | [0m[35m        """get a new scilog token"""[0m
[30;1m37 | [0m[35m        response = requests.post([0m
[30;1m38 | [0m[35m            f"{self.host}/users/login",[0m
[30;1m39 | [0m[35m            json={"principal": self.user, "password": self.user_secret},[0m
[30;1m40 | [0m[35m            timeout=5,[0m

[31m--[ [0m[34mMatch #[0m[33m325[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/bec_emitter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m139 | [0m[35m    def on_scan_status_update(self, status_msg: messages.ScanStatusMessage):[0m
[30;1m140 | [0m[35m        if status_msg.status == "open":[0m
[30;1m141 | [0m[35m            return[0m
[30;1m142 | [0m[35m        num_points = status_msg.info.get("num_points", 0) - 1[0m
[30;1m143 | [0m[35m        self._update_scan_progress(status_msg.scan_id, num_points, done=True)[0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35m    def shutdown(self):[0m

[31m--[ [0m[34mMatch #[0m[33m326[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/bec_emitter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m112 | [0m[35m            metadata={[0m
[30;1m113 | [0m[35m                "scan_id": scan_id,[0m
[30;1m114 | [0m[35m                "RID": info.get("RID", ""),[0m
[30;1m115 | [0m[35m                "queue_id": info.get("queue_id", ""),[0m
[30;1m116 | [0m[35m            },[0m
[30;1m117 | [0m[35m        )[0m
[30;1m118 | [0m[35m        self.scan_bundler.connector.set_and_publish(MessageEndpoints.scan_progress(), msg)[0m

[31m--[ [0m[34mMatch #[0m[33m327[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/bec_emitter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m111 | [0m[35m            done=done,[0m
[30;1m112 | [0m[35m            metadata={[0m
[30;1m113 | [0m[35m                "scan_id": scan_id,[0m
[30;1m114 | [0m[35m                "RID": info.get("RID", ""),[0m
[30;1m115 | [0m[35m                "queue_id": info.get("queue_id", ""),[0m
[30;1m116 | [0m[35m            },[0m
[30;1m117 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m328[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/bec_emitter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m107 | [0m[35m        info = self.scan_bundler.sync_storage[scan_id]["info"][0m
[30;1m108 | [0m[35m        msg = messages.ProgressMessage([0m
[30;1m109 | [0m[35m            value=point_id + 1,[0m
[30;1m110 | [0m[35m            max_value=info.get("num_points", point_id + 1),[0m
[30;1m111 | [0m[35m            done=done,[0m
[30;1m112 | [0m[35m            metadata={[0m
[30;1m113 | [0m[35m                "scan_id": scan_id,[0m

[31m--[ [0m[34mMatch #[0m[33m329[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/bec_emitter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m88 | [0m[35m            metadata={[0m
[30;1m89 | [0m[35m                "scan_id": scan_id,[0m
[30;1m90 | [0m[35m                "scan_type": info.get("scan_type"),[0m
[30;1m91 | [0m[35m                "scan_report_devices": info.get("scan_report_devices"),[0m
[30;1m92 | [0m[35m            },[0m
[30;1m93 | [0m[35m        )[0m
[30;1m94 | [0m[35m        self.add_message([0m

[31m--[ [0m[34mMatch #[0m[33m330[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/bec_emitter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m87 | [0m[35m            data=sb.sync_storage[scan_id][point_id],[0m
[30;1m88 | [0m[35m            metadata={[0m
[30;1m89 | [0m[35m                "scan_id": scan_id,[0m
[30;1m90 | [0m[35m                "scan_type": info.get("scan_type"),[0m
[30;1m91 | [0m[35m                "scan_report_devices": info.get("scan_report_devices"),[0m
[30;1m92 | [0m[35m            },[0m
[30;1m93 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m331[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/bec_emitter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m    def _get_messages_from_buffer(self) -> list:[0m
[30;1m47 | [0m[35m        msgs_to_send = [][0m
[30;1m48 | [0m[35m        while not self._send_buffer.empty():[0m
[30;1m49 | [0m[35m            msgs_to_send.append(self._send_buffer.get())[0m
[30;1m50 | [0m[35m        return msgs_to_send[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m    def _publish_data(self) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m332[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/bec_emitter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mfrom __future__ import annotations[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport threading[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35mfrom queue import Queue[0m
[30;1m6 | [0m[35mfrom typing import TYPE_CHECKING[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mfrom bec_lib import messages[0m

[31m--[ [0m[34mMatch #[0m[33m333[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/bec_emitter.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m101 | [0m[35m    def _update_scan_progress(self, scan_id: str, point_id: int, done=False) -> None:[0m
[30;1m102 | [0m[35m        if scan_id not in self.scan_bundler.sync_storage:[0m
[30;1m103 | [0m[35m            logger.warning([0m
[30;1m104 | [0m[35m                f"Cannot update scan progress: Scan {scan_id} not found in sync storage."[0m
[30;1m105 | [0m[35m            )[0m
[30;1m106 | [0m[35m            return[0m
[30;1m107 | [0m[35m        info = self.scan_bundler.sync_storage[scan_id]["info"][0m

[31m--[ [0m[34mMatch #[0m[33m334[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_assembler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m107 | [0m[35m            scan_instance = scan_cls([0m
[30;1m108 | [0m[35m                *args,[0m
[30;1m109 | [0m[35m                device_manager=self.device_manager,[0m
[30;1m110 | [0m[35m                parameter=msg.content.get("parameter"),[0m
[30;1m111 | [0m[35m                metadata=msg.metadata,[0m
[30;1m112 | [0m[35m                instruction_handler=self.parent.queue_manager.instruction_handler,[0m
[30;1m113 | [0m[35m                scan_id=scan_id,[0m

[31m--[ [0m[34mMatch #[0m[33m335[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_assembler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m        logger.info(f"Preparing instructions of request of type {scan} / {scan_cls.__name__}")[0m
[30;1m65 | [0m[35m        try:[0m
[30;1m66 | [0m[35m            args = unpack_scan_args(msg.content.get("parameter", {}).get("args", []))[0m
[30;1m67 | [0m[35m            kwargs = msg.content.get("parameter", {}).get("kwargs", {})[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m            cls_input_args = [[0m
[30;1m70 | [0m[35m                name[0m

[31m--[ [0m[34mMatch #[0m[33m336[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_assembler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m        logger.info(f"Preparing instructions of request of type {scan} / {scan_cls.__name__}")[0m
[30;1m65 | [0m[35m        try:[0m
[30;1m66 | [0m[35m            args = unpack_scan_args(msg.content.get("parameter", {}).get("args", []))[0m
[30;1m67 | [0m[35m            kwargs = msg.content.get("parameter", {}).get("kwargs", {})[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m            cls_input_args = [[0m
[30;1m70 | [0m[35m                name[0m

[31m--[ [0m[34mMatch #[0m[33m337[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_assembler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m        logger.info(f"Preparing instructions of request of type {scan} / {scan_cls.__name__}")[0m
[30;1m65 | [0m[35m        try:[0m
[30;1m66 | [0m[35m            args = unpack_scan_args(msg.content.get("parameter", {}).get("args", []))[0m
[30;1m67 | [0m[35m            kwargs = msg.content.get("parameter", {}).get("kwargs", {})[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m            cls_input_args = [[0m

[31m--[ [0m[34mMatch #[0m[33m338[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_assembler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m        logger.info(f"Preparing instructions of request of type {scan} / {scan_cls.__name__}")[0m
[30;1m65 | [0m[35m        try:[0m
[30;1m66 | [0m[35m            args = unpack_scan_args(msg.content.get("parameter", {}).get("args", []))[0m
[30;1m67 | [0m[35m            kwargs = msg.content.get("parameter", {}).get("kwargs", {})[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m            cls_input_args = [[0m

[31m--[ [0m[34mMatch #[0m[33m339[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_assembler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m57 | [0m[35m        Returns:[0m
[30;1m58 | [0m[35m            RequestBase: Scan instance of the initialized scan class[0m
[30;1m59 | [0m[35m        """[0m
[30;1m60 | [0m[35m        scan = msg.content.get("scan_type")[0m
[30;1m61 | [0m[35m        cls_name = self.scan_manager.available_scans[scan]["class"][0m
[30;1m62 | [0m[35m        scan_cls = self.scan_manager.scan_dict[cls_name][0m
[30;1m63 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m340[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_assembler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m36 | [0m[35m        Returns:[0m
[30;1m37 | [0m[35m            bool: True if the message is a scan message, False otherwise[0m
[30;1m38 | [0m[35m        """[0m
[30;1m39 | [0m[35m        scan = msg.content.get("scan_type")[0m
[30;1m40 | [0m[35m        cls_name = self.scan_manager.available_scans[scan]["class"][0m
[30;1m41 | [0m[35m        scan_cls = self.scan_manager.scan_dict[cls_name][0m
[30;1m42 | [0m[35m        return issubclass(scan_cls, ScanBase)[0m

[31m--[ [0m[34mMatch #[0m[33m341[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer_plugins/cSAXS.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m139 | [0m[35m                name="wavelength", data=12.3984193 / (mokev.get("mokev").get("value") + 1e-9)[0m
[30;1m140 | [0m[35m            )[0m
[30;1m141 | [0m[35m            wavelength.attrs["units"] = "Angstrom"[0m
[30;1m142 | [0m[35m            energy = mono.create_dataset(name="energy", data=mokev.get("mokev").get("value"))[0m
[30;1m143 | [0m[35m            energy.attrs["units"] = "keV"[0m
[30;1m144 | [0m[35m        mono.create_dataset(name="type", data="Double crystal fixed exit monochromator.")[0m
[30;1m145 | [0m[35m        distance = mono.create_dataset([0m

[31m--[ [0m[34mMatch #[0m[33m342[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer_plugins/cSAXS.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m139 | [0m[35m                name="wavelength", data=12.3984193 / (mokev.get("mokev").get("value") + 1e-9)[0m
[30;1m140 | [0m[35m            )[0m
[30;1m141 | [0m[35m            wavelength.attrs["units"] = "Angstrom"[0m
[30;1m142 | [0m[35m            energy = mono.create_dataset(name="energy", data=mokev.get("mokev").get("value"))[0m
[30;1m143 | [0m[35m            energy.attrs["units"] = "keV"[0m
[30;1m144 | [0m[35m        mono.create_dataset(name="type", data="Double crystal fixed exit monochromator.")[0m
[30;1m145 | [0m[35m        distance = mono.create_dataset([0m

[31m--[ [0m[34mMatch #[0m[33m343[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer_plugins/cSAXS.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m            if isinstance(mokev, list):[0m
[30;1m137 | [0m[35m                mokev = mokev[0][0m
[30;1m138 | [0m[35m            wavelength = mono.create_dataset([0m
[30;1m139 | [0m[35m                name="wavelength", data=12.3984193 / (mokev.get("mokev").get("value") + 1e-9)[0m
[30;1m140 | [0m[35m            )[0m
[30;1m141 | [0m[35m            wavelength.attrs["units"] = "Angstrom"[0m
[30;1m142 | [0m[35m            energy = mono.create_dataset(name="energy", data=mokev.get("mokev").get("value"))[0m

[31m--[ [0m[34mMatch #[0m[33m344[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer_plugins/cSAXS.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m            if isinstance(mokev, list):[0m
[30;1m137 | [0m[35m                mokev = mokev[0][0m
[30;1m138 | [0m[35m            wavelength = mono.create_dataset([0m
[30;1m139 | [0m[35m                name="wavelength", data=12.3984193 / (mokev.get("mokev").get("value") + 1e-9)[0m
[30;1m140 | [0m[35m            )[0m
[30;1m141 | [0m[35m            wavelength.attrs["units"] = "Angstrom"[0m
[30;1m142 | [0m[35m            energy = mono.create_dataset(name="energy", data=mokev.get("mokev").get("value"))[0m

[31m--[ [0m[34mMatch #[0m[33m345[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer_plugins/cSAXS.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m        mono = instrument.create_group("monochromator")[0m
[30;1m133 | [0m[35m        mono.attrs["NX_class"] = "NXmonochromator"[0m
[30;1m134 | [0m[35m        mokev = data.get("mokev", {})[0m
[30;1m135 | [0m[35m        if mokev:[0m
[30;1m136 | [0m[35m            if isinstance(mokev, list):[0m
[30;1m137 | [0m[35m                mokev = mokev[0][0m

[31m--[ [0m[34mMatch #[0m[33m346[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer_plugins/cSAXS.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m        control = entry.create_group("sample")[0m
[30;1m55 | [0m[35m        control.attrs["NX_class"] = "NXsample"[0m
[30;1m56 | [0m[35m        control.create_dataset(name="name", data=self.get_entry("samplename"))[0m
[30;1m57 | [0m[35m        control.create_dataset(name="description", data=data.get("sample_description"))[0m
[30;1m58 | [0m[35m        x_translation = control.create_dataset(name="x_translation", data=self.get_entry("samx"))[0m
[30;1m59 | [0m[35m        x_translation.attrs["units"] = "mm"[0m
[30;1m60 | [0m[35m        y_translation = control.create_dataset(name="y_translation", data=self.get_entry("samy"))[0m

[31m--[ [0m[34mMatch #[0m[33m347[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer_plugins/cSAXS.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35m        entry.attrs["NX_class"] = "NXentry"[0m
[30;1m27 | [0m[35m        entry.attrs["definition"] = "NXsas"[0m
[30;1m28 | [0m[35m        entry.attrs["start_time"] = data.get("start_time")[0m
[30;1m29 | [0m[35m        entry.attrs["end_time"] = data.get("end_time")[0m
[30;1m30 | [0m[35m        entry.attrs["version"] = 1.0[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m        # /entry/collection[0m

[31m--[ [0m[34mMatch #[0m[33m348[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer_plugins/cSAXS.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m        entry = storage.create_group("entry")[0m
[30;1m26 | [0m[35m        entry.attrs["NX_class"] = "NXentry"[0m
[30;1m27 | [0m[35m        entry.attrs["definition"] = "NXsas"[0m
[30;1m28 | [0m[35m        entry.attrs["start_time"] = data.get("start_time")[0m
[30;1m29 | [0m[35m        entry.attrs["end_time"] = data.get("end_time")[0m
[30;1m30 | [0m[35m        entry.attrs["version"] = 1.0[0m
[30;1m31 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m349[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer_plugins/cSAXS.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m51 | [0m[35m            main_data.create_soft_link(name="data", target="/entry/instrument/pilatus_2/data")[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m        # /entry/sample[0m
[30;1m54 | [0m[35m        control = entry.create_group("sample")[0m
[30;1m55 | [0m[35m        control.attrs["NX_class"] = "NXsample"[0m
[30;1m56 | [0m[35m        control.create_dataset(name="name", data=self.get_entry("samplename"))[0m
[30;1m57 | [0m[35m        control.create_dataset(name="description", data=data.get("sample_description"))[0m

[31m--[ [0m[34mMatch #[0m[33m350[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer_plugins/cSAXS.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m35 | [0m[35m        bec_collection = collection.create_group("bec")[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m        # /entry/control[0m
[30;1m38 | [0m[35m        control = entry.create_group("control")[0m
[30;1m39 | [0m[35m        control.attrs["NX_class"] = "NXmonitor"[0m
[30;1m40 | [0m[35m        control.create_dataset(name="mode", data="monitor")[0m
[30;1m41 | [0m[35m        control.create_dataset(name="integral", data=self.get_entry("bpm4i"))[0m

[31m--[ [0m[34mMatch #[0m[33m351[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/tests/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport enum[0m
[30;1m2 | [0m[35mimport inspect[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mfrom typing import Any, Generator, Literal, Protocol[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom ophyd import DeviceStatus, Kind[0m
[30;1m7 | [0m[35mfrom ophyd_devices.interfaces.protocols.bec_protocols import ([0m

[31m--[ [0m[34mMatch #[0m[33m352[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scan_stub_status.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport threading[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35mfrom unittest import mock[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mimport pytest[0m
[30;1m6 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m353[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/cli/launch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# Description: Launch the SciHub connector.[0m
[30;1m2 | [0m[35m# This script is the entry point for the SciHub connector. It is called either[0m
[30;1m3 | [0m[35m# by the bec-dap entry point or directly from the command line.[0m
[30;1m4 | [0m[35mimport argparse[0m
[30;1m5 | [0m[35mimport threading[0m

[31m--[ [0m[34mMatch #[0m[33m354[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/lmfit1d_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m311 | [0m[35m        if not x:[0m
[30;1m312 | [0m[35m            logger.warning(f"Failed to find signal {device_x}.{signal_x}")[0m
[30;1m313 | [0m[35m            return None[0m
[30;1m314 | [0m[35m        y = scan_item.live_data.get(device_y, {}).get(signal_y, {}).get("value")[0m
[30;1m315 | [0m[35m        if not y:[0m
[30;1m316 | [0m[35m            logger.warning(f"Failed to find signal {device_y}.{signal_y}")[0m
[30;1m317 | [0m[35m            return None[0m

[31m--[ [0m[34mMatch #[0m[33m355[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/lmfit1d_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m311 | [0m[35m        if not x:[0m
[30;1m312 | [0m[35m            logger.warning(f"Failed to find signal {device_x}.{signal_x}")[0m
[30;1m313 | [0m[35m            return None[0m
[30;1m314 | [0m[35m        y = scan_item.live_data.get(device_y, {}).get(signal_y, {}).get("value")[0m
[30;1m315 | [0m[35m        if not y:[0m
[30;1m316 | [0m[35m            logger.warning(f"Failed to find signal {device_y}.{signal_y}")[0m
[30;1m317 | [0m[35m            return None[0m

[31m--[ [0m[34mMatch #[0m[33m356[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/lmfit1d_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m311 | [0m[35m        if not x:[0m
[30;1m312 | [0m[35m            logger.warning(f"Failed to find signal {device_x}.{signal_x}")[0m
[30;1m313 | [0m[35m            return None[0m
[30;1m314 | [0m[35m        y = scan_item.live_data.get(device_y, {}).get(signal_y, {}).get("value")[0m
[30;1m315 | [0m[35m        if not y:[0m
[30;1m316 | [0m[35m            logger.warning(f"Failed to find signal {device_y}.{signal_y}")[0m
[30;1m317 | [0m[35m            return None[0m

[31m--[ [0m[34mMatch #[0m[33m357[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/lmfit1d_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m307 | [0m[35m        # get the event data[0m
[30;1m308 | [0m[35m        if not scan_item.live_data:[0m
[30;1m309 | [0m[35m            return None[0m
[30;1m310 | [0m[35m        x = scan_item.live_data.get(device_x, {}).get(signal_x, {}).get("value")[0m
[30;1m311 | [0m[35m        if not x:[0m
[30;1m312 | [0m[35m            logger.warning(f"Failed to find signal {device_x}.{signal_x}")[0m
[30;1m313 | [0m[35m            return None[0m

[31m--[ [0m[34mMatch #[0m[33m358[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/lmfit1d_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m307 | [0m[35m        # get the event data[0m
[30;1m308 | [0m[35m        if not scan_item.live_data:[0m
[30;1m309 | [0m[35m            return None[0m
[30;1m310 | [0m[35m        x = scan_item.live_data.get(device_x, {}).get(signal_x, {}).get("value")[0m
[30;1m311 | [0m[35m        if not x:[0m
[30;1m312 | [0m[35m            logger.warning(f"Failed to find signal {device_x}.{signal_x}")[0m
[30;1m313 | [0m[35m            return None[0m

[31m--[ [0m[34mMatch #[0m[33m359[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/lmfit1d_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m307 | [0m[35m        # get the event data[0m
[30;1m308 | [0m[35m        if not scan_item.live_data:[0m
[30;1m309 | [0m[35m            return None[0m
[30;1m310 | [0m[35m        x = scan_item.live_data.get(device_x, {}).get(signal_x, {}).get("value")[0m
[30;1m311 | [0m[35m        if not x:[0m
[30;1m312 | [0m[35m            logger.warning(f"Failed to find signal {device_x}.{signal_x}")[0m
[30;1m313 | [0m[35m            return None[0m

[31m--[ [0m[34mMatch #[0m[33m360[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/lmfit1d_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m290 | [0m[35m                logger.warning("Failed to find scan report devices")[0m
[30;1m291 | [0m[35m                return None[0m
[30;1m292 | [0m[35m            device_x = scan_report_devices[0][0m
[30;1m293 | [0m[35m            bec_device_x = self.client.device_manager.devices.get(device_x)[0m
[30;1m294 | [0m[35m            if not bec_device_x:[0m
[30;1m295 | [0m[35m                logger.warning(f"Failed to find device {device_x}")[0m
[30;1m296 | [0m[35m                return None[0m

[31m--[ [0m[34mMatch #[0m[33m361[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/lmfit1d_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m285 | [0m[35m        if not device_x:[0m
[30;1m286 | [0m[35m            if not scan_item.live_data:[0m
[30;1m287 | [0m[35m                return None[0m
[30;1m288 | [0m[35m            scan_report_devices = scan_item.live_data[0].metadata.get("scan_report_devices", [])[0m
[30;1m289 | [0m[35m            if not scan_report_devices:[0m
[30;1m290 | [0m[35m                logger.warning("Failed to find scan report devices")[0m
[30;1m291 | [0m[35m                return None[0m

[31m--[ [0m[34mMatch #[0m[33m362[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/lmfit1d_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m280 | [0m[35m        device_x = devices.get("device_x", self.device_x)[0m
[30;1m281 | [0m[35m        signal_x = devices.get("signal_x", self.signal_x)[0m
[30;1m282 | [0m[35m        device_y = devices.get("device_y", self.device_y)[0m
[30;1m283 | [0m[35m        signal_y = devices.get("signal_y", self.signal_y)[0m
[30;1m284 | [0m[35m[0m
[30;1m285 | [0m[35m        if not device_x:[0m
[30;1m286 | [0m[35m            if not scan_item.live_data:[0m

[31m--[ [0m[34mMatch #[0m[33m363[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/lmfit1d_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m279 | [0m[35m            devices = {}[0m
[30;1m280 | [0m[35m        device_x = devices.get("device_x", self.device_x)[0m
[30;1m281 | [0m[35m        signal_x = devices.get("signal_x", self.signal_x)[0m
[30;1m282 | [0m[35m        device_y = devices.get("device_y", self.device_y)[0m
[30;1m283 | [0m[35m        signal_y = devices.get("signal_y", self.signal_y)[0m
[30;1m284 | [0m[35m[0m
[30;1m285 | [0m[35m        if not device_x:[0m

[31m--[ [0m[34mMatch #[0m[33m364[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/lmfit1d_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m278 | [0m[35m        if not devices:[0m
[30;1m279 | [0m[35m            devices = {}[0m
[30;1m280 | [0m[35m        device_x = devices.get("device_x", self.device_x)[0m
[30;1m281 | [0m[35m        signal_x = devices.get("signal_x", self.signal_x)[0m
[30;1m282 | [0m[35m        device_y = devices.get("device_y", self.device_y)[0m
[30;1m283 | [0m[35m        signal_y = devices.get("signal_y", self.signal_y)[0m
[30;1m284 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m365[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/lmfit1d_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m277 | [0m[35m            return None[0m
[30;1m278 | [0m[35m        if not devices:[0m
[30;1m279 | [0m[35m            devices = {}[0m
[30;1m280 | [0m[35m        device_x = devices.get("device_x", self.device_x)[0m
[30;1m281 | [0m[35m        signal_x = devices.get("signal_x", self.signal_x)[0m
[30;1m282 | [0m[35m        device_y = devices.get("device_y", self.device_y)[0m
[30;1m283 | [0m[35m        signal_y = devices.get("signal_y", self.signal_y)[0m

[31m--[ [0m[34mMatch #[0m[33m366[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/lmfit1d_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m240 | [0m[35m            self.device_y = device_y[0m
[30;1m241 | [0m[35m        if signal_y:[0m
[30;1m242 | [0m[35m            self.signal_y = signal_y[0m
[30;1m243 | [0m[35m        elif device_y and self.client.device_manager.devices.get(device_y):[0m
[30;1m244 | [0m[35m            if len(self.client.device_manager.devices[device_y]._hints) == 1:[0m
[30;1m245 | [0m[35m                self.signal_y = self.client.device_manager.devices[device_y]._hints[0][0m
[30;1m246 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m367[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/lmfit1d_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m233 | [0m[35m            self.device_x = device_x[0m
[30;1m234 | [0m[35m        if signal_x:[0m
[30;1m235 | [0m[35m            self.signal_x = signal_x[0m
[30;1m236 | [0m[35m        elif device_x and self.client.device_manager.devices.get(device_x):[0m
[30;1m237 | [0m[35m            if len(self.client.device_manager.devices[device_x]._hints) == 1:[0m
[30;1m238 | [0m[35m                self.signal_x = self.client.device_manager.devices[device_x]._hints[0][0m
[30;1m239 | [0m[35m        if device_y:[0m

[31m--[ [0m[34mMatch #[0m[33m368[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/lmfit1d_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m218 | [0m[35m            }[0m
[30;1m219 | [0m[35m            return[0m
[30;1m220 | [0m[35m[0m
[30;1m221 | [0m[35m        selected_device = kwargs.get("selected_device")[0m
[30;1m222 | [0m[35m        if selected_device:[0m
[30;1m223 | [0m[35m            device_y, signal_y = selected_device[0m
[30;1m224 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m369[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/lmfit1d_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m133 | [0m[35m            self.finish_event = threading.Event()[0m
[30;1m134 | [0m[35m            threading.Thread(target=self.process_until_finished, args=(self.finish_event,)).start()[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m        if status.get("status") != "open":[0m
[30;1m137 | [0m[35m            time.sleep(0.2)[0m
[30;1m138 | [0m[35m            self.finish_event.set()[0m
[30;1m139 | [0m[35m            self.finish_event = None[0m

[31m--[ [0m[34mMatch #[0m[33m370[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/lmfit1d_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m313 | [0m[35m            return None[0m
[30;1m314 | [0m[35m        y = scan_item.live_data.get(device_y, {}).get(signal_y, {}).get("value")[0m
[30;1m315 | [0m[35m        if not y:[0m
[30;1m316 | [0m[35m            logger.warning(f"Failed to find signal {device_y}.{signal_y}")[0m
[30;1m317 | [0m[35m            return None[0m
[30;1m318 | [0m[35m[0m
[30;1m319 | [0m[35m        if len(x) < MIN_DATA_POINTS or len(y) < MIN_DATA_POINTS:[0m

[31m--[ [0m[34mMatch #[0m[33m371[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/lmfit1d_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m309 | [0m[35m            return None[0m
[30;1m310 | [0m[35m        x = scan_item.live_data.get(device_x, {}).get(signal_x, {}).get("value")[0m
[30;1m311 | [0m[35m        if not x:[0m
[30;1m312 | [0m[35m            logger.warning(f"Failed to find signal {device_x}.{signal_x}")[0m
[30;1m313 | [0m[35m            return None[0m
[30;1m314 | [0m[35m        y = scan_item.live_data.get(device_y, {}).get(signal_y, {}).get("value")[0m
[30;1m315 | [0m[35m        if not y:[0m

[31m--[ [0m[34mMatch #[0m[33m372[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/lmfit1d_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m297 | [0m[35m            # pylint: disable=protected-access[0m
[30;1m298 | [0m[35m            hints = bec_device_x._hints[0m
[30;1m299 | [0m[35m            if not hints:[0m
[30;1m300 | [0m[35m                logger.warning(f"Failed to find hints for device {device_x}")[0m
[30;1m301 | [0m[35m                return None[0m
[30;1m302 | [0m[35m            if len(hints) > 1:[0m
[30;1m303 | [0m[35m                logger.warning(f"Multiple hints found for device {device_x}")[0m

[31m--[ [0m[34mMatch #[0m[33m373[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/lmfit1d_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m292 | [0m[35m            device_x = scan_report_devices[0][0m
[30;1m293 | [0m[35m            bec_device_x = self.client.device_manager.devices.get(device_x)[0m
[30;1m294 | [0m[35m            if not bec_device_x:[0m
[30;1m295 | [0m[35m                logger.warning(f"Failed to find device {device_x}")[0m
[30;1m296 | [0m[35m                return None[0m
[30;1m297 | [0m[35m            # pylint: disable=protected-access[0m
[30;1m298 | [0m[35m            hints = bec_device_x._hints[0m

[31m--[ [0m[34mMatch #[0m[33m374[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/lmfit1d_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m287 | [0m[35m                return None[0m
[30;1m288 | [0m[35m            scan_report_devices = scan_item.live_data[0].metadata.get("scan_report_devices", [])[0m
[30;1m289 | [0m[35m            if not scan_report_devices:[0m
[30;1m290 | [0m[35m                logger.warning("Failed to find scan report devices")[0m
[30;1m291 | [0m[35m                return None[0m
[30;1m292 | [0m[35m            device_x = scan_report_devices[0][0m
[30;1m293 | [0m[35m            bec_device_x = self.client.device_manager.devices.get(device_x)[0m

[31m--[ [0m[34mMatch #[0m[33m375[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/lmfit1d_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m    def __init__(self, model: str, *args, continuous: bool = False, **kwargs):[0m
[30;1m32 | [0m[35m        """[0m
[30;1m33 | [0m[35m        Initialize the lmfit service. This is a multiplexer service that provides[0m
[30;1m34 | [0m[35m        access to multiple lmfit models.[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m        Args:[0m

[31m--[ [0m[34mMatch #[0m[33m376[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/lmfit1d_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35mclass LmfitService1D(DAPServiceBase):[0m
[30;1m25 | [0m[35m    """[0m
[30;1m26 | [0m[35m    Lmfit service for 1D data.[0m
[30;1m27 | [0m[35m    """[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    AUTO_FIT_SUPPORTED = True[0m

[31m--[ [0m[34mMatch #[0m[33m377[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/lmfit1d_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport inspect[0m
[30;1m4 | [0m[35mimport threading[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35mfrom typing import TYPE_CHECKING[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mimport lmfit[0m
[30;1m9 | [0m[35mimport numpy as np[0m

[31m--[ [0m[34mMatch #[0m[33m378[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/bec_server_utils/subprocess_launch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m38 | [0m[35m    for ii, service_info in enumerate(services.items()):[0m
[30;1m39 | [0m[35m        service, service_config = service_info[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m        if os.environ.get("CONDA_DEFAULT_ENV"):[0m
[30;1m42 | [0m[35m            cmd = f"{os.environ['CONDA_EXE']} run -n {os.environ['CONDA_DEFAULT_ENV']} --no-capture-[0m
[30;1m43 | [0m[35m        else:[0m
[30;1m44 | [0m[35m            cmd = service_config.command[0m

[31m--[ [0m[34mMatch #[0m[33m379[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/bec_server_utils/subprocess_launch.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m73 | [0m[35m    if not processes:[0m
[30;1m74 | [0m[35m        return[0m
[30;1m75 | [0m[35m    for process in processes:[0m
[30;1m76 | [0m[35m        cmd = process.args[0][0m
[30;1m77 | [0m[35m        for term in TERMINALS:[0m
[30;1m78 | [0m[35m            if term.cmd == cmd:[0m
[30;1m79 | [0m[35m                if term.spawn_child:[0m

[31m--[ [0m[34mMatch #[0m[33m380[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/bec_server_utils/subprocess_launch.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m41 | [0m[35m        if os.environ.get("CONDA_DEFAULT_ENV"):[0m
[30;1m42 | [0m[35m            cmd = f"{os.environ['CONDA_EXE']} run -n {os.environ['CONDA_DEFAULT_ENV']} --no-capture-[0m
[30;1m43 | [0m[35m        else:[0m
[30;1m44 | [0m[35m            cmd = service_config.command[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m        service_path = service_config.path.substitute(base_path=bec_path)[0m
[30;1m47 | [0m[35m        # service_config adds a subdirectory to each path, here we do not want the subdirectory[0m

[31m--[ [0m[34mMatch #[0m[33m381[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/bec_server_utils/subprocess_launch.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m39 | [0m[35m        service, service_config = service_info[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m        if os.environ.get("CONDA_DEFAULT_ENV"):[0m
[30;1m42 | [0m[35m            cmd = f"{os.environ['CONDA_EXE']} run -n {os.environ['CONDA_DEFAULT_ENV']} --no-capture-[0m
[30;1m43 | [0m[35m        else:[0m
[30;1m44 | [0m[35m            cmd = service_config.command[0m
[30;1m45 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m382[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m360 | [0m[35m            start_time=storage.start_time,[0m
[30;1m361 | [0m[35m            end_time=storage.end_time,[0m
[30;1m362 | [0m[35m            num_points=storage.num_points,[0m
[30;1m363 | [0m[35m            scan_name=storage.metadata.get("scan_name"),[0m
[30;1m364 | [0m[35m        )[0m
[30;1m365 | [0m[35m        self.connector.xadd([0m
[30;1m366 | [0m[35m            topic=MessageEndpoints.scan_history(), msg_dict={"data": history_msg}, max_size=10000[0m

[31m--[ [0m[34mMatch #[0m[33m383[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m355 | [0m[35m            scan_id=scan_id,[0m
[30;1m356 | [0m[35m            scan_number=storage.scan_number,[0m
[30;1m357 | [0m[35m            dataset_number=storage.metadata.get("dataset_number"),[0m
[30;1m358 | [0m[35m            exit_status=storage.metadata.get("exit_status"),[0m
[30;1m359 | [0m[35m            file_path=file_path,[0m
[30;1m360 | [0m[35m            start_time=storage.start_time,[0m
[30;1m361 | [0m[35m            end_time=storage.end_time,[0m

[31m--[ [0m[34mMatch #[0m[33m384[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m354 | [0m[35m        history_msg = messages.ScanHistoryMessage([0m
[30;1m355 | [0m[35m            scan_id=scan_id,[0m
[30;1m356 | [0m[35m            scan_number=storage.scan_number,[0m
[30;1m357 | [0m[35m            dataset_number=storage.metadata.get("dataset_number"),[0m
[30;1m358 | [0m[35m            exit_status=storage.metadata.get("exit_status"),[0m
[30;1m359 | [0m[35m            file_path=file_path,[0m
[30;1m360 | [0m[35m            start_time=storage.start_time,[0m

[31m--[ [0m[34mMatch #[0m[33m385[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m296 | [0m[35m        Args:[0m
[30;1m297 | [0m[35m            scan_id (str): Scan ID[0m
[30;1m298 | [0m[35m        """[0m
[30;1m299 | [0m[35m        if not self.scan_storage.get(scan_id):[0m
[30;1m300 | [0m[35m            return[0m
[30;1m301 | [0m[35m        storage = self.scan_storage[scan_id][0m
[30;1m302 | [0m[35m        if storage.scan_number is None:[0m

[31m--[ [0m[34mMatch #[0m[33m386[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m282 | [0m[35m            scan_id (str): Scan ID[0m
[30;1m283 | [0m[35m        """[0m
[30;1m284 | [0m[35m        with self._lock:[0m
[30;1m285 | [0m[35m            if not self.scan_storage.get(scan_id):[0m
[30;1m286 | [0m[35m                return[0m
[30;1m287 | [0m[35m            self.update_baseline_reading(scan_id)[0m
[30;1m288 | [0m[35m            self.update_file_references(scan_id)[0m

[31m--[ [0m[34mMatch #[0m[33m387[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m258 | [0m[35m[0m
[30;1m259 | [0m[35m        # extract name from 'public/<scan_id>/file/<name>'[0m
[30;1m260 | [0m[35m        names = [msg.decode().split("/")[-1] for msg in msgs][0m
[30;1m261 | [0m[35m        file_msgs = [self.connector.get(msg.decode()) for msg in msgs][0m
[30;1m262 | [0m[35m        if not file_msgs:[0m
[30;1m263 | [0m[35m            return[0m
[30;1m264 | [0m[35m        for name, file_msg in zip(names, file_msgs):[0m

[31m--[ [0m[34mMatch #[0m[33m388[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m250 | [0m[35m        Args:[0m
[30;1m251 | [0m[35m            scan_id (str): Scan ID[0m
[30;1m252 | [0m[35m        """[0m
[30;1m253 | [0m[35m        if not self.scan_storage.get(scan_id):[0m
[30;1m254 | [0m[35m            return[0m
[30;1m255 | [0m[35m        msgs = self.connector.keys(MessageEndpoints.public_file(scan_id, "*"))[0m
[30;1m256 | [0m[35m        if not msgs:[0m

[31m--[ [0m[34mMatch #[0m[33m389[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m235 | [0m[35m            return[0m
[30;1m236 | [0m[35m        if self.scan_storage[scan_id].baseline:[0m
[30;1m237 | [0m[35m            return[0m
[30;1m238 | [0m[35m        baseline = self.connector.get(MessageEndpoints.public_scan_baseline(scan_id))[0m
[30;1m239 | [0m[35m        if not baseline:[0m
[30;1m240 | [0m[35m            return[0m
[30;1m241 | [0m[35m        self.scan_storage[scan_id].baseline = baseline.content["data"][0m

[31m--[ [0m[34mMatch #[0m[33m390[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m231 | [0m[35m        Args:[0m
[30;1m232 | [0m[35m            scan_id (str): Scan ID[0m
[30;1m233 | [0m[35m        """[0m
[30;1m234 | [0m[35m        if not self.scan_storage.get(scan_id):[0m
[30;1m235 | [0m[35m            return[0m
[30;1m236 | [0m[35m        if self.scan_storage[scan_id].baseline:[0m
[30;1m237 | [0m[35m            return[0m

[31m--[ [0m[34mMatch #[0m[33m391[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m221 | [0m[35m        self.scan_storage[scan_id].append([0m
[30;1m222 | [0m[35m            point_id=msg.content.get("point_id"), data=msg.content.get("data")[0m
[30;1m223 | [0m[35m        )[0m
[30;1m224 | [0m[35m        logger.debug(msg.content.get("point_id"))[0m
[30;1m225 | [0m[35m        self.check_storage_status(scan_id=scan_id)[0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m    def update_baseline_reading(self, scan_id: str) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m392[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m219 | [0m[35m                scan_number=msg.metadata.get("scan_number"), scan_id=scan_id[0m
[30;1m220 | [0m[35m            )[0m
[30;1m221 | [0m[35m        self.scan_storage[scan_id].append([0m
[30;1m222 | [0m[35m            point_id=msg.content.get("point_id"), data=msg.content.get("data")[0m
[30;1m223 | [0m[35m        )[0m
[30;1m224 | [0m[35m        logger.debug(msg.content.get("point_id"))[0m
[30;1m225 | [0m[35m        self.check_storage_status(scan_id=scan_id)[0m

[31m--[ [0m[34mMatch #[0m[33m393[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m219 | [0m[35m                scan_number=msg.metadata.get("scan_number"), scan_id=scan_id[0m
[30;1m220 | [0m[35m            )[0m
[30;1m221 | [0m[35m        self.scan_storage[scan_id].append([0m
[30;1m222 | [0m[35m            point_id=msg.content.get("point_id"), data=msg.content.get("data")[0m
[30;1m223 | [0m[35m        )[0m
[30;1m224 | [0m[35m        logger.debug(msg.content.get("point_id"))[0m
[30;1m225 | [0m[35m        self.check_storage_status(scan_id=scan_id)[0m

[31m--[ [0m[34mMatch #[0m[33m394[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m216 | [0m[35m            return[0m
[30;1m217 | [0m[35m        if not self.scan_storage.get(scan_id):[0m
[30;1m218 | [0m[35m            self.scan_storage[scan_id] = ScanStorage([0m
[30;1m219 | [0m[35m                scan_number=msg.metadata.get("scan_number"), scan_id=scan_id[0m
[30;1m220 | [0m[35m            )[0m
[30;1m221 | [0m[35m        self.scan_storage[scan_id].append([0m
[30;1m222 | [0m[35m            point_id=msg.content.get("point_id"), data=msg.content.get("data")[0m

[31m--[ [0m[34mMatch #[0m[33m395[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m214 | [0m[35m        scan_id = msg.content.get("scan_id")[0m
[30;1m215 | [0m[35m        if scan_id is None:[0m
[30;1m216 | [0m[35m            return[0m
[30;1m217 | [0m[35m        if not self.scan_storage.get(scan_id):[0m
[30;1m218 | [0m[35m            self.scan_storage[scan_id] = ScanStorage([0m
[30;1m219 | [0m[35m                scan_number=msg.metadata.get("scan_number"), scan_id=scan_id[0m
[30;1m220 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m396[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m211 | [0m[35m        Args:[0m
[30;1m212 | [0m[35m            msg (messages.ScanMessage): Scan message[0m
[30;1m213 | [0m[35m        """[0m
[30;1m214 | [0m[35m        scan_id = msg.content.get("scan_id")[0m
[30;1m215 | [0m[35m        if scan_id is None:[0m
[30;1m216 | [0m[35m            return[0m
[30;1m217 | [0m[35m        if not self.scan_storage.get(scan_id):[0m

[31m--[ [0m[34mMatch #[0m[33m397[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m            scan_storage.scan_finished = True[0m
[30;1m193 | [0m[35m            scan_storage.num_points = msg.num_points[0m
[30;1m194 | [0m[35m            info = msg.content.get("info")[0m
[30;1m195 | [0m[35m            if info:[0m
[30;1m196 | [0m[35m                if msg.scan_type == "step":[0m
[30;1m197 | [0m[35m                    scan_storage.enforce_sync = True[0m

[31m--[ [0m[34mMatch #[0m[33m398[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m187 | [0m[35m            if status in ["aborted", "halted"]:[0m
[30;1m188 | [0m[35m                scan_storage.forced_finish = True[0m
[30;1m189 | [0m[35m            if not scan_storage.end_time:[0m
[30;1m190 | [0m[35m                scan_storage.end_time = msg.content.get("timestamp")[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m            scan_storage.scan_finished = True[0m
[30;1m193 | [0m[35m            scan_storage.num_points = msg.num_points[0m

[31m--[ [0m[34mMatch #[0m[33m399[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m179 | [0m[35m                self.writer_mixin.compile_full_filename(suffix="master"),[0m
[30;1m180 | [0m[35m                scan_id=scan_id,[0m
[30;1m181 | [0m[35m                connector=self.connector,[0m
[30;1m182 | [0m[35m                devices=msg.readout_priority.get("async", []),[0m
[30;1m183 | [0m[35m            )[0m
[30;1m184 | [0m[35m            scan_storage.async_writer.start()[0m
[30;1m185 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m400[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m174 | [0m[35m        if status:[0m
[30;1m175 | [0m[35m            scan_storage.metadata["exit_status"] = status[0m
[30;1m176 | [0m[35m        if status == "open" and not scan_storage.start_time:[0m
[30;1m177 | [0m[35m            scan_storage.start_time = msg.content.get("timestamp")[0m
[30;1m178 | [0m[35m            scan_storage.async_writer = AsyncWriter([0m
[30;1m179 | [0m[35m                self.writer_mixin.compile_full_filename(suffix="master"),[0m
[30;1m180 | [0m[35m                scan_id=scan_id,[0m

[31m--[ [0m[34mMatch #[0m[33m401[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35m        scan_storage = self.scan_storage[scan_id][0m
[30;1m172 | [0m[35m        scan_storage.metadata.update(metadata)[0m
[30;1m173 | [0m[35m        status = msg.content.get("status")[0m
[30;1m174 | [0m[35m        if status:[0m
[30;1m175 | [0m[35m            scan_storage.metadata["exit_status"] = status[0m
[30;1m176 | [0m[35m        if status == "open" and not scan_storage.start_time:[0m

[31m--[ [0m[34mMatch #[0m[33m402[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m164 | [0m[35m            self.scan_storage[scan_id] = ScanStorage([0m
[30;1m165 | [0m[35m                scan_number=msg.content["info"].get("scan_number"), scan_id=scan_id[0m
[30;1m166 | [0m[35m            )[0m
[30;1m167 | [0m[35m        metadata = msg.content.get("info").copy()[0m
[30;1m168 | [0m[35m        metadata.pop("DIID", None)[0m
[30;1m169 | [0m[35m        metadata.pop("stream", None)[0m
[30;1m170 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m403[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m        if not self.scan_storage.get(scan_id):[0m
[30;1m164 | [0m[35m            self.scan_storage[scan_id] = ScanStorage([0m
[30;1m165 | [0m[35m                scan_number=msg.content["info"].get("scan_number"), scan_id=scan_id[0m
[30;1m166 | [0m[35m            )[0m
[30;1m167 | [0m[35m        metadata = msg.content.get("info").copy()[0m
[30;1m168 | [0m[35m        metadata.pop("DIID", None)[0m

[31m--[ [0m[34mMatch #[0m[33m404[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m160 | [0m[35m        if scan_id is None:[0m
[30;1m161 | [0m[35m            return[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m        if not self.scan_storage.get(scan_id):[0m
[30;1m164 | [0m[35m            self.scan_storage[scan_id] = ScanStorage([0m
[30;1m165 | [0m[35m                scan_number=msg.content["info"].get("scan_number"), scan_id=scan_id[0m
[30;1m166 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m405[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m156 | [0m[35m        Args:[0m
[30;1m157 | [0m[35m            msg (messages.ScanStatusMessage): Scan status message[0m
[30;1m158 | [0m[35m        """[0m
[30;1m159 | [0m[35m        scan_id = msg.content.get("scan_id")[0m
[30;1m160 | [0m[35m        if scan_id is None:[0m
[30;1m161 | [0m[35m            return[0m
[30;1m162 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m406[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m145 | [0m[35m        Refresh the device configurations.[0m
[30;1m146 | [0m[35m        """[0m
[30;1m147 | [0m[35m        for device in self.device_manager.devices:[0m
[30;1m148 | [0m[35m            info = self.connector.get(MessageEndpoints.device_read_configuration(device))[0m
[30;1m149 | [0m[35m            if info:[0m
[30;1m150 | [0m[35m                self.update_device_configuration(device, info)[0m
[30;1m151 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m407[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m        self.callbacks.register([0m
[30;1m86 | [0m[35m            event_type=EventType.DEVICE_UPDATE, callback=self._update_available_devices[0m
[30;1m87 | [0m[35m        )[0m
[30;1m88 | [0m[35m        self.file_writer_config = self._service_config.service_config.get("file_writer")[0m
[30;1m89 | [0m[35m        self._start_device_manager()[0m
[30;1m90 | [0m[35m        self.device_configuration = {}[0m
[30;1m91 | [0m[35m        self.connector.register([0m

[31m--[ [0m[34mMatch #[0m[33m408[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m267 | [0m[35m[0m
[30;1m268 | [0m[35m    def update_device_configuration(self, device: str, msg: messages.DeviceMessage) -> None:[0m
[30;1m269 | [0m[35m        """[0m
[30;1m270 | [0m[35m        Update the device configuration. Note that this is a global configuration and not specific t[0m
[30;1m271 | [0m[35m[0m
[30;1m272 | [0m[35m        Args:[0m
[30;1m273 | [0m[35m            msg (messages.DeviceMessage): Device message[0m

[31m--[ [0m[34mMatch #[0m[33m409[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m243 | [0m[35m[0m
[30;1m244 | [0m[35m    def update_file_references(self, scan_id: str) -> None:[0m
[30;1m245 | [0m[35m        """[0m
[30;1m246 | [0m[35m        Update the file references for the scan.[0m
[30;1m247 | [0m[35m        All external files ought to be announced to the endpoint public_file before the scan finishe[0m
[30;1m248 | [0m[35m        retrieves the file references and adds them to the scan storage.[0m
[30;1m249 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m410[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m    def update_baseline_reading(self, scan_id: str) -> None:[0m
[30;1m228 | [0m[35m        """[0m
[30;1m229 | [0m[35m        Update the baseline reading for the scan.[0m
[30;1m230 | [0m[35m[0m
[30;1m231 | [0m[35m        Args:[0m
[30;1m232 | [0m[35m            scan_id (str): Scan ID[0m

[31m--[ [0m[34mMatch #[0m[33m411[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m151 | [0m[35m[0m
[30;1m152 | [0m[35m    def update_scan_storage_with_status(self, msg: messages.ScanStatusMessage) -> None:[0m
[30;1m153 | [0m[35m        """[0m
[30;1m154 | [0m[35m        Update the scan storage with the scan status.[0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35m        Args:[0m
[30;1m157 | [0m[35m            msg (messages.ScanStatusMessage): Scan status message[0m

[31m--[ [0m[34mMatch #[0m[33m412[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m    def _update_available_devices(self, *args) -> None:[0m
[30;1m133 | [0m[35m        """[0m
[30;1m134 | [0m[35m        Update the available devices.[0m
[30;1m135 | [0m[35m        """[0m
[30;1m136 | [0m[35m        for device in self.device_configuration:[0m
[30;1m137 | [0m[35m            if ([0m

[31m--[ [0m[34mMatch #[0m[33m413[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m61 | [0m[35m            return True[0m
[30;1m62 | [0m[35m        if self.enforce_sync:[0m
[30;1m63 | [0m[35m            # wait for all points to be received. Since this method will be called for every[0m
[30;1m64 | [0m[35m            # update of the scan segments, we can also accept to write after the scan is finished[0m
[30;1m65 | [0m[35m            _ready_to_write = self.scan_finished and (self.num_points == len(self.scan_segments))[0m
[30;1m66 | [0m[35m            logger.info([0m
[30;1m67 | [0m[35m                f"Received number of segments: {len(self.scan_segments)}, Number of points (expected[0m

[31m--[ [0m[34mMatch #[0m[33m414[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m76 | [0m[35m        Service to write scan data to file.[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m        Args:[0m
[30;1m79 | [0m[35m            config (ServiceConfig): Service config[0m
[30;1m80 | [0m[35m            connector_cls (RedisConnector): Connector class[0m
[30;1m81 | [0m[35m        """[0m
[30;1m82 | [0m[35m        super().__init__(config, connector_cls, unique_service=True)[0m

[31m--[ [0m[34mMatch #[0m[33m415[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m73 | [0m[35mclass FileWriterManager(BECService):[0m
[30;1m74 | [0m[35m    def __init__(self, config: ServiceConfig, connector_cls: type[RedisConnector]) -> None:[0m
[30;1m75 | [0m[35m        """[0m
[30;1m76 | [0m[35m        Service to write scan data to file.[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m        Args:[0m
[30;1m79 | [0m[35m            config (ServiceConfig): Service config[0m

[31m--[ [0m[34mMatch #[0m[33m416[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer_manager.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mfrom __future__ import annotations[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport threading[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35mimport traceback[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mfrom bec_lib import messages[0m
[30;1m8 | [0m[35mfrom bec_lib.alarm_handler import Alarms[0m

[31m--[ [0m[34mMatch #[0m[33m417[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m373 | [0m[35m        action = instr.content.get("action")[0m
[30;1m374 | [0m[35m        scan_def_id = instr.metadata.get("scan_def_id")[0m
[30;1m375 | [0m[35m        if self.current_scan_id != instr.metadata.get("scan_id"):[0m
[30;1m376 | [0m[35m            self.current_scan_id = instr.metadata.get("scan_id")[0m
[30;1m377 | [0m[35m[0m
[30;1m378 | [0m[35m        if "point_id" in instr.metadata:[0m
[30;1m379 | [0m[35m            self.max_point_id = instr.metadata["point_id"][0m

[31m--[ [0m[34mMatch #[0m[33m418[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m372 | [0m[35m        logger.debug(instr)[0m
[30;1m373 | [0m[35m        action = instr.content.get("action")[0m
[30;1m374 | [0m[35m        scan_def_id = instr.metadata.get("scan_def_id")[0m
[30;1m375 | [0m[35m        if self.current_scan_id != instr.metadata.get("scan_id"):[0m
[30;1m376 | [0m[35m            self.current_scan_id = instr.metadata.get("scan_id")[0m
[30;1m377 | [0m[35m[0m
[30;1m378 | [0m[35m        if "point_id" in instr.metadata:[0m

[31m--[ [0m[34mMatch #[0m[33m419[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m371 | [0m[35m    def _instruction_step(self, instr: messages.DeviceInstructionMessage):[0m
[30;1m372 | [0m[35m        logger.debug(instr)[0m
[30;1m373 | [0m[35m        action = instr.content.get("action")[0m
[30;1m374 | [0m[35m        scan_def_id = instr.metadata.get("scan_def_id")[0m
[30;1m375 | [0m[35m        if self.current_scan_id != instr.metadata.get("scan_id"):[0m
[30;1m376 | [0m[35m            self.current_scan_id = instr.metadata.get("scan_id")[0m
[30;1m377 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m420[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m370 | [0m[35m[0m
[30;1m371 | [0m[35m    def _instruction_step(self, instr: messages.DeviceInstructionMessage):[0m
[30;1m372 | [0m[35m        logger.debug(instr)[0m
[30;1m373 | [0m[35m        action = instr.content.get("action")[0m
[30;1m374 | [0m[35m        scan_def_id = instr.metadata.get("scan_def_id")[0m
[30;1m375 | [0m[35m        if self.current_scan_id != instr.metadata.get("scan_id"):[0m
[30;1m376 | [0m[35m            self.current_scan_id = instr.metadata.get("scan_id")[0m

[31m--[ [0m[34mMatch #[0m[33m421[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m293 | [0m[35m                else [instr.content["device"]][0m
[30;1m294 | [0m[35m            )[0m
[30;1m295 | [0m[35m[0m
[30;1m296 | [0m[35m            if set(readback.get("devices", [])) & set(instr_device):[0m
[30;1m297 | [0m[35m                instr.metadata["response"] = True[0m
[30;1m298 | [0m[35m[0m
[30;1m299 | [0m[35m    def _process_instructions(self, queue: InstructionQueueItem) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m422[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m268 | [0m[35m            request_inputs=self.current_scan_info.get("request_inputs"),[0m
[30;1m269 | [0m[35m            info=self.current_scan_info,[0m
[30;1m270 | [0m[35m        )[0m
[30;1m271 | [0m[35m        if msg.readout_priority != self.current_scan_info.get("readout_priority"):[0m
[30;1m272 | [0m[35m            raise RuntimeError("Readout priority mismatch")[0m
[30;1m273 | [0m[35m        expire = None if status in ["open", "paused"] else 1800[0m
[30;1m274 | [0m[35m        pipe = self.device_manager.connector.pipeline()[0m

[31m--[ [0m[34mMatch #[0m[33m423[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m265 | [0m[35m            user_metadata=self.current_scan_info.get("user_metadata"),[0m
[30;1m266 | [0m[35m            readout_priority=self.current_scan_info.get("readout_priority"),[0m
[30;1m267 | [0m[35m            scan_parameters=self.current_scan_info.get("scan_parameters"),[0m
[30;1m268 | [0m[35m            request_inputs=self.current_scan_info.get("request_inputs"),[0m
[30;1m269 | [0m[35m            info=self.current_scan_info,[0m
[30;1m270 | [0m[35m        )[0m
[30;1m271 | [0m[35m        if msg.readout_priority != self.current_scan_info.get("readout_priority"):[0m

[31m--[ [0m[34mMatch #[0m[33m424[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m264 | [0m[35m            scan_report_devices=self.current_scan_info.get("scan_report_devices"),[0m
[30;1m265 | [0m[35m            user_metadata=self.current_scan_info.get("user_metadata"),[0m
[30;1m266 | [0m[35m            readout_priority=self.current_scan_info.get("readout_priority"),[0m
[30;1m267 | [0m[35m            scan_parameters=self.current_scan_info.get("scan_parameters"),[0m
[30;1m268 | [0m[35m            request_inputs=self.current_scan_info.get("request_inputs"),[0m
[30;1m269 | [0m[35m            info=self.current_scan_info,[0m
[30;1m270 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m425[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m263 | [0m[35m            scan_type=self.current_scan_info.get("scan_type"),[0m
[30;1m264 | [0m[35m            scan_report_devices=self.current_scan_info.get("scan_report_devices"),[0m
[30;1m265 | [0m[35m            user_metadata=self.current_scan_info.get("user_metadata"),[0m
[30;1m266 | [0m[35m            readout_priority=self.current_scan_info.get("readout_priority"),[0m
[30;1m267 | [0m[35m            scan_parameters=self.current_scan_info.get("scan_parameters"),[0m
[30;1m268 | [0m[35m            request_inputs=self.current_scan_info.get("request_inputs"),[0m
[30;1m269 | [0m[35m            info=self.current_scan_info,[0m

[31m--[ [0m[34mMatch #[0m[33m426[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m262 | [0m[35m            num_points=self.current_scan_info.get("num_points"),[0m
[30;1m263 | [0m[35m            scan_type=self.current_scan_info.get("scan_type"),[0m
[30;1m264 | [0m[35m            scan_report_devices=self.current_scan_info.get("scan_report_devices"),[0m
[30;1m265 | [0m[35m            user_metadata=self.current_scan_info.get("user_metadata"),[0m
[30;1m266 | [0m[35m            readout_priority=self.current_scan_info.get("readout_priority"),[0m
[30;1m267 | [0m[35m            scan_parameters=self.current_scan_info.get("scan_parameters"),[0m
[30;1m268 | [0m[35m            request_inputs=self.current_scan_info.get("request_inputs"),[0m

[31m--[ [0m[34mMatch #[0m[33m427[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m261 | [0m[35m            dataset_number=self.current_scan_info.get("dataset_number"),[0m
[30;1m262 | [0m[35m            num_points=self.current_scan_info.get("num_points"),[0m
[30;1m263 | [0m[35m            scan_type=self.current_scan_info.get("scan_type"),[0m
[30;1m264 | [0m[35m            scan_report_devices=self.current_scan_info.get("scan_report_devices"),[0m
[30;1m265 | [0m[35m            user_metadata=self.current_scan_info.get("user_metadata"),[0m
[30;1m266 | [0m[35m            readout_priority=self.current_scan_info.get("readout_priority"),[0m
[30;1m267 | [0m[35m            scan_parameters=self.current_scan_info.get("scan_parameters"),[0m

[31m--[ [0m[34mMatch #[0m[33m428[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m260 | [0m[35m            session_id=self.current_scan_info.get("session_id"),[0m
[30;1m261 | [0m[35m            dataset_number=self.current_scan_info.get("dataset_number"),[0m
[30;1m262 | [0m[35m            num_points=self.current_scan_info.get("num_points"),[0m
[30;1m263 | [0m[35m            scan_type=self.current_scan_info.get("scan_type"),[0m
[30;1m264 | [0m[35m            scan_report_devices=self.current_scan_info.get("scan_report_devices"),[0m
[30;1m265 | [0m[35m            user_metadata=self.current_scan_info.get("user_metadata"),[0m
[30;1m266 | [0m[35m            readout_priority=self.current_scan_info.get("readout_priority"),[0m

[31m--[ [0m[34mMatch #[0m[33m429[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m259 | [0m[35m            scan_number=self.current_scan_info.get("scan_number"),[0m
[30;1m260 | [0m[35m            session_id=self.current_scan_info.get("session_id"),[0m
[30;1m261 | [0m[35m            dataset_number=self.current_scan_info.get("dataset_number"),[0m
[30;1m262 | [0m[35m            num_points=self.current_scan_info.get("num_points"),[0m
[30;1m263 | [0m[35m            scan_type=self.current_scan_info.get("scan_type"),[0m
[30;1m264 | [0m[35m            scan_report_devices=self.current_scan_info.get("scan_report_devices"),[0m
[30;1m265 | [0m[35m            user_metadata=self.current_scan_info.get("user_metadata"),[0m

[31m--[ [0m[34mMatch #[0m[33m430[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m258 | [0m[35m            scan_name=self.current_scan_info.get("scan_name"),[0m
[30;1m259 | [0m[35m            scan_number=self.current_scan_info.get("scan_number"),[0m
[30;1m260 | [0m[35m            session_id=self.current_scan_info.get("session_id"),[0m
[30;1m261 | [0m[35m            dataset_number=self.current_scan_info.get("dataset_number"),[0m
[30;1m262 | [0m[35m            num_points=self.current_scan_info.get("num_points"),[0m
[30;1m263 | [0m[35m            scan_type=self.current_scan_info.get("scan_type"),[0m
[30;1m264 | [0m[35m            scan_report_devices=self.current_scan_info.get("scan_report_devices"),[0m

[31m--[ [0m[34mMatch #[0m[33m431[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m257 | [0m[35m            status=status,[0m
[30;1m258 | [0m[35m            scan_name=self.current_scan_info.get("scan_name"),[0m
[30;1m259 | [0m[35m            scan_number=self.current_scan_info.get("scan_number"),[0m
[30;1m260 | [0m[35m            session_id=self.current_scan_info.get("session_id"),[0m
[30;1m261 | [0m[35m            dataset_number=self.current_scan_info.get("dataset_number"),[0m
[30;1m262 | [0m[35m            num_points=self.current_scan_info.get("num_points"),[0m
[30;1m263 | [0m[35m            scan_type=self.current_scan_info.get("scan_type"),[0m

[31m--[ [0m[34mMatch #[0m[33m432[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m256 | [0m[35m            scan_id=self.current_scan_id,[0m
[30;1m257 | [0m[35m            status=status,[0m
[30;1m258 | [0m[35m            scan_name=self.current_scan_info.get("scan_name"),[0m
[30;1m259 | [0m[35m            scan_number=self.current_scan_info.get("scan_number"),[0m
[30;1m260 | [0m[35m            session_id=self.current_scan_info.get("session_id"),[0m
[30;1m261 | [0m[35m            dataset_number=self.current_scan_info.get("dataset_number"),[0m
[30;1m262 | [0m[35m            num_points=self.current_scan_info.get("num_points"),[0m

[31m--[ [0m[34mMatch #[0m[33m433[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m255 | [0m[35m        msg = messages.ScanStatusMessage([0m
[30;1m256 | [0m[35m            scan_id=self.current_scan_id,[0m
[30;1m257 | [0m[35m            status=status,[0m
[30;1m258 | [0m[35m            scan_name=self.current_scan_info.get("scan_name"),[0m
[30;1m259 | [0m[35m            scan_number=self.current_scan_info.get("scan_number"),[0m
[30;1m260 | [0m[35m            session_id=self.current_scan_info.get("session_id"),[0m
[30;1m261 | [0m[35m            dataset_number=self.current_scan_info.get("dataset_number"),[0m

[31m--[ [0m[34mMatch #[0m[33m434[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m247 | [0m[35m[0m
[30;1m248 | [0m[35m    def _send_scan_status(self, status: str):[0m
[30;1m249 | [0m[35m        current_scan_info_print = self.current_scan_info.copy()[0m
[30;1m250 | [0m[35m        if current_scan_info_print.get("positions", []):[0m
[30;1m251 | [0m[35m            current_scan_info_print["positions"] = "..."[0m
[30;1m252 | [0m[35m        logger.info([0m
[30;1m253 | [0m[35m            f"New scan status: {self.current_scan_id} / {status} / {current_scan_info_print}"[0m

[31m--[ [0m[34mMatch #[0m[33m435[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m105 | [0m[35m        self.scan_id = None[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m        scan_info = self.current_scan_info[0m
[30;1m108 | [0m[35m        if scan_info.get("scan_type") == "fly":[0m
[30;1m109 | [0m[35m            # flyers do not increase the point_id but instead set the num_points directly[0m
[30;1m110 | [0m[35m            num_points = self.current_instruction_queue_item.active_request_block.scan.num_pos[0m
[30;1m111 | [0m[35m            self.current_scan_info["num_points"] = num_points[0m

[31m--[ [0m[34mMatch #[0m[33m436[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m96 | [0m[35m            instr (DeviceInstructionMessage): Device instruction received from the scan assembler[0m
[30;1m97 | [0m[35m            max_point_id (int): Maximum point ID of the scan[0m
[30;1m98 | [0m[35m        """[0m
[30;1m99 | [0m[35m        scan_id = instr.metadata.get("scan_id")[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m        if self.scan_id != scan_id:[0m
[30;1m102 | [0m[35m            return[0m

[31m--[ [0m[34mMatch #[0m[33m437[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m        # only append the scan_progress if the scan is not using device_progress[0m
[30;1m82 | [0m[35m        if active_rb.scan.use_scan_progress_report:[0m
[30;1m83 | [0m[35m            if not self.scan_report_instructions or not self.scan_report_instructions[-1].get([0m
[30;1m84 | [0m[35m                "device_progress"[0m
[30;1m85 | [0m[35m            ):[0m
[30;1m86 | [0m[35m                self.scan_report_instructions.append({"scan_progress": num_points})[0m

[31m--[ [0m[34mMatch #[0m[33m438[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m        if not instr.metadata.get("scan_def_id"):[0m
[30;1m69 | [0m[35m            self.max_point_id = 0[0m
[30;1m70 | [0m[35m        instr_num_points = instr.content["parameter"].get("num_points", 0)[0m
[30;1m71 | [0m[35m        if instr_num_points is None:[0m
[30;1m72 | [0m[35m            instr_num_points = 0[0m
[30;1m73 | [0m[35m        num_points = self.max_point_id + instr_num_points[0m

[31m--[ [0m[34mMatch #[0m[33m439[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m65 | [0m[35m                self.readout_priority = instr.content["parameter"].get("readout_priority", {})[0m
[30;1m66 | [0m[35m            self.scan_type = instr.content["parameter"].get("scan_type")[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m        if not instr.metadata.get("scan_def_id"):[0m
[30;1m69 | [0m[35m            self.max_point_id = 0[0m
[30;1m70 | [0m[35m        instr_num_points = instr.content["parameter"].get("num_points", 0)[0m
[30;1m71 | [0m[35m        if instr_num_points is None:[0m

[31m--[ [0m[34mMatch #[0m[33m440[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m63 | [0m[35m                    for dev in instr.content["parameter"].get("scan_motors")[0m
[30;1m64 | [0m[35m                ][0m
[30;1m65 | [0m[35m                self.readout_priority = instr.content["parameter"].get("readout_priority", {})[0m
[30;1m66 | [0m[35m            self.scan_type = instr.content["parameter"].get("scan_type")[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m        if not instr.metadata.get("scan_def_id"):[0m
[30;1m69 | [0m[35m            self.max_point_id = 0[0m

[31m--[ [0m[34mMatch #[0m[33m441[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m                    self.device_manager.devices[dev][0m
[30;1m63 | [0m[35m                    for dev in instr.content["parameter"].get("scan_motors")[0m
[30;1m64 | [0m[35m                ][0m
[30;1m65 | [0m[35m                self.readout_priority = instr.content["parameter"].get("readout_priority", {})[0m
[30;1m66 | [0m[35m            self.scan_type = instr.content["parameter"].get("scan_type")[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m        if not instr.metadata.get("scan_def_id"):[0m

[31m--[ [0m[34mMatch #[0m[33m442[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m60 | [0m[35m            if instr.content["parameter"].get("scan_motors") is not None:[0m
[30;1m61 | [0m[35m                self.scan_motors = [[0m
[30;1m62 | [0m[35m                    self.device_manager.devices[dev][0m
[30;1m63 | [0m[35m                    for dev in instr.content["parameter"].get("scan_motors")[0m
[30;1m64 | [0m[35m                ][0m
[30;1m65 | [0m[35m                self.readout_priority = instr.content["parameter"].get("readout_priority", {})[0m
[30;1m66 | [0m[35m            self.scan_type = instr.content["parameter"].get("scan_type")[0m

[31m--[ [0m[34mMatch #[0m[33m443[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m57 | [0m[35m        """[0m
[30;1m58 | [0m[35m        if not self.scan_id:[0m
[30;1m59 | [0m[35m            self.scan_id = instr.metadata.get("scan_id")[0m
[30;1m60 | [0m[35m            if instr.content["parameter"].get("scan_motors") is not None:[0m
[30;1m61 | [0m[35m                self.scan_motors = [[0m
[30;1m62 | [0m[35m                    self.device_manager.devices[dev][0m
[30;1m63 | [0m[35m                    for dev in instr.content["parameter"].get("scan_motors")[0m

[31m--[ [0m[34mMatch #[0m[33m444[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m        """[0m
[30;1m58 | [0m[35m        if not self.scan_id:[0m
[30;1m59 | [0m[35m            self.scan_id = instr.metadata.get("scan_id")[0m
[30;1m60 | [0m[35m            if instr.content["parameter"].get("scan_motors") is not None:[0m
[30;1m61 | [0m[35m                self.scan_motors = [[0m
[30;1m62 | [0m[35m                    self.device_manager.devices[dev][0m

[31m--[ [0m[34mMatch #[0m[33m445[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_worker.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m111 | [0m[35m            self.current_scan_info["num_points"] = num_points[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m        else:[0m
[30;1m114 | [0m[35m            # point_id starts at 0[0m
[30;1m115 | [0m[35m            scan_info["num_points"] = max_point_id + 1[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m        self._send_scan_status("closed")[0m

[31m--[ [0m[34mMatch #[0m[33m446[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/scan_worker.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mfrom __future__ import annotations[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport threading[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35mimport traceback[0m
[30;1m6 | [0m[35mfrom typing import TYPE_CHECKING[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mfrom bec_lib import messages[0m

[31m--[ [0m[34mMatch #[0m[33m447[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/cli/launch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35m# pylint: disable=wrong-import-position[0m
[30;1m6 | [0m[35m# pylint: disable=wrong-import-order[0m
[30;1m7 | [0m[35m# we need to run the startup script before we import anything else. This is[0m
[30;1m8 | [0m[35m# to ensure that the epics environment variables are set correctly.[0m
[30;1m9 | [0m[35mimport importlib.metadata as imd[0m
[30;1m10 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m448[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/bec_server_utils/tmux_launch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m101 | [0m[35m    if avail_sessions:[0m
[30;1m102 | [0m[35m        session = avail_sessions[0][0m
[30;1m103 | [0m[35m        for bash_pid in map(int, [p.pane_pid for p in session.panes]):[0m
[30;1m104 | [0m[35m            # bash_pid is tmux "bash -c" (= primary) pid for the pane[0m
[30;1m105 | [0m[35m            for proc in psutil.Process(bash_pid).children():[0m
[30;1m106 | [0m[35m                # there should be only 1 child pid[0m
[30;1m107 | [0m[35m                os.kill(proc.pid, signal.SIGTERM)[0m

[31m--[ [0m[34mMatch #[0m[33m449[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/bec_server_utils/tmux_launch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    Args:[0m
[30;1m61 | [0m[35m        bec_path (str): Path to the BEC source code[0m
[30;1m62 | [0m[35m        services (dict): Dictionary of services to launch. Keys are the service names, values are pa[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m    """[0m
[30;1m65 | [0m[35m    sessions = {}[0m

[31m--[ [0m[34mMatch #[0m[33m450[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/bec_server_utils/tmux_launch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35mdef tmux_start(bec_path: str, services: dict):[0m
[30;1m55 | [0m[35m    """[0m
[30;1m56 | [0m[35m    Launch services in a tmux session. All services are launched in separate panes.[0m
[30;1m57 | [0m[35m    Services config dict contains "tmux_session_name" (default: "bec") and "window_label" (default: [0m
[30;1m58 | [0m[35m    must be the same for the same session).[0m
[30;1m59 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m451[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/bec_server_utils/tmux_launch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35m    """[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m    # check if the current file was installed with pip install -e (editable mode)[0m
[30;1m16 | [0m[35m    # if so, the venv is the service directory and it's called <service_name>_venv[0m
[30;1m17 | [0m[35m    # otherwise, we simply take the currently running venv ;[0m
[30;1m18 | [0m[35m    # in case of no venv, maybe it is running within a Conda environment[0m
[30;1m19 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m452[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/bec_server_utils/tmux_launch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35m    Activate the python environment for a service.[0m
[30;1m13 | [0m[35m    """[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m    # check if the current file was installed with pip install -e (editable mode)[0m
[30;1m16 | [0m[35m    # if so, the venv is the service directory and it's called <service_name>_venv[0m
[30;1m17 | [0m[35m    # otherwise, we simply take the currently running venv ;[0m
[30;1m18 | [0m[35m    # in case of no venv, maybe it is running within a Conda environment[0m

[31m--[ [0m[34mMatch #[0m[33m453[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/bec_server_utils/tmux_launch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport os[0m
[30;1m2 | [0m[35mimport signal[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mimport libtmux[0m
[30;1m6 | [0m[35mimport psutil[0m
[30;1m7 | [0m[35mfrom libtmux.exc import LibTmuxException[0m

[31m--[ [0m[34mMatch #[0m[33m454[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m260 | [0m[35m        info_storage.update(info_storage["bec"].get("user_metadata", {}))[0m
[30;1m261 | [0m[35m        info_storage["bec"].pop("user_metadata", None)[0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m        requested_plugin = self.file_writer_manager.file_writer_config.get("plugin")[0m
[30;1m264 | [0m[35m        if requested_plugin == "default_NeXus_format":[0m
[30;1m265 | [0m[35m            writer_format_cls = default_NeXus_format[0m
[30;1m266 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m455[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m257 | [0m[35m            ).isoformat()[0m
[30;1m258 | [0m[35m        if data.end_time is not None:[0m
[30;1m259 | [0m[35m            info_storage["end_time"] = datetime.datetime.fromtimestamp(data.end_time).isoformat()[0m
[30;1m260 | [0m[35m        info_storage.update(info_storage["bec"].get("user_metadata", {}))[0m
[30;1m261 | [0m[35m        info_storage["bec"].pop("user_metadata", None)[0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m        requested_plugin = self.file_writer_manager.file_writer_config.get("plugin")[0m

[31m--[ [0m[34mMatch #[0m[33m456[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m176 | [0m[35m        container[name] = h5py.SoftLink(val._data)[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35m    def add_external_link(self, name, container, val):[0m
[30;1m179 | [0m[35m        container[name] = h5py.ExternalLink(val._data.get("file"), val._data.get("entry"))[0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35m    def add_content(self, container, storage):[0m
[30;1m182 | [0m[35m        for name, val in storage.items():[0m

[31m--[ [0m[34mMatch #[0m[33m457[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/file_writer/file_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m176 | [0m[35m        container[name] = h5py.SoftLink(val._data)[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35m    def add_external_link(self, name, container, val):[0m
[30;1m179 | [0m[35m        container[name] = h5py.ExternalLink(val._data.get("file"), val._data.get("entry"))[0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35m    def add_content(self, container, storage):[0m
[30;1m182 | [0m[35m        for name, val in storage.items():[0m

[31m--[ [0m[34mMatch #[0m[33m458[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scihub/test_atlas_config_handler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m298 | [0m[35m                        update = ["something"][0m
[30;1m299 | [0m[35m                        config_handler._update_device_config(device, {available_key: update})[0m
[30;1m300 | [0m[35m                    else:[0m
[30;1m301 | [0m[35m                        update = ""[0m
[30;1m302 | [0m[35m                        config_handler._update_device_config(device, {available_key: update})[0m
[30;1m303 | [0m[35m                    # mock doesn't copy the data, hence the popped result:[0m
[30;1m304 | [0m[35m                    if available_key == "deviceConfig":[0m

[31m--[ [0m[34mMatch #[0m[33m459[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scihub/test_atlas_config_handler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m295 | [0m[35m                        update = OnFailure.RETRY[0m
[30;1m296 | [0m[35m                        config_handler._update_device_config(device, {available_key: update})[0m
[30;1m297 | [0m[35m                    elif available_key in ["deviceTags"]:[0m
[30;1m298 | [0m[35m                        update = ["something"][0m
[30;1m299 | [0m[35m                        config_handler._update_device_config(device, {available_key: update})[0m
[30;1m300 | [0m[35m                    else:[0m
[30;1m301 | [0m[35m                        update = ""[0m

[31m--[ [0m[34mMatch #[0m[33m460[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scihub/test_atlas_config_handler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m292 | [0m[35m                        update = ReadoutPriority.MONITORED[0m
[30;1m293 | [0m[35m                        config_handler._update_device_config(device, {available_key: update})[0m
[30;1m294 | [0m[35m                    elif available_key in ["readoutPriority"]:[0m
[30;1m295 | [0m[35m                        update = OnFailure.RETRY[0m
[30;1m296 | [0m[35m                        config_handler._update_device_config(device, {available_key: update})[0m
[30;1m297 | [0m[35m                    elif available_key in ["deviceTags"]:[0m
[30;1m298 | [0m[35m                        update = ["something"][0m

[31m--[ [0m[34mMatch #[0m[33m461[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scihub/test_atlas_config_handler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m289 | [0m[35m                        update = True[0m
[30;1m290 | [0m[35m                        config_handler._update_device_config(device, {available_key: update})[0m
[30;1m291 | [0m[35m                    elif available_key in ["readoutPriority"]:[0m
[30;1m292 | [0m[35m                        update = ReadoutPriority.MONITORED[0m
[30;1m293 | [0m[35m                        config_handler._update_device_config(device, {available_key: update})[0m
[30;1m294 | [0m[35m                    elif available_key in ["readoutPriority"]:[0m
[30;1m295 | [0m[35m                        update = OnFailure.RETRY[0m

[31m--[ [0m[34mMatch #[0m[33m462[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scihub/test_atlas_config_handler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m286 | [0m[35m                        update = {"something": "to_update"}[0m
[30;1m287 | [0m[35m                        config_handler._update_device_config(device, {available_key: update})[0m
[30;1m288 | [0m[35m                    elif available_key in ["softwareTrigger", "readOnly"]:[0m
[30;1m289 | [0m[35m                        update = True[0m
[30;1m290 | [0m[35m                        config_handler._update_device_config(device, {available_key: update})[0m
[30;1m291 | [0m[35m                    elif available_key in ["readoutPriority"]:[0m
[30;1m292 | [0m[35m                        update = ReadoutPriority.MONITORED[0m

[31m--[ [0m[34mMatch #[0m[33m463[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scihub/test_atlas_config_handler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m283 | [0m[35m                    device = dev["samx"][0m
[30;1m284 | [0m[35m                    rid = str(uuid.uuid4())[0m
[30;1m285 | [0m[35m                    if available_key in ["deviceConfig", "userParameter"]:[0m
[30;1m286 | [0m[35m                        update = {"something": "to_update"}[0m
[30;1m287 | [0m[35m                        config_handler._update_device_config(device, {available_key: update})[0m
[30;1m288 | [0m[35m                    elif available_key in ["softwareTrigger", "readOnly"]:[0m
[30;1m289 | [0m[35m                        update = True[0m

[31m--[ [0m[34mMatch #[0m[33m464[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/scan_bundler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m354 | [0m[35m        """remove old scan_ids to free memory"""[0m
[30;1m355 | [0m[35m        remove_scan_ids = [][0m
[30;1m356 | [0m[35m        for scan_id, entry in self.sync_storage.items():[0m
[30;1m357 | [0m[35m            if entry.get("status") not in ["closed", "aborted"]:[0m
[30;1m358 | [0m[35m                continue[0m
[30;1m359 | [0m[35m            if scan_id in self.scan_id_history:[0m
[30;1m360 | [0m[35m                continue[0m

[31m--[ [0m[34mMatch #[0m[33m465[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/scan_bundler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m347 | [0m[35m    def _get_last_device_readback(self, devices: list) -> list:[0m
[30;1m348 | [0m[35m        pipe = self.connector.pipeline()[0m
[30;1m349 | [0m[35m        for dev in devices:[0m
[30;1m350 | [0m[35m            self.connector.get(MessageEndpoints.device_readback(dev.name), pipe)[0m
[30;1m351 | [0m[35m        return [msg.content["signals"] for msg in self.connector.execute_pipeline(pipe)][0m
[30;1m352 | [0m[35m[0m
[30;1m353 | [0m[35m    def cleanup_storage(self):[0m

[31m--[ [0m[34mMatch #[0m[33m466[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/scan_bundler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m319 | [0m[35m            self.device_storage[device] = signal[0m
[30;1m320 | [0m[35m            readout_priority = metadata.get("readout_priority")[0m
[30;1m321 | [0m[35m            device_is_monitor_sync = self.sync_storage[scan_id]["info"]["monitor_sync"] == device[0m
[30;1m322 | [0m[35m            dev_obj = self.device_manager.devices.get(device)[0m
[30;1m323 | [0m[35m            if dev_obj in self.monitored_devices[scan_id]["devices"] or device_is_monitor_sync:[0m
[30;1m324 | [0m[35m                if self.sync_storage[scan_id]["info"]["scan_type"] == "step":[0m
[30;1m325 | [0m[35m                    self._step_scan_update(scan_id, device, signal, metadata)[0m

[31m--[ [0m[34mMatch #[0m[33m467[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/scan_bundler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m317 | [0m[35m                if not self.sync_storage[scan_id]["info"].get("scan_type"):[0m
[30;1m318 | [0m[35m                    return[0m
[30;1m319 | [0m[35m            self.device_storage[device] = signal[0m
[30;1m320 | [0m[35m            readout_priority = metadata.get("readout_priority")[0m
[30;1m321 | [0m[35m            device_is_monitor_sync = self.sync_storage[scan_id]["info"]["monitor_sync"] == device[0m
[30;1m322 | [0m[35m            dev_obj = self.device_manager.devices.get(device)[0m
[30;1m323 | [0m[35m            if dev_obj in self.monitored_devices[scan_id]["devices"] or device_is_monitor_sync:[0m

[31m--[ [0m[34mMatch #[0m[33m468[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/scan_bundler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m314 | [0m[35m            if self.sync_storage[scan_id]["status"] in ["aborted", "closed"]:[0m
[30;1m315 | [0m[35m                # check if the sync_storage has been initialized properly.[0m
[30;1m316 | [0m[35m                # In case of post-scan initialization, scan info is not available[0m
[30;1m317 | [0m[35m                if not self.sync_storage[scan_id]["info"].get("scan_type"):[0m
[30;1m318 | [0m[35m                    return[0m
[30;1m319 | [0m[35m            self.device_storage[device] = signal[0m
[30;1m320 | [0m[35m            readout_priority = metadata.get("readout_priority")[0m

[31m--[ [0m[34mMatch #[0m[33m469[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/scan_bundler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m303 | [0m[35m                logger.info("Received device message without scan_id")[0m
[30;1m304 | [0m[35m                return[0m
[30;1m305 | [0m[35m[0m
[30;1m306 | [0m[35m            signal = msg.content.get("signals")[0m
[30;1m307 | [0m[35m[0m
[30;1m308 | [0m[35m            try:[0m
[30;1m309 | [0m[35m                self._wait_for_scan_id(scan_id, timeout_time=timeout_time)[0m

[31m--[ [0m[34mMatch #[0m[33m470[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/scan_bundler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m298 | [0m[35m        for msg in msgs:[0m
[30;1m299 | [0m[35m            metadata = msg.metadata[0m
[30;1m300 | [0m[35m[0m
[30;1m301 | [0m[35m            scan_id = metadata.get("scan_id")[0m
[30;1m302 | [0m[35m            if not scan_id:[0m
[30;1m303 | [0m[35m                logger.info("Received device message without scan_id")[0m
[30;1m304 | [0m[35m                return[0m

[31m--[ [0m[34mMatch #[0m[33m471[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/scan_bundler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m278 | [0m[35m    def _wait_for_scan_id(self, scan_id, timeout_time=10):[0m
[30;1m279 | [0m[35m        elapsed_time = 0[0m
[30;1m280 | [0m[35m        while scan_id not in self.storage_initialized:[0m
[30;1m281 | [0m[35m            msg = self.connector.get(MessageEndpoints.public_scan_info(scan_id))[0m
[30;1m282 | [0m[35m            if msg and msg.content["scan_id"] == scan_id:[0m
[30;1m283 | [0m[35m                self.handle_scan_status_message(msg)[0m
[30;1m284 | [0m[35m            if scan_id in self.sync_storage:[0m

[31m--[ [0m[34mMatch #[0m[33m472[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/scan_bundler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m258 | [0m[35m            baseline_devices_status[device] = True[0m
[30;1m259 | [0m[35m[0m
[30;1m260 | [0m[35m            self.sync_storage[scan_id]["baseline"] = {[0m
[30;1m261 | [0m[35m                **self.sync_storage[scan_id].get("baseline", {}),[0m
[30;1m262 | [0m[35m                **dev,[0m
[30;1m263 | [0m[35m            }[0m
[30;1m264 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m473[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/scan_bundler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m247 | [0m[35m                    **signal,[0m
[30;1m248 | [0m[35m                }[0m
[30;1m249 | [0m[35m[0m
[30;1m250 | [0m[35m                if self.sync_storage[scan_id].get(point_id):[0m
[30;1m251 | [0m[35m                    self._update_monitor_signals(scan_id, point_id)[0m
[30;1m252 | [0m[35m                    self._send_scan_point(scan_id, point_id)[0m
[30;1m253 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m474[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/scan_bundler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m243 | [0m[35m                    self._send_scan_point(scan_id, point_id)[0m
[30;1m244 | [0m[35m            else:[0m
[30;1m245 | [0m[35m                self.sync_storage[scan_id][point_id] = {[0m
[30;1m246 | [0m[35m                    **self.sync_storage[scan_id].get(point_id, {}),[0m
[30;1m247 | [0m[35m                    **signal,[0m
[30;1m248 | [0m[35m                }[0m
[30;1m249 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m475[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/scan_bundler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m238 | [0m[35m                        == len(self.monitored_devices[scan_id]["devices"])[0m
[30;1m239 | [0m[35m                    )[0m
[30;1m240 | [0m[35m                )[0m
[30;1m241 | [0m[35m                if all_monitored_devices_completed and self.sync_storage[scan_id].get(point_id):[0m
[30;1m242 | [0m[35m                    self._update_monitor_signals(scan_id, point_id)[0m
[30;1m243 | [0m[35m                    self._send_scan_point(scan_id, point_id)[0m
[30;1m244 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m476[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/scan_bundler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m223 | [0m[35m                    **dev,[0m
[30;1m224 | [0m[35m                }[0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m                if monitored_devices["point_id"].get(point_id) is None:[0m
[30;1m227 | [0m[35m                    monitored_devices["point_id"][point_id] = {[0m
[30;1m228 | [0m[35m                        dev.name: False for dev in monitored_devices["devices"][0m
[30;1m229 | [0m[35m                    }[0m

[31m--[ [0m[34mMatch #[0m[33m477[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/scan_bundler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m219 | [0m[35m                monitored_devices = self.monitored_devices[scan_id][0m
[30;1m220 | [0m[35m[0m
[30;1m221 | [0m[35m                self.sync_storage[scan_id][point_id] = {[0m
[30;1m222 | [0m[35m                    **self.sync_storage[scan_id].get(point_id, {}),[0m
[30;1m223 | [0m[35m                    **dev,[0m
[30;1m224 | [0m[35m                }[0m
[30;1m225 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m478[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/scan_bundler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m214 | [0m[35m            logger.info([0m
[30;1m215 | [0m[35m                f"Received reading from device {device} for scan_id {scan_id} at point {point_id}."[0m
[30;1m216 | [0m[35m            )[0m
[30;1m217 | [0m[35m            if self.sync_storage[scan_id].get("info", {}).get("monitor_sync", "bec") == "bec":[0m
[30;1m218 | [0m[35m                # For monitor sync with BEC, we use the point_id as the key for the sync_storage.[0m
[30;1m219 | [0m[35m                monitored_devices = self.monitored_devices[scan_id][0m
[30;1m220 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m479[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/scan_bundler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m214 | [0m[35m            logger.info([0m
[30;1m215 | [0m[35m                f"Received reading from device {device} for scan_id {scan_id} at point {point_id}."[0m
[30;1m216 | [0m[35m            )[0m
[30;1m217 | [0m[35m            if self.sync_storage[scan_id].get("info", {}).get("monitor_sync", "bec") == "bec":[0m
[30;1m218 | [0m[35m                # For monitor sync with BEC, we use the point_id as the key for the sync_storage.[0m
[30;1m219 | [0m[35m                monitored_devices = self.monitored_devices[scan_id][0m
[30;1m220 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m480[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/scan_bundler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m198 | [0m[35m                logger.debug([0m
[30;1m199 | [0m[35m                    f"Waiting for devices {missing_devices} to complete for scan_id {scan_id} at poi[0m
[30;1m200 | [0m[35m                )[0m
[30;1m201 | [0m[35m            if all_monitored_devices_completed and self.sync_storage[scan_id].get(point_id):[0m
[30;1m202 | [0m[35m                self._update_monitor_signals(scan_id, point_id)[0m
[30;1m203 | [0m[35m                self._send_scan_point(scan_id, point_id)[0m
[30;1m204 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m481[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/scan_bundler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m176 | [0m[35m                **dev,[0m
[30;1m177 | [0m[35m            }[0m
[30;1m178 | [0m[35m[0m
[30;1m179 | [0m[35m            if monitored_devices["point_id"].get(point_id) is None:[0m
[30;1m180 | [0m[35m                monitored_devices["point_id"][point_id] = {[0m
[30;1m181 | [0m[35m                    dev.name: False for dev in monitored_devices["devices"][0m
[30;1m182 | [0m[35m                }[0m

[31m--[ [0m[34mMatch #[0m[33m482[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/scan_bundler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m172 | [0m[35m            monitored_devices = self.monitored_devices[scan_id][0m
[30;1m173 | [0m[35m[0m
[30;1m174 | [0m[35m            self.sync_storage[scan_id][point_id] = {[0m
[30;1m175 | [0m[35m                **self.sync_storage[scan_id].get(point_id, {}),[0m
[30;1m176 | [0m[35m                **dev,[0m
[30;1m177 | [0m[35m            }[0m
[30;1m178 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m483[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/scan_bundler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m132 | [0m[35m                self.scan_id_history.append(scan_id)[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m    def _initialize_scan_container(self, scan_msg: messages.ScanStatusMessage):[0m
[30;1m135 | [0m[35m        if scan_msg.content.get("status") != "open":[0m
[30;1m136 | [0m[35m            return[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m        scan_id = scan_msg.content["scan_id"][0m

[31m--[ [0m[34mMatch #[0m[33m484[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/scan_bundler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m123 | [0m[35m        if not scan_id:[0m
[30;1m124 | [0m[35m            logger.warning(f"Received scan status update without scan_id: {msg}")[0m
[30;1m125 | [0m[35m            return[0m
[30;1m126 | [0m[35m        if self.sync_storage.get(scan_id):[0m
[30;1m127 | [0m[35m            self.sync_storage[scan_id]["status"] = status[0m
[30;1m128 | [0m[35m        else:[0m
[30;1m129 | [0m[35m            self.sync_storage[scan_id] = {"info": {}, "status": status, "sent": set()}[0m

[31m--[ [0m[34mMatch #[0m[33m485[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/scan_bundler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m119 | [0m[35m        if status not in ["closed", "aborted", "paused", "halted"]:[0m
[30;1m120 | [0m[35m            logger.error(f"Unknown scan status {status}")[0m
[30;1m121 | [0m[35m            return[0m
[30;1m122 | [0m[35m        scan_id = msg.content.get("scan_id")[0m
[30;1m123 | [0m[35m        if not scan_id:[0m
[30;1m124 | [0m[35m            logger.warning(f"Received scan status update without scan_id: {msg}")[0m
[30;1m125 | [0m[35m            return[0m

[31m--[ [0m[34mMatch #[0m[33m486[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/scan_bundler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m115 | [0m[35m            self._scan_status_modification(msg)[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m    def _scan_status_modification(self, msg: messages.ScanStatusMessage):[0m
[30;1m118 | [0m[35m        status = msg.content.get("status")[0m
[30;1m119 | [0m[35m        if status not in ["closed", "aborted", "paused", "halted"]:[0m
[30;1m120 | [0m[35m            logger.error(f"Unknown scan status {status}")[0m
[30;1m121 | [0m[35m            return[0m

[31m--[ [0m[34mMatch #[0m[33m487[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/scan_bundler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m111 | [0m[35m            if scan_id not in self.scan_id_history:[0m
[30;1m112 | [0m[35m                self.scan_id_history.append(scan_id)[0m
[30;1m113 | [0m[35m        self.run_emitter("on_scan_status_update", msg)[0m
[30;1m114 | [0m[35m        if msg.content.get("status") != "open":[0m
[30;1m115 | [0m[35m            self._scan_status_modification(msg)[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m    def _scan_status_modification(self, msg: messages.ScanStatusMessage):[0m

[31m--[ [0m[34mMatch #[0m[33m488[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/scan_bundler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m93 | [0m[35m    def _scan_queue_callback(self, msg, **_kwargs):[0m
[30;1m94 | [0m[35m        msg = msg.value[0m
[30;1m95 | [0m[35m        logger.trace(msg)[0m
[30;1m96 | [0m[35m        self.current_queue = msg.content["queue"]["primary"].get("info")[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m    def _scan_status_callback(self, msg, **_kwargs):[0m
[30;1m99 | [0m[35m        msg = msg.value[0m

[31m--[ [0m[34mMatch #[0m[33m489[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/scan_bundler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m308 | [0m[35m            try:[0m
[30;1m309 | [0m[35m                self._wait_for_scan_id(scan_id, timeout_time=timeout_time)[0m
[30;1m310 | [0m[35m            except TimeoutError:[0m
[30;1m311 | [0m[35m                logger.warning(f"Could not find a matching scan_id {scan_id} in sync_storage.")[0m
[30;1m312 | [0m[35m                return[0m
[30;1m313 | [0m[35m[0m
[30;1m314 | [0m[35m            if self.sync_storage[scan_id]["status"] in ["aborted", "closed"]:[0m

[31m--[ [0m[34mMatch #[0m[33m490[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/scan_bundler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m291 | [0m[35m            elapsed_time += 0.05[0m
[30;1m292 | [0m[35m            if elapsed_time > timeout_time:[0m
[30;1m293 | [0m[35m                raise TimeoutError([0m
[30;1m294 | [0m[35m                    f"Reached timeout whilst waiting for scan_id {scan_id} to appear."[0m
[30;1m295 | [0m[35m                )[0m
[30;1m296 | [0m[35m[0m
[30;1m297 | [0m[35m    def _add_device_to_storage(self, msgs, device, timeout_time=10):[0m

[31m--[ [0m[34mMatch #[0m[33m491[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/scan_bundler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport collections[0m
[30;1m4 | [0m[35mimport threading[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35mimport traceback[0m
[30;1m7 | [0m[35mfrom collections.abc import Callable[0m
[30;1m8 | [0m[35mfrom concurrent.futures import ThreadPoolExecutor[0m
[30;1m9 | [0m[35mfrom typing import TYPE_CHECKING[0m

[31m--[ [0m[34mMatch #[0m[33m492[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/scan_bundler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m212 | [0m[35m            dev = {device: signal}[0m
[30;1m213 | [0m[35m            point_id = metadata["point_id"][0m
[30;1m214 | [0m[35m            logger.info([0m
[30;1m215 | [0m[35m                f"Received reading from device {device} for scan_id {scan_id} at point {point_id}."[0m
[30;1m216 | [0m[35m            )[0m
[30;1m217 | [0m[35m            if self.sync_storage[scan_id].get("info", {}).get("monitor_sync", "bec") == "bec":[0m
[30;1m218 | [0m[35m                # For monitor sync with BEC, we use the point_id as the key for the sync_storage.[0m

[31m--[ [0m[34mMatch #[0m[33m493[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/scan_bundler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m196 | [0m[35m            ][0m
[30;1m197 | [0m[35m            if missing_devices:[0m
[30;1m198 | [0m[35m                logger.debug([0m
[30;1m199 | [0m[35m                    f"Waiting for devices {missing_devices} to complete for scan_id {scan_id} at poi[0m
[30;1m200 | [0m[35m                )[0m
[30;1m201 | [0m[35m            if all_monitored_devices_completed and self.sync_storage[scan_id].get(point_id):[0m
[30;1m202 | [0m[35m                self._update_monitor_signals(scan_id, point_id)[0m

[31m--[ [0m[34mMatch #[0m[33m494[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/scan_bundler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m121 | [0m[35m            return[0m
[30;1m122 | [0m[35m        scan_id = msg.content.get("scan_id")[0m
[30;1m123 | [0m[35m        if not scan_id:[0m
[30;1m124 | [0m[35m            logger.warning(f"Received scan status update without scan_id: {msg}")[0m
[30;1m125 | [0m[35m            return[0m
[30;1m126 | [0m[35m        if self.sync_storage.get(scan_id):[0m
[30;1m127 | [0m[35m            self.sync_storage[scan_id]["status"] = status[0m

[31m--[ [0m[34mMatch #[0m[33m495[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/image_analysis_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m50 | [0m[35m        # ):[0m
[30;1m51 | [0m[35m        """Configure the image analysis service. Either provide a scan item and a device which[0m
[30;1m52 | [0m[35m        has a 2D monitor active, or provide the images directly. If no data is found for the input[0m
[30;1m53 | [0m[35m        the service will return an empty stream output.[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m        Args:[0m
[30;1m56 | [0m[35m            scan_item: Scan Item to consider for the analysis[0m

[31m--[ [0m[34mMatch #[0m[33m496[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/atlas/atlas_forwarder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m100 | [0m[35m    def _get_endpoint_from_subscription(self, subscription: str) -> EndpointInfo:[0m
[30;1m101 | [0m[35m        endpoint_info = json.loads(subscription)[0m
[30;1m102 | [0m[35m        func = getattr(MessageEndpoints, endpoint_info["endpoint"])[0m
[30;1m103 | [0m[35m        if endpoint_info.get("args"):[0m
[30;1m104 | [0m[35m            endpoint = func(*endpoint_info["args"])[0m
[30;1m105 | [0m[35m        else:[0m
[30;1m106 | [0m[35m            endpoint = func()[0m

[31m--[ [0m[34mMatch #[0m[33m497[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/atlas/atlas_forwarder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m    def update_deployment_state(self, msg: messages.RawMessage):[0m
[30;1m78 | [0m[35m        requested_subscriptions = {[0m
[30;1m79 | [0m[35m            sub[1] for user_info in msg.data.values() for sub in user_info.get("subscriptions", [])[0m
[30;1m80 | [0m[35m        }[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m        # Add new subscriptions[0m

[31m--[ [0m[34mMatch #[0m[33m498[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/atlas/atlas_forwarder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m            key = msg.data.get("key")[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m            out = redis_bec.get(key)[0m
[30;1m67 | [0m[35m            topic = msg.data.get("response_endpoint")[0m
[30;1m68 | [0m[35m            if out is None:[0m
[30;1m69 | [0m[35m                out = json.dumps({"out": None})[0m
[30;1m70 | [0m[35m            redis_atlas.send(topic, out)[0m

[31m--[ [0m[34mMatch #[0m[33m499[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/atlas/atlas_forwarder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m63 | [0m[35m        if msg.data.get("action") == "get":[0m
[30;1m64 | [0m[35m            key = msg.data.get("key")[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m            out = redis_bec.get(key)[0m
[30;1m67 | [0m[35m            topic = msg.data.get("response_endpoint")[0m
[30;1m68 | [0m[35m            if out is None:[0m
[30;1m69 | [0m[35m                out = json.dumps({"out": None})[0m

[31m--[ [0m[34mMatch #[0m[33m500[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/atlas/atlas_forwarder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m        redis_atlas: RedisConnector = parent.atlas_connector.redis_atlas[0m
[30;1m62 | [0m[35m        redis_bec: RedisConnector = parent.atlas_connector.connector[0m
[30;1m63 | [0m[35m        if msg.data.get("action") == "get":[0m
[30;1m64 | [0m[35m            key = msg.data.get("key")[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m            out = redis_bec.get(key)[0m
[30;1m67 | [0m[35m            topic = msg.data.get("response_endpoint")[0m

[31m--[ [0m[34mMatch #[0m[33m501[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/atlas/atlas_forwarder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m60 | [0m[35m        msg: messages.RawMessage = msg_obj.value[0m
[30;1m61 | [0m[35m        redis_atlas: RedisConnector = parent.atlas_connector.redis_atlas[0m
[30;1m62 | [0m[35m        redis_bec: RedisConnector = parent.atlas_connector.connector[0m
[30;1m63 | [0m[35m        if msg.data.get("action") == "get":[0m
[30;1m64 | [0m[35m            key = msg.data.get("key")[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m            out = redis_bec.get(key)[0m

[31m--[ [0m[34mMatch #[0m[33m502[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/devices/devicemanager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m665 | [0m[35m        metadata = self.devices[device_name].metadata[0m
[30;1m666 | [0m[35m        if kwargs.get("metadata") is not None:[0m
[30;1m667 | [0m[35m            metadata.update(kwargs.get("metadata"))[0m
[30;1m668 | [0m[35m        scan_id = metadata.get("scan_id")[0m
[30;1m669 | [0m[35m        msg = messages.FileMessage([0m
[30;1m670 | [0m[35m            file_path=file_path,[0m
[30;1m671 | [0m[35m            done=done,[0m

[31m--[ [0m[34mMatch #[0m[33m503[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/devices/devicemanager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m664 | [0m[35m        device_name = obj.root.name[0m
[30;1m665 | [0m[35m        metadata = self.devices[device_name].metadata[0m
[30;1m666 | [0m[35m        if kwargs.get("metadata") is not None:[0m
[30;1m667 | [0m[35m            metadata.update(kwargs.get("metadata"))[0m
[30;1m668 | [0m[35m        scan_id = metadata.get("scan_id")[0m
[30;1m669 | [0m[35m        msg = messages.FileMessage([0m
[30;1m670 | [0m[35m            file_path=file_path,[0m

[31m--[ [0m[34mMatch #[0m[33m504[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/devices/devicemanager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m663 | [0m[35m        """[0m
[30;1m664 | [0m[35m        device_name = obj.root.name[0m
[30;1m665 | [0m[35m        metadata = self.devices[device_name].metadata[0m
[30;1m666 | [0m[35m        if kwargs.get("metadata") is not None:[0m
[30;1m667 | [0m[35m            metadata.update(kwargs.get("metadata"))[0m
[30;1m668 | [0m[35m        scan_id = metadata.get("scan_id")[0m
[30;1m669 | [0m[35m        msg = messages.FileMessage([0m

[31m--[ [0m[34mMatch #[0m[33m505[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/devices/devicemanager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m608 | [0m[35m        if not hasattr(ds_obj, "emitted_points"):[0m
[30;1m609 | [0m[35m            ds_obj.emitted_points = {}[0m
[30;1m610 | [0m[35m[0m
[30;1m611 | [0m[35m        emitted_points = ds_obj.emitted_points.get(metadata["scan_id"], 0)[0m
[30;1m612 | [0m[35m[0m
[30;1m613 | [0m[35m        # make sure all arrays are of equal length[0m
[30;1m614 | [0m[35m        max_points = min(len(d) for d in data.values())[0m

[31m--[ [0m[34mMatch #[0m[33m506[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/devices/devicemanager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m599 | [0m[35m        logger.warning([0m
[30;1m600 | [0m[35m            f"Flyer callback will be deprecated in future, please refactor your device {obj.root.nam[0m
[30;1m601 | [0m[35m        )[0m
[30;1m602 | [0m[35m        data = kwargs["value"].get("data")[0m
[30;1m603 | [0m[35m        ds_obj = self.devices[obj.root.name][0m
[30;1m604 | [0m[35m        metadata = ds_obj.metadata[0m
[30;1m605 | [0m[35m        if "scan_id" not in metadata:[0m

[31m--[ [0m[34mMatch #[0m[33m507[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/devices/devicemanager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m587 | [0m[35m[0m
[30;1m588 | [0m[35m    def _obj_callback_is_moving(self, *_args, **kwargs):[0m
[30;1m589 | [0m[35m        device = kwargs["obj"].root.name[0m
[30;1m590 | [0m[35m        status = int(kwargs.get("value"))[0m
[30;1m591 | [0m[35m        metadata = self.devices[device].metadata[0m
[30;1m592 | [0m[35m        self.connector.set([0m
[30;1m593 | [0m[35m            MessageEndpoints.device_status(device),[0m

[31m--[ [0m[34mMatch #[0m[33m508[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/devices/devicemanager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m491 | [0m[35m            return[0m
[30;1m492 | [0m[35m        name = obj.root.name[0m
[30;1m493 | [0m[35m        signals = obj.root.read_configuration()[0m
[30;1m494 | [0m[35m        metadata = self.devices.get(obj.root.name).metadata[0m
[30;1m495 | [0m[35m        dev_msg = messages.DeviceMessage(signals=signals, metadata=metadata)[0m
[30;1m496 | [0m[35m        pipe = self.connector.pipeline()[0m
[30;1m497 | [0m[35m        self.connector.set_and_publish([0m

[31m--[ [0m[34mMatch #[0m[33m509[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/devices/devicemanager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m477 | [0m[35m            return[0m
[30;1m478 | [0m[35m        name = obj.root.name[0m
[30;1m479 | [0m[35m        signals = obj.root.read()[0m
[30;1m480 | [0m[35m        metadata = self.devices.get(obj.root.name).metadata[0m
[30;1m481 | [0m[35m        dev_msg = messages.DeviceMessage(signals=signals, metadata=metadata)[0m
[30;1m482 | [0m[35m        pipe = self.connector.pipeline()[0m
[30;1m483 | [0m[35m        self.connector.set_and_publish(MessageEndpoints.device_readback(name), dev_msg, pipe)[0m

[31m--[ [0m[34mMatch #[0m[33m510[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/devices/devicemanager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m325 | [0m[35m            DSDevice: initialized device object[0m
[30;1m326 | [0m[35m        """[0m
[30;1m327 | [0m[35m        name = dev.get("name")[0m
[30;1m328 | [0m[35m        enabled = dev.get("enabled")[0m
[30;1m329 | [0m[35m[0m
[30;1m330 | [0m[35m        # refresh the device info[0m
[30;1m331 | [0m[35m        pipe = self.connector.pipeline()[0m

[31m--[ [0m[34mMatch #[0m[33m511[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/devices/devicemanager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m324 | [0m[35m        Returns:[0m
[30;1m325 | [0m[35m            DSDevice: initialized device object[0m
[30;1m326 | [0m[35m        """[0m
[30;1m327 | [0m[35m        name = dev.get("name")[0m
[30;1m328 | [0m[35m        enabled = dev.get("enabled")[0m
[30;1m329 | [0m[35m[0m
[30;1m330 | [0m[35m        # refresh the device info[0m

[31m--[ [0m[34mMatch #[0m[33m512[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/devices/devicemanager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m294 | [0m[35m[0m
[30;1m295 | [0m[35m        init_kwargs = {key: config.pop(key) for key in class_params_and_config_keys}[0m
[30;1m296 | [0m[35m        device_access = config.pop("device_access", None)[0m
[30;1m297 | [0m[35m        if device_access or (device_access is None and config.get("device_mapping")):[0m
[30;1m298 | [0m[35m            init_kwargs["device_manager"] = device_manager[0m
[30;1m299 | [0m[35m[0m
[30;1m300 | [0m[35m        signature = inspect.signature(dev_cls)[0m

[31m--[ [0m[34mMatch #[0m[33m513[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/devices/devicemanager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m272 | [0m[35m        """[0m
[30;1m273 | [0m[35m        name = dev.get("name")[0m
[30;1m274 | [0m[35m        dev_cls = DeviceManagerDS._get_device_class(dev["deviceClass"])[0m
[30;1m275 | [0m[35m        device_config = dev.get("deviceConfig")[0m
[30;1m276 | [0m[35m        device_config = device_config if device_config is not None else {}[0m
[30;1m277 | [0m[35m        config = device_config.copy()[0m
[30;1m278 | [0m[35m        config["name"] = name[0m

[31m--[ [0m[34mMatch #[0m[33m514[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/devices/devicemanager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m270 | [0m[35m        Returns:[0m
[30;1m271 | [0m[35m            (OphydObject, dict): device object and updated config dictionary[0m
[30;1m272 | [0m[35m        """[0m
[30;1m273 | [0m[35m        name = dev.get("name")[0m
[30;1m274 | [0m[35m        dev_cls = DeviceManagerDS._get_device_class(dev["deviceClass"])[0m
[30;1m275 | [0m[35m        device_config = dev.get("deviceConfig")[0m
[30;1m276 | [0m[35m        device_config = device_config if device_config is not None else {}[0m

[31m--[ [0m[34mMatch #[0m[33m515[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/devices/devicemanager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m175 | [0m[35m    def _register_device_proxy(self, name: str) -> None:[0m
[30;1m176 | [0m[35m        obj_lookup = self.devices.get(name).obj.lookup[0m
[30;1m177 | [0m[35m        for key in obj_lookup.keys():[0m
[30;1m178 | [0m[35m            signal_name = obj_lookup[key].get("signal_name")[0m
[30;1m179 | [0m[35m            if key not in self.devices:[0m
[30;1m180 | [0m[35m                raise DeviceConfigError([0m
[30;1m181 | [0m[35m                    f"Failed to init DeviceProxy {name}, no device {key} found in device manager."[0m

[31m--[ [0m[34mMatch #[0m[33m516[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/devices/devicemanager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m173 | [0m[35m            self._register_device_proxy(name)[0m
[30;1m174 | [0m[35m[0m
[30;1m175 | [0m[35m    def _register_device_proxy(self, name: str) -> None:[0m
[30;1m176 | [0m[35m        obj_lookup = self.devices.get(name).obj.lookup[0m
[30;1m177 | [0m[35m        for key in obj_lookup.keys():[0m
[30;1m178 | [0m[35m            signal_name = obj_lookup[key].get("signal_name")[0m
[30;1m179 | [0m[35m            if key not in self.devices:[0m

[31m--[ [0m[34mMatch #[0m[33m517[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/devices/devicemanager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m164 | [0m[35m    def initialize_delayed_devices(self, dev: dict, config: dict, obj: OphydObject) -> None:[0m
[30;1m165 | [0m[35m        """Initialize delayed device after all other devices have been initialized."""[0m
[30;1m166 | [0m[35m        name = dev.get("name")[0m
[30;1m167 | [0m[35m        enabled = dev.get("enabled")[0m
[30;1m168 | [0m[35m        logger.info(f"Adding device {name}: {'ENABLED' if enabled else 'DISABLED'}")[0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35m        obj = self.initialize_device(dev, config, obj)[0m

[31m--[ [0m[34mMatch #[0m[33m518[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/devices/devicemanager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m163 | [0m[35m[0m
[30;1m164 | [0m[35m    def initialize_delayed_devices(self, dev: dict, config: dict, obj: OphydObject) -> None:[0m
[30;1m165 | [0m[35m        """Initialize delayed device after all other devices have been initialized."""[0m
[30;1m166 | [0m[35m        name = dev.get("name")[0m
[30;1m167 | [0m[35m        enabled = dev.get("enabled")[0m
[30;1m168 | [0m[35m        logger.info(f"Adding device {name}: {'ENABLED' if enabled else 'DISABLED'}")[0m
[30;1m169 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m519[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/devices/devicemanager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m141 | [0m[35m                    self.failed_devices[name] = msg[0m
[30;1m142 | [0m[35m[0m
[30;1m143 | [0m[35m            for dev in delayed_init:[0m
[30;1m144 | [0m[35m                name = dev.get("name")[0m
[30;1m145 | [0m[35m                obj, config = self.construct_device_obj(dev, device_manager=self)[0m
[30;1m146 | [0m[35m                try:[0m
[30;1m147 | [0m[35m                    self.initialize_delayed_devices(dev, config, obj)[0m

[31m--[ [0m[34mMatch #[0m[33m520[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/devices/devicemanager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m127 | [0m[35m                name = dev.get("name")[0m
[30;1m128 | [0m[35m                enabled = dev.get("enabled")[0m
[30;1m129 | [0m[35m                logger.info(f"Adding device {name}: {'ENABLED' if enabled else 'DISABLED'}")[0m
[30;1m130 | [0m[35m                dev_cls = self._get_device_class(dev.get("deviceClass"))[0m
[30;1m131 | [0m[35m                if issubclass(dev_cls, (opd.DeviceProxy, opd.ComputedSignal)):[0m
[30;1m132 | [0m[35m                    delayed_init.append(dev)[0m
[30;1m133 | [0m[35m                    continue[0m

[31m--[ [0m[34mMatch #[0m[33m521[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/devices/devicemanager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m125 | [0m[35m            self.failed_devices = {}[0m
[30;1m126 | [0m[35m            for dev in self._session["devices"]:[0m
[30;1m127 | [0m[35m                name = dev.get("name")[0m
[30;1m128 | [0m[35m                enabled = dev.get("enabled")[0m
[30;1m129 | [0m[35m                logger.info(f"Adding device {name}: {'ENABLED' if enabled else 'DISABLED'}")[0m
[30;1m130 | [0m[35m                dev_cls = self._get_device_class(dev.get("deviceClass"))[0m
[30;1m131 | [0m[35m                if issubclass(dev_cls, (opd.DeviceProxy, opd.ComputedSignal)):[0m

[31m--[ [0m[34mMatch #[0m[33m522[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/devices/devicemanager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m        try:[0m
[30;1m125 | [0m[35m            self.failed_devices = {}[0m
[30;1m126 | [0m[35m            for dev in self._session["devices"]:[0m
[30;1m127 | [0m[35m                name = dev.get("name")[0m
[30;1m128 | [0m[35m                enabled = dev.get("enabled")[0m
[30;1m129 | [0m[35m                logger.info(f"Adding device {name}: {'ENABLED' if enabled else 'DISABLED'}")[0m
[30;1m130 | [0m[35m                dev_cls = self._get_device_class(dev.get("deviceClass"))[0m

[31m--[ [0m[34mMatch #[0m[33m523[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/devices/devicemanager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m52 | [0m[35m        if hasattr(self.obj, "low_limit_travel") and hasattr(self.obj, "high_limit_travel"):[0m
[30;1m53 | [0m[35m            limits = {[0m
[30;1m54 | [0m[35m                "low": {"value": self.obj.low_limit_travel.get()},[0m
[30;1m55 | [0m[35m                "high": {"value": self.obj.high_limit_travel.get()},[0m
[30;1m56 | [0m[35m            }[0m
[30;1m57 | [0m[35m        else:[0m
[30;1m58 | [0m[35m            limits = None[0m

[31m--[ [0m[34mMatch #[0m[33m524[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/devices/devicemanager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m        if hasattr(self.obj, "low_limit_travel") and hasattr(self.obj, "high_limit_travel"):[0m
[30;1m53 | [0m[35m            limits = {[0m
[30;1m54 | [0m[35m                "low": {"value": self.obj.low_limit_travel.get()},[0m
[30;1m55 | [0m[35m                "high": {"value": self.obj.high_limit_travel.get()},[0m
[30;1m56 | [0m[35m            }[0m
[30;1m57 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m525[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/devices/devicemanager.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mfrom __future__ import annotations[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mimport inspect[0m
[30;1m10 | [0m[35mimport time[0m
[30;1m11 | [0m[35mimport traceback[0m
[30;1m12 | [0m[35mfrom typing import Callable[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mimport numpy as np[0m

[31m--[ [0m[34mMatch #[0m[33m526[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/bec_server_utils/launch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m32 | [0m[35m    command.add_parser("stop", help="Stop the BEC server")[0m
[30;1m33 | [0m[35m    restart = command.add_parser("restart", help="Restart the BEC server")[0m
[30;1m34 | [0m[35m    restart.add_argument([0m
[30;1m35 | [0m[35m        "--config", type=str, default=None, help="Path to the BEC service config file"[0m
[30;1m36 | [0m[35m    )[0m
[30;1m37 | [0m[35m    restart.add_argument([0m
[30;1m38 | [0m[35m        "--interface",[0m

[31m--[ [0m[34mMatch #[0m[33m527[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/bec_server_utils/launch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14 | [0m[35m    command = parser.add_subparsers(dest="command")[0m
[30;1m15 | [0m[35m    start = command.add_parser("start", help="Start the BEC server")[0m
[30;1m16 | [0m[35m    start.add_argument([0m
[30;1m17 | [0m[35m        "--config", type=str, default=None, help="Path to the BEC service config file"[0m
[30;1m18 | [0m[35m    )[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m    start.add_argument([0m

[31m--[ [0m[34mMatch #[0m[33m528[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/bec_server_utils/launch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mdef main():[0m
[30;1m10 | [0m[35m    """[0m
[30;1m11 | [0m[35m    Launch the BEC server in a tmux session. All services are launched in separate panes.[0m
[30;1m12 | [0m[35m    """[0m
[30;1m13 | [0m[35m    parser = argparse.ArgumentParser(description="Utility tool managing the BEC server")[0m
[30;1m14 | [0m[35m    command = parser.add_subparsers(dest="command")[0m

[31m--[ [0m[34mMatch #[0m[33m529[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scihub/test_repeated_timer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport pytest[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mfrom bec_server.scihub.repeated_timer import RepeatedTimer[0m

[31m--[ [0m[34mMatch #[0m[33m530[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scan_gui_models.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m169 | [0m[35m                    {[0m
[30;1m170 | [0m[35m                        "arg": False,[0m
[30;1m171 | [0m[35m                        "name": "burst_at_each_point",[0m
[30;1m172 | [0m[35m                        "display_name": "Burst At Each Point",[0m
[30;1m173 | [0m[35m                        "type": "int",[0m
[30;1m174 | [0m[35m                        "tooltip": "Number of acquisition per point",[0m
[30;1m175 | [0m[35m                        "default": 1,[0m

[31m--[ [0m[34mMatch #[0m[33m531[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scan_gui_models.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m153 | [0m[35m                        "name": "exp_time",[0m
[30;1m154 | [0m[35m                        "display_name": "Exp Time",[0m
[30;1m155 | [0m[35m                        "type": "float",[0m
[30;1m156 | [0m[35m                        "tooltip": "Exposure time in s",[0m
[30;1m157 | [0m[35m                        "default": 0,[0m
[30;1m158 | [0m[35m                        "expert": False,[0m
[30;1m159 | [0m[35m                    },[0m

[31m--[ [0m[34mMatch #[0m[33m532[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_scan_gui_models.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m        Args:[0m
[30;1m32 | [0m[35m            *args (Device, float, float): pairs of device / start position / end position[0m
[30;1m33 | [0m[35m            exp_time (float): exposure time in s. Default: 0[0m
[30;1m34 | [0m[35m            steps (int): number of steps. Default: 10[0m
[30;1m35 | [0m[35m            relative (bool): if True, the start and end positions are relative to the current positi[0m
[30;1m36 | [0m[35m            burst_at_each_point (int): number of acquisition per point. Default: 1[0m

[31m--[ [0m[34mMatch #[0m[33m533[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_file_writer/test_file_writer_manager.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# pylint: skip-file[0m
[30;1m2 | [0m[35mimport os[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mfrom unittest import mock[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mimport numpy as np[0m
[30;1m7 | [0m[35mimport pytest[0m

[31m--[ [0m[34mMatch #[0m[33m534[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_instruction_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35mdef test_add_instruction(instruction_handler, msg, popped):[0m
[30;1m60 | [0m[35m    instruction_handler.add_instruction(msg)[0m
[30;1m61 | [0m[35m    if popped:[0m
[30;1m62 | [0m[35m        assert instruction_handler._instruction_storage.get(msg.instruction_id) is None[0m
[30;1m63 | [0m[35m    else:[0m
[30;1m64 | [0m[35m        assert instruction_handler._instruction_storage[msg.instruction_id] == msg[0m
[30;1m65 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m535[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_file_writer/test_file_writer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m172 | [0m[35m[0m
[30;1m173 | [0m[35m    file_writer.write("./test.h5", storage, configuration_data={})[0m
[30;1m174 | [0m[35m[0m
[30;1m175 | [0m[35m    # open file and check that time stamps are correct[0m
[30;1m176 | [0m[35m    with h5py.File("./test.h5", "r") as test_file:[0m
[30;1m177 | [0m[35m        assert ([0m
[30;1m178 | [0m[35m            test_file["entry"].attrs["start_time"][0m

[31m--[ [0m[34mMatch #[0m[33m536[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/cli/launch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# Description: Launch the data processing server.[0m
[30;1m2 | [0m[35m# This script is the entry point for the Data Processing Server. It is called either[0m
[30;1m3 | [0m[35m# by the bec-dap entry point or directly from the command line.[0m
[30;1m4 | [0m[35mimport argparse[0m
[30;1m5 | [0m[35mimport threading[0m

[31m--[ [0m[34mMatch #[0m[33m537[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/atlas/atlas_connector.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m101 | [0m[35m        )[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m    def _load_environment(self):[0m
[30;1m104 | [0m[35m        env_base = self.scihub.config.service_config.get("atlas", {}).get("env_file", "")[0m
[30;1m105 | [0m[35m        env_file = os.path.join(env_base, ".env")[0m
[30;1m106 | [0m[35m        if not os.path.exists(env_file):[0m
[30;1m107 | [0m[35m            # check if there is an env file in the parent directory[0m

[31m--[ [0m[34mMatch #[0m[33m538[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/atlas/atlas_connector.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m101 | [0m[35m        )[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m    def _load_environment(self):[0m
[30;1m104 | [0m[35m        env_base = self.scihub.config.service_config.get("atlas", {}).get("env_file", "")[0m
[30;1m105 | [0m[35m        env_file = os.path.join(env_base, ".env")[0m
[30;1m106 | [0m[35m        if not os.path.exists(env_file):[0m
[30;1m107 | [0m[35m            # check if there is an env file in the parent directory[0m

[31m--[ [0m[34mMatch #[0m[33m539[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/atlas/atlas_connector.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m104 | [0m[35m        env_base = self.scihub.config.service_config.get("atlas", {}).get("env_file", "")[0m
[30;1m105 | [0m[35m        env_file = os.path.join(env_base, ".env")[0m
[30;1m106 | [0m[35m        if not os.path.exists(env_file):[0m
[30;1m107 | [0m[35m            # check if there is an env file in the parent directory[0m
[30;1m108 | [0m[35m            current_dir = os.path.dirname(os.path.dirname(os.path.dirname(__file__)))[0m
[30;1m109 | [0m[35m            env_file = os.path.join(current_dir, ".env")[0m
[30;1m110 | [0m[35m            if not os.path.exists(env_file):[0m

[31m--[ [0m[34mMatch #[0m[33m540[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scihub/atlas/atlas_connector.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m    @property[0m
[30;1m50 | [0m[35m    def config(self):[0m
[30;1m51 | [0m[35m        """get the current service config"""[0m
[30;1m52 | [0m[35m        return self.scihub.config[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m    def connect_to_atlas(self):[0m

[31m--[ [0m[34mMatch #[0m[33m541[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/dap_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m        Example:[0m
[30;1m145 | [0m[35m            >>> def on_scan_status_update(self, status: dict, metadata: dict):[0m
[30;1m146 | [0m[35m            >>>     if status.get("status") == "closed":[0m
[30;1m147 | [0m[35m            >>>         self.process()[0m
[30;1m148 | [0m[35m        """[0m
[30;1m149 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m542[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/dap_service.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m114 | [0m[35m        Args:[0m
[30;1m115 | [0m[35m            status (dict): Scan status[0m
[30;1m116 | [0m[35m        """[0m
[30;1m117 | [0m[35m        scan_id = status.get("scan_id")[0m
[30;1m118 | [0m[35m        if scan_id != self.scan_id:[0m
[30;1m119 | [0m[35m            self.current_scan_item = self.client.queue.scan_storage.find_scan_by_ID(scan_id)[0m
[30;1m120 | [0m[35m        self.scan_id = scan_id[0m

[31m--[ [0m[34mMatch #[0m[33m543[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/dap_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m149 | [0m[35m[0m
[30;1m150 | [0m[35m    def configure(self, *args, **kwargs):[0m
[30;1m151 | [0m[35m        """[0m
[30;1m152 | [0m[35m        Configure the service using the provided parameters by the user.[0m
[30;1m153 | [0m[35m        The process request's config dictionary will be passed to this method.[0m
[30;1m154 | [0m[35m        """[0m
[30;1m155 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m544[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/dap_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m134 | [0m[35m    def on_scan_status_update(self, status: dict, metadata: dict):[0m
[30;1m135 | [0m[35m        """[0m
[30;1m136 | [0m[35m        Override this method to process a continuous dap request.[0m
[30;1m137 | [0m[35m        The underlying service manager will call this method when a[0m
[30;1m138 | [0m[35m        scan status update is received.[0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35m        Args:[0m

[31m--[ [0m[34mMatch #[0m[33m545[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/dap_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m    def _process_scan_status_update(self, status: dict, metadata: dict):[0m
[30;1m123 | [0m[35m        """[0m
[30;1m124 | [0m[35m        Process a scan status update. This method is called by the service manager and[0m
[30;1m125 | [0m[35m        should not be overridden or invoked directly.[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m        Args:[0m

[31m--[ [0m[34mMatch #[0m[33m546[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/dap_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m27 | [0m[35m    tuple of (stream_output, metadata) and the return value should be serializable.[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    For services that require continuous data processing, the user should override[0m
[30;1m30 | [0m[35m    the on_scan_status_update method. The underlying service manager will call this[0m
[30;1m31 | [0m[35m    method when a scan status update is received.[0m
[30;1m32 | [0m[35m    """[0m
[30;1m33 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m547[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/dap_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35m    Base class for data processing services. For most services, the user should[0m
[30;1m24 | [0m[35m    override the configure and process methods. The configure method is called[0m
[30;1m25 | [0m[35m    when the service is initialized and the process method is called when the[0m
[30;1m26 | [0m[35m    service is requested to process data. The process method should return a[0m
[30;1m27 | [0m[35m    tuple of (stream_output, metadata) and the return value should be serializable.[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    For services that require continuous data processing, the user should override[0m

[31m--[ [0m[34mMatch #[0m[33m548[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/dap_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m    """[0m
[30;1m23 | [0m[35m    Base class for data processing services. For most services, the user should[0m
[30;1m24 | [0m[35m    override the configure and process methods. The configure method is called[0m
[30;1m25 | [0m[35m    when the service is initialized and the process method is called when the[0m
[30;1m26 | [0m[35m    service is requested to process data. The process method should return a[0m
[30;1m27 | [0m[35m    tuple of (stream_output, metadata) and the return value should be serializable.[0m
[30;1m28 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m549[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/dap_service.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m135 | [0m[35m        """[0m
[30;1m136 | [0m[35m        Override this method to process a continuous dap request.[0m
[30;1m137 | [0m[35m        The underlying service manager will call this method when a[0m
[30;1m138 | [0m[35m        scan status update is received.[0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35m        Args:[0m
[30;1m141 | [0m[35m            status (dict): Scan status[0m

[31m--[ [0m[34mMatch #[0m[33m550[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/dap_service.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m    def _update_scan_id_and_item(self, status: dict):[0m
[30;1m111 | [0m[35m        """[0m
[30;1m112 | [0m[35m        Update the scan ID and the current scan item with the provided scan status.[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m        Args:[0m
[30;1m115 | [0m[35m            status (dict): Scan status[0m

[31m--[ [0m[34mMatch #[0m[33m551[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/data_processing/dap_service.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    For services that require continuous data processing, the user should override[0m
[30;1m30 | [0m[35m    the on_scan_status_update method. The underlying service manager will call this[0m
[30;1m31 | [0m[35m    method when a scan status update is received.[0m
[30;1m32 | [0m[35m    """[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    AUTO_FIT_SUPPORTED = False[0m

[31m--[ [0m[34mMatch #[0m[33m552[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_file_writer/test_async_file_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m358 | [0m[35m    )[0m
[30;1m359 | [0m[35m    async_writer.connector.xadd(endpoint, msg_dict={"data": entry})[0m
[30;1m360 | [0m[35m    async_writer.poll_and_write_data()[0m
[30;1m361 | [0m[35m    msg = async_writer.connector.get(MessageEndpoints.alarm())[0m
[30;1m362 | [0m[35m    assert msg is not None[0m
[30;1m363 | [0m[35m    assert msg.source["device"] == "/entry/collection/devices/monitor_async/monitor_async"[0m
[30;1m364 | [0m[35m    assert ([0m

[31m--[ [0m[34mMatch #[0m[33m553[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_file_writer/test_async_file_writer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m344 | [0m[35m    )[0m
[30;1m345 | [0m[35m    async_writer.connector.xadd(endpoint, msg_dict={"data": entry})[0m
[30;1m346 | [0m[35m    async_writer.poll_and_write_data()[0m
[30;1m347 | [0m[35m    msg = async_writer.connector.get(MessageEndpoints.alarm())[0m
[30;1m348 | [0m[35m    assert msg is not None[0m
[30;1m349 | [0m[35m    assert msg.source["device"] == "/entry/collection/devices/monitor_async/monitor_async"[0m
[30;1m350 | [0m[35m    assert msg.msg == "Unknown async update type: unknown. Data will not be written."[0m

[31m--[ [0m[34mMatch #[0m[33m554[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_file_writer/test_async_file_writer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m363 | [0m[35m    assert msg.source["device"] == "/entry/collection/devices/monitor_async/monitor_async"[0m
[30;1m364 | [0m[35m    assert ([0m
[30;1m365 | [0m[35m        msg.msg[0m
[30;1m366 | [0m[35m        == "Invalid max_shape for async update type 'add_slice': [None, 5, 5]. max_shape cannot exce[0m
[30;1m367 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m555[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_file_writer/test_async_file_writer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m347 | [0m[35m    msg = async_writer.connector.get(MessageEndpoints.alarm())[0m
[30;1m348 | [0m[35m    assert msg is not None[0m
[30;1m349 | [0m[35m    assert msg.source["device"] == "/entry/collection/devices/monitor_async/monitor_async"[0m
[30;1m350 | [0m[35m    assert msg.msg == "Unknown async update type: unknown. Data will not be written."[0m
[30;1m351 | [0m[35m[0m
[30;1m352 | [0m[35m[0m
[30;1m353 | [0m[35mdef test_async_writer_raises_warning_for_3d_shape(async_writer):[0m

[31m--[ [0m[34mMatch #[0m[33m556[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_bundler/cli/launch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# Description: Launch the scan bundler.[0m
[30;1m2 | [0m[35m# This script is the entry point for the Scan Bundler. It is called either[0m
[30;1m3 | [0m[35m# by the bec-scan-bundler entry point or directly from the command line.[0m
[30;1m4 | [0m[35mimport threading[0m
[30;1m5 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m557[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/scan_server/procedures/worker_base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35mclass ProcedureWorker(ABC):[0m
[30;1m26 | [0m[35m    """Base class for a worker which automatically dies when there is nothing in the queue for TIMEO[0m
[30;1m27 | [0m[35m    Implement _setup_execution_environment(), _kill_process(), and _run_task() to create a functiona[0m
[30;1m28 | [0m[35m    """[0m
[30;1m29 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m558[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_data_processing/test_lmfit1d_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m42 | [0m[35m        assert "class" in service[0m
[30;1m43 | [0m[35m        assert "user_friendly_name" in service[0m
[30;1m44 | [0m[35m        assert "class_doc" in service[0m
[30;1m45 | [0m[35m        assert "run_doc" in service[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35mdef test_LmfitService1D_get_data_from_current_scan_without_devices(lmfit_service):[0m
[30;1m49 | [0m[35m    scan_item = mock.MagicMock()[0m

[31m--[ [0m[34mMatch #[0m[33m559[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_data_processing/test_lmfit1d_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m41 | [0m[35m        assert isinstance(service, dict)[0m
[30;1m42 | [0m[35m        assert "class" in service[0m
[30;1m43 | [0m[35m        assert "user_friendly_name" in service[0m
[30;1m44 | [0m[35m        assert "class_doc" in service[0m
[30;1m45 | [0m[35m        assert "run_doc" in service[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35mdef test_LmfitService1D_get_data_from_current_scan_without_devices(lmfit_service):[0m

[31m--[ [0m[34mMatch #[0m[33m560[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_data_processing/test_lmfit1d_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m    for model, service in services.items():[0m
[30;1m41 | [0m[35m        assert isinstance(service, dict)[0m
[30;1m42 | [0m[35m        assert "class" in service[0m
[30;1m43 | [0m[35m        assert "user_friendly_name" in service[0m
[30;1m44 | [0m[35m        assert "class_doc" in service[0m
[30;1m45 | [0m[35m        assert "run_doc" in service[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m561[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_data_processing/test_lmfit1d_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35m    assert len(services) > 0[0m
[30;1m40 | [0m[35m    for model, service in services.items():[0m
[30;1m41 | [0m[35m        assert isinstance(service, dict)[0m
[30;1m42 | [0m[35m        assert "class" in service[0m
[30;1m43 | [0m[35m        assert "user_friendly_name" in service[0m
[30;1m44 | [0m[35m        assert "class_doc" in service[0m
[30;1m45 | [0m[35m        assert "run_doc" in service[0m
[30;1m46 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m562[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_data_processing/test_lmfit1d_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m37 | [0m[35m    services = lmfit_service.get_provided_services()[0m
[30;1m38 | [0m[35m    assert isinstance(services, dict)[0m
[30;1m39 | [0m[35m    assert len(services) > 0[0m
[30;1m40 | [0m[35m    for model, service in services.items():[0m
[30;1m41 | [0m[35m        assert isinstance(service, dict)[0m
[30;1m42 | [0m[35m        assert "class" in service[0m
[30;1m43 | [0m[35m        assert "user_friendly_name" in service[0m

[31m--[ [0m[34mMatch #[0m[33m563[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_data_processing/test_lmfit1d_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35m        service = LmfitService1D(model=model, client=client)[0m
[30;1m24 | [0m[35m        return[0m
[30;1m25 | [0m[35m    with pytest.raises(AttributeError):[0m
[30;1m26 | [0m[35m        service = LmfitService1D(model=model, client=client)[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35mdef test_LmfitService1D_available_models(lmfit_service):[0m

[31m--[ [0m[34mMatch #[0m[33m564[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_data_processing/test_lmfit1d_service.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m17 | [0m[35mdef test_LmfitService1D(model, exists):[0m
[30;1m18 | [0m[35m    client = mock.MagicMock()[0m
[30;1m19 | [0m[35m    if exists:[0m
[30;1m20 | [0m[35m        service = LmfitService1D(model=model, client=client)[0m
[30;1m21 | [0m[35m        return[0m
[30;1m22 | [0m[35m    with pytest.raises(AttributeError):[0m
[30;1m23 | [0m[35m        service = LmfitService1D(model=model, client=client)[0m

[31m--[ [0m[34mMatch #[0m[33m565[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_device_server/test_rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m223 | [0m[35m        res = rpc_cls.process_rpc_instruction(instr)[0m
[30;1m224 | [0m[35m        assert res == {[0m
[30;1m225 | [0m[35m            "type": "namedtuple",[0m
[30;1m226 | [0m[35m            "RID": instr.metadata.get("RID"),[0m
[30;1m227 | [0m[35m            "fields": point_tuple._fields,[0m
[30;1m228 | [0m[35m            "values": point_tuple._asdict(),[0m
[30;1m229 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m566[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_device_server/test_rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m50 | [0m[35m            rpc_var.assert_called_once_with(*instr_params["args"], **instr_params["kwargs"])[0m
[30;1m51 | [0m[35m        elif instr_params.get("args"):[0m
[30;1m52 | [0m[35m            rpc_var.assert_called_once_with(*instr_params["args"])[0m
[30;1m53 | [0m[35m        elif instr_params.get("kwargs"):[0m
[30;1m54 | [0m[35m            rpc_var.assert_called_once_with(**instr_params["kwargs"])[0m
[30;1m55 | [0m[35m        else:[0m
[30;1m56 | [0m[35m            rpc_var.assert_called_once_with()[0m

[31m--[ [0m[34mMatch #[0m[33m567[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_device_server/test_rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m48 | [0m[35m    if instr_params:[0m
[30;1m49 | [0m[35m        if instr_params.get("args") and instr_params.get("kwargs"):[0m
[30;1m50 | [0m[35m            rpc_var.assert_called_once_with(*instr_params["args"], **instr_params["kwargs"])[0m
[30;1m51 | [0m[35m        elif instr_params.get("args"):[0m
[30;1m52 | [0m[35m            rpc_var.assert_called_once_with(*instr_params["args"])[0m
[30;1m53 | [0m[35m        elif instr_params.get("kwargs"):[0m
[30;1m54 | [0m[35m            rpc_var.assert_called_once_with(**instr_params["kwargs"])[0m

[31m--[ [0m[34mMatch #[0m[33m568[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_device_server/test_rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m    rpc_var.return_value = 1[0m
[30;1m47 | [0m[35m    out = rpc_cls._get_result_from_rpc(rpc_var=rpc_var, instr_params=instr_params)[0m
[30;1m48 | [0m[35m    if instr_params:[0m
[30;1m49 | [0m[35m        if instr_params.get("args") and instr_params.get("kwargs"):[0m
[30;1m50 | [0m[35m            rpc_var.assert_called_once_with(*instr_params["args"], **instr_params["kwargs"])[0m
[30;1m51 | [0m[35m        elif instr_params.get("args"):[0m
[30;1m52 | [0m[35m            rpc_var.assert_called_once_with(*instr_params["args"])[0m

[31m--[ [0m[34mMatch #[0m[33m569[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_device_server/test_rpc_mixin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m    rpc_var.return_value = 1[0m
[30;1m47 | [0m[35m    out = rpc_cls._get_result_from_rpc(rpc_var=rpc_var, instr_params=instr_params)[0m
[30;1m48 | [0m[35m    if instr_params:[0m
[30;1m49 | [0m[35m        if instr_params.get("args") and instr_params.get("kwargs"):[0m
[30;1m50 | [0m[35m            rpc_var.assert_called_once_with(*instr_params["args"], **instr_params["kwargs"])[0m
[30;1m51 | [0m[35m        elif instr_params.get("args"):[0m
[30;1m52 | [0m[35m            rpc_var.assert_called_once_with(*instr_params["args"])[0m

[31m--[ [0m[34mMatch #[0m[33m570[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/bec_server/device_server/devices/device_serializer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m142 | [0m[35m                            "kind_int": signal_obj.kind.value,[0m
[30;1m143 | [0m[35m                            "kind_str": signal_obj.kind.name,[0m
[30;1m144 | [0m[35m                            "doc": doc,[0m
[30;1m145 | [0m[35m                            "describe": signal_obj.describe().get(signal_obj.name, {}),[0m
[30;1m146 | [0m[35m                            # pylint: disable=protected-access[0m
[30;1m147 | [0m[35m                            "metadata": signal_obj._metadata,[0m
[30;1m148 | [0m[35m                        }[0m

[31m--[ [0m[34mMatch #[0m[33m571[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_procedures.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m154 | [0m[35m    # spawn method should be added as a future[0m
[30;1m155 | [0m[35m    _wait_until(procedure_manager.active_workers[queue]["future"].running)[0m
[30;1m156 | [0m[35m    # and then create the worker[0m
[30;1m157 | [0m[35m    _wait_until(lambda: procedure_manager.active_workers[queue].get("worker") is not None)[0m
[30;1m158 | [0m[35m    worker = procedure_manager.active_workers[queue]["worker"][0m
[30;1m159 | [0m[35m    assert isinstance(worker, UnlockableWorker)[0m
[30;1m160 | [0m[35m    _wait_until(lambda: worker.status == ProcedureWorkerStatus.RUNNING)[0m

[31m--[ [0m[34mMatch #[0m[33m572[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_procedures.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport threading[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35mfrom functools import partial[0m
[30;1m4 | [0m[35mfrom typing import Any, Callable[0m
[30;1m5 | [0m[35mfrom unittest.mock import MagicMock, patch[0m
[30;1m6 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m573[0m[34m of [0m[33m573[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/bec_server-3.28.1/tests/tests_scan_server/test_procedures.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m167 | [0m[35m    # queue "timed out" and brpop returns None, so work() will return on the next iteration[0m
[30;1m168 | [0m[35m    with procedure_manager.lock:[0m
[30;1m169 | [0m[35m        worker.event.set()  # let the task end and return to ProcedureWorker.work()[0m
[30;1m170 | [0m[35m        # queue deletion at the end of spawn needs the lock so we can catch it in IDLE[0m
[30;1m171 | [0m[35m        _wait_until(lambda: worker.status == ProcedureWorkerStatus.IDLE)[0m
[30;1m172 | [0m[35m    # spawn deletes the worker queue[0m
[30;1m173 | [0m[35m    _wait_until(lambda: len(procedure_manager.active_workers) == 0)[0m

573 matches found.
