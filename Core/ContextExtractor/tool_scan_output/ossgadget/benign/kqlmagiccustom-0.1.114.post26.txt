[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1086 | [0m[35mbVOCDmHbYludEPIyaNHePgkkzQjs7ZSCgElpVKw6UuKgCLQKAKvviqyyirmMDLut2WWESG03k3NZKMTudH37LO7DzVzbumii0ykq[0m
[30;1m1087 | [0m[35m            plotly_orca_is_missing_bytes_png: bytes = base64.b64decode(plotly_orca_is_missing_base64[0m
[30;1m1088 | [0m[35m            return plotly_orca_is_missing_bytes_png[0m
[30;1m1089 | [0m[35m[0m
[30;1m1090 | [0m[35m[0m
[30;1m1091 | [0m[35m    @classmethod[0m
[30;1m1092 | [0m[35m    def _init_matplotlib(cls, **options):[0m
[30;1m1093 | [0m[35m        if not cls._is_matplotlib_intialized:[0m
[30;1m1094 | [0m[35m            plt = Dependencies.get_module('matplotlib.pyplot')[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1044 | [0m[35m                image_bytes = self._plotly_fig_to_image(chart_figure, None, options=options)[0m
[30;1m1045 | [0m[35m                image_base64_bytes= base64.b64encode(image_bytes)[0m
[30;1m1046 | [0m[35m                image_base64_str = image_base64_bytes.decode("utf-8")[0m
[30;1m1047 | [0m[35m                image_html_str = f"""<div><img src='data:image/png;base64,{image_base64_str}'></div>[0m
[30;1m1048 | [0m[35m                return {"body": image_html_str}[0m
[30;1m1049 | [0m[35m                [0m
[30;1m1050 | [0m[35m            elif window_mode:[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1042 | [0m[35m            self._metadata["chart_figure"] = chart_figure[0m
[30;1m1043 | [0m[35m            if options.get("plot_package") == "plotly_orca":[0m
[30;1m1044 | [0m[35m                image_bytes = self._plotly_fig_to_image(chart_figure, None, options=options)[0m
[30;1m1045 | [0m[35m                image_base64_bytes= base64.b64encode(image_bytes)[0m
[30;1m1046 | [0m[35m                image_base64_str = image_base64_bytes.decode("utf-8")[0m
[30;1m1047 | [0m[35m                image_html_str = f"""<div><img src='data:image/png;base64,{image_base64_str}'></div>[0m
[30;1m1048 | [0m[35m                return {"body": image_html_str}[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m11 | [0m[35mimport os.path[0m
[30;1m12 | [0m[35mimport re[0m
[30;1m13 | [0m[35mimport uuid[0m
[30;1m14 | [0m[35mimport base64[0m
[30;1m15 | [0m[35mimport json[0m
[30;1m16 | [0m[35mimport io[0m
[30;1m17 | [0m[35mfrom typing import Any, Union, Dict[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m573 | [0m[35m```$ export HTTP_PROXY="http://10.10.1.10:3128"```<br><br>[0m
[30;1m574 | [0m[35m```$ export HTTPS_PROXY="http://10.10.1.10:1080"```<br><br>[0m
[30;1m575 | [0m[35m<br>[0m
[30;1m576 | [0m[35m- To use HTTP Basic Auth with your proxy, use the http://user:password@host syntax:<br><br>[0m
[30;1m577 | [0m[35m```$ export HTTP_PROXY="http://user:pass@10.10.1.10:3128"```<br><br>[0m
[30;1m578 | [0m[35m```$ export HTTPS_PROXY="http://user:pass@10.10.1.10:1080"```<br><br>[0m
[30;1m579 | [0m[35m<br>[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m556 | [0m[35mlowing parameters:[0m
[30;1m557 | [0m[35m        - cachename = an identifying name for your SSO cache.[0m
[30;1m558 | [0m[35m        - secretkey = a password for encryption, for the Single Sign On. Should be at least 8 charac[0m
[30;1m559 | [0m[35m        - secret_salt_uuid = a valid UUID (version 4).[0m
[30;1m560 | [0m[35m    2. Authenticate normally.[0m
[30;1m561 | [0m[35m    3. Use this environmental parameter again (with your parameters) to use SSO and authenticate aut[0m
[30;1m562 | [0m[35m- Additional settings:[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m554 | [0m[35mand remain autheticated for a certain amount of time. [0m
[30;1m555 | [0m[35m- To activate Single Sign On:[0m
[30;1m556 | [0m[35m    1. Set the environmental parameter {Constants.MAGIC_CLASS_NAME_UPPER}_SSO_ENCRYPTION_KEYS with t[0m
[30;1m557 | [0m[35m        - cachename = an identifying name for your SSO cache.[0m
[30;1m558 | [0m[35m        - secretkey = a password for encryption, for the Single Sign On. Should be at least 8 charac[0m
[30;1m559 | [0m[35m        - secret_salt_uuid = a valid UUID (version 4).[0m
[30;1m560 | [0m[35m    2. Authenticate normally.[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m554 | [0m[35m process once and remain autheticated for a certain amount of time. [0m
[30;1m555 | [0m[35m- To activate Single Sign On:[0m
[30;1m556 | [0m[35m    1. Set the environmental parameter {Constants.MAGIC_CLASS_NAME_UPPER}_SSO_ENCRYPTION_KEYS with t[0m
[30;1m557 | [0m[35m        - cachename = an identifying name for your SSO cache.[0m
[30;1m558 | [0m[35m        - secretkey = a password for encryption, for the Single Sign On. Should be at least 8 charac[0m
[30;1m559 | [0m[35m        - secret_salt_uuid = a valid UUID (version 4).[0m
[30;1m560 | [0m[35m    2. Authenticate normally.[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m469 | [0m[35m## {Constants.MAGIC_CLASS_NAME_UPPER}_DEVICE_CODE_NOTIFICATION_EMAIL[0m
[30;1m470 | [0m[35mSpecifies details to enable email notification. <br>[0m
[30;1m471 | [0m[35mShould be a list of key='value' pairs separated by a semicolon ';'<br>[0m
[30;1m472 | [0m[35mThe required keys are: "{Email.SMTP_PORT}", "{Email.SMTP_ENDPOINT}", "{Email.SEND_FROM}", "{Email.SE[0m
[30;1m473 | [0m[35mThe optional keys are: "{Email.CONTEXT}"<br>[0m
[30;1m474 | [0m[35mDefault: None<br>[0m
[30;1m475 | [0m[35m<br>[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m462 | [0m[35m## {Constants.MAGIC_CLASS_NAME_UPPER}_SSO_ENCRYPTION_KEYS[0m
[30;1m463 | [0m[35mSpecifies details to enable SSO.<br>[0m
[30;1m464 | [0m[35mShould be a list of key='value' pairs separated by a semicolon ';'<br>[0m
[30;1m465 | [0m[35mThe required keys are: "{SsoEnvVarParam.CACHE_NAME}", "{SsoEnvVarParam.SECRET_KEY}", "{SsoEnvVarPara[0m
[30;1m466 | [0m[35mDefault: None<br>[0m
[30;1m467 | [0m[35m<br>[0m
[30;1m468 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m396 | [0m[35m- username/password works only on corporate network.<br>[0m
[30;1m397 | [0m[35m- alias is optional.<br>[0m
[30;1m398 | [0m[35m- if credentials are missing, and a previous connection was established the credentials will be inhe[0m
[30;1m399 | [0m[35m- if secret (password / clientsecret / appkey) is missing, user will be prompted to provide it.<br>[0m
[30;1m400 | [0m[35m- if tenant is missing, and a previous connection was established the tenant will be inherited.<br>[0m
[30;1m401 | [0m[35m- **a not quoted value, is a python expression, that is evaluated and its result is used as the valu[0m
[30;1m402 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m393 | [0m[35m```%kql appinsights://anonymous;appid='<app-id>';alias='<appid-friendly-name>'```<br><br>[0m
[30;1m394 | [0m[35m[0m
[30;1m395 | [0m[35mNotes:<br>[0m
[30;1m396 | [0m[35m- username/password works only on corporate network.<br>[0m
[30;1m397 | [0m[35m- alias is optional.<br>[0m
[30;1m398 | [0m[35m- if credentials are missing, and a previous connection was established the credentials will be inhe[0m
[30;1m399 | [0m[35m- if secret (password / clientsecret / appkey) is missing, user will be prompted to provide it.<br>[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m389 | [0m[35m```%kql appinsights://appid='<app-id>';appkey='<app-key>';alias='<appid-friendly-name>'```<br><br>[0m
[30;1m390 | [0m[35m```%kql appinsights://code;appid='<app-id>';alias='<appid-friendly-name>'```<br><br>[0m
[30;1m391 | [0m[35m```%kql appinsights://tenant='<tenant-id>';clientid='<aad-appid>';clientsecret='<aad-appkey>';appid=[0m
[30;1m392 | [0m[35m```%kql appinsights://username='<username>';password='<password>';appid='<app-id>';alias='<appid-fri[0m
[30;1m393 | [0m[35m```%kql appinsights://anonymous;appid='<app-id>';alias='<appid-friendly-name>'```<br><br>[0m
[30;1m394 | [0m[35m[0m
[30;1m395 | [0m[35mNotes:<br>[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m389 | [0m[35m```%kql appinsights://appid='<app-id>';appkey='<app-key>';alias='<appid-friendly-name>'```<br><br>[0m
[30;1m390 | [0m[35m```%kql appinsights://code;appid='<app-id>';alias='<appid-friendly-name>'```<br><br>[0m
[30;1m391 | [0m[35m```%kql appinsights://tenant='<tenant-id>';clientid='<aad-appid>';clientsecret='<aad-appkey>';appid=[0m
[30;1m392 | [0m[35m```%kql appinsights://username='<username>';password='<password>';appid='<app-id>';alias='<appid-fri[0m
[30;1m393 | [0m[35m```%kql appinsights://anonymous;appid='<app-id>';alias='<appid-friendly-name>'```<br><br>[0m
[30;1m394 | [0m[35m[0m
[30;1m395 | [0m[35mNotes:<br>[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m379 | [0m[35m- username/password works only on corporate network.<br>[0m
[30;1m380 | [0m[35m- alias is optional.<br>[0m
[30;1m381 | [0m[35m- if credentials are missing, and a previous connection was established the credentials will be inhe[0m
[30;1m382 | [0m[35m- if secret (password / clientsecret) is missing, user will be prompted to provide it.<br>[0m
[30;1m383 | [0m[35m- if tenant is missing, and a previous connection was established the tenant will be inherited.<br>[0m
[30;1m384 | [0m[35m- **a not quoted value, is a python expression, that is evaluated and its result is used as the valu[0m
[30;1m385 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m376 | [0m[35m[0m
[30;1m377 | [0m[35mNotes:<br>[0m
[30;1m378 | [0m[35m- authentication with appkey works only for the demo.<br>[0m
[30;1m379 | [0m[35m- username/password works only on corporate network.<br>[0m
[30;1m380 | [0m[35m- alias is optional.<br>[0m
[30;1m381 | [0m[35m- if credentials are missing, and a previous connection was established the credentials will be inhe[0m
[30;1m382 | [0m[35m- if secret (password / clientsecret) is missing, user will be prompted to provide it.<br>[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m371 | [0m[35mFew options to authenticate with Log Analytics:<br>[0m
[30;1m372 | [0m[35m```%kql loganalytics://code;workspace='<workspace-id>';alias='<workspace-friendly-name>'```<br><br>[0m
[30;1m373 | [0m[35m```%kql loganalytics://tenant='<tenant-id>';clientid='<aad-appid>';clientsecret='<aad-appkey>';works[0m
[30;1m374 | [0m[35m```%kql loganalytics://username='<username>';password='<password>';workspace='<workspace-id>';alias=[0m
[30;1m375 | [0m[35m```%kql loganalytics://anonymous;workspace='<workspace-id>';alias='<workspace-friendly-name>'```<br>[0m
[30;1m376 | [0m[35m[0m
[30;1m377 | [0m[35mNotes:<br>[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m371 | [0m[35mFew options to authenticate with Log Analytics:<br>[0m
[30;1m372 | [0m[35m```%kql loganalytics://code;workspace='<workspace-id>';alias='<workspace-friendly-name>'```<br><br>[0m
[30;1m373 | [0m[35m```%kql loganalytics://tenant='<tenant-id>';clientid='<aad-appid>';clientsecret='<aad-appkey>';works[0m
[30;1m374 | [0m[35m```%kql loganalytics://username='<username>';password='<password>';workspace='<workspace-id>';alias=[0m
[30;1m375 | [0m[35m```%kql loganalytics://anonymous;workspace='<workspace-id>';alias='<workspace-friendly-name>'```<br>[0m
[30;1m376 | [0m[35m[0m
[30;1m377 | [0m[35mNotes:<br>[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m360 | [0m[35m- username/password works only on corporate network.<br>[0m
[30;1m361 | [0m[35m- alias is optional.<br>[0m
[30;1m362 | [0m[35m- if credentials are missing, and a previous connection was established the credentials will be inhe[0m
[30;1m363 | [0m[35m- if secret (password / clientsecret / thumbprint) is missing, user will be prompted to provide it.<[0m
[30;1m364 | [0m[35m- if cluster is missing, and a previous connection was established the cluster will be inherited.<br[0m
[30;1m365 | [0m[35m- if tenant is missing, and a previous connection was established the tenant will be inherited.<br>[0m
[30;1m366 | [0m[35m- if only the database change, a new connection can be set as follow: [0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m357 | [0m[35m```%kql azuredataexplorer://anonymous;cluster='<cluster-name>';database='<database-name>';alias='<da[0m
[30;1m358 | [0m[35m[0m
[30;1m359 | [0m[35mNotes:<br>[0m
[30;1m360 | [0m[35m- username/password works only on corporate network.<br>[0m
[30;1m361 | [0m[35m- alias is optional.<br>[0m
[30;1m362 | [0m[35m- if credentials are missing, and a previous connection was established the credentials will be inhe[0m
[30;1m363 | [0m[35m- if secret (password / clientsecret / thumbprint) is missing, user will be prompted to provide it.<[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m354 | [0m[35mme>'```<br><br>[0m
[30;1m355 | [0m[35m```%kql azuredataexplorer://tenant='<tenant-id>';certificate_pem_file='<pem_filename>';certificate_t[0m
[30;1m356 | [0m[35m```%kql azuredataexplorer://username='<username>';password='<password>';cluster='<cluster-name>';dat[0m
[30;1m357 | [0m[35m```%kql azuredataexplorer://anonymous;cluster='<cluster-name>';database='<database-name>';alias='<da[0m
[30;1m358 | [0m[35m[0m
[30;1m359 | [0m[35mNotes:<br>[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m354 | [0m[35mfriendly-name>'```<br><br>[0m
[30;1m355 | [0m[35m```%kql azuredataexplorer://tenant='<tenant-id>';certificate_pem_file='<pem_filename>';certificate_t[0m
[30;1m356 | [0m[35m```%kql azuredataexplorer://username='<username>';password='<password>';cluster='<cluster-name>';dat[0m
[30;1m357 | [0m[35m```%kql azuredataexplorer://anonymous;cluster='<cluster-name>';database='<database-name>';alias='<da[0m
[30;1m358 | [0m[35m[0m
[30;1m359 | [0m[35mNotes:<br>[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m340 | [0m[35m[0m
[30;1m341 | [0m[35m## Authentication methods:[0m
[30;1m342 | [0m[35m[0m
[30;1m343 | [0m[35m* AAD Username/password - Provide your AAD username and password.[0m
[30;1m344 | [0m[35m* AAD application - Provide your AAD tenant ID, AAD app ID and app secret.[0m
[30;1m345 | [0m[35m* AAD code - Provide only your AAD username, and authenticate yourself using a code, generated by AD[0m
[30;1m346 | [0m[35m* certificate - Provide your AAD tenant ID, AAD app ID, certificate and certificate-thumbprint (supp[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m340 | [0m[35m[0m
[30;1m341 | [0m[35m## Authentication methods:[0m
[30;1m342 | [0m[35m[0m
[30;1m343 | [0m[35m* AAD Username/password - Provide your AAD username and password.[0m
[30;1m344 | [0m[35m* AAD application - Provide your AAD tenant ID, AAD app ID and app secret.[0m
[30;1m345 | [0m[35m* AAD code - Provide only your AAD username, and authenticate yourself using a code, generated by AD[0m
[30;1m346 | [0m[35m* certificate - Provide your AAD tenant ID, AAD app ID, certificate and certificate-thumbprint (supp[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/_require.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m_KQLMAGIC_FERNET_SSO_REQUIRES = [[0m
[30;1m105 | [0m[35m    'cryptography>=2.7', # also required by adal/msal[0m
[30;1m106 | [0m[35m    'password-strength>=0.0.3',[0m
[30;1m107 | [0m[35m][0m
[30;1m108 | [0m[35m[0m
[30;1m109 | [0m[35m_KQLMAGIC_MSAL_SSO_REQUIRES = [[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/aria_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m50 | [0m[35m            "optional": [ConnStrKeys.ALIAS, ConnStrKeys.TENANT, ConnStrKeys.AAD_URL][0m
[30;1m51 | [0m[35m        },[0m
[30;1m52 | [0m[35m        {[0m
[30;1m53 | [0m[35m            "must": [ConnStrKeys.DATABASE, ConnStrKeys.USERNAME, ConnStrKeys.PASSWORD],[0m
[30;1m54 | [0m[35m            "extra": [ConnStrKeys.CLIENTID],[0m
[30;1m55 | [0m[35m            "optional": [ConnStrKeys.ALIAS, ConnStrKeys.TENANT, ConnStrKeys.AAD_URL, ConnStrKeys.CLI[0m
[30;1m56 | [0m[35m        },[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/aria_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m31 | [0m[35m  [ConnStrKeys.DATABASE, ConnStrKeys.ALIAS, ConnStrKeys.TENANT, ConnStrKeys.AAD_URL, ConnStrKeys.CLI[0m
[30;1m32 | [0m[35m        [ConnStrKeys.DATABASE, ConnStrKeys.ALIAS, ConnStrKeys.TENANT, ConnStrKeys.AAD_URL,          [0m
[30;1m33 | [0m[35m        [ConnStrKeys.DATABASE, ConnStrKeys.ALIAS,                                                   [0m
[30;1m34 | [0m[35m    ][0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m    _VALID_KEYS_COMBINATIONS_NEW = [[0m
[30;1m37 | [0m[35m        {[0m
[30;1m38 | [0m[35m            "must": [ConnStrKeys.DATABASE, ConnStrKeys.CLIENTID, ConnStrKeys.CLIENTSECRET],[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/aria_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m29 | [0m[35mConnStrKeys.CODE],[0m
[30;1m30 | [0m[35m        [ConnStrKeys.DATABASE, ConnStrKeys.ALIAS, ConnStrKeys.TENANT, ConnStrKeys.AAD_URL,          [0m
[30;1m31 | [0m[35m        [ConnStrKeys.DATABASE, ConnStrKeys.ALIAS, ConnStrKeys.TENANT, ConnStrKeys.AAD_URL, ConnStrKe[0m
[30;1m32 | [0m[35m        [ConnStrKeys.DATABASE, ConnStrKeys.ALIAS, ConnStrKeys.TENANT, ConnStrKeys.AAD_URL,          [0m
[30;1m33 | [0m[35m        [ConnStrKeys.DATABASE, ConnStrKeys.ALIAS,                                                   [0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/constants.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m302 | [0m[35m[0m
[30;1m303 | [0m[35mclass SsoEnvVarParam(object):[0m
[30;1m304 | [0m[35m    CACHE_NAME       =      "cachename"[0m
[30;1m305 | [0m[35m    SECRET_KEY       =      "secretkey"[0m
[30;1m306 | [0m[35m    SECRET_SALT_UUID = "secretsaltuuid"[0m
[30;1m307 | [0m[35m    CRYPTO           =         "crypto"[0m
[30;1m308 | [0m[35m    STORAGE          =        "storage"[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/constants.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m302 | [0m[35m[0m
[30;1m303 | [0m[35mclass SsoEnvVarParam(object):[0m
[30;1m304 | [0m[35m    CACHE_NAME       =      "cachename"[0m
[30;1m305 | [0m[35m    SECRET_KEY       =      "secretkey"[0m
[30;1m306 | [0m[35m    SECRET_SALT_UUID = "secretsaltuuid"[0m
[30;1m307 | [0m[35m    CRYPTO           =         "crypto"[0m
[30;1m308 | [0m[35m    STORAGE          =        "storage"[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/constants.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m284 | [0m[35m# SSO Constants[0m
[30;1m285 | [0m[35mclass CryptoParam(object):[0m
[30;1m286 | [0m[35m    CRYPTO_KEY = "crypto_key"[0m
[30;1m287 | [0m[35m    PASSWORD   =   "password"[0m
[30;1m288 | [0m[35m    SALT       =       "salt"[0m
[30;1m289 | [0m[35m    LENGTH     =     "length"[0m
[30;1m290 | [0m[35m    ITERATIONS = "iterations"[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/constants.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m284 | [0m[35m# SSO Constants[0m
[30;1m285 | [0m[35mclass CryptoParam(object):[0m
[30;1m286 | [0m[35m    CRYPTO_KEY = "crypto_key"[0m
[30;1m287 | [0m[35m    PASSWORD   =   "password"[0m
[30;1m288 | [0m[35m    SALT       =       "salt"[0m
[30;1m289 | [0m[35m    LENGTH     =     "length"[0m
[30;1m290 | [0m[35m    ITERATIONS = "iterations"[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/constants.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m96 | [0m[35m    # because they are ignored[0m
[30;1m97 | [0m[35m    TENANT                 =                "tenant"[0m
[30;1m98 | [0m[35m    USERNAME               =              "username"[0m
[30;1m99 | [0m[35m    PASSWORD               =              "password"[0m
[30;1m100 | [0m[35m    CLIENTID               =              "clientid"[0m
[30;1m101 | [0m[35m    CLIENTSECRET           =          "clientsecret"[0m
[30;1m102 | [0m[35m    CERTIFICATE            =           "certificate"[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/constants.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m96 | [0m[35m    # because they are ignored[0m
[30;1m97 | [0m[35m    TENANT                 =                "tenant"[0m
[30;1m98 | [0m[35m    USERNAME               =              "username"[0m
[30;1m99 | [0m[35m    PASSWORD               =              "password"[0m
[30;1m100 | [0m[35m    CLIENTID               =              "clientid"[0m
[30;1m101 | [0m[35m    CLIENTSECRET           =          "clientsecret"[0m
[30;1m102 | [0m[35m    CERTIFICATE            =           "certificate"[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/constants.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m68 | [0m[35m    SMTP_ENDPOINT      =     "smtpendpoint"[0m
[30;1m69 | [0m[35m    SEND_FROM          =         "sendfrom"[0m
[30;1m70 | [0m[35m    SEND_TO            =           "sendto"[0m
[30;1m71 | [0m[35m    SEND_FROM_PASSWORD = "sendfrompassword"[0m
[30;1m72 | [0m[35m    CONTEXT            =          "context"[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/constants.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m68 | [0m[35m    SMTP_ENDPOINT      =     "smtpendpoint"[0m
[30;1m69 | [0m[35m    SEND_FROM          =         "sendfrom"[0m
[30;1m70 | [0m[35m    SEND_TO            =           "sendto"[0m
[30;1m71 | [0m[35m    SEND_FROM_PASSWORD = "sendfrompassword"[0m
[30;1m72 | [0m[35m    CONTEXT            =          "context"[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/constants.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m    # SSO[0m
[30;1m45 | [0m[35m    SSO_GC_INTERVAL_IN_SECS =                                   1 * HOUR_SECS[0m
[30;1m46 | [0m[35m    SSO_KEYS_ENV_VAR_NAME   = f"{MAGIC_CLASS_NAME_UPPER}_SSO_ENCRYPTION_KEYS"[0m
[30;1m47 | [0m[35m    SSO_ENV_VAR_NAME        =              f"{MAGIC_CLASS_NAME_UPPER}_SSO_ON"[0m
[30;1m48 | [0m[35m    SSO_DB_KEY_PREFIX       =       f"{MAGIC_CLASS_NAME_LOWER}_store/tokens/"[0m
[30;1m49 | [0m[35m    SSO_DEFAULT_CACHE_NAME  =               f"{MAGIC_CLASS_NAME_LOWER}_cache"[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m117 | [0m[35m                _key = key +  ("0" * diff).encode()[0m
[30;1m118 | [0m[35m                # logger().debug(f"_init_crypto {type(_key)}")[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m            _key = base64.urlsafe_b64encode(_key)[0m
[30;1m121 | [0m[35m        else:[0m
[30;1m122 | [0m[35m            _key = self.fernet.generate_key()[0m
[30;1m123 | [0m[35m        return self.fernet(_key) # pylint: disable=not-callable[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m7 | [0m[35mfrom typing import Any, Dict[0m
[30;1m8 | [0m[35mimport os[0m
[30;1m9 | [0m[35mimport uuid[0m
[30;1m10 | [0m[35mimport base64[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mfrom .dependencies import Dependencies[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m171 | [0m[35m        if len(results) > 0:[0m
[30;1m172 | [0m[35m            hints = [][0m
[30;1m173 | [0m[35m            for i, policy in enumerate(results,1):[0m
[30;1m174 | [0m[35m                hints.append(f"{i}. {password_hints.get(type(policy))}")[0m
[30;1m175 | [0m[35m                return os.linesep.join(hints)[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m166 | [0m[35m            nonletters=1,  # need min. 2 non-letter characters (digits, specials, anything) [0m
[30;1m167 | [0m[35m        )[0m
[30;1m168 | [0m[35m[0m
[30;1m169 | [0m[35m        results = policy.test(password)[0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35m        if len(results) > 0:[0m
[30;1m172 | [0m[35m            hints = [][0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m159 | [0m[35m            cls.password_tests.NonLetters: "at least one non-letter character"[0m
[30;1m160 | [0m[35m        }[0m
[30;1m161 | [0m[35m[0m
[30;1m162 | [0m[35m        policy = cls.password_policy.from_names([0m
[30;1m163 | [0m[35m            length=8,  # min length: 8[0m
[30;1m164 | [0m[35m            uppercase=1,  # need min. 1 uppercase letters[0m
[30;1m165 | [0m[35m            numbers=2,  # need min. 2 digits[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m156 | [0m[35m            cls.password_tests.Length: "at least 8 characters.",[0m
[30;1m157 | [0m[35m            cls.password_tests.Uppercase: "at least one uppercase letter.",[0m
[30;1m158 | [0m[35m            cls.password_tests.Numbers: "at least 2 digits.",[0m
[30;1m159 | [0m[35m            cls.password_tests.NonLetters: "at least one non-letter character"[0m
[30;1m160 | [0m[35m        }[0m
[30;1m161 | [0m[35m[0m
[30;1m162 | [0m[35m        policy = cls.password_policy.from_names([0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m155 | [0m[35m        password_hints = {[0m
[30;1m156 | [0m[35m            cls.password_tests.Length: "at least 8 characters.",[0m
[30;1m157 | [0m[35m            cls.password_tests.Uppercase: "at least one uppercase letter.",[0m
[30;1m158 | [0m[35m            cls.password_tests.Numbers: "at least 2 digits.",[0m
[30;1m159 | [0m[35m            cls.password_tests.NonLetters: "at least one non-letter character"[0m
[30;1m160 | [0m[35m        }[0m
[30;1m161 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m154 | [0m[35m    def check_password_strength(cls, password:str)->str:[0m
[30;1m155 | [0m[35m        password_hints = {[0m
[30;1m156 | [0m[35m            cls.password_tests.Length: "at least 8 characters.",[0m
[30;1m157 | [0m[35m            cls.password_tests.Uppercase: "at least one uppercase letter.",[0m
[30;1m158 | [0m[35m            cls.password_tests.Numbers: "at least 2 digits.",[0m
[30;1m159 | [0m[35m            cls.password_tests.NonLetters: "at least one non-letter character"[0m
[30;1m160 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m153 | [0m[35m    @classmethod[0m
[30;1m154 | [0m[35m    def check_password_strength(cls, password:str)->str:[0m
[30;1m155 | [0m[35m        password_hints = {[0m
[30;1m156 | [0m[35m            cls.password_tests.Length: "at least 8 characters.",[0m
[30;1m157 | [0m[35m            cls.password_tests.Uppercase: "at least one uppercase letter.",[0m
[30;1m158 | [0m[35m            cls.password_tests.Numbers: "at least 2 digits.",[0m
[30;1m159 | [0m[35m            cls.password_tests.NonLetters: "at least one non-letter character"[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m    @classmethod[0m
[30;1m154 | [0m[35m    def check_password_strength(cls, password:str)->str:[0m
[30;1m155 | [0m[35m        password_hints = {[0m
[30;1m156 | [0m[35m            cls.password_tests.Length: "at least 8 characters.",[0m
[30;1m157 | [0m[35m            cls.password_tests.Uppercase: "at least one uppercase letter.",[0m
[30;1m158 | [0m[35m            cls.password_tests.Numbers: "at least 2 digits.",[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m151 | [0m[35m[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m    @classmethod[0m
[30;1m154 | [0m[35m    def check_password_strength(cls, password:str)->str:[0m
[30;1m155 | [0m[35m        password_hints = {[0m
[30;1m156 | [0m[35m            cls.password_tests.Length: "at least 8 characters.",[0m
[30;1m157 | [0m[35m            cls.password_tests.Uppercase: "at least one uppercase letter.",[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m151 | [0m[35m[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m    @classmethod[0m
[30;1m154 | [0m[35m    def check_password_strength(cls, password:str)->str:[0m
[30;1m155 | [0m[35m        password_hints = {[0m
[30;1m156 | [0m[35m            cls.password_tests.Length: "at least 8 characters.",[0m
[30;1m157 | [0m[35m            cls.password_tests.Uppercase: "at least one uppercase letter.",[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m        # PBKDF2 instances can only be used once[0m
[30;1m101 | [0m[35m        kdf = self.PBKDF2HMAC(algorithm=algorithm, length=length, salt=salt_bytes, iterations=iterat[0m
[30;1m102 | [0m[35m        kdf.verify(password_as_bytes, key)[0m
[30;1m103 | [0m[35m        return key[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m95 | [0m[35m        backend = options.get(CryptoParam.BACKEND, self.default_backend()) # pylint: disable=not-cal[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m        kdf = self.PBKDF2HMAC(algorithm=algorithm, length=length, salt=salt_bytes, iterations=iterat[0m
[30;1m98 | [0m[35m        key = kdf.derive(password_as_bytes)[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m        # PBKDF2 instances can only be used once[0m
[30;1m101 | [0m[35m        kdf = self.PBKDF2HMAC(algorithm=algorithm, length=length, salt=salt_bytes, iterations=iterat[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m    def _create_encryption_key(self, options:Dict[str,Any])->bytes:[0m
[30;1m86 | [0m[35m        password = options.get(CryptoParam.PASSWORD, str(uuid.uuid4()))[0m
[30;1m87 | [0m[35m        password_as_bytes = password.encode()[0m
[30;1m88 | [0m[35m        salt  = options.get(CryptoParam.SALT, uuid.uuid4())[0m
[30;1m89 | [0m[35m        logger().debug(f"_create_encryption_key {type(salt)}")[0m
[30;1m90 | [0m[35m        salt_bytes = str(salt).encode()[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m    def _create_encryption_key(self, options:Dict[str,Any])->bytes:[0m
[30;1m86 | [0m[35m        password = options.get(CryptoParam.PASSWORD, str(uuid.uuid4()))[0m
[30;1m87 | [0m[35m        password_as_bytes = password.encode()[0m
[30;1m88 | [0m[35m        salt  = options.get(CryptoParam.SALT, uuid.uuid4())[0m
[30;1m89 | [0m[35m        logger().debug(f"_create_encryption_key {type(salt)}")[0m
[30;1m90 | [0m[35m        salt_bytes = str(salt).encode()[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m    def _create_encryption_key(self, options:Dict[str,Any])->bytes:[0m
[30;1m86 | [0m[35m        password = options.get(CryptoParam.PASSWORD, str(uuid.uuid4()))[0m
[30;1m87 | [0m[35m        password_as_bytes = password.encode()[0m
[30;1m88 | [0m[35m        salt  = options.get(CryptoParam.SALT, uuid.uuid4())[0m
[30;1m89 | [0m[35m        logger().debug(f"_create_encryption_key {type(salt)}")[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m    def _create_encryption_key(self, options:Dict[str,Any])->bytes:[0m
[30;1m86 | [0m[35m        password = options.get(CryptoParam.PASSWORD, str(uuid.uuid4()))[0m
[30;1m87 | [0m[35m        password_as_bytes = password.encode()[0m
[30;1m88 | [0m[35m        salt  = options.get(CryptoParam.SALT, uuid.uuid4())[0m
[30;1m89 | [0m[35m        logger().debug(f"_create_encryption_key {type(salt)}")[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m48 | [0m[35m                cls.hashes = hazmat_primitives.hashes[0m
[30;1m49 | [0m[35m                cls.PBKDF2HMAC = hazmat_primitives_kdf_pbkdf2.PBKDF2HMAC[0m
[30;1m50 | [0m[35m                cls.password_policy = password_strength.PasswordPolicy[0m
[30;1m51 | [0m[35m                cls.password_tests = password_strength.tests[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m    @classmethod[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m48 | [0m[35m                cls.hashes = hazmat_primitives.hashes[0m
[30;1m49 | [0m[35m                cls.PBKDF2HMAC = hazmat_primitives_kdf_pbkdf2.PBKDF2HMAC[0m
[30;1m50 | [0m[35m                cls.password_policy = password_strength.PasswordPolicy[0m
[30;1m51 | [0m[35m                cls.password_tests = password_strength.tests[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m    @classmethod[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m47 | [0m[35m                cls.default_backend = hazmat_backends.default_backend[0m
[30;1m48 | [0m[35m                cls.hashes = hazmat_primitives.hashes[0m
[30;1m49 | [0m[35m                cls.PBKDF2HMAC = hazmat_primitives_kdf_pbkdf2.PBKDF2HMAC[0m
[30;1m50 | [0m[35m                cls.password_policy = password_strength.PasswordPolicy[0m
[30;1m51 | [0m[35m                cls.password_tests = password_strength.tests[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m47 | [0m[35m                cls.default_backend = hazmat_backends.default_backend[0m
[30;1m48 | [0m[35m                cls.hashes = hazmat_primitives.hashes[0m
[30;1m49 | [0m[35m                cls.PBKDF2HMAC = hazmat_primitives_kdf_pbkdf2.PBKDF2HMAC[0m
[30;1m50 | [0m[35m                cls.password_policy = password_strength.PasswordPolicy[0m
[30;1m51 | [0m[35m                cls.password_tests = password_strength.tests[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m47 | [0m[35m                cls.default_backend = hazmat_backends.default_backend[0m
[30;1m48 | [0m[35m                cls.hashes = hazmat_primitives.hashes[0m
[30;1m49 | [0m[35m                cls.PBKDF2HMAC = hazmat_primitives_kdf_pbkdf2.PBKDF2HMAC[0m
[30;1m50 | [0m[35m                cls.password_policy = password_strength.PasswordPolicy[0m
[30;1m51 | [0m[35m                cls.password_tests = password_strength.tests[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m40 | [0m[35m                                and hazmat_backends [0m
[30;1m41 | [0m[35m                                and hazmat_primitives [0m
[30;1m42 | [0m[35m                                and hazmat_primitives_kdf_pbkdf2[0m
[30;1m43 | [0m[35m                                and password_strength)[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m            if cls._is_installed:[0m
[30;1m46 | [0m[35m                cls.fernet = fernet_module.Fernet[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m33 | [0m[35m            hazmat_backends = Dependencies.get_module("cryptography.hazmat.backends", dont_throw=Tru[0m
[30;1m34 | [0m[35m            hazmat_primitives = Dependencies.get_module("cryptography.hazmat.primitives", dont_throw[0m
[30;1m35 | [0m[35m            hazmat_primitives_kdf_pbkdf2 = Dependencies.get_module("cryptography.hazmat.primitives.k[0m
[30;1m36 | [0m[35m            password_strength = Dependencies.get_module("password_strength", dont_throw=True)[0m
[30;1m37 | [0m[35m            cls._are_dependencies_set = True[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m            cls._is_installed = (fernet_module [0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m33 | [0m[35m            hazmat_backends = Dependencies.get_module("cryptography.hazmat.backends", dont_throw=Tru[0m
[30;1m34 | [0m[35m            hazmat_primitives = Dependencies.get_module("cryptography.hazmat.primitives", dont_throw[0m
[30;1m35 | [0m[35m            hazmat_primitives_kdf_pbkdf2 = Dependencies.get_module("cryptography.hazmat.primitives.k[0m
[30;1m36 | [0m[35m            password_strength = Dependencies.get_module("password_strength", dont_throw=True)[0m
[30;1m37 | [0m[35m            cls._are_dependencies_set = True[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m            cls._is_installed = (fernet_module [0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m24 | [0m[35m    hashes = None[0m
[30;1m25 | [0m[35m    PBKDF2HMAC = None[0m
[30;1m26 | [0m[35m    password_policy = None[0m
[30;1m27 | [0m[35m    password_tests = None[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    @classmethod[0m
[30;1m30 | [0m[35m    def set_dependencies(cls)->str:[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m23 | [0m[35m    default_backend = None[0m
[30;1m24 | [0m[35m    hashes = None[0m
[30;1m25 | [0m[35m    PBKDF2HMAC = None[0m
[30;1m26 | [0m[35m    password_policy = None[0m
[30;1m27 | [0m[35m    password_tests = None[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    @classmethod[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/la_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m47 | [0m[35m            "optional": [ConnStrKeys.ALIAS, ConnStrKeys.DATA_SOURCE_URL, ConnStrKeys.TENANT, ConnStr[0m
[30;1m48 | [0m[35m        },[0m
[30;1m49 | [0m[35m        {[0m
[30;1m50 | [0m[35m            "must": [ConnStrKeys.WORKSPACE, ConnStrKeys.USERNAME, ConnStrKeys.PASSWORD],[0m
[30;1m51 | [0m[35m            "extra": [ConnStrKeys.CLIENTID],[0m
[30;1m52 | [0m[35m            "optional": [ConnStrKeys.ALIAS, ConnStrKeys.DATA_SOURCE_URL, ConnStrKeys.TENANT, ConnStr[0m
[30;1m53 | [0m[35m        },[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/la_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m32 | [0m[35mA_SOURCE_URL, ConnStrKeys.TENANT, ConnStrKeys.AAD_URL, ConnStrKeys.CLIENTID, ConnStrKeys.USERNAME, C[0m
[30;1m33 | [0m[35m        [ConnStrKeys.WORKSPACE, ConnStrKeys.ALIAS, ConnStrKeys.DATA_SOURCE_URL, ConnStrKeys.TENANT, [0m
[30;1m34 | [0m[35m        [ConnStrKeys.WORKSPACE, ConnStrKeys.ALIAS, ConnStrKeys.DATA_SOURCE_URL,                     [0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/la_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m31 | [0m[35meys.ALIAS, ConnStrKeys.DATA_SOURCE_URL, ConnStrKeys.TENANT, ConnStrKeys.AAD_URL,                    [0m
[30;1m32 | [0m[35m        [ConnStrKeys.WORKSPACE, ConnStrKeys.ALIAS, ConnStrKeys.DATA_SOURCE_URL, ConnStrKeys.TENANT, [0m
[30;1m33 | [0m[35m        [ConnStrKeys.WORKSPACE, ConnStrKeys.ALIAS, ConnStrKeys.DATA_SOURCE_URL, ConnStrKeys.TENANT, [0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1295 | [0m[35m            elif padding_size == 1:[0m
[30;1m1296 | [0m[35m                url_str += '='[0m
[30;1m1297 | [0m[35m            else:[0m
[30;1m1298 | [0m[35m                raise ValueError(f"Invalid base64 url string: {url_str}")[0m
[30;1m1299 | [0m[35m        return urlsafe_b64decode(url_str.encode('utf-8')).decode('utf-8')[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m85 | [0m[35m    REFRESH_TOKEN = 'refresh_token'[0m
[30;1m86 | [0m[35m    ID_TOKEN = 'id_token'[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m    CLIENT_INFO = 'client_info'  # base64: {"uid":"<oid>","utid":"<tid>"}[0m
[30;1m89 | [0m[35m    ID_TOKEN_CLAIMS = 'id_token_claims'[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m    # error response[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m15 | [0m[35mfrom urllib.parse import urlparse[0m
[30;1m16 | [0m[35m# import webbrowser[0m
[30;1m17 | [0m[35mimport json[0m
[30;1m18 | [0m[35mfrom base64 import urlsafe_b64decode[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35mimport dateutil.parser[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1214 | [0m[35m    def _get_authentication_error_kwargs(self):[0m
[30;1m1215 | [0m[35m        " collect info for AuthenticationError exception and raise it"[0m
[30;1m1216 | [0m[35m        kwargs = {}[0m
[30;1m1217 | [0m[35m        if self._current_authentication_method is AuthenticationMethod.aad_username_password:[0m
[30;1m1218 | [0m[35m            kwargs = {"username": self._username, "client_id": self._client_id}[0m
[30;1m1219 | [0m[35m        elif self._current_authentication_method is AuthenticationMethod.aad_application_key:[0m
[30;1m1220 | [0m[35m            kwargs = {"client_id": self._client_id}[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1177 | [0m[35m[0m
[30;1m1178 | [0m[35m[0m
[30;1m1179 | [0m[35m    def _warn_token_diff_from_conn_str(self)->None:[0m
[30;1m1180 | [0m[35m        if self._options.get("auth_token_warnings"):[0m
[30;1m1181 | [0m[35m            token = self._current_token[0m
[30;1m1182 | [0m[35m            if token is not None:[0m
[30;1m1183 | [0m[35m                # to avoid more than one warning per connection, keep track of already displayed war[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1170 | [0m[35m[0m
[30;1m1171 | [0m[35m[0m
[30;1m1172 | [0m[35m    def _warn_on_token_validation_failure(self, message)->None:[0m
[30;1m1173 | [0m[35m        if self._options.get("auth_token_warnings"):[0m
[30;1m1174 | [0m[35m            if self._current_authentication_method is not None and message is not None:[0m
[30;1m1175 | [0m[35m                warn_message =f"Can't use '{self._current_authentication_method}' token entry, {mess[0m
[30;1m1176 | [0m[35m                Display.showWarningMessage(warn_message, display_handler_name='acquire_token', **sel[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m460 | [0m[35mword Flow.[0m
[30;1m461 | [0m[35m                    # https://github.com/AzureAD/microsoft-authentication-library-for-python/wiki/Us[0m
[30;1m462 | [0m[35m                    acquire_token_result = self._current_msal_client_app.acquire_token_by_username_p[0m
[30;1m463 | [0m[35m                        self._username, self._password, scopes=self._scopes)                        [0m
[30;1m464 | [0m[35m[0m
[30;1m465 | [0m[35m                elif self._authentication_method is AuthenticationMethod.aad_application_key:[0m
[30;1m466 | [0m[35m                    acquire_token_result = self._current_msal_client_app.acquire_token_for_client(sc[0m
[30;1m467 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m460 | [0m[35m         # See this page for constraints of Username Password Flow.[0m
[30;1m461 | [0m[35m                    # https://github.com/AzureAD/microsoft-authentication-library-for-python/wiki/Us[0m
[30;1m462 | [0m[35m                    acquire_token_result = self._current_msal_client_app.acquire_token_by_username_p[0m
[30;1m463 | [0m[35m                        self._username, self._password, scopes=self._scopes)                        [0m
[30;1m464 | [0m[35m[0m
[30;1m465 | [0m[35m                elif self._authentication_method is AuthenticationMethod.aad_application_key:[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m458 | [0m[35m[0m
[30;1m459 | [0m[35m                if self._authentication_method is AuthenticationMethod.aad_username_password:[0m
[30;1m460 | [0m[35m                    # See this page for constraints of Username Password Flow.[0m
[30;1m461 | [0m[35m                    # https://github.com/AzureAD/microsoft-authentication-library-for-python/wiki/Us[0m
[30;1m462 | [0m[35m                    acquire_token_result = self._current_msal_client_app.acquire_token_by_username_p[0m
[30;1m463 | [0m[35m                        self._username, self._password, scopes=self._scopes)                        [0m
[30;1m464 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m456 | [0m[35mache. Let's get a new one from AAD.")[0m
[30;1m457 | [0m[35m                self._current_msal_client_app = self._msal_client_app_sso or self._msal_client_app[0m
[30;1m458 | [0m[35m[0m
[30;1m459 | [0m[35m                if self._authentication_method is AuthenticationMethod.aad_username_password:[0m
[30;1m460 | [0m[35m                    # See this page for constraints of Username Password Flow.[0m
[30;1m461 | [0m[35m                    # https://github.com/AzureAD/microsoft-authentication-library-for-python/wiki/Us[0m
[30;1m462 | [0m[35m                    acquire_token_result = self._current_msal_client_app.acquire_token_by_username_p[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m455 | [0m[35mken is None:[0m
[30;1m456 | [0m[35m                logger().debug("No suitable token exists in cache. Let's get a new one from AAD.")[0m
[30;1m457 | [0m[35m                self._current_msal_client_app = self._msal_client_app_sso or self._msal_client_app[0m
[30;1m458 | [0m[35m[0m
[30;1m459 | [0m[35m                if self._authentication_method is AuthenticationMethod.aad_username_password:[0m
[30;1m460 | [0m[35m                    # See this page for constraints of Username Password Flow.[0m
[30;1m461 | [0m[35m                    # https://github.com/AzureAD/microsoft-authentication-library-for-python/wiki/Us[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m371 | [0m[35m        elif self._current_authentication_method == AuthenticationMethod.aad_application_key:[0m
[30;1m372 | [0m[35m            details["client_secret"] = '*****' if self._client_secret else 'NOT-SET'[0m
[30;1m373 | [0m[35m        elif self._current_authentication_method == AuthenticationMethod.aad_username_password:[0m
[30;1m374 | [0m[35m            details["password"] = '*****' if self._password else 'NOT-SET'[0m
[30;1m375 | [0m[35m[0m
[30;1m376 | [0m[35m        return details[0m
[30;1m377 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m371 | [0m[35m        elif self._current_authentication_method == AuthenticationMethod.aad_application_key:[0m
[30;1m372 | [0m[35m            details["client_secret"] = '*****' if self._client_secret else 'NOT-SET'[0m
[30;1m373 | [0m[35m        elif self._current_authentication_method == AuthenticationMethod.aad_username_password:[0m
[30;1m374 | [0m[35m            details["password"] = '*****' if self._password else 'NOT-SET'[0m
[30;1m375 | [0m[35m[0m
[30;1m376 | [0m[35m        return details[0m
[30;1m377 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m370 | [0m[35m            details["certificate"] = '*****' if self._password else 'NOT-SET'[0m
[30;1m371 | [0m[35m        elif self._current_authentication_method == AuthenticationMethod.aad_application_key:[0m
[30;1m372 | [0m[35m            details["client_secret"] = '*****' if self._client_secret else 'NOT-SET'[0m
[30;1m373 | [0m[35m        elif self._current_authentication_method == AuthenticationMethod.aad_username_password:[0m
[30;1m374 | [0m[35m            details["password"] = '*****' if self._password else 'NOT-SET'[0m
[30;1m375 | [0m[35m[0m
[30;1m376 | [0m[35m        return details[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m367 | [0m[35m            details["msi_params"] = self._options.get("try_msi")[0m
[30;1m368 | [0m[35m        elif self._current_authentication_method == AuthenticationMethod.aad_application_certificate[0m
[30;1m369 | [0m[35m            details["thumbprint"] = self._thumbprint[0m
[30;1m370 | [0m[35m            details["certificate"] = '*****' if self._password else 'NOT-SET'[0m
[30;1m371 | [0m[35m        elif self._current_authentication_method == AuthenticationMethod.aad_application_key:[0m
[30;1m372 | [0m[35m            details["client_secret"] = '*****' if self._client_secret else 'NOT-SET'[0m
[30;1m373 | [0m[35m        elif self._current_authentication_method == AuthenticationMethod.aad_username_password:[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m289 | [0m[35m            self._certificate = kcsb.application_certificate[0m
[30;1m290 | [0m[35m            self._thumbprint = kcsb.application_certificate_thumbprint[0m
[30;1m291 | [0m[35m            self._client_credential = {[0m
[30;1m292 | [0m[35m                "private_key": self._certificate,[0m
[30;1m293 | [0m[35m                "thumbprint": self._thumbprint,[0m
[30;1m294 | [0m[35m            }[0m
[30;1m295 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m279 | [0m[35m        if all([kcsb.aad_user_id, kcsb.password]):[0m
[30;1m280 | [0m[35m            self._authentication_method = AuthenticationMethod.aad_username_password[0m
[30;1m281 | [0m[35m            self._username = kcsb.aad_user_id[0m
[30;1m282 | [0m[35m            self._password = kcsb.password[0m
[30;1m283 | [0m[35m        elif all([kcsb.application_client_id, kcsb.application_key]):[0m
[30;1m284 | [0m[35m            self._authentication_method = AuthenticationMethod.aad_application_key[0m
[30;1m285 | [0m[35m            self._client_secret = kcsb.application_key[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m279 | [0m[35m        if all([kcsb.aad_user_id, kcsb.password]):[0m
[30;1m280 | [0m[35m            self._authentication_method = AuthenticationMethod.aad_username_password[0m
[30;1m281 | [0m[35m            self._username = kcsb.aad_user_id[0m
[30;1m282 | [0m[35m            self._password = kcsb.password[0m
[30;1m283 | [0m[35m        elif all([kcsb.application_client_id, kcsb.application_key]):[0m
[30;1m284 | [0m[35m            self._authentication_method = AuthenticationMethod.aad_application_key[0m
[30;1m285 | [0m[35m            self._client_secret = kcsb.application_key[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m277 | [0m[35m        self._http_client = http_client[0m
[30;1m278 | [0m[35m        self._username = None[0m
[30;1m279 | [0m[35m        if all([kcsb.aad_user_id, kcsb.password]):[0m
[30;1m280 | [0m[35m            self._authentication_method = AuthenticationMethod.aad_username_password[0m
[30;1m281 | [0m[35m            self._username = kcsb.aad_user_id[0m
[30;1m282 | [0m[35m            self._password = kcsb.password[0m
[30;1m283 | [0m[35m        elif all([kcsb.application_client_id, kcsb.application_key]):[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m276 | [0m[35m        super(_MyAadHelper, self).__init__(kcsb, default_clientid, msal_client_app, msal_client_app_[0m
[30;1m277 | [0m[35m        self._http_client = http_client[0m
[30;1m278 | [0m[35m        self._username = None[0m
[30;1m279 | [0m[35m        if all([kcsb.aad_user_id, kcsb.password]):[0m
[30;1m280 | [0m[35m            self._authentication_method = AuthenticationMethod.aad_username_password[0m
[30;1m281 | [0m[35m            self._username = kcsb.aad_user_id[0m
[30;1m282 | [0m[35m            self._password = kcsb.password[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m217 | [0m[35m    aux_token                   = "token"[0m
[30;1m218 | [0m[35m[0m
[30;1m219 | [0m[35m    client_app_type = {[0m
[30;1m220 | [0m[35m        aad_username_password:       ClientAppType.public,[0m
[30;1m221 | [0m[35m        aad_application_key:         ClientAppType.confidential,[0m
[30;1m222 | [0m[35m        aad_application_certificate: ClientAppType.confidential,[0m
[30;1m223 | [0m[35m        aad_code_login:              ClientAppType.public,[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m203 | [0m[35mclass AuthenticationMethod(object):[0m
[30;1m204 | [0m[35m    """Represnting all authentication methods available in Azure Monitor with Python."""[0m
[30;1m205 | [0m[35m[0m
[30;1m206 | [0m[35m    aad_username_password       = "aad_username_password"[0m
[30;1m207 | [0m[35m    aad_application_key         = "aad_application_key"[0m
[30;1m208 | [0m[35m    aad_application_certificate = "aad_application_certificate"[0m
[30;1m209 | [0m[35m    aad_code_login              = "aad_code_login"[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m203 | [0m[35mclass AuthenticationMethod(object):[0m
[30;1m204 | [0m[35m    """Represnting all authentication methods available in Azure Monitor with Python."""[0m
[30;1m205 | [0m[35m[0m
[30;1m206 | [0m[35m    aad_username_password       = "aad_username_password"[0m
[30;1m207 | [0m[35m    aad_application_key         = "aad_application_key"[0m
[30;1m208 | [0m[35m    aad_application_certificate = "aad_application_certificate"[0m
[30;1m209 | [0m[35m    aad_code_login              = "aad_code_login"[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m165 | [0m[35m            "authority_id":                       ConnStrKeys.TENANT,[0m
[30;1m166 | [0m[35m            "aad_url":                            ConnStrKeys.AAD_URL,[0m
[30;1m167 | [0m[35m            "aad_user_id":                        ConnStrKeys.USERNAME,[0m
[30;1m168 | [0m[35m            "password":                           ConnStrKeys.PASSWORD,[0m
[30;1m169 | [0m[35m            "application_client_id":              ConnStrKeys.CLIENTID,[0m
[30;1m170 | [0m[35m            "application_key":                    ConnStrKeys.CLIENTSECRET,[0m
[30;1m171 | [0m[35m            "application_certificate":            ConnStrKeys.CERTIFICATE,[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m165 | [0m[35m            "authority_id":                       ConnStrKeys.TENANT,[0m
[30;1m166 | [0m[35m            "aad_url":                            ConnStrKeys.AAD_URL,[0m
[30;1m167 | [0m[35m            "aad_user_id":                        ConnStrKeys.USERNAME,[0m
[30;1m168 | [0m[35m            "password":                           ConnStrKeys.PASSWORD,[0m
[30;1m169 | [0m[35m            "application_client_id":              ConnStrKeys.CLIENTID,[0m
[30;1m170 | [0m[35m            "application_key":                    ConnStrKeys.CLIENTSECRET,[0m
[30;1m171 | [0m[35m            "application_certificate":            ConnStrKeys.CERTIFICATE,[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/dependencies.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m105 | [0m[35mcryptography.hazmat.primitives', 'cryptography', OPTIONAL_TAG, "Single Sign On feature will be disab[0m
[30;1m106 | [0m[35m        ('cryptography.hazmat.primitives.kdf.pbkdf2', 'cryptography', OPTIONAL_TAG, "Single Sign On [0m
[30;1m107 | [0m[35m        ('password_strength', 'password_strength', OPTIONAL_TAG, "Single Sign On feature will be dis[0m
[30;1m108 | [0m[35m    ][0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m    dependencies_dict = {entry[0]:entry for entry in dependencies}[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m    installed_modules:Dict[str,Any] = {}[0m
[30;1m114 | [0m[35m    installed_versions:Dict[str,str] = {}[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m    extras_names:List[str] = [][0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/dependencies.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m104 | [0m[35mgraphy'),[0m
[30;1m105 | [0m[35m        ('cryptography.hazmat.primitives', 'cryptography', OPTIONAL_TAG, "Single Sign On feature wil[0m
[30;1m106 | [0m[35m        ('cryptography.hazmat.primitives.kdf.pbkdf2', 'cryptography', OPTIONAL_TAG, "Single Sign On [0m
[30;1m107 | [0m[35m        ('password_strength', 'password_strength', OPTIONAL_TAG, "Single Sign On feature will be dis[0m
[30;1m108 | [0m[35m    ][0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m    dependencies_dict = {entry[0]:entry for entry in dependencies}[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m    installed_modules:Dict[str,Any] = {}[0m
[30;1m114 | [0m[35m    installed_versions:Dict[str,str] = {}[0m
[30;1m115 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/dependencies.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m14 | [0m[35mfrom ._require import EXTRAS_REQUIRE, INSTALL_REQUIRES, list_union, strip_package_name[0m
[30;1m15 | [0m[35mfrom .constants import Constants[0m
[30;1m16 | [0m[35mfrom .log import logger, isNullLogger[0m
[30;1m17 | [0m[35mfrom .my_utils import get_env_var_list, get_env_var_bool[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35msaved_formatwarning = warnings.formatwarning[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m125 | [0m[35m            The username of the user making the request to Kusto.[0m
[30;1m126 | [0m[35m            if this is given, then password must follow and the client_secret should not be given.[0m
[30;1m127 | [0m[35m        password : str[0m
[30;1m128 | [0m[35m            The password matching the username of the user making the request to Kusto[0m
[30;1m129 | [0m[35m        authority : 'microsoft.com', optional[0m
[30;1m130 | [0m[35m            In case your tenant is not microsoft please use this param.[0m
[30;1m131 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m124 | [0m[35m        username : str[0m
[30;1m125 | [0m[35m            The username of the user making the request to Kusto.[0m
[30;1m126 | [0m[35m            if this is given, then password must follow and the client_secret should not be given.[0m
[30;1m127 | [0m[35m        password : str[0m
[30;1m128 | [0m[35m            The password matching the username of the user making the request to Kusto[0m
[30;1m129 | [0m[35m        authority : 'microsoft.com', optional[0m
[30;1m130 | [0m[35m            In case your tenant is not microsoft please use this param.[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m123 | [0m[35m            if this is given, then username/password should not be.[0m
[30;1m124 | [0m[35m        username : str[0m
[30;1m125 | [0m[35m            The username of the user making the request to Kusto.[0m
[30;1m126 | [0m[35m            if this is given, then password must follow and the client_secret should not be given.[0m
[30;1m127 | [0m[35m        password : str[0m
[30;1m128 | [0m[35m            The password matching the username of the user making the request to Kusto[0m
[30;1m129 | [0m[35m        authority : 'microsoft.com', optional[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m120 | [0m[35m            The AAD application ID of the application making the request to Kusto[0m
[30;1m121 | [0m[35m        client_secret : str[0m
[30;1m122 | [0m[35m            The AAD application key of the application making the request to Kusto.[0m
[30;1m123 | [0m[35m            if this is given, then username/password should not be.[0m
[30;1m124 | [0m[35m        username : str[0m
[30;1m125 | [0m[35m            The username of the user making the request to Kusto.[0m
[30;1m126 | [0m[35m            if this is given, then password must follow and the client_secret should not be given.[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/email_notification.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m56 | [0m[35m        raise ValueError("""[0m
[30;1m57 | [0m[35m            cannot notify device_code login by email because some email parameters are missing. [0m
[30;1m58 | [0m[35m            Set KQLMAGIC_CODE_NOTIFICATION_EMAIL in the following way: SMTPEndPoint: \" email server[0m
[30;1m59 | [0m[35m            sendFrom: \"sender email address \"; sendFromPassword: \"email address password \"; send[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m    def _is_email_format(self, email):[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/email_notification.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m56 | [0m[35m        raise ValueError("""[0m
[30;1m57 | [0m[35m            cannot notify device_code login by email because some email parameters are missing. [0m
[30;1m58 | [0m[35m            Set KQLMAGIC_CODE_NOTIFICATION_EMAIL in the following way: SMTPEndPoint: \" email server[0m
[30;1m59 | [0m[35m            sendFrom: \"sender email address \"; sendFromPassword: \"email address password \"; send[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m    def _is_email_format(self, email):[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/email_notification.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m    def _validate_email_params(self):[0m
[30;1m53 | [0m[35m        if self._port and self._smtp_server and self._sender_email and self._receiver_email and self[0m
[30;1m54 | [0m[35m            if self._is_email_format(self._sender_email) and self._is_email_format(self._receiver_em[0m
[30;1m55 | [0m[35m                return True[0m
[30;1m56 | [0m[35m        raise ValueError("""[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/email_notification.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m        with smtplib.SMTP(self._smtp_server, self._port) as server:[0m
[30;1m41 | [0m[35m            server.starttls() [0m
[30;1m42 | [0m[35m            server.login(self._sender_email, self._password)[0m
[30;1m43 | [0m[35m            result = server.sendmail(self._sender_email, self._receiver_email, [0m
[30;1m44 | [0m[35m                                     f"From: {self._sender_email}\nTo: {self._receiver_email}\nSubje[0m
[30;1m45 | [0m[35m            if result:[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/email_notification.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m18 | [0m[35m        self._smtp_server = params.get(Email.SMTP_ENDPOINT)[0m
[30;1m19 | [0m[35m        self._sender_email = params.get(Email.SEND_FROM)[0m
[30;1m20 | [0m[35m        self._receiver_email = params.get(Email.SEND_TO) [0m
[30;1m21 | [0m[35m        self._password = params.get(Email.SEND_FROM_PASSWORD)[0m
[30;1m22 | [0m[35m        self._context = params.get(Email.CONTEXT)[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m        self._validate_email_params()[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/email_notification.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m18 | [0m[35m        self._smtp_server = params.get(Email.SMTP_ENDPOINT)[0m
[30;1m19 | [0m[35m        self._sender_email = params.get(Email.SEND_FROM)[0m
[30;1m20 | [0m[35m        self._receiver_email = params.get(Email.SEND_TO) [0m
[30;1m21 | [0m[35m        self._password = params.get(Email.SEND_FROM_PASSWORD)[0m
[30;1m22 | [0m[35m        self._context = params.get(Email.CONTEXT)[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m        self._validate_email_params()[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m55 | [0m[35m            "optional": [ConnStrKeys.ALIAS, ConnStrKeys.TENANT, ConnStrKeys.AAD_URL][0m
[30;1m56 | [0m[35m        },[0m
[30;1m57 | [0m[35m        {[0m
[30;1m58 | [0m[35m            "must": [ConnStrKeys.DATABASE, ConnStrKeys.CLUSTER, ConnStrKeys.USERNAME, ConnStrKeys.PA[0m
[30;1m59 | [0m[35m            "extra": [ConnStrKeys.CLIENTID],[0m
[30;1m60 | [0m[35m            "optional": [ConnStrKeys.ALIAS, ConnStrKeys.TENANT, ConnStrKeys.AAD_URL, ConnStrKeys.CLI[0m
[30;1m61 | [0m[35m        },[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m36 | [0m[35m, ConnStrKeys.CLUSTER, ConnStrKeys.TENANT, ConnStrKeys.AAD_URL, ConnStrKeys.CLIENTID, ConnStrKeys.US[0m
[30;1m37 | [0m[35m        [ConnStrKeys.DATABASE, ConnStrKeys.ALIAS, ConnStrKeys.CLUSTER, ConnStrKeys.TENANT, ConnStrKe[0m
[30;1m38 | [0m[35m        [ConnStrKeys.DATABASE, ConnStrKeys.ALIAS, ConnStrKeys.CLUSTER,                              [0m
[30;1m39 | [0m[35m    ][0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m    _VALID_KEYS_COMBINATIONS_NEW = [[0m
[30;1m42 | [0m[35m        {[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m35 | [0m[35mATABASE, ConnStrKeys.ALIAS, ConnStrKeys.CLUSTER, ConnStrKeys.TENANT, ConnStrKeys.AAD_URL,           [0m
[30;1m36 | [0m[35m        [ConnStrKeys.DATABASE, ConnStrKeys.ALIAS, ConnStrKeys.CLUSTER, ConnStrKeys.TENANT, ConnStrKe[0m
[30;1m37 | [0m[35m        [ConnStrKeys.DATABASE, ConnStrKeys.ALIAS, ConnStrKeys.CLUSTER, ConnStrKeys.TENANT, ConnStrKe[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1641 | [0m[35m        #[0m
[30;1m1642 | [0m[35m        # KQLMAGIC environment variables[0m
[30;1m1643 | [0m[35m        #[0m
[30;1m1644 | [0m[35m        # obfuscate secrets/password in envrionment variables [0m
[30;1m1645 | [0m[35m        self.obfuscated_default_env = self.obfuscate_default_env()[0m
[30;1m1646 | [0m[35m[0m
[30;1m1647 | [0m[35m        #[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m  | [0m[35mUJUpZvVWbOG7zeJqLw8J99uI8NyO31uwZK4+6OWGwKlvaYdmdNvEEO0UNPWTMIA4AqWPBw2jKrdWIADvoTG9aiYPqOoPu+eER/ym[0m
[30;1m  | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m  | [0m[35mChAdo4AJuasPs+ilwJzn3NO/7vvMtevnpaRCMAAkBKOUAGDGCEKodT/MaMVor73pDfoD0iMnfpr8wLeeOu7YTErputL33XqjJgSz[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m  | [0m[35mshow kqlmagic latest version info")[0m
[30;1m  | [0m[35m        self._show_magic_latest_version(**options)[0m
[30;1m  | [0m[35m[0m
[30;1m  | [0m[35m        logger().debug("Kqlmagic_core::_show_banner() - show what's new")[0m
[30;1m  | [0m[35m        self._show_what_new(options)[0m
[30;1m  | [0m[35m[0m
[30;1m  | [0m[35m[0m
[30;1m  | [0m[35m    def _show_banner_header(self, **options)->None:[0m
[30;1m  | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1641 | [0m[35m        #[0m
[30;1m1642 | [0m[35m        # KQLMAGIC environment variables[0m
[30;1m1643 | [0m[35m        #[0m
[30;1m1644 | [0m[35m        # obfuscate secrets/password in envrionment variables [0m
[30;1m1645 | [0m[35m        self.obfuscated_default_env = self.obfuscate_default_env()[0m
[30;1m1646 | [0m[35m[0m
[30;1m1647 | [0m[35m        #[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1617 | [0m[35m                if val is not None:[0m
[30;1m1618 | [0m[35m                    # val is a string[0m
[30;1m1619 | [0m[35m                    kv = Parser.parse_and_get_kv_string(val, {}, keep_original_key=True)[0m
[30;1m1620 | [0m[35m                    val = self.obfuscate_string(val, Email.SEND_FROM_PASSWORD, kv)[0m
[30;1m1621 | [0m[35m                    opts[o] = val[0m
[30;1m1622 | [0m[35m[0m
[30;1m1623 | [0m[35m            elif o == "try_token":[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1595 | [0m[35m                # {Constants.MAGIC_CLASS_NAME_UPPER}_DEVICE_CODE_NOTIFICATION_EMAIL[0m
[30;1m1596 | [0m[35m                val = env[var][0m
[30;1m1597 | [0m[35m                kv = Parser.parse_and_get_kv_string(val, {}, keep_original_key=True)[0m
[30;1m1598 | [0m[35m                val = self.obfuscate_string(val, Email.SEND_FROM_PASSWORD, kv)[0m
[30;1m1599 | [0m[35m                env[var] = val[0m
[30;1m1600 | [0m[35m            elif var == f"{Constants.MAGIC_CLASS_NAME_UPPER}_CONFIGURATION":[0m
[30;1m1601 | [0m[35m                # try_token[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1588 | [0m[35m                # SsoEnvVarParam.SECRET_KEY, SsoEnvVarParam.SECRET_SALT_UUID[0m
[30;1m1589 | [0m[35m                val = env[var][0m
[30;1m1590 | [0m[35m                kv = Parser.parse_and_get_kv_string(val, {}, keep_original_key=True)[0m
[30;1m1591 | [0m[35m                val = self.obfuscate_string(val, SsoEnvVarParam.SECRET_KEY, kv)[0m
[30;1m1592 | [0m[35m                val = self.obfuscate_string(val, SsoEnvVarParam.SECRET_SALT_UUID, kv)[0m
[30;1m1593 | [0m[35m                env[var] = val[0m
[30;1m1594 | [0m[35m            elif var == f"{Constants.MAGIC_CLASS_NAME_UPPER}_DEVICE_CODE_NOTIFICATION_EMAIL":[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1585 | [0m[35m                val = self.obfuscate_string(val, ConnStrKeys.APPKEY, kv)[0m
[30;1m1586 | [0m[35m                env[var] = val[0m
[30;1m1587 | [0m[35m            elif var == f"{Constants.MAGIC_CLASS_NAME_UPPER}_SSO_ENCRYPTION_KEYS": [0m
[30;1m1588 | [0m[35m                # SsoEnvVarParam.SECRET_KEY, SsoEnvVarParam.SECRET_SALT_UUID[0m
[30;1m1589 | [0m[35m                val = env[var][0m
[30;1m1590 | [0m[35m                kv = Parser.parse_and_get_kv_string(val, {}, keep_original_key=True)[0m
[30;1m1591 | [0m[35m                val = self.obfuscate_string(val, SsoEnvVarParam.SECRET_KEY, kv)[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1579 | [0m[35m            if var  == f"{Constants.MAGIC_CLASS_NAME_UPPER}_CONNECTION_STR":[0m
[30;1m1580 | [0m[35m                val = env[var][0m
[30;1m1581 | [0m[35m                kv = Parser.parse_and_get_kv_string(val, {}, keep_original_key=True)[0m
[30;1m1582 | [0m[35m                val = self.obfuscate_string(val, ConnStrKeys.PASSWORD, kv)[0m
[30;1m1583 | [0m[35m                val = self.obfuscate_string(val, ConnStrKeys.CLIENTSECRET, kv)[0m
[30;1m1584 | [0m[35m                val = self.obfuscate_string(val, ConnStrKeys.CERTIFICATE, kv)[0m
[30;1m1585 | [0m[35m                val = self.obfuscate_string(val, ConnStrKeys.APPKEY, kv)[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m814 | [0m[35m            # Note: set current (default) username, passsword and cluster to kusto.[0m
[30;1m815 | [0m[35m[0m
[30;1m816 | [0m[35m            %kql kusto://username('myName').password('myPassword')[0m
[30;1m817 | [0m[35m            # Note: set current (default) username and password to kusto.[0m
[30;1m818 | [0m[35m[0m
[30;1m819 | [0m[35m            %kql kusto://cluster('myCluster')[0m
[30;1m820 | [0m[35m            # Note set current (default) cluster to kusto.[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m813 | [0m[35m            %kql kusto://username('myName').password('myPassword').cluster('myCluster')[0m
[30;1m814 | [0m[35m            # Note: set current (default) username, passsword and cluster to kusto.[0m
[30;1m815 | [0m[35m[0m
[30;1m816 | [0m[35m            %kql kusto://username('myName').password('myPassword')[0m
[30;1m817 | [0m[35m            # Note: set current (default) username and password to kusto.[0m
[30;1m818 | [0m[35m[0m
[30;1m819 | [0m[35m            %kql kusto://cluster('myCluster')[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m813 | [0m[35m            %kql kusto://username('myName').password('myPassword').cluster('myCluster')[0m
[30;1m814 | [0m[35m            # Note: set current (default) username, passsword and cluster to kusto.[0m
[30;1m815 | [0m[35m[0m
[30;1m816 | [0m[35m            %kql kusto://username('myName').password('myPassword')[0m
[30;1m817 | [0m[35m            # Note: set current (default) username and password to kusto.[0m
[30;1m818 | [0m[35m[0m
[30;1m819 | [0m[35m            %kql kusto://cluster('myCluster')[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m810 | [0m[35m            <KQL statement>[0m
[30;1m811 | [0m[35m            # Note: establish connection to kusto using current username, password and cluster to fo[0m
[30;1m812 | [0m[35m[0m
[30;1m813 | [0m[35m            %kql kusto://username('myName').password('myPassword').cluster('myCluster')[0m
[30;1m814 | [0m[35m            # Note: set current (default) username, passsword and cluster to kusto.[0m
[30;1m815 | [0m[35m[0m
[30;1m816 | [0m[35m            %kql kusto://username('myName').password('myPassword')[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m810 | [0m[35m            <KQL statement>[0m
[30;1m811 | [0m[35m            # Note: establish connection to kusto using current username, password and cluster to fo[0m
[30;1m812 | [0m[35m[0m
[30;1m813 | [0m[35m            %kql kusto://username('myName').password('myPassword').cluster('myCluster')[0m
[30;1m814 | [0m[35m            # Note: set current (default) username, passsword and cluster to kusto.[0m
[30;1m815 | [0m[35m[0m
[30;1m816 | [0m[35m            %kql kusto://username('myName').password('myPassword')[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m808 | [0m[35m[0m
[30;1m809 | [0m[35m            %%kql kusto://database('myDatabase')[0m
[30;1m810 | [0m[35m            <KQL statement>[0m
[30;1m811 | [0m[35m            # Note: establish connection to kusto using current username, password and cluster to fo[0m
[30;1m812 | [0m[35m[0m
[30;1m813 | [0m[35m            %kql kusto://username('myName').password('myPassword').cluster('myCluster')[0m
[30;1m814 | [0m[35m            # Note: set current (default) username, passsword and cluster to kusto.[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m804 | [0m[35m[0m
[30;1m805 | [0m[35m            %%kql kusto://cluster('myCluster').database('myDatabase')[0m
[30;1m806 | [0m[35m            <KQL statement>[0m
[30;1m807 | [0m[35m            # Note: establish connection to kusto using current username and password to form the fu[0m
[30;1m808 | [0m[35m[0m
[30;1m809 | [0m[35m            %%kql kusto://database('myDatabase')[0m
[30;1m810 | [0m[35m            <KQL statement>[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m771 | [0m[35m[0m
[30;1m772 | [0m[35m        Examples::[0m
[30;1m773 | [0m[35m[0m
[30;1m774 | [0m[35m            %%kql kusto://username('myName').password('myPassword').cluster('myCluster').database('m[0m
[30;1m775 | [0m[35m            <KQL statement>[0m
[30;1m776 | [0m[35m            # Note: establish connection to Azure Data Explorer (kusto) and submit query.[0m
[30;1m777 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m771 | [0m[35m[0m
[30;1m772 | [0m[35m        Examples::[0m
[30;1m773 | [0m[35m[0m
[30;1m774 | [0m[35m            %%kql kusto://username('myName').password('myPassword').cluster('myCluster').database('m[0m
[30;1m775 | [0m[35m            <KQL statement>[0m
[30;1m776 | [0m[35m            # Note: establish connection to Azure Data Explorer (kusto) and submit query.[0m
[30;1m777 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m764 | [0m[35m            # Note: connection string is built from the dsn file settings, section <sectionName>. [0m
[30;1m765 | [0m[35m            #       The dsn filename value is taken from configuartion value Kqlmagic.dsn_filename.[0m
[30;1m766 | [0m[35m[0m
[30;1m767 | [0m[35m            # Note: if password or appkey component is missing, user will be prompted.[0m
[30;1m768 | [0m[35m            # Note: connection string doesn't have to include all components, see examples below.[0m
[30;1m769 | [0m[35m            # Note: substring of the form $name or ${name} in windows also %name%, are replaced by e[0m
[30;1m770 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m751 | [0m[35m[0m
[30;1m752 | [0m[35m        Connection string Syntax::[0m
[30;1m753 | [0m[35m[0m
[30;1m754 | [0m[35m            kusto://username('<username>).password(<password>).cluster(<cluster>).database(<database[0m
[30;1m755 | [0m[35m[0m
[30;1m756 | [0m[35m            appinsights://appid(<appid>).appkey(<appkey>)[0m
[30;1m757 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m751 | [0m[35m[0m
[30;1m752 | [0m[35m        Connection string Syntax::[0m
[30;1m753 | [0m[35m[0m
[30;1m754 | [0m[35m            kusto://username('<username>).password(<password>).cluster(<cluster>).database(<database[0m
[30;1m755 | [0m[35m[0m
[30;1m756 | [0m[35m            appinsights://appid(<appid>).appkey(<appkey>)[0m
[30;1m757 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m197 | [0m[35m    # Driver          = Easysoft ODBC-SQL Server[0m
[30;1m198 | [0m[35m    # Server          = my_machine\SQLEXPRESS[0m
[30;1m199 | [0m[35m    # User            = my_domain\my_user[0m
[30;1m200 | [0m[35m    # Password        = my_password[0m
[30;1m201 | [0m[35m    # If the database you want to connect to is the default[0m
[30;1m202 | [0m[35m    # for the SQL Server login, omit this attribute[0m
[30;1m203 | [0m[35m    # Database        = Northwind[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m197 | [0m[35m    # Driver          = Easysoft ODBC-SQL Server[0m
[30;1m198 | [0m[35m    # Server          = my_machine\SQLEXPRESS[0m
[30;1m199 | [0m[35m    # User            = my_domain\my_user[0m
[30;1m200 | [0m[35m    # Password        = my_password[0m
[30;1m201 | [0m[35m    # If the database you want to connect to is the default[0m
[30;1m202 | [0m[35m    # for the SQL Server login, omit this attribute[0m
[30;1m203 | [0m[35m    # Database        = Northwind[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1574 | [0m[35m            [0m
[30;1m1575 | [0m[35m[0m
[30;1m1576 | [0m[35m    def obfuscate_default_env(self)->dict:[0m
[30;1m1577 | [0m[35m        env = {var: os.getenv(var) for var in os.environ if var.startswith(Constants.MAGIC_CLASS_NAM[0m
[30;1m1578 | [0m[35m        for var in env:[0m
[30;1m1579 | [0m[35m            if var  == f"{Constants.MAGIC_CLASS_NAME_UPPER}_CONNECTION_STR":[0m
[30;1m1580 | [0m[35m                val = env[var][0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m363 | [0m[35m            if app == "auto":[0m
[30;1m364 | [0m[35m                if (is_env_var("VSCODE_LOG_STACK") [0m
[30;1m365 | [0m[35m                        or is_env_var("VSCODE_NLS_CONFIG")[0m
[30;1m366 | [0m[35m                        or is_env_var("VSCODE_HANDLES_UNCAUGHT_ERRORS")[0m
[30;1m367 | [0m[35m                        or is_env_var("VSCODE_IPC_HOOK_CLI")):[0m
[30;1m368 | [0m[35m                    app = "visualstudiocode"[0m
[30;1m369 | [0m[35m            if app == "auto":[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m331 | [0m[35m            elif is_env_var("AZUREML_NB_PATH"):[0m
[30;1m332 | [0m[35m                app = "azuremljupyternotebook"[0m
[30;1m333 | [0m[35m                _kernel_location = "remote"[0m
[30;1m334 | [0m[35m            elif get_env_var("HOME") == "/home/azureuser" and get_env_var("LOGNAME") ==  "azureuser"[0m
[30;1m335 | [0m[35m                app = "azuremljupyterlab"[0m
[30;1m336 | [0m[35m                _kernel_location = "remote"[0m
[30;1m337 | [0m[35m            elif is_env_var("AZURE_NOTEBOOKS_HOST") or is_env_var("AZURE_NOTEBOOKS_SERVER_URL") or i[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m331 | [0m[35m            elif is_env_var("AZUREML_NB_PATH"):[0m
[30;1m332 | [0m[35m                app = "azuremljupyternotebook"[0m
[30;1m333 | [0m[35m                _kernel_location = "remote"[0m
[30;1m334 | [0m[35m            elif get_env_var("HOME") == "/home/azureuser" and get_env_var("LOGNAME") ==  "azureuser"[0m
[30;1m335 | [0m[35m                app = "azuremljupyterlab"[0m
[30;1m336 | [0m[35m                _kernel_location = "remote"[0m
[30;1m337 | [0m[35m            elif is_env_var("AZURE_NOTEBOOKS_HOST") or is_env_var("AZURE_NOTEBOOKS_SERVER_URL") or i[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m30 | [0m[35mfrom .help import execute_usage_command, execute_help_command, execute_faq_command, UrlReference, Ma[0m
[30;1m31 | [0m[35mfrom .constants import Constants, ConnStrKeys, SsoEnvVarParam, Email[0m
[30;1m32 | [0m[35mfrom .dependencies import Dependencies[0m
[30;1m33 | [0m[35mfrom .my_utils import adjust_path, adjust_path_to_uri, json_dumps, get_env_var, is_env_var, get_env_[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35mfrom .results import ResultSet[0m
[30;1m36 | [0m[35mfrom .connection import Connection[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m959 | [0m[35m        "plotlylayout": {"flag": "plotly_layout", "type": "dict", "allow_none": True},[0m
[30;1m960 | [0m[35m[0m
[30;1m961 | [0m[35m        "atw": {"abbreviation": "authtokenwarnings"},[0m
[30;1m962 | [0m[35m        "authtokenwarnings": {"flag": "auth_token_warnings", "type": "bool"},[0m
[30;1m963 | [0m[35m[0m
[30;1m964 | [0m[35m        "ecbp": {"abbreviation": "enablecurlybracketsparams"},[0m
[30;1m965 | [0m[35m        "enablecurlybracketsparams": {"flag": "enable_curly_brackets_params", "type": "bool"},[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m959 | [0m[35m        "plotlylayout": {"flag": "plotly_layout", "type": "dict", "allow_none": True},[0m
[30;1m960 | [0m[35m[0m
[30;1m961 | [0m[35m        "atw": {"abbreviation": "authtokenwarnings"},[0m
[30;1m962 | [0m[35m        "authtokenwarnings": {"flag": "auth_token_warnings", "type": "bool"},[0m
[30;1m963 | [0m[35m[0m
[30;1m964 | [0m[35m        "ecbp": {"abbreviation": "enablecurlybracketsparams"},[0m
[30;1m965 | [0m[35m        "enablecurlybracketsparams": {"flag": "enable_curly_brackets_params", "type": "bool"},[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m958 | [0m[35m        "pl": {"abbreviation": "plotlylayout"},[0m
[30;1m959 | [0m[35m        "plotlylayout": {"flag": "plotly_layout", "type": "dict", "allow_none": True},[0m
[30;1m960 | [0m[35m[0m
[30;1m961 | [0m[35m        "atw": {"abbreviation": "authtokenwarnings"},[0m
[30;1m962 | [0m[35m        "authtokenwarnings": {"flag": "auth_token_warnings", "type": "bool"},[0m
[30;1m963 | [0m[35m[0m
[30;1m964 | [0m[35m        "ecbp": {"abbreviation": "enablecurlybracketsparams"},[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m17 | [0m[35mfrom ._debug_utils import debug_print [0m
[30;1m18 | [0m[35mfrom .dependencies import Dependencies[0m
[30;1m19 | [0m[35mfrom .constants import Constants, Schema[0m
[30;1m20 | [0m[35mfrom .my_utils import split_lex, adjust_path, is_env_var, get_env_var, is_collection, strip_if_quote[0m
[30;1m21 | [0m[35mfrom .engine import Engine[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mfrom .commands_table import COMMANDS_TABLE[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m669 | [0m[35m        Abbreviation: 'pl'"""        [0m
[30;1m670 | [0m[35m    )[0m
[30;1m671 | [0m[35m[0m
[30;1m672 | [0m[35m    auth_token_warnings = Bool([0m
[30;1m673 | [0m[35m        default_value=False, [0m
[30;1m674 | [0m[35m        config=True, [0m
[30;1m675 | [0m[35m        help=f"""When set to True, will display auth token warning when token different from connect[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m225 | [0m[35m        default_value="", [0m
[30;1m226 | [0m[35m        config=True, [0m
[30;1m227 | [0m[35m        help=f"""Email details. Should be set by {Constants.MAGIC_CLASS_NAME_UPPER}_DEVICE_CODE_NOTI[0m
[30;1m228 | [0m[35m        the email details string format is: SMTPEndPoint='endpoint';SMTPPort='port';sendFrom='email'[0m
[30;1m229 | [0m[35m        Abbreviation: 'dcne'"""[0m
[30;1m230 | [0m[35m    )[0m
[30;1m231 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m225 | [0m[35m        default_value="", [0m
[30;1m226 | [0m[35m        config=True, [0m
[30;1m227 | [0m[35m        help=f"""Email details. Should be set by {Constants.MAGIC_CLASS_NAME_UPPER}_DEVICE_CODE_NOTI[0m
[30;1m228 | [0m[35m        the email details string format is: SMTPEndPoint='endpoint';SMTPPort='port';sendFrom='email'[0m
[30;1m229 | [0m[35m        Abbreviation: 'dcne'"""[0m
[30;1m230 | [0m[35m    )[0m
[30;1m231 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m204 | [0m[35mplicit identity to use when authenticating to Azure AD. Mutually exclusive with client_id and msi_re[0m
[30;1m205 | [0m[35m        # - msi_res_id: Identifies, by ARM resource id, a specific explicit identity to use when aut[0m
[30;1m206 | [0m[35m        # - cloud_environment (msrestazure.azure_cloud.Cloud): A targeted cloud environment[0m
[30;1m207 | [0m[35m        # - resource (str): Alternative authentication resource, default is 'https://management.core[0m
[30;1m208 | [0m[35m    )[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m    sso_db_gc_interval = Int([0m
[30;1m211 | [0m[35m        default_value=168, [0m
[30;1m212 | [0m[35m        config=True,[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/sso_storage.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m226 | [0m[35m                    crypto_obj = _create_fernet_obj(key_vals, crypto_key)[0m
[30;1m227 | [0m[35m                    if crypto_obj is not None and crypto_key is None:[0m
[30;1m228 | [0m[35m                        try:[0m
[30;1m229 | [0m[35m                            locker.set_generic_password(service_name, account_name, crypto_obj.crypt[0m
[30;1m230 | [0m[35m                        except Exception as ex:[0m
[30;1m231 | [0m[35m                            raise SsoWarning([0m
[30;1m232 | [0m[35m                                f"Warning: SSO is not activated due failure to set key to Keychain, [0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/sso_storage.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m214 | [0m[35m            with Keychain() as locker:[0m
[30;1m215 | [0m[35m                crypto_key = None[0m
[30;1m216 | [0m[35m                try:[0m
[30;1m217 | [0m[35m                    crypto_key = locker.get_generic_password(service_name, account_name)[0m
[30;1m218 | [0m[35m                except KeychainError as ex:[0m
[30;1m219 | [0m[35m                    if ex.exit_status != KeychainError.ITEM_NOT_FOUND:[0m
[30;1m220 | [0m[35m                        raise SsoWarning([0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/sso_storage.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m        cache_name = _get_cache_name(key_vals)[0m
[30;1m190 | [0m[35m        crypto_options = {[0m
[30;1m191 | [0m[35m            CryptoParam.PASSWORD: f"{cache_name}-{secret_key}",[0m
[30;1m192 | [0m[35m            CryptoParam.SALT: salt,[0m
[30;1m193 | [0m[35m            CryptoParam.LENGTH: 32[0m
[30;1m194 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/sso_storage.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m        cache_name = _get_cache_name(key_vals)[0m
[30;1m190 | [0m[35m        crypto_options = {[0m
[30;1m191 | [0m[35m            CryptoParam.PASSWORD: f"{cache_name}-{secret_key}",[0m
[30;1m192 | [0m[35m            CryptoParam.SALT: salt,[0m
[30;1m193 | [0m[35m            CryptoParam.LENGTH: 32[0m
[30;1m194 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/sso_storage.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m176 | [0m[35m        hint = FernetCrypto.check_password_strength(secret_key)[0m
[30;1m177 | [0m[35m        if hint:[0m
[30;1m178 | [0m[35m            raise SsoWarning([0m
[30;1m179 | [0m[35m                f"Warning: SSO could not be activated due to {SsoEnvVarParam.SECRET_KEY} key " [0m
[30;1m180 | [0m[35m                f"in environment variable {Constants.SSO_KEYS_ENV_VAR_NAME} is too simple. It should[0m
[30;1m181 | [0m[35m[0m
[30;1m182 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/sso_storage.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m173 | [0m[35m        if secret_salt_uuid is None:[0m
[30;1m174 | [0m[35m            raise SsoWarning(f"Warning: SSO is not activated due to environment variable {Constants.[0m
[30;1m175 | [0m[35m[0m
[30;1m176 | [0m[35m        hint = FernetCrypto.check_password_strength(secret_key)[0m
[30;1m177 | [0m[35m        if hint:[0m
[30;1m178 | [0m[35m            raise SsoWarning([0m
[30;1m179 | [0m[35m                f"Warning: SSO could not be activated due to {SsoEnvVarParam.SECRET_KEY} key " [0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/sso_storage.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m173 | [0m[35m        if secret_salt_uuid is None:[0m
[30;1m174 | [0m[35m            raise SsoWarning(f"Warning: SSO is not activated due to environment variable {Constants.[0m
[30;1m175 | [0m[35m[0m
[30;1m176 | [0m[35m        hint = FernetCrypto.check_password_strength(secret_key)[0m
[30;1m177 | [0m[35m        if hint:[0m
[30;1m178 | [0m[35m            raise SsoWarning([0m
[30;1m179 | [0m[35m                f"Warning: SSO could not be activated due to {SsoEnvVarParam.SECRET_KEY} key " [0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/sso_storage.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m167 | [0m[35m    if crypto_key is None or crypto_key == SsoCrypto.FERNET:[0m
[30;1m168 | [0m[35m        secret_key = key_vals.get(SsoEnvVarParam.SECRET_KEY) if crypto_key == SsoCrypto.FERNET else [0m
[30;1m169 | [0m[35m        if secret_key is None:[0m
[30;1m170 | [0m[35m            raise SsoWarning(f"Warning: SSO is not activated due to environment variable {Constants.[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m        secret_salt_uuid = _get_secret_salt_uuid(key_vals)[0m
[30;1m173 | [0m[35m        if secret_salt_uuid is None:[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/sso_storage.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m    if crypto_key is None or crypto_key == SsoCrypto.FERNET:[0m
[30;1m168 | [0m[35m        secret_key = key_vals.get(SsoEnvVarParam.SECRET_KEY) if crypto_key == SsoCrypto.FERNET else [0m
[30;1m169 | [0m[35m        if secret_key is None:[0m
[30;1m170 | [0m[35m            raise SsoWarning(f"Warning: SSO is not activated due to environment variable {Constants.[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m        secret_salt_uuid = _get_secret_salt_uuid(key_vals)[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/sso_storage.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m165 | [0m[35m        raise SsoWarning(f"Warning: SSO is not activated due to {SsoCrypto.FERNET} cryptography and/[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m    if crypto_key is None or crypto_key == SsoCrypto.FERNET:[0m
[30;1m168 | [0m[35m        secret_key = key_vals.get(SsoEnvVarParam.SECRET_KEY) if crypto_key == SsoCrypto.FERNET else [0m
[30;1m169 | [0m[35m        if secret_key is None:[0m
[30;1m170 | [0m[35m            raise SsoWarning(f"Warning: SSO is not activated due to environment variable {Constants.[0m
[30;1m171 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/sso_storage.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m165 | [0m[35m        raise SsoWarning(f"Warning: SSO is not activated due to {SsoCrypto.FERNET} cryptography and/[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m    if crypto_key is None or crypto_key == SsoCrypto.FERNET:[0m
[30;1m168 | [0m[35m        secret_key = key_vals.get(SsoEnvVarParam.SECRET_KEY) if crypto_key == SsoCrypto.FERNET else [0m
[30;1m169 | [0m[35m        if secret_key is None:[0m
[30;1m170 | [0m[35m            raise SsoWarning(f"Warning: SSO is not activated due to environment variable {Constants.[0m
[30;1m171 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/sso_storage.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m165 | [0m[35m        raise SsoWarning(f"Warning: SSO is not activated due to {SsoCrypto.FERNET} cryptography and/[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m    if crypto_key is None or crypto_key == SsoCrypto.FERNET:[0m
[30;1m168 | [0m[35m        secret_key = key_vals.get(SsoEnvVarParam.SECRET_KEY) if crypto_key == SsoCrypto.FERNET else [0m
[30;1m169 | [0m[35m        if secret_key is None:[0m
[30;1m170 | [0m[35m            raise SsoWarning(f"Warning: SSO is not activated due to environment variable {Constants.[0m
[30;1m171 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/sso_storage.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m162 | [0m[35m    [0m
[30;1m163 | [0m[35mdef _create_fernet_obj(key_vals:dict, crypto_key:str) -> FernetCrypto:[0m
[30;1m164 | [0m[35m    if not FernetCrypto.is_installed():[0m
[30;1m165 | [0m[35m        raise SsoWarning(f"Warning: SSO is not activated due to {SsoCrypto.FERNET} cryptography and/[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m    if crypto_key is None or crypto_key == SsoCrypto.FERNET:[0m
[30;1m168 | [0m[35m        secret_key = key_vals.get(SsoEnvVarParam.SECRET_KEY) if crypto_key == SsoCrypto.FERNET else [0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/sso_storage.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35mdef _get_secret_key(key_vals:dict) -> str:[0m
[30;1m102 | [0m[35m    secret_key = key_vals.get(SsoEnvVarParam.SECRET_KEY) or str(uuid.uuid4())[0m
[30;1m103 | [0m[35m    return secret_key[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35mdef _get_secret_salt_uuid(key_vals:dict) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/sso_storage.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35mdef _get_secret_key(key_vals:dict) -> str:[0m
[30;1m102 | [0m[35m    secret_key = key_vals.get(SsoEnvVarParam.SECRET_KEY) or str(uuid.uuid4())[0m
[30;1m103 | [0m[35m    return secret_key[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/sso_storage.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35mdef _get_secret_key(key_vals:dict) -> str:[0m
[30;1m102 | [0m[35m    secret_key = key_vals.get(SsoEnvVarParam.SECRET_KEY) or str(uuid.uuid4())[0m
[30;1m103 | [0m[35m    return secret_key[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/sso_storage.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m98 | [0m[35m    return cache_name[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35mdef _get_secret_key(key_vals:dict) -> str:[0m
[30;1m102 | [0m[35m    secret_key = key_vals.get(SsoEnvVarParam.SECRET_KEY) or str(uuid.uuid4())[0m
[30;1m103 | [0m[35m    return secret_key[0m
[30;1m104 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m463 | [0m[35m        # in case secret is missing, get it from user[0m
[30;1m464 | [0m[35m        secret_key_set = self._SECRET_KEYS.intersection(self._keys_set)[0m
[30;1m465 | [0m[35m        if len(secret_key_set) == 1:[0m
[30;1m466 | [0m[35m            s = secret_key_set.pop()[0m
[30;1m467 | [0m[35m            if s not in matched_keys_set or parsed_conn_kv[s] == f"<{s}>":[0m
[30;1m468 | [0m[35m                name = self.get_conn_name()[0m
[30;1m469 | [0m[35m                parsed_conn_kv[s] = getpass.getpass(prompt=f"connection to {name} requires {s}, plea[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m462 | [0m[35m    def _retreive_and_set_secret(self, matched_keys_set:set, parsed_conn_kv:Dict[str,str])->None:[0m
[30;1m463 | [0m[35m        # in case secret is missing, get it from user[0m
[30;1m464 | [0m[35m        secret_key_set = self._SECRET_KEYS.intersection(self._keys_set)[0m
[30;1m465 | [0m[35m        if len(secret_key_set) == 1:[0m
[30;1m466 | [0m[35m            s = secret_key_set.pop()[0m
[30;1m467 | [0m[35m            if s not in matched_keys_set or parsed_conn_kv[s] == f"<{s}>":[0m
[30;1m468 | [0m[35m                name = self.get_conn_name()[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m461 | [0m[35m[0m
[30;1m462 | [0m[35m    def _retreive_and_set_secret(self, matched_keys_set:set, parsed_conn_kv:Dict[str,str])->None:[0m
[30;1m463 | [0m[35m        # in case secret is missing, get it from user[0m
[30;1m464 | [0m[35m        secret_key_set = self._SECRET_KEYS.intersection(self._keys_set)[0m
[30;1m465 | [0m[35m        if len(secret_key_set) == 1:[0m
[30;1m466 | [0m[35m            s = secret_key_set.pop()[0m
[30;1m467 | [0m[35m            if s not in matched_keys_set or parsed_conn_kv[s] == f"<{s}>":[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m461 | [0m[35m[0m
[30;1m462 | [0m[35m    def _retreive_and_set_secret(self, matched_keys_set:set, parsed_conn_kv:Dict[str,str])->None:[0m
[30;1m463 | [0m[35m        # in case secret is missing, get it from user[0m
[30;1m464 | [0m[35m        secret_key_set = self._SECRET_KEYS.intersection(self._keys_set)[0m
[30;1m465 | [0m[35m        if len(secret_key_set) == 1:[0m
[30;1m466 | [0m[35m            s = secret_key_set.pop()[0m
[30;1m467 | [0m[35m            if s not in matched_keys_set or parsed_conn_kv[s] == f"<{s}>":[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m422 | [0m[35m            if key in self._SHOULD_BE_NULL_KEYS:[0m
[30;1m423 | [0m[35m                if parsed_conn_kv[key] != "":[0m
[30;1m424 | [0m[35m                    raise KqlEngineError(f"key {key} must be empty")[0m
[30;1m425 | [0m[35m            elif key not in self._SECRET_KEYS:[0m
[30;1m426 | [0m[35m                if parsed_conn_kv[key] == f"<{key}>" or parsed_conn_kv[key] == "":[0m
[30;1m427 | [0m[35m                    raise KqlEngineError(f"key {key} cannot be empty or set to <{key}>")[0m
[30;1m428 | [0m[35m        logger().debug(f"kql_engine.py - _check_for_restricted_values - make sure that all required [0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m418 | [0m[35m[0m
[30;1m419 | [0m[35m    def _check_for_restricted_values(self, matched_keys_set:set, parsed_conn_kv:Dict[str,str])->None[0m
[30;1m420 | [0m[35m        # make sure that all required keys are with proper value[0m
[30;1m421 | [0m[35m        for key in matched_keys_set:  # .difference(secret_key_set).difference(self._SHOULD_BE_NULL_[0m
[30;1m422 | [0m[35m            if key in self._SHOULD_BE_NULL_KEYS:[0m
[30;1m423 | [0m[35m                if parsed_conn_kv[key] != "":[0m
[30;1m424 | [0m[35m                    raise KqlEngineError(f"key {key} must be empty")[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m403 | [0m[35m    def _check_for_required_keys(self, matched_keys_set:set)->None:[0m
[30;1m404 | [0m[35m        # make sure that all required keys are in set[0m
[30;1m405 | [0m[35m        secret_key_set = self._SECRET_KEYS.intersection(self._keys_set)[0m
[30;1m406 | [0m[35m        missing_set = self._keys_set.difference(matched_keys_set).difference(secret_key_set).differe[0m
[30;1m407 | [0m[35m        if len(missing_set) > 0:[0m
[30;1m408 | [0m[35m            logger().debug(f"kql_engine.py - _check_for_required_keys - the following required key i[0m
[30;1m409 | [0m[35m            raise KqlEngineError(f"missing {missing_set}")[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m402 | [0m[35m[0m
[30;1m403 | [0m[35m    def _check_for_required_keys(self, matched_keys_set:set)->None:[0m
[30;1m404 | [0m[35m        # make sure that all required keys are in set[0m
[30;1m405 | [0m[35m        secret_key_set = self._SECRET_KEYS.intersection(self._keys_set)[0m
[30;1m406 | [0m[35m        missing_set = self._keys_set.difference(matched_keys_set).difference(secret_key_set).differe[0m
[30;1m407 | [0m[35m        if len(missing_set) > 0:[0m
[30;1m408 | [0m[35m            logger().debug(f"kql_engine.py - _check_for_required_keys - the following required key i[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m402 | [0m[35m[0m
[30;1m403 | [0m[35m    def _check_for_required_keys(self, matched_keys_set:set)->None:[0m
[30;1m404 | [0m[35m        # make sure that all required keys are in set[0m
[30;1m405 | [0m[35m        secret_key_set = self._SECRET_KEYS.intersection(self._keys_set)[0m
[30;1m406 | [0m[35m        missing_set = self._keys_set.difference(matched_keys_set).difference(secret_key_set).differe[0m
[30;1m407 | [0m[35m        if len(missing_set) > 0:[0m
[30;1m408 | [0m[35m            logger().debug(f"kql_engine.py - _check_for_required_keys - the following required key i[0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m270 | [0m[35m    _SECRET_KEYS = {[0m
[30;1m271 | [0m[35m        ConnStrKeys.CLIENTSECRET, [0m
[30;1m272 | [0m[35m        ConnStrKeys.APPKEY, [0m
[30;1m273 | [0m[35m        ConnStrKeys.PASSWORD, [0m
[30;1m274 | [0m[35m        ConnStrKeys.CERTIFICATE_THUMBPRINT[0m
[30;1m275 | [0m[35m    }[0m
[30;1m276 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m267 | [0m[35m        ConnStrKeys.CERTIFICATE_THUMBPRINT,[0m
[30;1m268 | [0m[35m    }[0m
[30;1m269 | [0m[35m[0m
[30;1m270 | [0m[35m    _SECRET_KEYS = {[0m
[30;1m271 | [0m[35m        ConnStrKeys.CLIENTSECRET, [0m
[30;1m272 | [0m[35m        ConnStrKeys.APPKEY, [0m
[30;1m273 | [0m[35m        ConnStrKeys.PASSWORD, [0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m263 | [0m[35m        ConnStrKeys.CERTIFICATE,[0m
[30;1m264 | [0m[35m        ConnStrKeys.CLIENTSECRET,[0m
[30;1m265 | [0m[35m        ConnStrKeys.APPKEY,[0m
[30;1m266 | [0m[35m        ConnStrKeys.PASSWORD,[0m
[30;1m267 | [0m[35m        ConnStrKeys.CERTIFICATE_THUMBPRINT,[0m
[30;1m268 | [0m[35m    }[0m
[30;1m269 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m84 | [0m[35m    def obfuscate_parsed_conn(self)->Dict[str,str]:[0m
[30;1m85 | [0m[35m        parse_conn_copy = {**self._parsed_conn}[0m
[30;1m86 | [0m[35m        for p in parse_conn_copy:[0m
[30;1m87 | [0m[35m            if p in [ConnStrKeys.PASSWORD, ConnStrKeys.CLIENTSECRET, ConnStrKeys.CERTIFICATE, ConnSt[0m
[30;1m88 | [0m[35m                parse_conn_copy[p] = "*****"[0m
[30;1m89 | [0m[35m        return parse_conn_copy[0m
[30;1m90 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/KqlmagicCustom.egg-info/requires.txt[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m294 | [0m[35mmsal-extensions>=0.3.0[0m
[30;1m295 | [0m[35mmsrestazure>=0.6.3[0m
[30;1m296 | [0m[35mmsal>=1.11.0[0m
[30;1m297 | [0m[35mpassword-strength>=0.0.3[0m
[30;1m298 | [0m[35mazure-identity>=1.5.0[0m
[30;1m299 | [0m[35m[0m
[30;1m300 | [0m[35m[tests][0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/KqlmagicCustom.egg-info/requires.txt[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m267 | [0m[35mrequests>=2.21.0[0m
[30;1m268 | [0m[35mlxml>=4.2.5[0m
[30;1m269 | [0m[35mmsal>=1.11.0[0m
[30;1m270 | [0m[35mpassword-strength>=0.0.3[0m
[30;1m271 | [0m[35mPygments>=2.2.0[0m
[30;1m272 | [0m[35mmsal-extensions>=0.3.0[0m
[30;1m273 | [0m[35mpsutil>=5.4.7[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/KqlmagicCustom.egg-info/requires.txt[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m238 | [0m[35mrequests>=2.21.0[0m
[30;1m239 | [0m[35mlxml>=4.2.5[0m
[30;1m240 | [0m[35mmsal>=1.11.0[0m
[30;1m241 | [0m[35mpassword-strength>=0.0.3[0m
[30;1m242 | [0m[35mPygments>=2.2.0[0m
[30;1m243 | [0m[35mipywidgets[0m
[30;1m244 | [0m[35mmsal-extensions>=0.3.0[0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/KqlmagicCustom.egg-info/requires.txt[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m208 | [0m[35mpassword-strength>=0.0.3[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m[kqlmagic_sso][0m
[30;1m211 | [0m[35mpassword-strength>=0.0.3[0m
[30;1m212 | [0m[35mcryptography>=2.7[0m
[30;1m213 | [0m[35mmsal-extensions>=0.3.0[0m
[30;1m214 | [0m[35mmsal>=1.11.0[0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/KqlmagicCustom.egg-info/requires.txt[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m202 | [0m[35m[0m
[30;1m203 | [0m[35m[kqlmagic_msal_sso][0m
[30;1m204 | [0m[35mcryptography>=2.7[0m
[30;1m205 | [0m[35mpassword-strength>=0.0.3[0m
[30;1m206 | [0m[35m[0m
[30;1m207 | [0m[35m[kqlmagic_sso][0m
[30;1m208 | [0m[35mpassword-strength>=0.0.3[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/KqlmagicCustom.egg-info/requires.txt[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m198 | [0m[35m[0m
[30;1m199 | [0m[35m[kqlmagic_fernet_sso][0m
[30;1m200 | [0m[35mcryptography>=2.7[0m
[30;1m201 | [0m[35mpassword-strength>=0.0.3[0m
[30;1m202 | [0m[35m[0m
[30;1m203 | [0m[35m[kqlmagic_msal_sso][0m
[30;1m204 | [0m[35mcryptography>=2.7[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/KqlmagicCustom.egg-info/requires.txt[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m183 | [0m[35mrequests>=2.21.0[0m
[30;1m184 | [0m[35mlxml>=4.2.5[0m
[30;1m185 | [0m[35mmsal>=1.11.0[0m
[30;1m186 | [0m[35mpassword-strength>=0.0.3[0m
[30;1m187 | [0m[35mPygments>=2.2.0[0m
[30;1m188 | [0m[35mipykernel>=5.1.1[0m
[30;1m189 | [0m[35mmsal-extensions>=0.3.0[0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/KqlmagicCustom.egg-info/requires.txt[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m152 | [0m[35mrequests>=2.21.0[0m
[30;1m153 | [0m[35mlxml>=4.2.5[0m
[30;1m154 | [0m[35mmsal>=1.11.0[0m
[30;1m155 | [0m[35mpassword-strength>=0.0.3[0m
[30;1m156 | [0m[35mPygments>=2.2.0[0m
[30;1m157 | [0m[35mipykernel>=5.1.1[0m
[30;1m158 | [0m[35mipywidgets[0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/KqlmagicCustom.egg-info/requires.txt[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m125 | [0m[35mrequests>=2.21.0[0m
[30;1m126 | [0m[35mlxml>=4.2.5[0m
[30;1m127 | [0m[35mmsal>=1.11.0[0m
[30;1m128 | [0m[35mpassword-strength>=0.0.3[0m
[30;1m129 | [0m[35mPygments>=2.2.0[0m
[30;1m130 | [0m[35mmsal-extensions>=0.3.0[0m
[30;1m131 | [0m[35mpsutil>=5.4.7[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/KqlmagicCustom.egg-info/requires.txt[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m94 | [0m[35mrequests>=2.21.0[0m
[30;1m95 | [0m[35mlxml>=4.2.5[0m
[30;1m96 | [0m[35mmsal>=1.11.0[0m
[30;1m97 | [0m[35mpassword-strength>=0.0.3[0m
[30;1m98 | [0m[35mPygments>=2.2.0[0m
[30;1m99 | [0m[35mipywidgets[0m
[30;1m100 | [0m[35mmsal-extensions>=0.3.0[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/KqlmagicCustom.egg-info/requires.txt[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m69 | [0m[35mrequests>=2.21.0[0m
[30;1m70 | [0m[35mlxml>=4.2.5[0m
[30;1m71 | [0m[35mmsal>=1.11.0[0m
[30;1m72 | [0m[35mpassword-strength>=0.0.3[0m
[30;1m73 | [0m[35mPygments>=2.2.0[0m
[30;1m74 | [0m[35mipykernel>=5.1.1[0m
[30;1m75 | [0m[35mmsal-extensions>=0.3.0[0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/KqlmagicCustom.egg-info/requires.txt[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m32 | [0m[35mrequests>=2.21.0[0m
[30;1m33 | [0m[35mlxml>=4.2.5[0m
[30;1m34 | [0m[35mmsal>=1.11.0[0m
[30;1m35 | [0m[35mpassword-strength>=0.0.3[0m
[30;1m36 | [0m[35mPygments>=2.2.0[0m
[30;1m37 | [0m[35mipykernel>=5.1.1[0m
[30;1m38 | [0m[35mipywidgets[0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ai_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m47 | [0m[35m            "optional": [ConnStrKeys.ALIAS, ConnStrKeys.DATA_SOURCE_URL, ConnStrKeys.TENANT, ConnStr[0m
[30;1m48 | [0m[35m        },[0m
[30;1m49 | [0m[35m        {[0m
[30;1m50 | [0m[35m            "required": [ConnStrKeys.APPID, ConnStrKeys.USERNAME, ConnStrKeys.PASSWORD],[0m
[30;1m51 | [0m[35m            "extra": [ConnStrKeys.CLIENTID],[0m
[30;1m52 | [0m[35m            "optional": [ConnStrKeys.ALIAS, ConnStrKeys.DATA_SOURCE_URL, ConnStrKeys.TENANT, ConnStr[0m
[30;1m53 | [0m[35m        },[0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ai_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m32 | [0m[35m.DATA_SOURCE_URL, ConnStrKeys.TENANT, ConnStrKeys.AAD_URL, ConnStrKeys.CLIENTID, ConnStrKeys.USERNAM[0m
[30;1m33 | [0m[35m        [ConnStrKeys.APPID, ConnStrKeys.ALIAS, ConnStrKeys.DATA_SOURCE_URL, ConnStrKeys.TENANT, Conn[0m
[30;1m34 | [0m[35m        [ConnStrKeys.APPID, ConnStrKeys.ALIAS, ConnStrKeys.DATA_SOURCE_URL,                         [0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ai_engine.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m31 | [0m[35mStrKeys.ALIAS, ConnStrKeys.DATA_SOURCE_URL, ConnStrKeys.TENANT, ConnStrKeys.AAD_URL,                [0m
[30;1m32 | [0m[35m        [ConnStrKeys.APPID, ConnStrKeys.ALIAS, ConnStrKeys.DATA_SOURCE_URL, ConnStrKeys.TENANT, Conn[0m
[30;1m33 | [0m[35m        [ConnStrKeys.APPID, ConnStrKeys.ALIAS, ConnStrKeys.DATA_SOURCE_URL, ConnStrKeys.TENANT, Conn[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m882 | [0m[35m            elif padding_size == 1:[0m
[30;1m883 | [0m[35m                url_str += '='[0m
[30;1m884 | [0m[35m            else:[0m
[30;1m885 | [0m[35m                raise ValueError(f"Invalid base64 url string: {url_str}")[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m14 | [0m[35mfrom urllib.parse import urlparse[0m
[30;1m15 | [0m[35m# import webbrowser[0m
[30;1m16 | [0m[35mimport json[0m
[30;1m17 | [0m[35mfrom base64 import urlsafe_b64decode[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35mimport dateutil.parser[0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m803 | [0m[35m    def _get_authentication_error_kwargs(self):[0m
[30;1m804 | [0m[35m        " collect info for AuthenticationError exception and raise it"[0m
[30;1m805 | [0m[35m        kwargs = {}[0m
[30;1m806 | [0m[35m        if self._current_authentication_method is AuthenticationMethod.aad_username_password:[0m
[30;1m807 | [0m[35m            kwargs = {"username": self._username, "client_id": self._client_id}[0m
[30;1m808 | [0m[35m        elif self._current_authentication_method is AuthenticationMethod.aad_application_key:[0m
[30;1m809 | [0m[35m            kwargs = {"client_id": self._client_id}[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m766 | [0m[35m[0m
[30;1m767 | [0m[35m[0m
[30;1m768 | [0m[35m    def _warn_token_diff_from_conn_str(self)->None:[0m
[30;1m769 | [0m[35m        if self._options.get("auth_token_warnings"):[0m
[30;1m770 | [0m[35m            token = self._current_token[0m
[30;1m771 | [0m[35m            if token is not None:[0m
[30;1m772 | [0m[35m                # to avoid more than one warning per connection, keep track of already displayed war[0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m759 | [0m[35m[0m
[30;1m760 | [0m[35m[0m
[30;1m761 | [0m[35m    def _warn_on_token_validation_failure(self, message)->None:[0m
[30;1m762 | [0m[35m        if self._options.get("auth_token_warnings"):[0m
[30;1m763 | [0m[35m            if self._current_authentication_method is not None and message is not None:[0m
[30;1m764 | [0m[35m                warn_message =f"Can't use '{self._current_authentication_method}' token entry, {mess[0m
[30;1m765 | [0m[35m                Display.showWarningMessage(warn_message, display_handler_name='acquire_token', **sel[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m298 | [0m[35mr().debug(f"_MyAadHelper::acquire_token - aad/user-password - resource: '{self._resource}', username[0m
[30;1m299 | [0m[35m                    token = self._current_adal_context.acquire_token_with_username_password(self._re[0m
[30;1m300 | [0m[35m[0m
[30;1m301 | [0m[35m                elif self._authentication_method is AuthenticationMethod.aad_application_key:[0m
[30;1m302 | [0m[35m                    logger().debug(f"_MyAadHelper::acquire_token - aad/client-secret - resource: '{s[0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m297 | [0m[35md_username_password:[0m
[30;1m298 | [0m[35m                    logger().debug(f"_MyAadHelper::acquire_token - aad/user-password - resource: '{s[0m
[30;1m299 | [0m[35m                    token = self._current_adal_context.acquire_token_with_username_password(self._re[0m
[30;1m300 | [0m[35m[0m
[30;1m301 | [0m[35m                elif self._authentication_method is AuthenticationMethod.aad_application_key:[0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m295 | [0m[35mcontext = self._adal_context_sso or self._adal_context[0m
[30;1m296 | [0m[35m[0m
[30;1m297 | [0m[35m                if self._authentication_method is AuthenticationMethod.aad_username_password:[0m
[30;1m298 | [0m[35m                    logger().debug(f"_MyAadHelper::acquire_token - aad/user-password - resource: '{s[0m
[30;1m299 | [0m[35m                    token = self._current_adal_context.acquire_token_with_username_password(self._re[0m
[30;1m300 | [0m[35m[0m
[30;1m301 | [0m[35m                elif self._authentication_method is AuthenticationMethod.aad_application_key:[0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m294 | [0m[35mthod = self._authentication_method[0m
[30;1m295 | [0m[35m                self._current_adal_context = self._adal_context_sso or self._adal_context[0m
[30;1m296 | [0m[35m[0m
[30;1m297 | [0m[35m                if self._authentication_method is AuthenticationMethod.aad_username_password:[0m
[30;1m298 | [0m[35m                    logger().debug(f"_MyAadHelper::acquire_token - aad/user-password - resource: '{s[0m
[30;1m299 | [0m[35m                    token = self._current_adal_context.acquire_token_with_username_password(self._re[0m
[30;1m300 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m292 | [0m[35mis None:[0m
[30;1m293 | [0m[35m                token = None[0m
[30;1m294 | [0m[35m                self._current_authentication_method = self._authentication_method[0m
[30;1m295 | [0m[35m                self._current_adal_context = self._adal_context_sso or self._adal_context[0m
[30;1m296 | [0m[35m[0m
[30;1m297 | [0m[35m                if self._authentication_method is AuthenticationMethod.aad_username_password:[0m
[30;1m298 | [0m[35m                    logger().debug(f"_MyAadHelper::acquire_token - aad/user-password - resource: '{s[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m238 | [0m[35m        elif self._current_authentication_method == AuthenticationMethod.aad_application_key:[0m
[30;1m239 | [0m[35m            details["client_secret"] = '*****' if self._client_secret else 'NOT-SET'[0m
[30;1m240 | [0m[35m        elif self._current_authentication_method == AuthenticationMethod.aad_username_password:[0m
[30;1m241 | [0m[35m            details["password"] = '*****' if self._password else 'NOT-SET'[0m
[30;1m242 | [0m[35m[0m
[30;1m243 | [0m[35m        return details[0m
[30;1m244 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m238 | [0m[35m        elif self._current_authentication_method == AuthenticationMethod.aad_application_key:[0m
[30;1m239 | [0m[35m            details["client_secret"] = '*****' if self._client_secret else 'NOT-SET'[0m
[30;1m240 | [0m[35m        elif self._current_authentication_method == AuthenticationMethod.aad_username_password:[0m
[30;1m241 | [0m[35m            details["password"] = '*****' if self._password else 'NOT-SET'[0m
[30;1m242 | [0m[35m[0m
[30;1m243 | [0m[35m        return details[0m
[30;1m244 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m237 | [0m[35m            details["thumbprint"] = self._thumbprint[0m
[30;1m238 | [0m[35m        elif self._current_authentication_method == AuthenticationMethod.aad_application_key:[0m
[30;1m239 | [0m[35m            details["client_secret"] = '*****' if self._client_secret else 'NOT-SET'[0m
[30;1m240 | [0m[35m        elif self._current_authentication_method == AuthenticationMethod.aad_username_password:[0m
[30;1m241 | [0m[35m            details["password"] = '*****' if self._password else 'NOT-SET'[0m
[30;1m242 | [0m[35m[0m
[30;1m243 | [0m[35m        return details[0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m215 | [0m[35m            "authority_uri": self._authority_uri,[0m
[30;1m216 | [0m[35m            "client_id": self._client_id,[0m
[30;1m217 | [0m[35m            "aad_login_url": self._aad_login_url}[0m
[30;1m218 | [0m[35m        if (self._current_authentication_method == AuthenticationMethod.aad_username_password[0m
[30;1m219 | [0m[35m                or self._current_authentication_method == AuthenticationMethod.aad_code_login):[0m
[30;1m220 | [0m[35m            details["username"] = self._username[0m
[30;1m221 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m194 | [0m[35m        if all([kcsb.aad_user_id, kcsb.password]):[0m
[30;1m195 | [0m[35m            self._authentication_method = AuthenticationMethod.aad_username_password[0m
[30;1m196 | [0m[35m            self._username = kcsb.aad_user_id[0m
[30;1m197 | [0m[35m            self._password = kcsb.password[0m
[30;1m198 | [0m[35m        elif all([kcsb.application_client_id, kcsb.application_key]):[0m
[30;1m199 | [0m[35m            self._authentication_method = AuthenticationMethod.aad_application_key[0m
[30;1m200 | [0m[35m            self._client_secret = kcsb.application_key[0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m194 | [0m[35m        if all([kcsb.aad_user_id, kcsb.password]):[0m
[30;1m195 | [0m[35m            self._authentication_method = AuthenticationMethod.aad_username_password[0m
[30;1m196 | [0m[35m            self._username = kcsb.aad_user_id[0m
[30;1m197 | [0m[35m            self._password = kcsb.password[0m
[30;1m198 | [0m[35m        elif all([kcsb.application_client_id, kcsb.application_key]):[0m
[30;1m199 | [0m[35m            self._authentication_method = AuthenticationMethod.aad_application_key[0m
[30;1m200 | [0m[35m            self._client_secret = kcsb.application_key[0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m        self._username = None[0m
[30;1m194 | [0m[35m        if all([kcsb.aad_user_id, kcsb.password]):[0m
[30;1m195 | [0m[35m            self._authentication_method = AuthenticationMethod.aad_username_password[0m
[30;1m196 | [0m[35m            self._username = kcsb.aad_user_id[0m
[30;1m197 | [0m[35m            self._password = kcsb.password[0m
[30;1m198 | [0m[35m        elif all([kcsb.application_client_id, kcsb.application_key]):[0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m191 | [0m[35m        self._client_id = kcsb.application_client_id or default_clientid[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m        self._username = None[0m
[30;1m194 | [0m[35m        if all([kcsb.aad_user_id, kcsb.password]):[0m
[30;1m195 | [0m[35m            self._authentication_method = AuthenticationMethod.aad_username_password[0m
[30;1m196 | [0m[35m            self._username = kcsb.aad_user_id[0m
[30;1m197 | [0m[35m            self._password = kcsb.password[0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m85 | [0m[35mclass AuthenticationMethod(object):[0m
[30;1m86 | [0m[35m    """Represnting all authentication methods available in Azure Monitor with Python."""[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m    aad_username_password = "aad_username_password"[0m
[30;1m89 | [0m[35m    aad_application_key = "aad_application_key"[0m
[30;1m90 | [0m[35m    aad_application_certificate = "aad_application_certificate"[0m
[30;1m91 | [0m[35m    aad_code_login = "aad_code_login"[0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m85 | [0m[35mclass AuthenticationMethod(object):[0m
[30;1m86 | [0m[35m    """Represnting all authentication methods available in Azure Monitor with Python."""[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m    aad_username_password = "aad_username_password"[0m
[30;1m89 | [0m[35m    aad_application_key = "aad_application_key"[0m
[30;1m90 | [0m[35m    aad_application_certificate = "aad_application_certificate"[0m
[30;1m91 | [0m[35m    aad_code_login = "aad_code_login"[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m67 | [0m[35m            "authority_id":                       ConnStrKeys.TENANT,[0m
[30;1m68 | [0m[35m            "aad_url":                            ConnStrKeys.AAD_URL,[0m
[30;1m69 | [0m[35m            "aad_user_id":                        ConnStrKeys.USERNAME,[0m
[30;1m70 | [0m[35m            "password":                           ConnStrKeys.PASSWORD,[0m
[30;1m71 | [0m[35m            "application_client_id":              ConnStrKeys.CLIENTID,[0m
[30;1m72 | [0m[35m            "application_key":                    ConnStrKeys.CLIENTSECRET,[0m
[30;1m73 | [0m[35m            "application_certificate":            ConnStrKeys.CERTIFICATE,[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m67 | [0m[35m            "authority_id":                       ConnStrKeys.TENANT,[0m
[30;1m68 | [0m[35m            "aad_url":                            ConnStrKeys.AAD_URL,[0m
[30;1m69 | [0m[35m            "aad_user_id":                        ConnStrKeys.USERNAME,[0m
[30;1m70 | [0m[35m            "password":                           ConnStrKeys.PASSWORD,[0m
[30;1m71 | [0m[35m            "application_client_id":              ConnStrKeys.CLIENTID,[0m
[30;1m72 | [0m[35m            "application_key":                    ConnStrKeys.CLIENTSECRET,[0m
[30;1m73 | [0m[35m            "application_certificate":            ConnStrKeys.CERTIFICATE,[0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m611 | [0m[35m                with open(full_file_name, 'r') as str_reader:[0m
[30;1m612 | [0m[35m                    # Read the entire file[0m
[30;1m613 | [0m[35m                    file_path_or_data = str_reader.read()[0m
[30;1m614 | [0m[35m            file_path_or_data =  base64.b64encode(file_path_or_data.encode('utf-8')).decode('utf-8')[0m
[30;1m615 | [0m[35m            isText = True[0m
[30;1m616 | [0m[35m            host_or_text = 'body'[0m
[30;1m617 | [0m[35m        window_name = window_name.replace(".", "_").replace("-", "_").replace("/", "_").replace(":",[0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m446 | [0m[35m                with open(full_file_name, 'r') as str_reader:[0m
[30;1m447 | [0m[35m                    # Read the entire file[0m
[30;1m448 | [0m[35m                    file_path_or_data = str_reader.read()[0m
[30;1m449 | [0m[35m            file_path_or_data =  base64.b64encode(file_path_or_data.encode('utf-8')).decode('utf-8')[0m
[30;1m450 | [0m[35m            isText = True[0m
[30;1m451 | [0m[35m            host_or_text = 'body'[0m
[30;1m452 | [0m[35m        onclick_visibility = "visible" if onclick_visibility == "visible" else "hidden"[0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m5 | [0m[35m# --------------------------------------------------------------------------[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mimport os[0m
[30;1m8 | [0m[35mimport base64[0m
[30;1m9 | [0m[35mimport uuid[0m
[30;1m10 | [0m[35m# import webbrowser[0m
[30;1m11 | [0m[35mimport urllib.parse[0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_utils.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m249 | [0m[35m            return default[0m
[30;1m250 | [0m[35m    except: # pylint: disable=bare-except[0m
[30;1m251 | [0m[35m        pass[0m
[30;1m252 | [0m[35m    raise SyntaxError(f"failed to parse environment variable {var_name}={os.getenv(var_name)} ")[0m
[30;1m253 | [0m[35m[0m
[30;1m254 | [0m[35m[0m
[30;1m255 | [0m[35mdef is_env_var(var_name:str)->bool:[0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_utils.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m        return items[0m
[30;1m234 | [0m[35m    except: # pylint: disable=bare-except[0m
[30;1m235 | [0m[35m        raise SyntaxError(f"failed to parse environment variable {var_name}={os.getenv(var_name)} ")[0m
[30;1m236 | [0m[35m[0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35mdef get_env_var_bool(var_name:str, default:bool=None)->bool:[0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1805 | [0m[35m            yaxis=dict([0m
[30;1m1806 | [0m[35m                title=chart_properties.get("ylabel"),[0m
[30;1m1807 | [0m[35m                type=chart_properties.get("yscale"),[0m
[30;1m1808 | [0m[35m                range=chart_properties.get("range"),[0m
[30;1m1809 | [0m[35m                # dtick=20,[0m
[30;1m1810 | [0m[35m                ticksuffix="",[0m
[30;1m1811 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1804 | [0m[35m            ),[0m
[30;1m1805 | [0m[35m            yaxis=dict([0m
[30;1m1806 | [0m[35m                title=chart_properties.get("ylabel"),[0m
[30;1m1807 | [0m[35m                type=chart_properties.get("yscale"),[0m
[30;1m1808 | [0m[35m                range=chart_properties.get("range"),[0m
[30;1m1809 | [0m[35m                # dtick=20,[0m
[30;1m1810 | [0m[35m                ticksuffix="",[0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1803 | [0m[35m                autorange=chart_properties.get("autorange"),[0m
[30;1m1804 | [0m[35m            ),[0m
[30;1m1805 | [0m[35m            yaxis=dict([0m
[30;1m1806 | [0m[35m                title=chart_properties.get("ylabel"),[0m
[30;1m1807 | [0m[35m                type=chart_properties.get("yscale"),[0m
[30;1m1808 | [0m[35m                range=chart_properties.get("range"),[0m
[30;1m1809 | [0m[35m                # dtick=20,[0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1800 | [0m[35m            xaxis=dict([0m
[30;1m1801 | [0m[35m                title=chart_properties.get("xlabel"),[0m
[30;1m1802 | [0m[35m                type=chart_properties.get("xscale"),[0m
[30;1m1803 | [0m[35m                autorange=chart_properties.get("autorange"),[0m
[30;1m1804 | [0m[35m            ),[0m
[30;1m1805 | [0m[35m            yaxis=dict([0m
[30;1m1806 | [0m[35m                title=chart_properties.get("ylabel"),[0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1799 | [0m[35m            showlegend=chart_properties.get("showlegend"),[0m
[30;1m1800 | [0m[35m            xaxis=dict([0m
[30;1m1801 | [0m[35m                title=chart_properties.get("xlabel"),[0m
[30;1m1802 | [0m[35m                type=chart_properties.get("xscale"),[0m
[30;1m1803 | [0m[35m                autorange=chart_properties.get("autorange"),[0m
[30;1m1804 | [0m[35m            ),[0m
[30;1m1805 | [0m[35m            yaxis=dict([0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1798 | [0m[35m            title=chart_properties.get("title"),[0m
[30;1m1799 | [0m[35m            showlegend=chart_properties.get("showlegend"),[0m
[30;1m1800 | [0m[35m            xaxis=dict([0m
[30;1m1801 | [0m[35m                title=chart_properties.get("xlabel"),[0m
[30;1m1802 | [0m[35m                type=chart_properties.get("xscale"),[0m
[30;1m1803 | [0m[35m                autorange=chart_properties.get("autorange"),[0m
[30;1m1804 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1796 | [0m[35m        ][0m
[30;1m1797 | [0m[35m        layout = go.Layout([0m
[30;1m1798 | [0m[35m            title=chart_properties.get("title"),[0m
[30;1m1799 | [0m[35m            showlegend=chart_properties.get("showlegend"),[0m
[30;1m1800 | [0m[35m            xaxis=dict([0m
[30;1m1801 | [0m[35m                title=chart_properties.get("xlabel"),[0m
[30;1m1802 | [0m[35m                type=chart_properties.get("xscale"),[0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1795 | [0m[35m            for idx, tab in enumerate(self.chart_sub_tables)[0m
[30;1m1796 | [0m[35m        ][0m
[30;1m1797 | [0m[35m        layout = go.Layout([0m
[30;1m1798 | [0m[35m            title=chart_properties.get("title"),[0m
[30;1m1799 | [0m[35m            showlegend=chart_properties.get("showlegend"),[0m
[30;1m1800 | [0m[35m            xaxis=dict([0m
[30;1m1801 | [0m[35m                title=chart_properties.get("xlabel"),[0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1790 | [0m[35m                y=list(tab.values()),[0m
[30;1m1791 | [0m[35m                name=tab.name,[0m
[30;1m1792 | [0m[35m                mode="markers",[0m
[30;1m1793 | [0m[35m                marker=dict(line=dict(width=1), color=self.get_color_from_palette(idx, n_colors=char[0m
[30;1m1794 | [0m[35m            )[0m
[30;1m1795 | [0m[35m            for idx, tab in enumerate(self.chart_sub_tables)[0m
[30;1m1796 | [0m[35m        ][0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1762 | [0m[35m            yaxis=dict([0m
[30;1m1763 | [0m[35m                title=chart_properties.get("ylabel"),[0m
[30;1m1764 | [0m[35m                type=chart_properties.get("yscale"),[0m
[30;1m1765 | [0m[35m                range=chart_properties.get("range"),[0m
[30;1m1766 | [0m[35m                # dtick=20,[0m
[30;1m1767 | [0m[35m                # ticksuffix=''[0m
[30;1m1768 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1761 | [0m[35m            ),[0m
[30;1m1762 | [0m[35m            yaxis=dict([0m
[30;1m1763 | [0m[35m                title=chart_properties.get("ylabel"),[0m
[30;1m1764 | [0m[35m                type=chart_properties.get("yscale"),[0m
[30;1m1765 | [0m[35m                range=chart_properties.get("range"),[0m
[30;1m1766 | [0m[35m                # dtick=20,[0m
[30;1m1767 | [0m[35m                # ticksuffix=''[0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1760 | [0m[35m                autorange=chart_properties.get("autorange"),[0m
[30;1m1761 | [0m[35m            ),[0m
[30;1m1762 | [0m[35m            yaxis=dict([0m
[30;1m1763 | [0m[35m                title=chart_properties.get("ylabel"),[0m
[30;1m1764 | [0m[35m                type=chart_properties.get("yscale"),[0m
[30;1m1765 | [0m[35m                range=chart_properties.get("range"),[0m
[30;1m1766 | [0m[35m                # dtick=20,[0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1757 | [0m[35m            xaxis=dict([0m
[30;1m1758 | [0m[35m                title=chart_properties.get("xlabel"),[0m
[30;1m1759 | [0m[35m                type=chart_properties.get("xscale"),[0m
[30;1m1760 | [0m[35m                autorange=chart_properties.get("autorange"),[0m
[30;1m1761 | [0m[35m            ),[0m
[30;1m1762 | [0m[35m            yaxis=dict([0m
[30;1m1763 | [0m[35m                title=chart_properties.get("ylabel"),[0m

[31m--[ [0m[34mMatch #[0m[33m232[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1756 | [0m[35m            showlegend=chart_properties.get("showlegend"),[0m
[30;1m1757 | [0m[35m            xaxis=dict([0m
[30;1m1758 | [0m[35m                title=chart_properties.get("xlabel"),[0m
[30;1m1759 | [0m[35m                type=chart_properties.get("xscale"),[0m
[30;1m1760 | [0m[35m                autorange=chart_properties.get("autorange"),[0m
[30;1m1761 | [0m[35m            ),[0m
[30;1m1762 | [0m[35m            yaxis=dict([0m

[31m--[ [0m[34mMatch #[0m[33m233[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1755 | [0m[35m            title=chart_properties.get("title"),[0m
[30;1m1756 | [0m[35m            showlegend=chart_properties.get("showlegend"),[0m
[30;1m1757 | [0m[35m            xaxis=dict([0m
[30;1m1758 | [0m[35m                title=chart_properties.get("xlabel"),[0m
[30;1m1759 | [0m[35m                type=chart_properties.get("xscale"),[0m
[30;1m1760 | [0m[35m                autorange=chart_properties.get("autorange"),[0m
[30;1m1761 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m234[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1753 | [0m[35m        ][0m
[30;1m1754 | [0m[35m        layout = go.Layout([0m
[30;1m1755 | [0m[35m            title=chart_properties.get("title"),[0m
[30;1m1756 | [0m[35m            showlegend=chart_properties.get("showlegend"),[0m
[30;1m1757 | [0m[35m            xaxis=dict([0m
[30;1m1758 | [0m[35m                title=chart_properties.get("xlabel"),[0m
[30;1m1759 | [0m[35m                type=chart_properties.get("xscale"),[0m

[31m--[ [0m[34mMatch #[0m[33m235[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1752 | [0m[35m            for idx, tab in enumerate(self.chart_sub_tables)[0m
[30;1m1753 | [0m[35m        ][0m
[30;1m1754 | [0m[35m        layout = go.Layout([0m
[30;1m1755 | [0m[35m            title=chart_properties.get("title"),[0m
[30;1m1756 | [0m[35m            showlegend=chart_properties.get("showlegend"),[0m
[30;1m1757 | [0m[35m            xaxis=dict([0m
[30;1m1758 | [0m[35m                title=chart_properties.get("xlabel"),[0m

[31m--[ [0m[34mMatch #[0m[33m236[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1746 | [0m[35m                x=list(tab.keys()),[0m
[30;1m1747 | [0m[35m                y=list(tab.values()),[0m
[30;1m1748 | [0m[35m                name=tab.name,[0m
[30;1m1749 | [0m[35m                line=dict(width=1, color=self.get_color_from_palette(idx, n_colors=chart_properties.[0m
[30;1m1750 | [0m[35m                opacity=0.8,[0m
[30;1m1751 | [0m[35m            )[0m
[30;1m1752 | [0m[35m            for idx, tab in enumerate(self.chart_sub_tables)[0m

[31m--[ [0m[34mMatch #[0m[33m237[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1721 | [0m[35m            yaxis=dict([0m
[30;1m1722 | [0m[35m                type=chart_properties.get("yscale"),[0m
[30;1m1723 | [0m[35m                title=chart_properties.get("ylabel"),[0m
[30;1m1724 | [0m[35m                range=chart_properties.get("range") if chart_properties.get("orientation") != "h" el[0m
[30;1m1725 | [0m[35m            ),[0m
[30;1m1726 | [0m[35m        )[0m
[30;1m1727 | [0m[35m        return {"data": data, "layout": layout}[0m

[31m--[ [0m[34mMatch #[0m[33m238[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1721 | [0m[35m            yaxis=dict([0m
[30;1m1722 | [0m[35m                type=chart_properties.get("yscale"),[0m
[30;1m1723 | [0m[35m                title=chart_properties.get("ylabel"),[0m
[30;1m1724 | [0m[35m                range=chart_properties.get("range") if chart_properties.get("orientation") != "h" el[0m
[30;1m1725 | [0m[35m            ),[0m
[30;1m1726 | [0m[35m        )[0m
[30;1m1727 | [0m[35m        return {"data": data, "layout": layout}[0m

[31m--[ [0m[34mMatch #[0m[33m239[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1720 | [0m[35m            ),[0m
[30;1m1721 | [0m[35m            yaxis=dict([0m
[30;1m1722 | [0m[35m                type=chart_properties.get("yscale"),[0m
[30;1m1723 | [0m[35m                title=chart_properties.get("ylabel"),[0m
[30;1m1724 | [0m[35m                range=chart_properties.get("range") if chart_properties.get("orientation") != "h" el[0m
[30;1m1725 | [0m[35m            ),[0m
[30;1m1726 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m240[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1719 | [0m[35m                ticksuffix="",[0m
[30;1m1720 | [0m[35m            ),[0m
[30;1m1721 | [0m[35m            yaxis=dict([0m
[30;1m1722 | [0m[35m                type=chart_properties.get("yscale"),[0m
[30;1m1723 | [0m[35m                title=chart_properties.get("ylabel"),[0m
[30;1m1724 | [0m[35m                range=chart_properties.get("range") if chart_properties.get("orientation") != "h" el[0m
[30;1m1725 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m241[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1714 | [0m[35m            xaxis=dict([0m
[30;1m1715 | [0m[35m                title=chart_properties.get("xlabel"),[0m
[30;1m1716 | [0m[35m                type=chart_properties.get("xscale"),[0m
[30;1m1717 | [0m[35m                range=chart_properties.get("range") if chart_properties.get("orientation") == "h" el[0m
[30;1m1718 | [0m[35m                # dtick=20,[0m
[30;1m1719 | [0m[35m                ticksuffix="",[0m
[30;1m1720 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m242[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1714 | [0m[35m            xaxis=dict([0m
[30;1m1715 | [0m[35m                title=chart_properties.get("xlabel"),[0m
[30;1m1716 | [0m[35m                type=chart_properties.get("xscale"),[0m
[30;1m1717 | [0m[35m                range=chart_properties.get("range") if chart_properties.get("orientation") == "h" el[0m
[30;1m1718 | [0m[35m                # dtick=20,[0m
[30;1m1719 | [0m[35m                ticksuffix="",[0m
[30;1m1720 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m243[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1713 | [0m[35m            showlegend=chart_properties.get("showlegend"),[0m
[30;1m1714 | [0m[35m            xaxis=dict([0m
[30;1m1715 | [0m[35m                title=chart_properties.get("xlabel"),[0m
[30;1m1716 | [0m[35m                type=chart_properties.get("xscale"),[0m
[30;1m1717 | [0m[35m                range=chart_properties.get("range") if chart_properties.get("orientation") == "h" el[0m
[30;1m1718 | [0m[35m                # dtick=20,[0m
[30;1m1719 | [0m[35m                ticksuffix="",[0m

[31m--[ [0m[34mMatch #[0m[33m244[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1712 | [0m[35m            title=chart_properties.get("title"),[0m
[30;1m1713 | [0m[35m            showlegend=chart_properties.get("showlegend"),[0m
[30;1m1714 | [0m[35m            xaxis=dict([0m
[30;1m1715 | [0m[35m                title=chart_properties.get("xlabel"),[0m
[30;1m1716 | [0m[35m                type=chart_properties.get("xscale"),[0m
[30;1m1717 | [0m[35m                range=chart_properties.get("range") if chart_properties.get("orientation") == "h" el[0m
[30;1m1718 | [0m[35m                # dtick=20,[0m

[31m--[ [0m[34mMatch #[0m[33m245[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1710 | [0m[35m        ][0m
[30;1m1711 | [0m[35m        layout = go.Layout([0m
[30;1m1712 | [0m[35m            title=chart_properties.get("title"),[0m
[30;1m1713 | [0m[35m            showlegend=chart_properties.get("showlegend"),[0m
[30;1m1714 | [0m[35m            xaxis=dict([0m
[30;1m1715 | [0m[35m                title=chart_properties.get("xlabel"),[0m
[30;1m1716 | [0m[35m                type=chart_properties.get("xscale"),[0m

[31m--[ [0m[34mMatch #[0m[33m246[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1709 | [0m[35m            for idx, tab in enumerate(sub_tables)[0m
[30;1m1710 | [0m[35m        ][0m
[30;1m1711 | [0m[35m        layout = go.Layout([0m
[30;1m1712 | [0m[35m            title=chart_properties.get("title"),[0m
[30;1m1713 | [0m[35m            showlegend=chart_properties.get("showlegend"),[0m
[30;1m1714 | [0m[35m            xaxis=dict([0m
[30;1m1715 | [0m[35m                title=chart_properties.get("xlabel"),[0m

[31m--[ [0m[34mMatch #[0m[33m247[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1704 | [0m[35m                y=list(tab.keys()) if chart_properties.get("orientation") == "h" else list(tab.value[0m
[30;1m1705 | [0m[35m                marker=dict(color=self.get_color_from_palette(idx, n_colors=chart_properties.get("n_[0m
[30;1m1706 | [0m[35m                name=tab.name,[0m
[30;1m1707 | [0m[35m                orientation=chart_properties.get("orientation"),[0m
[30;1m1708 | [0m[35m            )[0m
[30;1m1709 | [0m[35m            for idx, tab in enumerate(sub_tables)[0m
[30;1m1710 | [0m[35m        ][0m

[31m--[ [0m[34mMatch #[0m[33m248[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1702 | [0m[35m            go.Bar([0m
[30;1m1703 | [0m[35m                x=list(tab.values()) if chart_properties.get("orientation") == "h" else list(tab.key[0m
[30;1m1704 | [0m[35m                y=list(tab.keys()) if chart_properties.get("orientation") == "h" else list(tab.value[0m
[30;1m1705 | [0m[35m                marker=dict(color=self.get_color_from_palette(idx, n_colors=chart_properties.get("n_[0m
[30;1m1706 | [0m[35m                name=tab.name,[0m
[30;1m1707 | [0m[35m                orientation=chart_properties.get("orientation"),[0m
[30;1m1708 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m249[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1701 | [0m[35m        data = [[0m
[30;1m1702 | [0m[35m            go.Bar([0m
[30;1m1703 | [0m[35m                x=list(tab.values()) if chart_properties.get("orientation") == "h" else list(tab.key[0m
[30;1m1704 | [0m[35m                y=list(tab.keys()) if chart_properties.get("orientation") == "h" else list(tab.value[0m
[30;1m1705 | [0m[35m                marker=dict(color=self.get_color_from_palette(idx, n_colors=chart_properties.get("n_[0m
[30;1m1706 | [0m[35m                name=tab.name,[0m
[30;1m1707 | [0m[35m                orientation=chart_properties.get("orientation"),[0m

[31m--[ [0m[34mMatch #[0m[33m250[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1700 | [0m[35m[0m
[30;1m1701 | [0m[35m        data = [[0m
[30;1m1702 | [0m[35m            go.Bar([0m
[30;1m1703 | [0m[35m                x=list(tab.values()) if chart_properties.get("orientation") == "h" else list(tab.key[0m
[30;1m1704 | [0m[35m                y=list(tab.keys()) if chart_properties.get("orientation") == "h" else list(tab.value[0m
[30;1m1705 | [0m[35m                marker=dict(color=self.get_color_from_palette(idx, n_colors=chart_properties.get("n_[0m
[30;1m1706 | [0m[35m                name=tab.name,[0m

[31m--[ [0m[34mMatch #[0m[33m251[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1674 | [0m[35m                    text=tab.name,[0m
[30;1m1675 | [0m[35m                    showarrow=False,[0m
[30;1m1676 | [0m[35m                    x=(domains[idx].get("x")[0] + domains[idx].get("x")[1]) / 2,[0m
[30;1m1677 | [0m[35m                    y=domains[idx].get("y")[0] - 0.05 * ydelta,[0m
[30;1m1678 | [0m[35m                )[0m
[30;1m1679 | [0m[35m                for idx, tab in enumerate(self.chart_sub_tables)[0m
[30;1m1680 | [0m[35m            ],[0m

[31m--[ [0m[34mMatch #[0m[33m252[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1673 | [0m[35m                dict([0m
[30;1m1674 | [0m[35m                    text=tab.name,[0m
[30;1m1675 | [0m[35m                    showarrow=False,[0m
[30;1m1676 | [0m[35m                    x=(domains[idx].get("x")[0] + domains[idx].get("x")[1]) / 2,[0m
[30;1m1677 | [0m[35m                    y=domains[idx].get("y")[0] - 0.05 * ydelta,[0m
[30;1m1678 | [0m[35m                )[0m
[30;1m1679 | [0m[35m                for idx, tab in enumerate(self.chart_sub_tables)[0m

[31m--[ [0m[34mMatch #[0m[33m253[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1673 | [0m[35m                dict([0m
[30;1m1674 | [0m[35m                    text=tab.name,[0m
[30;1m1675 | [0m[35m                    showarrow=False,[0m
[30;1m1676 | [0m[35m                    x=(domains[idx].get("x")[0] + domains[idx].get("x")[1]) / 2,[0m
[30;1m1677 | [0m[35m                    y=domains[idx].get("y")[0] - 0.05 * ydelta,[0m
[30;1m1678 | [0m[35m                )[0m
[30;1m1679 | [0m[35m                for idx, tab in enumerate(self.chart_sub_tables)[0m

[31m--[ [0m[34mMatch #[0m[33m254[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1653 | [0m[35m[0m
[30;1m1654 | [0m[35m        palette = self._get_palette(n_colors=n_colors)[0m
[30;1m1655 | [0m[35m        show_legend = properties.get(VisualizationKeys.LEGEND) != VisualizationLegends.HIDDEN[0m
[30;1m1656 | [0m[35m        title = properties.get(VisualizationKeys.TITLE) or VisualizationValues.PIE_CHART[0m
[30;1m1657 | [0m[35m[0m
[30;1m1658 | [0m[35m        data = [[0m
[30;1m1659 | [0m[35m            go.Pie([0m

[31m--[ [0m[34mMatch #[0m[33m255[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1652 | [0m[35m        ][0m
[30;1m1653 | [0m[35m[0m
[30;1m1654 | [0m[35m        palette = self._get_palette(n_colors=n_colors)[0m
[30;1m1655 | [0m[35m        show_legend = properties.get(VisualizationKeys.LEGEND) != VisualizationLegends.HIDDEN[0m
[30;1m1656 | [0m[35m        title = properties.get(VisualizationKeys.TITLE) or VisualizationValues.PIE_CHART[0m
[30;1m1657 | [0m[35m[0m
[30;1m1658 | [0m[35m        data = [[0m

[31m--[ [0m[34mMatch #[0m[33m256[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1609 | [0m[35m            yaxis=dict([0m
[30;1m1610 | [0m[35m                title=chart_properties.get("ylabel"),[0m
[30;1m1611 | [0m[35m                type=chart_properties.get("yscale"),[0m
[30;1m1612 | [0m[35m                range=chart_properties.get("range"),[0m
[30;1m1613 | [0m[35m                # dtick=20,[0m
[30;1m1614 | [0m[35m                ticksuffix="",[0m
[30;1m1615 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m257[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1608 | [0m[35m            ),[0m
[30;1m1609 | [0m[35m            yaxis=dict([0m
[30;1m1610 | [0m[35m                title=chart_properties.get("ylabel"),[0m
[30;1m1611 | [0m[35m                type=chart_properties.get("yscale"),[0m
[30;1m1612 | [0m[35m                range=chart_properties.get("range"),[0m
[30;1m1613 | [0m[35m                # dtick=20,[0m
[30;1m1614 | [0m[35m                ticksuffix="",[0m

[31m--[ [0m[34mMatch #[0m[33m258[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1607 | [0m[35m                autorange=chart_properties.get("autorange"),[0m
[30;1m1608 | [0m[35m            ),[0m
[30;1m1609 | [0m[35m            yaxis=dict([0m
[30;1m1610 | [0m[35m                title=chart_properties.get("ylabel"),[0m
[30;1m1611 | [0m[35m                type=chart_properties.get("yscale"),[0m
[30;1m1612 | [0m[35m                range=chart_properties.get("range"),[0m
[30;1m1613 | [0m[35m                # dtick=20,[0m

[31m--[ [0m[34mMatch #[0m[33m259[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1604 | [0m[35m                rangeslider=dict(),[0m
[30;1m1605 | [0m[35m                title=chart_properties.get("xlabel"),[0m
[30;1m1606 | [0m[35m                type=chart_properties.get("xscale"),[0m
[30;1m1607 | [0m[35m                autorange=chart_properties.get("autorange"),[0m
[30;1m1608 | [0m[35m            ),[0m
[30;1m1609 | [0m[35m            yaxis=dict([0m
[30;1m1610 | [0m[35m                title=chart_properties.get("ylabel"),[0m

[31m--[ [0m[34mMatch #[0m[33m260[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1603 | [0m[35m                ),[0m
[30;1m1604 | [0m[35m                rangeslider=dict(),[0m
[30;1m1605 | [0m[35m                title=chart_properties.get("xlabel"),[0m
[30;1m1606 | [0m[35m                type=chart_properties.get("xscale"),[0m
[30;1m1607 | [0m[35m                autorange=chart_properties.get("autorange"),[0m
[30;1m1608 | [0m[35m            ),[0m
[30;1m1609 | [0m[35m            yaxis=dict([0m

[31m--[ [0m[34mMatch #[0m[33m261[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1602 | [0m[35m                    )[0m
[30;1m1603 | [0m[35m                ),[0m
[30;1m1604 | [0m[35m                rangeslider=dict(),[0m
[30;1m1605 | [0m[35m                title=chart_properties.get("xlabel"),[0m
[30;1m1606 | [0m[35m                type=chart_properties.get("xscale"),[0m
[30;1m1607 | [0m[35m                autorange=chart_properties.get("autorange"),[0m
[30;1m1608 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m262[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1590 | [0m[35m[0m
[30;1m1591 | [0m[35m        layout = go.Layout([0m
[30;1m1592 | [0m[35m            title=chart_properties.get("title"),[0m
[30;1m1593 | [0m[35m            showlegend=chart_properties.get("showlegend"),[0m
[30;1m1594 | [0m[35m            xaxis=dict([0m
[30;1m1595 | [0m[35m                rangeselector=dict([0m
[30;1m1596 | [0m[35m                    buttons=list([0m

[31m--[ [0m[34mMatch #[0m[33m263[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1589 | [0m[35m        ][0m
[30;1m1590 | [0m[35m[0m
[30;1m1591 | [0m[35m        layout = go.Layout([0m
[30;1m1592 | [0m[35m            title=chart_properties.get("title"),[0m
[30;1m1593 | [0m[35m            showlegend=chart_properties.get("showlegend"),[0m
[30;1m1594 | [0m[35m            xaxis=dict([0m
[30;1m1595 | [0m[35m                rangeselector=dict([0m

[31m--[ [0m[34mMatch #[0m[33m264[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1582 | [0m[35m                x=list(tab.keys()),[0m
[30;1m1583 | [0m[35m                y=list(tab.values()),[0m
[30;1m1584 | [0m[35m                name=tab.name,[0m
[30;1m1585 | [0m[35m                line=dict(width=1, color=self.get_color_from_palette(idx, n_colors=chart_properties.[0m
[30;1m1586 | [0m[35m                opacity=0.8,[0m
[30;1m1587 | [0m[35m            )[0m
[30;1m1588 | [0m[35m            for idx, tab in enumerate(self.chart_sub_tables)[0m

[31m--[ [0m[34mMatch #[0m[33m265[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1555 | [0m[35m            yaxis=dict([0m
[30;1m1556 | [0m[35m                title=chart_properties.get("ylabel"),[0m
[30;1m1557 | [0m[35m                type=chart_properties.get("yscale"),[0m
[30;1m1558 | [0m[35m                range=chart_properties.get("range"),[0m
[30;1m1559 | [0m[35m                # dtick=20,[0m
[30;1m1560 | [0m[35m                ticksuffix="",[0m
[30;1m1561 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m266[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1554 | [0m[35m            ),[0m
[30;1m1555 | [0m[35m            yaxis=dict([0m
[30;1m1556 | [0m[35m                title=chart_properties.get("ylabel"),[0m
[30;1m1557 | [0m[35m                type=chart_properties.get("yscale"),[0m
[30;1m1558 | [0m[35m                range=chart_properties.get("range"),[0m
[30;1m1559 | [0m[35m                # dtick=20,[0m
[30;1m1560 | [0m[35m                ticksuffix="",[0m

[31m--[ [0m[34mMatch #[0m[33m267[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1553 | [0m[35m                autorange=chart_properties.get("autorange"),[0m
[30;1m1554 | [0m[35m            ),[0m
[30;1m1555 | [0m[35m            yaxis=dict([0m
[30;1m1556 | [0m[35m                title=chart_properties.get("ylabel"),[0m
[30;1m1557 | [0m[35m                type=chart_properties.get("yscale"),[0m
[30;1m1558 | [0m[35m                range=chart_properties.get("range"),[0m
[30;1m1559 | [0m[35m                # dtick=20,[0m

[31m--[ [0m[34mMatch #[0m[33m268[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1550 | [0m[35m            xaxis=dict([0m
[30;1m1551 | [0m[35m                title=chart_properties.get("xlabel"), [0m
[30;1m1552 | [0m[35m                type=chart_properties.get("xscale"),[0m
[30;1m1553 | [0m[35m                autorange=chart_properties.get("autorange"),[0m
[30;1m1554 | [0m[35m            ),[0m
[30;1m1555 | [0m[35m            yaxis=dict([0m
[30;1m1556 | [0m[35m                title=chart_properties.get("ylabel"),[0m

[31m--[ [0m[34mMatch #[0m[33m269[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1549 | [0m[35m            showlegend=chart_properties.get("showlegend"),[0m
[30;1m1550 | [0m[35m            xaxis=dict([0m
[30;1m1551 | [0m[35m                title=chart_properties.get("xlabel"), [0m
[30;1m1552 | [0m[35m                type=chart_properties.get("xscale"),[0m
[30;1m1553 | [0m[35m                autorange=chart_properties.get("autorange"),[0m
[30;1m1554 | [0m[35m            ),[0m
[30;1m1555 | [0m[35m            yaxis=dict([0m

[31m--[ [0m[34mMatch #[0m[33m270[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1548 | [0m[35m            title=chart_properties.get("title"),[0m
[30;1m1549 | [0m[35m            showlegend=chart_properties.get("showlegend"),[0m
[30;1m1550 | [0m[35m            xaxis=dict([0m
[30;1m1551 | [0m[35m                title=chart_properties.get("xlabel"), [0m
[30;1m1552 | [0m[35m                type=chart_properties.get("xscale"),[0m
[30;1m1553 | [0m[35m                autorange=chart_properties.get("autorange"),[0m
[30;1m1554 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m271[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1546 | [0m[35m        ][0m
[30;1m1547 | [0m[35m        layout = go.Layout([0m
[30;1m1548 | [0m[35m            title=chart_properties.get("title"),[0m
[30;1m1549 | [0m[35m            showlegend=chart_properties.get("showlegend"),[0m
[30;1m1550 | [0m[35m            xaxis=dict([0m
[30;1m1551 | [0m[35m                title=chart_properties.get("xlabel"), [0m
[30;1m1552 | [0m[35m                type=chart_properties.get("xscale"),[0m

[31m--[ [0m[34mMatch #[0m[33m272[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1545 | [0m[35m            for idx, tab in enumerate(self.chart_sub_tables)[0m
[30;1m1546 | [0m[35m        ][0m
[30;1m1547 | [0m[35m        layout = go.Layout([0m
[30;1m1548 | [0m[35m            title=chart_properties.get("title"),[0m
[30;1m1549 | [0m[35m            showlegend=chart_properties.get("showlegend"),[0m
[30;1m1550 | [0m[35m            xaxis=dict([0m
[30;1m1551 | [0m[35m                title=chart_properties.get("xlabel"), [0m

[31m--[ [0m[34mMatch #[0m[33m273[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1539 | [0m[35m                y=ys_stcks[idx],[0m
[30;1m1540 | [0m[35m                name=tab.name,[0m
[30;1m1541 | [0m[35m                mode="lines",[0m
[30;1m1542 | [0m[35m                line=dict(width=0.5, color=self.get_color_from_palette(idx, n_colors=chart_propertie[0m
[30;1m1543 | [0m[35m                fill="tonexty",[0m
[30;1m1544 | [0m[35m            )[0m
[30;1m1545 | [0m[35m            for idx, tab in enumerate(self.chart_sub_tables)[0m

[31m--[ [0m[34mMatch #[0m[33m274[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1503 | [0m[35m            yaxis=dict([0m
[30;1m1504 | [0m[35m                title=chart_properties.get("ylabel"),[0m
[30;1m1505 | [0m[35m                type=chart_properties.get("yscale"),[0m
[30;1m1506 | [0m[35m                range=chart_properties.get("range"),[0m
[30;1m1507 | [0m[35m                # dtick=20,[0m
[30;1m1508 | [0m[35m                ticksuffix="",[0m
[30;1m1509 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m275[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1502 | [0m[35m            ),[0m
[30;1m1503 | [0m[35m            yaxis=dict([0m
[30;1m1504 | [0m[35m                title=chart_properties.get("ylabel"),[0m
[30;1m1505 | [0m[35m                type=chart_properties.get("yscale"),[0m
[30;1m1506 | [0m[35m                range=chart_properties.get("range"),[0m
[30;1m1507 | [0m[35m                # dtick=20,[0m
[30;1m1508 | [0m[35m                ticksuffix="",[0m

[31m--[ [0m[34mMatch #[0m[33m276[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1501 | [0m[35m                autorange=chart_properties.get("autorange"),[0m
[30;1m1502 | [0m[35m            ),[0m
[30;1m1503 | [0m[35m            yaxis=dict([0m
[30;1m1504 | [0m[35m                title=chart_properties.get("ylabel"),[0m
[30;1m1505 | [0m[35m                type=chart_properties.get("yscale"),[0m
[30;1m1506 | [0m[35m                range=chart_properties.get("range"),[0m
[30;1m1507 | [0m[35m                # dtick=20,[0m

[31m--[ [0m[34mMatch #[0m[33m277[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1498 | [0m[35m            xaxis=dict([0m
[30;1m1499 | [0m[35m                title=chart_properties.get("xlabel"), [0m
[30;1m1500 | [0m[35m                type=chart_properties.get("xscale"),[0m
[30;1m1501 | [0m[35m                autorange=chart_properties.get("autorange"),[0m
[30;1m1502 | [0m[35m            ),[0m
[30;1m1503 | [0m[35m            yaxis=dict([0m
[30;1m1504 | [0m[35m                title=chart_properties.get("ylabel"),[0m

[31m--[ [0m[34mMatch #[0m[33m278[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1497 | [0m[35m            showlegend=chart_properties.get("showlegend"),[0m
[30;1m1498 | [0m[35m            xaxis=dict([0m
[30;1m1499 | [0m[35m                title=chart_properties.get("xlabel"), [0m
[30;1m1500 | [0m[35m                type=chart_properties.get("xscale"),[0m
[30;1m1501 | [0m[35m                autorange=chart_properties.get("autorange"),[0m
[30;1m1502 | [0m[35m            ),[0m
[30;1m1503 | [0m[35m            yaxis=dict([0m

[31m--[ [0m[34mMatch #[0m[33m279[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1496 | [0m[35m            title=chart_properties.get("title"),[0m
[30;1m1497 | [0m[35m            showlegend=chart_properties.get("showlegend"),[0m
[30;1m1498 | [0m[35m            xaxis=dict([0m
[30;1m1499 | [0m[35m                title=chart_properties.get("xlabel"), [0m
[30;1m1500 | [0m[35m                type=chart_properties.get("xscale"),[0m
[30;1m1501 | [0m[35m                autorange=chart_properties.get("autorange"),[0m
[30;1m1502 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m280[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1494 | [0m[35m        ][0m
[30;1m1495 | [0m[35m        layout = go.Layout([0m
[30;1m1496 | [0m[35m            title=chart_properties.get("title"),[0m
[30;1m1497 | [0m[35m            showlegend=chart_properties.get("showlegend"),[0m
[30;1m1498 | [0m[35m            xaxis=dict([0m
[30;1m1499 | [0m[35m                title=chart_properties.get("xlabel"), [0m
[30;1m1500 | [0m[35m                type=chart_properties.get("xscale"),[0m

[31m--[ [0m[34mMatch #[0m[33m281[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1493 | [0m[35m            for idx, tab in enumerate(self.chart_sub_tables)[0m
[30;1m1494 | [0m[35m        ][0m
[30;1m1495 | [0m[35m        layout = go.Layout([0m
[30;1m1496 | [0m[35m            title=chart_properties.get("title"),[0m
[30;1m1497 | [0m[35m            showlegend=chart_properties.get("showlegend"),[0m
[30;1m1498 | [0m[35m            xaxis=dict([0m
[30;1m1499 | [0m[35m                title=chart_properties.get("xlabel"), [0m

[31m--[ [0m[34mMatch #[0m[33m282[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1487 | [0m[35m                y=list(tab.values()),[0m
[30;1m1488 | [0m[35m                name=tab.name,[0m
[30;1m1489 | [0m[35m                mode="lines",[0m
[30;1m1490 | [0m[35m                line=dict(width=0.5, color=self.get_color_from_palette(idx, n_colors=chart_propertie[0m
[30;1m1491 | [0m[35m                fill="tozeroy",[0m
[30;1m1492 | [0m[35m            )[0m
[30;1m1493 | [0m[35m            for idx, tab in enumerate(self.chart_sub_tables)[0m

[31m--[ [0m[34mMatch #[0m[33m283[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1456 | [0m[35m                layout[property] = plotly_layout.get(property)[0m
[30;1m1457 | [0m[35m[0m
[30;1m1458 | [0m[35m        go = Dependencies.get_module('plotly.graph_objs')[0m
[30;1m1459 | [0m[35m        if IPythonAPI.is_ipywidgets_installed() and options.get("plot_package") == "plotly_widget" a[0m
[30;1m1460 | [0m[35m            # print("----------- FigureWidget --------------")[0m
[30;1m1461 | [0m[35m[0m
[30;1m1462 | [0m[35m            fig = go.FigureWidget(data=data, layout=layout)[0m

[31m--[ [0m[34mMatch #[0m[33m284[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1453 | [0m[35m        plotly_layout = options.get("plotly_layout")[0m
[30;1m1454 | [0m[35m        if plotly_layout is not None:[0m
[30;1m1455 | [0m[35m            for property in plotly_layout:[0m
[30;1m1456 | [0m[35m                layout[property] = plotly_layout.get(property)[0m
[30;1m1457 | [0m[35m[0m
[30;1m1458 | [0m[35m        go = Dependencies.get_module('plotly.graph_objs')[0m
[30;1m1459 | [0m[35m        if IPythonAPI.is_ipywidgets_installed() and options.get("plot_package") == "plotly_widget" a[0m

[31m--[ [0m[34mMatch #[0m[33m285[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1450 | [0m[35m[0m
[30;1m1451 | [0m[35m    def _figure_or_figurewidget(self, data, layout:Dict[str,Any], window_mode:bool, options:dict=Non[0m
[30;1m1452 | [0m[35m        options = options or {}[0m
[30;1m1453 | [0m[35m        plotly_layout = options.get("plotly_layout")[0m
[30;1m1454 | [0m[35m        if plotly_layout is not None:[0m
[30;1m1455 | [0m[35m            for property in plotly_layout:[0m
[30;1m1456 | [0m[35m                layout[property] = plotly_layout.get(property)[0m

[31m--[ [0m[34mMatch #[0m[33m286[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1441 | [0m[35m            chart_properties["orientation"] = "v"[0m
[30;1m1442 | [0m[35m        chart_properties["autorange"] = "reversed" if tabs[0].is_descending_sorted else True[0m
[30;1m1443 | [0m[35m        chart_properties["showlegend"] = properties.get(VisualizationKeys.LEGEND) != VisualizationLe[0m
[30;1m1444 | [0m[35m        chart_properties["title"] = properties.get(VisualizationKeys.TITLE) or properties.get(Visual[0m
[30;1m1445 | [0m[35m        chart_properties["n_colors"] = len(tabs)[0m
[30;1m1446 | [0m[35m        if tabs[0].col_y_min is not None and tabs[0].col_y_max is not None:[0m
[30;1m1447 | [0m[35m            chart_properties["range"] = [tabs[0].col_y_min, tabs[0].col_y_max][0m

[31m--[ [0m[34mMatch #[0m[33m287[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1441 | [0m[35m            chart_properties["orientation"] = "v"[0m
[30;1m1442 | [0m[35m        chart_properties["autorange"] = "reversed" if tabs[0].is_descending_sorted else True[0m
[30;1m1443 | [0m[35m        chart_properties["showlegend"] = properties.get(VisualizationKeys.LEGEND) != VisualizationLe[0m
[30;1m1444 | [0m[35m        chart_properties["title"] = properties.get(VisualizationKeys.TITLE) or properties.get(Visual[0m
[30;1m1445 | [0m[35m        chart_properties["n_colors"] = len(tabs)[0m
[30;1m1446 | [0m[35m        if tabs[0].col_y_min is not None and tabs[0].col_y_max is not None:[0m
[30;1m1447 | [0m[35m            chart_properties["range"] = [tabs[0].col_y_min, tabs[0].col_y_max][0m

[31m--[ [0m[34mMatch #[0m[33m288[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1440 | [0m[35m    chart_properties["yscale"] = self._get_plotly_axis_scale(properties.get(VisualizationKeys.Y_AXIS[0m
[30;1m1441 | [0m[35m            chart_properties["orientation"] = "v"[0m
[30;1m1442 | [0m[35m        chart_properties["autorange"] = "reversed" if tabs[0].is_descending_sorted else True[0m
[30;1m1443 | [0m[35m        chart_properties["showlegend"] = properties.get(VisualizationKeys.LEGEND) != VisualizationLe[0m
[30;1m1444 | [0m[35m        chart_properties["title"] = properties.get(VisualizationKeys.TITLE) or properties.get(Visual[0m
[30;1m1445 | [0m[35m        chart_properties["n_colors"] = len(tabs)[0m

[31m--[ [0m[34mMatch #[0m[33m289[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1438 | [0m[35mchart_properties["xlabel"] = properties.get(VisualizationKeys.X_TITLE) or tabs[0].col_x.name[0m
[30;1m1439 | [0m[35m            chart_properties["xscale"] = self._get_plotly_axis_scale(properties.get(VisualizationKey[0m
[30;1m1440 | [0m[35m            chart_properties["yscale"] = self._get_plotly_axis_scale(properties.get(VisualizationKey[0m
[30;1m1441 | [0m[35m            chart_properties["orientation"] = "v"[0m
[30;1m1442 | [0m[35m        chart_properties["autorange"] = "reversed" if tabs[0].is_descending_sorted else True[0m
[30;1m1443 | [0m[35m        chart_properties["showlegend"] = properties.get(VisualizationKeys.LEGEND) != VisualizationLe[0m

[31m--[ [0m[34mMatch #[0m[33m290[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1437 | [0m[35m            chart_properties["ylabel"] = self._get_plotly_ylabel(properties.get(VisualizationKeys.Y_[0m
[30;1m1438 | [0m[35m            chart_properties["xlabel"] = properties.get(VisualizationKeys.X_TITLE) or tabs[0].col_x.[0m
[30;1m1439 | [0m[35m            chart_properties["xscale"] = self._get_plotly_axis_scale(properties.get(VisualizationKey[0m
[30;1m1440 | [0m[35m            chart_properties["yscale"] = self._get_plotly_axis_scale(properties.get(VisualizationKey[0m
[30;1m1441 | [0m[35m            chart_properties["orientation"] = "v"[0m
[30;1m1442 | [0m[35m        chart_properties["autorange"] = "reversed" if tabs[0].is_descending_sorted else True[0m

[31m--[ [0m[34mMatch #[0m[33m291[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1435 | [0m[35m            chart_properties["orientation"] = "h"[0m
[30;1m1436 | [0m[35m        else:[0m
[30;1m1437 | [0m[35m            chart_properties["ylabel"] = self._get_plotly_ylabel(properties.get(VisualizationKeys.Y_[0m
[30;1m1438 | [0m[35m            chart_properties["xlabel"] = properties.get(VisualizationKeys.X_TITLE) or tabs[0].col_x.[0m
[30;1m1439 | [0m[35m            chart_properties["xscale"] = self._get_plotly_axis_scale(properties.get(VisualizationKey[0m
[30;1m1440 | [0m[35m            chart_properties["yscale"] = self._get_plotly_axis_scale(properties.get(VisualizationKey[0m
[30;1m1441 | [0m[35m            chart_properties["orientation"] = "v"[0m

[31m--[ [0m[34mMatch #[0m[33m292[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1433 | [0m[35mget(VisualizationKeys.Y_AXIS), tabs[0].col_x)[0m
[30;1m1434 | [0m[35m            chart_properties["xscale"] = self._get_plotly_axis_scale(properties.get(VisualizationKey[0m
[30;1m1435 | [0m[35m            chart_properties["orientation"] = "h"[0m
[30;1m1436 | [0m[35m        else:[0m
[30;1m1437 | [0m[35m            chart_properties["ylabel"] = self._get_plotly_ylabel(properties.get(VisualizationKeys.Y_[0m
[30;1m1438 | [0m[35m            chart_properties["xlabel"] = properties.get(VisualizationKeys.X_TITLE) or tabs[0].col_x.[0m
[30;1m1439 | [0m[35m            chart_properties["xscale"] = self._get_plotly_axis_scale(properties.get(VisualizationKey[0m

[31m--[ [0m[34mMatch #[0m[33m293[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1432 | [0m[35mchart_properties["ylabel"] = properties.get(VisualizationKeys.Y_TITLE) or tabs[0].col_x.name[0m
[30;1m1433 | [0m[35m            chart_properties["yscale"] = self._get_plotly_axis_scale(properties.get(VisualizationKey[0m
[30;1m1434 | [0m[35m            chart_properties["xscale"] = self._get_plotly_axis_scale(properties.get(VisualizationKey[0m
[30;1m1435 | [0m[35m            chart_properties["orientation"] = "h"[0m
[30;1m1436 | [0m[35m        else:[0m
[30;1m1437 | [0m[35m            chart_properties["ylabel"] = self._get_plotly_ylabel(properties.get(VisualizationKeys.Y_[0m

[31m--[ [0m[34mMatch #[0m[33m294[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1431 | [0m[35m            chart_properties["xlabel"] = self._get_plotly_ylabel(properties.get(VisualizationKeys.X_[0m
[30;1m1432 | [0m[35m            chart_properties["ylabel"] = properties.get(VisualizationKeys.Y_TITLE) or tabs[0].col_x.[0m
[30;1m1433 | [0m[35m            chart_properties["yscale"] = self._get_plotly_axis_scale(properties.get(VisualizationKey[0m
[30;1m1434 | [0m[35m            chart_properties["xscale"] = self._get_plotly_axis_scale(properties.get(VisualizationKey[0m
[30;1m1435 | [0m[35m            chart_properties["orientation"] = "h"[0m
[30;1m1436 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m295[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1428 | [0m[35ms or {}[0m
[30;1m1429 | [0m[35m        chart_properties = {}[0m
[30;1m1430 | [0m[35m        if properties.get(VisualizationKeys.VISUALIZATION) == VisualizationValues.BAR_CHART:[0m
[30;1m1431 | [0m[35m            chart_properties["xlabel"] = self._get_plotly_ylabel(properties.get(VisualizationKeys.X_[0m
[30;1m1432 | [0m[35m            chart_properties["ylabel"] = properties.get(VisualizationKeys.Y_TITLE) or tabs[0].col_x.[0m
[30;1m1433 | [0m[35m            chart_properties["yscale"] = self._get_plotly_axis_scale(properties.get(VisualizationKey[0m
[30;1m1434 | [0m[35m            chart_properties["xscale"] = self._get_plotly_axis_scale(properties.get(VisualizationKey[0m

[31m--[ [0m[34mMatch #[0m[33m296[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1427 | [0m[35mstr,Any], tabs: list, options:Dict[str,Any]=None)->Dict[str,Any]:[0m
[30;1m1428 | [0m[35m        options = options or {}[0m
[30;1m1429 | [0m[35m        chart_properties = {}[0m
[30;1m1430 | [0m[35m        if properties.get(VisualizationKeys.VISUALIZATION) == VisualizationValues.BAR_CHART:[0m
[30;1m1431 | [0m[35m            chart_properties["xlabel"] = self._get_plotly_ylabel(properties.get(VisualizationKeys.X_[0m
[30;1m1432 | [0m[35m            chart_properties["ylabel"] = properties.get(VisualizationKeys.Y_TITLE) or tabs[0].col_x.[0m
[30;1m1433 | [0m[35m            chart_properties["yscale"] = self._get_plotly_axis_scale(properties.get(VisualizationKey[0m

[31m--[ [0m[34mMatch #[0m[33m297[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1424 | [0m[35melf._CHART_X_TYPE.get(properties.get(VisualizationKeys.VISUALIZATION), "first")[0m
[30;1m1425 | [0m[35m    [0m
[30;1m1426 | [0m[35m[0m
[30;1m1427 | [0m[35m    def _get_plotly_chart_properties(self, properties:Dict[str,Any], tabs: list, options:Dict[str,An[0m
[30;1m1428 | [0m[35m        options = options or {}[0m
[30;1m1429 | [0m[35m        chart_properties = {}[0m
[30;1m1430 | [0m[35m        if properties.get(VisualizationKeys.VISUALIZATION) == VisualizationValues.BAR_CHART:[0m
[30;1m1431 | [0m[35m            chart_properties["xlabel"] = self._get_plotly_ylabel(properties.get(VisualizationKeys.X_[0m
[30;1m1432 | [0m[35m            chart_properties["ylabel"] = properties.get(VisualizationKeys.Y_TITLE) or tabs[0].col_x.[0m

[31m--[ [0m[34mMatch #[0m[33m298[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1421 | [0m[35m[0m
[30;1m1422 | [0m[35m[0m
[30;1m1423 | [0m[35m    def _get_plotly_chart_x_type(self, properties:Dict[str,Any])->str:[0m
[30;1m1424 | [0m[35m        return self._CHART_X_TYPE.get(properties.get(VisualizationKeys.VISUALIZATION), "first")[0m
[30;1m1425 | [0m[35m    [0m
[30;1m1426 | [0m[35m[0m
[30;1m1427 | [0m[35m    def _get_plotly_chart_properties(self, properties:Dict[str,Any], tabs: list, options:Dict[str,An[0m

[31m--[ [0m[34mMatch #[0m[33m299[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1421 | [0m[35m[0m
[30;1m1422 | [0m[35m[0m
[30;1m1423 | [0m[35m    def _get_plotly_chart_x_type(self, properties:Dict[str,Any])->str:[0m
[30;1m1424 | [0m[35m        return self._CHART_X_TYPE.get(properties.get(VisualizationKeys.VISUALIZATION), "first")[0m
[30;1m1425 | [0m[35m    [0m
[30;1m1426 | [0m[35m[0m
[30;1m1427 | [0m[35m    def _get_plotly_chart_properties(self, properties:Dict[str,Any], tabs: list, options:Dict[str,An[0m

[31m--[ [0m[34mMatch #[0m[33m300[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1376 | [0m[35m[0m
[30;1m1377 | [0m[35m        coords = functools.reduce(operator.add, [(x, y) for y in ys])[0m
[30;1m1378 | [0m[35m        plot = plt.plot(*coords, **kwargs)[0m
[30;1m1379 | [0m[35m        plt.title(properties.get(VisualizationKeys.TITLE) or ylabel)[0m
[30;1m1380 | [0m[35m        plt.xlabel(xlabel)[0m
[30;1m1381 | [0m[35m        plt.ylabel(ylabel)[0m
[30;1m1382 | [0m[35m        plt.show()[0m

[31m--[ [0m[34mMatch #[0m[33m301[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1339 | [0m[35m        plt.xticks(range(len(self.columns[0])), self.columns[0], rotation=45)[0m
[30;1m1340 | [0m[35m        plt.xlabel(xlabel)[0m
[30;1m1341 | [0m[35m        plt.ylabel(ylabel)[0m
[30;1m1342 | [0m[35m        plt.title(properties.get(VisualizationKeys.TITLE) or ylabel)[0m
[30;1m1343 | [0m[35m[0m
[30;1m1344 | [0m[35m        plt.show()[0m
[30;1m1345 | [0m[35m        return columnchart[0m

[31m--[ [0m[34mMatch #[0m[33m302[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1292 | [0m[35m        plt.yticks(range(len(self.columns[0])), self.columns[0], rotation=0)[0m
[30;1m1293 | [0m[35m        plt.ylabel(xlabel)[0m
[30;1m1294 | [0m[35m        plt.xlabel(ylabel)[0m
[30;1m1295 | [0m[35m        plt.title(properties.get(VisualizationKeys.TITLE) or ylabel)[0m
[30;1m1296 | [0m[35m[0m
[30;1m1297 | [0m[35m        plt.show()[0m
[30;1m1298 | [0m[35m        return barchart[0m

[31m--[ [0m[34mMatch #[0m[33m303[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1244 | [0m[35m        self.build_columns()[0m
[30;1m1245 | [0m[35m[0m
[30;1m1246 | [0m[35m        pie = plt.pie(self.columns[1], labels=self.columns[0], **kwargs)[0m
[30;1m1247 | [0m[35m        plt.title(properties.get(VisualizationKeys.TITLE) or self.columns[1].name)[0m
[30;1m1248 | [0m[35m        plt.show()[0m
[30;1m1249 | [0m[35m        return pie[0m
[30;1m1250 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m304[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1202 | [0m[35m            return None  # no results[0m
[30;1m1203 | [0m[35m        if filename:[0m
[30;1m1204 | [0m[35m            filename = adjust_path(filename)[0m
[30;1m1205 | [0m[35m            encoding = kwargs.get("encoding", "utf-8")[0m
[30;1m1206 | [0m[35m            outfile = open(filename, "w", newline="", encoding=encoding)[0m
[30;1m1207 | [0m[35m        else:[0m
[30;1m1208 | [0m[35m            outfile = io.StringIO()[0m

[31m--[ [0m[34mMatch #[0m[33m305[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1159 | [0m[35m        if hasattr(self.x, "name"):[0m
[30;1m1160 | [0m[35m            plt.xlabel(self.x.name)[0m
[30;1m1161 | [0m[35m        ylabel = ", ".join(y.name for y in self.ys)[0m
[30;1m1162 | [0m[35m        plt.title(properties.get(VisualizationKeys.TITLE) or ylabel)[0m
[30;1m1163 | [0m[35m        plt.ylabel(ylabel)[0m
[30;1m1164 | [0m[35m        return plot[0m
[30;1m1165 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m306[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1127 | [0m[35m        self.build_columns()[0m
[30;1m1128 | [0m[35m[0m
[30;1m1129 | [0m[35m        pie = plt.pie(self.columns[1], labels=self.columns[0], **kwargs)[0m
[30;1m1130 | [0m[35m        plt.title(properties.get(VisualizationKeys.TITLE) or self.columns[1].name)[0m
[30;1m1131 | [0m[35m        plt.show()[0m
[30;1m1132 | [0m[35m        return pie[0m
[30;1m1133 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m307[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1079 | [0m[35m            else:[0m
[30;1m1080 | [0m[35m                plotly = Dependencies.get_module('plotly')[0m
[30;1m1081 | [0m[35m                return plotly.io.to_image([0m
[30;1m1082 | [0m[35m                    fig, format=options.get("format"), scale=options.get("scale"), width=options.get[0m
[30;1m1083 | [0m[35m                )[0m
[30;1m1084 | [0m[35m        except: # pylint: disable=bare-except[0m
[30;1m1085 | [0m[35m            # display image with 'orca is missing'[0m

[31m--[ [0m[34mMatch #[0m[33m308[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1079 | [0m[35m            else:[0m
[30;1m1080 | [0m[35m                plotly = Dependencies.get_module('plotly')[0m
[30;1m1081 | [0m[35m                return plotly.io.to_image([0m
[30;1m1082 | [0m[35m                    fig, format=options.get("format"), scale=options.get("scale"), width=options.get[0m
[30;1m1083 | [0m[35m                )[0m
[30;1m1084 | [0m[35m        except: # pylint: disable=bare-except[0m
[30;1m1085 | [0m[35m            # display image with 'orca is missing'[0m

[31m--[ [0m[34mMatch #[0m[33m309[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1079 | [0m[35m            else:[0m
[30;1m1080 | [0m[35m                plotly = Dependencies.get_module('plotly')[0m
[30;1m1081 | [0m[35m                return plotly.io.to_image([0m
[30;1m1082 | [0m[35m                    fig, format=options.get("format"), scale=options.get("scale"), width=options.get[0m
[30;1m1083 | [0m[35m                )[0m
[30;1m1084 | [0m[35m        except: # pylint: disable=bare-except[0m
[30;1m1085 | [0m[35m            # display image with 'orca is missing'[0m

[31m--[ [0m[34mMatch #[0m[33m310[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1079 | [0m[35m            else:[0m
[30;1m1080 | [0m[35m                plotly = Dependencies.get_module('plotly')[0m
[30;1m1081 | [0m[35m                return plotly.io.to_image([0m
[30;1m1082 | [0m[35m                    fig, format=options.get("format"), scale=options.get("scale"), width=options.get[0m
[30;1m1083 | [0m[35m                )[0m
[30;1m1084 | [0m[35m        except: # pylint: disable=bare-except[0m
[30;1m1085 | [0m[35m            # display image with 'orca is missing'[0m

[31m--[ [0m[34mMatch #[0m[33m311[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1073 | [0m[35m                )[0m
[30;1m1074 | [0m[35m                # plotly = Dependencies.get_module('plotly')[0m
[30;1m1075 | [0m[35m                # plotly.io.write_image([0m
[30;1m1076 | [0m[35m                #     fig, file, format=options.get("format"), scale=options.get("scale"), width=opt[0m
[30;1m1077 | [0m[35m                # )[0m
[30;1m1078 | [0m[35m                return filename        [0m
[30;1m1079 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m312[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1073 | [0m[35m                )[0m
[30;1m1074 | [0m[35m                # plotly = Dependencies.get_module('plotly')[0m
[30;1m1075 | [0m[35m                # plotly.io.write_image([0m
[30;1m1076 | [0m[35m                #     fig, file, format=options.get("format"), scale=options.get("scale"), width=opt[0m
[30;1m1077 | [0m[35m                # )[0m
[30;1m1078 | [0m[35m                return filename        [0m
[30;1m1079 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m313[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1073 | [0m[35m                )[0m
[30;1m1074 | [0m[35m                # plotly = Dependencies.get_module('plotly')[0m
[30;1m1075 | [0m[35m                # plotly.io.write_image([0m
[30;1m1076 | [0m[35m                #     fig, file, format=options.get("format"), scale=options.get("scale"), width=opt[0m
[30;1m1077 | [0m[35m                # )[0m
[30;1m1078 | [0m[35m                return filename        [0m
[30;1m1079 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m314[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1073 | [0m[35m                )[0m
[30;1m1074 | [0m[35m                # plotly = Dependencies.get_module('plotly')[0m
[30;1m1075 | [0m[35m                # plotly.io.write_image([0m
[30;1m1076 | [0m[35m                #     fig, file, format=options.get("format"), scale=options.get("scale"), width=opt[0m
[30;1m1077 | [0m[35m                # )[0m
[30;1m1078 | [0m[35m                return filename        [0m
[30;1m1079 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m315[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1069 | [0m[35m                fig.write_image([0m
[30;1m1070 | [0m[35m                    adjust_path(filename),[0m
[30;1m1071 | [0m[35m                    format=options.get("format"), [0m
[30;1m1072 | [0m[35m                    scale=options.get("scale"), width=options.get("width"), height=options.get("heig[0m
[30;1m1073 | [0m[35m                )[0m
[30;1m1074 | [0m[35m                # plotly = Dependencies.get_module('plotly')[0m
[30;1m1075 | [0m[35m                # plotly.io.write_image([0m

[31m--[ [0m[34mMatch #[0m[33m316[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1069 | [0m[35m                fig.write_image([0m
[30;1m1070 | [0m[35m                    adjust_path(filename),[0m
[30;1m1071 | [0m[35m                    format=options.get("format"), [0m
[30;1m1072 | [0m[35m                    scale=options.get("scale"), width=options.get("width"), height=options.get("heig[0m
[30;1m1073 | [0m[35m                )[0m
[30;1m1074 | [0m[35m                # plotly = Dependencies.get_module('plotly')[0m
[30;1m1075 | [0m[35m                # plotly.io.write_image([0m

[31m--[ [0m[34mMatch #[0m[33m317[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1069 | [0m[35m                fig.write_image([0m
[30;1m1070 | [0m[35m                    adjust_path(filename),[0m
[30;1m1071 | [0m[35m                    format=options.get("format"), [0m
[30;1m1072 | [0m[35m                    scale=options.get("scale"), width=options.get("width"), height=options.get("heig[0m
[30;1m1073 | [0m[35m                )[0m
[30;1m1074 | [0m[35m                # plotly = Dependencies.get_module('plotly')[0m
[30;1m1075 | [0m[35m                # plotly.io.write_image([0m

[31m--[ [0m[34mMatch #[0m[33m318[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1068 | [0m[35m            if filename:  # requires plotly orca package[0m
[30;1m1069 | [0m[35m                fig.write_image([0m
[30;1m1070 | [0m[35m                    adjust_path(filename),[0m
[30;1m1071 | [0m[35m                    format=options.get("format"), [0m
[30;1m1072 | [0m[35m                    scale=options.get("scale"), width=options.get("width"), height=options.get("heig[0m
[30;1m1073 | [0m[35m                )[0m
[30;1m1074 | [0m[35m                # plotly = Dependencies.get_module('plotly')[0m

[31m--[ [0m[34mMatch #[0m[33m319[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1052 | [0m[35m                plotly = Dependencies.get_module('plotly')[0m
[30;1m1053 | [0m[35m                body = plotly.offline.plot([0m
[30;1m1054 | [0m[35m                    chart_figure,[0m
[30;1m1055 | [0m[35m                    include_plotlyjs=window_mode and self.options.get("plotly_fs_includejs", False),[0m
[30;1m1056 | [0m[35m                    output_type="div"[0m
[30;1m1057 | [0m[35m                )[0m
[30;1m1058 | [0m[35m                return {"body": body, "head": head}[0m

[31m--[ [0m[34mMatch #[0m[33m320[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1048 | [0m[35m                return {"body": image_html_str}[0m
[30;1m1049 | [0m[35m                [0m
[30;1m1050 | [0m[35m            elif window_mode:[0m
[30;1m1051 | [0m[35m                head = '<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>' if not sel[0m
[30;1m1052 | [0m[35m                plotly = Dependencies.get_module('plotly')[0m
[30;1m1053 | [0m[35m                body = plotly.offline.plot([0m
[30;1m1054 | [0m[35m                    chart_figure,[0m

[31m--[ [0m[34mMatch #[0m[33m321[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1040 | [0m[35m        chart_figure = self._figure_or_figurewidget(data=chart_obj.get("data"), layout=chart_obj.get[0m
[30;1m1041 | [0m[35m        if chart_figure is not None:[0m
[30;1m1042 | [0m[35m            self._metadata["chart_figure"] = chart_figure[0m
[30;1m1043 | [0m[35m            if options.get("plot_package") == "plotly_orca":[0m
[30;1m1044 | [0m[35m                image_bytes = self._plotly_fig_to_image(chart_figure, None, options=options)[0m
[30;1m1045 | [0m[35m                image_base64_bytes= base64.b64encode(image_bytes)[0m
[30;1m1046 | [0m[35m                image_base64_str = image_base64_bytes.decode("utf-8")[0m

[31m--[ [0m[34mMatch #[0m[33m322[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1037 | [0m[35m        if chart_obj is None:[0m
[30;1m1038 | [0m[35m            return {}[0m
[30;1m1039 | [0m[35m[0m
[30;1m1040 | [0m[35m        chart_figure = self._figure_or_figurewidget(data=chart_obj.get("data"), layout=chart_obj.get[0m
[30;1m1041 | [0m[35m        if chart_figure is not None:[0m
[30;1m1042 | [0m[35m            self._metadata["chart_figure"] = chart_figure[0m
[30;1m1043 | [0m[35m            if options.get("plot_package") == "plotly_orca":[0m

[31m--[ [0m[34mMatch #[0m[33m323[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1037 | [0m[35m        if chart_obj is None:[0m
[30;1m1038 | [0m[35m            return {}[0m
[30;1m1039 | [0m[35m[0m
[30;1m1040 | [0m[35m        chart_figure = self._figure_or_figurewidget(data=chart_obj.get("data"), layout=chart_obj.get[0m
[30;1m1041 | [0m[35m        if chart_figure is not None:[0m
[30;1m1042 | [0m[35m            self._metadata["chart_figure"] = chart_figure[0m
[30;1m1043 | [0m[35m            if options.get("plot_package") == "plotly_orca":[0m

[31m--[ [0m[34mMatch #[0m[33m324[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m960 | [0m[35m        if options.get("plot_package") == "None":[0m
[30;1m961 | [0m[35m            return {}[0m
[30;1m962 | [0m[35m[0m
[30;1m963 | [0m[35m        if options.get("plot_package") not in self._SUPPORTED_PLOT_PACKAGES:[0m
[30;1m964 | [0m[35m            return {}[0m
[30;1m965 | [0m[35m[0m
[30;1m966 | [0m[35m        if len(self) == 0:[0m

[31m--[ [0m[34mMatch #[0m[33m325[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m957 | [0m[35m        if not self.is_chart():[0m
[30;1m958 | [0m[35m            return {}[0m
[30;1m959 | [0m[35m[0m
[30;1m960 | [0m[35m        if options.get("plot_package") == "None":[0m
[30;1m961 | [0m[35m            return {}[0m
[30;1m962 | [0m[35m[0m
[30;1m963 | [0m[35m        if options.get("plot_package") not in self._SUPPORTED_PLOT_PACKAGES:[0m

[31m--[ [0m[34mMatch #[0m[33m326[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m914 | [0m[35m[0m
[30;1m915 | [0m[35m                    if file_or_image_bytes:[0m
[30;1m916 | [0m[35m[0m
[30;1m917 | [0m[35m                        return FileResultDescriptor(file_or_image_bytes, message="image results", fo[0m
[30;1m918 | [0m[35m[0m
[30;1m919 | [0m[35m[0m
[30;1m920 | [0m[35m    # Public API [0m

[31m--[ [0m[34mMatch #[0m[33m327[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m914 | [0m[35m[0m
[30;1m915 | [0m[35m                    if file_or_image_bytes:[0m
[30;1m916 | [0m[35m[0m
[30;1m917 | [0m[35m                        return FileResultDescriptor(file_or_image_bytes, message="image results", fo[0m
[30;1m918 | [0m[35m[0m
[30;1m919 | [0m[35m[0m
[30;1m920 | [0m[35m    # Public API [0m

[31m--[ [0m[34mMatch #[0m[33m328[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m908 | [0m[35m            fig = self._getChartHtml(window_mode=False, options=_options).get("fig")[0m
[30;1m909 | [0m[35m            if fig is not None:[0m
[30;1m910 | [0m[35m[0m
[30;1m911 | [0m[35m                filename = adjust_path(kwargs.get("filename"))[0m
[30;1m912 | [0m[35m                if filename is not None:[0m
[30;1m913 | [0m[35m                    file_or_image_bytes = self._plotly_fig_to_image(fig, filename, options=_options)[0m
[30;1m914 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m329[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m905 | [0m[35m[0m
[30;1m906 | [0m[35m            # replace rendering to plotly, to make it work with _plotly_fig_to_image() below[0m
[30;1m907 | [0m[35m            _options = {**self.options, **{"plot_package": "plotly"}}[0m
[30;1m908 | [0m[35m            fig = self._getChartHtml(window_mode=False, options=_options).get("fig")[0m
[30;1m909 | [0m[35m            if fig is not None:[0m
[30;1m910 | [0m[35m[0m
[30;1m911 | [0m[35m                filename = adjust_path(kwargs.get("filename"))[0m

[31m--[ [0m[34mMatch #[0m[33m330[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m901 | [0m[35m        "export image of the chart that was specified in the query to a file"[0m
[30;1m902 | [0m[35m        _options = {**self.options, **kwargs}[0m
[30;1m903 | [0m[35m[0m
[30;1m904 | [0m[35m        if self.options.get("plot_package") in ["plotly_orca", "plotly", "plotly_widget"]:[0m
[30;1m905 | [0m[35m[0m
[30;1m906 | [0m[35m            # replace rendering to plotly, to make it work with _plotly_fig_to_image() below[0m
[30;1m907 | [0m[35m            _options = {**self.options, **{"plot_package": "plotly"}}[0m

[31m--[ [0m[34mMatch #[0m[33m331[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m891 | [0m[35m                plotly.offline.init_notebook_mode(connected=True)[0m
[30;1m892 | [0m[35m                plotly.offline.iplot(c.get("fig"), filename="plotlychart")[0m
[30;1m893 | [0m[35m            else:[0m
[30;1m894 | [0m[35m                Display.show(c.get("fig"), display_handler_name=display_handler_name, **_options)[0m
[30;1m895 | [0m[35m        else:[0m
[30;1m896 | [0m[35m            return self.show_table(**kwargs)[0m
[30;1m897 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m332[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m889 | [0m[35m            if _options.get("notebook_app") in ["azurenotebook", "azureml", "azuremljupyternotebook"[0m
[30;1m890 | [0m[35m                plotly = Dependencies.get_module('plotly')[0m
[30;1m891 | [0m[35m                plotly.offline.init_notebook_mode(connected=True)[0m
[30;1m892 | [0m[35m                plotly.offline.iplot(c.get("fig"), filename="plotlychart")[0m
[30;1m893 | [0m[35m            else:[0m
[30;1m894 | [0m[35m                Display.show(c.get("fig"), display_handler_name=display_handler_name, **_options)[0m
[30;1m895 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m333[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m886 | [0m[35m            html = Display.toHtml(**c, title='chart')[0m
[30;1m887 | [0m[35m            Display.show(html, display_handler_name=display_handler_name, **_options)[0m
[30;1m888 | [0m[35m        elif c.get("fig"):[0m
[30;1m889 | [0m[35m            if _options.get("notebook_app") in ["azurenotebook", "azureml", "azuremljupyternotebook"[0m
[30;1m890 | [0m[35m                plotly = Dependencies.get_module('plotly')[0m
[30;1m891 | [0m[35m                plotly.offline.init_notebook_mode(connected=True)[0m
[30;1m892 | [0m[35m                plotly.offline.iplot(c.get("fig"), filename="plotlychart")[0m

[31m--[ [0m[34mMatch #[0m[33m334[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m885 | [0m[35m        if c.get("body") or c.get("head"):[0m
[30;1m886 | [0m[35m            html = Display.toHtml(**c, title='chart')[0m
[30;1m887 | [0m[35m            Display.show(html, display_handler_name=display_handler_name, **_options)[0m
[30;1m888 | [0m[35m        elif c.get("fig"):[0m
[30;1m889 | [0m[35m            if _options.get("notebook_app") in ["azurenotebook", "azureml", "azuremljupyternotebook"[0m
[30;1m890 | [0m[35m                plotly = Dependencies.get_module('plotly')[0m
[30;1m891 | [0m[35m                plotly.offline.init_notebook_mode(connected=True)[0m

[31m--[ [0m[34mMatch #[0m[33m335[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m882 | [0m[35m        if window_mode and not _options.get("button_text"):[0m
[30;1m883 | [0m[35m            _options["button_text"] = "popup " + self.visualization + ((" - " + self.title) if self.[0m
[30;1m884 | [0m[35m        c = self._getChartHtml(window_mode, options=_options)[0m
[30;1m885 | [0m[35m        if c.get("body") or c.get("head"):[0m
[30;1m886 | [0m[35m            html = Display.toHtml(**c, title='chart')[0m
[30;1m887 | [0m[35m            Display.show(html, display_handler_name=display_handler_name, **_options)[0m
[30;1m888 | [0m[35m        elif c.get("fig"):[0m

[31m--[ [0m[34mMatch #[0m[33m336[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m882 | [0m[35m        if window_mode and not _options.get("button_text"):[0m
[30;1m883 | [0m[35m            _options["button_text"] = "popup " + self.visualization + ((" - " + self.title) if self.[0m
[30;1m884 | [0m[35m        c = self._getChartHtml(window_mode, options=_options)[0m
[30;1m885 | [0m[35m        if c.get("body") or c.get("head"):[0m
[30;1m886 | [0m[35m            html = Display.toHtml(**c, title='chart')[0m
[30;1m887 | [0m[35m            Display.show(html, display_handler_name=display_handler_name, **_options)[0m
[30;1m888 | [0m[35m        elif c.get("fig"):[0m

[31m--[ [0m[34mMatch #[0m[33m337[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m879 | [0m[35m        _options = {**self.options, **kwargs}[0m
[30;1m880 | [0m[35m        window_mode = _options.get("popup_window")[0m
[30;1m881 | [0m[35m[0m
[30;1m882 | [0m[35m        if window_mode and not _options.get("button_text"):[0m
[30;1m883 | [0m[35m            _options["button_text"] = "popup " + self.visualization + ((" - " + self.title) if self.[0m
[30;1m884 | [0m[35m        c = self._getChartHtml(window_mode, options=_options)[0m
[30;1m885 | [0m[35m        if c.get("body") or c.get("head"):[0m

[31m--[ [0m[34mMatch #[0m[33m338[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m877 | [0m[35m    def show_chart(self, display_handler_name:str=None, **kwargs)->None:[0m
[30;1m878 | [0m[35m        "display the chart that was specified in the query"[0m
[30;1m879 | [0m[35m        _options = {**self.options, **kwargs}[0m
[30;1m880 | [0m[35m        window_mode = _options.get("popup_window")[0m
[30;1m881 | [0m[35m[0m
[30;1m882 | [0m[35m        if window_mode and not _options.get("button_text"):[0m
[30;1m883 | [0m[35m            _options["button_text"] = "popup " + self.visualization + ((" - " + self.title) if self.[0m

[31m--[ [0m[34mMatch #[0m[33m339[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m854 | [0m[35m[0m
[30;1m855 | [0m[35m        magic = self._metadata.get("magic")[0m
[30;1m856 | [0m[35m        line = self._metadata.get("parsed").get("line")[0m
[30;1m857 | [0m[35m        cell = self._metadata.get("parsed").get("cell")[0m
[30;1m858 | [0m[35m[0m
[30;1m859 | [0m[35m        return magic.execute([0m
[30;1m860 | [0m[35m            line, cell, [0m

[31m--[ [0m[34mMatch #[0m[33m340[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m854 | [0m[35m[0m
[30;1m855 | [0m[35m        magic = self._metadata.get("magic")[0m
[30;1m856 | [0m[35m        line = self._metadata.get("parsed").get("line")[0m
[30;1m857 | [0m[35m        cell = self._metadata.get("parsed").get("cell")[0m
[30;1m858 | [0m[35m[0m
[30;1m859 | [0m[35m        return magic.execute([0m
[30;1m860 | [0m[35m            line, cell, [0m

[31m--[ [0m[34mMatch #[0m[33m341[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m853 | [0m[35m            _override_options['display_handlers'] = self.options.get('display_handlers')[0m
[30;1m854 | [0m[35m[0m
[30;1m855 | [0m[35m        magic = self._metadata.get("magic")[0m
[30;1m856 | [0m[35m        line = self._metadata.get("parsed").get("line")[0m
[30;1m857 | [0m[35m        cell = self._metadata.get("parsed").get("cell")[0m
[30;1m858 | [0m[35m[0m
[30;1m859 | [0m[35m        return magic.execute([0m

[31m--[ [0m[34mMatch #[0m[33m342[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m853 | [0m[35m            _override_options['display_handlers'] = self.options.get('display_handlers')[0m
[30;1m854 | [0m[35m[0m
[30;1m855 | [0m[35m        magic = self._metadata.get("magic")[0m
[30;1m856 | [0m[35m        line = self._metadata.get("parsed").get("line")[0m
[30;1m857 | [0m[35m        cell = self._metadata.get("parsed").get("cell")[0m
[30;1m858 | [0m[35m[0m
[30;1m859 | [0m[35m        return magic.execute([0m

[31m--[ [0m[34mMatch #[0m[33m343[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m852 | [0m[35m        if _override_options.get('display_id') is None or _override_options.get('display_id') == sel[0m
[30;1m853 | [0m[35m            _override_options['display_handlers'] = self.options.get('display_handlers')[0m
[30;1m854 | [0m[35m[0m
[30;1m855 | [0m[35m        magic = self._metadata.get("magic")[0m
[30;1m856 | [0m[35m        line = self._metadata.get("parsed").get("line")[0m
[30;1m857 | [0m[35m        cell = self._metadata.get("parsed").get("cell")[0m
[30;1m858 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m344[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m850 | [0m[35m[0m
[30;1m851 | [0m[35m        _override_options = {**override_options} if type(override_options) == dict else {}[0m
[30;1m852 | [0m[35m        if _override_options.get('display_id') is None or _override_options.get('display_id') == sel[0m
[30;1m853 | [0m[35m            _override_options['display_handlers'] = self.options.get('display_handlers')[0m
[30;1m854 | [0m[35m[0m
[30;1m855 | [0m[35m        magic = self._metadata.get("magic")[0m
[30;1m856 | [0m[35m        line = self._metadata.get("parsed").get("line")[0m

[31m--[ [0m[34mMatch #[0m[33m345[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m849 | [0m[35m        "refresh the results of the query, on the same object: self"[0m
[30;1m850 | [0m[35m[0m
[30;1m851 | [0m[35m        _override_options = {**override_options} if type(override_options) == dict else {}[0m
[30;1m852 | [0m[35m        if _override_options.get('display_id') is None or _override_options.get('display_id') == sel[0m
[30;1m853 | [0m[35m            _override_options['display_handlers'] = self.options.get('display_handlers')[0m
[30;1m854 | [0m[35m[0m
[30;1m855 | [0m[35m        magic = self._metadata.get("magic")[0m

[31m--[ [0m[34mMatch #[0m[33m346[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m849 | [0m[35m        "refresh the results of the query, on the same object: self"[0m
[30;1m850 | [0m[35m[0m
[30;1m851 | [0m[35m        _override_options = {**override_options} if type(override_options) == dict else {}[0m
[30;1m852 | [0m[35m        if _override_options.get('display_id') is None or _override_options.get('display_id') == sel[0m
[30;1m853 | [0m[35m            _override_options['display_handlers'] = self.options.get('display_handlers')[0m
[30;1m854 | [0m[35m[0m
[30;1m855 | [0m[35m        magic = self._metadata.get("magic")[0m

[31m--[ [0m[34mMatch #[0m[33m347[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m849 | [0m[35m        "refresh the results of the query, on the same object: self"[0m
[30;1m850 | [0m[35m[0m
[30;1m851 | [0m[35m        _override_options = {**override_options} if type(override_options) == dict else {}[0m
[30;1m852 | [0m[35m        if _override_options.get('display_id') is None or _override_options.get('display_id') == sel[0m
[30;1m853 | [0m[35m            _override_options['display_handlers'] = self.options.get('display_handlers')[0m
[30;1m854 | [0m[35m[0m
[30;1m855 | [0m[35m        magic = self._metadata.get("magic")[0m

[31m--[ [0m[34mMatch #[0m[33m348[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m834 | [0m[35m        "execute the query again"[0m
[30;1m835 | [0m[35m        magic = self._metadata.get("magic")[0m
[30;1m836 | [0m[35m        line = self._metadata.get("parsed").get("line")[0m
[30;1m837 | [0m[35m        cell = self._metadata.get("parsed").get("cell")[0m
[30;1m838 | [0m[35m[0m
[30;1m839 | [0m[35m        return magic.execute([0m
[30;1m840 | [0m[35m            line, cell, [0m

[31m--[ [0m[34mMatch #[0m[33m349[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m834 | [0m[35m        "execute the query again"[0m
[30;1m835 | [0m[35m        magic = self._metadata.get("magic")[0m
[30;1m836 | [0m[35m        line = self._metadata.get("parsed").get("line")[0m
[30;1m837 | [0m[35m        cell = self._metadata.get("parsed").get("cell")[0m
[30;1m838 | [0m[35m[0m
[30;1m839 | [0m[35m        return magic.execute([0m
[30;1m840 | [0m[35m            line, cell, [0m

[31m--[ [0m[34mMatch #[0m[33m350[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m833 | [0m[35m    def submit(self, override_vars:Dict[str,str]=None, override_options:Dict[str,Any]=None, override[0m
[30;1m834 | [0m[35m        "execute the query again"[0m
[30;1m835 | [0m[35m        magic = self._metadata.get("magic")[0m
[30;1m836 | [0m[35m        line = self._metadata.get("parsed").get("line")[0m
[30;1m837 | [0m[35m        cell = self._metadata.get("parsed").get("cell")[0m
[30;1m838 | [0m[35m[0m
[30;1m839 | [0m[35m        return magic.execute([0m

[31m--[ [0m[34mMatch #[0m[33m351[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m833 | [0m[35m    def submit(self, override_vars:Dict[str,str]=None, override_options:Dict[str,Any]=None, override[0m
[30;1m834 | [0m[35m        "execute the query again"[0m
[30;1m835 | [0m[35m        magic = self._metadata.get("magic")[0m
[30;1m836 | [0m[35m        line = self._metadata.get("parsed").get("line")[0m
[30;1m837 | [0m[35m        cell = self._metadata.get("parsed").get("cell")[0m
[30;1m838 | [0m[35m[0m
[30;1m839 | [0m[35m        return magic.execute([0m

[31m--[ [0m[34mMatch #[0m[33m352[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m832 | [0m[35m    # Public API   [0m
[30;1m833 | [0m[35m    def submit(self, override_vars:Dict[str,str]=None, override_options:Dict[str,Any]=None, override[0m
[30;1m834 | [0m[35m        "execute the query again"[0m
[30;1m835 | [0m[35m        magic = self._metadata.get("magic")[0m
[30;1m836 | [0m[35m        line = self._metadata.get("parsed").get("line")[0m
[30;1m837 | [0m[35m        cell = self._metadata.get("parsed").get("cell")[0m
[30;1m838 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m353[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m730 | [0m[35m                # remove 'index' field metadata[0m
[30;1m731 | [0m[35m                fields = schema.get("fields")[0m
[30;1m732 | [0m[35m                for idx, field in enumerate(fields):[0m
[30;1m733 | [0m[35m                    if field.get("name") == "index":[0m
[30;1m734 | [0m[35m                        fields.pop(idx)[0m
[30;1m735 | [0m[35m                        break[0m
[30;1m736 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m354[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m728 | [0m[35m                schema["kqmagic_version"] = kqlmagic_version[0m
[30;1m729 | [0m[35m[0m
[30;1m730 | [0m[35m                # remove 'index' field metadata[0m
[30;1m731 | [0m[35m                fields = schema.get("fields")[0m
[30;1m732 | [0m[35m                for idx, field in enumerate(fields):[0m
[30;1m733 | [0m[35m                    if field.get("name") == "index":[0m
[30;1m734 | [0m[35m                        fields.pop(idx)[0m

[31m--[ [0m[34mMatch #[0m[33m355[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m710 | [0m[35m                if not isinstance(fields, list):[0m
[30;1m711 | [0m[35m                    return obj[0m
[30;1m712 | [0m[35m[0m
[30;1m713 | [0m[35m                rows = obj.get("data")[0m
[30;1m714 | [0m[35m                if not isinstance(rows, list):[0m
[30;1m715 | [0m[35m                    return obj[0m
[30;1m716 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m356[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m706 | [0m[35m                if 'index' not in primary_keys:[0m
[30;1m707 | [0m[35m                    return obj[0m
[30;1m708 | [0m[35m[0m
[30;1m709 | [0m[35m                fields = schema.get("fields")[0m
[30;1m710 | [0m[35m                if not isinstance(fields, list):[0m
[30;1m711 | [0m[35m                    return obj[0m
[30;1m712 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m357[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m696 | [0m[35m                #[0m
[30;1m697 | [0m[35m                # mofify schema part[0m
[30;1m698 | [0m[35m                #[0m
[30;1m699 | [0m[35m                primary_keys = schema.get('primaryKey')[0m
[30;1m700 | [0m[35m                if isinstance(primary_keys, str):[0m
[30;1m701 | [0m[35m                    primary_keys = [primary_keys.strip()][0m
[30;1m702 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m358[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m689 | [0m[35m                if not isinstance(obj, dict):[0m
[30;1m690 | [0m[35m                    return obj[0m
[30;1m691 | [0m[35m[0m
[30;1m692 | [0m[35m                schema = obj.get("schema")[0m
[30;1m693 | [0m[35m                if not isinstance(schema, dict):[0m
[30;1m694 | [0m[35m                    return obj[0m
[30;1m695 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m359[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m657 | [0m[35m                t = self._getPrettyTableHtml()[0m
[30;1m658 | [0m[35m                content = Display.toHtml(**t, title='table')[0m
[30;1m659 | [0m[35m[0m
[30;1m660 | [0m[35m        if options.get("popup_window") and not options.get("button_text"):[0m
[30;1m661 | [0m[35m            options["button_text"] = f'popup table{((" - " + self.title) if self.title else "")} '[0m
[30;1m662 | [0m[35m[0m
[30;1m663 | [0m[35m        Display.show(content, display_handler_name=display_handler_name, **options)[0m

[31m--[ [0m[34mMatch #[0m[33m360[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m657 | [0m[35m                t = self._getPrettyTableHtml()[0m
[30;1m658 | [0m[35m                content = Display.toHtml(**t, title='table')[0m
[30;1m659 | [0m[35m[0m
[30;1m660 | [0m[35m        if options.get("popup_window") and not options.get("button_text"):[0m
[30;1m661 | [0m[35m            options["button_text"] = f'popup table{((" - " + self.title) if self.title else "")} '[0m
[30;1m662 | [0m[35m[0m
[30;1m663 | [0m[35m        Display.show(content, display_handler_name=display_handler_name, **options)[0m

[31m--[ [0m[34mMatch #[0m[33m361[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m647 | [0m[35m                else:[0m
[30;1m648 | [0m[35m                    pandas_display_html_table_schema = pd.options.display.html.table_schema[0m
[30;1m649 | [0m[35m                    pd.options.display.html.table_schema = False[0m
[30;1m650 | [0m[35m                    if options.get("notebook_app") in ["azuredatastudiosaw"] and options.get("popup_[0m
[30;1m651 | [0m[35m                        content = df.to_string()[0m
[30;1m652 | [0m[35m                    else:[0m
[30;1m653 | [0m[35m                        t = df._repr_html_()[0m

[31m--[ [0m[34mMatch #[0m[33m362[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m647 | [0m[35m                else:[0m
[30;1m648 | [0m[35m                    pandas_display_html_table_schema = pd.options.display.html.table_schema[0m
[30;1m649 | [0m[35m                    pd.options.display.html.table_schema = False[0m
[30;1m650 | [0m[35m                    if options.get("notebook_app") in ["azuredatastudiosaw"] and options.get("popup_[0m
[30;1m651 | [0m[35m                        content = df.to_string()[0m
[30;1m652 | [0m[35m                    else:[0m
[30;1m653 | [0m[35m                        t = df._repr_html_()[0m

[31m--[ [0m[34mMatch #[0m[33m363[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m639 | [0m[35m[0m
[30;1m640 | [0m[35m                    pandas_display_html_table_schema = pd.options.display.html.table_schema[0m
[30;1m641 | [0m[35m                    pd.options.display.html.table_schema = True[0m
[30;1m642 | [0m[35m                    if options.get("notebook_app") in ["azuredatastudio", "azuredatastudiosaw"]:[0m
[30;1m643 | [0m[35m                        pandas__repr_data_resource_ = self._patch_pandas__repr_data_resource_()[0m
[30;1m644 | [0m[35m                        pandas__repr_data_resource_patched = True[0m
[30;1m645 | [0m[35m                    content = df[0m

[31m--[ [0m[34mMatch #[0m[33m364[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m626 | [0m[35m                    pass[0m
[30;1m627 | [0m[35m                pd.set_option('display.large_repr', "truncate")[0m
[30;1m628 | [0m[35m[0m
[30;1m629 | [0m[35m                if options.get("table_package", "") == "pandas_html_table_schema" and not options.ge[0m
[30;1m630 | [0m[35m                    df_copied = False[0m
[30;1m631 | [0m[35m                    for idx, column_type in enumerate(self.columns_type):[0m
[30;1m632 | [0m[35m                        if column_type == "dynamic":[0m

[31m--[ [0m[34mMatch #[0m[33m365[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m626 | [0m[35m                    pass[0m
[30;1m627 | [0m[35m                pd.set_option('display.large_repr', "truncate")[0m
[30;1m628 | [0m[35m[0m
[30;1m629 | [0m[35m                if options.get("table_package", "") == "pandas_html_table_schema" and not options.ge[0m
[30;1m630 | [0m[35m                    df_copied = False[0m
[30;1m631 | [0m[35m                    for idx, column_type in enumerate(self.columns_type):[0m
[30;1m632 | [0m[35m                        if column_type == "dynamic":[0m

[31m--[ [0m[34mMatch #[0m[33m366[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m611 | [0m[35m                else:[0m
[30;1m612 | [0m[35m                    content = Display.toHtml(**{}, title='table')[0m
[30;1m613 | [0m[35m[0m
[30;1m614 | [0m[35m            elif options.get("table_package", "").lower() in ["pandas", "pandas_html_table_schema"]:[0m
[30;1m615 | [0m[35m                pd = Dependencies.get_module("pandas")[0m
[30;1m616 | [0m[35m[0m
[30;1m617 | [0m[35m                df = self.to_dataframe()[0m

[31m--[ [0m[34mMatch #[0m[33m367[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m606 | [0m[35m        else:[0m
[30;1m607 | [0m[35m            display_limit = options.get("display_limit")[0m
[30;1m608 | [0m[35m            if type(display_limit) == int and display_limit < 0:[0m
[30;1m609 | [0m[35m                if options.get("notebook_app") in ["azuredatastudiosaw"] and options.get("popup_wind[0m
[30;1m610 | [0m[35m                    content = ""[0m
[30;1m611 | [0m[35m                else:[0m
[30;1m612 | [0m[35m                    content = Display.toHtml(**{}, title='table')[0m

[31m--[ [0m[34mMatch #[0m[33m368[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m606 | [0m[35m        else:[0m
[30;1m607 | [0m[35m            display_limit = options.get("display_limit")[0m
[30;1m608 | [0m[35m            if type(display_limit) == int and display_limit < 0:[0m
[30;1m609 | [0m[35m                if options.get("notebook_app") in ["azuredatastudiosaw"] and options.get("popup_wind[0m
[30;1m610 | [0m[35m                    content = ""[0m
[30;1m611 | [0m[35m                else:[0m
[30;1m612 | [0m[35m                    content = Display.toHtml(**{}, title='table')[0m

[31m--[ [0m[34mMatch #[0m[33m369[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m604 | [0m[35m        if not options.get("popup_window") and len(self) == 1 and len(self[0]) == 1 and (isinstance([0m
[30;1m605 | [0m[35m            content = Display.to_json_styled_class(self[0][0], options=options)[0m
[30;1m606 | [0m[35m        else:[0m
[30;1m607 | [0m[35m            display_limit = options.get("display_limit")[0m
[30;1m608 | [0m[35m            if type(display_limit) == int and display_limit < 0:[0m
[30;1m609 | [0m[35m                if options.get("notebook_app") in ["azuredatastudiosaw"] and options.get("popup_wind[0m
[30;1m610 | [0m[35m                    content = ""[0m

[31m--[ [0m[34mMatch #[0m[33m370[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m601 | [0m[35m        pandas__repr_data_resource_ = None[0m
[30;1m602 | [0m[35m        pandas_display_html_table_schema = None[0m
[30;1m603 | [0m[35m        pandas__repr_data_resource_patched = False[0m
[30;1m604 | [0m[35m        if not options.get("popup_window") and len(self) == 1 and len(self[0]) == 1 and (isinstance([0m
[30;1m605 | [0m[35m            content = Display.to_json_styled_class(self[0][0], options=options)[0m
[30;1m606 | [0m[35m        else:[0m
[30;1m607 | [0m[35m            display_limit = options.get("display_limit")[0m

[31m--[ [0m[34mMatch #[0m[33m371[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m585 | [0m[35m[0m
[30;1m586 | [0m[35m    def need_suppress_next_workaround(self)->bool:[0m
[30;1m587 | [0m[35m        if self.options.get("table_package") != "pandas_html_table_schema" \[0m
[30;1m588 | [0m[35m                or self.options.get("popup_window") \[0m
[30;1m589 | [0m[35m                or (len(self) == 1 and len(self[0]) == 1 and (isinstance(self[0][0], dict) or isinst[0m
[30;1m590 | [0m[35m            return False[0m
[30;1m591 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m372[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m584 | [0m[35m[0m
[30;1m585 | [0m[35m[0m
[30;1m586 | [0m[35m    def need_suppress_next_workaround(self)->bool:[0m
[30;1m587 | [0m[35m        if self.options.get("table_package") != "pandas_html_table_schema" \[0m
[30;1m588 | [0m[35m                or self.options.get("popup_window") \[0m
[30;1m589 | [0m[35m                or (len(self) == 1 and len(self[0]) == 1 and (isinstance(self[0][0], dict) or isinst[0m
[30;1m590 | [0m[35m            return False[0m

[31m--[ [0m[34mMatch #[0m[33m373[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m559 | [0m[35m            if prettytable:[0m
[30;1m560 | [0m[35m                if self.pretty is None:[0m
[30;1m561 | [0m[35m                    # table printing style to any of prettytable's defined styles (currently DEFAULT[0m
[30;1m562 | [0m[35m                    prettytable_style = prettytable.__dict__[self.options.get("prettytable_style", "[0m
[30;1m563 | [0m[35m                    self.pretty = PrettyTable(self.field_names, style=prettytable_style) if len(self[0m
[30;1m564 | [0m[35m[0m
[30;1m565 | [0m[35m                self.pretty.add_rows(table)[0m

[31m--[ [0m[34mMatch #[0m[33m374[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m549 | [0m[35m    def _getPrettyTableHtml(self)->Dict[str,str]:[0m
[30;1m550 | [0m[35m        "get query result in a table format as an HTML string"[0m
[30;1m551 | [0m[35m[0m
[30;1m552 | [0m[35m        display_limit = self.options.get("display_limit")[0m
[30;1m553 | [0m[35m        if display_limit is None:[0m
[30;1m554 | [0m[35m            display_limit = len(self)[0m
[30;1m555 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m375[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m538 | [0m[35m                f"{self.options.get('query_link_destination')}", [0m
[30;1m539 | [0m[35m                onclick_visibility="visible",[0m
[30;1m540 | [0m[35m                palette=Display.info_style,[0m
[30;1m541 | [0m[35m                before_text=f"Click to execute query in {self.options.get('query_link_destination')}[0m
[30;1m542 | [0m[35m                display_handler_name=display_handler_name,[0m
[30;1m543 | [0m[35m                close_window_timeout_in_secs=close_window_timeout_in_secs,[0m
[30;1m544 | [0m[35m                **self.options[0m

[31m--[ [0m[34mMatch #[0m[33m376[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m535 | [0m[35m            Display.show_window([0m
[30;1m536 | [0m[35m                f"query_link_{qld}", [0m
[30;1m537 | [0m[35m                deep_link_url, [0m
[30;1m538 | [0m[35m                f"{self.options.get('query_link_destination')}", [0m
[30;1m539 | [0m[35m                onclick_visibility="visible",[0m
[30;1m540 | [0m[35m                palette=Display.info_style,[0m
[30;1m541 | [0m[35m                before_text=f"Click to execute query in {self.options.get('query_link_destination')}[0m

[31m--[ [0m[34mMatch #[0m[33m377[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m531 | [0m[35m                deep_link_url = Display.get_show_deeplink_webbrowser_html_obj(f"query_link_{qld}", d[0m
[30;1m532 | [0m[35m                deep_link_url = f'{self.options.get("temp_files_server_address")}/webbrowser?url={ur[0m
[30;1m533 | [0m[35m[0m
[30;1m534 | [0m[35m            qld = self.options.get("query_link_destination").lower().replace('.', '_')[0m
[30;1m535 | [0m[35m            Display.show_window([0m
[30;1m536 | [0m[35m                f"query_link_{qld}", [0m
[30;1m537 | [0m[35m                deep_link_url, [0m

[31m--[ [0m[34mMatch #[0m[33m378[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m529 | [0m[35m                    return None[0m
[30;1m530 | [0m[35m                qld = self.options.get("query_link_destination").lower().replace('.', '_')[0m
[30;1m531 | [0m[35m                deep_link_url = Display.get_show_deeplink_webbrowser_html_obj(f"query_link_{qld}", d[0m
[30;1m532 | [0m[35m                deep_link_url = f'{self.options.get("temp_files_server_address")}/webbrowser?url={ur[0m
[30;1m533 | [0m[35m[0m
[30;1m534 | [0m[35m            qld = self.options.get("query_link_destination").lower().replace('.', '_')[0m
[30;1m535 | [0m[35m            Display.show_window([0m

[31m--[ [0m[34mMatch #[0m[33m379[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m529 | [0m[35m                    return None[0m
[30;1m530 | [0m[35m                qld = self.options.get("query_link_destination").lower().replace('.', '_')[0m
[30;1m531 | [0m[35m                deep_link_url = Display.get_show_deeplink_webbrowser_html_obj(f"query_link_{qld}", d[0m
[30;1m532 | [0m[35m                deep_link_url = f'{self.options.get("temp_files_server_address")}/webbrowser?url={ur[0m
[30;1m533 | [0m[35m[0m
[30;1m534 | [0m[35m            qld = self.options.get("query_link_destination").lower().replace('.', '_')[0m
[30;1m535 | [0m[35m            Display.show_window([0m

[31m--[ [0m[34mMatch #[0m[33m380[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m526 | [0m[35mkaround using temp_file_server webbrowser[0m
[30;1m527 | [0m[35m            if self.options.get("notebook_app") in ["nteract"]:[0m
[30;1m528 | [0m[35m                if self.options.get("kernel_location") != "local" or self.options.get("temp_files_se[0m
[30;1m529 | [0m[35m                    return None[0m
[30;1m530 | [0m[35m                qld = self.options.get("query_link_destination").lower().replace('.', '_')[0m
[30;1m531 | [0m[35m                deep_link_url = Display.get_show_deeplink_webbrowser_html_obj(f"query_link_{qld}", d[0m

[31m--[ [0m[34mMatch #[0m[33m381[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m524 | [0m[35m {deep_link_url}")[0m
[30;1m525 | [0m[35m            import urllib.parse[0m
[30;1m526 | [0m[35m            # nteract cannot execute deep link script, workaround using temp_file_server webbrowser[0m
[30;1m527 | [0m[35m            if self.options.get("notebook_app") in ["nteract"]:[0m
[30;1m528 | [0m[35m                if self.options.get("kernel_location") != "local" or self.options.get("temp_files_se[0m
[30;1m529 | [0m[35m                    return None[0m
[30;1m530 | [0m[35m                qld = self.options.get("query_link_destination").lower().replace('.', '_')[0m

[31m--[ [0m[34mMatch #[0m[33m382[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m524 | [0m[35mdebug(f"ResultSet::show_button_to_deep_link - url: {deep_link_url}")[0m
[30;1m525 | [0m[35m            import urllib.parse[0m
[30;1m526 | [0m[35m            # nteract cannot execute deep link script, workaround using temp_file_server webbrowser[0m
[30;1m527 | [0m[35m            if self.options.get("notebook_app") in ["nteract"]:[0m
[30;1m528 | [0m[35m                if self.options.get("kernel_location") != "local" or self.options.get("temp_files_se[0m
[30;1m529 | [0m[35m                    return None[0m
[30;1m530 | [0m[35m                qld = self.options.get("query_link_destination").lower().replace('.', '_')[0m

[31m--[ [0m[34mMatch #[0m[33m383[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m524 | [0m[35m            logger().debug(f"ResultSet::show_button_to_deep_link - url: {deep_link_url}")[0m
[30;1m525 | [0m[35m            import urllib.parse[0m
[30;1m526 | [0m[35m            # nteract cannot execute deep link script, workaround using temp_file_server webbrowser[0m
[30;1m527 | [0m[35m            if self.options.get("notebook_app") in ["nteract"]:[0m
[30;1m528 | [0m[35m                if self.options.get("kernel_location") != "local" or self.options.get("temp_files_se[0m
[30;1m529 | [0m[35m                    return None[0m
[30;1m530 | [0m[35m                qld = self.options.get("query_link_destination").lower().replace('.', '_')[0m

[31m--[ [0m[34mMatch #[0m[33m384[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m517 | [0m[35m[0m
[30;1m518 | [0m[35m[0m
[30;1m519 | [0m[35m    def show_button_to_deep_link(self, browser:bool=False, display_handler_name:str=None)->None:[0m
[30;1m520 | [0m[35m        close_window_timeout_in_secs = 60 if self.options.get("query_link_destination") == "Kusto.Ex[0m
[30;1m521 | [0m[35m        deep_link_url = self.engine.get_deep_link(self.parametrized_query_obj.query, options=self.op[0m
[30;1m522 | [0m[35m[0m
[30;1m523 | [0m[35m        if deep_link_url is not None:  # only use deep links for kusto connection [0m

[31m--[ [0m[34mMatch #[0m[33m385[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m495 | [0m[35m[0m
[30;1m496 | [0m[35m            Display.showInfoMessage(feedback_info, display_handler_name='feedback_info', **self.opti[0m
[30;1m497 | [0m[35m[0m
[30;1m498 | [0m[35m            if self.display_info and self.options.get("show_query_link"):[0m
[30;1m499 | [0m[35m                self.show_button_to_deep_link(display_handler_name='deep_link')[0m
[30;1m500 | [0m[35m            else:[0m
[30;1m501 | [0m[35m                Display.showInfoMessage(None, display_handler_name='deep_link', **self.options)[0m

[31m--[ [0m[34mMatch #[0m[33m386[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m481 | [0m[35m        if not self.suppress_result:[0m
[30;1m482 | [0m[35m            feedback_warning = self.feedback_warning if self.display_info else None[0m
[30;1m483 | [0m[35m            conn_info = self._metadata.get("conn_info") if self.display_info else None[0m
[30;1m484 | [0m[35m            parametrized_query = self.parametrized_query_obj.query if self.display_info and self.opt[0m
[30;1m485 | [0m[35m            feedback_info = self.feedback_info if self.display_info else None[0m
[30;1m486 | [0m[35m[0m
[30;1m487 | [0m[35m            Display.showWarningMessage(feedback_warning, display_handler_name='feedback_warning', **[0m

[31m--[ [0m[34mMatch #[0m[33m387[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m480 | [0m[35m[0m
[30;1m481 | [0m[35m        if not self.suppress_result:[0m
[30;1m482 | [0m[35m            feedback_warning = self.feedback_warning if self.display_info else None[0m
[30;1m483 | [0m[35m            conn_info = self._metadata.get("conn_info") if self.display_info else None[0m
[30;1m484 | [0m[35m            parametrized_query = self.parametrized_query_obj.query if self.display_info and self.opt[0m
[30;1m485 | [0m[35m            feedback_info = self.feedback_info if self.display_info else None[0m
[30;1m486 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m388[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m441 | [0m[35m[0m
[30;1m442 | [0m[35m[0m
[30;1m443 | [0m[35m    def fork_result(self, fork_table_id:int=0):[0m
[30;1m444 | [0m[35m        # return self._fork_table_resultSets.get(str(fork_table_id))[0m
[30;1m445 | [0m[35m        return self._fork_table_resultSets[str(fork_table_id)][0m
[30;1m446 | [0m[35m[0m
[30;1m447 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m389[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m435 | [0m[35m                    r.display_info = True[0m
[30;1m436 | [0m[35m                    r.suppress_result = False[0m
[30;1m437 | [0m[35m                    if r.options.get("feedback"):[0m
[30;1m438 | [0m[35m                        if r.options.get("show_query_time"):[0m
[30;1m439 | [0m[35m                            minutes, seconds = divmod(self.elapsed_timespan, 60)[0m
[30;1m440 | [0m[35m                            r.feedback_info.append("Done ({:0>2}:{:06.3f}): {} records".format(int(m[0m
[30;1m441 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m390[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m434 | [0m[35m                    r.feedback_warning = [][0m
[30;1m435 | [0m[35m                    r.display_info = True[0m
[30;1m436 | [0m[35m                    r.suppress_result = False[0m
[30;1m437 | [0m[35m                    if r.options.get("feedback"):[0m
[30;1m438 | [0m[35m                        if r.options.get("show_query_time"):[0m
[30;1m439 | [0m[35m                            minutes, seconds = divmod(self.elapsed_timespan, 60)[0m
[30;1m440 | [0m[35m                            r.feedback_info.append("Done ({:0>2}:{:06.3f}): {} records".format(int(m[0m

[31m--[ [0m[34mMatch #[0m[33m391[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m420 | [0m[35m            for fork_table_id in range(1, len(self._queryResult.tables)):[0m
[30;1m421 | [0m[35m                r = ResultSet(self._metadata, self._queryResult, fork_table_id=fork_table_id, fork_t[0m
[30;1m422 | [0m[35m                if r.options.get("feedback"):[0m
[30;1m423 | [0m[35m                    if r.options.get("show_query_time"):[0m
[30;1m424 | [0m[35m                        minutes, seconds = divmod(self.elapsed_timespan, 60)[0m
[30;1m425 | [0m[35m                        r.feedback_info.append("Done ({:0>2}:{:06.3f}): {} records".format(int(minut[0m
[30;1m426 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m392[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m419 | [0m[35md == 0 and len(self._fork_table_resultSets) == 1:[0m
[30;1m420 | [0m[35m            for fork_table_id in range(1, len(self._queryResult.tables)):[0m
[30;1m421 | [0m[35m                r = ResultSet(self._metadata, self._queryResult, fork_table_id=fork_table_id, fork_t[0m
[30;1m422 | [0m[35m                if r.options.get("feedback"):[0m
[30;1m423 | [0m[35m                    if r.options.get("show_query_time"):[0m
[30;1m424 | [0m[35m                        minutes, seconds = divmod(self.elapsed_timespan, 60)[0m
[30;1m425 | [0m[35m                        r.feedback_info.append("Done ({:0>2}:{:06.3f}): {} records".format(int(minut[0m
[30;1m426 | [0m[35m[0m
[30;1m427 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m393[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m397 | [0m[35m        self.visualization_properties = queryResultTable.extended_properties.get(ExtendedPropertiesK[0m
[30;1m398 | [0m[35m        self._cursor = queryResultTable.extended_properties.get(ExtendedPropertiesKeys.CURSOR, "")[0m
[30;1m399 | [0m[35m        # table[0m
[30;1m400 | [0m[35m        auto_limit = 0 if not self.options.get("auto_limit") else self.options.get("auto_limit")[0m
[30;1m401 | [0m[35m        if queryResultTable.returns_rows():[0m
[30;1m402 | [0m[35m            if auto_limit > 0:[0m
[30;1m403 | [0m[35m                list.__init__(self, queryResultTable.fetchmany(size=auto_limit))[0m

[31m--[ [0m[34mMatch #[0m[33m394[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m397 | [0m[35m        self.visualization_properties = queryResultTable.extended_properties.get(ExtendedPropertiesK[0m
[30;1m398 | [0m[35m        self._cursor = queryResultTable.extended_properties.get(ExtendedPropertiesKeys.CURSOR, "")[0m
[30;1m399 | [0m[35m        # table[0m
[30;1m400 | [0m[35m        auto_limit = 0 if not self.options.get("auto_limit") else self.options.get("auto_limit")[0m
[30;1m401 | [0m[35m        if queryResultTable.returns_rows():[0m
[30;1m402 | [0m[35m            if auto_limit > 0:[0m
[30;1m403 | [0m[35m                list.__init__(self, queryResultTable.fetchmany(size=auto_limit))[0m

[31m--[ [0m[34mMatch #[0m[33m395[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m395 | [0m[35m        self.records_count = queryResultTable.recordscount()[0m
[30;1m396 | [0m[35m        self.is_partial_table = queryResultTable.ispartial()[0m
[30;1m397 | [0m[35m        self.visualization_properties = queryResultTable.extended_properties.get(ExtendedPropertiesK[0m
[30;1m398 | [0m[35m        self._cursor = queryResultTable.extended_properties.get(ExtendedPropertiesKeys.CURSOR, "")[0m
[30;1m399 | [0m[35m        # table[0m
[30;1m400 | [0m[35m        auto_limit = 0 if not self.options.get("auto_limit") else self.options.get("auto_limit")[0m
[30;1m401 | [0m[35m        if queryResultTable.returns_rows():[0m

[31m--[ [0m[34mMatch #[0m[33m396[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m394 | [0m[35m        self.pretty = None[0m
[30;1m395 | [0m[35m        self.records_count = queryResultTable.recordscount()[0m
[30;1m396 | [0m[35m        self.is_partial_table = queryResultTable.ispartial()[0m
[30;1m397 | [0m[35m        self.visualization_properties = queryResultTable.extended_properties.get(ExtendedPropertiesK[0m
[30;1m398 | [0m[35m        self._cursor = queryResultTable.extended_properties.get(ExtendedPropertiesKeys.CURSOR, "")[0m
[30;1m399 | [0m[35m        # table[0m
[30;1m400 | [0m[35m        auto_limit = 0 if not self.options.get("auto_limit") else self.options.get("auto_limit")[0m

[31m--[ [0m[34mMatch #[0m[33m397[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m369 | [0m[35m        if deep_link_url is not None:[0m
[30;1m370 | [0m[35m            logger().debug("ResultSet::deep_link - url: {deep_link_url}")[0m
[30;1m371 | [0m[35m            qld = _options.get("query_link_destination").lower().replace('.', '_')[0m
[30;1m372 | [0m[35m            close_window_timeout_in_secs = 60 if _options.get("query_link_destination") == "Kusto.Ex[0m
[30;1m373 | [0m[35m            # close opening window only for Kusto.Explorer app, for Kusto.WebExplorer leave window[0m
[30;1m374 | [0m[35m            html_obj = Display.get_show_deeplink_html_obj(f"query_link_{qld}", deep_link_url, close_[0m
[30;1m375 | [0m[35m            return html_obj[0m

[31m--[ [0m[34mMatch #[0m[33m398[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m366 | [0m[35mns[0m
[30;1m367 | [0m[35m        deep_link_url = self.engine.get_deep_link(self.parametrized_query_obj.query, options=_option[0m
[30;1m368 | [0m[35m        # only use deep links for kusto connection[0m
[30;1m369 | [0m[35m        if deep_link_url is not None:[0m
[30;1m370 | [0m[35m            logger().debug("ResultSet::deep_link - url: {deep_link_url}")[0m
[30;1m371 | [0m[35m            qld = _options.get("query_link_destination").lower().replace('.', '_')[0m
[30;1m372 | [0m[35m            close_window_timeout_in_secs = 60 if _options.get("query_link_destination") == "Kusto.Ex[0m
[30;1m373 | [0m[35m            # close opening window only for Kusto.Explorer app, for Kusto.WebExplorer leave window[0m

[31m--[ [0m[34mMatch #[0m[33m399[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m357 | [0m[35m    # Public API   [0m
[30;1m358 | [0m[35m    @property[0m
[30;1m359 | [0m[35m    def title(self)->str:[0m
[30;1m360 | [0m[35m        return self.visualization_properties.get(VisualizationKeys.TITLE)[0m
[30;1m361 | [0m[35m[0m
[30;1m362 | [0m[35m    # Public API[0m
[30;1m363 | [0m[35m    def deep_link(self, qld_param:str=None):[0m

[31m--[ [0m[34mMatch #[0m[33m400[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m345 | [0m[35m    # Public API   [0m
[30;1m346 | [0m[35m    @property[0m
[30;1m347 | [0m[35m    def visualization(self):[0m
[30;1m348 | [0m[35m        return self.visualization_properties.get(VisualizationKeys.VISUALIZATION)[0m
[30;1m349 | [0m[35m[0m
[30;1m350 | [0m[35m[0m
[30;1m351 | [0m[35m    # Public API   [0m

[31m--[ [0m[34mMatch #[0m[33m401[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m333 | [0m[35m    # Public API   [0m
[30;1m334 | [0m[35m    @property[0m
[30;1m335 | [0m[35m    def end_time(self)->float:[0m
[30;1m336 | [0m[35m        return self._metadata.get("end_time")[0m
[30;1m337 | [0m[35m[0m
[30;1m338 | [0m[35m[0m
[30;1m339 | [0m[35m    # Public API   [0m

[31m--[ [0m[34mMatch #[0m[33m402[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m327 | [0m[35m    # Public API   [0m
[30;1m328 | [0m[35m    @property[0m
[30;1m329 | [0m[35m    def start_time(self)->float:[0m
[30;1m330 | [0m[35m        return self._metadata.get("start_time")[0m
[30;1m331 | [0m[35m[0m
[30;1m332 | [0m[35m[0m
[30;1m333 | [0m[35m    # Public API   [0m

[31m--[ [0m[34mMatch #[0m[33m403[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m321 | [0m[35m    # Public API   [0m
[30;1m322 | [0m[35m    @property[0m
[30;1m323 | [0m[35m    def connection(self)->str:[0m
[30;1m324 | [0m[35m        return self._metadata.get("conn_name")[0m
[30;1m325 | [0m[35m[0m
[30;1m326 | [0m[35m[0m
[30;1m327 | [0m[35m    # Public API   [0m

[31m--[ [0m[34mMatch #[0m[33m404[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m315 | [0m[35m    # Public API   [0m
[30;1m316 | [0m[35m    @property[0m
[30;1m317 | [0m[35m    def palettes(self)->Palettes:[0m
[30;1m318 | [0m[35m        return Palettes(n_colors=self.options.get("palette_colors"), desaturation=self.options.get("[0m
[30;1m319 | [0m[35m[0m
[30;1m320 | [0m[35m[0m
[30;1m321 | [0m[35m    # Public API   [0m

[31m--[ [0m[34mMatch #[0m[33m405[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m315 | [0m[35m    # Public API   [0m
[30;1m316 | [0m[35m    @property[0m
[30;1m317 | [0m[35m    def palettes(self)->Palettes:[0m
[30;1m318 | [0m[35m        return Palettes(n_colors=self.options.get("palette_colors"), desaturation=self.options.get("[0m
[30;1m319 | [0m[35m[0m
[30;1m320 | [0m[35m[0m
[30;1m321 | [0m[35m    # Public API   [0m

[31m--[ [0m[34mMatch #[0m[33m406[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m309 | [0m[35m    # Public API   [0m
[30;1m310 | [0m[35m    @property[0m
[30;1m311 | [0m[35m    def palette(self):[0m
[30;1m312 | [0m[35m        return self._metadata.get("palette")[0m
[30;1m313 | [0m[35m[0m
[30;1m314 | [0m[35m[0m
[30;1m315 | [0m[35m    # Public API   [0m

[31m--[ [0m[34mMatch #[0m[33m407[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m303 | [0m[35m    # Public API   [0m
[30;1m304 | [0m[35m    @property[0m
[30;1m305 | [0m[35m    def plotly_fig(self):[0m
[30;1m306 | [0m[35m        return self._metadata.get("chart_figure")[0m
[30;1m307 | [0m[35m[0m
[30;1m308 | [0m[35m[0m
[30;1m309 | [0m[35m    # Public API   [0m

[31m--[ [0m[34mMatch #[0m[33m408[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m297 | [0m[35m    # Public API   [0m
[30;1m298 | [0m[35m    @property[0m
[30;1m299 | [0m[35m    def query(self)->str:[0m
[30;1m300 | [0m[35m        return self._metadata.get("parsed").get("query").strip()[0m
[30;1m301 | [0m[35m[0m
[30;1m302 | [0m[35m[0m
[30;1m303 | [0m[35m    # Public API   [0m

[31m--[ [0m[34mMatch #[0m[33m409[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m297 | [0m[35m    # Public API   [0m
[30;1m298 | [0m[35m    @property[0m
[30;1m299 | [0m[35m    def query(self)->str:[0m
[30;1m300 | [0m[35m        return self._metadata.get("parsed").get("query").strip()[0m
[30;1m301 | [0m[35m[0m
[30;1m302 | [0m[35m[0m
[30;1m303 | [0m[35m    # Public API   [0m

[31m--[ [0m[34mMatch #[0m[33m410[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m276 | [0m[35m            palette_name=name,[0m
[30;1m277 | [0m[35m            n_colors=length,[0m
[30;1m278 | [0m[35m            desaturation=desaturation or self.options.get("palette_desaturation"),[0m
[30;1m279 | [0m[35m            to_reverse=self.options.get("palette_reverse"),[0m
[30;1m280 | [0m[35m        )[0m
[30;1m281 | [0m[35m        return self.palette[0m
[30;1m282 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m411[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m275 | [0m[35m        self._metadata["palette"] = Palette([0m
[30;1m276 | [0m[35m            palette_name=name,[0m
[30;1m277 | [0m[35m            n_colors=length,[0m
[30;1m278 | [0m[35m            desaturation=desaturation or self.options.get("palette_desaturation"),[0m
[30;1m279 | [0m[35m            to_reverse=self.options.get("palette_reverse"),[0m
[30;1m280 | [0m[35m        )[0m
[30;1m281 | [0m[35m        return self.palette[0m

[31m--[ [0m[34mMatch #[0m[33m412[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m271 | [0m[35m[0m
[30;1m272 | [0m[35m    def _get_palette(self, n_colors:int=None, desaturation:float=None):[0m
[30;1m273 | [0m[35m        name = self.options.get("palette_name")[0m
[30;1m274 | [0m[35m        length = max(n_colors or 10, self.options.get("palette_colors") or 10)[0m
[30;1m275 | [0m[35m        self._metadata["palette"] = Palette([0m
[30;1m276 | [0m[35m            palette_name=name,[0m
[30;1m277 | [0m[35m            n_colors=length,[0m

[31m--[ [0m[34mMatch #[0m[33m413[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m270 | [0m[35m[0m
[30;1m271 | [0m[35m[0m
[30;1m272 | [0m[35m    def _get_palette(self, n_colors:int=None, desaturation:float=None):[0m
[30;1m273 | [0m[35m        name = self.options.get("palette_name")[0m
[30;1m274 | [0m[35m        length = max(n_colors or 10, self.options.get("palette_colors") or 10)[0m
[30;1m275 | [0m[35m        self._metadata["palette"] = Palette([0m
[30;1m276 | [0m[35m            palette_name=name,[0m

[31m--[ [0m[34mMatch #[0m[33m414[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m266 | [0m[35m        self._metadata = metadata[0m
[30;1m267 | [0m[35m        self.parametrized_query_obj = metadata.get('parametrized_query_obj')[0m
[30;1m268 | [0m[35m        self.options = metadata['parsed'].get('options') or {}[0m
[30;1m269 | [0m[35m        self.engine = metadata.get('engine')[0m
[30;1m270 | [0m[35m[0m
[30;1m271 | [0m[35m[0m
[30;1m272 | [0m[35m    def _get_palette(self, n_colors:int=None, desaturation:float=None):[0m

[31m--[ [0m[34mMatch #[0m[33m415[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m265 | [0m[35m    def _update_metadata(self, metadata:Dict[str,Any])->None:[0m
[30;1m266 | [0m[35m        self._metadata = metadata[0m
[30;1m267 | [0m[35m        self.parametrized_query_obj = metadata.get('parametrized_query_obj')[0m
[30;1m268 | [0m[35m        self.options = metadata['parsed'].get('options') or {}[0m
[30;1m269 | [0m[35m        self.engine = metadata.get('engine')[0m
[30;1m270 | [0m[35m[0m
[30;1m271 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m416[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m264 | [0m[35m[0m
[30;1m265 | [0m[35m    def _update_metadata(self, metadata:Dict[str,Any])->None:[0m
[30;1m266 | [0m[35m        self._metadata = metadata[0m
[30;1m267 | [0m[35m        self.parametrized_query_obj = metadata.get('parametrized_query_obj')[0m
[30;1m268 | [0m[35m        self.options = metadata['parsed'].get('options') or {}[0m
[30;1m269 | [0m[35m        self.engine = metadata.get('engine')[0m
[30;1m270 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m417[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m    def _file_location_message(self):[0m
[30;1m130 | [0m[35m        file_location = os.path.join(os.path.abspath("."), self.file_or_image)[0m
[30;1m131 | [0m[35m        return f"{self.message} at {file_location}"[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m    # Printable unambiguous presentation of the object[0m

[31m--[ [0m[34mMatch #[0m[33m418[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1525 | [0m[35m            return None[0m
[30;1m1526 | [0m[35m        chart_properties = self._get_plotly_chart_properties(properties, self.chart_sub_tables, opti[0m
[30;1m1527 | [0m[35m[0m
[30;1m1528 | [0m[35m        # create stack one on top of each other[0m
[30;1m1529 | [0m[35m        # TODO: chack newer version of plotly, support it better[0m
[30;1m1530 | [0m[35m        ys_stcks = [][0m
[30;1m1531 | [0m[35m        y_stck = [0 for x in range(len(self.chart_sub_tables[0]))][0m

[31m--[ [0m[34mMatch #[0m[33m419[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1048 | [0m[35m                return {"body": image_html_str}[0m
[30;1m1049 | [0m[35m                [0m
[30;1m1050 | [0m[35m            elif window_mode:[0m
[30;1m1051 | [0m[35m                head = '<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>' if not sel[0m
[30;1m1052 | [0m[35m                plotly = Dependencies.get_module('plotly')[0m
[30;1m1053 | [0m[35m                body = plotly.offline.plot([0m
[30;1m1054 | [0m[35m                    chart_figure,[0m

[31m--[ [0m[34mMatch #[0m[33m420[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1020 | [0m[35m            # not supported yet[0m
[30;1m1021 | [0m[35m            return {}[0m
[30;1m1022 | [0m[35m[0m
[30;1m1023 | [0m[35m        # Interactive navigation over the events time-line (pivoting on time axis)[0m
[30;1m1024 | [0m[35m        elif self.visualization == VisualizationValues.TIME_PIVOT:[0m
[30;1m1025 | [0m[35m            # not supported yet[0m
[30;1m1026 | [0m[35m            return {}[0m

[31m--[ [0m[34mMatch #[0m[33m421[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m965 | [0m[35m[0m
[30;1m966 | [0m[35m        if len(self) == 0:[0m
[30;1m967 | [0m[35m            id = uuid.uuid4().hex[0m
[30;1m968 | [0m[35m            head = ([0m
[30;1m969 | [0m[35m                f"""<style>#uuid-{id} {{[0m
[30;1m970 | [0m[35m                    display: block; [0m
[30;1m971 | [0m[35m                    font-style:italic;[0m

[31m--[ [0m[34mMatch #[0m[33m422[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/results.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35mimport os.path[0m
[30;1m12 | [0m[35mimport re[0m
[30;1m13 | [0m[35mimport uuid[0m
[30;1m14 | [0m[35mimport base64[0m
[30;1m15 | [0m[35mimport json[0m
[30;1m16 | [0m[35mimport io[0m
[30;1m17 | [0m[35mfrom typing import Any, Union, Dict[0m

[31m--[ [0m[34mMatch #[0m[33m423[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m    @classmethod[0m
[30;1m211 | [0m[35m    def try_init_ipython_matplotlib_magic(cls, **options)->bool:[0m
[30;1m212 | [0m[35m        matplotlib_magic_command = "inline" if options.get('notebook_app') != "ipython" else "qt"[0m
[30;1m213 | [0m[35m        ip = cls._get_ipython()[0m
[30;1m214 | [0m[35m        if ip is not None:[0m
[30;1m215 | [0m[35m            try:[0m

[31m--[ [0m[34mMatch #[0m[33m424[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m160 | [0m[35m            for link in help_links:[0m
[30;1m161 | [0m[35m                # if found update url[0m
[30;1m162 | [0m[35m                if link.get("text") == text:[0m
[30;1m163 | [0m[35m                    if link.get("url") != url:[0m
[30;1m164 | [0m[35m                        link["url"] = url[0m
[30;1m165 | [0m[35m                    else:[0m
[30;1m166 | [0m[35m                        reconnect = False[0m

[31m--[ [0m[34mMatch #[0m[33m425[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m159 | [0m[35m            found = False[0m
[30;1m160 | [0m[35m            for link in help_links:[0m
[30;1m161 | [0m[35m                # if found update url[0m
[30;1m162 | [0m[35m                if link.get("text") == text:[0m
[30;1m163 | [0m[35m                    if link.get("url") != url:[0m
[30;1m164 | [0m[35m                        link["url"] = url[0m
[30;1m165 | [0m[35m                    else:[0m

[31m--[ [0m[34mMatch #[0m[33m426[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35m    @classmethod[0m
[30;1m146 | [0m[35m    def try_kernel_reconnect(cls, **options)->bool:[0m
[30;1m147 | [0m[35m        if options is None or options.get("notebook_app") not in ["jupyterlab", "visualstudiocode", [0m
[30;1m148 | [0m[35m            result = cls.try_kernel_execute("""try {IPython.notebook.kernel.reconnect();} catch(err)[0m
[30;1m149 | [0m[35m            time.sleep(1)[0m
[30;1m150 | [0m[35m            return result[0m

[31m--[ [0m[34mMatch #[0m[33m427[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m107 | [0m[35m        help_links = None[0m
[30;1m108 | [0m[35m        ip = cls._get_ipython()[0m
[30;1m109 | [0m[35m        if ip is not None and hasattr(ip, "kernel") and hasattr(ip.kernel, "_trait_values"):[0m
[30;1m110 | [0m[35m            help_links = ip.kernel._trait_values.get("help_links")[0m
[30;1m111 | [0m[35m        return help_links[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m428[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m    @classmethod[0m
[30;1m74 | [0m[35m    def get_ipython_root_path(cls, **options)->str:[0m
[30;1m75 | [0m[35m        temp_folder_location = options.get("temp_folder_location")[0m
[30;1m76 | [0m[35m        root_path = None[0m
[30;1m77 | [0m[35m        if temp_folder_location == "starting_dir":[0m
[30;1m78 | [0m[35m            ip = cls._get_ipython()[0m

[31m--[ [0m[34mMatch #[0m[33m429[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m298 | [0m[35m    def try_remove_input_transformers_cleanup(cls, transformer_func:Callable[[Iterable], Iterable])-[0m
[30;1m299 | [0m[35m        try:[0m
[30;1m300 | [0m[35m            ip = cls._get_ipython()[0m
[30;1m301 | [0m[35m            if ip is not None:[0m
[30;1m302 | [0m[35m                if cls.is_in_input_transformers_cleanup(transformer_func):[0m
[30;1m303 | [0m[35m                    ip.input_transformers_cleanup.remove(transformer_func)[0m
[30;1m304 | [0m[35m                return True[0m

[31m--[ [0m[34mMatch #[0m[33m430[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m297 | [0m[35m    @classmethod[0m
[30;1m298 | [0m[35m    def try_remove_input_transformers_cleanup(cls, transformer_func:Callable[[Iterable], Iterable])-[0m
[30;1m299 | [0m[35m        try:[0m
[30;1m300 | [0m[35m            ip = cls._get_ipython()[0m
[30;1m301 | [0m[35m            if ip is not None:[0m
[30;1m302 | [0m[35m                if cls.is_in_input_transformers_cleanup(transformer_func):[0m
[30;1m303 | [0m[35m                    ip.input_transformers_cleanup.remove(transformer_func)[0m

[31m--[ [0m[34mMatch #[0m[33m431[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m286 | [0m[35m        cls.try_remove_input_transformers_cleanup(transformer_func) # to make sure it within list on[0m
[30;1m287 | [0m[35m        try:[0m
[30;1m288 | [0m[35m            ip = cls._get_ipython()[0m
[30;1m289 | [0m[35m            if ip is not None:[0m
[30;1m290 | [0m[35m                ip.input_transformers_cleanup.append(transformer_func)[0m
[30;1m291 | [0m[35m                return True[0m
[30;1m292 | [0m[35m        except: # pylint: disable=bare-except[0m

[31m--[ [0m[34mMatch #[0m[33m432[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m285 | [0m[35m    def try_add_input_transformers_cleanup(cls, transformer_func:Callable[[Iterable], Iterable])->bo[0m
[30;1m286 | [0m[35m        cls.try_remove_input_transformers_cleanup(transformer_func) # to make sure it within list on[0m
[30;1m287 | [0m[35m        try:[0m
[30;1m288 | [0m[35m            ip = cls._get_ipython()[0m
[30;1m289 | [0m[35m            if ip is not None:[0m
[30;1m290 | [0m[35m                ip.input_transformers_cleanup.append(transformer_func)[0m
[30;1m291 | [0m[35m                return True[0m

[31m--[ [0m[34mMatch #[0m[33m433[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m274 | [0m[35m    def is_in_input_transformers_cleanup(cls, transformer_func:Callable[[Iterable], Iterable])->bool[0m
[30;1m275 | [0m[35m        try:[0m
[30;1m276 | [0m[35m            ip = cls._get_ipython()[0m
[30;1m277 | [0m[35m            if ip is not None:[0m
[30;1m278 | [0m[35m                return transformer_func in ip.input_transformers_cleanup[0m
[30;1m279 | [0m[35m        except: # pylint: disable=bare-except[0m
[30;1m280 | [0m[35m            pass[0m

[31m--[ [0m[34mMatch #[0m[33m434[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m273 | [0m[35m    @classmethod[0m
[30;1m274 | [0m[35m    def is_in_input_transformers_cleanup(cls, transformer_func:Callable[[Iterable], Iterable])->bool[0m
[30;1m275 | [0m[35m        try:[0m
[30;1m276 | [0m[35m            ip = cls._get_ipython()[0m
[30;1m277 | [0m[35m            if ip is not None:[0m
[30;1m278 | [0m[35m                return transformer_func in ip.input_transformers_cleanup[0m
[30;1m279 | [0m[35m        except: # pylint: disable=bare-except[0m

[31m--[ [0m[34mMatch #[0m[33m435[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m263 | [0m[35m        tr_cell = cell[0m
[30;1m264 | [0m[35m        try:[0m
[30;1m265 | [0m[35m            ip = cls._get_ipython()[0m
[30;1m266 | [0m[35m            if ip is not None:[0m
[30;1m267 | [0m[35m                tr_cell = ip.input_transformer_manager.transform_cell(cell)[0m
[30;1m268 | [0m[35m        except: # pylint: disable=bare-except[0m
[30;1m269 | [0m[35m            pass[0m

[31m--[ [0m[34mMatch #[0m[33m436[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m262 | [0m[35m    def transform_cell(cls, cell:str)->str:[0m
[30;1m263 | [0m[35m        tr_cell = cell[0m
[30;1m264 | [0m[35m        try:[0m
[30;1m265 | [0m[35m            ip = cls._get_ipython()[0m
[30;1m266 | [0m[35m            if ip is not None:[0m
[30;1m267 | [0m[35m                tr_cell = ip.input_transformer_manager.transform_cell(cell)[0m
[30;1m268 | [0m[35m        except: # pylint: disable=bare-except[0m

[31m--[ [0m[34mMatch #[0m[33m437[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m236 | [0m[35m    @classmethod[0m
[30;1m237 | [0m[35m    def run_line_magic(cls, name:str, body:str)->Any:[0m
[30;1m238 | [0m[35m        ip = cls._get_ipython()[0m
[30;1m239 | [0m[35m        if ip is not None:[0m
[30;1m240 | [0m[35m            return ip.run_line_magic(name, body)[0m
[30;1m241 | [0m[35m        else:[0m
[30;1m242 | [0m[35m            raise Exception("not python kernel, can't execute line magic")[0m

[31m--[ [0m[34mMatch #[0m[33m438[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m235 | [0m[35m[0m
[30;1m236 | [0m[35m    @classmethod[0m
[30;1m237 | [0m[35m    def run_line_magic(cls, name:str, body:str)->Any:[0m
[30;1m238 | [0m[35m        ip = cls._get_ipython()[0m
[30;1m239 | [0m[35m        if ip is not None:[0m
[30;1m240 | [0m[35m            return ip.run_line_magic(name, body)[0m
[30;1m241 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m439[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m227 | [0m[35m    @classmethod[0m
[30;1m228 | [0m[35m    def run_cell_magic(cls, name:str, line:str, cell:str)->Any:[0m
[30;1m229 | [0m[35m        ip = cls._get_ipython()[0m
[30;1m230 | [0m[35m        if ip is not None:[0m
[30;1m231 | [0m[35m            return ip.run_cell_magic(name, line, cell)[0m
[30;1m232 | [0m[35m        else:[0m
[30;1m233 | [0m[35m            raise Exception("not python kernel, can't execute cell magic")[0m

[31m--[ [0m[34mMatch #[0m[33m440[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m    @classmethod[0m
[30;1m228 | [0m[35m    def run_cell_magic(cls, name:str, line:str, cell:str)->Any:[0m
[30;1m229 | [0m[35m        ip = cls._get_ipython()[0m
[30;1m230 | [0m[35m        if ip is not None:[0m
[30;1m231 | [0m[35m            return ip.run_cell_magic(name, line, cell)[0m
[30;1m232 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m441[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m211 | [0m[35m    def try_init_ipython_matplotlib_magic(cls, **options)->bool:[0m
[30;1m212 | [0m[35m        matplotlib_magic_command = "inline" if options.get('notebook_app') != "ipython" else "qt"[0m
[30;1m213 | [0m[35m        ip = cls._get_ipython()[0m
[30;1m214 | [0m[35m        if ip is not None:[0m
[30;1m215 | [0m[35m            try:[0m
[30;1m216 | [0m[35m                ip.magic(f"matplotlib {matplotlib_magic_command}")[0m
[30;1m217 | [0m[35m                return True[0m

[31m--[ [0m[34mMatch #[0m[33m442[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m210 | [0m[35m    @classmethod[0m
[30;1m211 | [0m[35m    def try_init_ipython_matplotlib_magic(cls, **options)->bool:[0m
[30;1m212 | [0m[35m        matplotlib_magic_command = "inline" if options.get('notebook_app') != "ipython" else "qt"[0m
[30;1m213 | [0m[35m        ip = cls._get_ipython()[0m
[30;1m214 | [0m[35m        if ip is not None:[0m
[30;1m215 | [0m[35m            try:[0m
[30;1m216 | [0m[35m                ip.magic(f"matplotlib {matplotlib_magic_command}")[0m

[31m--[ [0m[34mMatch #[0m[33m443[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m199 | [0m[35m    @classmethod[0m
[30;1m200 | [0m[35m    def try_register_to_ipython_atexit(cls, func, *args)->bool:[0m
[30;1m201 | [0m[35m        ip = cls._get_ipython()[0m
[30;1m202 | [0m[35m        if ip is not None:[0m
[30;1m203 | [0m[35m            try:[0m
[30;1m204 | [0m[35m                import atexit[0m
[30;1m205 | [0m[35m                atexit.register(func, *args)  [0m

[31m--[ [0m[34mMatch #[0m[33m444[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m198 | [0m[35m[0m
[30;1m199 | [0m[35m    @classmethod[0m
[30;1m200 | [0m[35m    def try_register_to_ipython_atexit(cls, func, *args)->bool:[0m
[30;1m201 | [0m[35m        ip = cls._get_ipython()[0m
[30;1m202 | [0m[35m        if ip is not None:[0m
[30;1m203 | [0m[35m            try:[0m
[30;1m204 | [0m[35m                import atexit[0m

[31m--[ [0m[34mMatch #[0m[33m445[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m189 | [0m[35m    @classmethod[0m
[30;1m190 | [0m[35m    def try_add_to_ipython_tempdirs(cls, foldername:str, **options)->bool:[0m
[30;1m191 | [0m[35m        ip = cls._get_ipython()[0m
[30;1m192 | [0m[35m        if ip is not None:[0m
[30;1m193 | [0m[35m            ip.tempdirs.append(foldername)[0m
[30;1m194 | [0m[35m            return True[0m
[30;1m195 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m446[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m    @classmethod[0m
[30;1m190 | [0m[35m    def try_add_to_ipython_tempdirs(cls, foldername:str, **options)->bool:[0m
[30;1m191 | [0m[35m        ip = cls._get_ipython()[0m
[30;1m192 | [0m[35m        if ip is not None:[0m
[30;1m193 | [0m[35m            ip.tempdirs.append(foldername)[0m
[30;1m194 | [0m[35m            return True[0m

[31m--[ [0m[34mMatch #[0m[33m447[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m179 | [0m[35m    @classmethod[0m
[30;1m180 | [0m[35m    def try_add_to_ipython_tempfiles(cls, filename:str, **options)->bool:[0m
[30;1m181 | [0m[35m        ip = cls._get_ipython()[0m
[30;1m182 | [0m[35m        if ip is not None:[0m
[30;1m183 | [0m[35m            ip.tempfiles.append(filename)[0m
[30;1m184 | [0m[35m            return True[0m
[30;1m185 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m448[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m178 | [0m[35m[0m
[30;1m179 | [0m[35m    @classmethod[0m
[30;1m180 | [0m[35m    def try_add_to_ipython_tempfiles(cls, filename:str, **options)->bool:[0m
[30;1m181 | [0m[35m        ip = cls._get_ipython()[0m
[30;1m182 | [0m[35m        if ip is not None:[0m
[30;1m183 | [0m[35m            ip.tempfiles.append(filename)[0m
[30;1m184 | [0m[35m            return True[0m

[31m--[ [0m[34mMatch #[0m[33m449[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m132 | [0m[35m    @classmethod[0m
[30;1m133 | [0m[35m    def try_kernel_execute(cls, javascript_statement:str, **options)->bool:[0m
[30;1m134 | [0m[35m        ip = cls._get_ipython()[0m
[30;1m135 | [0m[35m        if ip is not None:[0m
[30;1m136 | [0m[35m            try:[0m
[30;1m137 | [0m[35m                ip.run_cell_magic('javascript', '', javascript_statement)[0m
[30;1m138 | [0m[35m                return True[0m

[31m--[ [0m[34mMatch #[0m[33m450[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m    @classmethod[0m
[30;1m133 | [0m[35m    def try_kernel_execute(cls, javascript_statement:str, **options)->bool:[0m
[30;1m134 | [0m[35m        ip = cls._get_ipython()[0m
[30;1m135 | [0m[35m        if ip is not None:[0m
[30;1m136 | [0m[35m            try:[0m
[30;1m137 | [0m[35m                ip.run_cell_magic('javascript', '', javascript_statement)[0m

[31m--[ [0m[34mMatch #[0m[33m451[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m124 | [0m[35m    def _get_ipython_db(cls, **options):[0m
[30;1m125 | [0m[35m        db = None[0m
[30;1m126 | [0m[35m        ip = cls._get_ipython()[0m
[30;1m127 | [0m[35m        if ip is not None:[0m
[30;1m128 | [0m[35m            db = ip.db[0m
[30;1m129 | [0m[35m        return db[0m
[30;1m130 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m452[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m123 | [0m[35m    @classmethod[0m
[30;1m124 | [0m[35m    def _get_ipython_db(cls, **options):[0m
[30;1m125 | [0m[35m        db = None[0m
[30;1m126 | [0m[35m        ip = cls._get_ipython()[0m
[30;1m127 | [0m[35m        if ip is not None:[0m
[30;1m128 | [0m[35m            db = ip.db[0m
[30;1m129 | [0m[35m        return db[0m

[31m--[ [0m[34mMatch #[0m[33m453[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m115 | [0m[35m    def has_ipython_kernel(cls)->bool:[0m
[30;1m116 | [0m[35m        has_kernel = False[0m
[30;1m117 | [0m[35m        ip = cls._get_ipython()[0m
[30;1m118 | [0m[35m        if ip is not None:[0m
[30;1m119 | [0m[35m            has_kernel = hasattr(ip, "kernel")[0m
[30;1m120 | [0m[35m        return has_kernel[0m
[30;1m121 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m454[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m114 | [0m[35m    @classmethod[0m
[30;1m115 | [0m[35m    def has_ipython_kernel(cls)->bool:[0m
[30;1m116 | [0m[35m        has_kernel = False[0m
[30;1m117 | [0m[35m        ip = cls._get_ipython()[0m
[30;1m118 | [0m[35m        if ip is not None:[0m
[30;1m119 | [0m[35m            has_kernel = hasattr(ip, "kernel")[0m
[30;1m120 | [0m[35m        return has_kernel[0m

[31m--[ [0m[34mMatch #[0m[33m455[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m106 | [0m[35m    def _get_ipython_help_links(cls, **options)->list:[0m
[30;1m107 | [0m[35m        help_links = None[0m
[30;1m108 | [0m[35m        ip = cls._get_ipython()[0m
[30;1m109 | [0m[35m        if ip is not None and hasattr(ip, "kernel") and hasattr(ip.kernel, "_trait_values"):[0m
[30;1m110 | [0m[35m            help_links = ip.kernel._trait_values.get("help_links")[0m
[30;1m111 | [0m[35m        return help_links[0m
[30;1m112 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m456[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m105 | [0m[35m    @classmethod[0m
[30;1m106 | [0m[35m    def _get_ipython_help_links(cls, **options)->list:[0m
[30;1m107 | [0m[35m        help_links = None[0m
[30;1m108 | [0m[35m        ip = cls._get_ipython()[0m
[30;1m109 | [0m[35m        if ip is not None and hasattr(ip, "kernel") and hasattr(ip.kernel, "_trait_values"):[0m
[30;1m110 | [0m[35m            help_links = ip.kernel._trait_values.get("help_links")[0m
[30;1m111 | [0m[35m        return help_links[0m

[31m--[ [0m[34mMatch #[0m[33m457[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m76 | [0m[35m        root_path = None[0m
[30;1m77 | [0m[35m        if temp_folder_location == "starting_dir":[0m
[30;1m78 | [0m[35m            ip = cls._get_ipython()[0m
[30;1m79 | [0m[35m            if ip is not None:[0m
[30;1m80 | [0m[35m                root_path = ip.starting_dir[0m
[30;1m81 | [0m[35m        if root_path is None:[0m
[30;1m82 | [0m[35m            root_path = os.path.expanduser('~')[0m

[31m--[ [0m[34mMatch #[0m[33m458[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m75 | [0m[35m        temp_folder_location = options.get("temp_folder_location")[0m
[30;1m76 | [0m[35m        root_path = None[0m
[30;1m77 | [0m[35m        if temp_folder_location == "starting_dir":[0m
[30;1m78 | [0m[35m            ip = cls._get_ipython()[0m
[30;1m79 | [0m[35m            if ip is not None:[0m
[30;1m80 | [0m[35m                root_path = ip.starting_dir[0m
[30;1m81 | [0m[35m        if root_path is None:[0m

[31m--[ [0m[34mMatch #[0m[33m459[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m    kernel_id:str = None[0m
[30;1m36 | [0m[35m    ip_initialized:bool = None[0m
[30;1m37 | [0m[35m    ip = None[0m
[30;1m38 | [0m[35m    ipywidgets_installed:bool = None[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m460[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mimport os[0m
[30;1m8 | [0m[35mimport sys[0m
[30;1m9 | [0m[35mimport time[0m
[30;1m10 | [0m[35mfrom typing import Any, Callable, Iterable[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m461[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/ipython_api.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m158 | [0m[35m        if help_links is not None:[0m
[30;1m159 | [0m[35m            found = False[0m
[30;1m160 | [0m[35m            for link in help_links:[0m
[30;1m161 | [0m[35m                # if found update url[0m
[30;1m162 | [0m[35m                if link.get("text") == text:[0m
[30;1m163 | [0m[35m                    if link.get("url") != url:[0m
[30;1m164 | [0m[35m                        link["url"] = url[0m

[31m--[ [0m[34mMatch #[0m[33m462[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m911 | [0m[35m    MarkdownString object[0m
[30;1m912 | [0m[35m        The help topic string wrapped by an object that enable markdown, html or text display of the[0m
[30;1m913 | [0m[35m    """[0m
[30;1m914 | [0m[35m    help_topic_string = _HELP.get(topic.strip().lower().replace("_", "").replace("-", ""))[0m
[30;1m915 | [0m[35m    if help_topic_string is None:[0m
[30;1m916 | [0m[35m        raise ValueError(f'"{topic}" unknown help topic')[0m
[30;1m917 | [0m[35m    elif help_topic_string.startswith("http"):[0m

[31m--[ [0m[34mMatch #[0m[33m463[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m681 | [0m[35mn the results of the query instead of the data itself. [bool][0m
[30;1m682 | [0m[35m- **query_results_cache_max_age**: If positive, controls the maximum age of the cached query results[0m
[30;1m683 | [0m[35m- **query_results_progressive_row_count**: Hint for Kusto as to how many records to send in each upd[0m
[30;1m684 | [0m[35m- **query_results_progressive_update_period**: Hint for Kusto as to how often to send progress frame[0m
[30;1m685 | [0m[35m- **query_take_max_records**: Enables limiting query results to this number of records. [int][0m

[31m--[ [0m[34mMatch #[0m[33m464[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m556 | [0m[35mts.MAGIC_CLASS_NAME_UPPER}_SSO_ENCRYPTION_KEYS with the following parameters:[0m
[30;1m557 | [0m[35m        - cachename = an identifying name for your SSO cache.[0m
[30;1m558 | [0m[35m        - secretkey = a password for encryption, for the Single Sign On. Should be at least 8 charac[0m
[30;1m559 | [0m[35m        - secret_salt_uuid = a valid UUID (version 4).[0m
[30;1m560 | [0m[35m    2. Authenticate normally.[0m
[30;1m561 | [0m[35m    3. Use this environmental parameter again (with your parameters) to use SSO and authenticate aut[0m
[30;1m562 | [0m[35m- Additional settings:[0m

[31m--[ [0m[34mMatch #[0m[33m465[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m556 | [0m[35mtal parameter {Constants.MAGIC_CLASS_NAME_UPPER}_SSO_ENCRYPTION_KEYS with the following parameters:[0m
[30;1m557 | [0m[35m        - cachename = an identifying name for your SSO cache.[0m
[30;1m558 | [0m[35m        - secretkey = a password for encryption, for the Single Sign On. Should be at least 8 charac[0m
[30;1m559 | [0m[35m        - secret_salt_uuid = a valid UUID (version 4).[0m
[30;1m560 | [0m[35m    2. Authenticate normally.[0m
[30;1m561 | [0m[35m    3. Use this environmental parameter again (with your parameters) to use SSO and authenticate aut[0m

[31m--[ [0m[34mMatch #[0m[33m466[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m555 | [0m[35m On:[0m
[30;1m556 | [0m[35m    1. Set the environmental parameter {Constants.MAGIC_CLASS_NAME_UPPER}_SSO_ENCRYPTION_KEYS with t[0m
[30;1m557 | [0m[35m        - cachename = an identifying name for your SSO cache.[0m
[30;1m558 | [0m[35m        - secretkey = a password for encryption, for the Single Sign On. Should be at least 8 charac[0m
[30;1m559 | [0m[35m        - secret_salt_uuid = a valid UUID (version 4).[0m
[30;1m560 | [0m[35m    2. Authenticate normally.[0m

[31m--[ [0m[34mMatch #[0m[33m467[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m555 | [0m[35mTo activate Single Sign On:[0m
[30;1m556 | [0m[35m    1. Set the environmental parameter {Constants.MAGIC_CLASS_NAME_UPPER}_SSO_ENCRYPTION_KEYS with t[0m
[30;1m557 | [0m[35m        - cachename = an identifying name for your SSO cache.[0m
[30;1m558 | [0m[35m        - secretkey = a password for encryption, for the Single Sign On. Should be at least 8 charac[0m
[30;1m559 | [0m[35m        - secret_salt_uuid = a valid UUID (version 4).[0m
[30;1m560 | [0m[35m    2. Authenticate normally.[0m

[31m--[ [0m[34mMatch #[0m[33m468[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m450 | [0m[35m<br>[0m
[30;1m451 | [0m[35m[0m
[30;1m452 | [0m[35m## {Constants.MAGIC_CLASS_NAME_UPPER}_LOG_FILE_MODE[0m
[30;1m453 | [0m[35mThe mode at which the log filename is oppened. The following modes are supported: 'append' and 'writ[0m
[30;1m454 | [0m[35mDefault: 'write' if a filename is specified, otherwise None<br>[0m
[30;1m455 | [0m[35m<br>[0m
[30;1m456 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m469[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m426 | [0m[35m<br>[0m
[30;1m427 | [0m[35m[0m
[30;1m428 | [0m[35m- **{Constants.MAGIC_CLASS_NAME_UPPER}_LOG_FILE_MODE**<br>[0m
[30;1m429 | [0m[35mThe mode at which the filename is oppened. The following modes are supported: 'append' and 'write'<b[0m
[30;1m430 | [0m[35mThe default mode is: 'write'<br>[0m
[30;1m431 | [0m[35m<br>[0m
[30;1m432 | [0m[35m"""[0m

[31m--[ [0m[34mMatch #[0m[33m470[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m329 | [0m[35md, it gets a name of the form <resource>@<data-source>.[0m
[30;1m330 | [0m[35m- Reference to a data resource can be by connection string, connection name, or current connection ([0m
[30;1m331 | [0m[35m    - If connection is not specified, current connection (last connection used) will be used.[0m
[30;1m332 | [0m[35m    - To submit queries, at least one connection to a data resource must be established.[0m
[30;1m333 | [0m[35m[0m
[30;1m334 | [0m[35m- When a connection is specified, and it is a new connection string, the authentication and authoriz[0m

[31m--[ [0m[34mMatch #[0m[33m471[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m689 | [0m[35m*: Arbitrary text that the author of the request wants to include as the request description. [str][0m
[30;1m690 | [0m[35m- **request_external_table_disabled**: If specified, indicates that the request cannot invoke code i[0m
[30;1m691 | [0m[35m- **request_impersonation_disabled**: If specified, indicates that the service shouldn't impersonate[0m
[30;1m692 | [0m[35m- **request_readonly**: If specified, indicates that the request must not be able to write anything.[0m
[30;1m693 | [0m[35m- **request_remote_entities_disabled**: If specified, indicates that the request cannot access remot[0m

[31m--[ [0m[34mMatch #[0m[33m472[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m678 | [0m[35m- **query_max_entities_in_union**: Overrides the default maximum number of columns a query is allowe[0m
[30;1m679 | [0m[35m- **query_now**: Overrides the datetime value returned by the now(0s) function. [DateTime][0m
[30;1m680 | [0m[35m- **query_python_debug**: If set, generate python debug query for the enumerated python node (defaul[0m
[30;1m681 | [0m[35m- **query_results_apply_getschema** If set, retrieves the schema of each tabular data in the results[0m

[31m--[ [0m[34mMatch #[0m[33m473[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m671 | [0m[35mn only (if defined). [DateTime][0m
[30;1m672 | [0m[35m- **query_datetimescope_to**: Controls the query's datetime scope (latest) -- used as auto-applied f[0m
[30;1m673 | [0m[35m- **query_distribution_nodes_span**: If set, controls the way sub-query merge behaves: the executing[0m
[30;1m674 | [0m[35m- **query_fanout_nodes_percent**: The percentage of nodes to fanout execution to. [int][0m

[31m--[ [0m[34mMatch #[0m[33m474[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m656 | [0m[35mr node. [int][0m
[30;1m657 | [0m[35m- **maxmemoryconsumptionperiterator**: Overrides the default maximum amount of memory a query operat[0m
[30;1m658 | [0m[35m- **maxoutputcolumns**: Overrides the default maximum number of columns a query is allowed to produc[0m
[30;1m659 | [0m[35m- **norequesttimeout**: Enables setting the request timeout to its maximum value. [bool][0m
[30;1m660 | [0m[35m- **notruncation**: Enables suppressing truncation of the query results returned to the caller. [boo[0m
[30;1m661 | [0m[35m- **push_selection_through_aggregation**: If true, push simple selection through aggregation [bool][0m

[31m--[ [0m[34mMatch #[0m[33m475[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m492 | [0m[35m<br>[0m
[30;1m493 | [0m[35m[0m
[30;1m494 | [0m[35m## {Constants.MAGIC_CLASS_NAME_UPPER}_NOTEBOOK_SERVICE_ADDRESS[0m
[30;1m495 | [0m[35mForce the specified backend service address. Only for remote kernels.<br>[0m
[30;1m496 | [0m[35mDefault: None (auto set by jupyter implementation)<br>[0m
[30;1m497 | [0m[35m<br>[0m
[30;1m498 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m476[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m  | [0m[35mdata from a variety of sources and provides a query language for advanced analytics.<br>[0m
[30;1m  | [0m[35m<br>[0m
[30;1m  | [0m[35m[0m
[30;1m  | [0m[35m- **ApplicationInsights** / **AppInsights**- [Reference to resources Application Insights service]({[0m

[31m--[ [0m[34mMatch #[0m[33m477[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m280 | [0m[35m<br>[0m
[30;1m281 | [0m[35m[0m
[30;1m282 | [0m[35m- **AzureDataExplorer** / **kusto**- [Reference to resources Azure Data Explorer (kusto) service]({_[0m
[30;1m283 | [0m[35mAzure Data Explorer is a fast and highly scalable data exploration service for log and telemetry dat[0m
[30;1m284 | [0m[35m<br>[0m
[30;1m285 | [0m[35m[0m
[30;1m286 | [0m[35m- **LogAnalytics**- [Reference to resources Log Analytics service]({_LOGANALYTICS_URL})<br>[0m

[31m--[ [0m[34mMatch #[0m[33m478[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m210 | [0m[35m    | sort by count_ [0m
[30;1m211 | [0m[35m    | limit 10```<br><br>[0m
[30;1m212 | [0m[35m```%%kql pageViews | where client_City != '' [0m
[30;1m213 | [0m[35m    | summarize count() by client_City | sort by count_ [0m
[30;1m214 | [0m[35m    | limit 10```<br><br>[0m
[30;1m215 | [0m[35m```%kql DEMO_APP@appinsights pageViews | count```[0m
[30;1m216 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m479[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m207 | [0m[35m    pageViews [0m
[30;1m208 | [0m[35m    | where client_City != '' [0m
[30;1m209 | [0m[35m    | summarize count() by client_City [0m
[30;1m210 | [0m[35m    | sort by count_ [0m
[30;1m211 | [0m[35m    | limit 10```<br><br>[0m
[30;1m212 | [0m[35m```%%kql pageViews | where client_City != '' [0m
[30;1m213 | [0m[35m    | summarize count() by client_City | sort by count_ [0m

[31m--[ [0m[34mMatch #[0m[33m480[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/palette.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m    @classmethod[0m
[30;1m137 | [0m[35m    def validate_palette_name(cls, name):[0m
[30;1m138 | [0m[35m        parsed = cls.parse(name)[0m
[30;1m139 | [0m[35m        if parsed.get("rgb_palette") is None and parsed.get("base_name") not in Palettes.get_all_pal[0m
[30;1m140 | [0m[35m            raise ValueError([0m
[30;1m141 | [0m[35m                f"must be a known palette name or custom palette (see option -popup_palettes) , but [0m
[30;1m142 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m481[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/palette.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m    @classmethod[0m
[30;1m137 | [0m[35m    def validate_palette_name(cls, name):[0m
[30;1m138 | [0m[35m        parsed = cls.parse(name)[0m
[30;1m139 | [0m[35m        if parsed.get("rgb_palette") is None and parsed.get("base_name") not in Palettes.get_all_pal[0m
[30;1m140 | [0m[35m            raise ValueError([0m
[30;1m141 | [0m[35m                f"must be a known palette name or custom palette (see option -popup_palettes) , but [0m
[30;1m142 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m482[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/palette.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m53 | [0m[35m                rgb_palette = ["rgb" + str((int(rgb[0] * 255), int(rgb[1] * 255), int(rgb[2] * 255))[0m
[30;1m54 | [0m[35m            if parsed.get("slice"):[0m
[30;1m55 | [0m[35m                rgb_palette = rgb_palette.__getitem__(parsed.get("slice"))[0m
[30;1m56 | [0m[35m            if parsed.get("reversed") is not None and parsed.get("reversed"):[0m
[30;1m57 | [0m[35m                rgb_palette = list(reversed(rgb_palette))[0m
[30;1m58 | [0m[35m            if to_reverse:[0m
[30;1m59 | [0m[35m                rgb_palette = list(reversed(rgb_palette))[0m

[31m--[ [0m[34mMatch #[0m[33m483[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/palette.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m53 | [0m[35m                rgb_palette = ["rgb" + str((int(rgb[0] * 255), int(rgb[1] * 255), int(rgb[2] * 255))[0m
[30;1m54 | [0m[35m            if parsed.get("slice"):[0m
[30;1m55 | [0m[35m                rgb_palette = rgb_palette.__getitem__(parsed.get("slice"))[0m
[30;1m56 | [0m[35m            if parsed.get("reversed") is not None and parsed.get("reversed"):[0m
[30;1m57 | [0m[35m                rgb_palette = list(reversed(rgb_palette))[0m
[30;1m58 | [0m[35m            if to_reverse:[0m
[30;1m59 | [0m[35m                rgb_palette = list(reversed(rgb_palette))[0m

[31m--[ [0m[34mMatch #[0m[33m484[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/palette.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m52 | [0m[35m                rgb_float_pallete = self._get_color_palette(name=parsed.get("base_name"), n_colors=s[0m
[30;1m53 | [0m[35m                rgb_palette = ["rgb" + str((int(rgb[0] * 255), int(rgb[1] * 255), int(rgb[2] * 255))[0m
[30;1m54 | [0m[35m            if parsed.get("slice"):[0m
[30;1m55 | [0m[35m                rgb_palette = rgb_palette.__getitem__(parsed.get("slice"))[0m
[30;1m56 | [0m[35m            if parsed.get("reversed") is not None and parsed.get("reversed"):[0m
[30;1m57 | [0m[35m                rgb_palette = list(reversed(rgb_palette))[0m
[30;1m58 | [0m[35m            if to_reverse:[0m

[31m--[ [0m[34mMatch #[0m[33m485[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/palette.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m51 | [0m[35m            if rgb_palette is None:[0m
[30;1m52 | [0m[35m                rgb_float_pallete = self._get_color_palette(name=parsed.get("base_name"), n_colors=s[0m
[30;1m53 | [0m[35m                rgb_palette = ["rgb" + str((int(rgb[0] * 255), int(rgb[1] * 255), int(rgb[2] * 255))[0m
[30;1m54 | [0m[35m            if parsed.get("slice"):[0m
[30;1m55 | [0m[35m                rgb_palette = rgb_palette.__getitem__(parsed.get("slice"))[0m
[30;1m56 | [0m[35m            if parsed.get("reversed") is not None and parsed.get("reversed"):[0m
[30;1m57 | [0m[35m                rgb_palette = list(reversed(rgb_palette))[0m

[31m--[ [0m[34mMatch #[0m[33m486[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/palette.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m        if rgb_palette is None:[0m
[30;1m50 | [0m[35m            rgb_palette = parsed.get("rgb_palette")[0m
[30;1m51 | [0m[35m            if rgb_palette is None:[0m
[30;1m52 | [0m[35m                rgb_float_pallete = self._get_color_palette(name=parsed.get("base_name"), n_colors=s[0m
[30;1m53 | [0m[35m                rgb_palette = ["rgb" + str((int(rgb[0] * 255), int(rgb[1] * 255), int(rgb[2] * 255))[0m
[30;1m54 | [0m[35m            if parsed.get("slice"):[0m
[30;1m55 | [0m[35m                rgb_palette = rgb_palette.__getitem__(parsed.get("slice"))[0m

[31m--[ [0m[34mMatch #[0m[33m487[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/palette.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m47 | [0m[35m        self.name = parsed.get("name") or self.name[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m        if rgb_palette is None:[0m
[30;1m50 | [0m[35m            rgb_palette = parsed.get("rgb_palette")[0m
[30;1m51 | [0m[35m            if rgb_palette is None:[0m
[30;1m52 | [0m[35m                rgb_float_pallete = self._get_color_palette(name=parsed.get("base_name"), n_colors=s[0m
[30;1m53 | [0m[35m                rgb_palette = ["rgb" + str((int(rgb[0] * 255), int(rgb[1] * 255), int(rgb[2] * 255))[0m

[31m--[ [0m[34mMatch #[0m[33m488[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/palette.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m44 | [0m[35m        self.range_start = range_start[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m        parsed = self.parse(self.name)[0m
[30;1m47 | [0m[35m        self.name = parsed.get("name") or self.name[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m        if rgb_palette is None:[0m
[30;1m50 | [0m[35m            rgb_palette = parsed.get("rgb_palette")[0m

[31m--[ [0m[34mMatch #[0m[33m489[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m.. code-block:: python[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m    Connect to database at cluster[0m
[30;1m106 | [0m[35m    In [3]: %kql kusto://code;cluster='help';database='Samples'[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35m.. code-block:: python[0m

[31m--[ [0m[34mMatch #[0m[33m490[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m108 | [0m[35m.. code-block:: python[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m    Query database@cluster and render result set to a pie chart[0m
[30;1m111 | [0m[35m    In [4]: %kql Samples@help StormEvents | summarize count() by State | sort by count_ | limit 10 |[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m491[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14 | [0m[35mClassifier: Development Status :: 5 - Production/Stable[0m
[30;1m15 | [0m[35mClassifier: Intended Audience :: Developers[0m
[30;1m16 | [0m[35mClassifier: Intended Audience :: System Administrators[0m
[30;1m17 | [0m[35mClassifier: Intended Audience :: Customer Service[0m
[30;1m18 | [0m[35mClassifier: Intended Audience :: Information Technology[0m
[30;1m19 | [0m[35mClassifier: Intended Audience :: Science/Research[0m
[30;1m20 | [0m[35mClassifier: Environment :: Console[0m

[31m--[ [0m[34mMatch #[0m[33m492[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/_require.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m234 | [0m[35m    'flake8',     # analyzes programs and detects various errors[0m
[30;1m235 | [0m[35m    'pipreqs',    # Pip requirements.txt generator based on imports in project[0m
[30;1m236 | [0m[35m[0m
[30;1m237 | [0m[35m    'mccabe',     # Ned’s script to check McCabe complexity, plugin for flake8[0m
[30;1m238 | [0m[35m    'pep8'        # heck PEP-8 naming conventions, plugin for flake8[0m
[30;1m239 | [0m[35m    'autopep8',   # A tool that automatically formats Python code to conform to the PEP 8 style guid[0m
[30;1m240 | [0m[35m    'pydocstyle', # tatic analysis tool for checking compliance with Python docstring conventions[0m

[31m--[ [0m[34mMatch #[0m[33m493[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/_require.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m232 | [0m[35m    'black',      # code formatter[0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35m    'flake8',     # analyzes programs and detects various errors[0m
[30;1m235 | [0m[35m    'pipreqs',    # Pip requirements.txt generator based on imports in project[0m
[30;1m236 | [0m[35m[0m
[30;1m237 | [0m[35m    'mccabe',     # Ned’s script to check McCabe complexity, plugin for flake8[0m
[30;1m238 | [0m[35m    'pep8'        # heck PEP-8 naming conventions, plugin for flake8[0m

[31m--[ [0m[34mMatch #[0m[33m494[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/_require.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m# --------------------------------------------------------------------------[0m
[30;1m10 | [0m[35m# because it is also executed from setup.py, make sure[0m
[30;1m11 | [0m[35m# that it imports only modules, that for sure will exist at setup.py execution[0m
[30;1m12 | [0m[35m# TRY TO KEEP IMPORTS TO MINIMUM[0m
[30;1m13 | [0m[35m# --------------------------------------------------------------------------[0m
[30;1m14 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m495[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/dpapi_crypto.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m48 | [0m[35m        def __init__(self, **options):[0m
[30;1m49 | [0m[35m            entropy: str = options.get(DpapiParam.ENTROPY) or "kqlmagic"[0m
[30;1m50 | [0m[35m            self._entropy_blob_byref = byref(self._toBlob(entropy)) if entropy else None[0m
[30;1m51 | [0m[35m            self._description: str = options.get(DpapiParam.DESCRIPTION)[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m        @property[0m

[31m--[ [0m[34mMatch #[0m[33m496[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/dpapi_crypto.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m    class DpapiCrypto(object):[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m        def __init__(self, **options):[0m
[30;1m49 | [0m[35m            entropy: str = options.get(DpapiParam.ENTROPY) or "kqlmagic"[0m
[30;1m50 | [0m[35m            self._entropy_blob_byref = byref(self._toBlob(entropy)) if entropy else None[0m
[30;1m51 | [0m[35m            self._description: str = options.get(DpapiParam.DESCRIPTION)[0m
[30;1m52 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m497[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/connection.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m143 | [0m[35m    @classmethod[0m
[30;1m144 | [0m[35m    def get_engine_by_name(cls, name:str)->Engine:[0m
[30;1m145 | [0m[35m        id = cls._id_by_name.get(name, name)[0m
[30;1m146 | [0m[35m        return cls._engine_by_id.get(id)[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m    @classmethod[0m

[31m--[ [0m[34mMatch #[0m[33m498[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/connection.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m142 | [0m[35m[0m
[30;1m143 | [0m[35m    @classmethod[0m
[30;1m144 | [0m[35m    def get_engine_by_name(cls, name:str)->Engine:[0m
[30;1m145 | [0m[35m        id = cls._id_by_name.get(name, name)[0m
[30;1m146 | [0m[35m        return cls._engine_by_id.get(id)[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m499[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/connection.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m129 | [0m[35m        "Save engine if new. Set as current engine"[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m        id = engine.get_id()[0m
[30;1m132 | [0m[35m        cls._current_engine = cls._engine_by_id.get(id) or engine[0m
[30;1m133 | [0m[35m        cls._engine_by_id[id] = cls._current_engine[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m        name = name or engine.get_conn_name()[0m

[31m--[ [0m[34mMatch #[0m[33m500[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/connection.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m97 | [0m[35m            parts = conn_str.split("://", 1)[0m
[30;1m98 | [0m[35m            if len(parts) == 2:[0m
[30;1m99 | [0m[35m                uri_schema = parts[0].lower().replace("_", "").replace("-", "")[0m
[30;1m100 | [0m[35m                return cls._ENGINE_CLASS_BY_SCHEMA.get(uri_schema)[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m    @classmethod[0m

[31m--[ [0m[34mMatch #[0m[33m501[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/connection.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m                raise KqlEngineError(f"invalid connection_str: {conn_str}")[0m
[30;1m87 | [0m[35m            engine = cls._create_kusto_database_engine(engine_class, database_name, cluster_friendly[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m        if options.get("use_cache") and engine_class != CacheEngine:[0m
[30;1m90 | [0m[35m            engine = CacheEngine(engine, user_ns, last_current_engine, **options)[0m
[30;1m91 | [0m[35m        return engine[0m
[30;1m92 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m502[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/connection.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m            if "://" in conn_str:[0m
[30;1m69 | [0m[35m                if last_current_engine is not None:[0m
[30;1m70 | [0m[35m                    last_cluster_friendly_name = last_current_engine.get_cluster_friendly_name()[0m
[30;1m71 | [0m[35m                    last_current_engine = cls._engine_by_id.get(f"@{last_cluster_friendly_name}")[0m
[30;1m72 | [0m[35m                cluster_engine = engine_class(conn_str, user_ns, current=last_current_engine, conn_c[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m                cluster_friendly_name = cluster_engine.get_cluster_friendly_name()[0m

[31m--[ [0m[34mMatch #[0m[33m503[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/connection.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m                valid_prefixes_str = ", ".join([f"{s}://" for s in cls._ENGINE_CLASS_BY_SCHEMA.keys([0m
[30;1m60 | [0m[35m                raise KqlEngineError(f"invalid connection_str, unknown <uri schema name>. valid uri [0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m        last_current_engine:Engine = cls._last_current_by_engine_class.get(engine_class.__name__)[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m        if engine_class not in [KustoEngine, AriaEngine]:[0m
[30;1m65 | [0m[35m            engine = engine_class(conn_str, user_ns, current=last_current_engine, **options)[0m

[31m--[ [0m[34mMatch #[0m[33m504[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/activate_kernel_command.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m132 | [0m[35m            if change.get('new') is False:[0m
[30;1m133 | [0m[35m                ActivateKernelCommand.config.set_trait("kqlmagic_kernel", False, force=True)        [0m
[30;1m134 | [0m[35m                ActivateKernelCommand._activate_kernel(False)[0m
[30;1m135 | [0m[35m            elif change.get('new') is True and ActivateKernelCommand.is_kqlmagic_kernel_default is T[0m
[30;1m136 | [0m[35m                ActivateKernelCommand.execute(True)[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m505[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/activate_kernel_command.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m129 | [0m[35m    @staticmethod[0m
[30;1m130 | [0m[35m    def observe_is_magic(change:Dict[str,str]):[0m
[30;1m131 | [0m[35m        if change.get('type') == 'change' and change.get('name') == 'is_magic':[0m
[30;1m132 | [0m[35m            if change.get('new') is False:[0m
[30;1m133 | [0m[35m                ActivateKernelCommand.config.set_trait("kqlmagic_kernel", False, force=True)        [0m
[30;1m134 | [0m[35m                ActivateKernelCommand._activate_kernel(False)[0m
[30;1m135 | [0m[35m            elif change.get('new') is True and ActivateKernelCommand.is_kqlmagic_kernel_default is T[0m

[31m--[ [0m[34mMatch #[0m[33m506[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/activate_kernel_command.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m    @staticmethod[0m
[30;1m130 | [0m[35m    def observe_is_magic(change:Dict[str,str]):[0m
[30;1m131 | [0m[35m        if change.get('type') == 'change' and change.get('name') == 'is_magic':[0m
[30;1m132 | [0m[35m            if change.get('new') is False:[0m
[30;1m133 | [0m[35m                ActivateKernelCommand.config.set_trait("kqlmagic_kernel", False, force=True)        [0m
[30;1m134 | [0m[35m                ActivateKernelCommand._activate_kernel(False)[0m

[31m--[ [0m[34mMatch #[0m[33m507[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/activate_kernel_command.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m    @staticmethod[0m
[30;1m130 | [0m[35m    def observe_is_magic(change:Dict[str,str]):[0m
[30;1m131 | [0m[35m        if change.get('type') == 'change' and change.get('name') == 'is_magic':[0m
[30;1m132 | [0m[35m            if change.get('new') is False:[0m
[30;1m133 | [0m[35m                ActivateKernelCommand.config.set_trait("kqlmagic_kernel", False, force=True)        [0m
[30;1m134 | [0m[35m                ActivateKernelCommand._activate_kernel(False)[0m

[31m--[ [0m[34mMatch #[0m[33m508[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/activate_kernel_command.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35m            ActivateKernelCommand.config.set_trait("kqlmagic_kernel", is_kqlmagic_kernel, force=True[0m
[30;1m46 | [0m[35m            if not kernel_init_suppress_output:[0m
[30;1m47 | [0m[35m                if is_kqlmagic_kernel == to_activate:[0m
[30;1m48 | [0m[35m                    if not options.get("suppress_results"):[0m
[30;1m49 | [0m[35m                        msg_title = {[0m
[30;1m50 | [0m[35m                            "message": f"""{Constants.MAGIC_CLASS_NAME_LOWER} kernel {'' if to_activ[0m
[30;1m51 | [0m[35m                            "style_options": {[0m

[31m--[ [0m[34mMatch #[0m[33m509[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/activate_kernel_command.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m39 | [0m[35m    @staticmethod[0m
[30;1m40 | [0m[35m    def execute(to_activate:bool, kernel_init_suppress_output = False, options=None):[0m
[30;1m41 | [0m[35m        options = options or {}[0m
[30;1m42 | [0m[35m        ActivateKernelCommand.suppress_results = options.get("suppress_results")[0m
[30;1m43 | [0m[35m        if ActivateKernelCommand.config.is_magic:[0m
[30;1m44 | [0m[35m            is_kqlmagic_kernel = ActivateKernelCommand._activate_kernel(to_activate)[0m
[30;1m45 | [0m[35m            ActivateKernelCommand.config.set_trait("kqlmagic_kernel", is_kqlmagic_kernel, force=True[0m

[31m--[ [0m[34mMatch #[0m[33m510[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/activate_kernel_command.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m164 | [0m[35m    # track parentheses level, similar to the internals of tokenize.[0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35m    #   reexported from token on 3.7+[0m
[30;1m167 | [0m[35m    NEWLINE, NL = tokenize.NEWLINE, tokenize.NL  # type: ignore[0m
[30;1m168 | [0m[35m    tokens_by_line:List[List[Any]] = [[]][0m
[30;1m169 | [0m[35m    if len(lines) > 1 and not lines[0].endswith(('\n', '\r', '\r\n', '\x0b', '\x0c')):[0m
[30;1m170 | [0m[35m        pass[0m

[31m--[ [0m[34mMatch #[0m[33m511[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/activate_kernel_command.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m158 | [0m[35m    '\\r\\n') for this to properly work. Use `.splitlines(keeplineending=True)`[0m
[30;1m159 | [0m[35m    for example when passing block of text to this function.[0m
[30;1m160 | [0m[35m    """[0m
[30;1m161 | [0m[35m    # NL tokens are used inside multiline expressions, but also after blank[0m
[30;1m162 | [0m[35m    # lines or comments. This is intentional - see https://bugs.python.org/issue17061[0m
[30;1m163 | [0m[35m    # We want to group the former case together but split the latter, so we[0m
[30;1m164 | [0m[35m    # track parentheses level, similar to the internals of tokenize.[0m

[31m--[ [0m[34mMatch #[0m[33m512[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_proxy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m211 | [0m[35m                pass[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m            elif col_type == "dynamic":[0m
[30;1m214 | [0m[35m                if options.get("dynamic_to_dataframe") == "str":[0m
[30;1m215 | [0m[35m                    frame[col_name] = frame[col_name].apply(lambda x: self._dynamic_to_str(x))[0m
[30;1m216 | [0m[35m                else:[0m
[30;1m217 | [0m[35m                    frame[col_name] = frame[col_name].apply(lambda x: self._dynamic_to_object(x))[0m

[31m--[ [0m[34mMatch #[0m[33m513[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_proxy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m167 | [0m[35m[0m
[30;1m168 | [0m[35m    @property[0m
[30;1m169 | [0m[35m    def datafarme_types(self):[0m
[30;1m170 | [0m[35m        return [self.KQL_TO_DATAFRAME_DATA_TYPES.get(t) for t in self.data_table.columns_type][0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m[0m
[30;1m173 | [0m[35m    def _map_columns_to_index(self, columns: list):[0m

[31m--[ [0m[34mMatch #[0m[33m514[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_proxy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m113 | [0m[35m        self.tables = [[0m
[30;1m114 | [0m[35m            KqlTableResponse([0m
[30;1m115 | [0m[35m                t, [0m
[30;1m116 | [0m[35m                response.extended_properties.get(t.id, {}),[0m
[30;1m117 | [0m[35m                **options) [0m
[30;1m118 | [0m[35m            for t in response.primary_results][0m
[30;1m119 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m515[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_proxy.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m234 | [0m[35m[0m
[30;1m235 | [0m[35m[0m
[30;1m236 | [0m[35m    def _is_valid_datetime(self, d:str)->bool:[0m
[30;1m237 | [0m[35m        # max diff in seconds from 9223372036 from 1970-01-01T00:00:00Z[0m
[30;1m238 | [0m[35m        MAX_DIFF_FROM_EPOCH_IN_SECS = 9223372036  # 2**63/1000000000[0m
[30;1m239 | [0m[35m        START_EPOCH_DATETIME = dateutil.parser.isoparse('1970-01-01T00:00:00Z')[0m
[30;1m240 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m516[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/dpapi_crypto_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m        def __init__(self, **crypto_options)->None:[0m
[30;1m36 | [0m[35m            entropy: str = crypto_options.get(DpapiParam.ENTROPY) or "kqlmagic"[0m
[30;1m37 | [0m[35m            self._description: str = crypto_options.get(DpapiParam.DESCRIPTION)[0m
[30;1m38 | [0m[35m            self._dp_agent = WindowsDataProtectionAgent(entropy=entropy)[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m517[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/dpapi_crypto_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m33 | [0m[35m    class DpapiCrypto(object):[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m        def __init__(self, **crypto_options)->None:[0m
[30;1m36 | [0m[35m            entropy: str = crypto_options.get(DpapiParam.ENTROPY) or "kqlmagic"[0m
[30;1m37 | [0m[35m            self._description: str = crypto_options.get(DpapiParam.DESCRIPTION)[0m
[30;1m38 | [0m[35m            self._dp_agent = WindowsDataProtectionAgent(entropy=entropy)[0m
[30;1m39 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m518[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/constants.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m225 | [0m[35m    scatterchart    map             Expected columns are [Longitude, Latitude] or GeoJSON point. Ser[0m
[30;1m226 | [0m[35m    """[0m
[30;1m227 | [0m[35m   [0m
[30;1m228 | [0m[35m    # TODO: find out what it means[0m
[30;1m229 | [0m[35m    ANOMALY_COLUMNS = "AnomalyColumns"[0m
[30;1m230 | [0m[35m    """Property relevant only for anomalychart. Comma-delimited list of columns which will be consid[0m
[30;1m231 | [0m[35m [0m

[31m--[ [0m[34mMatch #[0m[33m519[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/constants.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m201 | [0m[35m    "Whether the value of each measure gets added to all its predecessors. (true or false)"[0m
[30;1m202 | [0m[35m[0m
[30;1m203 | [0m[35m    IS_QUERY_SORTED = "IsQuerySorted"[0m
[30;1m204 | [0m[35m    "Tips: Sort the data to define the order of the x-axis."[0m
[30;1m205 | [0m[35m[0m
[30;1m206 | [0m[35m    # TODO: implement it[0m
[30;1m207 | [0m[35m    KIND = "Kind"[0m

[31m--[ [0m[34mMatch #[0m[33m520[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/constants.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m150 | [0m[35m        timechart	    Line graph. First column is x-axis, and should be datetime. Other (numeric) co[0m
[30;1m151 | [0m[35m                        There is one string column whose values are used to "group" the numeric colu[0m
[30;1m152 | [0m[35m                        (further string columns are ignored).[0m
[30;1m153 | [0m[35m        timepivot	    Interactive navigation over the events time-line (pivoting on time axis)   [0m
[30;1m154 | [0m[35m    """[0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35m    TITLE = "Title"[0m

[31m--[ [0m[34mMatch #[0m[33m521[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/constants.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35m    BLUE = '\033[94m'[0m
[30;1m58 | [0m[35m    GREEN = '\033[92m'[0m
[30;1m59 | [0m[35m    YELLOW = '\033[93m'[0m
[30;1m60 | [0m[35m    RED = '\033[91m'[0m
[30;1m61 | [0m[35m    BOLD = '\033[1m'[0m
[30;1m62 | [0m[35m    UNDERLINE = '\033[4m'[0m
[30;1m63 | [0m[35m    END = '\033[0m'[0m

[31m--[ [0m[34mMatch #[0m[33m522[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/constants.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m    MAGIC_ISSUES_REPOSITORY_URL = "https://github.com/microsoft/jupyter-Kqlmagic/issues/new"[0m
[30;1m19 | [0m[35m    [0m
[30;1m20 | [0m[35m    [0m
[30;1m21 | [0m[35m    # class must start with an uppercase, because %config can't find it if it is lowercase?[0m
[30;1m22 | [0m[35m    MAGIC_CLASS_NAME = "Kqlmagic"[0m
[30;1m23 | [0m[35m    MAGIC_CLASS_NAME_UPPER = MAGIC_CLASS_NAME.upper()[0m
[30;1m24 | [0m[35m    MAGIC_CLASS_NAME_LOWER = MAGIC_CLASS_NAME.lower()[0m

[31m--[ [0m[34mMatch #[0m[33m523[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mtry:[0m
[30;1m8 | [0m[35m    # to avoid this warnig to be dispayed:[0m
[30;1m9 | [0m[35m    # UserWarning: Distutils was imported before Setuptools. This usage is discouraged and may exhib[0m
[30;1m10 | [0m[35m    import setuptools[0m
[30;1m11 | [0m[35mexcept: # pylint: disable=bare-except[0m
[30;1m12 | [0m[35m    pass[0m

[31m--[ [0m[34mMatch #[0m[33m524[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/version.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m385 | [0m[35m[0m
[30;1m386 | [0m[35m    api_url = f"https://pypi.org/pypi/{package_name}/json"[0m
[30;1m387 | [0m[35m    http_client = HttpClient()[0m
[30;1m388 | [0m[35m    response = http_client.get(api_url)[0m
[30;1m389 | [0m[35m[0m
[30;1m390 | [0m[35m    #[0m
[30;1m391 | [0m[35m    # handle response[0m

[31m--[ [0m[34mMatch #[0m[33m525[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/version.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m349 | [0m[35m    all_releases = json_response.get("releases").keys()[0m
[30;1m350 | [0m[35m    all_releases_desc_sorted = sorted(all_releases, key=cmp_to_key(lambda v,o: compare_version(v, o,[0m
[30;1m351 | [0m[35m[0m
[30;1m352 | [0m[35m    latest_stable_release = latest_release = json_response.get("info").get("version") if json_respon[0m
[30;1m353 | [0m[35m[0m
[30;1m354 | [0m[35m    if len(all_releases_desc_sorted) > 0:[0m
[30;1m355 | [0m[35m        latest_release = all_releases_desc_sorted[0][0m

[31m--[ [0m[34mMatch #[0m[33m526[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/version.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m349 | [0m[35m    all_releases = json_response.get("releases").keys()[0m
[30;1m350 | [0m[35m    all_releases_desc_sorted = sorted(all_releases, key=cmp_to_key(lambda v,o: compare_version(v, o,[0m
[30;1m351 | [0m[35m[0m
[30;1m352 | [0m[35m    latest_stable_release = latest_release = json_response.get("info").get("version") if json_respon[0m
[30;1m353 | [0m[35m[0m
[30;1m354 | [0m[35m    if len(all_releases_desc_sorted) > 0:[0m
[30;1m355 | [0m[35m        latest_release = all_releases_desc_sorted[0][0m

[31m--[ [0m[34mMatch #[0m[33m527[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/version.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m349 | [0m[35m    all_releases = json_response.get("releases").keys()[0m
[30;1m350 | [0m[35m    all_releases_desc_sorted = sorted(all_releases, key=cmp_to_key(lambda v,o: compare_version(v, o,[0m
[30;1m351 | [0m[35m[0m
[30;1m352 | [0m[35m    latest_stable_release = latest_release = json_response.get("info").get("version") if json_respon[0m
[30;1m353 | [0m[35m[0m
[30;1m354 | [0m[35m    if len(all_releases_desc_sorted) > 0:[0m
[30;1m355 | [0m[35m        latest_release = all_releases_desc_sorted[0][0m

[31m--[ [0m[34mMatch #[0m[33m528[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/version.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m346 | [0m[35m    #[0m
[30;1m347 | [0m[35m[0m
[30;1m348 | [0m[35m    json_response = _retreive_package_from_pypi(package_name)[0m
[30;1m349 | [0m[35m    all_releases = json_response.get("releases").keys()[0m
[30;1m350 | [0m[35m    all_releases_desc_sorted = sorted(all_releases, key=cmp_to_key(lambda v,o: compare_version(v, o,[0m
[30;1m351 | [0m[35m[0m
[30;1m352 | [0m[35m    latest_stable_release = latest_release = json_response.get("info").get("version") if json_respon[0m

[31m--[ [0m[34mMatch #[0m[33m529[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/version.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m306 | [0m[35m        match = re.match(r'([0-9]*)[\-_]?([a-z]*)[\-_]?([0-9]*)', last, re.IGNORECASE)[0m
[30;1m307 | [0m[35m        if match:[0m
[30;1m308 | [0m[35m            groups = match.groups()[0m
[30;1m309 | [0m[35m            return PRE_STR_TO_LABEL.get(groups[1])[0m
[30;1m310 | [0m[35m[0m
[30;1m311 | [0m[35m[0m
[30;1m312 | [0m[35mdef execute_version_command()->MarkdownString:[0m

[31m--[ [0m[34mMatch #[0m[33m530[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/version.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m245 | [0m[35m                match = re.match(r'([0-9]*)[\-_]?([a-z]*)[\-_]?([0-9]*)', last, re.IGNORECASE)[0m
[30;1m246 | [0m[35m                if match:[0m
[30;1m247 | [0m[35m                    groups = match.groups()[0m
[30;1m248 | [0m[35m                    pre_post_level = PRE_POST_STR_TO_LEVEL.get(groups[1].lower())[0m
[30;1m249 | [0m[35m                    if pre_post_level is not None:[0m
[30;1m250 | [0m[35m                        if groups[0] != "":[0m
[30;1m251 | [0m[35m                            version_list.append(groups[0])[0m

[31m--[ [0m[34mMatch #[0m[33m531[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m171 | [0m[35m        if len(results) > 0:[0m
[30;1m172 | [0m[35m            hints = [][0m
[30;1m173 | [0m[35m            for i, policy in enumerate(results,1):[0m
[30;1m174 | [0m[35m                hints.append(f"{i}. {password_hints.get(type(policy))}")[0m
[30;1m175 | [0m[35m                return os.linesep.join(hints)[0m

[31m--[ [0m[34mMatch #[0m[33m532[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m92 | [0m[35m        length = min(length, 32) + 2  # 2 last bytes are to create suffix[0m
[30;1m93 | [0m[35m        iterations = options.get(CryptoParam.ITERATIONS, 100000)[0m
[30;1m94 | [0m[35m        algorithm = options.get(CryptoParam.ALGORITHM, self.hashes.SHA256())[0m
[30;1m95 | [0m[35m        backend = options.get(CryptoParam.BACKEND, self.default_backend()) # pylint: disable=not-cal[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m        kdf = self.PBKDF2HMAC(algorithm=algorithm, length=length, salt=salt_bytes, iterations=iterat[0m
[30;1m98 | [0m[35m        key = kdf.derive(password_as_bytes)[0m

[31m--[ [0m[34mMatch #[0m[33m533[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m        length = options.get(CryptoParam.LENGTH, 32)[0m
[30;1m92 | [0m[35m        length = min(length, 32) + 2  # 2 last bytes are to create suffix[0m
[30;1m93 | [0m[35m        iterations = options.get(CryptoParam.ITERATIONS, 100000)[0m
[30;1m94 | [0m[35m        algorithm = options.get(CryptoParam.ALGORITHM, self.hashes.SHA256())[0m
[30;1m95 | [0m[35m        backend = options.get(CryptoParam.BACKEND, self.default_backend()) # pylint: disable=not-cal[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m        kdf = self.PBKDF2HMAC(algorithm=algorithm, length=length, salt=salt_bytes, iterations=iterat[0m

[31m--[ [0m[34mMatch #[0m[33m534[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m90 | [0m[35m        salt_bytes = str(salt).encode()[0m
[30;1m91 | [0m[35m        length = options.get(CryptoParam.LENGTH, 32)[0m
[30;1m92 | [0m[35m        length = min(length, 32) + 2  # 2 last bytes are to create suffix[0m
[30;1m93 | [0m[35m        iterations = options.get(CryptoParam.ITERATIONS, 100000)[0m
[30;1m94 | [0m[35m        algorithm = options.get(CryptoParam.ALGORITHM, self.hashes.SHA256())[0m
[30;1m95 | [0m[35m        backend = options.get(CryptoParam.BACKEND, self.default_backend()) # pylint: disable=not-cal[0m
[30;1m96 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m535[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m88 | [0m[35m        salt  = options.get(CryptoParam.SALT, uuid.uuid4())[0m
[30;1m89 | [0m[35m        logger().debug(f"_create_encryption_key {type(salt)}")[0m
[30;1m90 | [0m[35m        salt_bytes = str(salt).encode()[0m
[30;1m91 | [0m[35m        length = options.get(CryptoParam.LENGTH, 32)[0m
[30;1m92 | [0m[35m        length = min(length, 32) + 2  # 2 last bytes are to create suffix[0m
[30;1m93 | [0m[35m        iterations = options.get(CryptoParam.ITERATIONS, 100000)[0m
[30;1m94 | [0m[35m        algorithm = options.get(CryptoParam.ALGORITHM, self.hashes.SHA256())[0m

[31m--[ [0m[34mMatch #[0m[33m536[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m    def _create_encryption_key(self, options:Dict[str,Any])->bytes:[0m
[30;1m86 | [0m[35m        password = options.get(CryptoParam.PASSWORD, str(uuid.uuid4()))[0m
[30;1m87 | [0m[35m        password_as_bytes = password.encode()[0m
[30;1m88 | [0m[35m        salt  = options.get(CryptoParam.SALT, uuid.uuid4())[0m
[30;1m89 | [0m[35m        logger().debug(f"_create_encryption_key {type(salt)}")[0m
[30;1m90 | [0m[35m        salt_bytes = str(salt).encode()[0m
[30;1m91 | [0m[35m        length = options.get(CryptoParam.LENGTH, 32)[0m

[31m--[ [0m[34mMatch #[0m[33m537[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m    def _create_encryption_key(self, options:Dict[str,Any])->bytes:[0m
[30;1m86 | [0m[35m        password = options.get(CryptoParam.PASSWORD, str(uuid.uuid4()))[0m
[30;1m87 | [0m[35m        password_as_bytes = password.encode()[0m
[30;1m88 | [0m[35m        salt  = options.get(CryptoParam.SALT, uuid.uuid4())[0m
[30;1m89 | [0m[35m        logger().debug(f"_create_encryption_key {type(salt)}")[0m

[31m--[ [0m[34mMatch #[0m[33m538[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m    def __init__(self, options:Dict[str,Any])->None:[0m
[30;1m62 | [0m[35m        self.set_dependencies()[0m
[30;1m63 | [0m[35m        if self.is_installed():[0m
[30;1m64 | [0m[35m            self._crypto_key = options.get(CryptoParam.CRYPTO_KEY) or self._create_encryption_key(op[0m
[30;1m65 | [0m[35m            self._crypto = self._init_crypto(self._crypto_key)[0m
[30;1m66 | [0m[35m            self._suffix = self._create_suffix_from_key(self._crypto_key)[0m
[30;1m67 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m539[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m112 | [0m[35m            _key = key[0m
[30;1m113 | [0m[35m            if diff < 0:[0m
[30;1m114 | [0m[35m                _key = key[:diff][0m
[30;1m115 | [0m[35m            elif diff > 0:[0m
[30;1m116 | [0m[35m                # logger().debug(f"_init_crypto {type(_key)}")[0m
[30;1m117 | [0m[35m                _key = key +  ("0" * diff).encode()[0m
[30;1m118 | [0m[35m                # logger().debug(f"_init_crypto {type(_key)}")[0m

[31m--[ [0m[34mMatch #[0m[33m540[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m110 | [0m[35m            diff = 32 - key_len[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m            _key = key[0m
[30;1m113 | [0m[35m            if diff < 0:[0m
[30;1m114 | [0m[35m                _key = key[:diff][0m
[30;1m115 | [0m[35m            elif diff > 0:[0m
[30;1m116 | [0m[35m                # logger().debug(f"_init_crypto {type(_key)}")[0m

[31m--[ [0m[34mMatch #[0m[33m541[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m107 | [0m[35m        if key:[0m
[30;1m108 | [0m[35m            key_len = len(key)[0m
[30;1m109 | [0m[35m            # make the key long enough or short enough [0m
[30;1m110 | [0m[35m            diff = 32 - key_len[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m            _key = key[0m
[30;1m113 | [0m[35m            if diff < 0:[0m

[31m--[ [0m[34mMatch #[0m[33m542[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/fernet_crypto.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mfrom typing import Any, Dict[0m
[30;1m8 | [0m[35mimport os[0m
[30;1m9 | [0m[35mimport uuid[0m
[30;1m10 | [0m[35mimport base64[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mfrom .dependencies import Dependencies[0m

[31m--[ [0m[34mMatch #[0m[33m543[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/cache_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m202 | [0m[35m        else:[0m
[30;1m203 | [0m[35m            database_friendly_name = engine.get_database_friendly_name()[0m
[30;1m204 | [0m[35m            cluster_friendly_name = engine.get_cluster_friendly_name()[0m
[30;1m205 | [0m[35m            file_path = self._get_file_path(query, f"{database_friendly_name}_at_{cluster_friendly_n[0m
[30;1m206 | [0m[35m        outfile = open(file_path, "w")[0m
[30;1m207 | [0m[35m        outfile.write(json_dumps(result.json_response))[0m
[30;1m208 | [0m[35m        outfile.flush()[0m

[31m--[ [0m[34mMatch #[0m[33m544[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/cache_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m193 | [0m[35m            folder_parts = [][0m
[30;1m194 | [0m[35m            for part in parts[:-1]:[0m
[30;1m195 | [0m[35m                folder_parts.append(part)[0m
[30;1m196 | [0m[35m                folder_name = f'{path_obj.get("prefix")}/'.join(folder_parts)[0m
[30;1m197 | [0m[35m                os_folder_name = adjust_path(folder_name)[0m
[30;1m198 | [0m[35m                if not os.path.exists(os_folder_name):[0m
[30;1m199 | [0m[35m                    os.makedirs(os_folder_name)[0m

[31m--[ [0m[34mMatch #[0m[33m545[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/cache_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m189 | [0m[35m        if file_path is not None:[0m
[30;1m190 | [0m[35m            path_obj = convert_to_common_path_obj(file_path)[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m            parts = path_obj.get("path").split("/")[0m
[30;1m193 | [0m[35m            folder_parts = [][0m
[30;1m194 | [0m[35m            for part in parts[:-1]:[0m
[30;1m195 | [0m[35m                folder_parts.append(part)[0m

[31m--[ [0m[34mMatch #[0m[33m546[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/cache_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m163 | [0m[35m        try:[0m
[30;1m164 | [0m[35m            str_response = open(file_path, "r").read()[0m
[30;1m165 | [0m[35m            json_response = json.loads(str_response)[0m
[30;1m166 | [0m[35m            if query.startswith(".") and json_response.get("tables") is not None:[0m
[30;1m167 | [0m[35m                return KqlSchemaResponse(json_response)[0m
[30;1m168 | [0m[35m            else:[0m
[30;1m169 | [0m[35m                endpoint_version = self._get_endpoint_version(json_response)[0m

[31m--[ [0m[34mMatch #[0m[33m547[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/cache_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m150 | [0m[35m        :param str query: Query to be executed or a json file with query results.[0m
[30;1m151 | [0m[35m        """[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m        file_path = self._get_file_path(query, database_at_cluster, cache_folder=options.get("use_ca[0m
[30;1m154 | [0m[35m        # collect this inormation, in case bug report will be generated[0m
[30;1m155 | [0m[35m        KqlClient.last_query_info = {[0m
[30;1m156 | [0m[35m            "request": {[0m

[31m--[ [0m[34mMatch #[0m[33m548[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/cache_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m        root_path = IPythonAPI.get_ipython_root_path(**options)[0m
[30;1m29 | [0m[35m        cache_folder_name = options.get("cache_folder_name")[0m
[30;1m30 | [0m[35m        cache_folder_name = f"{Constants.MAGIC_CLASS_NAME_LOWER}/{cache_folder_name}"[0m
[30;1m31 | [0m[35m        if options.get("temp_folder_location") == "user_dir":[0m
[30;1m32 | [0m[35m            # app that has a free/tree build server, are not supporting directories athat starts wit[0m
[30;1m33 | [0m[35m            cache_folder_name = f".{cache_folder_name}"[0m
[30;1m34 | [0m[35m        folder_name_path = f"/{folder_name}" if folder_name else ""[0m

[31m--[ [0m[34mMatch #[0m[33m549[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/cache_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35m    @staticmethod[0m
[30;1m27 | [0m[35m    def abs_cache_folder(folder_name:str=None, **options)->str:[0m
[30;1m28 | [0m[35m        root_path = IPythonAPI.get_ipython_root_path(**options)[0m
[30;1m29 | [0m[35m        cache_folder_name = options.get("cache_folder_name")[0m
[30;1m30 | [0m[35m        cache_folder_name = f"{Constants.MAGIC_CLASS_NAME_LOWER}/{cache_folder_name}"[0m
[30;1m31 | [0m[35m        if options.get("temp_folder_location") == "user_dir":[0m
[30;1m32 | [0m[35m            # app that has a free/tree build server, are not supporting directories athat starts wit[0m

[31m--[ [0m[34mMatch #[0m[33m550[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1239 | [0m[35m                    # obfuscated[0m
[30;1m1240 | [0m[35m                    token_dict[key] = f"..."                   [0m
[30;1m1241 | [0m[35m                else:[0m
[30;1m1242 | [0m[35m                    token_dict[key] = self._options.get("try_token")[key][0m
[30;1m1243 | [0m[35m            kwargs = token_dict[0m
[30;1m1244 | [0m[35m        else:[0m
[30;1m1245 | [0m[35m            pass[0m

[31m--[ [0m[34mMatch #[0m[33m551[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1233 | [0m[35mn_method is AuthenticationMethod.azcli_login_subscription:[0m
[30;1m1234 | [0m[35m            kwargs = {"subscription": self._options.get("try_azcli_login_subscription")}[0m
[30;1m1235 | [0m[35m        elif self._current_authentication_method is AuthenticationMethod.aux_token:[0m
[30;1m1236 | [0m[35m            token_dict = {}[0m
[30;1m1237 | [0m[35m            for key in self._options.get("try_token"):[0m

[31m--[ [0m[34mMatch #[0m[33m552[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1231 | [0m[35m        elif self._current_authentication_method is AuthenticationMethod.vscode_login:[0m
[30;1m1232 | [0m[35m            pass[0m
[30;1m1233 | [0m[35m        elif self._current_authentication_method is AuthenticationMethod.azcli_login_subscription:[0m
[30;1m1234 | [0m[35m            kwargs = {"subscription": self._options.get("try_azcli_login_subscription")}[0m
[30;1m1235 | [0m[35m        elif self._current_authentication_method is AuthenticationMethod.aux_token:[0m
[30;1m1236 | [0m[35m            token_dict = {}[0m
[30;1m1237 | [0m[35m            for key in self._options.get("try_token"):[0m

[31m--[ [0m[34mMatch #[0m[33m553[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1223 | [0m[35m        elif self._current_authentication_method is AuthenticationMethod.aad_application_certificate[0m
[30;1m1224 | [0m[35m            kwargs = {"client_id": self._client_id, "thumbprint": self._thumbprint}[0m
[30;1m1225 | [0m[35m        elif self._current_authentication_method is AuthenticationMethod.managed_service_identity:[0m
[30;1m1226 | [0m[35m            kwargs = self._options.get("try_msi")[0m
[30;1m1227 | [0m[35m        elif self._current_authentication_method is AuthenticationMethod.azcli_login:[0m
[30;1m1228 | [0m[35m            pass[0m
[30;1m1229 | [0m[35m        elif self._current_authentication_method is AuthenticationMethod.azcli_login_by_profile:[0m

[31m--[ [0m[34mMatch #[0m[33m554[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1177 | [0m[35m[0m
[30;1m1178 | [0m[35m[0m
[30;1m1179 | [0m[35m    def _warn_token_diff_from_conn_str(self)->None:[0m
[30;1m1180 | [0m[35m        if self._options.get("auth_token_warnings"):[0m
[30;1m1181 | [0m[35m            token = self._current_token[0m
[30;1m1182 | [0m[35m            if token is not None:[0m
[30;1m1183 | [0m[35m                # to avoid more than one warning per connection, keep track of already displayed war[0m

[31m--[ [0m[34mMatch #[0m[33m555[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1170 | [0m[35m[0m
[30;1m1171 | [0m[35m[0m
[30;1m1172 | [0m[35m    def _warn_on_token_validation_failure(self, message)->None:[0m
[30;1m1173 | [0m[35m        if self._options.get("auth_token_warnings"):[0m
[30;1m1174 | [0m[35m            if self._current_authentication_method is not None and message is not None:[0m
[30;1m1175 | [0m[35m                warn_message =f"Can't use '{self._current_authentication_method}' token entry, {mess[0m
[30;1m1176 | [0m[35m                Display.showWarningMessage(warn_message, display_handler_name='acquire_token', **sel[0m

[31m--[ [0m[34mMatch #[0m[33m556[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1163 | [0m[35m    def _get_aad_login_url(self, aad_login_url=None):[0m
[30;1m1164 | [0m[35m        if aad_login_url is None:[0m
[30;1m1165 | [0m[35m            cloud = self._get_cloud_from_resource()[0m
[30;1m1166 | [0m[35m            aad_login_url = _AAD_URL_BY_CLOUD.get(cloud)[0m
[30;1m1167 | [0m[35m            if aad_login_url is None:[0m
[30;1m1168 | [0m[35m                raise KqlEngineError(f"AAD is not known for this cloud '{cloud}', please use aadurl [0m
[30;1m1169 | [0m[35m        return aad_login_url[0m

[31m--[ [0m[34mMatch #[0m[33m557[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1157 | [0m[35m        for host_suffix in _CLOUD_BY_HOST_SUFFIX:[0m
[30;1m1158 | [0m[35m            if self._resource.endswith(host_suffix):[0m
[30;1m1159 | [0m[35m                return _CLOUD_BY_HOST_SUFFIX[host_suffix][0m
[30;1m1160 | [0m[35m        return self._options.get("cloud")[0m
[30;1m1161 | [0m[35m[0m
[30;1m1162 | [0m[35m[0m
[30;1m1163 | [0m[35m    def _get_aad_login_url(self, aad_login_url=None):[0m

[31m--[ [0m[34mMatch #[0m[33m558[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1150 | [0m[35m                    cache = MsalTokenCache.get_cache(self._client_app_key, **self._options)[0m
[30;1m1151 | [0m[35m                    if cache is not None:[0m
[30;1m1152 | [0m[35m                        global_msal_client_app_sso[self._client_app_key] = self._create_client_app(c[0m
[30;1m1153 | [0m[35m                self._msal_client_app_sso = global_msal_client_app_sso.get(self._client_app_key)[0m
[30;1m1154 | [0m[35m[0m
[30;1m1155 | [0m[35m[0m
[30;1m1156 | [0m[35m    def _get_cloud_from_resource(self):[0m

[31m--[ [0m[34mMatch #[0m[33m559[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1146 | [0m[35m        if self._options.get("enable_sso"):[0m
[30;1m1147 | [0m[35m            self._msal_client_app_sso = msal_client_app_sso[0m
[30;1m1148 | [0m[35m            if self._msal_client_app_sso is None:[0m
[30;1m1149 | [0m[35m                if global_msal_client_app_sso.get(self._client_app_key) is None:[0m
[30;1m1150 | [0m[35m                    cache = MsalTokenCache.get_cache(self._client_app_key, **self._options)[0m
[30;1m1151 | [0m[35m                    if cache is not None:[0m
[30;1m1152 | [0m[35m                        global_msal_client_app_sso[self._client_app_key] = self._create_client_app(c[0m

[31m--[ [0m[34mMatch #[0m[33m560[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1143 | [0m[35m            self._msal_client_app = global_msal_client_app.get(self._client_app_key)[0m
[30;1m1144 | [0m[35m[0m
[30;1m1145 | [0m[35m        self._msal_client_app_sso = None[0m
[30;1m1146 | [0m[35m        if self._options.get("enable_sso"):[0m
[30;1m1147 | [0m[35m            self._msal_client_app_sso = msal_client_app_sso[0m
[30;1m1148 | [0m[35m            if self._msal_client_app_sso is None:[0m
[30;1m1149 | [0m[35m                if global_msal_client_app_sso.get(self._client_app_key) is None:[0m

[31m--[ [0m[34mMatch #[0m[33m561[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1140 | [0m[35m        if self._msal_client_app is None:[0m
[30;1m1141 | [0m[35m            if global_msal_client_app.get(self._client_app_key) is None:[0m
[30;1m1142 | [0m[35m                global_msal_client_app[self._client_app_key] = self._create_client_app(cache=None)[0m
[30;1m1143 | [0m[35m            self._msal_client_app = global_msal_client_app.get(self._client_app_key)[0m
[30;1m1144 | [0m[35m[0m
[30;1m1145 | [0m[35m        self._msal_client_app_sso = None[0m
[30;1m1146 | [0m[35m        if self._options.get("enable_sso"):[0m

[31m--[ [0m[34mMatch #[0m[33m562[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1138 | [0m[35m[0m
[30;1m1139 | [0m[35m        self._msal_client_app = msal_client_app[0m
[30;1m1140 | [0m[35m        if self._msal_client_app is None:[0m
[30;1m1141 | [0m[35m            if global_msal_client_app.get(self._client_app_key) is None:[0m
[30;1m1142 | [0m[35m                global_msal_client_app[self._client_app_key] = self._create_client_app(cache=None)[0m
[30;1m1143 | [0m[35m            self._msal_client_app = global_msal_client_app.get(self._client_app_key)[0m
[30;1m1144 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m563[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m874 | [0m[35m        try:[0m
[30;1m875 | [0m[35m            claims = self._get_token_claims(self._get_token_access_token(token))[0m
[30;1m876 | [0m[35m            tenant_id = claims.get("tid")[0m
[30;1m877 | [0m[35m            issuer = claims.get("iss")[0m
[30;1m878 | [0m[35m[0m
[30;1m879 | [0m[35m            if tenant_id is None and issuer is not None and issuer.startswith("http"):[0m
[30;1m880 | [0m[35m                from urllib.parse import urlparse[0m

[31m--[ [0m[34mMatch #[0m[33m564[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m873 | [0m[35m        authority_uri = None[0m
[30;1m874 | [0m[35m        try:[0m
[30;1m875 | [0m[35m            claims = self._get_token_claims(self._get_token_access_token(token))[0m
[30;1m876 | [0m[35m            tenant_id = claims.get("tid")[0m
[30;1m877 | [0m[35m            issuer = claims.get("iss")[0m
[30;1m878 | [0m[35m[0m
[30;1m879 | [0m[35m            if tenant_id is None and issuer is not None and issuer.startswith("http"):[0m

[31m--[ [0m[34mMatch #[0m[33m565[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m862 | [0m[35m        "retrieve resource list from access token claims"[0m
[30;1m863 | [0m[35m        resources = None[0m
[30;1m864 | [0m[35m        claims = self._get_token_claims(self._get_token_access_token(token))[0m
[30;1m865 | [0m[35m        resources = claims.get("aud")[0m
[30;1m866 | [0m[35m        if type(resources) == str:[0m
[30;1m867 | [0m[35m            resources = [resources][0m
[30;1m868 | [0m[35m        return resources[0m

[31m--[ [0m[34mMatch #[0m[33m566[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m854 | [0m[35m    def _get_client_id_from_token(self, token:dict)->str:[0m
[30;1m855 | [0m[35m        "retrieve client_id from access token claims"[0m
[30;1m856 | [0m[35m        claims = self._get_token_claims(self._get_token_access_token(token))[0m
[30;1m857 | [0m[35m        client_id = claims.get("client_id") or claims.get("appid") or claims.get("azp")[0m
[30;1m858 | [0m[35m        return client_id[0m
[30;1m859 | [0m[35m[0m
[30;1m860 | [0m[35m    [0m

[31m--[ [0m[34mMatch #[0m[33m567[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m854 | [0m[35m    def _get_client_id_from_token(self, token:dict)->str:[0m
[30;1m855 | [0m[35m        "retrieve client_id from access token claims"[0m
[30;1m856 | [0m[35m        claims = self._get_token_claims(self._get_token_access_token(token))[0m
[30;1m857 | [0m[35m        client_id = claims.get("client_id") or claims.get("appid") or claims.get("azp")[0m
[30;1m858 | [0m[35m        return client_id[0m
[30;1m859 | [0m[35m[0m
[30;1m860 | [0m[35m    [0m

[31m--[ [0m[34mMatch #[0m[33m568[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m854 | [0m[35m    def _get_client_id_from_token(self, token:dict)->str:[0m
[30;1m855 | [0m[35m        "retrieve client_id from access token claims"[0m
[30;1m856 | [0m[35m        claims = self._get_token_claims(self._get_token_access_token(token))[0m
[30;1m857 | [0m[35m        client_id = claims.get("client_id") or claims.get("appid") or claims.get("azp")[0m
[30;1m858 | [0m[35m        return client_id[0m
[30;1m859 | [0m[35m[0m
[30;1m860 | [0m[35m    [0m

[31m--[ [0m[34mMatch #[0m[33m569[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m845 | [0m[35m        "retrieve not_before from access token claims"[0m
[30;1m846 | [0m[35m        not_before = None[0m
[30;1m847 | [0m[35m        claims = self._get_token_claims(self._get_token_access_token(token))[0m
[30;1m848 | [0m[35m        nbf = claims.get("nbf")[0m
[30;1m849 | [0m[35m        if nbf is not None:[0m
[30;1m850 | [0m[35m            not_before = time.strftime("%Y-%m-%d %H:%M:%S", time.localtime(nbf))[0m
[30;1m851 | [0m[35m        return not_before[0m

[31m--[ [0m[34mMatch #[0m[33m570[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m835 | [0m[35m        "retrieve expires_on from access token claims"[0m
[30;1m836 | [0m[35m        expires_on = None[0m
[30;1m837 | [0m[35m        claims = self._get_token_claims(self._get_token_access_token(token))[0m
[30;1m838 | [0m[35m        exp = claims.get("exp")[0m
[30;1m839 | [0m[35m        if exp is not None:[0m
[30;1m840 | [0m[35m            expires_on = time.strftime("%Y-%m-%d %H:%M:%S", time.localtime(exp))[0m
[30;1m841 | [0m[35m        return expires_on[0m

[31m--[ [0m[34mMatch #[0m[33m571[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m827 | [0m[35m        id_token_claims = self._get_token_claims(self._get_token_id_token(token))[0m
[30;1m828 | [0m[35m        access_token_claims = self._get_token_claims(self._get_token_access_token(token))[0m
[30;1m829 | [0m[35m        claims = {**access_token_claims, **id_token_claims}[0m
[30;1m830 | [0m[35m        username = claims.get("preferred_username") or claims.get("unique_name") or claims.get("upn"[0m
[30;1m831 | [0m[35m        return username[0m
[30;1m832 | [0m[35m[0m
[30;1m833 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m572[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m827 | [0m[35m        id_token_claims = self._get_token_claims(self._get_token_id_token(token))[0m
[30;1m828 | [0m[35m        access_token_claims = self._get_token_claims(self._get_token_access_token(token))[0m
[30;1m829 | [0m[35m        claims = {**access_token_claims, **id_token_claims}[0m
[30;1m830 | [0m[35m        username = claims.get("preferred_username") or claims.get("unique_name") or claims.get("upn"[0m
[30;1m831 | [0m[35m        return username[0m
[30;1m832 | [0m[35m[0m
[30;1m833 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m573[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m827 | [0m[35m        id_token_claims = self._get_token_claims(self._get_token_id_token(token))[0m
[30;1m828 | [0m[35m        access_token_claims = self._get_token_claims(self._get_token_access_token(token))[0m
[30;1m829 | [0m[35m        claims = {**access_token_claims, **id_token_claims}[0m
[30;1m830 | [0m[35m        username = claims.get("preferred_username") or claims.get("unique_name") or claims.get("upn"[0m
[30;1m831 | [0m[35m        return username[0m
[30;1m832 | [0m[35m[0m
[30;1m833 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m574[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m827 | [0m[35m        id_token_claims = self._get_token_claims(self._get_token_id_token(token))[0m
[30;1m828 | [0m[35m        access_token_claims = self._get_token_claims(self._get_token_access_token(token))[0m
[30;1m829 | [0m[35m        claims = {**access_token_claims, **id_token_claims}[0m
[30;1m830 | [0m[35m        username = claims.get("preferred_username") or claims.get("unique_name") or claims.get("upn"[0m
[30;1m831 | [0m[35m        return username[0m
[30;1m832 | [0m[35m[0m
[30;1m833 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m575[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m827 | [0m[35m        id_token_claims = self._get_token_claims(self._get_token_id_token(token))[0m
[30;1m828 | [0m[35m        access_token_claims = self._get_token_claims(self._get_token_access_token(token))[0m
[30;1m829 | [0m[35m        claims = {**access_token_claims, **id_token_claims}[0m
[30;1m830 | [0m[35m        username = claims.get("preferred_username") or claims.get("unique_name") or claims.get("upn"[0m
[30;1m831 | [0m[35m        return username[0m
[30;1m832 | [0m[35m[0m
[30;1m833 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m576[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m806 | [0m[35m[0m
[30;1m807 | [0m[35m[0m
[30;1m808 | [0m[35m    def _get_token_authority(self, token:dict, default_authority:str=None)->str:[0m
[30;1m809 | [0m[35m        return token.get(TokenResponseFieldsV1._AUTHORITY) or default_authority[0m
[30;1m810 | [0m[35m[0m
[30;1m811 | [0m[35m[0m
[30;1m812 | [0m[35m    def _create_authorization_header(self)->str:[0m

[31m--[ [0m[34mMatch #[0m[33m577[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m801 | [0m[35m[0m
[30;1m802 | [0m[35m    def _get_token_id_token(self, token:dict, default_id_token:str=None)->str:[0m
[30;1m803 | [0m[35m        return (token.get(OAuth2TokenFields.ID_TOKEN)[0m
[30;1m804 | [0m[35m                or token.get(TokenResponseFieldsV2.ID_TOKEN)[0m
[30;1m805 | [0m[35m                or default_id_token)[0m
[30;1m806 | [0m[35m[0m
[30;1m807 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m578[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m800 | [0m[35m[0m
[30;1m801 | [0m[35m[0m
[30;1m802 | [0m[35m    def _get_token_id_token(self, token:dict, default_id_token:str=None)->str:[0m
[30;1m803 | [0m[35m        return (token.get(OAuth2TokenFields.ID_TOKEN)[0m
[30;1m804 | [0m[35m                or token.get(TokenResponseFieldsV2.ID_TOKEN)[0m
[30;1m805 | [0m[35m                or default_id_token)[0m
[30;1m806 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m579[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m795 | [0m[35m    def _get_token_refresh_token(self, token:dict, default_refresh_token:str=None)->str:[0m
[30;1m796 | [0m[35m        return (token.get(TokenResponseFieldsV1.REFRESH_TOKEN)[0m
[30;1m797 | [0m[35m                or token.get(TokenResponseFieldsV2.REFRESH_TOKEN)[0m
[30;1m798 | [0m[35m                or token.get(OAuth2TokenFields.REFRESH_TOKEN)[0m
[30;1m799 | [0m[35m                or default_refresh_token)[0m
[30;1m800 | [0m[35m[0m
[30;1m801 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m580[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m794 | [0m[35m[0m
[30;1m795 | [0m[35m    def _get_token_refresh_token(self, token:dict, default_refresh_token:str=None)->str:[0m
[30;1m796 | [0m[35m        return (token.get(TokenResponseFieldsV1.REFRESH_TOKEN)[0m
[30;1m797 | [0m[35m                or token.get(TokenResponseFieldsV2.REFRESH_TOKEN)[0m
[30;1m798 | [0m[35m                or token.get(OAuth2TokenFields.REFRESH_TOKEN)[0m
[30;1m799 | [0m[35m                or default_refresh_token)[0m
[30;1m800 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m581[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m793 | [0m[35m[0m
[30;1m794 | [0m[35m[0m
[30;1m795 | [0m[35m    def _get_token_refresh_token(self, token:dict, default_refresh_token:str=None)->str:[0m
[30;1m796 | [0m[35m        return (token.get(TokenResponseFieldsV1.REFRESH_TOKEN)[0m
[30;1m797 | [0m[35m                or token.get(TokenResponseFieldsV2.REFRESH_TOKEN)[0m
[30;1m798 | [0m[35m                or token.get(OAuth2TokenFields.REFRESH_TOKEN)[0m
[30;1m799 | [0m[35m                or default_refresh_token)[0m

[31m--[ [0m[34mMatch #[0m[33m582[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m789 | [0m[35m[0m
[30;1m790 | [0m[35m[0m
[30;1m791 | [0m[35m    def _get_token_user_id(self, token:dict, default_user_id:str=None)->str:[0m
[30;1m792 | [0m[35m        return token.get(TokenResponseFieldsV1.USER_ID) or default_user_id[0m
[30;1m793 | [0m[35m[0m
[30;1m794 | [0m[35m[0m
[30;1m795 | [0m[35m    def _get_token_refresh_token(self, token:dict, default_refresh_token:str=None)->str:[0m

[31m--[ [0m[34mMatch #[0m[33m583[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m779 | [0m[35m[0m
[30;1m780 | [0m[35m[0m
[30;1m781 | [0m[35m    def _get_token_scope(self, token:dict, default_scopes:str=None)->list:[0m
[30;1m782 | [0m[35m        scope = token.get(TokenResponseFieldsV2.SCOPE)[0m
[30;1m783 | [0m[35m        if scope is None:[0m
[30;1m784 | [0m[35m            resource = self._get_token_resource(token) or self._get_resources_from_token(token) or s[0m
[30;1m785 | [0m[35m            if resource is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m584[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m775 | [0m[35m            scope = token.get(TokenResponseFieldsV2.SCOPE)[0m
[30;1m776 | [0m[35m            if scope is not None:[0m
[30;1m777 | [0m[35m                resource = '/'.join(scope.split(None, 1)[0].spilt('/')[:3])[0m
[30;1m778 | [0m[35m        return token.get(TokenResponseFieldsV1.RESOURCE) or token.get(OAuth2TokenFields.RESOURCE) or[0m
[30;1m779 | [0m[35m[0m
[30;1m780 | [0m[35m[0m
[30;1m781 | [0m[35m    def _get_token_scope(self, token:dict, default_scopes:str=None)->list:[0m

[31m--[ [0m[34mMatch #[0m[33m585[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m775 | [0m[35m            scope = token.get(TokenResponseFieldsV2.SCOPE)[0m
[30;1m776 | [0m[35m            if scope is not None:[0m
[30;1m777 | [0m[35m                resource = '/'.join(scope.split(None, 1)[0].spilt('/')[:3])[0m
[30;1m778 | [0m[35m        return token.get(TokenResponseFieldsV1.RESOURCE) or token.get(OAuth2TokenFields.RESOURCE) or[0m
[30;1m779 | [0m[35m[0m
[30;1m780 | [0m[35m[0m
[30;1m781 | [0m[35m    def _get_token_scope(self, token:dict, default_scopes:str=None)->list:[0m

[31m--[ [0m[34mMatch #[0m[33m586[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m772 | [0m[35m    def _get_token_resource(self, token:dict, default_resource:str=None)->str:[0m
[30;1m773 | [0m[35m        resource = token.get(TokenResponseFieldsV1.RESOURCE)[0m
[30;1m774 | [0m[35m        if resource is None:[0m
[30;1m775 | [0m[35m            scope = token.get(TokenResponseFieldsV2.SCOPE)[0m
[30;1m776 | [0m[35m            if scope is not None:[0m
[30;1m777 | [0m[35m                resource = '/'.join(scope.split(None, 1)[0].spilt('/')[:3])[0m
[30;1m778 | [0m[35m        return token.get(TokenResponseFieldsV1.RESOURCE) or token.get(OAuth2TokenFields.RESOURCE) or[0m

[31m--[ [0m[34mMatch #[0m[33m587[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m770 | [0m[35m[0m
[30;1m771 | [0m[35m[0m
[30;1m772 | [0m[35m    def _get_token_resource(self, token:dict, default_resource:str=None)->str:[0m
[30;1m773 | [0m[35m        resource = token.get(TokenResponseFieldsV1.RESOURCE)[0m
[30;1m774 | [0m[35m        if resource is None:[0m
[30;1m775 | [0m[35m            scope = token.get(TokenResponseFieldsV2.SCOPE)[0m
[30;1m776 | [0m[35m            if scope is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m588[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m765 | [0m[35m    def _get_token_token_type(self, token:dict, default_token_type:str=None)->str:[0m
[30;1m766 | [0m[35m        return (token.get(TokenResponseFieldsV1.TOKEN_TYPE)[0m
[30;1m767 | [0m[35m                or token.get(TokenResponseFieldsV2.TOKEN_TYPE)[0m
[30;1m768 | [0m[35m                or token.get(OAuth2TokenFields.TOKEN_TYPE)[0m
[30;1m769 | [0m[35m                or default_token_type)[0m
[30;1m770 | [0m[35m[0m
[30;1m771 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m589[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m764 | [0m[35m[0m
[30;1m765 | [0m[35m    def _get_token_token_type(self, token:dict, default_token_type:str=None)->str:[0m
[30;1m766 | [0m[35m        return (token.get(TokenResponseFieldsV1.TOKEN_TYPE)[0m
[30;1m767 | [0m[35m                or token.get(TokenResponseFieldsV2.TOKEN_TYPE)[0m
[30;1m768 | [0m[35m                or token.get(OAuth2TokenFields.TOKEN_TYPE)[0m
[30;1m769 | [0m[35m                or default_token_type)[0m
[30;1m770 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m590[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m763 | [0m[35m[0m
[30;1m764 | [0m[35m[0m
[30;1m765 | [0m[35m    def _get_token_token_type(self, token:dict, default_token_type:str=None)->str:[0m
[30;1m766 | [0m[35m        return (token.get(TokenResponseFieldsV1.TOKEN_TYPE)[0m
[30;1m767 | [0m[35m                or token.get(TokenResponseFieldsV2.TOKEN_TYPE)[0m
[30;1m768 | [0m[35m                or token.get(OAuth2TokenFields.TOKEN_TYPE)[0m
[30;1m769 | [0m[35m                or default_token_type)[0m

[31m--[ [0m[34mMatch #[0m[33m591[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m755 | [0m[35m        if token.get(OAuth2TokenFields.NOT_BEFORE) is not None:[0m
[30;1m756 | [0m[35m            try:[0m
[30;1m757 | [0m[35m                # The date is represented as the number of seconds from "1970-01-01T0:0:0Z UTC" (cor[0m
[30;1m758 | [0m[35m                not_before = time.strftime("%Y-%m-%d %H:%M:%S", time.localtime(token.get(OAuth2Token[0m
[30;1m759 | [0m[35m            except: # pylint: disable=bare-except[0m
[30;1m760 | [0m[35m                # this happens if the not_before field is empty or is not a float (i.e datetime)[0m
[30;1m761 | [0m[35m                not_before = None[0m

[31m--[ [0m[34mMatch #[0m[33m592[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m752 | [0m[35m[0m
[30;1m753 | [0m[35m    def _get_token_not_before(self, token:dict, default_not_before:str=None)->str:[0m
[30;1m754 | [0m[35m        not_before = default_not_before[0m
[30;1m755 | [0m[35m        if token.get(OAuth2TokenFields.NOT_BEFORE) is not None:[0m
[30;1m756 | [0m[35m            try:[0m
[30;1m757 | [0m[35m                # The date is represented as the number of seconds from "1970-01-01T0:0:0Z UTC" (cor[0m
[30;1m758 | [0m[35m                not_before = time.strftime("%Y-%m-%d %H:%M:%S", time.localtime(token.get(OAuth2Token[0m

[31m--[ [0m[34mMatch #[0m[33m593[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m743 | [0m[35m        elif token.get(OAuth2TokenFields.EXPIRES_ON) is not None:[0m
[30;1m744 | [0m[35m            try:[0m
[30;1m745 | [0m[35m                # The date is represented as the number of seconds from "1970-01-01T0:0:0Z UTC" (cor[0m
[30;1m746 | [0m[35m                expires_on = time.strftime("%Y-%m-%d %H:%M:%S", time.localtime(token.get(OAuth2Token[0m
[30;1m747 | [0m[35m            except: # pylint: disable=bare-except[0m
[30;1m748 | [0m[35m                # this happens if the expires_on field is empty or is not a float (i.e datetime)[0m
[30;1m749 | [0m[35m                expires_on = None[0m

[31m--[ [0m[34mMatch #[0m[33m594[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m740 | [0m[35m        expires_on = default_expires_on[0m
[30;1m741 | [0m[35m        if token.get(TokenResponseFieldsV1.EXPIRES_ON) is not None:[0m
[30;1m742 | [0m[35m            expires_on = token.get(TokenResponseFieldsV1.EXPIRES_ON)[0m
[30;1m743 | [0m[35m        elif token.get(OAuth2TokenFields.EXPIRES_ON) is not None:[0m
[30;1m744 | [0m[35m            try:[0m
[30;1m745 | [0m[35m                # The date is represented as the number of seconds from "1970-01-01T0:0:0Z UTC" (cor[0m
[30;1m746 | [0m[35m                expires_on = time.strftime("%Y-%m-%d %H:%M:%S", time.localtime(token.get(OAuth2Token[0m

[31m--[ [0m[34mMatch #[0m[33m595[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m739 | [0m[35m    def _get_token_expires_on(self, token:dict, default_expires_on:str=None)->str:[0m
[30;1m740 | [0m[35m        expires_on = default_expires_on[0m
[30;1m741 | [0m[35m        if token.get(TokenResponseFieldsV1.EXPIRES_ON) is not None:[0m
[30;1m742 | [0m[35m            expires_on = token.get(TokenResponseFieldsV1.EXPIRES_ON)[0m
[30;1m743 | [0m[35m        elif token.get(OAuth2TokenFields.EXPIRES_ON) is not None:[0m
[30;1m744 | [0m[35m            try:[0m
[30;1m745 | [0m[35m                # The date is represented as the number of seconds from "1970-01-01T0:0:0Z UTC" (cor[0m

[31m--[ [0m[34mMatch #[0m[33m596[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m738 | [0m[35m[0m
[30;1m739 | [0m[35m    def _get_token_expires_on(self, token:dict, default_expires_on:str=None)->str:[0m
[30;1m740 | [0m[35m        expires_on = default_expires_on[0m
[30;1m741 | [0m[35m        if token.get(TokenResponseFieldsV1.EXPIRES_ON) is not None:[0m
[30;1m742 | [0m[35m            expires_on = token.get(TokenResponseFieldsV1.EXPIRES_ON)[0m
[30;1m743 | [0m[35m        elif token.get(OAuth2TokenFields.EXPIRES_ON) is not None:[0m
[30;1m744 | [0m[35m            try:[0m

[31m--[ [0m[34mMatch #[0m[33m597[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m732 | [0m[35m[0m
[30;1m733 | [0m[35m    def _get_token_client_id(self, token:dict, default_client_id:str=None)->str:[0m
[30;1m734 | [0m[35m        return (token.get(TokenResponseFieldsV1._CLIENT_ID)[0m
[30;1m735 | [0m[35m                or token.get(OAuth2TokenFields.CLIENT_ID)[0m
[30;1m736 | [0m[35m                or default_client_id)[0m
[30;1m737 | [0m[35m[0m
[30;1m738 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m598[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m731 | [0m[35m[0m
[30;1m732 | [0m[35m[0m
[30;1m733 | [0m[35m    def _get_token_client_id(self, token:dict, default_client_id:str=None)->str:[0m
[30;1m734 | [0m[35m        return (token.get(TokenResponseFieldsV1._CLIENT_ID)[0m
[30;1m735 | [0m[35m                or token.get(OAuth2TokenFields.CLIENT_ID)[0m
[30;1m736 | [0m[35m                or default_client_id)[0m
[30;1m737 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m599[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m726 | [0m[35m    def _get_token_access_token(self, token:dict, default_access_token:str=None)->str:[0m
[30;1m727 | [0m[35m        return (token.get(TokenResponseFieldsV1.ACCESS_TOKEN)[0m
[30;1m728 | [0m[35m                or token.get(TokenResponseFieldsV2.ACCESS_TOKEN)[0m
[30;1m729 | [0m[35m                or token.get(OAuth2TokenFields.ACCESS_TOKEN)[0m
[30;1m730 | [0m[35m                or default_access_token)[0m
[30;1m731 | [0m[35m[0m
[30;1m732 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m600[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m725 | [0m[35m    #[0m
[30;1m726 | [0m[35m    def _get_token_access_token(self, token:dict, default_access_token:str=None)->str:[0m
[30;1m727 | [0m[35m        return (token.get(TokenResponseFieldsV1.ACCESS_TOKEN)[0m
[30;1m728 | [0m[35m                or token.get(TokenResponseFieldsV2.ACCESS_TOKEN)[0m
[30;1m729 | [0m[35m                or token.get(OAuth2TokenFields.ACCESS_TOKEN)[0m
[30;1m730 | [0m[35m                or default_access_token)[0m
[30;1m731 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m601[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m724 | [0m[35m    # Assume OAuth2 format (e.g. MSI Token) too[0m
[30;1m725 | [0m[35m    #[0m
[30;1m726 | [0m[35m    def _get_token_access_token(self, token:dict, default_access_token:str=None)->str:[0m
[30;1m727 | [0m[35m        return (token.get(TokenResponseFieldsV1.ACCESS_TOKEN)[0m
[30;1m728 | [0m[35m                or token.get(TokenResponseFieldsV2.ACCESS_TOKEN)[0m
[30;1m729 | [0m[35m                or token.get(OAuth2TokenFields.ACCESS_TOKEN)[0m
[30;1m730 | [0m[35m                or default_access_token)[0m

[31m--[ [0m[34mMatch #[0m[33m602[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m573 | [0m[35m                            sys.stdout.flush()[0m
[30;1m574 | [0m[35m                            input("Press Enter after signing in from another device to proceed, CTRL[0m
[30;1m575 | [0m[35m[0m
[30;1m576 | [0m[35m                    elif device_code_login_notification == "popup_interaction" and self._options.get[0m
[30;1m577 | [0m[35m                        before_text = f"<b>{device_code}</b>"[0m
[30;1m578 | [0m[35m                        button_text = "Copy code to clipboard and authenticate"[0m
[30;1m579 | [0m[35m                        # before_text = f"Copy code: {device_code} to verification url: {url} and "[0m

[31m--[ [0m[34mMatch #[0m[33m603[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m522 | [0m[35met("login_code_destination") =="browser":[0m
[30;1m523 | [0m[35m                    #     raise Exception("error: using papermill without an email specified is not [0m
[30;1m524 | [0m[35m                    if device_code_login_notification == "email":[0m
[30;1m525 | [0m[35m                        params = Parser.parse_and_get_kv_string(self._options.get('device_code_notif[0m
[30;1m526 | [0m[35m                        email_notification = EmailNotification(**params)[0m
[30;1m527 | [0m[35m                        subject = f"Kqlmagic device_code {device_code} authentication (context: {ema[0m

[31m--[ [0m[34mMatch #[0m[33m604[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m519 | [0m[35m                        except: # pylint: disable=bare-except[0m
[30;1m520 | [0m[35m                            pass[0m
[30;1m521 | [0m[35m[0m
[30;1m522 | [0m[35m                    # if  self._options.get("notebook_app")=="papermill" and self._options.get("logi[0m
[30;1m523 | [0m[35m                    #     raise Exception("error: using papermill without an email specified is not [0m
[30;1m524 | [0m[35m                    if device_code_login_notification == "email":[0m
[30;1m525 | [0m[35m                        params = Parser.parse_and_get_kv_string(self._options.get('device_code_notif[0m

[31m--[ [0m[34mMatch #[0m[33m605[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m519 | [0m[35m                        except: # pylint: disable=bare-except[0m
[30;1m520 | [0m[35m                            pass[0m
[30;1m521 | [0m[35m[0m
[30;1m522 | [0m[35m                    # if  self._options.get("notebook_app")=="papermill" and self._options.get("logi[0m
[30;1m523 | [0m[35m                    #     raise Exception("error: using papermill without an email specified is not [0m
[30;1m524 | [0m[35m                    if device_code_login_notification == "email":[0m
[30;1m525 | [0m[35m                        params = Parser.parse_and_get_kv_string(self._options.get('device_code_notif[0m

[31m--[ [0m[34mMatch #[0m[33m606[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m510 | [0m[35m[0m
[30;1m511 | [0m[35m                    if (self._options.get("kernel_location") == "local"[0m
[30;1m512 | [0m[35m                            or device_code_login_notification in ["browser", "browser_reference"][0m
[30;1m513 | [0m[35m                            or (device_code_login_notification == "popup_interaction" and self._opti[0m
[30;1m514 | [0m[35m                        # copy code to local clipboard[0m
[30;1m515 | [0m[35m                        try:[0m
[30;1m516 | [0m[35m                            pyperclip = Dependencies.get_module("pyperclip", dont_throw=True)[0m

[31m--[ [0m[34mMatch #[0m[33m607[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m508 | [0m[35m                        else:[0m
[30;1m509 | [0m[35m                            device_code_login_notification = "button"[0m
[30;1m510 | [0m[35m[0m
[30;1m511 | [0m[35m                    if (self._options.get("kernel_location") == "local"[0m
[30;1m512 | [0m[35m                            or device_code_login_notification in ["browser", "browser_reference"][0m
[30;1m513 | [0m[35m                            or (device_code_login_notification == "popup_interaction" and self._opti[0m
[30;1m514 | [0m[35m                        # copy code to local clipboard[0m

[31m--[ [0m[34mMatch #[0m[33m608[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m503 | [0m[35m                                    device_code_login_notification = "browser_reference"[0m
[30;1m504 | [0m[35m                            else:[0m
[30;1m505 | [0m[35m                                device_code_login_notification = "terminal"[0m
[30;1m506 | [0m[35m                        elif self._options.get("notebook_app") in ["azureml", "azuremljupyternoteboo[0m
[30;1m507 | [0m[35m                            device_code_login_notification = "terminal_reference"[0m
[30;1m508 | [0m[35m                        else:[0m
[30;1m509 | [0m[35m                            device_code_login_notification = "button"[0m

[31m--[ [0m[34mMatch #[0m[33m609[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m497 | [0m[35m             if self._options.get("temp_files_server_address") is not None:[0m
[30;1m498 | [0m[35m                                    import urllib.parse[0m
[30;1m499 | [0m[35m                                    indirect_url = f'{self._options.get("temp_files_server_address")[0m
[30;1m500 | [0m[35m                                    url = indirect_url[0m
[30;1m501 | [0m[35m                                    device_code_login_notification = "popup_interaction"[0m
[30;1m502 | [0m[35m                                else:[0m
[30;1m503 | [0m[35m                                    device_code_login_notification = "browser_reference"[0m

[31m--[ [0m[34mMatch #[0m[33m610[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m496 | [0m[35mot execute authentication script, workaround using temp_file_server webbrowser[0m
[30;1m497 | [0m[35m                                if self._options.get("temp_files_server_address") is not None:[0m
[30;1m498 | [0m[35m                                    import urllib.parse[0m
[30;1m499 | [0m[35m                                    indirect_url = f'{self._options.get("temp_files_server_address")[0m
[30;1m500 | [0m[35m                                    url = indirect_url[0m
[30;1m501 | [0m[35m                                    device_code_login_notification = "popup_interaction"[0m
[30;1m502 | [0m[35m                                else:[0m

[31m--[ [0m[34mMatch #[0m[33m611[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m494 | [0m[35m[0m
[30;1m495 | [0m[35m                            if self._options.get("kernel_location") == "local":[0m
[30;1m496 | [0m[35m                                # ntreact cannot execute authentication script, workaround using tem[0m
[30;1m497 | [0m[35m                                if self._options.get("temp_files_server_address") is not None:[0m
[30;1m498 | [0m[35m                                    import urllib.parse[0m
[30;1m499 | [0m[35m                                    indirect_url = f'{self._options.get("temp_files_server_address")[0m
[30;1m500 | [0m[35m                                    url = indirect_url[0m

[31m--[ [0m[34mMatch #[0m[33m612[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m492 | [0m[35m                            device_code_login_notification = "popup_interaction"[0m
[30;1m493 | [0m[35m                        elif self._options.get("notebook_app") in ["nteract"]:[0m
[30;1m494 | [0m[35m[0m
[30;1m495 | [0m[35m                            if self._options.get("kernel_location") == "local":[0m
[30;1m496 | [0m[35m                                # ntreact cannot execute authentication script, workaround using tem[0m
[30;1m497 | [0m[35m                                if self._options.get("temp_files_server_address") is not None:[0m
[30;1m498 | [0m[35m                                    import urllib.parse[0m

[31m--[ [0m[34mMatch #[0m[33m613[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m490 | [0m[35m                            device_code_login_notification = "popup_interaction"[0m
[30;1m491 | [0m[35m                        elif self._options.get("notebook_app") in ["visualstudiocode", "azuredatastu[0m
[30;1m492 | [0m[35m                            device_code_login_notification = "popup_interaction"[0m
[30;1m493 | [0m[35m                        elif self._options.get("notebook_app") in ["nteract"]:[0m
[30;1m494 | [0m[35m[0m
[30;1m495 | [0m[35m                            if self._options.get("kernel_location") == "local":[0m
[30;1m496 | [0m[35m                                # ntreact cannot execute authentication script, workaround using tem[0m

[31m--[ [0m[34mMatch #[0m[33m614[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m488 | [0m[35m                    if device_code_login_notification == "auto":[0m
[30;1m489 | [0m[35m                        if self._options.get("notebook_app") in ["ipython"]:[0m
[30;1m490 | [0m[35m                            device_code_login_notification = "popup_interaction"[0m
[30;1m491 | [0m[35m                        elif self._options.get("notebook_app") in ["visualstudiocode", "azuredatastu[0m
[30;1m492 | [0m[35m                            device_code_login_notification = "popup_interaction"[0m
[30;1m493 | [0m[35m                        elif self._options.get("notebook_app") in ["nteract"]:[0m
[30;1m494 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m615[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m486 | [0m[35m[0m
[30;1m487 | [0m[35m                    device_code_login_notification = self._options.get("device_code_login_notificati[0m
[30;1m488 | [0m[35m                    if device_code_login_notification == "auto":[0m
[30;1m489 | [0m[35m                        if self._options.get("notebook_app") in ["ipython"]:[0m
[30;1m490 | [0m[35m                            device_code_login_notification = "popup_interaction"[0m
[30;1m491 | [0m[35m                        elif self._options.get("notebook_app") in ["visualstudiocode", "azuredatastu[0m
[30;1m492 | [0m[35m                            device_code_login_notification = "popup_interaction"[0m

[31m--[ [0m[34mMatch #[0m[33m616[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m484 | [0m[35m                    url = flow[OAuth2DeviceCodeResponseParameters.VERIFICATION_URL][0m
[30;1m485 | [0m[35m                    device_code = flow[OAuth2DeviceCodeResponseParameters.USER_CODE].strip()[0m
[30;1m486 | [0m[35m[0m
[30;1m487 | [0m[35m                    device_code_login_notification = self._options.get("device_code_login_notificati[0m
[30;1m488 | [0m[35m                    if device_code_login_notification == "auto":[0m
[30;1m489 | [0m[35m                        if self._options.get("notebook_app") in ["ipython"]:[0m
[30;1m490 | [0m[35m                            device_code_login_notification = "popup_interaction"[0m

[31m--[ [0m[34mMatch #[0m[33m617[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m469 | [0m[35mpp.acquire_token_for_client(scopes=self._scopes)[0m
[30;1m470 | [0m[35m[0m
[30;1m471 | [0m[35m                elif self._authentication_method is AuthenticationMethod.aad_code_login and ([0m
[30;1m472 | [0m[35m                    self._options.get("code_auth_interactive_mode") == "auth_code"  or (self._option[0m
[30;1m473 | [0m[35m                    acquire_token_result = self._current_msal_client_app.acquire_token_interactive([0m
[30;1m474 | [0m[35m                        scopes=self._scopes,[0m
[30;1m475 | [0m[35m                        login_hint = self._current_username,[0m

[31m--[ [0m[34mMatch #[0m[33m618[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m469 | [0m[35m  acquire_token_result = self._current_msal_client_app.acquire_token_for_client(scopes=self._scopes)[0m
[30;1m470 | [0m[35m[0m
[30;1m471 | [0m[35m                elif self._authentication_method is AuthenticationMethod.aad_code_login and ([0m
[30;1m472 | [0m[35m                    self._options.get("code_auth_interactive_mode") == "auth_code"  or (self._option[0m
[30;1m473 | [0m[35m                    acquire_token_result = self._current_msal_client_app.acquire_token_interactive([0m
[30;1m474 | [0m[35m                        scopes=self._scopes,[0m

[31m--[ [0m[34mMatch #[0m[33m619[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m468 | [0m[35muthenticationMethod.aad_application_certificate:[0m
[30;1m469 | [0m[35m                    acquire_token_result = self._current_msal_client_app.acquire_token_for_client(sc[0m
[30;1m470 | [0m[35m[0m
[30;1m471 | [0m[35m                elif self._authentication_method is AuthenticationMethod.aad_code_login and ([0m
[30;1m472 | [0m[35m                    self._options.get("code_auth_interactive_mode") == "auth_code"  or (self._option[0m
[30;1m473 | [0m[35m                    acquire_token_result = self._current_msal_client_app.acquire_token_interactive([0m

[31m--[ [0m[34mMatch #[0m[33m620[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m417 | [0m[35m                    self._current_token = self._validate_and_refresh_token(token)[0m
[30;1m418 | [0m[35m[0m
[30;1m419 | [0m[35m            if self._current_token is None:[0m
[30;1m420 | [0m[35m                if self._options.get("try_vscode_login"):[0m
[30;1m421 | [0m[35m                    token = self._get_vscode_token()[0m
[30;1m422 | [0m[35m                    self._current_token = self._validate_and_refresh_token(token)[0m
[30;1m423 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m621[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m412 | [0m[35m                    self._current_token = self._validate_and_refresh_token(token)[0m
[30;1m413 | [0m[35m[0m
[30;1m414 | [0m[35m            if self._current_token is None:[0m
[30;1m415 | [0m[35m                if self._options.get("try_azcli_login_by_profile"):[0m
[30;1m416 | [0m[35m                    token = self._get_azcli_token_by_profile()[0m
[30;1m417 | [0m[35m                    self._current_token = self._validate_and_refresh_token(token)[0m
[30;1m418 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m622[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m407 | [0m[35m                    self._current_token = self._validate_and_refresh_token(token)[0m
[30;1m408 | [0m[35m[0m
[30;1m409 | [0m[35m            if self._current_token is None:[0m
[30;1m410 | [0m[35m                if self._options.get("try_azcli_login"):[0m
[30;1m411 | [0m[35m                    token = self._get_azcli_token()[0m
[30;1m412 | [0m[35m                    self._current_token = self._validate_and_refresh_token(token)[0m
[30;1m413 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m623[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m403 | [0m[35m[0m
[30;1m404 | [0m[35m            if self._current_token is None:[0m
[30;1m405 | [0m[35m                if self._options.get("try_azcli_login_subscription") is not None:[0m
[30;1m406 | [0m[35m                    token = self._get_azcli_token(subscription=self._options.get("try_azcli_login_su[0m
[30;1m407 | [0m[35m                    self._current_token = self._validate_and_refresh_token(token)[0m
[30;1m408 | [0m[35m[0m
[30;1m409 | [0m[35m            if self._current_token is None:[0m

[31m--[ [0m[34mMatch #[0m[33m624[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m402 | [0m[35m                    self._current_token = self._validate_and_refresh_token(token)[0m
[30;1m403 | [0m[35m[0m
[30;1m404 | [0m[35m            if self._current_token is None:[0m
[30;1m405 | [0m[35m                if self._options.get("try_azcli_login_subscription") is not None:[0m
[30;1m406 | [0m[35m                    token = self._get_azcli_token(subscription=self._options.get("try_azcli_login_su[0m
[30;1m407 | [0m[35m                    self._current_token = self._validate_and_refresh_token(token)[0m
[30;1m408 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m625[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m398 | [0m[35m[0m
[30;1m399 | [0m[35m            if self._current_token is None:[0m
[30;1m400 | [0m[35m                if self._options.get("try_msi") is not None:[0m
[30;1m401 | [0m[35m                    token = self._get_msi_token(msi_params=self._options.get("try_msi"))[0m
[30;1m402 | [0m[35m                    self._current_token = self._validate_and_refresh_token(token)[0m
[30;1m403 | [0m[35m[0m
[30;1m404 | [0m[35m            if self._current_token is None:[0m

[31m--[ [0m[34mMatch #[0m[33m626[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m397 | [0m[35m                    self._current_token = self._validate_and_refresh_token(token)[0m
[30;1m398 | [0m[35m[0m
[30;1m399 | [0m[35m            if self._current_token is None:[0m
[30;1m400 | [0m[35m                if self._options.get("try_msi") is not None:[0m
[30;1m401 | [0m[35m                    token = self._get_msi_token(msi_params=self._options.get("try_msi"))[0m
[30;1m402 | [0m[35m                    self._current_token = self._validate_and_refresh_token(token)[0m
[30;1m403 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m627[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m393 | [0m[35m[0m
[30;1m394 | [0m[35m            if self._current_token is None:[0m
[30;1m395 | [0m[35m                if self._options.get("try_token") is not None:[0m
[30;1m396 | [0m[35m                    token = self._get_aux_token(token=self._options.get("try_token"))[0m
[30;1m397 | [0m[35m                    self._current_token = self._validate_and_refresh_token(token)[0m
[30;1m398 | [0m[35m[0m
[30;1m399 | [0m[35m            if self._current_token is None:[0m

[31m--[ [0m[34mMatch #[0m[33m628[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m392 | [0m[35m                self._current_username = None[0m
[30;1m393 | [0m[35m[0m
[30;1m394 | [0m[35m            if self._current_token is None:[0m
[30;1m395 | [0m[35m                if self._options.get("try_token") is not None:[0m
[30;1m396 | [0m[35m                    token = self._get_aux_token(token=self._options.get("try_token"))[0m
[30;1m397 | [0m[35m                    self._current_token = self._validate_and_refresh_token(token)[0m
[30;1m398 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m629[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m364 | [0m[35m        elif self._current_authentication_method == AuthenticationMethod.vscode_login:[0m
[30;1m365 | [0m[35m            details["tenant"] = self._authority[0m
[30;1m366 | [0m[35m        elif self._current_authentication_method == AuthenticationMethod.managed_service_identity:[0m
[30;1m367 | [0m[35m            details["msi_params"] = self._options.get("try_msi")[0m
[30;1m368 | [0m[35m        elif self._current_authentication_method == AuthenticationMethod.aad_application_certificate[0m
[30;1m369 | [0m[35m            details["thumbprint"] = self._thumbprint[0m
[30;1m370 | [0m[35m            details["certificate"] = '*****' if self._password else 'NOT-SET'[0m

[31m--[ [0m[34mMatch #[0m[33m630[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m356 | [0m[35m            details["username"] = self._get_token_user_id(self._current_token) or self._get_username[0m
[30;1m357 | [0m[35m[0m
[30;1m358 | [0m[35m        if self._current_authentication_method == AuthenticationMethod.azcli_login_subscription:[0m
[30;1m359 | [0m[35m            details["subscription"] = self._options.get("try_azcli_login_subscription")[0m
[30;1m360 | [0m[35m        elif self._current_authentication_method == AuthenticationMethod.azcli_login:[0m
[30;1m361 | [0m[35m            details["tenant"] = self._authority[0m
[30;1m362 | [0m[35m        elif self._current_authentication_method == AuthenticationMethod.azcli_login_by_profile:[0m

[31m--[ [0m[34mMatch #[0m[33m631[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m296 | [0m[35m            self._authentication_method = AuthenticationMethod.aad_code_login[0m
[30;1m297 | [0m[35m            self._username = kcsb.aad_user_id  # optional[0m
[30;1m298 | [0m[35m[0m
[30;1m299 | [0m[35m        self._client_app_type = AuthenticationMethod.client_app_type.get(self._authentication_method[0m
[30;1m300 | [0m[35m[0m
[30;1m301 | [0m[35m        # to provide stickiness, to avoid switching tokens when not required[0m
[30;1m302 | [0m[35m        self._current_token = None[0m

[31m--[ [0m[34mMatch #[0m[33m632[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35m[0m
[30;1m182 | [0m[35m    def __getattr__(self, kcsb_attr_name):[0m
[30;1m183 | [0m[35m        return self.kcsb.get(kcsb_attr_name, None)[0m
[30;1m184 | [0m[35m[0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35m    def __eq__(self, other:any)-> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m633[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m172 | [0m[35m            "application_certificate_thumbprint": ConnStrKeys.CERTIFICATE_THUMBPRINT,[0m
[30;1m173 | [0m[35m        }[0m
[30;1m174 | [0m[35m        [0m
[30;1m175 | [0m[35m        self.kcsb = {k: conn_kv.get(self.translate_map.get(k), None) for k in self.translate_map}[0m
[30;1m176 | [0m[35m        self.kcsb["data_source"] = data_source[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35m        self._json_dumps = json.dumps(self.kcsb, sort_keys=True)[0m

[31m--[ [0m[34mMatch #[0m[33m634[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m172 | [0m[35m            "application_certificate_thumbprint": ConnStrKeys.CERTIFICATE_THUMBPRINT,[0m
[30;1m173 | [0m[35m        }[0m
[30;1m174 | [0m[35m        [0m
[30;1m175 | [0m[35m        self.kcsb = {k: conn_kv.get(self.translate_map.get(k), None) for k in self.translate_map}[0m
[30;1m176 | [0m[35m        self.kcsb["data_source"] = data_source[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35m        self._json_dumps = json.dumps(self.kcsb, sort_keys=True)[0m

[31m--[ [0m[34mMatch #[0m[33m635[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m141 | [0m[35m        exception = exception.exception if isinstance(exception, AuthenticationError) else exception[0m
[30;1m142 | [0m[35m        self.authentication_method = kwargs.get("authentication_method")[0m
[30;1m143 | [0m[35m        self.authority = kwargs.get("authority")[0m
[30;1m144 | [0m[35m        self.resource = kwargs.get("resource")[0m
[30;1m145 | [0m[35m        self.exception = exception[0m
[30;1m146 | [0m[35m        self.kwargs = kwargs[0m
[30;1m147 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m636[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m140 | [0m[35m        super(AuthenticationError, self).__init__()[0m
[30;1m141 | [0m[35m        exception = exception.exception if isinstance(exception, AuthenticationError) else exception[0m
[30;1m142 | [0m[35m        self.authentication_method = kwargs.get("authentication_method")[0m
[30;1m143 | [0m[35m        self.authority = kwargs.get("authority")[0m
[30;1m144 | [0m[35m        self.resource = kwargs.get("resource")[0m
[30;1m145 | [0m[35m        self.exception = exception[0m
[30;1m146 | [0m[35m        self.kwargs = kwargs[0m

[31m--[ [0m[34mMatch #[0m[33m637[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m139 | [0m[35m    def __init__(self, exception, acquire_token_result=None, **kwargs):[0m
[30;1m140 | [0m[35m        super(AuthenticationError, self).__init__()[0m
[30;1m141 | [0m[35m        exception = exception.exception if isinstance(exception, AuthenticationError) else exception[0m
[30;1m142 | [0m[35m        self.authentication_method = kwargs.get("authentication_method")[0m
[30;1m143 | [0m[35m        self.authority = kwargs.get("authority")[0m
[30;1m144 | [0m[35m        self.resource = kwargs.get("resource")[0m
[30;1m145 | [0m[35m        self.exception = exception[0m

[31m--[ [0m[34mMatch #[0m[33m638[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m.hostname[0m
[30;1m321 | [0m[35m        self._displayed_warnings = [][0m
[30;1m322 | [0m[35m[0m
[30;1m323 | [0m[35m        url = urlparse(kcsb.data_source)[0m
[30;1m324 | [0m[35m        self._resource = f"{url.scheme}://{url.hostname}"[0m
[30;1m325 | [0m[35m[0m
[30;1m326 | [0m[35m        self._scopes = [f"{self._resource}/.default"][0m
[30;1m327 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m639[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1295 | [0m[35m            elif padding_size == 1:[0m
[30;1m1296 | [0m[35m                url_str += '='[0m
[30;1m1297 | [0m[35m            else:[0m
[30;1m1298 | [0m[35m                raise ValueError(f"Invalid base64 url string: {url_str}")[0m
[30;1m1299 | [0m[35m        return urlsafe_b64decode(url_str.encode('utf-8')).decode('utf-8')[0m

[31m--[ [0m[34mMatch #[0m[33m640[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m992 | [0m[35m[0m
[30;1m993 | [0m[35m[0m
[30;1m994 | [0m[35m    def _get_msi_token(self, msi_params=None)->str:[0m
[30;1m995 | [0m[35m        "retrieve token from managed service identity"[0m
[30;1m996 | [0m[35m        msi_params = msi_params or {}[0m
[30;1m997 | [0m[35m        token = None[0m
[30;1m998 | [0m[35m        self._current_authentication_method = AuthenticationMethod.managed_service_identity[0m

[31m--[ [0m[34mMatch #[0m[33m641[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m636 | [0m[35mPress Enter after signing in from another device to proceed, CTRL+C to abort.")[0m
[30;1m637 | [0m[35m                        acquire_token_result = self._current_msal_client_app.acquire_token_by_device[0m
[30;1m638 | [0m[35m                        # You can follow this instruction to shorten the block time[0m
[30;1m639 | [0m[35m                        #    https://msal-python.readthedocs.io/en/latest/#msal.PublicClientApplicat[0m
[30;1m640 | [0m[35m                        # or you may even turn off the blocking behavior,[0m

[31m--[ [0m[34mMatch #[0m[33m642[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m108 | [0m[35mclass OAuth2TokenFields(object):[0m
[30;1m109 | [0m[35m    # taken from here: https://docs.microsoft.com/en-us/azure/app-service/overview-managed-identity?[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m    # The requested access token. The calling web service can use this token to authenticate to the [0m
[30;1m112 | [0m[35m    ACCESS_TOKEN = 'access_token'[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m    # The client ID of the identity that was used.[0m

[31m--[ [0m[34mMatch #[0m[33m643[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m15 | [0m[35mfrom urllib.parse import urlparse[0m
[30;1m16 | [0m[35m# import webbrowser[0m
[30;1m17 | [0m[35mimport json[0m
[30;1m18 | [0m[35mfrom base64 import urlsafe_b64decode[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35mimport dateutil.parser[0m

[31m--[ [0m[34mMatch #[0m[33m644[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper_msal.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35mimport os[0m
[30;1m11 | [0m[35mimport sys[0m
[30;1m12 | [0m[35mfrom io import StringIO[0m
[30;1m13 | [0m[35mimport time[0m
[30;1m14 | [0m[35mfrom datetime import timedelta, datetime[0m
[30;1m15 | [0m[35mfrom urllib.parse import urlparse[0m
[30;1m16 | [0m[35m# import webbrowser[0m

[31m--[ [0m[34mMatch #[0m[33m645[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_files_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m593 | [0m[35m            port = params.get("port", DEFAULT_PORT)[0m
[30;1m594 | [0m[35m            host = params.get("host", DEFAULT_HOST)[0m
[30;1m595 | [0m[35m            parent_id = params.get("parent_id", None) [0m
[30;1m596 | [0m[35m            liveness_mode = params.get("liveness_mode")[0m
[30;1m597 | [0m[35m            parent_monitor = init_parent_monitor(sys.platform, parent_id, liveness_mode)[0m
[30;1m598 | [0m[35m            if parent_monitor is not None:[0m
[30;1m599 | [0m[35m                logger.info(f"start parent_monitor for parent id: {parent_id}")[0m

[31m--[ [0m[34mMatch #[0m[33m646[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_files_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m592 | [0m[35m            folder_list = [folder[:-1] if folder.endswith('/') else folder for folder in folders_str[0m
[30;1m593 | [0m[35m            port = params.get("port", DEFAULT_PORT)[0m
[30;1m594 | [0m[35m            host = params.get("host", DEFAULT_HOST)[0m
[30;1m595 | [0m[35m            parent_id = params.get("parent_id", None) [0m
[30;1m596 | [0m[35m            liveness_mode = params.get("liveness_mode")[0m
[30;1m597 | [0m[35m            parent_monitor = init_parent_monitor(sys.platform, parent_id, liveness_mode)[0m
[30;1m598 | [0m[35m            if parent_monitor is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m647[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_files_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m591 | [0m[35m            folders_str = params.get("folders", "")[0m
[30;1m592 | [0m[35m            folder_list = [folder[:-1] if folder.endswith('/') else folder for folder in folders_str[0m
[30;1m593 | [0m[35m            port = params.get("port", DEFAULT_PORT)[0m
[30;1m594 | [0m[35m            host = params.get("host", DEFAULT_HOST)[0m
[30;1m595 | [0m[35m            parent_id = params.get("parent_id", None) [0m
[30;1m596 | [0m[35m            liveness_mode = params.get("liveness_mode")[0m
[30;1m597 | [0m[35m            parent_monitor = init_parent_monitor(sys.platform, parent_id, liveness_mode)[0m

[31m--[ [0m[34mMatch #[0m[33m648[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_files_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m590 | [0m[35m            base_folder = base_folder[:-1] if base_folder.endswith("/") else base_folder[0m
[30;1m591 | [0m[35m            folders_str = params.get("folders", "")[0m
[30;1m592 | [0m[35m            folder_list = [folder[:-1] if folder.endswith('/') else folder for folder in folders_str[0m
[30;1m593 | [0m[35m            port = params.get("port", DEFAULT_PORT)[0m
[30;1m594 | [0m[35m            host = params.get("host", DEFAULT_HOST)[0m
[30;1m595 | [0m[35m            parent_id = params.get("parent_id", None) [0m
[30;1m596 | [0m[35m            liveness_mode = params.get("liveness_mode")[0m

[31m--[ [0m[34mMatch #[0m[33m649[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_files_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m588 | [0m[35m        base_folder = params.get("base_folder")       [0m
[30;1m589 | [0m[35m        if base_folder is not None:[0m
[30;1m590 | [0m[35m            base_folder = base_folder[:-1] if base_folder.endswith("/") else base_folder[0m
[30;1m591 | [0m[35m            folders_str = params.get("folders", "")[0m
[30;1m592 | [0m[35m            folder_list = [folder[:-1] if folder.endswith('/') else folder for folder in folders_str[0m
[30;1m593 | [0m[35m            port = params.get("port", DEFAULT_PORT)[0m
[30;1m594 | [0m[35m            host = params.get("host", DEFAULT_HOST)[0m

[31m--[ [0m[34mMatch #[0m[33m650[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_files_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m585 | [0m[35m        logger = init_logger(parent_kernel_id)[0m
[30;1m586 | [0m[35m        logger.debug(f"__name__ argv: {sys.argv[1:]}")[0m
[30;1m587 | [0m[35m        logger.debug(f"__name__ params: {params}")[0m
[30;1m588 | [0m[35m        base_folder = params.get("base_folder")       [0m
[30;1m589 | [0m[35m        if base_folder is not None:[0m
[30;1m590 | [0m[35m            base_folder = base_folder[:-1] if base_folder.endswith("/") else base_folder[0m
[30;1m591 | [0m[35m            folders_str = params.get("folders", "")[0m

[31m--[ [0m[34mMatch #[0m[33m651[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_files_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m581 | [0m[35m                params[key] = arg[0m
[30;1m582 | [0m[35m                key = None[0m
[30;1m583 | [0m[35m[0m
[30;1m584 | [0m[35m        parent_kernel_id = params.get("parent_kernel_id")  [0m
[30;1m585 | [0m[35m        logger = init_logger(parent_kernel_id)[0m
[30;1m586 | [0m[35m        logger.debug(f"__name__ argv: {sys.argv[1:]}")[0m
[30;1m587 | [0m[35m        logger.debug(f"__name__ params: {params}")[0m

[31m--[ [0m[34mMatch #[0m[33m652[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_files_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m538 | [0m[35m        os_exit_started = True[0m
[30;1m539 | [0m[35m        try:[0m
[30;1m540 | [0m[35m            logger.info(f"OS_EXIT code: {code}!!!")[0m
[30;1m541 | [0m[35m            to_clean = params.get("clean", None)[0m
[30;1m542 | [0m[35m            if to_clean is not None and len(folder_list) > 0:[0m
[30;1m543 | [0m[35m                for folder in folder_list:[0m
[30;1m544 | [0m[35m                    folder_path = None[0m

[31m--[ [0m[34mMatch #[0m[33m653[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_files_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m450 | [0m[35mdef abort()->str:[0m
[30;1m451 | [0m[35m    """aborts the process"""[0m
[30;1m452 | [0m[35m    try:[0m
[30;1m453 | [0m[35m        _kernel_id = request.args.get("kernelid")[0m
[30;1m454 | [0m[35m        logger.debug(f"/abort")[0m
[30;1m455 | [0m[35m[0m
[30;1m456 | [0m[35m        os_exit(0)[0m

[31m--[ [0m[34mMatch #[0m[33m654[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_files_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m423 | [0m[35m    """open web browser."""[0m
[30;1m424 | [0m[35m    try:[0m
[30;1m425 | [0m[35m        _encoded_url = request.args.get("url")[0m
[30;1m426 | [0m[35m        _kernel_id = request.args.get("kernelid")[0m
[30;1m427 | [0m[35m[0m
[30;1m428 | [0m[35m        import urllib.parse[0m
[30;1m429 | [0m[35m        import webbrowser[0m

[31m--[ [0m[34mMatch #[0m[33m655[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_files_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m422 | [0m[35mdef webbrowser()->str:[0m
[30;1m423 | [0m[35m    """open web browser."""[0m
[30;1m424 | [0m[35m    try:[0m
[30;1m425 | [0m[35m        _encoded_url = request.args.get("url")[0m
[30;1m426 | [0m[35m        _kernel_id = request.args.get("kernelid")[0m
[30;1m427 | [0m[35m[0m
[30;1m428 | [0m[35m        import urllib.parse[0m

[31m--[ [0m[34mMatch #[0m[33m656[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_files_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m403 | [0m[35mdef heartbeat()->Union[str,Response]:[0m
[30;1m404 | [0m[35m    """print 'heartbeat' as the response body."""[0m
[30;1m405 | [0m[35m    try:[0m
[30;1m406 | [0m[35m        _kernel_id = request.args.get("kernelid")[0m
[30;1m407 | [0m[35m[0m
[30;1m408 | [0m[35m        if parent_monitor.__class__.__name__ == ParentHeartbeatMonitor:[0m
[30;1m409 | [0m[35m            parent_monitor.heartbeat()[0m

[31m--[ [0m[34mMatch #[0m[33m657[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_files_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m387 | [0m[35mdef ping()->Union[str,Response]:[0m
[30;1m388 | [0m[35m    """print 'pong' as the response body."""[0m
[30;1m389 | [0m[35m    try:[0m
[30;1m390 | [0m[35m        _kernel_id = request.args.get("kernelid")[0m
[30;1m391 | [0m[35m[0m
[30;1m392 | [0m[35m        pong = f"pong kernelid: {_kernel_id}"[0m
[30;1m393 | [0m[35m        logger.debug(f"/ping - {pong}")[0m

[31m--[ [0m[34mMatch #[0m[33m658[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_files_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m360 | [0m[35m    """return content of filename as the response body."""[0m
[30;1m361 | [0m[35m    try:[0m
[30;1m362 | [0m[35m        _kernel_id = request.args.get("kernelid")[0m
[30;1m363 | [0m[35m        _filename = request.args.get("filename")[0m
[30;1m364 | [0m[35m[0m
[30;1m365 | [0m[35m        if len(folder_list) == 0 or f"{foldername}/{_kernel_id}" in folder_list:[0m
[30;1m366 | [0m[35m            err_resp = check_path(foldername, _kernel_id, _filename)[0m

[31m--[ [0m[34mMatch #[0m[33m659[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_files_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m359 | [0m[35mdef folders(foldername:str)->Response:[0m
[30;1m360 | [0m[35m    """return content of filename as the response body."""[0m
[30;1m361 | [0m[35m    try:[0m
[30;1m362 | [0m[35m        _kernel_id = request.args.get("kernelid")[0m
[30;1m363 | [0m[35m        _filename = request.args.get("filename")[0m
[30;1m364 | [0m[35m[0m
[30;1m365 | [0m[35m        if len(folder_list) == 0 or f"{foldername}/{_kernel_id}" in folder_list:[0m

[31m--[ [0m[34mMatch #[0m[33m660[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_files_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m333 | [0m[35mdef _files(foldername:str, kernel_id:str, filename:str)->Response:[0m
[30;1m334 | [0m[35m    """return content of filename as the response body."""[0m
[30;1m335 | [0m[35m    try:[0m
[30;1m336 | [0m[35m        _kernel_id = request.args.get("kernelid")[0m
[30;1m337 | [0m[35m[0m
[30;1m338 | [0m[35m        if len(folder_list) == 0 or f"{foldername}/{kernel_id}" in folder_list:[0m
[30;1m339 | [0m[35m            err_resp = check_path(foldername, kernel_id, filename)[0m

[31m--[ [0m[34mMatch #[0m[33m661[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_files_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35mimport sys[0m
[30;1m9 | [0m[35mimport os[0m
[30;1m10 | [0m[35mfrom datetime import datetime[0m
[30;1m11 | [0m[35mimport time[0m
[30;1m12 | [0m[35mfrom threading import Thread, Event[0m
[30;1m13 | [0m[35mfrom _thread import interrupt_main[0m
[30;1m14 | [0m[35mimport logging[0m

[31m--[ [0m[34mMatch #[0m[33m662[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/allow_single_line_cell.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m    @staticmethod[0m
[30;1m74 | [0m[35m    def observe_is_magic(change:Dict[str,str]):[0m
[30;1m75 | [0m[35m        if change.get('type') == 'change' and change.get('name') == 'is_magic':[0m
[30;1m76 | [0m[35m            allow_single_line_cell = change.get('new') and AllowSingleLineCell.config.allow_single_l[0m
[30;1m77 | [0m[35m            AllowSingleLineCell.config.set_trait('allow_single_line_cell', allow_single_line_cell, f[0m
[30;1m78 | [0m[35m            AllowSingleLineCell.allow_single_line_cell(allow_single_line_cell)[0m

[31m--[ [0m[34mMatch #[0m[33m663[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/allow_single_line_cell.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m    @staticmethod[0m
[30;1m74 | [0m[35m    def observe_is_magic(change:Dict[str,str]):[0m
[30;1m75 | [0m[35m        if change.get('type') == 'change' and change.get('name') == 'is_magic':[0m
[30;1m76 | [0m[35m            allow_single_line_cell = change.get('new') and AllowSingleLineCell.config.allow_single_l[0m
[30;1m77 | [0m[35m            AllowSingleLineCell.config.set_trait('allow_single_line_cell', allow_single_line_cell, f[0m
[30;1m78 | [0m[35m            AllowSingleLineCell.allow_single_line_cell(allow_single_line_cell)[0m

[31m--[ [0m[34mMatch #[0m[33m664[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/allow_single_line_cell.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m    @staticmethod[0m
[30;1m74 | [0m[35m    def observe_is_magic(change:Dict[str,str]):[0m
[30;1m75 | [0m[35m        if change.get('type') == 'change' and change.get('name') == 'is_magic':[0m
[30;1m76 | [0m[35m            allow_single_line_cell = change.get('new') and AllowSingleLineCell.config.allow_single_l[0m
[30;1m77 | [0m[35m            AllowSingleLineCell.config.set_trait('allow_single_line_cell', allow_single_line_cell, f[0m
[30;1m78 | [0m[35m            AllowSingleLineCell.allow_single_line_cell(allow_single_line_cell)[0m

[31m--[ [0m[34mMatch #[0m[33m665[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/allow_single_line_cell.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m                if change.get('new') is True:[0m
[30;1m68 | [0m[35m                    AllowSingleLineCell.config.set_trait('allow_single_line_cell', False, force=True[0m
[30;1m69 | [0m[35m            else:[0m
[30;1m70 | [0m[35m                AllowSingleLineCell.allow_single_line_cell(change.get('new'))[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m    @staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m666[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/allow_single_line_cell.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m    def observe_allow_single_line_cell(change:Dict[str,str]):[0m
[30;1m65 | [0m[35m        if change.get('type') == 'change' and change.get('name') == 'allow_single_line_cell':[0m
[30;1m66 | [0m[35m            if AllowSingleLineCell.config.is_magic is False:[0m
[30;1m67 | [0m[35m                if change.get('new') is True:[0m
[30;1m68 | [0m[35m                    AllowSingleLineCell.config.set_trait('allow_single_line_cell', False, force=True[0m
[30;1m69 | [0m[35m            else:[0m
[30;1m70 | [0m[35m                AllowSingleLineCell.allow_single_line_cell(change.get('new'))[0m

[31m--[ [0m[34mMatch #[0m[33m667[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/allow_single_line_cell.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m    @staticmethod[0m
[30;1m64 | [0m[35m    def observe_allow_single_line_cell(change:Dict[str,str]):[0m
[30;1m65 | [0m[35m        if change.get('type') == 'change' and change.get('name') == 'allow_single_line_cell':[0m
[30;1m66 | [0m[35m            if AllowSingleLineCell.config.is_magic is False:[0m
[30;1m67 | [0m[35m                if change.get('new') is True:[0m
[30;1m68 | [0m[35m                    AllowSingleLineCell.config.set_trait('allow_single_line_cell', False, force=True[0m

[31m--[ [0m[34mMatch #[0m[33m668[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/allow_single_line_cell.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m    @staticmethod[0m
[30;1m64 | [0m[35m    def observe_allow_single_line_cell(change:Dict[str,str]):[0m
[30;1m65 | [0m[35m        if change.get('type') == 'change' and change.get('name') == 'allow_single_line_cell':[0m
[30;1m66 | [0m[35m            if AllowSingleLineCell.config.is_magic is False:[0m
[30;1m67 | [0m[35m                if change.get('new') is True:[0m
[30;1m68 | [0m[35m                    AllowSingleLineCell.config.set_trait('allow_single_line_cell', False, force=True[0m

[31m--[ [0m[34mMatch #[0m[33m669[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/README.rst[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m.. code-block:: python[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    Connect to database at cluster[0m
[30;1m33 | [0m[35m    In [3]: %kql kusto://code;cluster='help';database='Samples'[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m.. code-block:: python[0m

[31m--[ [0m[34mMatch #[0m[33m670[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/README.rst[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m.. code-block:: python[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    Query database@cluster and render result set to a pie chart[0m
[30;1m38 | [0m[35m    In [4]: %kql Samples@help StormEvents | summarize count() by State | sort by count_ | limit 10 |[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m671[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/_debug_utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m# --------------------------------------------------------------------------[0m
[30;1m10 | [0m[35m# because it is also executed from setup.py, make sure[0m
[30;1m11 | [0m[35m# that it imports only modules, that for sure will exist at setup.py execution[0m
[30;1m12 | [0m[35m# TRY TO KEEP IMPORTS TO MINIMUM[0m
[30;1m13 | [0m[35m# --------------------------------------------------------------------------[0m
[30;1m14 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m672[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/dependencies.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m298 | [0m[35mge, category, filename, lineno, line=line)[0m
[30;1m299 | [0m[35m[0m
[30;1m300 | [0m[35m[0m
[30;1m301 | [0m[35m    @classmethod[0m
[30;1m302 | [0m[35m    def warn_missing_env_variables(cls, options:Dict[str,Any]=None)->None:[0m
[30;1m303 | [0m[35m        options = options or {}[0m
[30;1m304 | [0m[35m        if options.get("notebook_app") in ["azureml", "azuremljupyternotebook", "azuremljupyterlab"][0m
[30;1m305 | [0m[35m            if options.get("notebook_service_address") is None:[0m
[30;1m306 | [0m[35m                var_name = f"{Constants.MAGIC_CLASS_NAME_UPPER}_AZUREML_COMPUTE"[0m

[31m--[ [0m[34mMatch #[0m[33m673[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/dependencies.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m301 | [0m[35m    @classmethod[0m
[30;1m302 | [0m[35m    def warn_missing_env_variables(cls, options:Dict[str,Any]=None)->None:[0m
[30;1m303 | [0m[35m        options = options or {}[0m
[30;1m304 | [0m[35m        if options.get("notebook_app") in ["azureml", "azuremljupyternotebook", "azuremljupyterlab"][0m
[30;1m305 | [0m[35m            if options.get("notebook_service_address") is None:[0m
[30;1m306 | [0m[35m                var_name = f"{Constants.MAGIC_CLASS_NAME_UPPER}_AZUREML_COMPUTE"[0m
[30;1m307 | [0m[35m                message = f"{cls.MISSING_ENV_TAG}Popup windows might not work properly (copy/paste c[0m

[31m--[ [0m[34mMatch #[0m[33m674[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/dependencies.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m275 | [0m[35m[0m
[30;1m276 | [0m[35m    @classmethod[0m
[30;1m277 | [0m[35m    def _import_warn(cls, install_package_names:List[str], module_name:str, package:str, tag:str, me[0m
[30;1m278 | [0m[35m        if not cls.installed_modules.get(module_name) and package in install_package_names:[0m
[30;1m279 | [0m[35m            import_error_message = cls._import_error_message(module_name, package, tag, message, ver[0m
[30;1m280 | [0m[35m            warnings.warn_explicit(f"{tag}{import_error_message}", ImportWarning, '', 0)[0m
[30;1m281 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m675[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/dependencies.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m244 | [0m[35m                module_name = item[0][0m
[30;1m245 | [0m[35m                if cls.is_installed(module_name):[0m
[30;1m246 | [0m[35m                    package_name = item[1][0m
[30;1m247 | [0m[35m                    tail = f"installed version '{cls.installed_versions.get(package_name)}'"[0m
[30;1m248 | [0m[35m                else:[0m
[30;1m249 | [0m[35m                    tail = "NOT installed"[0m
[30;1m250 | [0m[35m                logger().debug(f"dependency -- '{item}' -- {tail}")[0m

[31m--[ [0m[34mMatch #[0m[33m676[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/dependencies.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m229 | [0m[35m                message = f"{debug_disabled_package_message}{message}"[0m
[30;1m230 | [0m[35m            if dont_throw:[0m
[30;1m231 | [0m[35m                return None[0m
[30;1m232 | [0m[35m            item = cls.dependencies_dict.get(module_name)[0m
[30;1m233 | [0m[35m            message = f", {message}" if message else ""[0m
[30;1m234 | [0m[35m            import_error_message = cls._import_error_message(*item) if item else f"due to '{module_n[0m
[30;1m235 | [0m[35m            import_error_message = f"{import_error_message}{message}"[0m

[31m--[ [0m[34mMatch #[0m[33m677[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/dependencies.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m207 | [0m[35m                            version_module = module[0m
[30;1m208 | [0m[35m                        else:[0m
[30;1m209 | [0m[35m                            # version_location should refer to a module [0m
[30;1m210 | [0m[35m                            version_module = cls.installed_modules.get(version_location)[0m
[30;1m211 | [0m[35m                            if version_module is None:[0m
[30;1m212 | [0m[35m                                version_module = importlib.import_module(version_location)[0m
[30;1m213 | [0m[35m                                cls.installed_modules[version_location] = version_module[0m

[31m--[ [0m[34mMatch #[0m[33m678[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/dependencies.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m199 | [0m[35m            import importlib[0m
[30;1m200 | [0m[35m            module = importlib.import_module(module_name)[0m
[30;1m201 | [0m[35m            cls.installed_modules[module_name] = module[0m
[30;1m202 | [0m[35m            if package_name is not None and cls.installed_versions.get(package_name) is None:[0m
[30;1m203 | [0m[35m                version = None[0m
[30;1m204 | [0m[35m                if version_location is not None:[0m
[30;1m205 | [0m[35m                    try:[0m

[31m--[ [0m[34mMatch #[0m[33m679[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/dependencies.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m182 | [0m[35m    @classmethod[0m
[30;1m183 | [0m[35m    def get_module(cls, module_name:str, package_name:str=None, version_location:str=None, dont_thro[0m
[30;1m184 | [0m[35m        try:[0m
[30;1m185 | [0m[35m            module = cls.installed_modules.get(module_name)[0m
[30;1m186 | [0m[35m            if module:[0m
[30;1m187 | [0m[35m                return module[0m
[30;1m188 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m680[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/dependencies.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m175 | [0m[35m[0m
[30;1m176 | [0m[35m    @classmethod[0m
[30;1m177 | [0m[35m    def installed_packages(cls)->Dict[str,str]:[0m
[30;1m178 | [0m[35m        return {package: cls.installed_versions.get(package) for package in cls.installed_versions}[0m
[30;1m179 | [0m[35m[0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m681[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/dependencies.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m152 | [0m[35m        else:[0m
[30;1m153 | [0m[35m            python_branch = platform.python_branch()[0m
[30;1m154 | [0m[35m            name = 'saw' if python_branch.endswith(Constants.SAW_PYTHON_BRANCH_SUFFIX) else 'default[0m
[30;1m155 | [0m[35m            cls.extras_require_packages = EXTRAS_REQUIRE.get(name, [])[0m
[30;1m156 | [0m[35m        cls.extras_require_package_names = list(map(strip_package_name, cls.extras_require_packages)[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m        cls.install_requires_packages = INSTALL_REQUIRES[0m

[31m--[ [0m[34mMatch #[0m[33m682[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/dependencies.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m148 | [0m[35m                            [name.strip() for name in (get_env_var_list(f"{Constants.MAGIC_CLASS_NAM[0m
[30;1m149 | [0m[35m[0m
[30;1m150 | [0m[35m        if cls.extras_names:[0m
[30;1m151 | [0m[35m            cls.extras_require_packages = list_union(*[EXTRAS_REQUIRE.get(name, []) for name in cls.[0m
[30;1m152 | [0m[35m        else:[0m
[30;1m153 | [0m[35m            python_branch = platform.python_branch()[0m
[30;1m154 | [0m[35m            name = 'saw' if python_branch.endswith(Constants.SAW_PYTHON_BRANCH_SUFFIX) else 'default[0m

[31m--[ [0m[34mMatch #[0m[33m683[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/dependencies.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m    @classmethod[0m
[30;1m137 | [0m[35m    def extend_dependencies(cls)->None:[0m
[30;1m138 | [0m[35m        key = platform.system()[0m
[30;1m139 | [0m[35m        cls.dependencies.extend(cls.platform_dependencies.get(key, ()))[0m
[30;1m140 | [0m[35m[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m    @classmethod[0m

[31m--[ [0m[34mMatch #[0m[33m684[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/dependencies.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m292 | [0m[35m            return f"MissingEnvironmentVariable: {filename} is not set. {message}\n"[0m
[30;1m293 | [0m[35m        elif category.__name__ == 'UserWarning' and re.match(cls.BAD_ENV_REGEX, f'{message}'):[0m
[30;1m294 | [0m[35m            message = f'{message}'[3:][0m
[30;1m295 | [0m[35m            # assumes env variable is passed as filename[0m
[30;1m296 | [0m[35m            return f"BadEnvironmentVariable: {filename} value is invalid. {message}\n"[0m
[30;1m297 | [0m[35m        else:[0m
[30;1m298 | [0m[35m            return saved_formatwarning(message, category, filename, lineno, line=line)[0m

[31m--[ [0m[34mMatch #[0m[33m685[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/dependencies.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m288 | [0m[35m            return f"{category.__name__}: {message}\n"[0m
[30;1m289 | [0m[35m        elif category.__name__ == 'UserWarning' and re.match(cls.MISSING_ENV_REGEX, f'{message}'):[0m
[30;1m290 | [0m[35m            message = f'{message}'[3:][0m
[30;1m291 | [0m[35m            # assumes env variable is passed as filename[0m
[30;1m292 | [0m[35m            return f"MissingEnvironmentVariable: {filename} is not set. {message}\n"[0m
[30;1m293 | [0m[35m        elif category.__name__ == 'UserWarning' and re.match(cls.BAD_ENV_REGEX, f'{message}'):[0m
[30;1m294 | [0m[35m            message = f'{message}'[3:][0m

[31m--[ [0m[34mMatch #[0m[33m686[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/dependencies.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m246 | [0m[35m                    package_name = item[1][0m
[30;1m247 | [0m[35m                    tail = f"installed version '{cls.installed_versions.get(package_name)}'"[0m
[30;1m248 | [0m[35m                else:[0m
[30;1m249 | [0m[35m                    tail = "NOT installed"[0m
[30;1m250 | [0m[35m                logger().debug(f"dependency -- '{item}' -- {tail}")[0m
[30;1m251 | [0m[35m[0m
[30;1m252 | [0m[35m        warnings.filterwarnings(cls.RAISE_WARNINGS, message=cls.MANDATORY_MODULES_REGEX, category=Im[0m

[31m--[ [0m[34mMatch #[0m[33m687[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/dependencies.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m244 | [0m[35m                module_name = item[0][0m
[30;1m245 | [0m[35m                if cls.is_installed(module_name):[0m
[30;1m246 | [0m[35m                    package_name = item[1][0m
[30;1m247 | [0m[35m                    tail = f"installed version '{cls.installed_versions.get(package_name)}'"[0m
[30;1m248 | [0m[35m                else:[0m
[30;1m249 | [0m[35m                    tail = "NOT installed"[0m
[30;1m250 | [0m[35m                logger().debug(f"dependency -- '{item}' -- {tail}")[0m

[31m--[ [0m[34mMatch #[0m[33m688[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/_test.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m# --------------------------------------------------------------------------[0m
[30;1m10 | [0m[35m# because it is also executed from setup.py, make sure[0m
[30;1m11 | [0m[35m# that it imports only modules, that for sure will exist at setup.py execution[0m
[30;1m12 | [0m[35m# TRY TO KEEP IMPORTS TO MINIMUM[0m
[30;1m13 | [0m[35m# --------------------------------------------------------------------------[0m
[30;1m14 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m689[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/KqlmagicCustom.egg-info/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m.. code-block:: python[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m    Connect to database at cluster[0m
[30;1m106 | [0m[35m    In [3]: %kql kusto://code;cluster='help';database='Samples'[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35m.. code-block:: python[0m

[31m--[ [0m[34mMatch #[0m[33m690[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/KqlmagicCustom.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m108 | [0m[35m.. code-block:: python[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m    Query database@cluster and render result set to a pie chart[0m
[30;1m111 | [0m[35m    In [4]: %kql Samples@help StormEvents | summarize count() by State | sort by count_ | limit 10 |[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m691[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/KqlmagicCustom.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14 | [0m[35mClassifier: Development Status :: 5 - Production/Stable[0m
[30;1m15 | [0m[35mClassifier: Intended Audience :: Developers[0m
[30;1m16 | [0m[35mClassifier: Intended Audience :: System Administrators[0m
[30;1m17 | [0m[35mClassifier: Intended Audience :: Customer Service[0m
[30;1m18 | [0m[35mClassifier: Intended Audience :: Information Technology[0m
[30;1m19 | [0m[35mClassifier: Intended Audience :: Science/Research[0m
[30;1m20 | [0m[35mClassifier: Environment :: Console[0m

[31m--[ [0m[34mMatch #[0m[33m692[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure_bdist_wheel.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35m                if os.path.isfile(init_file):[0m
[30;1m45 | [0m[35m                    os.remove(init_file)[0m
[30;1m46 | [0m[35m                else:[0m
[30;1m47 | [0m[35m                    raise ValueError("Unable to find {}. Are you sure of your namespace package?".fo[0m
[30;1m48 | [0m[35m        bdist_wheel.write_record(self, bdist_dir, distinfo_dir)[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m693[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m339 | [0m[35m            }[0m
[30;1m340 | [0m[35m        }[0m
[30;1m341 | [0m[35m[0m
[30;1m342 | [0m[35m        response = self._http_client.post(endpoint, headers=request_headers, json=request_payload, t[0m
[30;1m343 | [0m[35m[0m
[30;1m344 | [0m[35m        logger().debug(f"KustoClient::execute - response - status: {response.status_code}, headers: [0m
[30;1m345 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m694[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m339 | [0m[35m            }[0m
[30;1m340 | [0m[35m        }[0m
[30;1m341 | [0m[35m[0m
[30;1m342 | [0m[35m        response = self._http_client.post(endpoint, headers=request_headers, json=request_payload, t[0m
[30;1m343 | [0m[35m[0m
[30;1m344 | [0m[35m        logger().debug(f"KustoClient::execute - response - status: {response.status_code}, headers: [0m
[30;1m345 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m695[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m335 | [0m[35m                "endpoint": endpoint,[0m
[30;1m336 | [0m[35m                "headers": log_request_headers,[0m
[30;1m337 | [0m[35m                "payload": request_payload,[0m
[30;1m338 | [0m[35m                "timeout": options.get("timeout"),[0m
[30;1m339 | [0m[35m            }[0m
[30;1m340 | [0m[35m        }[0m
[30;1m341 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m696[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m327 | [0m[35m            log_request_headers = request_headers.copy()[0m
[30;1m328 | [0m[35m            log_request_headers["Authorization"] = "..."  [0m
[30;1m329 | [0m[35m[0m
[30;1m330 | [0m[35m        logger().debug(f"KustoClient::execute - POST request - url: {endpoint}, headers: {log_reques[0m
[30;1m331 | [0m[35m[0m
[30;1m332 | [0m[35m        # collect this information, in case bug report will be generated[0m
[30;1m333 | [0m[35m        KqlClient.last_query_info = {[0m

[31m--[ [0m[34mMatch #[0m[33m697[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m323 | [0m[35m        # print("timeout: ", options.get("timeout"))[0m
[30;1m324 | [0m[35m[0m
[30;1m325 | [0m[35m        log_request_headers = request_headers[0m
[30;1m326 | [0m[35m        if request_headers.get("Authorization"):[0m
[30;1m327 | [0m[35m            log_request_headers = request_headers.copy()[0m
[30;1m328 | [0m[35m            log_request_headers["Authorization"] = "..."  [0m
[30;1m329 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m698[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m320 | [0m[35m        # print("endpoint: ", endpoint)[0m
[30;1m321 | [0m[35m        # print("headers: ", request_headers)[0m
[30;1m322 | [0m[35m        # print("payload: ", request_payload)[0m
[30;1m323 | [0m[35m        # print("timeout: ", options.get("timeout"))[0m
[30;1m324 | [0m[35m[0m
[30;1m325 | [0m[35m        log_request_headers = request_headers[0m
[30;1m326 | [0m[35m        if request_headers.get("Authorization"):[0m

[31m--[ [0m[34mMatch #[0m[33m699[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m310 | [0m[35m            request_headers["Authorization"] = self._aad_helper.acquire_token()[0m
[30;1m311 | [0m[35m            request_headers["Fed"] = "True"[0m
[30;1m312 | [0m[35m[0m
[30;1m313 | [0m[35m        cache_max_age = options.get("request_cache_max_age")[0m
[30;1m314 | [0m[35m        if cache_max_age is not None:[0m
[30;1m315 | [0m[35m            if cache_max_age > 0:[0m
[30;1m316 | [0m[35m                request_headers["Cache-Control"] = f"max-age={cache_max_age}"[0m

[31m--[ [0m[34mMatch #[0m[33m700[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m303 | [0m[35m            "x-ms-client-request-id": client_request_id,[0m
[30;1m304 | [0m[35m            "x-ms-app": app[0m
[30;1m305 | [0m[35m        }[0m
[30;1m306 | [0m[35m        user_tag = options.get("request_user_tag")[0m
[30;1m307 | [0m[35m        if user_tag is not None:[0m
[30;1m308 | [0m[35m            request_headers["x-ms-user"] = user_tag[0m
[30;1m309 | [0m[35m        if self._aad_helper is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m701[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m283 | [0m[35m[0m
[30;1m284 | [0m[35m        cache_max_age = options.get("request_cache_max_age")[0m
[30;1m285 | [0m[35m        if cache_max_age is not None and cache_max_age > 0:[0m
[30;1m286 | [0m[35m            query_properties["query_results_cache_max_age"] = query_properties.get("query_results_ca[0m
[30;1m287 | [0m[35m                                                              or f"{cache_max_age}s"[0m
[30;1m288 | [0m[35m[0m
[30;1m289 | [0m[35m        if len(query_properties) > 0:[0m

[31m--[ [0m[34mMatch #[0m[33m702[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m281 | [0m[35m                # MS-TDS/T-SQL Differences between Kusto Microsoft SQL Server: https://docs.microsof[0m
[30;1m282 | [0m[35m                query_properties["query_language"] = "sql"[0m
[30;1m283 | [0m[35m[0m
[30;1m284 | [0m[35m        cache_max_age = options.get("request_cache_max_age")[0m
[30;1m285 | [0m[35m        if cache_max_age is not None and cache_max_age > 0:[0m
[30;1m286 | [0m[35m            query_properties["query_results_cache_max_age"] = query_properties.get("query_results_ca[0m
[30;1m287 | [0m[35m                                                              or f"{cache_max_age}s"[0m

[31m--[ [0m[34mMatch #[0m[33m703[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m271 | [0m[35m        if user_agent_tag is not None:[0m
[30;1m272 | [0m[35m            user_agent = user_agent_tag[0m
[30;1m273 | [0m[35m[0m
[30;1m274 | [0m[35m        query_properties:dict = options.get("query_properties")  or {}[0m
[30;1m275 | [0m[35m[0m
[30;1m276 | [0m[35m        if type(kusto_query) == str:[0m
[30;1m277 | [0m[35m            first_word = kusto_query.split(maxsplit=1)[0].upper()[0m

[31m--[ [0m[34mMatch #[0m[33m704[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m267 | [0m[35m            app = f"{app};{app_tag}"[0m
[30;1m268 | [0m[35m            [0m
[30;1m269 | [0m[35m        user_agent = f'{Constants.MAGIC_CLASS_NAME}/{self._WEB_CLIENT_VERSION}'[0m
[30;1m270 | [0m[35m        user_agent_tag = options.get("request_user_agent_tag")[0m
[30;1m271 | [0m[35m        if user_agent_tag is not None:[0m
[30;1m272 | [0m[35m            user_agent = user_agent_tag[0m
[30;1m273 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m705[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m262 | [0m[35m            client_request_id = f"{client_request_id};{str(uuid.uuid4())}/{self._session_guid}/Azure[0m
[30;1m263 | [0m[35m            [0m
[30;1m264 | [0m[35m        app = f'{Constants.MAGIC_CLASS_NAME};{options.get("notebook_app")}'[0m
[30;1m265 | [0m[35m        app_tag = options.get("request_app_tag")[0m
[30;1m266 | [0m[35m        if app_tag is not None:[0m
[30;1m267 | [0m[35m            app = f"{app};{app_tag}"[0m
[30;1m268 | [0m[35m            [0m

[31m--[ [0m[34mMatch #[0m[33m706[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m261 | [0m[35m        else:[0m
[30;1m262 | [0m[35m            client_request_id = f"{client_request_id};{str(uuid.uuid4())}/{self._session_guid}/Azure[0m
[30;1m263 | [0m[35m            [0m
[30;1m264 | [0m[35m        app = f'{Constants.MAGIC_CLASS_NAME};{options.get("notebook_app")}'[0m
[30;1m265 | [0m[35m        app_tag = options.get("request_app_tag")[0m
[30;1m266 | [0m[35m        if app_tag is not None:[0m
[30;1m267 | [0m[35m            app = f"{app};{app_tag}"[0m

[31m--[ [0m[34mMatch #[0m[33m707[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m255 | [0m[35m        client_version = f"{Constants.MAGIC_CLASS_NAME}.Python.Client:{self._WEB_CLIENT_VERSION}"[0m
[30;1m256 | [0m[35m[0m
[30;1m257 | [0m[35m        client_request_id = f"{Constants.MAGIC_CLASS_NAME}.execute"[0m
[30;1m258 | [0m[35m        client_request_id_tag = options.get("request_id_tag")[0m
[30;1m259 | [0m[35m        if client_request_id_tag is not None:[0m
[30;1m260 | [0m[35m            client_request_id = f"{client_request_id};{client_request_id_tag};{str(uuid.uuid4())}/{s[0m
[30;1m261 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m708[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m205 | [0m[35m        match = self._FQN_DRAFT_PROXY_CLUSTER_PATTERN.match(self.data_source) or self._FQN_DRAFT_PRO[0m
[30;1m206 | [0m[35m        if match:[0m
[30;1m207 | [0m[35m            cloud = self._CLOUD_BY_ADXPROXY_HOST_SUFFIX.get(match.group("host_suffix")) or self.defa[0m
[30;1m208 | [0m[35m            cloud_url_suffix = self._ADX_URL_SUFFIX_BY_CLOUD.get(cloud)[0m
[30;1m209 | [0m[35m            return f"https://help.kusto{cloud_url_suffix}"[0m
[30;1m210 | [0m[35m        else:[0m
[30;1m211 | [0m[35m            return self._data_source[0m

[31m--[ [0m[34mMatch #[0m[33m709[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m204 | [0m[35m    def deep_link_data_source(self)->str:[0m
[30;1m205 | [0m[35m        match = self._FQN_DRAFT_PROXY_CLUSTER_PATTERN.match(self.data_source) or self._FQN_DRAFT_PRO[0m
[30;1m206 | [0m[35m        if match:[0m
[30;1m207 | [0m[35m            cloud = self._CLOUD_BY_ADXPROXY_HOST_SUFFIX.get(match.group("host_suffix")) or self.defa[0m
[30;1m208 | [0m[35m            cloud_url_suffix = self._ADX_URL_SUFFIX_BY_CLOUD.get(cloud)[0m
[30;1m209 | [0m[35m            return f"https://help.kusto{cloud_url_suffix}"[0m
[30;1m210 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m710[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m177 | [0m[35m                return aad_helper[0m
[30;1m178 | [0m[35m        [0m
[30;1m179 | [0m[35m        new_context = AadContext(conn_kv, new_auth_resource, client_id, options)[0m
[30;1m180 | [0m[35m        http_client = self._http_client if options.get("auth_use_http_client") else None[0m
[30;1m181 | [0m[35m        new_aad_helper = _MyAadHelper(new_context.kcsb, client_id, http_client=http_client, **option[0m
[30;1m182 | [0m[35m        self._aad_helpers[new_context] = new_aad_helper[0m
[30;1m183 | [0m[35m        return new_aad_helper[0m

[31m--[ [0m[34mMatch #[0m[33m711[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m164 | [0m[35m        [0m
[30;1m165 | [0m[35m        cloud = self.getCloudFromHost(auth_resource)[0m
[30;1m166 | [0m[35m        client_id = self._ADX_CLIENT_BY_CLOUD[cloud][0m
[30;1m167 | [0m[35m        self._aad_helper = self._get_aad_helper(conn_kv, auth_resource, client_id, **options) if con[0m
[30;1m168 | [0m[35m        self._data_source = data_source[0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m712[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m157 | [0m[35m        match = self._FQN_DRAFT_PROXY_CLUSTER_PATTERN.match(data_source) or self._FQN_DRAFT_PROXY_CL[0m
[30;1m158 | [0m[35m        if match:[0m
[30;1m159 | [0m[35m            cloud = self._CLOUD_BY_ADXPROXY_HOST_SUFFIX.get(match.group("host_suffix")) or self.defa[0m
[30;1m160 | [0m[35m            cloud_url_suffix = self._ADX_URL_SUFFIX_BY_CLOUD.get(cloud)[0m
[30;1m161 | [0m[35m            auth_resource = f"https://kusto.kusto{cloud_url_suffix}"[0m
[30;1m162 | [0m[35m        else:[0m
[30;1m163 | [0m[35m            auth_resource = data_source[0m

[31m--[ [0m[34mMatch #[0m[33m713[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m        match = self._FQN_DRAFT_PROXY_CLUSTER_PATTERN.match(data_source) or self._FQN_DRAFT_PROXY_CL[0m
[30;1m158 | [0m[35m        if match:[0m
[30;1m159 | [0m[35m            cloud = self._CLOUD_BY_ADXPROXY_HOST_SUFFIX.get(match.group("host_suffix")) or self.defa[0m
[30;1m160 | [0m[35m            cloud_url_suffix = self._ADX_URL_SUFFIX_BY_CLOUD.get(cloud)[0m
[30;1m161 | [0m[35m            auth_resource = f"https://kusto.kusto{cloud_url_suffix}"[0m
[30;1m162 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m714[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m143 | [0m[35m        elif cluster_name.find(".kustomfa.") > 0:[0m
[30;1m144 | [0m[35m            data_source = f"https://{cluster_name}"[0m
[30;1m145 | [0m[35m        else:[0m
[30;1m146 | [0m[35m            adx_url_suffix = self._ADX_URL_SUFFIX_BY_CLOUD.get(self.default_cloud)[0m
[30;1m147 | [0m[35m            if not adx_url_suffix:[0m
[30;1m148 | [0m[35m                raise KqlEngineError(f"adx not supported in cloud {self.default_cloud}")[0m
[30;1m149 | [0m[35m            if cluster_name.endswith(adx_url_suffix):[0m

[31m--[ [0m[34mMatch #[0m[33m715[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m131 | [0m[35m        """[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m        super(KustoClient, self).__init__()[0m
[30;1m134 | [0m[35m        self.default_cloud = options.get("cloud")[0m
[30;1m135 | [0m[35m        cluster_name = cluster_name or conn_kv[ConnStrKeys.CLUSTER][0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35m        if cluster_name.find("://") > 0:[0m

[31m--[ [0m[34mMatch #[0m[33m716[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m233 | [0m[35m            If this is True, results are returned to client, even if there are exceptions.[0m
[30;1m234 | [0m[35m            If this is False, exception is raised. Default is False.[0m
[30;1m235 | [0m[35m        options["timeout"] : float, optional[0m
[30;1m236 | [0m[35m            Optional parameter. Network timeout in seconds. Default is no timeout.[0m
[30;1m237 | [0m[35m        """[0m
[30;1m238 | [0m[35m        if kusto_query.startswith("."):[0m
[30;1m239 | [0m[35m            endpoint_version = self._MGMT_ENDPOINT_VERSION[0m

[31m--[ [0m[34mMatch #[0m[33m717[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parameterizer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m316 | [0m[35m        # i = d["index"][0m
[30;1m317 | [0m[35m        c = d["columns"][0m
[30;1m318 | [0m[35m        r = d["data"][0m
[30;1m319 | [0m[35m        pairs_t = {col: [str(t[col]), cls._DATAFRAME_TO_KQL_TYPES.get(str(t[col]))] for col in c}[0m
[30;1m320 | [0m[35m        pairs_t = cls._guess_object_types(pairs_t, r)[0m
[30;1m321 | [0m[35m        schema = ", ".join([f"{col}:{pairs_t[col][1]}" for col in c])[0m
[30;1m322 | [0m[35m        data = ", ".join([", ".join([cls._dataframe_to_kql_value(val, pairs_t[c[idx]]) for idx, val [0m

[31m--[ [0m[34mMatch #[0m[33m718[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parameterizer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m184 | [0m[35m        """build let statements that resolve python variable names to python variables values"""[0m
[30;1m185 | [0m[35m        statements = [][0m
[30;1m186 | [0m[35m        for k in parameters:[0m
[30;1m187 | [0m[35m            v = parameters.get(k)[0m
[30;1m188 | [0m[35m            # print('type', type(v))[0m
[30;1m189 | [0m[35m            val = self._object_to_kql(v)[0m
[30;1m190 | [0m[35m            statements.append(f"let {k} = {val}")[0m

[31m--[ [0m[34mMatch #[0m[33m719[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parameterizer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m89 | [0m[35m        """expand query to include resolution of python parameters"""[0m
[30;1m90 | [0m[35m        override_vars = override_vars if type(override_vars) == dict else {}[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m        if options.get("enable_curly_brackets_params"):[0m
[30;1m93 | [0m[35m            curly_brackets_params_dict = CurlyBracketsParamsDict(parameter_vars, override_vars)[0m
[30;1m94 | [0m[35m            curly_brackets_parametrized_query = self._query.format_map(curly_brackets_params_dict)[0m
[30;1m95 | [0m[35m            used_params_dict = curly_brackets_params_dict.used_params_dict[0m

[31m--[ [0m[34mMatch #[0m[33m720[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parameterizer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m147 | [0m[35m                if isinstance(v, bool)[0m
[30;1m148 | [0m[35m                else cls._timedelta_to_timespan(v)[0m
[30;1m149 | [0m[35m                if isinstance(v, timedelta)[0m
[30;1m150 | [0m[35m                else f"datetime({v.isoformat()})"  # kql will assume utc time[0m
[30;1m151 | [0m[35m                if isinstance(v, datetime)[0m
[30;1m152 | [0m[35m                else f"dynamic({json_dumps(dict(v))})"[0m
[30;1m153 | [0m[35m                if isinstance(v, dict)[0m

[31m--[ [0m[34mMatch #[0m[33m721[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/email_notification.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m19 | [0m[35m        self._sender_email = params.get(Email.SEND_FROM)[0m
[30;1m20 | [0m[35m        self._receiver_email = params.get(Email.SEND_TO) [0m
[30;1m21 | [0m[35m        self._password = params.get(Email.SEND_FROM_PASSWORD)[0m
[30;1m22 | [0m[35m        self._context = params.get(Email.CONTEXT)[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m        self._validate_email_params()[0m
[30;1m25 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m722[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/email_notification.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m18 | [0m[35m        self._smtp_server = params.get(Email.SMTP_ENDPOINT)[0m
[30;1m19 | [0m[35m        self._sender_email = params.get(Email.SEND_FROM)[0m
[30;1m20 | [0m[35m        self._receiver_email = params.get(Email.SEND_TO) [0m
[30;1m21 | [0m[35m        self._password = params.get(Email.SEND_FROM_PASSWORD)[0m
[30;1m22 | [0m[35m        self._context = params.get(Email.CONTEXT)[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m        self._validate_email_params()[0m

[31m--[ [0m[34mMatch #[0m[33m723[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/email_notification.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m17 | [0m[35m        self._port = params.get(Email.SMTP_PORT)  [0m
[30;1m18 | [0m[35m        self._smtp_server = params.get(Email.SMTP_ENDPOINT)[0m
[30;1m19 | [0m[35m        self._sender_email = params.get(Email.SEND_FROM)[0m
[30;1m20 | [0m[35m        self._receiver_email = params.get(Email.SEND_TO) [0m
[30;1m21 | [0m[35m        self._password = params.get(Email.SEND_FROM_PASSWORD)[0m
[30;1m22 | [0m[35m        self._context = params.get(Email.CONTEXT)[0m
[30;1m23 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m724[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/email_notification.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m16 | [0m[35m    def __init__(self, **params):[0m
[30;1m17 | [0m[35m        self._port = params.get(Email.SMTP_PORT)  [0m
[30;1m18 | [0m[35m        self._smtp_server = params.get(Email.SMTP_ENDPOINT)[0m
[30;1m19 | [0m[35m        self._sender_email = params.get(Email.SEND_FROM)[0m
[30;1m20 | [0m[35m        self._receiver_email = params.get(Email.SEND_TO) [0m
[30;1m21 | [0m[35m        self._password = params.get(Email.SEND_FROM_PASSWORD)[0m
[30;1m22 | [0m[35m        self._context = params.get(Email.CONTEXT)[0m

[31m--[ [0m[34mMatch #[0m[33m725[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/email_notification.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m    def __init__(self, **params):[0m
[30;1m17 | [0m[35m        self._port = params.get(Email.SMTP_PORT)  [0m
[30;1m18 | [0m[35m        self._smtp_server = params.get(Email.SMTP_ENDPOINT)[0m
[30;1m19 | [0m[35m        self._sender_email = params.get(Email.SEND_FROM)[0m
[30;1m20 | [0m[35m        self._receiver_email = params.get(Email.SEND_TO) [0m
[30;1m21 | [0m[35m        self._password = params.get(Email.SEND_FROM_PASSWORD)[0m

[31m--[ [0m[34mMatch #[0m[33m726[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/email_notification.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m14 | [0m[35mclass EmailNotification(object):[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m    def __init__(self, **params):[0m
[30;1m17 | [0m[35m        self._port = params.get(Email.SMTP_PORT)  [0m
[30;1m18 | [0m[35m        self._smtp_server = params.get(Email.SMTP_ENDPOINT)[0m
[30;1m19 | [0m[35m        self._sender_email = params.get(Email.SEND_FROM)[0m
[30;1m20 | [0m[35m        self._receiver_email = params.get(Email.SEND_TO) [0m

[31m--[ [0m[34mMatch #[0m[33m727[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/email_notification.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m            if result:[0m
[30;1m46 | [0m[35m                error_message = [][0m
[30;1m47 | [0m[35m                for key, value in result:[0m
[30;1m48 | [0m[35m                    error_message.append(f"failed to send mail to {key} due to error {value}")[0m
[30;1m49 | [0m[35m                raise ValueError(",\n".join(error_message))[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m728[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help_html.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m        if url:[0m
[30;1m88 | [0m[35m            IPythonAPI.try_add_to_help_links(text, url, reconnect, **options)[0m
[30;1m89 | [0m[35m        elif Help_html._pending_helps.get(text) is None:[0m
[30;1m90 | [0m[35m            Help_html._pending_helps[text] = file_path[0m

[31m--[ [0m[34mMatch #[0m[33m729[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help_html.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m        # know remote service address[0m
[30;1m33 | [0m[35m        else:[0m
[30;1m34 | [0m[35m            notebook_service_address = options.get("notebook_service_address")[0m
[30;1m35 | [0m[35m            if notebook_service_address is not None:[0m
[30;1m36 | [0m[35m                # azure notebooks service[0m
[30;1m37 | [0m[35m                if notebook_service_address.endswith("notebooks.azure.com"):[0m

[31m--[ [0m[34mMatch #[0m[33m730[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help_html.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m33 | [0m[35m        else:[0m
[30;1m34 | [0m[35m            notebook_service_address = options.get("notebook_service_address")[0m
[30;1m35 | [0m[35m            if notebook_service_address is not None:[0m
[30;1m36 | [0m[35m                # azure notebooks service[0m
[30;1m37 | [0m[35m                if notebook_service_address.endswith("notebooks.azure.com"):[0m
[30;1m38 | [0m[35m                    start = notebook_service_address.find("//") + 2[0m
[30;1m39 | [0m[35m                    host_suffix = "." + notebook_service_address[start:][0m

[31m--[ [0m[34mMatch #[0m[33m731[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/help_html.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35m            del parts[3]  # remove '/notebooks'[0m
[30;1m30 | [0m[35m            base_url = "/".join(parts)[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m        # know remote service address[0m
[30;1m33 | [0m[35m        else:[0m
[30;1m34 | [0m[35m            notebook_service_address = options.get("notebook_service_address")[0m
[30;1m35 | [0m[35m            if notebook_service_address is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m732[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m128 | [0m[35m        # http_query.append(f"uri={urllib.parse.quote(client.data_source)}")  # not clear what it sh[0m
[30;1m129 | [0m[35m        http_query.append(f"name={urllib.parse.quote(self.cluster_friendly_name)}")[0m
[30;1m130 | [0m[35m        if options.get("saw"):[0m
[30;1m131 | [0m[35m            http_query.append(f"saw={urllib.parse.quote(str(options.get('saw')))}")[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m        http_query.append(f"query={urllib.parse.quote(query)}")[0m
[30;1m134 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m733[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m127 | [0m[35m        http_query.append(f"web={urllib.parse.quote(str(web_or_app))}")[0m
[30;1m128 | [0m[35m        # http_query.append(f"uri={urllib.parse.quote(client.data_source)}")  # not clear what it sh[0m
[30;1m129 | [0m[35m        http_query.append(f"name={urllib.parse.quote(self.cluster_friendly_name)}")[0m
[30;1m130 | [0m[35m        if options.get("saw"):[0m
[30;1m131 | [0m[35m            http_query.append(f"saw={urllib.parse.quote(str(options.get('saw')))}")[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m        http_query.append(f"query={urllib.parse.quote(query)}")[0m

[31m--[ [0m[34mMatch #[0m[33m734[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m123 | [0m[35m        options = options or {}[0m
[30;1m124 | [0m[35m        client = self.get_client()[0m
[30;1m125 | [0m[35m        http_query = [][0m
[30;1m126 | [0m[35m        web_or_app = 0 if options.get("query_link_destination") == "Kusto.Explorer" else 1  # defaul[0m
[30;1m127 | [0m[35m        http_query.append(f"web={urllib.parse.quote(str(web_or_app))}")[0m
[30;1m128 | [0m[35m        # http_query.append(f"uri={urllib.parse.quote(client.data_source)}")  # not clear what it sh[0m
[30;1m129 | [0m[35m        http_query.append(f"name={urllib.parse.quote(self.cluster_friendly_name)}")[0m

[31m--[ [0m[34mMatch #[0m[33m735[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m89 | [0m[35m                conn_str, current, self._URI_SCHEMA_NAME, self._MANDATORY_KEY, self._VALID_KEYS_COMB[0m
[30;1m90 | [0m[35m            )[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m            cluster_name = self._parsed_conn.get(ConnStrKeys.CLUSTER, self._DEFAULT_CLUSTER_NAME)[0m
[30;1m93 | [0m[35m            self.client = KustoClient(cluster_name, self._parsed_conn, **options)[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m736[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m            self.database_friendly_name = self.createDatabaseFriendlyName(self.database_name)[0m
[30;1m82 | [0m[35m            self.cluster_name = conn_dict.get(ConnStrKeys.CLUSTER)[0m
[30;1m83 | [0m[35m            self.alias = conn_dict.get(ConnStrKeys.ALIAS) or self.database_friendly_name[0m
[30;1m84 | [0m[35m            self.cluster_friendly_name = conn_dict.get(ConnStrKeys.CLUSTER_FRIENDLY_NAME)[0m
[30;1m85 | [0m[35m            self.bind_url = f"{self._URI_SCHEMA_NAME}://{ConnStrKeys.CLUSTER}('{self.cluster_name}')[0m
[30;1m86 | [0m[35m        else:[0m
[30;1m87 | [0m[35m            conn_str:str = conn_str_or_dict[0m

[31m--[ [0m[34mMatch #[0m[33m737[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m80 | [0m[35m            self.database_name = conn_dict.get(ConnStrKeys.DATABASE)[0m
[30;1m81 | [0m[35m            self.database_friendly_name = self.createDatabaseFriendlyName(self.database_name)[0m
[30;1m82 | [0m[35m            self.cluster_name = conn_dict.get(ConnStrKeys.CLUSTER)[0m
[30;1m83 | [0m[35m            self.alias = conn_dict.get(ConnStrKeys.ALIAS) or self.database_friendly_name[0m
[30;1m84 | [0m[35m            self.cluster_friendly_name = conn_dict.get(ConnStrKeys.CLUSTER_FRIENDLY_NAME)[0m
[30;1m85 | [0m[35m            self.bind_url = f"{self._URI_SCHEMA_NAME}://{ConnStrKeys.CLUSTER}('{self.cluster_name}')[0m
[30;1m86 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m738[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m78 | [0m[35m isinstance(conn_str_or_dict, dict):[0m
[30;1m79 | [0m[35m            conn_dict:Dict[str,str] = conn_str_or_dict[0m
[30;1m80 | [0m[35m            self.database_name = conn_dict.get(ConnStrKeys.DATABASE)[0m
[30;1m81 | [0m[35m            self.database_friendly_name = self.createDatabaseFriendlyName(self.database_name)[0m
[30;1m82 | [0m[35m            self.cluster_name = conn_dict.get(ConnStrKeys.CLUSTER)[0m
[30;1m83 | [0m[35m            self.alias = conn_dict.get(ConnStrKeys.ALIAS) or self.database_friendly_name[0m
[30;1m84 | [0m[35m            self.cluster_friendly_name = conn_dict.get(ConnStrKeys.CLUSTER_FRIENDLY_NAME)[0m

[31m--[ [0m[34mMatch #[0m[33m739[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kusto_engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m        self.conn_class = conn_class[0m
[30;1m78 | [0m[35m        if isinstance(conn_str_or_dict, dict):[0m
[30;1m79 | [0m[35m            conn_dict:Dict[str,str] = conn_str_or_dict[0m
[30;1m80 | [0m[35m            self.database_name = conn_dict.get(ConnStrKeys.DATABASE)[0m
[30;1m81 | [0m[35m            self.database_friendly_name = self.createDatabaseFriendlyName(self.database_name)[0m
[30;1m82 | [0m[35m            self.cluster_name = conn_dict.get(ConnStrKeys.CLUSTER)[0m
[30;1m83 | [0m[35m            self.alias = conn_dict.get(ConnStrKeys.ALIAS) or self.database_friendly_name[0m

[31m--[ [0m[34mMatch #[0m[33m740[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_response.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m338 | [0m[35m                if table["TableName"] == "QueryCompletionInformation":[0m
[30;1m339 | [0m[35m                    cols_idx_map = self._map_columns_to_index(table["Columns"])[0m
[30;1m340 | [0m[35m                    event_type_name_idx = cols_idx_map.get("EventTypeName")[0m
[30;1m341 | [0m[35m                    payload_idx = cols_idx_map.get("Payload")[0m
[30;1m342 | [0m[35m                    if event_type_name_idx is not None and payload_idx is not None:[0m
[30;1m343 | [0m[35m                        for row in table["Rows"]:[0m
[30;1m344 | [0m[35m                            if row[event_type_name_idx] == "QueryResourceConsumption":[0m

[31m--[ [0m[34mMatch #[0m[33m741[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_response.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m337 | [0m[35m            for table in self.all_tables:[0m
[30;1m338 | [0m[35m                if table["TableName"] == "QueryCompletionInformation":[0m
[30;1m339 | [0m[35m                    cols_idx_map = self._map_columns_to_index(table["Columns"])[0m
[30;1m340 | [0m[35m                    event_type_name_idx = cols_idx_map.get("EventTypeName")[0m
[30;1m341 | [0m[35m                    payload_idx = cols_idx_map.get("Payload")[0m
[30;1m342 | [0m[35m                    if event_type_name_idx is not None and payload_idx is not None:[0m
[30;1m343 | [0m[35m                        for row in table["Rows"]:[0m

[31m--[ [0m[34mMatch #[0m[33m742[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_response.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m310 | [0m[35m                if table["TableName"] == "QueryCompletionInformation":[0m
[30;1m311 | [0m[35m                    cols_idx_map = self._map_columns_to_index(table["Columns"])[0m
[30;1m312 | [0m[35m                    event_type_name_idx = cols_idx_map.get("EventTypeName")[0m
[30;1m313 | [0m[35m                    payload_idx = cols_idx_map.get("Payload")[0m
[30;1m314 | [0m[35m                    if event_type_name_idx is not None and payload_idx is not None:[0m
[30;1m315 | [0m[35m                        for row in table["Rows"]:[0m
[30;1m316 | [0m[35m                            if row[event_type_name_idx] == "QueryInfo":[0m

[31m--[ [0m[34mMatch #[0m[33m743[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_response.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m309 | [0m[35m            for table in self.all_tables:[0m
[30;1m310 | [0m[35m                if table["TableName"] == "QueryCompletionInformation":[0m
[30;1m311 | [0m[35m                    cols_idx_map = self._map_columns_to_index(table["Columns"])[0m
[30;1m312 | [0m[35m                    event_type_name_idx = cols_idx_map.get("EventTypeName")[0m
[30;1m313 | [0m[35m                    payload_idx = cols_idx_map.get("Payload")[0m
[30;1m314 | [0m[35m                    if event_type_name_idx is not None and payload_idx is not None:[0m
[30;1m315 | [0m[35m                        for row in table["Rows"]:[0m

[31m--[ [0m[34mMatch #[0m[33m744[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_response.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m295 | [0m[35m                                    if key == ExtendedPropertiesKeys.VISUALIZATION:[0m
[30;1m296 | [0m[35m                                        extended_properties[key] = value_obj[0m
[30;1m297 | [0m[35m                                    elif key == ExtendedPropertiesKeys.CURSOR:[0m
[30;1m298 | [0m[35m                                        extended_properties[key] = str(value_obj.get(ExtendedPropert[0m
[30;1m299 | [0m[35m                                    else:[0m
[30;1m300 | [0m[35m                                        extended_properties[key] = value_obj[0m
[30;1m301 | [0m[35m                                    self._extended_properties[table_id] = extended_properties[0m

[31m--[ [0m[34mMatch #[0m[33m745[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_response.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m266 | [0m[35m                                table_id = row[table_id_idx][0m
[30;1m267 | [0m[35m                                key = row[key_idx][0m
[30;1m268 | [0m[35m                                value = row[value_idx][0m
[30;1m269 | [0m[35m                                extended_properties = self._extended_properties.get(table_id, {})[0m
[30;1m270 | [0m[35m                                if key == ExtendedPropertiesKeys.VISUALIZATION:[0m
[30;1m271 | [0m[35m                                    value_obj = self._dynamic_to_object(value)[0m
[30;1m272 | [0m[35m                                    extended_properties[key] = value_obj[0m

[31m--[ [0m[34mMatch #[0m[33m746[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_response.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m254 | [0m[35m                        types = self._get_columns_types(table["Columns"])[0m
[30;1m255 | [0m[35m                        key_idx = cols_idx_map.get("Key")[0m
[30;1m256 | [0m[35m                        table_id_idx = cols_idx_map.get("TableId")[0m
[30;1m257 | [0m[35m                        value_idx = cols_idx_map.get("Value")[0m
[30;1m258 | [0m[35m                        if ([0m
[30;1m259 | [0m[35m                            key_idx is not None[0m
[30;1m260 | [0m[35m                            and table_id_idx is not None[0m

[31m--[ [0m[34mMatch #[0m[33m747[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_response.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m253 | [0m[35m                        cols_idx_map = self._map_columns_to_index(table["Columns"])[0m
[30;1m254 | [0m[35m                        types = self._get_columns_types(table["Columns"])[0m
[30;1m255 | [0m[35m                        key_idx = cols_idx_map.get("Key")[0m
[30;1m256 | [0m[35m                        table_id_idx = cols_idx_map.get("TableId")[0m
[30;1m257 | [0m[35m                        value_idx = cols_idx_map.get("Value")[0m
[30;1m258 | [0m[35m                        if ([0m
[30;1m259 | [0m[35m                            key_idx is not None[0m

[31m--[ [0m[34mMatch #[0m[33m748[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_response.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m252 | [0m[35m                    if table["TableName"] == "@ExtendedProperties" and table["TableKind"] == "QueryP[0m
[30;1m253 | [0m[35m                        cols_idx_map = self._map_columns_to_index(table["Columns"])[0m
[30;1m254 | [0m[35m                        types = self._get_columns_types(table["Columns"])[0m
[30;1m255 | [0m[35m                        key_idx = cols_idx_map.get("Key")[0m
[30;1m256 | [0m[35m                        table_id_idx = cols_idx_map.get("TableId")[0m
[30;1m257 | [0m[35m                        value_idx = cols_idx_map.get("Value")[0m
[30;1m258 | [0m[35m                        if ([0m

[31m--[ [0m[34mMatch #[0m[33m749[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_response.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m208 | [0m[35mclass KqlQueryResponse(object):[0m
[30;1m209 | [0m[35m    """ Wrapper for response """[0m
[30;1m210 | [0m[35m[0m
[30;1m211 | [0m[35m    # TODO: add support to get additional infromation from response, like execution time[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m    def __init__(self, json_response, endpoint_version="v1"):[0m
[30;1m214 | [0m[35m        self.json_response = json_response[0m

[31m--[ [0m[34mMatch #[0m[33m750[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/os_dependent_api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m30 | [0m[35m    def webbrowser_open(cls, url:str)->None:[0m
[30;1m31 | [0m[35m        # return webbrowser.open(url)[0m
[30;1m32 | [0m[35m        # webbrowser.open(url, new=1, autoraise=True)[0m
[30;1m33 | [0m[35m        if cls.options.get("notebook_app") in ["azuredatastudiosaw"]:[0m
[30;1m34 | [0m[35m            try:[0m
[30;1m35 | [0m[35m                OsDependentAPI.startfile(url)[0m
[30;1m36 | [0m[35m                return[0m

[31m--[ [0m[34mMatch #[0m[33m751[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1738 | [0m[35m                "secureadminworkstation": "azuredatastudiosaw",[0m
[30;1m1739 | [0m[35m                "azurenotebooks": "azurenotebook",[0m
[30;1m1740 | [0m[35m                # "papermill":"papermill" #TODO: add "papermill"[0m
[30;1m1741 | [0m[35m            }.get(lookup_key)[0m
[30;1m1742 | [0m[35m            if app is not None:[0m
[30;1m1743 | [0m[35m                app = app.strip()[0m
[30;1m1744 | [0m[35m                self.default_options.set_trait("notebook_app", app, force=True)[0m

[31m--[ [0m[34mMatch #[0m[33m752[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1524 | [0m[35m[0m
[30;1m1525 | [0m[35m            self.last_raw_result = saved_result[0m
[30;1m1526 | [0m[35m            if options.get("last_raw_result_var") is not None:[0m
[30;1m1527 | [0m[35m                last_raw_result_var = options.get("last_raw_result_var")[0m
[30;1m1528 | [0m[35m                self.shell_user_ns.update({last_raw_result_var: saved_result})[0m
[30;1m1529 | [0m[35m                user_ns.update({last_raw_result_var: saved_result})[0m
[30;1m1530 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m753[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1523 | [0m[35m                user_ns.update({cursor_var: cursor_value})[0m
[30;1m1524 | [0m[35m[0m
[30;1m1525 | [0m[35m            self.last_raw_result = saved_result[0m
[30;1m1526 | [0m[35m            if options.get("last_raw_result_var") is not None:[0m
[30;1m1527 | [0m[35m                last_raw_result_var = options.get("last_raw_result_var")[0m
[30;1m1528 | [0m[35m                self.shell_user_ns.update({last_raw_result_var: saved_result})[0m
[30;1m1529 | [0m[35m                user_ns.update({last_raw_result_var: saved_result})[0m

[31m--[ [0m[34mMatch #[0m[33m754[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1517 | [0m[35m[0m
[30;1m1518 | [0m[35m            # Return results into the default ipython _ variable[0m
[30;1m1519 | [0m[35m            if options.get("cursor_var") is not None:[0m
[30;1m1520 | [0m[35m                cursor_var = options.get("cursor_var")[0m
[30;1m1521 | [0m[35m                cursor_value = saved_result.cursor[0m
[30;1m1522 | [0m[35m                self.shell_user_ns.update({cursor_var: cursor_value})[0m
[30;1m1523 | [0m[35m                user_ns.update({cursor_var: cursor_value})[0m

[31m--[ [0m[34mMatch #[0m[33m755[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1516 | [0m[35m                user_ns.update({assign_var: saved_result})[0m
[30;1m1517 | [0m[35m[0m
[30;1m1518 | [0m[35m            # Return results into the default ipython _ variable[0m
[30;1m1519 | [0m[35m            if options.get("cursor_var") is not None:[0m
[30;1m1520 | [0m[35m                cursor_var = options.get("cursor_var")[0m
[30;1m1521 | [0m[35m                cursor_value = saved_result.cursor[0m
[30;1m1522 | [0m[35m                self.shell_user_ns.update({cursor_var: cursor_value})[0m

[31m--[ [0m[34mMatch #[0m[33m756[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1511 | [0m[35m[0m
[30;1m1512 | [0m[35m            # Return results into the default ipython _ variable[0m
[30;1m1513 | [0m[35m            if options.get("assign_var") is not None:[0m
[30;1m1514 | [0m[35m                assign_var = options.get("assign_var")[0m
[30;1m1515 | [0m[35m                self.shell_user_ns.update({assign_var: saved_result})[0m
[30;1m1516 | [0m[35m                user_ns.update({assign_var: saved_result})[0m
[30;1m1517 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m757[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1510 | [0m[35m                saved_result._update_fork_results()[0m
[30;1m1511 | [0m[35m[0m
[30;1m1512 | [0m[35m            # Return results into the default ipython _ variable[0m
[30;1m1513 | [0m[35m            if options.get("assign_var") is not None:[0m
[30;1m1514 | [0m[35m                assign_var = options.get("assign_var")[0m
[30;1m1515 | [0m[35m                self.shell_user_ns.update({assign_var: saved_result})[0m
[30;1m1516 | [0m[35m                user_ns.update({assign_var: saved_result})[0m

[31m--[ [0m[34mMatch #[0m[33m758[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1498 | [0m[35m            if result is not None:[0m
[30;1m1499 | [0m[35m                if suppress_results:[0m
[30;1m1500 | [0m[35m                    saved_result.suppress_result = True[0m
[30;1m1501 | [0m[35m                elif options.get("auto_dataframe"):[0m
[30;1m1502 | [0m[35m                    Display.showWarningMessage(saved_result.feedback_warning, **options)[0m
[30;1m1503 | [0m[35m                    Display.showInfoMessage(saved_result.feedback_info, **options)[0m
[30;1m1504 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m759[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1492 | [0m[35m                if options.get("feedback"):[0m
[30;1m1493 | [0m[35m                    saved_result.feedback_info.append(f"query results saved as {save_as_file_path}")[0m
[30;1m1494 | [0m[35m            if options.get("save_to") is not None:[0m
[30;1m1495 | [0m[35m                if options.get("feedback"):[0m
[30;1m1496 | [0m[35m                    path = "/".join(save_as_file_path.split("/")[:-1])[0m
[30;1m1497 | [0m[35m                    saved_result.feedback_info.append(f"query results saved to {path}")[0m
[30;1m1498 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m760[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1488 | [0m[35m            if options.get("save_as") is not None:[0m
[30;1m1489 | [0m[35m                if options.get("feedback"):[0m
[30;1m1490 | [0m[35m                    saved_result.feedback_info.append(f"query results saved as {save_as_file_path}")[0m
[30;1m1491 | [0m[35m            if options.get("save_to") is not None:[0m
[30;1m1492 | [0m[35m                if options.get("feedback"):[0m
[30;1m1493 | [0m[35m                    path = "/".join(save_as_file_path.split("/")[:-1])[0m
[30;1m1494 | [0m[35m                    saved_result.feedback_info.append(f"query results saved to {path}")[0m

[31m--[ [0m[34mMatch #[0m[33m761[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1486 | [0m[35m                    saved_result.feedback_info.append("query results cached")[0m
[30;1m1487 | [0m[35m[0m
[30;1m1488 | [0m[35m            if options.get("save_as") is not None:[0m
[30;1m1489 | [0m[35m                if options.get("feedback"):[0m
[30;1m1490 | [0m[35m                    saved_result.feedback_info.append(f"query results saved as {save_as_file_path}")[0m
[30;1m1491 | [0m[35m            if options.get("save_to") is not None:[0m
[30;1m1492 | [0m[35m                if options.get("feedback"):[0m

[31m--[ [0m[34mMatch #[0m[33m762[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1485 | [0m[35m                if options.get("feedback"):[0m
[30;1m1486 | [0m[35m                    saved_result.feedback_info.append("query results cached")[0m
[30;1m1487 | [0m[35m[0m
[30;1m1488 | [0m[35m            if options.get("save_as") is not None:[0m
[30;1m1489 | [0m[35m                if options.get("feedback"):[0m
[30;1m1490 | [0m[35m                    saved_result.feedback_info.append(f"query results saved as {save_as_file_path}")[0m
[30;1m1491 | [0m[35m            if options.get("save_to") is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m763[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1482 | [0m[35m[0m
[30;1m1483 | [0m[35m            if options.get("cache") is not None and options.get("cache") != options.get("use_cache")[0m
[30;1m1484 | [0m[35m                CacheClient(**options).save(raw_query_result, engine, parametrized_query, **options)[0m
[30;1m1485 | [0m[35m                if options.get("feedback"):[0m
[30;1m1486 | [0m[35m                    saved_result.feedback_info.append("query results cached")[0m
[30;1m1487 | [0m[35m[0m
[30;1m1488 | [0m[35m            if options.get("save_as") is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m764[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1480 | [0m[35m                user_ns.update({result_var: result if result is not None else saved_result})[0m
[30;1m1481 | [0m[35m                result = None[0m
[30;1m1482 | [0m[35m[0m
[30;1m1483 | [0m[35m            if options.get("cache") is not None and options.get("cache") != options.get("use_cache")[0m
[30;1m1484 | [0m[35m                CacheClient(**options).save(raw_query_result, engine, parametrized_query, **options)[0m
[30;1m1485 | [0m[35m                if options.get("feedback"):[0m
[30;1m1486 | [0m[35m                    saved_result.feedback_info.append("query results cached")[0m

[31m--[ [0m[34mMatch #[0m[33m765[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1480 | [0m[35m                user_ns.update({result_var: result if result is not None else saved_result})[0m
[30;1m1481 | [0m[35m                result = None[0m
[30;1m1482 | [0m[35m[0m
[30;1m1483 | [0m[35m            if options.get("cache") is not None and options.get("cache") != options.get("use_cache")[0m
[30;1m1484 | [0m[35m                CacheClient(**options).save(raw_query_result, engine, parametrized_query, **options)[0m
[30;1m1485 | [0m[35m                if options.get("feedback"):[0m
[30;1m1486 | [0m[35m                    saved_result.feedback_info.append("query results cached")[0m

[31m--[ [0m[34mMatch #[0m[33m766[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1480 | [0m[35m                user_ns.update({result_var: result if result is not None else saved_result})[0m
[30;1m1481 | [0m[35m                result = None[0m
[30;1m1482 | [0m[35m[0m
[30;1m1483 | [0m[35m            if options.get("cache") is not None and options.get("cache") != options.get("use_cache")[0m
[30;1m1484 | [0m[35m                CacheClient(**options).save(raw_query_result, engine, parametrized_query, **options)[0m
[30;1m1485 | [0m[35m                if options.get("feedback"):[0m
[30;1m1486 | [0m[35m                    saved_result.feedback_info.append("query results cached")[0m

[31m--[ [0m[34mMatch #[0m[33m767[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1474 | [0m[35m[0m
[30;1m1475 | [0m[35m            if options.get("result_var") and result_set is None:[0m
[30;1m1476 | [0m[35m                result_var = options.get("result_var")[0m
[30;1m1477 | [0m[35m                if options.get("feedback"):[0m
[30;1m1478 | [0m[35m                    saved_result.feedback_info.append(f"Returning data to local variable {result_var[0m
[30;1m1479 | [0m[35m                self.shell_user_ns.update({result_var: result if result is not None else saved_resul[0m
[30;1m1480 | [0m[35m                user_ns.update({result_var: result if result is not None else saved_result})[0m

[31m--[ [0m[34mMatch #[0m[33m768[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1473 | [0m[35m                result = saved_result.to_dataframe()[0m
[30;1m1474 | [0m[35m[0m
[30;1m1475 | [0m[35m            if options.get("result_var") and result_set is None:[0m
[30;1m1476 | [0m[35m                result_var = options.get("result_var")[0m
[30;1m1477 | [0m[35m                if options.get("feedback"):[0m
[30;1m1478 | [0m[35m                    saved_result.feedback_info.append(f"Returning data to local variable {result_var[0m
[30;1m1479 | [0m[35m                self.shell_user_ns.update({result_var: result if result is not None else saved_resul[0m

[31m--[ [0m[34mMatch #[0m[33m769[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1472 | [0m[35m                    saved_result.feedback_info.append("Returning data converted to pandas dataframe"[0m
[30;1m1473 | [0m[35m                result = saved_result.to_dataframe()[0m
[30;1m1474 | [0m[35m[0m
[30;1m1475 | [0m[35m            if options.get("result_var") and result_set is None:[0m
[30;1m1476 | [0m[35m                result_var = options.get("result_var")[0m
[30;1m1477 | [0m[35m                if options.get("feedback"):[0m
[30;1m1478 | [0m[35m                    saved_result.feedback_info.append(f"Returning data to local variable {result_var[0m

[31m--[ [0m[34mMatch #[0m[33m770[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1468 | [0m[35m                result = None[0m
[30;1m1469 | [0m[35m[0m
[30;1m1470 | [0m[35m            if options.get("auto_dataframe"):[0m
[30;1m1471 | [0m[35m                if options.get("feedback"):[0m
[30;1m1472 | [0m[35m                    saved_result.feedback_info.append("Returning data converted to pandas dataframe"[0m
[30;1m1473 | [0m[35m                result = saved_result.to_dataframe()[0m
[30;1m1474 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m771[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1467 | [0m[35m                user_ns.update(saved_result.to_dict())[0m
[30;1m1468 | [0m[35m                result = None[0m
[30;1m1469 | [0m[35m[0m
[30;1m1470 | [0m[35m            if options.get("auto_dataframe"):[0m
[30;1m1471 | [0m[35m                if options.get("feedback"):[0m
[30;1m1472 | [0m[35m                    saved_result.feedback_info.append("Returning data converted to pandas dataframe"[0m
[30;1m1473 | [0m[35m                result = saved_result.to_dataframe()[0m

[31m--[ [0m[34mMatch #[0m[33m772[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1460 | [0m[35m                # Instead of returning values, set variables directly in the[0m
[30;1m1461 | [0m[35m                # users namespace. Variable names given by column names[0m
[30;1m1462 | [0m[35m[0m
[30;1m1463 | [0m[35m                if options.get("feedback"):[0m
[30;1m1464 | [0m[35m                    saved_result.feedback_info.append("Returning raw data to local variables")[0m
[30;1m1465 | [0m[35m[0m
[30;1m1466 | [0m[35m                self.shell_user_ns.update(saved_result.to_dict())[0m

[31m--[ [0m[34mMatch #[0m[33m773[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1456 | [0m[35m                    minutes, seconds = divmod(end_time - start_time, 60)[0m
[30;1m1457 | [0m[35m                    saved_result.feedback_info.append("Done ({:0>2}:{:06.3f}): {} records".format(in[0m
[30;1m1458 | [0m[35m[0m
[30;1m1459 | [0m[35m            if options.get("columns_to_local_vars"):[0m
[30;1m1460 | [0m[35m                # Instead of returning values, set variables directly in the[0m
[30;1m1461 | [0m[35m                # users namespace. Variable names given by column names[0m
[30;1m1462 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m774[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1452 | [0m[35m                saved_result.feedback_warning.append(f"partial results, query had errors (see {optio[0m
[30;1m1453 | [0m[35m[0m
[30;1m1454 | [0m[35m            if options.get("feedback"):[0m
[30;1m1455 | [0m[35m                if options.get("show_query_time"):[0m
[30;1m1456 | [0m[35m                    minutes, seconds = divmod(end_time - start_time, 60)[0m
[30;1m1457 | [0m[35m                    saved_result.feedback_info.append("Done ({:0>2}:{:06.3f}): {} records".format(in[0m
[30;1m1458 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m775[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1451 | [0m[35m            if saved_result.is_partial_table:[0m
[30;1m1452 | [0m[35m                saved_result.feedback_warning.append(f"partial results, query had errors (see {optio[0m
[30;1m1453 | [0m[35m[0m
[30;1m1454 | [0m[35m            if options.get("feedback"):[0m
[30;1m1455 | [0m[35m                if options.get("show_query_time"):[0m
[30;1m1456 | [0m[35m                    minutes, seconds = divmod(end_time - start_time, 60)[0m
[30;1m1457 | [0m[35m                    saved_result.feedback_info.append("Done ({:0>2}:{:06.3f}): {} records".format(in[0m

[31m--[ [0m[34mMatch #[0m[33m776[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1449 | [0m[35m            result = saved_result[0m
[30;1m1450 | [0m[35m[0m
[30;1m1451 | [0m[35m            if saved_result.is_partial_table:[0m
[30;1m1452 | [0m[35m                saved_result.feedback_warning.append(f"partial results, query had errors (see {optio[0m
[30;1m1453 | [0m[35m[0m
[30;1m1454 | [0m[35m            if options.get("feedback"):[0m
[30;1m1455 | [0m[35m                if options.get("show_query_time"):[0m

[31m--[ [0m[34mMatch #[0m[33m777[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1420 | [0m[35m                )[0m
[30;1m1421 | [0m[35m            if options.get("save_to") is not None:[0m
[30;1m1422 | [0m[35m                save_as_file_path = CacheClient(**options).save([0m
[30;1m1423 | [0m[35m                    raw_query_result, engine, parametrized_query, filefolder=options.get("save_to"),[0m
[30;1m1424 | [0m[35m                )[0m
[30;1m1425 | [0m[35m            #[0m
[30;1m1426 | [0m[35m            # model query results[0m

[31m--[ [0m[34mMatch #[0m[33m778[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1418 | [0m[35m                save_as_file_path = CacheClient(**options).save([0m
[30;1m1419 | [0m[35m                    raw_query_result, engine, parametrized_query, file_path=options.get("save_as"), [0m
[30;1m1420 | [0m[35m                )[0m
[30;1m1421 | [0m[35m            if options.get("save_to") is not None:[0m
[30;1m1422 | [0m[35m                save_as_file_path = CacheClient(**options).save([0m
[30;1m1423 | [0m[35m                    raw_query_result, engine, parametrized_query, filefolder=options.get("save_to"),[0m
[30;1m1424 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m779[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1416 | [0m[35m            save_as_file_path = None[0m
[30;1m1417 | [0m[35m            if options.get("save_as") is not None:[0m
[30;1m1418 | [0m[35m                save_as_file_path = CacheClient(**options).save([0m
[30;1m1419 | [0m[35m                    raw_query_result, engine, parametrized_query, file_path=options.get("save_as"), [0m
[30;1m1420 | [0m[35m                )[0m
[30;1m1421 | [0m[35m            if options.get("save_to") is not None:[0m
[30;1m1422 | [0m[35m                save_as_file_path = CacheClient(**options).save([0m

[31m--[ [0m[34mMatch #[0m[33m780[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1414 | [0m[35m            end_time = time.time()[0m
[30;1m1415 | [0m[35m[0m
[30;1m1416 | [0m[35m            save_as_file_path = None[0m
[30;1m1417 | [0m[35m            if options.get("save_as") is not None:[0m
[30;1m1418 | [0m[35m                save_as_file_path = CacheClient(**options).save([0m
[30;1m1419 | [0m[35m                    raw_query_result, engine, parametrized_query, file_path=options.get("save_as"), [0m
[30;1m1420 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m781[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1395 | [0m[35m            Parser.validate_query_properties(engine._URI_SCHEMA_NAME, options.get("query_properties"[0m
[30;1m1396 | [0m[35m[0m
[30;1m1397 | [0m[35m            parametrized_query_obj = result_set.parametrized_query_obj if result_set is not None els[0m
[30;1m1398 | [0m[35m            params_vars = parametrized_query_obj.parameters if result_set is not None else options.g[0m
[30;1m1399 | [0m[35m            parametrized_query_obj.apply(params_vars, override_vars=override_vars,  **options)[0m
[30;1m1400 | [0m[35m            parametrized_query = parametrized_query_obj.query[0m
[30;1m1401 | [0m[35m            try:[0m

[31m--[ [0m[34mMatch #[0m[33m782[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1392 | [0m[35m            # submit query[0m
[30;1m1393 | [0m[35m            #[0m
[30;1m1394 | [0m[35m            start_time = time.time()[0m
[30;1m1395 | [0m[35m            Parser.validate_query_properties(engine._URI_SCHEMA_NAME, options.get("query_properties"[0m
[30;1m1396 | [0m[35m[0m
[30;1m1397 | [0m[35m            parametrized_query_obj = result_set.parametrized_query_obj if result_set is not None els[0m
[30;1m1398 | [0m[35m            params_vars = parametrized_query_obj.parameters if result_set is not None else options.g[0m

[31m--[ [0m[34mMatch #[0m[33m783[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1376 | [0m[35m                Database_html.popup_schema(schema_file_path, engine, **options)[0m
[30;1m1377 | [0m[35m            engine.options["auto_popup_schema_done"] = True[0m
[30;1m1378 | [0m[35m[0m
[30;1m1379 | [0m[35m            if not engine.options.get("add_schema_to_help_done") and options.get("add_schema_to_help[0m
[30;1m1380 | [0m[35m                schema_file_path = schema_file_path or Database_html.get_schema_file_path(engine, **[0m
[30;1m1381 | [0m[35m                Help_html.add_menu_item(engine.get_conn_name(), schema_file_path, **options)[0m
[30;1m1382 | [0m[35m            engine.options["add_schema_to_help_done"] = True[0m

[31m--[ [0m[34mMatch #[0m[33m784[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1376 | [0m[35m                Database_html.popup_schema(schema_file_path, engine, **options)[0m
[30;1m1377 | [0m[35m            engine.options["auto_popup_schema_done"] = True[0m
[30;1m1378 | [0m[35m[0m
[30;1m1379 | [0m[35m            if not engine.options.get("add_schema_to_help_done") and options.get("add_schema_to_help[0m
[30;1m1380 | [0m[35m                schema_file_path = schema_file_path or Database_html.get_schema_file_path(engine, **[0m
[30;1m1381 | [0m[35m                Help_html.add_menu_item(engine.get_conn_name(), schema_file_path, **options)[0m
[30;1m1382 | [0m[35m            engine.options["add_schema_to_help_done"] = True[0m

[31m--[ [0m[34mMatch #[0m[33m785[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1376 | [0m[35m                Database_html.popup_schema(schema_file_path, engine, **options)[0m
[30;1m1377 | [0m[35m            engine.options["auto_popup_schema_done"] = True[0m
[30;1m1378 | [0m[35m[0m
[30;1m1379 | [0m[35m            if not engine.options.get("add_schema_to_help_done") and options.get("add_schema_to_help[0m
[30;1m1380 | [0m[35m                schema_file_path = schema_file_path or Database_html.get_schema_file_path(engine, **[0m
[30;1m1381 | [0m[35m                Help_html.add_menu_item(engine.get_conn_name(), schema_file_path, **options)[0m
[30;1m1382 | [0m[35m            engine.options["add_schema_to_help_done"] = True[0m

[31m--[ [0m[34mMatch #[0m[33m786[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1370 | [0m[35m[0m
[30;1m1371 | [0m[35m            schema_file_path = None[0m
[30;1m1372 | [0m[35m            if options.get("popup_schema") or ([0m
[30;1m1373 | [0m[35m                not engine.options.get("auto_popup_schema_done") and options.get("auto_popup_schema"[0m
[30;1m1374 | [0m[35m            ):[0m
[30;1m1375 | [0m[35m                schema_file_path = Database_html.get_schema_file_path(engine, **options)[0m
[30;1m1376 | [0m[35m                Database_html.popup_schema(schema_file_path, engine, **options)[0m

[31m--[ [0m[34mMatch #[0m[33m787[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1370 | [0m[35m[0m
[30;1m1371 | [0m[35m            schema_file_path = None[0m
[30;1m1372 | [0m[35m            if options.get("popup_schema") or ([0m
[30;1m1373 | [0m[35m                not engine.options.get("auto_popup_schema_done") and options.get("auto_popup_schema"[0m
[30;1m1374 | [0m[35m            ):[0m
[30;1m1375 | [0m[35m                schema_file_path = Database_html.get_schema_file_path(engine, **options)[0m
[30;1m1376 | [0m[35m                Database_html.popup_schema(schema_file_path, engine, **options)[0m

[31m--[ [0m[34mMatch #[0m[33m788[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1369 | [0m[35m                    engine.validate(**options)[0m
[30;1m1370 | [0m[35m[0m
[30;1m1371 | [0m[35m            schema_file_path = None[0m
[30;1m1372 | [0m[35m            if options.get("popup_schema") or ([0m
[30;1m1373 | [0m[35m                not engine.options.get("auto_popup_schema_done") and options.get("auto_popup_schema"[0m
[30;1m1374 | [0m[35m            ):[0m
[30;1m1375 | [0m[35m                schema_file_path = Database_html.get_schema_file_path(engine, **options)[0m

[31m--[ [0m[34mMatch #[0m[33m789[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1346 | [0m[35m            # validate database_name exist as a resource or pretty name[0m
[30;1m1347 | [0m[35m            engine.validate_database_name(**options)[0m
[30;1m1348 | [0m[35m            # validate connection[0m
[30;1m1349 | [0m[35m            if options.get("validate_connection_string"):[0m
[30;1m1350 | [0m[35m                retry_with_code = False[0m
[30;1m1351 | [0m[35m                try:[0m
[30;1m1352 | [0m[35m                    engine.validate(**options)[0m

[31m--[ [0m[34mMatch #[0m[33m790[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1320 | [0m[35m        options = parsed.get("options", {})[0m
[30;1m1321 | [0m[35m[0m
[30;1m1322 | [0m[35m        suppress_results = options.get("suppress_results", False) and options.get("enable_suppress_r[0m
[30;1m1323 | [0m[35m        connection_string = parsed.get("connection_string")[0m
[30;1m1324 | [0m[35m[0m
[30;1m1325 | [0m[35m        if not query and not connection_string:[0m
[30;1m1326 | [0m[35m            return None[0m

[31m--[ [0m[34mMatch #[0m[33m791[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1319 | [0m[35m        query = parsed.get("query", "").strip()[0m
[30;1m1320 | [0m[35m        options = parsed.get("options", {})[0m
[30;1m1321 | [0m[35m[0m
[30;1m1322 | [0m[35m        suppress_results = options.get("suppress_results", False) and options.get("enable_suppress_r[0m
[30;1m1323 | [0m[35m        connection_string = parsed.get("connection_string")[0m
[30;1m1324 | [0m[35m[0m
[30;1m1325 | [0m[35m        if not query and not connection_string:[0m

[31m--[ [0m[34mMatch #[0m[33m792[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1319 | [0m[35m        query = parsed.get("query", "").strip()[0m
[30;1m1320 | [0m[35m        options = parsed.get("options", {})[0m
[30;1m1321 | [0m[35m[0m
[30;1m1322 | [0m[35m        suppress_results = options.get("suppress_results", False) and options.get("enable_suppress_r[0m
[30;1m1323 | [0m[35m        connection_string = parsed.get("connection_string")[0m
[30;1m1324 | [0m[35m[0m
[30;1m1325 | [0m[35m        if not query and not connection_string:[0m

[31m--[ [0m[34mMatch #[0m[33m793[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1317 | [0m[35m[0m
[30;1m1318 | [0m[35m    def _execute_query(self, parsed:Dict[str,Any], user_ns:Dict[str,Any], result_set:ResultSet=None,[0m
[30;1m1319 | [0m[35m        query = parsed.get("query", "").strip()[0m
[30;1m1320 | [0m[35m        options = parsed.get("options", {})[0m
[30;1m1321 | [0m[35m[0m
[30;1m1322 | [0m[35m        suppress_results = options.get("suppress_results", False) and options.get("enable_suppress_r[0m
[30;1m1323 | [0m[35m        connection_string = parsed.get("connection_string")[0m

[31m--[ [0m[34mMatch #[0m[33m794[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1316 | [0m[35m[0m
[30;1m1317 | [0m[35m[0m
[30;1m1318 | [0m[35m    def _execute_query(self, parsed:Dict[str,Any], user_ns:Dict[str,Any], result_set:ResultSet=None,[0m
[30;1m1319 | [0m[35m        query = parsed.get("query", "").strip()[0m
[30;1m1320 | [0m[35m        options = parsed.get("options", {})[0m
[30;1m1321 | [0m[35m[0m
[30;1m1322 | [0m[35m        suppress_results = options.get("suppress_results", False) and options.get("enable_suppress_r[0m

[31m--[ [0m[34mMatch #[0m[33m795[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1298 | [0m[35m                seconds = now_time - self._discover_notebook_url_start_time[0m
[30;1m1299 | [0m[35m                if (seconds < 5):[0m
[30;1m1300 | [0m[35m                    time.sleep(5 - seconds)[0m
[30;1m1301 | [0m[35m                window_location = user_ns.get("NOTEBOOK_URL") or self.shell_user_ns.get("NOTEBOOK_UR[0m
[30;1m1302 | [0m[35m                if window_location is not None:[0m
[30;1m1303 | [0m[35m                    logger().debug(f"_add_help_to_jupyter_help_menu - got NOTEBOOK_URL value: {windo[0m
[30;1m1304 | [0m[35m                    if self.default_options.kernel_location == "auto":[0m

[31m--[ [0m[34mMatch #[0m[33m796[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1298 | [0m[35m                seconds = now_time - self._discover_notebook_url_start_time[0m
[30;1m1299 | [0m[35m                if (seconds < 5):[0m
[30;1m1300 | [0m[35m                    time.sleep(5 - seconds)[0m
[30;1m1301 | [0m[35m                window_location = user_ns.get("NOTEBOOK_URL") or self.shell_user_ns.get("NOTEBOOK_UR[0m
[30;1m1302 | [0m[35m                if window_location is not None:[0m
[30;1m1303 | [0m[35m                    logger().debug(f"_add_help_to_jupyter_help_menu - got NOTEBOOK_URL value: {windo[0m
[30;1m1304 | [0m[35m                    if self.default_options.kernel_location == "auto":[0m

[31m--[ [0m[34mMatch #[0m[33m797[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1272 | [0m[35m        [0m
[30;1m1273 | [0m[35m[0m
[30;1m1274 | [0m[35m    def _get_connection_info(self, **options)->List[str]:[0m
[30;1m1275 | [0m[35m        mode = options.get("show_conn_info")[0m
[30;1m1276 | [0m[35m        if mode == "list":[0m
[30;1m1277 | [0m[35m            return Connection.get_connection_list_formatted()[0m
[30;1m1278 | [0m[35m        elif mode == "current":[0m

[31m--[ [0m[34mMatch #[0m[33m798[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1160 | [0m[35m            values = None[0m
[30;1m1161 | [0m[35m[0m
[30;1m1162 | [0m[35m        connections_info = Connection.get_connections_info(values)[0m
[30;1m1163 | [0m[35m        return Display.to_json_styled_class(connections_info, style=options.get("json_display"), opt[0m
[30;1m1164 | [0m[35m[0m
[30;1m1165 | [0m[35m    [0m
[30;1m1166 | [0m[35m    def execute_help_on_options(self, topic:str)->MarkdownString:[0m

[31m--[ [0m[34mMatch #[0m[33m799[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1152 | [0m[35m        logger().debug(f"execute_conn_command - param: {param}")[0m
[30;1m1153 | [0m[35m        if param is None:[0m
[30;1m1154 | [0m[35m            connection_list = Connection.get_connection_list_formatted()[0m
[30;1m1155 | [0m[35m            return Display.to_json_styled_class(connection_list, style=options.get("json_display"), [0m
[30;1m1156 | [0m[35m            # return Connection.get_connection_list_formatted()[0m
[30;1m1157 | [0m[35m[0m
[30;1m1158 | [0m[35m        values = [v.strip() for v in param.split(sep=',')][0m

[31m--[ [0m[34mMatch #[0m[33m800[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1101 | [0m[35m        Display.showInfoMessage("\n".join(notebook_messages))[0m
[30;1m1102 | [0m[35m        Display.showInfoMessage(warning_message)[0m
[30;1m1103 | [0m[35m[0m
[30;1m1104 | [0m[35m        Display.show(Display.to_json_styled_class(info, style=options.get("json_display"), options=o[0m
[30;1m1105 | [0m[35m[0m
[30;1m1106 | [0m[35m[0m
[30;1m1107 | [0m[35m        url = None[0m

[31m--[ [0m[34mMatch #[0m[33m801[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1051 | [0m[35m            self.last_execution["error"] = str(exception)[0m
[30;1m1052 | [0m[35m            self.last_execution["traceback"] = traceback.format_exc().splitlines()[0m
[30;1m1053 | [0m[35m            logger().debug(f"Kqlmagic_core::execute - failed - command: {command} param: {param}")[0m
[30;1m1054 | [0m[35m            is_short_error = parsed.get("options", {}).get("short_errors") if parsed else self.defau[0m
[30;1m1055 | [0m[35m            if is_short_error:[0m
[30;1m1056 | [0m[35m                error_msg = f"{type(exception).__name__}: {exception}"[0m
[30;1m1057 | [0m[35m                Display.showDangerMessage(error_msg)[0m

[31m--[ [0m[34mMatch #[0m[33m802[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1051 | [0m[35m            self.last_execution["error"] = str(exception)[0m
[30;1m1052 | [0m[35m            self.last_execution["traceback"] = traceback.format_exc().splitlines()[0m
[30;1m1053 | [0m[35m            logger().debug(f"Kqlmagic_core::execute - failed - command: {command} param: {param}")[0m
[30;1m1054 | [0m[35m            is_short_error = parsed.get("options", {}).get("short_errors") if parsed else self.defau[0m
[30;1m1055 | [0m[35m            if is_short_error:[0m
[30;1m1056 | [0m[35m                error_msg = f"{type(exception).__name__}: {exception}"[0m
[30;1m1057 | [0m[35m                Display.showDangerMessage(error_msg)[0m

[31m--[ [0m[34mMatch #[0m[33m803[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1033 | [0m[35m                            html_obj = Display.get_show_window_html_obj(file_name, file_path, button[0m
[30;1m1034 | [0m[35m                            result = html_obj[0m
[30;1m1035 | [0m[35m[0m
[30;1m1036 | [0m[35m                    if options.get("suppress_results"):[0m
[30;1m1037 | [0m[35m                        result = None[0m
[30;1m1038 | [0m[35m[0m
[30;1m1039 | [0m[35m                    # options that were modified by --config command[0m

[31m--[ [0m[34mMatch #[0m[33m804[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m979 | [0m[35m                    elif options.get("popup_window"):[0m
[30;1m980 | [0m[35m                        html_str = None[0m
[30;1m981 | [0m[35m                        file_ext = None[0m
[30;1m982 | [0m[35m                        if True or options.get("notebook_app") in ["azuredatastudiosaw"]:[0m
[30;1m983 | [0m[35m                            if isinstance(result, MarkdownString):[0m
[30;1m984 | [0m[35m                                html_str  = result._force_repr_text_()[0m
[30;1m985 | [0m[35m                            # elif isinstance(result, "ResultSet"):[0m

[31m--[ [0m[34mMatch #[0m[33m805[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m976 | [0m[35m                        html_obj = Display.get_show_window_html_obj(result.name, file_path, result.b[0m
[30;1m977 | [0m[35m                        result = html_obj[0m
[30;1m978 | [0m[35m[0m
[30;1m979 | [0m[35m                    elif options.get("popup_window"):[0m
[30;1m980 | [0m[35m                        html_str = None[0m
[30;1m981 | [0m[35m                        file_ext = None[0m
[30;1m982 | [0m[35m                        if True or options.get("notebook_app") in ["azuredatastudiosaw"]:[0m

[31m--[ [0m[34mMatch #[0m[33m806[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m959 | [0m[35m                        result = Palettes(n_colors=n_colors, desaturation=desaturation)[0m
[30;1m960 | [0m[35m                        properties = [[0m
[30;1m961 | [0m[35m                            str(options.get("palette_colors")),[0m
[30;1m962 | [0m[35m                            str(options.get("palette_desaturation")),[0m
[30;1m963 | [0m[35m                        ][0m
[30;1m964 | [0m[35m                        param = hashlib.sha1(bytes("#".join(properties), "utf-8")).hexdigest()[0m
[30;1m965 | [0m[35m                        popup_text = ' '[0m

[31m--[ [0m[34mMatch #[0m[33m807[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m958 | [0m[35m                        desaturation = options.get("palette_desaturation")[0m
[30;1m959 | [0m[35m                        result = Palettes(n_colors=n_colors, desaturation=desaturation)[0m
[30;1m960 | [0m[35m                        properties = [[0m
[30;1m961 | [0m[35m                            str(options.get("palette_colors")),[0m
[30;1m962 | [0m[35m                            str(options.get("palette_desaturation")),[0m
[30;1m963 | [0m[35m                        ][0m
[30;1m964 | [0m[35m                        param = hashlib.sha1(bytes("#".join(properties), "utf-8")).hexdigest()[0m

[31m--[ [0m[34mMatch #[0m[33m808[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m955 | [0m[35m[0m
[30;1m956 | [0m[35m                    elif command == "palettes":[0m
[30;1m957 | [0m[35m                        n_colors = options.get("palette_colors")[0m
[30;1m958 | [0m[35m                        desaturation = options.get("palette_desaturation")[0m
[30;1m959 | [0m[35m                        result = Palettes(n_colors=n_colors, desaturation=desaturation)[0m
[30;1m960 | [0m[35m                        properties = [[0m
[30;1m961 | [0m[35m                            str(options.get("palette_colors")),[0m

[31m--[ [0m[34mMatch #[0m[33m809[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m954 | [0m[35m                        popup_text = pname if not pname.startswith("[") else "custom"[0m
[30;1m955 | [0m[35m[0m
[30;1m956 | [0m[35m                    elif command == "palettes":[0m
[30;1m957 | [0m[35m                        n_colors = options.get("palette_colors")[0m
[30;1m958 | [0m[35m                        desaturation = options.get("palette_desaturation")[0m
[30;1m959 | [0m[35m                        result = Palettes(n_colors=n_colors, desaturation=desaturation)[0m
[30;1m960 | [0m[35m                        properties = [[0m

[31m--[ [0m[34mMatch #[0m[33m810[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m950 | [0m[35m                            str(options.get("palette_reverse", False)),[0m
[30;1m951 | [0m[35m                        ][0m
[30;1m952 | [0m[35m                        param = hashlib.sha1(bytes("#".join(properties), "utf-8")).hexdigest()[0m
[30;1m953 | [0m[35m                        pname = options.get("palette_name")[0m
[30;1m954 | [0m[35m                        popup_text = pname if not pname.startswith("[") else "custom"[0m
[30;1m955 | [0m[35m[0m
[30;1m956 | [0m[35m                    elif command == "palettes":[0m

[31m--[ [0m[34mMatch #[0m[33m811[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m947 | [0m[35m                            options.get("palette_name"), [0m
[30;1m948 | [0m[35m                            str(options.get("palette_colors")),[0m
[30;1m949 | [0m[35m                            str(options.get("palette_desaturation")),[0m
[30;1m950 | [0m[35m                            str(options.get("palette_reverse", False)),[0m
[30;1m951 | [0m[35m                        ][0m
[30;1m952 | [0m[35m                        param = hashlib.sha1(bytes("#".join(properties), "utf-8")).hexdigest()[0m
[30;1m953 | [0m[35m                        pname = options.get("palette_name")[0m

[31m--[ [0m[34mMatch #[0m[33m812[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m946 | [0m[35m                        properties = [[0m
[30;1m947 | [0m[35m                            options.get("palette_name"), [0m
[30;1m948 | [0m[35m                            str(options.get("palette_colors")),[0m
[30;1m949 | [0m[35m                            str(options.get("palette_desaturation")),[0m
[30;1m950 | [0m[35m                            str(options.get("palette_reverse", False)),[0m
[30;1m951 | [0m[35m                        ][0m
[30;1m952 | [0m[35m                        param = hashlib.sha1(bytes("#".join(properties), "utf-8")).hexdigest()[0m

[31m--[ [0m[34mMatch #[0m[33m813[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m945 | [0m[35m                        )[0m
[30;1m946 | [0m[35m                        properties = [[0m
[30;1m947 | [0m[35m                            options.get("palette_name"), [0m
[30;1m948 | [0m[35m                            str(options.get("palette_colors")),[0m
[30;1m949 | [0m[35m                            str(options.get("palette_desaturation")),[0m
[30;1m950 | [0m[35m                            str(options.get("palette_reverse", False)),[0m
[30;1m951 | [0m[35m                        ][0m

[31m--[ [0m[34mMatch #[0m[33m814[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m944 | [0m[35m                            to_reverse=options.get("palette_reverse", False),[0m
[30;1m945 | [0m[35m                        )[0m
[30;1m946 | [0m[35m                        properties = [[0m
[30;1m947 | [0m[35m                            options.get("palette_name"), [0m
[30;1m948 | [0m[35m                            str(options.get("palette_colors")),[0m
[30;1m949 | [0m[35m                            str(options.get("palette_desaturation")),[0m
[30;1m950 | [0m[35m                            str(options.get("palette_reverse", False)),[0m

[31m--[ [0m[34mMatch #[0m[33m815[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m941 | [0m[35m                            palette_name=options.get("palette_name"),[0m
[30;1m942 | [0m[35m                            n_colors=options.get("palette_colors"),[0m
[30;1m943 | [0m[35m                            desaturation=options.get("palette_desaturation"),[0m
[30;1m944 | [0m[35m                            to_reverse=options.get("palette_reverse", False),[0m
[30;1m945 | [0m[35m                        )[0m
[30;1m946 | [0m[35m                        properties = [[0m
[30;1m947 | [0m[35m                            options.get("palette_name"), [0m

[31m--[ [0m[34mMatch #[0m[33m816[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m940 | [0m[35m                        result = Palette([0m
[30;1m941 | [0m[35m                            palette_name=options.get("palette_name"),[0m
[30;1m942 | [0m[35m                            n_colors=options.get("palette_colors"),[0m
[30;1m943 | [0m[35m                            desaturation=options.get("palette_desaturation"),[0m
[30;1m944 | [0m[35m                            to_reverse=options.get("palette_reverse", False),[0m
[30;1m945 | [0m[35m                        )[0m
[30;1m946 | [0m[35m                        properties = [[0m

[31m--[ [0m[34mMatch #[0m[33m817[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m939 | [0m[35m                    elif command == "palette":[0m
[30;1m940 | [0m[35m                        result = Palette([0m
[30;1m941 | [0m[35m                            palette_name=options.get("palette_name"),[0m
[30;1m942 | [0m[35m                            n_colors=options.get("palette_colors"),[0m
[30;1m943 | [0m[35m                            desaturation=options.get("palette_desaturation"),[0m
[30;1m944 | [0m[35m                            to_reverse=options.get("palette_reverse", False),[0m
[30;1m945 | [0m[35m                        )[0m

[31m--[ [0m[34mMatch #[0m[33m818[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m938 | [0m[35m                        result = self.execute_clear_sso_db_command()[0m
[30;1m939 | [0m[35m                    elif command == "palette":[0m
[30;1m940 | [0m[35m                        result = Palette([0m
[30;1m941 | [0m[35m                            palette_name=options.get("palette_name"),[0m
[30;1m942 | [0m[35m                            n_colors=options.get("palette_colors"),[0m
[30;1m943 | [0m[35m                            desaturation=options.get("palette_desaturation"),[0m
[30;1m944 | [0m[35m                            to_reverse=options.get("palette_reverse", False),[0m

[31m--[ [0m[34mMatch #[0m[33m819[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m906 | [0m[35m                    result = self.execute_schema_command(param, user_ns, **options)[0m
[30;1m907 | [0m[35m                    [0m
[30;1m908 | [0m[35m                else:[0m
[30;1m909 | [0m[35m                    params = parsed["command"].get("params")[0m
[30;1m910 | [0m[35m                    param = None if len(params) == 0 else params[0][0m
[30;1m911 | [0m[35m                    if command == "version":[0m
[30;1m912 | [0m[35m                        result = execute_version_command()[0m

[31m--[ [0m[34mMatch #[0m[33m820[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m901 | [0m[35m                    result = IPythonAPI.run_cell_magic(magic, line, cell)[0m
[30;1m902 | [0m[35m[0m
[30;1m903 | [0m[35m                elif command == "schema":[0m
[30;1m904 | [0m[35m                    params = parsed["command"].get("params")[0m
[30;1m905 | [0m[35m                    param = None if len(params) == 0 else params[0][0m
[30;1m906 | [0m[35m                    result = self.execute_schema_command(param, user_ns, **options)[0m
[30;1m907 | [0m[35m                    [0m

[31m--[ [0m[34mMatch #[0m[33m821[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m897 | [0m[35m                elif command == "cell_magic":[0m
[30;1m898 | [0m[35m                    line = parsed["command"].get("params")[0][0m
[30;1m899 | [0m[35m                    cell = parsed["command"].get("params")[1][0m
[30;1m900 | [0m[35m                    magic = parsed["command"].get("params")[2][0m
[30;1m901 | [0m[35m                    result = IPythonAPI.run_cell_magic(magic, line, cell)[0m
[30;1m902 | [0m[35m[0m
[30;1m903 | [0m[35m                elif command == "schema":[0m

[31m--[ [0m[34mMatch #[0m[33m822[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m896 | [0m[35m[0m
[30;1m897 | [0m[35m                elif command == "cell_magic":[0m
[30;1m898 | [0m[35m                    line = parsed["command"].get("params")[0][0m
[30;1m899 | [0m[35m                    cell = parsed["command"].get("params")[1][0m
[30;1m900 | [0m[35m                    magic = parsed["command"].get("params")[2][0m
[30;1m901 | [0m[35m                    result = IPythonAPI.run_cell_magic(magic, line, cell)[0m
[30;1m902 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m823[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m895 | [0m[35m                    result = IPythonAPI.run_line_magic(magic, body)[0m
[30;1m896 | [0m[35m[0m
[30;1m897 | [0m[35m                elif command == "cell_magic":[0m
[30;1m898 | [0m[35m                    line = parsed["command"].get("params")[0][0m
[30;1m899 | [0m[35m                    cell = parsed["command"].get("params")[1][0m
[30;1m900 | [0m[35m                    magic = parsed["command"].get("params")[2][0m
[30;1m901 | [0m[35m                    result = IPythonAPI.run_cell_magic(magic, line, cell)[0m

[31m--[ [0m[34mMatch #[0m[33m824[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m891 | [0m[35m[0m
[30;1m892 | [0m[35m                elif command == "line_magic":[0m
[30;1m893 | [0m[35m                    body = parsed["command"].get("params")[0][0m
[30;1m894 | [0m[35m                    magic = parsed["command"].get("params")[1][0m
[30;1m895 | [0m[35m                    result = IPythonAPI.run_line_magic(magic, body)[0m
[30;1m896 | [0m[35m[0m
[30;1m897 | [0m[35m                elif command == "cell_magic":[0m

[31m--[ [0m[34mMatch #[0m[33m825[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m890 | [0m[35m                        result.show_result(is_last_query=parsed.get("last_query") and self.execution[0m
[30;1m891 | [0m[35m[0m
[30;1m892 | [0m[35m                elif command == "line_magic":[0m
[30;1m893 | [0m[35m                    body = parsed["command"].get("params")[0][0m
[30;1m894 | [0m[35m                    magic = parsed["command"].get("params")[1][0m
[30;1m895 | [0m[35m                    result = IPythonAPI.run_line_magic(magic, body)[0m
[30;1m896 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m826[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m887 | [0m[35m                    if type(result) == ResultSet and parsed.get("last_query"):[0m
[30;1m888 | [0m[35m                        # can't just return result as is, it fails when used with table package pand[0m
[30;1m889 | [0m[35m                        # it will first show the result, and will suppres show by result._repr_html[0m
[30;1m890 | [0m[35m                        result.show_result(is_last_query=parsed.get("last_query") and self.execution[0m
[30;1m891 | [0m[35m[0m
[30;1m892 | [0m[35m                elif command == "line_magic":[0m
[30;1m893 | [0m[35m                    body = parsed["command"].get("params")[0][0m

[31m--[ [0m[34mMatch #[0m[33m827[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m884 | [0m[35m                    ns = user_ns if py_access == "pyro" else self.shell_user_ns[0m
[30;1m885 | [0m[35m                    code = params[0][0m
[30;1m886 | [0m[35m                    result = execute_python_command(code, ns, **options)[0m
[30;1m887 | [0m[35m                    if type(result) == ResultSet and parsed.get("last_query"):[0m
[30;1m888 | [0m[35m                        # can't just return result as is, it fails when used with table package pand[0m
[30;1m889 | [0m[35m                        # it will first show the result, and will suppres show by result._repr_html[0m
[30;1m890 | [0m[35m                        result.show_result(is_last_query=parsed.get("last_query") and self.execution[0m

[31m--[ [0m[34mMatch #[0m[33m828[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m879 | [0m[35m                        result.show_result(is_last_query=parsed.get("last_query") and self.execution[0m
[30;1m880 | [0m[35m[0m
[30;1m881 | [0m[35m                elif command == "python":[0m
[30;1m882 | [0m[35m                    params = parsed["command"].get("params") or ["", "pyro"][0m
[30;1m883 | [0m[35m                    py_access = params[1][0m
[30;1m884 | [0m[35m                    ns = user_ns if py_access == "pyro" else self.shell_user_ns[0m
[30;1m885 | [0m[35m                    code = params[0][0m

[31m--[ [0m[34mMatch #[0m[33m829[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m876 | [0m[35m                    if type(result) == ResultSet:[0m
[30;1m877 | [0m[35m                        # can't just return result as is, it fails when used with table package pand[0m
[30;1m878 | [0m[35m                        # it will first show the result, and will suppres show by result._repr_html[0m
[30;1m879 | [0m[35m                        result.show_result(is_last_query=parsed.get("last_query") and self.execution[0m
[30;1m880 | [0m[35m[0m
[30;1m881 | [0m[35m                elif command == "python":[0m
[30;1m882 | [0m[35m                    params = parsed["command"].get("params") or ["", "pyro"][0m

[31m--[ [0m[34mMatch #[0m[33m830[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m865 | [0m[35m                if type(override_connection) is str:[0m
[30;1m866 | [0m[35m                    parsed["connection_string"] = override_connection[0m
[30;1m867 | [0m[35m                options = parsed["options"][0m
[30;1m868 | [0m[35m                command = parsed["command"].get("command")[0m
[30;1m869 | [0m[35m[0m
[30;1m870 | [0m[35m                self._add_help_to_jupyter_help_menu(user_ns, options=options)[0m
[30;1m871 | [0m[35m                self._set_temp_files_server(options=options)[0m

[31m--[ [0m[34mMatch #[0m[33m831[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m821 | [0m[35m        """[0m
[30;1m822 | [0m[35m        local_ns = local_ns or {}[0m
[30;1m823 | [0m[35m        self.execution_depth += 1[0m
[30;1m824 | [0m[35m        if self.last_execution is not None and self.last_execution.get("log") is None:[0m
[30;1m825 | [0m[35m            log_messages = logger().getCurrentLogMessages()[0m
[30;1m826 | [0m[35m            self.last_execution["log"] = log_messages[0m
[30;1m827 | [0m[35m        logger().resetCurrentLogMessages()[0m

[31m--[ [0m[34mMatch #[0m[33m832[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m686 | [0m[35m    def _start_temp_files_server(self, options:Dict[str,Any]=None)->None:[0m
[30;1m687 | [0m[35m        options = options or {}[0m
[30;1m688 | [0m[35m        self.is_temp_files_server_on = False[0m
[30;1m689 | [0m[35m        if self.temp_files_server_manager is None and options.get("temp_folder_name") is not None:[0m
[30;1m690 | [0m[35m            server_py_path = get_env_var(f"{Constants.MAGIC_CLASS_NAME_UPPER}_TEMP_FILES_SERVER_PY_F[0m
[30;1m691 | [0m[35m            if server_py_path is None:[0m
[30;1m692 | [0m[35m                import Kqlmagic as kqlmagic[0m

[31m--[ [0m[34mMatch #[0m[33m833[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m676 | [0m[35m        if (options.get("temp_files_server") == "kqlmagic"[0m
[30;1m677 | [0m[35m            or (options.get('notebook_app') in ["visualstudiocode", "azuredatastudio", "azuredatastu[0m
[30;1m678 | [0m[35m                and options.get("kernel_location") == "local"[0m
[30;1m679 | [0m[35m                and options.get("temp_files_server") == "auto")):[0m
[30;1m680 | [0m[35m            if self.is_temp_files_server_on is None:[0m
[30;1m681 | [0m[35m                self._start_temp_files_server(options=options)[0m
[30;1m682 | [0m[35m        elif self.is_temp_files_server_on is True:[0m

[31m--[ [0m[34mMatch #[0m[33m834[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m675 | [0m[35m        options = options or {}[0m
[30;1m676 | [0m[35m        if (options.get("temp_files_server") == "kqlmagic"[0m
[30;1m677 | [0m[35m            or (options.get('notebook_app') in ["visualstudiocode", "azuredatastudio", "azuredatastu[0m
[30;1m678 | [0m[35m                and options.get("kernel_location") == "local"[0m
[30;1m679 | [0m[35m                and options.get("temp_files_server") == "auto")):[0m
[30;1m680 | [0m[35m            if self.is_temp_files_server_on is None:[0m
[30;1m681 | [0m[35m                self._start_temp_files_server(options=options)[0m

[31m--[ [0m[34mMatch #[0m[33m835[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m674 | [0m[35m    def _set_temp_files_server(self, options:Dict[str,Any]=None)->None:[0m
[30;1m675 | [0m[35m        options = options or {}[0m
[30;1m676 | [0m[35m        if (options.get("temp_files_server") == "kqlmagic"[0m
[30;1m677 | [0m[35m            or (options.get('notebook_app') in ["visualstudiocode", "azuredatastudio", "azuredatastu[0m
[30;1m678 | [0m[35m                and options.get("kernel_location") == "local"[0m
[30;1m679 | [0m[35m                and options.get("temp_files_server") == "auto")):[0m
[30;1m680 | [0m[35m            if self.is_temp_files_server_on is None:[0m

[31m--[ [0m[34mMatch #[0m[33m836[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m673 | [0m[35m[0m
[30;1m674 | [0m[35m    def _set_temp_files_server(self, options:Dict[str,Any]=None)->None:[0m
[30;1m675 | [0m[35m        options = options or {}[0m
[30;1m676 | [0m[35m        if (options.get("temp_files_server") == "kqlmagic"[0m
[30;1m677 | [0m[35m            or (options.get('notebook_app') in ["visualstudiocode", "azuredatastudio", "azuredatastu[0m
[30;1m678 | [0m[35m                and options.get("kernel_location") == "local"[0m
[30;1m679 | [0m[35m                and options.get("temp_files_server") == "auto")):[0m

[31m--[ [0m[34mMatch #[0m[33m837[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m645 | [0m[35m                    data_decoded = bytes_reader.read().decode('utf-8')[0m
[30;1m646 | [0m[35m                data_as_markdown = MarkdownString(data_decoded, title=f"what's new")[0m
[30;1m647 | [0m[35m                file_ext = None[0m
[30;1m648 | [0m[35m                if options.get("notebook_app") in ["azuredatastudiosaw"]:[0m
[30;1m649 | [0m[35m                    html_str  = data_as_markdown._force_repr_text_()[0m
[30;1m650 | [0m[35m                    file_ext = "txt"[0m
[30;1m651 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m838[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m636 | [0m[35m[0m
[30;1m637 | [0m[35m[0m
[30;1m638 | [0m[35m    def _show_what_new(self, options:Dict[str,Any])->None:[0m
[30;1m639 | [0m[35m        if options.get("show_what_new"):[0m
[30;1m640 | [0m[35m            try:[0m
[30;1m641 | [0m[35m                logger().debug("Kqlmagic_core::_show_what_new - fetch HISTORY.md")[0m
[30;1m642 | [0m[35m                # What's new (history.md)  button #[0m

[31m--[ [0m[34mMatch #[0m[33m839[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m603 | [0m[35m[0m
[30;1m604 | [0m[35m[0m
[30;1m605 | [0m[35m    def _show_magic_latest_version(self, **options)->None:[0m
[30;1m606 | [0m[35m        if options.get("check_magic_version"):[0m
[30;1m607 | [0m[35m            try:[0m
[30;1m608 | [0m[35m                logger().debug("Kqlmagic_core::_show_magic_latest_version - fetch PyPi Kqlmagic late[0m
[30;1m609 | [0m[35m                pypi_latest_version, pypi_stable_version = get_pypi_latest_version(Constants.MAGIC_P[0m

[31m--[ [0m[34mMatch #[0m[33m840[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m533 | [0m[35m    def _add_kql_ref_to_help(self, **options)->None:[0m
[30;1m534 | [0m[35m        # add help k[0m
[30;1m535 | [0m[35m        if options.get('notebook_app') != "ipython":[0m
[30;1m536 | [0m[35m            add_kql_ref_to_help = options.get("add_kql_ref_to_help")[0m
[30;1m537 | [0m[35m            if add_kql_ref_to_help:[0m
[30;1m538 | [0m[35m                logger().debug("Kqlmagic::__init__ - add kql reference to help menu")[0m
[30;1m539 | [0m[35m                Help_html.add_menu_item("kql Reference", _KQL_URL, **options)[0m

[31m--[ [0m[34mMatch #[0m[33m841[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m532 | [0m[35m[0m
[30;1m533 | [0m[35m    def _add_kql_ref_to_help(self, **options)->None:[0m
[30;1m534 | [0m[35m        # add help k[0m
[30;1m535 | [0m[35m        if options.get('notebook_app') != "ipython":[0m
[30;1m536 | [0m[35m            add_kql_ref_to_help = options.get("add_kql_ref_to_help")[0m
[30;1m537 | [0m[35m            if add_kql_ref_to_help:[0m
[30;1m538 | [0m[35m                logger().debug("Kqlmagic::__init__ - add kql reference to help menu")[0m

[31m--[ [0m[34mMatch #[0m[33m842[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m392 | [0m[35m                kernel_location = "local"[0m
[30;1m393 | [0m[35m            elif kernel_location == "auto":[0m
[30;1m394 | [0m[35m                app_info = self.get_app_from_parent()[0m
[30;1m395 | [0m[35m                kernel_location = app_info.get("kernel_location", kernel_location)[0m
[30;1m396 | [0m[35m            if kernel_location == "auto":           [0m
[30;1m397 | [0m[35m                if app in ["azurenotebook", "azureml", "azuremljupyternotebook", "azuremljupyterlab"[0m
[30;1m398 | [0m[35m                    kernel_location = "remote"[0m

[31m--[ [0m[34mMatch #[0m[33m843[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m358 | [0m[35m            if app == "auto":[0m
[30;1m359 | [0m[35m                app_info = self.get_app_from_parent()[0m
[30;1m360 | [0m[35m                app = app_info.get("app", app)[0m
[30;1m361 | [0m[35m                _kernel_location = _kernel_location or app_info.get("kernel_location")[0m
[30;1m362 | [0m[35m[0m
[30;1m363 | [0m[35m            if app == "auto":[0m
[30;1m364 | [0m[35m                if (is_env_var("VSCODE_LOG_STACK") [0m

[31m--[ [0m[34mMatch #[0m[33m844[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m357 | [0m[35m[0m
[30;1m358 | [0m[35m            if app == "auto":[0m
[30;1m359 | [0m[35m                app_info = self.get_app_from_parent()[0m
[30;1m360 | [0m[35m                app = app_info.get("app", app)[0m
[30;1m361 | [0m[35m                _kernel_location = _kernel_location or app_info.get("kernel_location")[0m
[30;1m362 | [0m[35m[0m
[30;1m363 | [0m[35m            if app == "auto":[0m

[31m--[ [0m[34mMatch #[0m[33m845[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m288 | [0m[35m            # root_path = "C:\\Users\\michabin\\Desktop\\nteract-notebooks"[0m
[30;1m289 | [0m[35m            #[0m
[30;1m290 | [0m[35m            # add subfolder per kernel_id[0m
[30;1m291 | [0m[35m            kernel_id = options.get("kernel_id")[0m
[30;1m292 | [0m[35m            folder_name = f"{folder_name}/{kernel_id}"[0m
[30;1m293 | [0m[35m[0m
[30;1m294 | [0m[35m            showfiles_folder_Full_name = adjust_path(f"{root_path}/{folder_name}")  # dont remove sp[0m

[31m--[ [0m[34mMatch #[0m[33m846[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m279 | [0m[35m        folder_name = options.get("temp_folder_name")[0m
[30;1m280 | [0m[35m        if folder_name is not None:[0m
[30;1m281 | [0m[35m            folder_name = f"{Constants.MAGIC_CLASS_NAME_LOWER}/{folder_name}"[0m
[30;1m282 | [0m[35m            if options.get("temp_folder_location") == "user_dir":[0m
[30;1m283 | [0m[35m                # app that has a free/tree build server, are not supporting directories athat starts[0m
[30;1m284 | [0m[35m                folder_name = f".{folder_name}"[0m
[30;1m285 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m847[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m276 | [0m[35m[0m
[30;1m277 | [0m[35m[0m
[30;1m278 | [0m[35m    def _set_temp_files_folder(self, **options)->None:[0m
[30;1m279 | [0m[35m        folder_name = options.get("temp_folder_name")[0m
[30;1m280 | [0m[35m        if folder_name is not None:[0m
[30;1m281 | [0m[35m            folder_name = f"{Constants.MAGIC_CLASS_NAME_LOWER}/{folder_name}"[0m
[30;1m282 | [0m[35m            if options.get("temp_folder_location") == "user_dir":[0m

[31m--[ [0m[34mMatch #[0m[33m848[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m251 | [0m[35m            Dependencies.warn_missing_dependencies(options=options)[0m
[30;1m252 | [0m[35m[0m
[30;1m253 | [0m[35m        logger().debug("Kqlmagic_core::_start - warn missing env variables")[0m
[30;1m254 | [0m[35m        if options.get("warn_missing_env_variables"):[0m
[30;1m255 | [0m[35m            Dependencies.warn_missing_env_variables(options=options)[0m
[30;1m256 | [0m[35m[0m
[30;1m257 | [0m[35m        logger().debug("Kqlmagic_core::_start - set default connection")[0m

[31m--[ [0m[34mMatch #[0m[33m849[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m247 | [0m[35m            self._show_banner(options)[0m
[30;1m248 | [0m[35m[0m
[30;1m249 | [0m[35m        logger().debug("Kqlmagic_core::_start - warn missing modules")[0m
[30;1m250 | [0m[35m        if options.get("warn_missing_dependencies"):[0m
[30;1m251 | [0m[35m            Dependencies.warn_missing_dependencies(options=options)[0m
[30;1m252 | [0m[35m[0m
[30;1m253 | [0m[35m        logger().debug("Kqlmagic_core::_start - warn missing env variables")[0m

[31m--[ [0m[34mMatch #[0m[33m850[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m243 | [0m[35m        self._add_help_to_jupyter_help_menu(None, start_time=time.time(), options=options)[0m
[30;1m244 | [0m[35m[0m
[30;1m245 | [0m[35m        logger().debug("Kqlmagic_core::_start - show banner")[0m
[30;1m246 | [0m[35m        if options.get("show_init_banner"):[0m
[30;1m247 | [0m[35m            self._show_banner(options)[0m
[30;1m248 | [0m[35m[0m
[30;1m249 | [0m[35m        logger().debug("Kqlmagic_core::_start - warn missing modules")[0m

[31m--[ [0m[34mMatch #[0m[33m851[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m191 | [0m[35m            return html_obj[0m
[30;1m192 | [0m[35m        else:[0m
[30;1m193 | [0m[35m            schema_tree = Database_html.get_schema_tree(engine, **_options)[0m
[30;1m194 | [0m[35m            return Display.to_json_styled_class(schema_tree, style=options.get("schema_json_display"[0m
[30;1m195 | [0m[35m[0m
[30;1m196 | [0m[35m    # [KUSTO][0m
[30;1m197 | [0m[35m    # Driver          = Easysoft ODBC-SQL Server[0m

[31m--[ [0m[34mMatch #[0m[33m852[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m182 | [0m[35m        connection_string = _options.pop("conn", None) or connection_string[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m        engine = Connection.get_engine(connection_string, user_ns, **_options)[0m
[30;1m185 | [0m[35m        if _options.get("popup_window"):[0m
[30;1m186 | [0m[35m            schema_file_path  = Database_html.get_schema_file_path(engine, **_options)[0m
[30;1m187 | [0m[35m            conn_name = engine.kql_engine.get_conn_name() if isinstance(engine, CacheEngine) else en[0m
[30;1m188 | [0m[35m            button_text = f"popup schema {conn_name}"[0m

[31m--[ [0m[34mMatch #[0m[33m853[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m777 | [0m[35m[0m
[30;1m778 | [0m[35m            %%kql myDatabase@myCluster[0m
[30;1m779 | [0m[35m            <KQL statement>[0m
[30;1m780 | [0m[35m            # Note: submit query using using an established kusto connection to myDatabase database [0m
[30;1m781 | [0m[35m[0m
[30;1m782 | [0m[35m            %%kql appinsights://appid('myAppid').appkey('myAppkey')[0m
[30;1m783 | [0m[35m            <KQL statement>[0m

[31m--[ [0m[34mMatch #[0m[33m854[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m298 | [0m[35m                logger().debug(f"Kqlmagic_core::_set_temp_files_folder - makedir({showfiles_folder_F[0m
[30;1m299 | [0m[35m                os.makedirs(showfiles_folder_Full_name)[0m
[30;1m300 | [0m[35m[0m
[30;1m301 | [0m[35m            # kernel will remove folder at shutdown or by restart[0m
[30;1m302 | [0m[35m            IPythonAPI.try_add_to_ipython_tempdirs(showfiles_folder_Full_name, **options)[0m
[30;1m303 | [0m[35m[0m
[30;1m304 | [0m[35m            Display.showfiles_file_base_path = adjust_path_to_uri(root_path)[0m

[31m--[ [0m[34mMatch #[0m[33m855[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m115 | [0m[35m                        is_disabled_msg = " and disabled"[0m
[30;1m116 | [0m[35m                    else:[0m
[30;1m117 | [0m[35m                        is_disabled_msg = ""[0m
[30;1m118 | [0m[35m                    return MarkdownString(f"{Constants.MAGIC_PACKAGE_NAME} cache **'{cache_name}'** [0m
[30;1m119 | [0m[35m                else:[0m
[30;1m120 | [0m[35m                    raise ValueError(f"cache '{cache_name} wasn't found")[0m
[30;1m121 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m856[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m106 | [0m[35m                is_created = CacheClient.create_or_attach_cache(cache_name, **options)[0m
[30;1m107 | [0m[35m                self.default_options.set_trait("cache", cache_name, force=True)[0m
[30;1m108 | [0m[35m                is_created_msg = "created and " if is_created else ""[0m
[30;1m109 | [0m[35m                return MarkdownString(f"{Constants.MAGIC_PACKAGE_NAME} caching query results to **'{[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m            elif command_name =="cache_remove":[0m
[30;1m112 | [0m[35m                if was_removed:[0m

[31m--[ [0m[34mMatch #[0m[33m857[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1606 | [0m[35m                val = self.obfuscate_string(val, "trytoken", kv)[0m
[30;1m1607 | [0m[35m                env[var] = val[0m
[30;1m1608 | [0m[35m[0m
[30;1m1609 | [0m[35m        return env[0m
[30;1m1610 | [0m[35m[0m
[30;1m1611 | [0m[35m[0m
[30;1m1612 | [0m[35m    def obfuscate_options(self)->dict:[0m

[31m--[ [0m[34mMatch #[0m[33m858[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1574 | [0m[35m            [0m
[30;1m1575 | [0m[35m[0m
[30;1m1576 | [0m[35m    def obfuscate_default_env(self)->dict:[0m
[30;1m1577 | [0m[35m        env = {var: os.getenv(var) for var in os.environ if var.startswith(Constants.MAGIC_CLASS_NAM[0m
[30;1m1578 | [0m[35m        for var in env:[0m
[30;1m1579 | [0m[35m            if var  == f"{Constants.MAGIC_CLASS_NAME_UPPER}_CONNECTION_STR":[0m
[30;1m1580 | [0m[35m                val = env[var][0m

[31m--[ [0m[34mMatch #[0m[33m859[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m662 | [0m[35m                        file_path, [0m
[30;1m663 | [0m[35m                        button_text=button_text, [0m
[30;1m664 | [0m[35m                        onclick_visibility="visible", [0m
[30;1m665 | [0m[35m                        before_text=f"Click to find out what's new in {Constants.MAGIC_PACKAGE_NAME}[0m
[30;1m666 | [0m[35m                        palette=Display.info_style, [0m
[30;1m667 | [0m[35m                        **options[0m
[30;1m668 | [0m[35m                    )[0m

[31m--[ [0m[34mMatch #[0m[33m860[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m250 | [0m[35m        if options.get("warn_missing_dependencies"):[0m
[30;1m251 | [0m[35m            Dependencies.warn_missing_dependencies(options=options)[0m
[30;1m252 | [0m[35m[0m
[30;1m253 | [0m[35m        logger().debug("Kqlmagic_core::_start - warn missing env variables")[0m
[30;1m254 | [0m[35m        if options.get("warn_missing_env_variables"):[0m
[30;1m255 | [0m[35m            Dependencies.warn_missing_env_variables(options=options)[0m
[30;1m256 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m861[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic_core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mimport os[0m
[30;1m8 | [0m[35mimport sys[0m
[30;1m9 | [0m[35mimport platform[0m
[30;1m10 | [0m[35mimport time[0m
[30;1m11 | [0m[35mimport json[0m
[30;1m12 | [0m[35mimport hashlib[0m
[30;1m13 | [0m[35mimport urllib.parse[0m

[31m--[ [0m[34mMatch #[0m[33m862[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/dict_db_storage.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m117 | [0m[35m            return[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m        try:[0m
[30;1m120 | [0m[35m            value = self._crypto_obj.decrypt(state_encrypted.get("data"))[0m
[30;1m121 | [0m[35m            return value[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m        except: # pylint: disable=bare-except[0m

[31m--[ [0m[34mMatch #[0m[33m863[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/dict_db_storage.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m112 | [0m[35m        if self.db_key_conflict:[0m
[30;1m113 | [0m[35m            return[0m
[30;1m114 | [0m[35m        [0m
[30;1m115 | [0m[35m        state_encrypted = self.db.get(self.db_key)[0m
[30;1m116 | [0m[35m        if not state_encrypted:[0m
[30;1m117 | [0m[35m            return[0m
[30;1m118 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m864[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/dict_db_storage.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m                state_encrypted = db_value[0m
[30;1m73 | [0m[35m                if not state_encrypted:[0m
[30;1m74 | [0m[35m                    continue[0m
[30;1m75 | [0m[35m                time_created = state_encrypted.get("timestamp")[0m
[30;1m76 | [0m[35m                logger().debug(f"DictDbStorage::time_created {time_created}  timedelta(seconds=self.[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m                if (time_created + timedelta(seconds=self.gc_ttl_in_secs)) < datetime.utcnow():[0m

[31m--[ [0m[34mMatch #[0m[33m865[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/dict_db_storage.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m            Constants.SSO_DB_KEY_PREFIX,[0m
[30;1m43 | [0m[35m            sso_options.get(SsoStorageParam.CACHE_NAME, Constants.SSO_DEFAULT_CACHE_NAME)[0m
[30;1m44 | [0m[35m        ][0m
[30;1m45 | [0m[35m        crypto_obj = sso_options.get(SsoStorageParam.CRYPTO_OBJ)[0m
[30;1m46 | [0m[35m        if crypto_obj and crypto_obj.suffix:[0m
[30;1m47 | [0m[35m            path_args.append(crypto_obj.suffix)[0m
[30;1m48 | [0m[35m        db_key_prefix = os.path.join(*path_args)[0m

[31m--[ [0m[34mMatch #[0m[33m866[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/dict_db_storage.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m        path_args = [[0m
[30;1m42 | [0m[35m            Constants.SSO_DB_KEY_PREFIX,[0m
[30;1m43 | [0m[35m            sso_options.get(SsoStorageParam.CACHE_NAME, Constants.SSO_DEFAULT_CACHE_NAME)[0m
[30;1m44 | [0m[35m        ][0m
[30;1m45 | [0m[35m        crypto_obj = sso_options.get(SsoStorageParam.CRYPTO_OBJ)[0m
[30;1m46 | [0m[35m        if crypto_obj and crypto_obj.suffix:[0m

[31m--[ [0m[34mMatch #[0m[33m867[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/dict_db_storage.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m24 | [0m[35m        self.gc_ttl_in_secs = sso_options.get(SsoStorageParam.GC_TTL_IN_SECS, 0)[0m
[30;1m25 | [0m[35m        DictDbStorage.last_clear_time = DictDbStorage.last_clear_time or (datetime.utcnow() - timede[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m        self._crypto_obj = sso_options.get(SsoStorageParam.CRYPTO_OBJ)[0m
[30;1m28 | [0m[35m        self._db_key_prefix = self._get_db_key_prefix(sso_options)[0m
[30;1m29 | [0m[35m        self.db_key = self._get_db_key(self._db_key_prefix, self.cache_selector_key)[0m
[30;1m30 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m868[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/dict_db_storage.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m21 | [0m[35m    def __init__(self, db:Dict[str,str], sso_options:Dict[str,Any], state:str=None)->None:[0m
[30;1m22 | [0m[35m        self.cache_selector_key = sso_options.get(SsoStorageParam.CACHE_SELECTOR_KEY)[0m
[30;1m23 | [0m[35m        self.db = db or {}[0m
[30;1m24 | [0m[35m        self.gc_ttl_in_secs = sso_options.get(SsoStorageParam.GC_TTL_IN_SECS, 0)[0m
[30;1m25 | [0m[35m        DictDbStorage.last_clear_time = DictDbStorage.last_clear_time or (datetime.utcnow() - timede[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m        self._crypto_obj = sso_options.get(SsoStorageParam.CRYPTO_OBJ)[0m

[31m--[ [0m[34mMatch #[0m[33m869[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/dict_db_storage.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m19 | [0m[35m    last_clear_time = None[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m    def __init__(self, db:Dict[str,str], sso_options:Dict[str,Any], state:str=None)->None:[0m
[30;1m22 | [0m[35m        self.cache_selector_key = sso_options.get(SsoStorageParam.CACHE_SELECTOR_KEY)[0m
[30;1m23 | [0m[35m        self.db = db or {}[0m
[30;1m24 | [0m[35m        self.gc_ttl_in_secs = sso_options.get(SsoStorageParam.GC_TTL_IN_SECS, 0)[0m
[30;1m25 | [0m[35m        DictDbStorage.last_clear_time = DictDbStorage.last_clear_time or (datetime.utcnow() - timede[0m

[31m--[ [0m[34mMatch #[0m[33m870[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/log.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m109 | [0m[35m        formatted = ""[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m        if self.log_context:[0m
[30;1m112 | [0m[35m            correlation_id = self.log_context.get("correlation_id")[0m
[30;1m113 | [0m[35m            if correlation_id:[0m
[30;1m114 | [0m[35m                formatted = f"{correlation_id} - "[0m
[30;1m115 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m871[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/log.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m    logger.setLevel(options.get("level", logging.ERROR) or logging.ERROR)[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    handler = options.get("handler")[0m
[30;1m76 | [0m[35m    if handler:[0m
[30;1m77 | [0m[35m        handler.setLevel(logger.level)[0m
[30;1m78 | [0m[35m        logger.addHandler(handler)[0m

[31m--[ [0m[34mMatch #[0m[33m872[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/log.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m70 | [0m[35m        options = {}[0m
[30;1m71 | [0m[35m    logger = logging.getLogger(Constants.LOGGER_NAME)[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m    logger.setLevel(options.get("level", logging.ERROR) or logging.ERROR)[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    handler = options.get("handler")[0m
[30;1m76 | [0m[35m    if handler:[0m

[31m--[ [0m[34mMatch #[0m[33m873[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m253 | [0m[35m            # collect this inormation, in case bug report will be generated[0m
[30;1m254 | [0m[35m            self.last_query_info["request"]["payload"] = request_payload  # pylint: disable=unsuppor[0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35m            response = self._http_client.post(api_url, headers=request_headers, json=request_payload[0m
[30;1m257 | [0m[35m[0m
[30;1m258 | [0m[35m        logger().debug(f"DraftClient::execute - response - status: {response.status_code}, headers: [0m
[30;1m259 | [0m[35m        #[0m

[31m--[ [0m[34mMatch #[0m[33m874[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m253 | [0m[35m            # collect this inormation, in case bug report will be generated[0m
[30;1m254 | [0m[35m            self.last_query_info["request"]["payload"] = request_payload  # pylint: disable=unsuppor[0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35m            response = self._http_client.post(api_url, headers=request_headers, json=request_payload[0m
[30;1m257 | [0m[35m[0m
[30;1m258 | [0m[35m        logger().debug(f"DraftClient::execute - response - status: {response.status_code}, headers: [0m
[30;1m259 | [0m[35m        #[0m

[31m--[ [0m[34mMatch #[0m[33m875[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m248 | [0m[35m                if type(timespan) == str and len(timespan) > 0:[0m
[30;1m249 | [0m[35m                    request_payload["timespan"] = timespan[0m
[30;1m250 | [0m[35m[0m
[30;1m251 | [0m[35m            logger().debug(f"DraftClient::execute - POST request - url: {api_url}, headers: {log_req[0m
[30;1m252 | [0m[35m[0m
[30;1m253 | [0m[35m            # collect this inormation, in case bug report will be generated[0m
[30;1m254 | [0m[35m            self.last_query_info["request"]["payload"] = request_payload  # pylint: disable=unsuppor[0m

[31m--[ [0m[34mMatch #[0m[33m876[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m244 | [0m[35m                if type(resources) == list and len(resources) > 0:[0m
[30;1m245 | [0m[35m                    request_payload[self.resources_name] = resources[0m
[30;1m246 | [0m[35m[0m
[30;1m247 | [0m[35m                timespan = options.get("query_properties").get("timespan")[0m
[30;1m248 | [0m[35m                if type(timespan) == str and len(timespan) > 0:[0m
[30;1m249 | [0m[35m                    request_payload["timespan"] = timespan[0m
[30;1m250 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m877[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m244 | [0m[35m                if type(resources) == list and len(resources) > 0:[0m
[30;1m245 | [0m[35m                    request_payload[self.resources_name] = resources[0m
[30;1m246 | [0m[35m[0m
[30;1m247 | [0m[35m                timespan = options.get("query_properties").get("timespan")[0m
[30;1m248 | [0m[35m                if type(timespan) == str and len(timespan) > 0:[0m
[30;1m249 | [0m[35m                    request_payload["timespan"] = timespan[0m
[30;1m250 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m878[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m240 | [0m[35m            # Implicit Cross Workspace Queries: https://dev.loganalytics.io/oms/documentation/3-Usin[0m
[30;1m241 | [0m[35m            # workspaces - string[] - A list of workspaces that are included in the query.[0m
[30;1m242 | [0m[35m            if type(options.get("query_properties")) == dict:[0m
[30;1m243 | [0m[35m                resources = options.get("query_properties").get(self.resources_name)[0m
[30;1m244 | [0m[35m                if type(resources) == list and len(resources) > 0:[0m
[30;1m245 | [0m[35m                    request_payload[self.resources_name] = resources[0m
[30;1m246 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m879[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m240 | [0m[35m            # Implicit Cross Workspace Queries: https://dev.loganalytics.io/oms/documentation/3-Usin[0m
[30;1m241 | [0m[35m            # workspaces - string[] - A list of workspaces that are included in the query.[0m
[30;1m242 | [0m[35m            if type(options.get("query_properties")) == dict:[0m
[30;1m243 | [0m[35m                resources = options.get("query_properties").get(self.resources_name)[0m
[30;1m244 | [0m[35m                if type(resources) == list and len(resources) > 0:[0m
[30;1m245 | [0m[35m                    request_payload[self.resources_name] = resources[0m
[30;1m246 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m880[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m239 | [0m[35m[0m
[30;1m240 | [0m[35m            # Implicit Cross Workspace Queries: https://dev.loganalytics.io/oms/documentation/3-Usin[0m
[30;1m241 | [0m[35m            # workspaces - string[] - A list of workspaces that are included in the query.[0m
[30;1m242 | [0m[35m            if type(options.get("query_properties")) == dict:[0m
[30;1m243 | [0m[35m                resources = options.get("query_properties").get(self.resources_name)[0m
[30;1m244 | [0m[35m                if type(resources) == list and len(resources) > 0:[0m
[30;1m245 | [0m[35m                    request_payload[self.resources_name] = resources[0m

[31m--[ [0m[34mMatch #[0m[33m881[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35m        if is_metadata:[0m
[30;1m233 | [0m[35m            logger().debug(f"DraftClient::execute - GET request - url: {api_url}, headers: {log_requ[0m
[30;1m234 | [0m[35m            response = self._http_client.get(api_url, headers=request_headers, timeout=options.get("[0m
[30;1m235 | [0m[35m        else:[0m
[30;1m236 | [0m[35m            request_payload = {[0m
[30;1m237 | [0m[35m                "query": query[0m

[31m--[ [0m[34mMatch #[0m[33m882[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35m        if is_metadata:[0m
[30;1m233 | [0m[35m            logger().debug(f"DraftClient::execute - GET request - url: {api_url}, headers: {log_requ[0m
[30;1m234 | [0m[35m            response = self._http_client.get(api_url, headers=request_headers, timeout=options.get("[0m
[30;1m235 | [0m[35m        else:[0m
[30;1m236 | [0m[35m            request_payload = {[0m
[30;1m237 | [0m[35m                "query": query[0m

[31m--[ [0m[34mMatch #[0m[33m883[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m230 | [0m[35m        }[0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35m        if is_metadata:[0m
[30;1m233 | [0m[35m            logger().debug(f"DraftClient::execute - GET request - url: {api_url}, headers: {log_requ[0m
[30;1m234 | [0m[35m            response = self._http_client.get(api_url, headers=request_headers, timeout=options.get("[0m
[30;1m235 | [0m[35m        else:[0m
[30;1m236 | [0m[35m            request_payload = {[0m

[31m--[ [0m[34mMatch #[0m[33m884[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m225 | [0m[35m            "request": {[0m
[30;1m226 | [0m[35m                "endpoint": api_url,[0m
[30;1m227 | [0m[35m                "headers": log_request_headers,[0m
[30;1m228 | [0m[35m                "timeout": options.get("timeout"),[0m
[30;1m229 | [0m[35m            }[0m
[30;1m230 | [0m[35m        }[0m
[30;1m231 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m885[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m216 | [0m[35m        # submit request[0m
[30;1m217 | [0m[35m        #[0m
[30;1m218 | [0m[35m        log_request_headers = request_headers[0m
[30;1m219 | [0m[35m        if request_headers.get("Authorization"):[0m
[30;1m220 | [0m[35m            log_request_headers = request_headers.copy()[0m
[30;1m221 | [0m[35m            log_request_headers["Authorization"] = "..." [0m
[30;1m222 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m886[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m205 | [0m[35m        if len(prefer_list) > 0:[0m
[30;1m206 | [0m[35m            request_headers["Prefer"] = ", ".join(prefer_list)[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m        cache_max_age = options.get("request_cache_max_age")[0m
[30;1m209 | [0m[35m        if cache_max_age is not None:[0m
[30;1m210 | [0m[35m            if cache_max_age > 0:[0m
[30;1m211 | [0m[35m                request_headers["Cache-Control"] = f"max-age={cache_max_age}"[0m

[31m--[ [0m[34mMatch #[0m[33m887[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m193 | [0m[35m            "x-ms-client-request-id": client_request_id,[0m
[30;1m194 | [0m[35m            "x-ms-app": app[0m
[30;1m195 | [0m[35m        }[0m
[30;1m196 | [0m[35m        user_tag = options.get("request_user_tag")[0m
[30;1m197 | [0m[35m        if user_tag is not None:[0m
[30;1m198 | [0m[35m            request_headers["x-ms-user"] = user_tag[0m
[30;1m199 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m888[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m183 | [0m[35m            app = f"{app};{app_tag}"[0m
[30;1m184 | [0m[35m            [0m
[30;1m185 | [0m[35m        user_agent = f'{Constants.MAGIC_CLASS_NAME}/{self._WEB_CLIENT_VERSION}'[0m
[30;1m186 | [0m[35m        user_agent_tag = options.get("request_user_agent_tag")[0m
[30;1m187 | [0m[35m        if user_agent_tag is not None:[0m
[30;1m188 | [0m[35m            user_agent = user_agent_tag[0m
[30;1m189 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m889[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m178 | [0m[35m            client_request_id = f"{client_request_id};{str(uuid.uuid4())}/{self._session_guid}/Azure[0m
[30;1m179 | [0m[35m[0m
[30;1m180 | [0m[35m        app = f'{Constants.MAGIC_CLASS_NAME};{options.get("notebook_app")}'[0m
[30;1m181 | [0m[35m        app_tag = options.get("request_app_tag")[0m
[30;1m182 | [0m[35m        if app_tag is not None:[0m
[30;1m183 | [0m[35m            app = f"{app};{app_tag}"[0m
[30;1m184 | [0m[35m            [0m

[31m--[ [0m[34mMatch #[0m[33m890[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m177 | [0m[35m        else:[0m
[30;1m178 | [0m[35m            client_request_id = f"{client_request_id};{str(uuid.uuid4())}/{self._session_guid}/Azure[0m
[30;1m179 | [0m[35m[0m
[30;1m180 | [0m[35m        app = f'{Constants.MAGIC_CLASS_NAME};{options.get("notebook_app")}'[0m
[30;1m181 | [0m[35m        app_tag = options.get("request_app_tag")[0m
[30;1m182 | [0m[35m        if app_tag is not None:[0m
[30;1m183 | [0m[35m            app = f"{app};{app_tag}"[0m

[31m--[ [0m[34mMatch #[0m[33m891[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m171 | [0m[35m        client_version = f"{Constants.MAGIC_CLASS_NAME}.Python.Client:{self._WEB_CLIENT_VERSION}"   [0m
[30;1m172 | [0m[35m[0m
[30;1m173 | [0m[35m        client_request_id = f"{Constants.MAGIC_CLASS_NAME}.execute"[0m
[30;1m174 | [0m[35m        client_request_id_tag = options.get("request_id_tag")[0m
[30;1m175 | [0m[35m        if client_request_id_tag is not None:[0m
[30;1m176 | [0m[35m            client_request_id = f"{client_request_id};{client_request_id_tag};{str(uuid.uuid4())}/{s[0m
[30;1m177 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m892[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m160 | [0m[35m        if self._API_VERSION != "beta":[0m
[30;1m161 | [0m[35m            prefer_list.append("ai.response-thinning=false")  # returns data as kusto v1[0m
[30;1m162 | [0m[35m        [0m
[30;1m163 | [0m[35m        timeout = options.get("timeout")[0m
[30;1m164 | [0m[35m        if timeout is not None:[0m
[30;1m165 | [0m[35m            prefer_list.append(f"wait={timeout}")[0m
[30;1m166 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m893[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m104 | [0m[35m        if self._appkey is None and conn_kv.get(ConnStrKeys.ANONYMOUS) is None:[0m
[30;1m105 | [0m[35m            cloud = options.get("cloud")[0m
[30;1m106 | [0m[35m            client_id = self._DRAFT_CLIENT_BY_CLOUD[cloud][0m
[30;1m107 | [0m[35m            http_client = self._http_client if options.get("auth_use_http_client") else None[0m
[30;1m108 | [0m[35m            self._aad_helper = _MyAadHelper(ConnKeysKCSB(conn_kv, self._data_source), client_id, htt[0m
[30;1m109 | [0m[35m        else:[0m
[30;1m110 | [0m[35m            self._aad_helper = None[0m

[31m--[ [0m[34mMatch #[0m[33m894[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m        if self._appkey is None and conn_kv.get(ConnStrKeys.ANONYMOUS) is None:[0m
[30;1m105 | [0m[35m            cloud = options.get("cloud")[0m
[30;1m106 | [0m[35m            client_id = self._DRAFT_CLIENT_BY_CLOUD[cloud][0m
[30;1m107 | [0m[35m            http_client = self._http_client if options.get("auth_use_http_client") else None[0m
[30;1m108 | [0m[35m            self._aad_helper = _MyAadHelper(ConnKeysKCSB(conn_kv, self._data_source), client_id, htt[0m

[31m--[ [0m[34mMatch #[0m[33m895[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m101 | [0m[35m        logger().debug(f"draft_client.py :: __init__ :  self._appkey: {self._appkey}")[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m        if self._appkey is None and conn_kv.get(ConnStrKeys.ANONYMOUS) is None:[0m
[30;1m105 | [0m[35m            cloud = options.get("cloud")[0m
[30;1m106 | [0m[35m            client_id = self._DRAFT_CLIENT_BY_CLOUD[cloud][0m
[30;1m107 | [0m[35m            http_client = self._http_client if options.get("auth_use_http_client") else None[0m

[31m--[ [0m[34mMatch #[0m[33m896[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m        logger().debug(f"draft_client.py :: __init__ :  conn_kv[\"datasourceurl\"]: {conn_kv.get(Con[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m        self._appkey = conn_kv.get(ConnStrKeys.APPKEY)[0m
[30;1m101 | [0m[35m        logger().debug(f"draft_client.py :: __init__ :  self._appkey: {self._appkey}")[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m897[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m95 | [0m[35m            if not self._data_source:[0m
[30;1m96 | [0m[35m                raise KqlEngineError(f"the service {schema} is not supported in cloud {cloud}")[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m        logger().debug(f"draft_client.py :: __init__ :  conn_kv[\"datasourceurl\"]: {conn_kv.get(Con[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m        self._appkey = conn_kv.get(ConnStrKeys.APPKEY)[0m
[30;1m101 | [0m[35m        logger().debug(f"draft_client.py :: __init__ :  self._appkey: {self._appkey}")[0m

[31m--[ [0m[34mMatch #[0m[33m898[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m90 | [0m[35m        else:[0m
[30;1m91 | [0m[35m            cloud = options.get("cloud")[0m
[30;1m92 | [0m[35m            urls = self._DRAFT_URLS_BY_SCHEMA.get(schema, {})[0m
[30;1m93 | [0m[35m            self._data_source = urls.get(cloud, data_source)[0m
[30;1m94 | [0m[35m                [0m
[30;1m95 | [0m[35m            if not self._data_source:[0m
[30;1m96 | [0m[35m                raise KqlEngineError(f"the service {schema} is not supported in cloud {cloud}")[0m

[31m--[ [0m[34mMatch #[0m[33m899[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m        else:[0m
[30;1m91 | [0m[35m            cloud = options.get("cloud")[0m
[30;1m92 | [0m[35m            urls = self._DRAFT_URLS_BY_SCHEMA.get(schema, {})[0m
[30;1m93 | [0m[35m            self._data_source = urls.get(cloud, data_source)[0m
[30;1m94 | [0m[35m                [0m
[30;1m95 | [0m[35m            if not self._data_source:[0m

[31m--[ [0m[34mMatch #[0m[33m900[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m88 | [0m[35m            logger().debug(f"draft_client.py :: __init__ :  self._data_source from conn_kv[\"datasou[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m        else:[0m
[30;1m91 | [0m[35m            cloud = options.get("cloud")[0m
[30;1m92 | [0m[35m            urls = self._DRAFT_URLS_BY_SCHEMA.get(schema, {})[0m
[30;1m93 | [0m[35m            self._data_source = urls.get(cloud, data_source)[0m
[30;1m94 | [0m[35m                [0m

[31m--[ [0m[34mMatch #[0m[33m901[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m84 | [0m[35m        self.resources_name = "workspaces" if schema == Schema.LOG_ANALYTICS else "applications"[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m        if conn_kv.get(ConnStrKeys.DATA_SOURCE_URL):[0m
[30;1m87 | [0m[35m            self._data_source =  conn_kv.get(ConnStrKeys.DATA_SOURCE_URL)  [0m
[30;1m88 | [0m[35m            logger().debug(f"draft_client.py :: __init__ :  self._data_source from conn_kv[\"datasou[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m902[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m83 | [0m[35m        self._domain = domain[0m
[30;1m84 | [0m[35m        self.resources_name = "workspaces" if schema == Schema.LOG_ANALYTICS else "applications"[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m        if conn_kv.get(ConnStrKeys.DATA_SOURCE_URL):[0m
[30;1m87 | [0m[35m            self._data_source =  conn_kv.get(ConnStrKeys.DATA_SOURCE_URL)  [0m
[30;1m88 | [0m[35m            logger().debug(f"draft_client.py :: __init__ :  self._data_source from conn_kv[\"datasou[0m
[30;1m89 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m903[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m161 | [0m[35m            prefer_list.append("ai.response-thinning=false")  # returns data as kusto v1[0m
[30;1m162 | [0m[35m        [0m
[30;1m163 | [0m[35m        timeout = options.get("timeout")[0m
[30;1m164 | [0m[35m        if timeout is not None:[0m
[30;1m165 | [0m[35m            prefer_list.append(f"wait={timeout}")[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m        #[0m

[31m--[ [0m[34mMatch #[0m[33m904[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m160 | [0m[35m        if self._API_VERSION != "beta":[0m
[30;1m161 | [0m[35m            prefer_list.append("ai.response-thinning=false")  # returns data as kusto v1[0m
[30;1m162 | [0m[35m        [0m
[30;1m163 | [0m[35m        timeout = options.get("timeout")[0m
[30;1m164 | [0m[35m        if timeout is not None:[0m
[30;1m165 | [0m[35m            prefer_list.append(f"wait={timeout}")[0m
[30;1m166 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m905[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m130 | [0m[35m            If this is True, results are returned to client, even if there are exceptions.[0m
[30;1m131 | [0m[35m            If this is False, exception is raised. Default is False.[0m
[30;1m132 | [0m[35m        oprions["timeout"] : float, optional[0m
[30;1m133 | [0m[35m            Optional parameter. Network timeout in seconds. Default is no timeout.[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m        Returns[0m
[30;1m136 | [0m[35m        -------[0m

[31m--[ [0m[34mMatch #[0m[33m906[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/draft_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m93 | [0m[35m            self._data_source = urls.get(cloud, data_source)[0m
[30;1m94 | [0m[35m                [0m
[30;1m95 | [0m[35m            if not self._data_source:[0m
[30;1m96 | [0m[35m                raise KqlEngineError(f"the service {schema} is not supported in cloud {cloud}")[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m        logger().debug(f"draft_client.py :: __init__ :  conn_kv[\"datasourceurl\"]: {conn_kv.get(Con[0m
[30;1m99 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m907[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_files_server_management.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m237 | [0m[35m            abort_url = f"{server_url}/abort?kernelid={kernel_id}"[0m
[30;1m238 | [0m[35m            requests = Dependencies.get_module("requests", dont_throw=True)[0m
[30;1m239 | [0m[35m            if requests:[0m
[30;1m240 | [0m[35m                requests.get(abort_url)[0m
[30;1m241 | [0m[35m                result = True[0m
[30;1m242 | [0m[35m        except: # pylint: disable=bare-except[0m
[30;1m243 | [0m[35m            pass[0m

[31m--[ [0m[34mMatch #[0m[33m908[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_files_server_management.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m178 | [0m[35m            heartbeat_url = f"{self._server_url}/heartbeat?kernelid={self._kernel_id}"[0m
[30;1m179 | [0m[35m            requests = Dependencies.get_module("requests", dont_throw=True)[0m
[30;1m180 | [0m[35m            if requests:[0m
[30;1m181 | [0m[35m                requests.get(heartbeat_url)[0m
[30;1m182 | [0m[35m                result = True[0m
[30;1m183 | [0m[35m        except: # pylint: disable=bare-except[0m
[30;1m184 | [0m[35m            pass[0m

[31m--[ [0m[34mMatch #[0m[33m909[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_files_server_management.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m162 | [0m[35m            ping_url = f'{self._server_url}/ping?kernelid={self._kernel_id}'[0m
[30;1m163 | [0m[35m            requests = Dependencies.get_module("requests", dont_throw=True)[0m
[30;1m164 | [0m[35m            if requests:[0m
[30;1m165 | [0m[35m                requests.get(ping_url)[0m
[30;1m166 | [0m[35m            result = True[0m
[30;1m167 | [0m[35m        except: # pylint: disable=bare-except[0m
[30;1m168 | [0m[35m            pass[0m

[31m--[ [0m[34mMatch #[0m[33m910[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_files_server_management.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m        self._is_registered = False[0m
[30;1m42 | [0m[35m        self._is_started = False[0m
[30;1m43 | [0m[35m        self._heartbeat_thread = None[0m
[30;1m44 | [0m[35m        self._kernel_id = options.get("kernel_id")[0m
[30;1m45 | [0m[35m        self._pid = os.getpid()[0m
[30;1m46 | [0m[35m        self._liveness_mode = self._find_liveness_mode(sys.platform)[0m
[30;1m47 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m911[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_files_server_management.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m            if self._liveness_mode == "heartbeat":[0m
[30;1m127 | [0m[35m                # alternative mechanism to detect parent is still alive[0m
[30;1m128 | [0m[35m                # parent is send heartbeat, and if for a period of time heartbeat stops, mean parent[0m
[30;1m129 | [0m[35m                self._heartbeat_thread = HeartbeatThread(self)[0m
[30;1m130 | [0m[35m                self._heartbeat_thread.start()[0m
[30;1m131 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m912[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_files_server_management.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mimport sys[0m
[30;1m9 | [0m[35mimport os[0m
[30;1m10 | [0m[35mimport time[0m
[30;1m11 | [0m[35mimport subprocess as sub[0m
[30;1m12 | [0m[35mimport threading[0m
[30;1m13 | [0m[35mfrom typing import Tuple[0m

[31m--[ [0m[34mMatch #[0m[33m913[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/adal_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m187 | [0m[35m            # pylint: disable=too-many-boolean-expressions[0m
[30;1m188 | [0m[35m            if ((is_mrrt is None or is_mrrt == v.get(TokenResponseFields.IS_MRRT))[0m
[30;1m189 | [0m[35m                    and (user_id is None or _string_cmp(user_id, v.get(TokenResponseFields.USER_ID))[0m
[30;1m190 | [0m[35m                    and (client_id is None or _string_cmp(client_id, v.get(TokenResponseFields._CLIE[0m
[30;1m191 | [0m[35m                matches.append(v)[0m
[30;1m192 | [0m[35m        return matches[0m

[31m--[ [0m[34mMatch #[0m[33m914[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/adal_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m186 | [0m[35m            # None value will be taken as wildcard match[0m
[30;1m187 | [0m[35m            # pylint: disable=too-many-boolean-expressions[0m
[30;1m188 | [0m[35m            if ((is_mrrt is None or is_mrrt == v.get(TokenResponseFields.IS_MRRT))[0m
[30;1m189 | [0m[35m                    and (user_id is None or _string_cmp(user_id, v.get(TokenResponseFields.USER_ID))[0m
[30;1m190 | [0m[35m                    and (client_id is None or _string_cmp(client_id, v.get(TokenResponseFields._CLIE[0m
[30;1m191 | [0m[35m                matches.append(v)[0m
[30;1m192 | [0m[35m        return matches[0m

[31m--[ [0m[34mMatch #[0m[33m915[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/adal_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m185 | [0m[35m            v = self._cache[k][0m
[30;1m186 | [0m[35m            # None value will be taken as wildcard match[0m
[30;1m187 | [0m[35m            # pylint: disable=too-many-boolean-expressions[0m
[30;1m188 | [0m[35m            if ((is_mrrt is None or is_mrrt == v.get(TokenResponseFields.IS_MRRT))[0m
[30;1m189 | [0m[35m                    and (user_id is None or _string_cmp(user_id, v.get(TokenResponseFields.USER_ID))[0m
[30;1m190 | [0m[35m                    and (client_id is None or _string_cmp(client_id, v.get(TokenResponseFields._CLIE[0m
[30;1m191 | [0m[35m                matches.append(v)[0m

[31m--[ [0m[34mMatch #[0m[33m916[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/adal_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m163 | [0m[35m                        and state_obj.get("random_string") [0m
[30;1m164 | [0m[35m                        and len(state_obj.get("random_string")) >= 1 [0m
[30;1m165 | [0m[35m                        and len(state_obj.get("random_string")) <= 100[0m
[30;1m166 | [0m[35m                        and state_obj.get("cache_values")):[0m
[30;1m167 | [0m[35m                    cache_values = state_obj["cache_values"][0m
[30;1m168 | [0m[35m                    for val in cache_values:[0m
[30;1m169 | [0m[35m                        key = _get_cache_key(val)[0m

[31m--[ [0m[34mMatch #[0m[33m917[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/adal_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m162 | [0m[35m                        and state_obj.get("timestamp") < int(datetime.utcnow().timestamp())[0m
[30;1m163 | [0m[35m                        and state_obj.get("random_string") [0m
[30;1m164 | [0m[35m                        and len(state_obj.get("random_string")) >= 1 [0m
[30;1m165 | [0m[35m                        and len(state_obj.get("random_string")) <= 100[0m
[30;1m166 | [0m[35m                        and state_obj.get("cache_values")):[0m
[30;1m167 | [0m[35m                    cache_values = state_obj["cache_values"][0m
[30;1m168 | [0m[35m                    for val in cache_values:[0m

[31m--[ [0m[34mMatch #[0m[33m918[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/adal_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m161 | [0m[35m                        and state_obj.get("version") == 1[0m
[30;1m162 | [0m[35m                        and state_obj.get("timestamp") < int(datetime.utcnow().timestamp())[0m
[30;1m163 | [0m[35m                        and state_obj.get("random_string") [0m
[30;1m164 | [0m[35m                        and len(state_obj.get("random_string")) >= 1 [0m
[30;1m165 | [0m[35m                        and len(state_obj.get("random_string")) <= 100[0m
[30;1m166 | [0m[35m                        and state_obj.get("cache_values")):[0m
[30;1m167 | [0m[35m                    cache_values = state_obj["cache_values"][0m

[31m--[ [0m[34mMatch #[0m[33m919[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/adal_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m160 | [0m[35m                if (state_obj.get("description") == "kqlmagic"[0m
[30;1m161 | [0m[35m                        and state_obj.get("version") == 1[0m
[30;1m162 | [0m[35m                        and state_obj.get("timestamp") < int(datetime.utcnow().timestamp())[0m
[30;1m163 | [0m[35m                        and state_obj.get("random_string") [0m
[30;1m164 | [0m[35m                        and len(state_obj.get("random_string")) >= 1 [0m
[30;1m165 | [0m[35m                        and len(state_obj.get("random_string")) <= 100[0m
[30;1m166 | [0m[35m                        and state_obj.get("cache_values")):[0m

[31m--[ [0m[34mMatch #[0m[33m920[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/adal_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m159 | [0m[35m                state_obj = json.loads(state)[0m
[30;1m160 | [0m[35m                if (state_obj.get("description") == "kqlmagic"[0m
[30;1m161 | [0m[35m                        and state_obj.get("version") == 1[0m
[30;1m162 | [0m[35m                        and state_obj.get("timestamp") < int(datetime.utcnow().timestamp())[0m
[30;1m163 | [0m[35m                        and state_obj.get("random_string") [0m
[30;1m164 | [0m[35m                        and len(state_obj.get("random_string")) >= 1 [0m
[30;1m165 | [0m[35m                        and len(state_obj.get("random_string")) <= 100[0m

[31m--[ [0m[34mMatch #[0m[33m921[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/adal_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m158 | [0m[35m                self._cache.clear()[0m
[30;1m159 | [0m[35m                state_obj = json.loads(state)[0m
[30;1m160 | [0m[35m                if (state_obj.get("description") == "kqlmagic"[0m
[30;1m161 | [0m[35m                        and state_obj.get("version") == 1[0m
[30;1m162 | [0m[35m                        and state_obj.get("timestamp") < int(datetime.utcnow().timestamp())[0m
[30;1m163 | [0m[35m                        and state_obj.get("random_string") [0m
[30;1m164 | [0m[35m                        and len(state_obj.get("random_string")) >= 1 [0m

[31m--[ [0m[34mMatch #[0m[33m922[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/adal_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m157 | [0m[35m            if state:[0m
[30;1m158 | [0m[35m                self._cache.clear()[0m
[30;1m159 | [0m[35m                state_obj = json.loads(state)[0m
[30;1m160 | [0m[35m                if (state_obj.get("description") == "kqlmagic"[0m
[30;1m161 | [0m[35m                        and state_obj.get("version") == 1[0m
[30;1m162 | [0m[35m                        and state_obj.get("timestamp") < int(datetime.utcnow().timestamp())[0m
[30;1m163 | [0m[35m                        and state_obj.get("random_string") [0m

[31m--[ [0m[34mMatch #[0m[33m923[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/adal_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m95 | [0m[35m            return self._query_cache([0m
[30;1m96 | [0m[35m                query.get(TokenResponseFields.IS_MRRT), [0m
[30;1m97 | [0m[35m                query.get(TokenResponseFields.USER_ID), [0m
[30;1m98 | [0m[35m                query.get(TokenResponseFields._CLIENT_ID)[0m
[30;1m99 | [0m[35m            )[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m924[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/adal_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m94 | [0m[35m            self.deserialize(state)[0m
[30;1m95 | [0m[35m            return self._query_cache([0m
[30;1m96 | [0m[35m                query.get(TokenResponseFields.IS_MRRT), [0m
[30;1m97 | [0m[35m                query.get(TokenResponseFields.USER_ID), [0m
[30;1m98 | [0m[35m                query.get(TokenResponseFields._CLIENT_ID)[0m
[30;1m99 | [0m[35m            )[0m
[30;1m100 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m925[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/adal_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m93 | [0m[35m            state = self._store.restore()[0m
[30;1m94 | [0m[35m            self.deserialize(state)[0m
[30;1m95 | [0m[35m            return self._query_cache([0m
[30;1m96 | [0m[35m                query.get(TokenResponseFields.IS_MRRT), [0m
[30;1m97 | [0m[35m                query.get(TokenResponseFields.USER_ID), [0m
[30;1m98 | [0m[35m                query.get(TokenResponseFields._CLIENT_ID)[0m
[30;1m99 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m926[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/adal_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m        entry.get(TokenResponseFields._AUTHORITY), [0m
[30;1m62 | [0m[35m        entry.get(TokenResponseFields.RESOURCE), [0m
[30;1m63 | [0m[35m        entry.get(TokenResponseFields._CLIENT_ID), [0m
[30;1m64 | [0m[35m        entry.get(TokenResponseFields.USER_ID))[0m
[30;1m65 | [0m[35m# pylint: enable=protected-access[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m927[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/adal_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m60 | [0m[35m    return AdalTokenCacheKey([0m
[30;1m61 | [0m[35m        entry.get(TokenResponseFields._AUTHORITY), [0m
[30;1m62 | [0m[35m        entry.get(TokenResponseFields.RESOURCE), [0m
[30;1m63 | [0m[35m        entry.get(TokenResponseFields._CLIENT_ID), [0m
[30;1m64 | [0m[35m        entry.get(TokenResponseFields.USER_ID))[0m
[30;1m65 | [0m[35m# pylint: enable=protected-access[0m
[30;1m66 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m928[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/adal_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35mdef _get_cache_key(entry):[0m
[30;1m60 | [0m[35m    return AdalTokenCacheKey([0m
[30;1m61 | [0m[35m        entry.get(TokenResponseFields._AUTHORITY), [0m
[30;1m62 | [0m[35m        entry.get(TokenResponseFields.RESOURCE), [0m
[30;1m63 | [0m[35m        entry.get(TokenResponseFields._CLIENT_ID), [0m
[30;1m64 | [0m[35m        entry.get(TokenResponseFields.USER_ID))[0m
[30;1m65 | [0m[35m# pylint: enable=protected-access[0m

[31m--[ [0m[34mMatch #[0m[33m929[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/adal_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m58 | [0m[35m# pylint: disable=protected-access[0m
[30;1m59 | [0m[35mdef _get_cache_key(entry):[0m
[30;1m60 | [0m[35m    return AdalTokenCacheKey([0m
[30;1m61 | [0m[35m        entry.get(TokenResponseFields._AUTHORITY), [0m
[30;1m62 | [0m[35m        entry.get(TokenResponseFields.RESOURCE), [0m
[30;1m63 | [0m[35m        entry.get(TokenResponseFields._CLIENT_ID), [0m
[30;1m64 | [0m[35m        entry.get(TokenResponseFields.USER_ID))[0m

[31m--[ [0m[34mMatch #[0m[33m930[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/adal_token_cache.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m145 | [0m[35m                "description": "kqlmagic",[0m
[30;1m146 | [0m[35m                "version": 1,[0m
[30;1m147 | [0m[35m                "timestamp": int(datetime.utcnow().timestamp()),[0m
[30;1m148 | [0m[35m                "random_string": self._random_string(),  # makes length and content different each t[0m
[30;1m149 | [0m[35m                "cache_values": list(self._cache.values()),[0m
[30;1m150 | [0m[35m            }[0m
[30;1m151 | [0m[35m            return json_dumps(state_obj)[0m

[31m--[ [0m[34mMatch #[0m[33m931[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1448 | [0m[35m            #[0m
[30;1m1449 | [0m[35m            try:[0m
[30;1m1450 | [0m[35m                new_value = cls._convert(dict_name, obj, key, value)[0m
[30;1m1451 | [0m[35m                trait:TraitType = cls.traits_dict.get(name)[0m
[30;1m1452 | [0m[35m                if hasattr(trait, "_validate"):[0m
[30;1m1453 | [0m[35m                    validated_value = trait._validate(config, new_value)[0m
[30;1m1454 | [0m[35m                return[0m

[31m--[ [0m[34mMatch #[0m[33m932[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1441 | [0m[35m    @classmethod[0m
[30;1m1442 | [0m[35m    def _validate_config_trait(cls, dict_name:str, obj:Dict[str,Any], key:str, value:Any, config:Con[0m
[30;1m1443 | [0m[35m        # validate using config traits[0m
[30;1m1444 | [0m[35m        name = obj.get("flag")[0m
[30;1m1445 | [0m[35m        if isinstance(config, Configurable) and name in cls.traits_dict:[0m
[30;1m1446 | [0m[35m            #[0m
[30;1m1447 | [0m[35m            # save current value[0m

[31m--[ [0m[34mMatch #[0m[33m933[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1384 | [0m[35m                    value = [value]                     [0m
[30;1m1385 | [0m[35m                return list(value)[0m
[30;1m1386 | [0m[35m            elif _type == "enum":[0m
[30;1m1387 | [0m[35m                enum_values = obj.get("values", [])[0m
[30;1m1388 | [0m[35m                if enum_values.index(value) >= 0:[0m
[30;1m1389 | [0m[35m                    return value[0m
[30;1m1390 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m934[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1355 | [0m[35m                raise ValueError(f"option '{key}' doesn't allow None value.")[0m
[30;1m1356 | [0m[35m        _type = None[0m
[30;1m1357 | [0m[35m        try:[0m
[30;1m1358 | [0m[35m            _type = obj.get("type")[0m
[30;1m1359 | [0m[35m            if _type == "int":[0m
[30;1m1360 | [0m[35m                if float(value) != int(value):[0m
[30;1m1361 | [0m[35m                    raise ValueError[0m

[31m--[ [0m[34mMatch #[0m[33m935[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1349 | [0m[35m    @classmethod[0m
[30;1m1350 | [0m[35m    def _convert(cls, name:str, obj:Dict[str,Any], key:str, value:Any)->Any:[0m
[30;1m1351 | [0m[35m        if value is None:[0m
[30;1m1352 | [0m[35m            if obj.get("allow_none"):[0m
[30;1m1353 | [0m[35m                return None[0m
[30;1m1354 | [0m[35m            else:[0m
[30;1m1355 | [0m[35m                raise ValueError(f"option '{key}' doesn't allow None value.")[0m

[31m--[ [0m[34mMatch #[0m[33m936[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1185 | [0m[35m        if not key_state:[0m
[30;1m1186 | [0m[35m            raise ValueError(f"{option_type} '{opt_key}' must have a value")[0m
[30;1m1187 | [0m[35m[0m
[30;1m1188 | [0m[35m        if options.get("query_properties"):[0m
[30;1m1189 | [0m[35m            properties.update(options["query_properties"])[0m
[30;1m1190 | [0m[35m        options["query_properties"] = properties[0m
[30;1m1191 | [0m[35m        if suppress_results:[0m

[31m--[ [0m[34mMatch #[0m[33m937[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1180 | [0m[35m[0m
[30;1m1181 | [0m[35m            # validate using config traits[0m
[30;1m1182 | [0m[35m            if key_state and is_option:[0m
[30;1m1183 | [0m[35m                cls._validate_config_trait("options", obj, key, options.get(opt_key), config)[0m
[30;1m1184 | [0m[35m            [0m
[30;1m1185 | [0m[35m        if not key_state:[0m
[30;1m1186 | [0m[35m            raise ValueError(f"{option_type} '{opt_key}' must have a value")[0m

[31m--[ [0m[34mMatch #[0m[33m938[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1160 | [0m[35m                        raise ValueError(f"{option_type} {key} is readony, cannot be set")[0m
[30;1m1161 | [0m[35m[0m
[30;1m1162 | [0m[35m                    _type = obj.get("type")[0m
[30;1m1163 | [0m[35m                    opt_key = obj.get("flag") or lookup_key[0m
[30;1m1164 | [0m[35m                    if _type == "bool" and value is None:[0m
[30;1m1165 | [0m[35m                        table[opt_key] = bool_value[0m
[30;1m1166 | [0m[35m                    else:[0m

[31m--[ [0m[34mMatch #[0m[33m939[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1159 | [0m[35m                    if obj.get("flag") in config.read_only_trait_names:[0m
[30;1m1160 | [0m[35m                        raise ValueError(f"{option_type} {key} is readony, cannot be set")[0m
[30;1m1161 | [0m[35m[0m
[30;1m1162 | [0m[35m                    _type = obj.get("type")[0m
[30;1m1163 | [0m[35m                    opt_key = obj.get("flag") or lookup_key[0m
[30;1m1164 | [0m[35m                    if _type == "bool" and value is None:[0m
[30;1m1165 | [0m[35m                        table[opt_key] = bool_value[0m

[31m--[ [0m[34mMatch #[0m[33m940[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1156 | [0m[35m                if obj is not None:[0m
[30;1m1157 | [0m[35m                    if obj.get("abbreviation") is not None:[0m
[30;1m1158 | [0m[35m                        obj = cls._OPTIONS_TABLE.get(obj.get("abbreviation"))[0m
[30;1m1159 | [0m[35m                    if obj.get("flag") in config.read_only_trait_names:[0m
[30;1m1160 | [0m[35m                        raise ValueError(f"{option_type} {key} is readony, cannot be set")[0m
[30;1m1161 | [0m[35m[0m
[30;1m1162 | [0m[35m                    _type = obj.get("type")[0m

[31m--[ [0m[34mMatch #[0m[33m941[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1155 | [0m[35m[0m
[30;1m1156 | [0m[35m                if obj is not None:[0m
[30;1m1157 | [0m[35m                    if obj.get("abbreviation") is not None:[0m
[30;1m1158 | [0m[35m                        obj = cls._OPTIONS_TABLE.get(obj.get("abbreviation"))[0m
[30;1m1159 | [0m[35m                    if obj.get("flag") in config.read_only_trait_names:[0m
[30;1m1160 | [0m[35m                        raise ValueError(f"{option_type} {key} is readony, cannot be set")[0m
[30;1m1161 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m942[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1155 | [0m[35m[0m
[30;1m1156 | [0m[35m                if obj is not None:[0m
[30;1m1157 | [0m[35m                    if obj.get("abbreviation") is not None:[0m
[30;1m1158 | [0m[35m                        obj = cls._OPTIONS_TABLE.get(obj.get("abbreviation"))[0m
[30;1m1159 | [0m[35m                    if obj.get("flag") in config.read_only_trait_names:[0m
[30;1m1160 | [0m[35m                        raise ValueError(f"{option_type} {key} is readony, cannot be set")[0m
[30;1m1161 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m943[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1154 | [0m[35m                    table = properties [0m
[30;1m1155 | [0m[35m[0m
[30;1m1156 | [0m[35m                if obj is not None:[0m
[30;1m1157 | [0m[35m                    if obj.get("abbreviation") is not None:[0m
[30;1m1158 | [0m[35m                        obj = cls._OPTIONS_TABLE.get(obj.get("abbreviation"))[0m
[30;1m1159 | [0m[35m                    if obj.get("flag") in config.read_only_trait_names:[0m
[30;1m1160 | [0m[35m                        raise ValueError(f"{option_type} {key} is readony, cannot be set")[0m

[31m--[ [0m[34mMatch #[0m[33m944[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1150 | [0m[35m                    table = options [0m
[30;1m1151 | [0m[35m                else:[0m
[30;1m1152 | [0m[35m                    lookup_key = key.lower()[0m
[30;1m1153 | [0m[35m                    obj = cls._QUERY_PROPERTIES_TABLE.get(lookup_key)[0m
[30;1m1154 | [0m[35m                    table = properties [0m
[30;1m1155 | [0m[35m[0m
[30;1m1156 | [0m[35m                if obj is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m945[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1146 | [0m[35m[0m
[30;1m1147 | [0m[35m                if is_option:[0m
[30;1m1148 | [0m[35m                    lookup_key = key.lower().replace("-", "").replace("_", "")[0m
[30;1m1149 | [0m[35m                    obj = cls._OPTIONS_TABLE.get(lookup_key)[0m
[30;1m1150 | [0m[35m                    table = options [0m
[30;1m1151 | [0m[35m                else:[0m
[30;1m1152 | [0m[35m                    lookup_key = key.lower()[0m

[31m--[ [0m[34mMatch #[0m[33m946[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1068 | [0m[35m        if obj.get("abbreviation"):[0m
[30;1m1069 | [0m[35m            obj = lookup_table.get(obj.get("abbreviation"))[0m
[30;1m1070 | [0m[35m            if not allow_abbr is not True:[0m
[30;1m1071 | [0m[35m                raise ValueError(f"unknown option '{key}'. (Found option abbreviation '{key}' for {o[0m
[30;1m1072 | [0m[35m        return obj[0m
[30;1m1073 | [0m[35m[0m
[30;1m1074 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m947[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1066 | [0m[35m            raise ValueError(f"unknown option '{key}'")[0m
[30;1m1067 | [0m[35m[0m
[30;1m1068 | [0m[35m        if obj.get("abbreviation"):[0m
[30;1m1069 | [0m[35m            obj = lookup_table.get(obj.get("abbreviation"))[0m
[30;1m1070 | [0m[35m            if not allow_abbr is not True:[0m
[30;1m1071 | [0m[35m                raise ValueError(f"unknown option '{key}'. (Found option abbreviation '{key}' for {o[0m
[30;1m1072 | [0m[35m        return obj[0m

[31m--[ [0m[34mMatch #[0m[33m948[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1066 | [0m[35m            raise ValueError(f"unknown option '{key}'")[0m
[30;1m1067 | [0m[35m[0m
[30;1m1068 | [0m[35m        if obj.get("abbreviation"):[0m
[30;1m1069 | [0m[35m            obj = lookup_table.get(obj.get("abbreviation"))[0m
[30;1m1070 | [0m[35m            if not allow_abbr is not True:[0m
[30;1m1071 | [0m[35m                raise ValueError(f"unknown option '{key}'. (Found option abbreviation '{key}' for {o[0m
[30;1m1072 | [0m[35m        return obj[0m

[31m--[ [0m[34mMatch #[0m[33m949[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1065 | [0m[35m        if obj is None:[0m
[30;1m1066 | [0m[35m            raise ValueError(f"unknown option '{key}'")[0m
[30;1m1067 | [0m[35m[0m
[30;1m1068 | [0m[35m        if obj.get("abbreviation"):[0m
[30;1m1069 | [0m[35m            obj = lookup_table.get(obj.get("abbreviation"))[0m
[30;1m1070 | [0m[35m            if not allow_abbr is not True:[0m
[30;1m1071 | [0m[35m                raise ValueError(f"unknown option '{key}'. (Found option abbreviation '{key}' for {o[0m

[31m--[ [0m[34mMatch #[0m[33m950[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1061 | [0m[35m    def _get_obj(cls, key:str, lookup:Dict[str,Dict[str,Any]]=None, allow_abbr:bool=None)->Dict[str,[0m
[30;1m1062 | [0m[35m        lookup_key = key.lower().replace("-", "").replace("_", "")[0m
[30;1m1063 | [0m[35m        lookup_table = lookup or cls._OPTIONS_TABLE[0m
[30;1m1064 | [0m[35m        obj = lookup_table.get(lookup_key)[0m
[30;1m1065 | [0m[35m        if obj is None:[0m
[30;1m1066 | [0m[35m            raise ValueError(f"unknown option '{key}'")[0m
[30;1m1067 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m951[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1049 | [0m[35m        obj = cls._get_obj(key, allow_abbr=allow_abbr) [0m
[30;1m1050 | [0m[35m        name = obj.get("flag")[0m
[30;1m1051 | [0m[35m        if "init" in obj:[0m
[30;1m1052 | [0m[35m            value = obj.get("init")[0m
[30;1m1053 | [0m[35m        elif name in cls.traits_dict:[0m
[30;1m1054 | [0m[35m            value = getattr(config, name)[0m
[30;1m1055 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m952[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1047 | [0m[35m           return normalized key"""[0m
[30;1m1048 | [0m[35m[0m
[30;1m1049 | [0m[35m        obj = cls._get_obj(key, allow_abbr=allow_abbr) [0m
[30;1m1050 | [0m[35m        name = obj.get("flag")[0m
[30;1m1051 | [0m[35m        if "init" in obj:[0m
[30;1m1052 | [0m[35m            value = obj.get("init")[0m
[30;1m1053 | [0m[35m        elif name in cls.traits_dict:[0m

[31m--[ [0m[34mMatch #[0m[33m953[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1012 | [0m[35m[0m
[30;1m1013 | [0m[35m    @classmethod[0m
[30;1m1014 | [0m[35m    def _parse_value(cls, dict_name:str, obj:Dict[str,Any], key:str, string:str, user_ns:Dict[str,An[0m
[30;1m1015 | [0m[35m        _type = obj.get("type")[0m
[30;1m1016 | [0m[35m[0m
[30;1m1017 | [0m[35m        if string == "" and _type == "str":[0m
[30;1m1018 | [0m[35m            return string[0m

[31m--[ [0m[34mMatch #[0m[33m954[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1002 | [0m[35m        obj = cls._get_obj(key, lookup=lookup, allow_abbr=allow_abbr)[0m
[30;1m1003 | [0m[35m        value = cls._parse_value(dict_name, obj, key, value, user_ns=user_ns)[0m
[30;1m1004 | [0m[35m        cls._validate_config_trait(dict_name, obj, key, value, config)[0m
[30;1m1005 | [0m[35m        key_name = obj.get("flag", key)[0m
[30;1m1006 | [0m[35m        if config.is_read_only(key_name) and value != getattr(config, key_name):[0m
[30;1m1007 | [0m[35m            # done to raise the proer error[0m
[30;1m1008 | [0m[35m            setattr(config, key_name, value)[0m

[31m--[ [0m[34mMatch #[0m[33m955[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m989 | [0m[35m                raise ValueError(f"option '{key}' in {name} is readony, cannot be set")[0m
[30;1m990 | [0m[35m            cls._convert(name, obj, key, value)[0m
[30;1m991 | [0m[35m            cls._validate_config_trait(name, obj, key, value, config)[0m
[30;1m992 | [0m[35m            options[obj.get("flag")] = value[0m
[30;1m993 | [0m[35m[0m
[30;1m994 | [0m[35m        return options[0m
[30;1m995 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m956[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m985 | [0m[35m        options = {}[0m
[30;1m986 | [0m[35m        for key, value in override_options.items():[0m
[30;1m987 | [0m[35m            obj = cls._get_obj(key, allow_abbr=True)[0m
[30;1m988 | [0m[35m            if obj.get("flag") in config.read_only_trait_names:[0m
[30;1m989 | [0m[35m                raise ValueError(f"option '{key}' in {name} is readony, cannot be set")[0m
[30;1m990 | [0m[35m            cls._convert(name, obj, key, value)[0m
[30;1m991 | [0m[35m            cls._validate_config_trait(name, obj, key, value, config)[0m

[31m--[ [0m[34mMatch #[0m[33m957[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m583 | [0m[35m            usupported_properties = [][0m
[30;1m584 | [0m[35m            for p in properties:[0m
[30;1m585 | [0m[35m                prop = cls._QUERY_PROPERTIES_TABLE[p][0m
[30;1m586 | [0m[35m                prop_schema_list = prop.get("schema")[0m
[30;1m587 | [0m[35m                if type(prop_schema_list) == list and schema not in prop_schema_list and len(prop_sc[0m
[30;1m588 | [0m[35m                    usupported_properties.append(p)[0m
[30;1m589 | [0m[35m                if len(usupported_properties) > 0:[0m

[31m--[ [0m[34mMatch #[0m[33m958[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m571 | [0m[35m        if len(params) > max_params:[0m
[30;1m572 | [0m[35m            raise ValueError(f"command --{command_name} has too many parameters")[0m
[30;1m573 | [0m[35m[0m
[30;1m574 | [0m[35m        min_params = obj.get("min_params") or (1 if _type is not None else 0)[0m
[30;1m575 | [0m[35m[0m
[30;1m576 | [0m[35m        if len(params) < min_params:[0m
[30;1m577 | [0m[35m            raise ValueError(f"command --{command_name} is missing parameter")[0m

[31m--[ [0m[34mMatch #[0m[33m959[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m566 | [0m[35m        obj = command.get("obj")[0m
[30;1m567 | [0m[35m        _type = obj.get("type")[0m
[30;1m568 | [0m[35m[0m
[30;1m569 | [0m[35m        max_params = obj.get("max_params") or (1 if _type is not None else 0)[0m
[30;1m570 | [0m[35m[0m
[30;1m571 | [0m[35m        if len(params) > max_params:[0m
[30;1m572 | [0m[35m            raise ValueError(f"command --{command_name} has too many parameters")[0m

[31m--[ [0m[34mMatch #[0m[33m960[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m564 | [0m[35m        params = command.get("params")[0m
[30;1m565 | [0m[35m        command_name = command.get("command")[0m
[30;1m566 | [0m[35m        obj = command.get("obj")[0m
[30;1m567 | [0m[35m        _type = obj.get("type")[0m
[30;1m568 | [0m[35m[0m
[30;1m569 | [0m[35m        max_params = obj.get("max_params") or (1 if _type is not None else 0)[0m
[30;1m570 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m961[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m563 | [0m[35m    def _validate_kql_command_params(cls, command:dict):[0m
[30;1m564 | [0m[35m        params = command.get("params")[0m
[30;1m565 | [0m[35m        command_name = command.get("command")[0m
[30;1m566 | [0m[35m        obj = command.get("obj")[0m
[30;1m567 | [0m[35m        _type = obj.get("type")[0m
[30;1m568 | [0m[35m[0m
[30;1m569 | [0m[35m        max_params = obj.get("max_params") or (1 if _type is not None else 0)[0m

[31m--[ [0m[34mMatch #[0m[33m962[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m562 | [0m[35m    @classmethod[0m
[30;1m563 | [0m[35m    def _validate_kql_command_params(cls, command:dict):[0m
[30;1m564 | [0m[35m        params = command.get("params")[0m
[30;1m565 | [0m[35m        command_name = command.get("command")[0m
[30;1m566 | [0m[35m        obj = command.get("obj")[0m
[30;1m567 | [0m[35m        _type = obj.get("type")[0m
[30;1m568 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m963[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m561 | [0m[35m[0m
[30;1m562 | [0m[35m    @classmethod[0m
[30;1m563 | [0m[35m    def _validate_kql_command_params(cls, command:dict):[0m
[30;1m564 | [0m[35m        params = command.get("params")[0m
[30;1m565 | [0m[35m        command_name = command.get("command")[0m
[30;1m566 | [0m[35m        obj = command.get("obj")[0m
[30;1m567 | [0m[35m        _type = obj.get("type")[0m

[31m--[ [0m[34mMatch #[0m[33m964[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m553 | [0m[35m                cell_rest, params = cls._parse_kql_command_params(command, cell_rest, DONT_EXIT_ON_O[0m
[30;1m554 | [0m[35m                cell_rest = ""[0m
[30;1m555 | [0m[35m            elif "default" in obj:[0m
[30;1m556 | [0m[35m                params.append(obj.get("default"))[0m
[30;1m557 | [0m[35m            command["params"] = params[0m
[30;1m558 | [0m[35m[0m
[30;1m559 | [0m[35m        return cell_rest[0m

[31m--[ [0m[34mMatch #[0m[33m965[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m548 | [0m[35m                params.append(cell_rest)[0m
[30;1m549 | [0m[35m                cell_rest = ""[0m
[30;1m550 | [0m[35m[0m
[30;1m551 | [0m[35m            elif len(cell_rest) > 0 and obj.get("type") is not None:[0m
[30;1m552 | [0m[35m                DONT_EXIT_ON_OPTION = False[0m
[30;1m553 | [0m[35m                cell_rest, params = cls._parse_kql_command_params(command, cell_rest, DONT_EXIT_ON_O[0m
[30;1m554 | [0m[35m                cell_rest = ""[0m

[31m--[ [0m[34mMatch #[0m[33m966[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m544 | [0m[35m        params = command.get("params")[0m
[30;1m545 | [0m[35m        if len(params) == 0:[0m
[30;1m546 | [0m[35m            obj = command.get("obj")[0m
[30;1m547 | [0m[35m            if obj.get("type") == "not_quoted_str":[0m
[30;1m548 | [0m[35m                params.append(cell_rest)[0m
[30;1m549 | [0m[35m                cell_rest = ""[0m
[30;1m550 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m967[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m543 | [0m[35m    def _update_kql_command_params(cls, command:dict, cell_rest:str, user_ns:Dict[str,Any])->str:[0m
[30;1m544 | [0m[35m        params = command.get("params")[0m
[30;1m545 | [0m[35m        if len(params) == 0:[0m
[30;1m546 | [0m[35m            obj = command.get("obj")[0m
[30;1m547 | [0m[35m            if obj.get("type") == "not_quoted_str":[0m
[30;1m548 | [0m[35m                params.append(cell_rest)[0m
[30;1m549 | [0m[35m                cell_rest = ""[0m

[31m--[ [0m[34mMatch #[0m[33m968[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m541 | [0m[35m[0m
[30;1m542 | [0m[35m    @classmethod[0m
[30;1m543 | [0m[35m    def _update_kql_command_params(cls, command:dict, cell_rest:str, user_ns:Dict[str,Any])->str:[0m
[30;1m544 | [0m[35m        params = command.get("params")[0m
[30;1m545 | [0m[35m        if len(params) == 0:[0m
[30;1m546 | [0m[35m            obj = command.get("obj")[0m
[30;1m547 | [0m[35m            if obj.get("type") == "not_quoted_str":[0m

[31m--[ [0m[34mMatch #[0m[33m969[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m510 | [0m[35m                trimmed_code = ""[0m
[30;1m511 | [0m[35m        elif params_type is not None:[0m
[30;1m512 | [0m[35m            skip_words_count = 0[0m
[30;1m513 | [0m[35m            command_name = command.get("command")[0m
[30;1m514 | [0m[35m            words = code.split()[0m
[30;1m515 | [0m[35m            for word in words:[0m
[30;1m516 | [0m[35m                if skip_words_count == 0:[0m

[31m--[ [0m[34mMatch #[0m[33m970[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m500 | [0m[35m        trimmed_code = code.strip()[0m
[30;1m501 | [0m[35m        params = command.get("params")[0m
[30;1m502 | [0m[35m        obj = command.get("obj")[0m
[30;1m503 | [0m[35m        params_type = obj.get("type")[0m
[30;1m504 | [0m[35m        if params_type == "not_quoted_str":[0m
[30;1m505 | [0m[35m            if exit_on_options and trimmed_code.startswith("-"):[0m
[30;1m506 | [0m[35m                # DO NOTHING, EXIT[0m

[31m--[ [0m[34mMatch #[0m[33m971[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m499 | [0m[35m    def _parse_kql_command_params(cls, command:dict, code:str, exit_on_options:bool, user_ns:Dict[st[0m
[30;1m500 | [0m[35m        trimmed_code = code.strip()[0m
[30;1m501 | [0m[35m        params = command.get("params")[0m
[30;1m502 | [0m[35m        obj = command.get("obj")[0m
[30;1m503 | [0m[35m        params_type = obj.get("type")[0m
[30;1m504 | [0m[35m        if params_type == "not_quoted_str":[0m
[30;1m505 | [0m[35m            if exit_on_options and trimmed_code.startswith("-"):[0m

[31m--[ [0m[34mMatch #[0m[33m972[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m498 | [0m[35m    @classmethod[0m
[30;1m499 | [0m[35m    def _parse_kql_command_params(cls, command:dict, code:str, exit_on_options:bool, user_ns:Dict[st[0m
[30;1m500 | [0m[35m        trimmed_code = code.strip()[0m
[30;1m501 | [0m[35m        params = command.get("params")[0m
[30;1m502 | [0m[35m        obj = command.get("obj")[0m
[30;1m503 | [0m[35m        params_type = obj.get("type")[0m
[30;1m504 | [0m[35m        if params_type == "not_quoted_str":[0m

[31m--[ [0m[34mMatch #[0m[33m973[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m490 | [0m[35m            if magic_name in ["py", "pyro", "pyrw"]:[0m
[30;1m491 | [0m[35m                obj = COMMANDS_TABLE.get(magic_name)[0m
[30;1m492 | [0m[35m                body = params[0] if command_name == "line_magic" else f"{params[0]}\n{params[1]}"[0m
[30;1m493 | [0m[35m                return ("", {"command": obj.get("flag"), "obj": obj, "params": [body, magic_name]})[0m
[30;1m494 | [0m[35m[0m
[30;1m495 | [0m[35m        return (trimmed_code.strip(), {"command": command_name, "obj": obj, "params": params})[0m
[30;1m496 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m974[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m488 | [0m[35m            params.append(magic_name) # the magic name[0m
[30;1m489 | [0m[35m[0m
[30;1m490 | [0m[35m            if magic_name in ["py", "pyro", "pyrw"]:[0m
[30;1m491 | [0m[35m                obj = COMMANDS_TABLE.get(magic_name)[0m
[30;1m492 | [0m[35m                body = params[0] if command_name == "line_magic" else f"{params[0]}\n{params[1]}"[0m
[30;1m493 | [0m[35m                return ("", {"command": obj.get("flag"), "obj": obj, "params": [body, magic_name]})[0m
[30;1m494 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m975[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m443 | [0m[35m                command_name = obj.get("flag")[0m
[30;1m444 | [0m[35m                trimmed_code = trimmed_code[trimmed_code.find(word) + len(word):][0m
[30;1m445 | [0m[35m[0m
[30;1m446 | [0m[35m                params_type = obj.get("type")[0m
[30;1m447 | [0m[35m[0m
[30;1m448 | [0m[35m                if params_type is None:[0m
[30;1m449 | [0m[35m                    break[0m

[31m--[ [0m[34mMatch #[0m[33m976[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m440 | [0m[35m                obj = COMMANDS_TABLE.get(lookup_key)[0m
[30;1m441 | [0m[35m                if obj is None:[0m
[30;1m442 | [0m[35m                    raise ValueError(f"unknown command --{word}")[0m
[30;1m443 | [0m[35m                command_name = obj.get("flag")[0m
[30;1m444 | [0m[35m                trimmed_code = trimmed_code[trimmed_code.find(word) + len(word):][0m
[30;1m445 | [0m[35m[0m
[30;1m446 | [0m[35m                params_type = obj.get("type")[0m

[31m--[ [0m[34mMatch #[0m[33m977[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m437 | [0m[35m                if word.startswith("-"):[0m
[30;1m438 | [0m[35m                    raise ValueError(f"unknown command --{word}, commands' prefix should be a double[0m
[30;1m439 | [0m[35m                lookup_key = word.lower().replace("_", "").replace("-", "")[0m
[30;1m440 | [0m[35m                obj = COMMANDS_TABLE.get(lookup_key)[0m
[30;1m441 | [0m[35m                if obj is None:[0m
[30;1m442 | [0m[35m                    raise ValueError(f"unknown command --{word}")[0m
[30;1m443 | [0m[35m                command_name = obj.get("flag")[0m

[31m--[ [0m[34mMatch #[0m[33m978[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m400 | [0m[35m                    body = body[len(first_line) + 1:][0m
[30;1m401 | [0m[35m[0m
[30;1m402 | [0m[35m                params.append(body)[0m
[30;1m403 | [0m[35m                params.append(section.get("name"))[0m
[30;1m404 | [0m[35m[0m
[30;1m405 | [0m[35m                return ("", {"command": command_name, "obj": obj, "params": params})[0m
[30;1m406 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m979[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m393 | [0m[35m                command_name = obj.get("flag")[0m
[30;1m394 | [0m[35m[0m
[30;1m395 | [0m[35m                params = [][0m
[30;1m396 | [0m[35m                body = section.get("body")[0m
[30;1m397 | [0m[35m                if command_name == "cell_magic":[0m
[30;1m398 | [0m[35m                    first_line = body.split("\n",1)[0][0m
[30;1m399 | [0m[35m                    params.append(first_line.strip())[0m

[31m--[ [0m[34mMatch #[0m[33m980[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m390 | [0m[35m                # line/cell magic[0m
[30;1m391 | [0m[35m                name = section.get("type")[0m
[30;1m392 | [0m[35m                obj = COMMANDS_TABLE.get(name.replace("_", ""))[0m
[30;1m393 | [0m[35m                command_name = obj.get("flag")[0m
[30;1m394 | [0m[35m[0m
[30;1m395 | [0m[35m                params = [][0m
[30;1m396 | [0m[35m                body = section.get("body")[0m

[31m--[ [0m[34mMatch #[0m[33m981[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m389 | [0m[35m            else:[0m
[30;1m390 | [0m[35m                # line/cell magic[0m
[30;1m391 | [0m[35m                name = section.get("type")[0m
[30;1m392 | [0m[35m                obj = COMMANDS_TABLE.get(name.replace("_", ""))[0m
[30;1m393 | [0m[35m                command_name = obj.get("flag")[0m
[30;1m394 | [0m[35m[0m
[30;1m395 | [0m[35m                params = [][0m

[31m--[ [0m[34mMatch #[0m[33m982[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m388 | [0m[35m                return ("", {"command": obj.get("flag"), "obj": obj, "params": [section.get("body"),[0m
[30;1m389 | [0m[35m            else:[0m
[30;1m390 | [0m[35m                # line/cell magic[0m
[30;1m391 | [0m[35m                name = section.get("type")[0m
[30;1m392 | [0m[35m                obj = COMMANDS_TABLE.get(name.replace("_", ""))[0m
[30;1m393 | [0m[35m                command_name = obj.get("flag")[0m
[30;1m394 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m983[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m385 | [0m[35m            name = section.get("name").replace("_", "").replace("-", "")[0m
[30;1m386 | [0m[35m            if name in ["py", "pyro", "pyrw"]:[0m
[30;1m387 | [0m[35m                obj = COMMANDS_TABLE.get(name)[0m
[30;1m388 | [0m[35m                return ("", {"command": obj.get("flag"), "obj": obj, "params": [section.get("body"),[0m
[30;1m389 | [0m[35m            else:[0m
[30;1m390 | [0m[35m                # line/cell magic[0m
[30;1m391 | [0m[35m                name = section.get("type")[0m

[31m--[ [0m[34mMatch #[0m[33m984[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m385 | [0m[35m            name = section.get("name").replace("_", "").replace("-", "")[0m
[30;1m386 | [0m[35m            if name in ["py", "pyro", "pyrw"]:[0m
[30;1m387 | [0m[35m                obj = COMMANDS_TABLE.get(name)[0m
[30;1m388 | [0m[35m                return ("", {"command": obj.get("flag"), "obj": obj, "params": [section.get("body"),[0m
[30;1m389 | [0m[35m            else:[0m
[30;1m390 | [0m[35m                # line/cell magic[0m
[30;1m391 | [0m[35m                name = section.get("type")[0m

[31m--[ [0m[34mMatch #[0m[33m985[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m384 | [0m[35m        if section.get("name") != Constants.MAGIC_NAME:[0m
[30;1m385 | [0m[35m            name = section.get("name").replace("_", "").replace("-", "")[0m
[30;1m386 | [0m[35m            if name in ["py", "pyro", "pyrw"]:[0m
[30;1m387 | [0m[35m                obj = COMMANDS_TABLE.get(name)[0m
[30;1m388 | [0m[35m                return ("", {"command": obj.get("flag"), "obj": obj, "params": [section.get("body"),[0m
[30;1m389 | [0m[35m            else:[0m
[30;1m390 | [0m[35m                # line/cell magic[0m

[31m--[ [0m[34mMatch #[0m[33m986[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m382 | [0m[35m    def _parse_kql_command(cls, section:Dict[str,str], user_ns:Dict[str,Any])->Tuple[str,Dict[str,An[0m
[30;1m383 | [0m[35m        code = section.get("body")[0m
[30;1m384 | [0m[35m        if section.get("name") != Constants.MAGIC_NAME:[0m
[30;1m385 | [0m[35m            name = section.get("name").replace("_", "").replace("-", "")[0m
[30;1m386 | [0m[35m            if name in ["py", "pyro", "pyrw"]:[0m
[30;1m387 | [0m[35m                obj = COMMANDS_TABLE.get(name)[0m
[30;1m388 | [0m[35m                return ("", {"command": obj.get("flag"), "obj": obj, "params": [section.get("body"),[0m

[31m--[ [0m[34mMatch #[0m[33m987[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m381 | [0m[35m    @classmethod[0m
[30;1m382 | [0m[35m    def _parse_kql_command(cls, section:Dict[str,str], user_ns:Dict[str,Any])->Tuple[str,Dict[str,An[0m
[30;1m383 | [0m[35m        code = section.get("body")[0m
[30;1m384 | [0m[35m        if section.get("name") != Constants.MAGIC_NAME:[0m
[30;1m385 | [0m[35m            name = section.get("name").replace("_", "").replace("-", "")[0m
[30;1m386 | [0m[35m            if name in ["py", "pyro", "pyrw"]:[0m
[30;1m387 | [0m[35m                obj = COMMANDS_TABLE.get(name)[0m

[31m--[ [0m[34mMatch #[0m[33m988[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m380 | [0m[35m[0m
[30;1m381 | [0m[35m    @classmethod[0m
[30;1m382 | [0m[35m    def _parse_kql_command(cls, section:Dict[str,str], user_ns:Dict[str,Any])->Tuple[str,Dict[str,An[0m
[30;1m383 | [0m[35m        code = section.get("body")[0m
[30;1m384 | [0m[35m        if section.get("name") != Constants.MAGIC_NAME:[0m
[30;1m385 | [0m[35m            name = section.get("name").replace("_", "").replace("-", "")[0m
[30;1m386 | [0m[35m            if name in ["py", "pyro", "pyrw"]:[0m

[31m--[ [0m[34mMatch #[0m[33m989[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m301 | [0m[35m                kql, options = cls._parse_kql_options(code, is_cell, config, user_ns)[0m
[30;1m302 | [0m[35m[0m
[30;1m303 | [0m[35m                parser = CP.ConfigParser()[0m
[30;1m304 | [0m[35m                dsn_filename = adjust_path(options.get("dsn_filename", config.dsn_filename))[0m
[30;1m305 | [0m[35m                parser.read(dsn_filename)[0m
[30;1m306 | [0m[35m                cfg_dict = dict(parser.items(section))[0m
[30;1m307 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m990[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m260 | [0m[35m        cell = cell.strip()[0m
[30;1m261 | [0m[35m        parsed_queries = [][0m
[30;1m262 | [0m[35m        cell, command = cls._parse_kql_command(cell, user_ns)[0m
[30;1m263 | [0m[35m        command_name = command.get("command")[0m
[30;1m264 | [0m[35m        if command_name is not None and command_name != "submit":[0m
[30;1m265 | [0m[35m            cell_rest, options = cls._parse_kql_options(cell.strip(), is_cell, config, user_ns)[0m
[30;1m266 | [0m[35m            cell_rest = cls._update_kql_command_params(command, cell_rest, user_ns)[0m

[31m--[ [0m[34mMatch #[0m[33m991[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m204 | [0m[35m                kql, options = cls._parse_kql_options(code, is_cell, config, user_ns)[0m
[30;1m205 | [0m[35m[0m
[30;1m206 | [0m[35m                parser = CP.ConfigParser()[0m
[30;1m207 | [0m[35m                dsn_filename = adjust_path(options.get("dsn_filename", config.dsn_filename))[0m
[30;1m208 | [0m[35m                parser.read(dsn_filename)[0m
[30;1m209 | [0m[35m                cfg_dict = dict(parser.items(section))[0m
[30;1m210 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m992[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m163 | [0m[35m        """Separate input into (connection info, KQL statements, options)"""[0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35m        cell, command = cls._parse_kql_command(section, user_ns)[0m
[30;1m166 | [0m[35m        command_name = command.get("command")[0m
[30;1m167 | [0m[35m        if command_name is not None and command_name != "submit":[0m
[30;1m168 | [0m[35m            cell_rest, options = cls._parse_kql_options(cell.strip(), is_cell, config, user_ns)[0m
[30;1m169 | [0m[35m            cell_rest = cls._update_kql_command_params(command, cell_rest, user_ns)[0m

[31m--[ [0m[34mMatch #[0m[33m993[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m148 | [0m[35m            elif len(parsed_section.get("command")) == 0:[0m
[30;1m149 | [0m[35m                parsed_section["connection_string"] = last_connection_string[0m
[30;1m150 | [0m[35m            if suppress_all_results:[0m
[30;1m151 | [0m[35m                parsed_section.get("options")["suppress_results"] = True[0m
[30;1m152 | [0m[35m            [0m
[30;1m153 | [0m[35m            parsed_sections.append(parsed_section)[0m
[30;1m154 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m994[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m145 | [0m[35m            connection_string = parsed_section.get("connection_string")[0m
[30;1m146 | [0m[35m            if connection_string:[0m
[30;1m147 | [0m[35m                last_connection_string = connection_string[0m
[30;1m148 | [0m[35m            elif len(parsed_section.get("command")) == 0:[0m
[30;1m149 | [0m[35m                parsed_section["connection_string"] = last_connection_string[0m
[30;1m150 | [0m[35m            if suppress_all_results:[0m
[30;1m151 | [0m[35m                parsed_section.get("options")["suppress_results"] = True[0m

[31m--[ [0m[34mMatch #[0m[33m995[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m142 | [0m[35m        last_connection_string = ""[0m
[30;1m143 | [0m[35m        for section in sections:[0m
[30;1m144 | [0m[35m            parsed_section = cls._parse_one_section(section, is_cell, config, engines, user_ns)[0m
[30;1m145 | [0m[35m            connection_string = parsed_section.get("connection_string")[0m
[30;1m146 | [0m[35m            if connection_string:[0m
[30;1m147 | [0m[35m                last_connection_string = connection_string[0m
[30;1m148 | [0m[35m            elif len(parsed_section.get("command")) == 0:[0m

[31m--[ [0m[34mMatch #[0m[33m996[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m                    sections.append({"type": "cell_magic", "name": magic_section_name, "body": "".jo[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m            if len(sections) > 0:[0m
[30;1m127 | [0m[35m                last_query = sections[-1].get("body").strip()[0m
[30;1m128 | [0m[35m                if last_query == ";":[0m
[30;1m129 | [0m[35m                    suppress_all_results = True[0m
[30;1m130 | [0m[35m                    sections = sections[:-1][0m

[31m--[ [0m[34mMatch #[0m[33m997[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m93 | [0m[35m                    section_lines.append(line)[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m                elif (lstripped_line.startswith(Constants.IPYKERNEL_LINE_MAGIC_PREFIX)[0m
[30;1m96 | [0m[35m                      and (previous_line.isspace() or (len(sections) > 0 and sections[-1].get("type"[0m
[30;1m97 | [0m[35m                    magic_word = lstripped_line.split(None, 1)[0][0m
[30;1m98 | [0m[35m                    magic_name = magic_word[len(Constants.IPYKERNEL_LINE_MAGIC_PREFIX):][0m
[30;1m99 | [0m[35m                    lstripped_line = lstripped_line[len(magic_word):].lstrip()[0m

[31m--[ [0m[34mMatch #[0m[33m998[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m                lstripped_line = line.lstrip()[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m                if (lstripped_line.startswith(Constants.IPYKERNEL_CELL_MAGIC_PREFIX)[0m
[30;1m80 | [0m[35m                        and (previous_line.isspace() or (len(sections) > 0 and sections[-1].get("typ[0m
[30;1m81 | [0m[35m                    if len(section_lines) > 0:[0m
[30;1m82 | [0m[35m                        sections.append({"type": "cell_magic", "name": magic_section_name, "body": "[0m
[30;1m83 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m999[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m            if "abbreviation" not in obj:[0m
[30;1m50 | [0m[35m                name = obj.get("flag")[0m
[30;1m51 | [0m[35m                if "init" in obj:[0m
[30;1m52 | [0m[35m                    cls.default_options[name] = obj.get("init")[0m
[30;1m53 | [0m[35m                elif name in cls.traits_dict:[0m
[30;1m54 | [0m[35m                    cls.default_options[name] = getattr(config, name)[0m
[30;1m55 | [0m[35m                elif "abbreviation" not in obj:[0m

[31m--[ [0m[34mMatch #[0m[33m1000[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m47 | [0m[35m    def init_default_options(cls, config:Configurable):[0m
[30;1m48 | [0m[35m        for obj in cls._OPTIONS_TABLE.values():[0m
[30;1m49 | [0m[35m            if "abbreviation" not in obj:[0m
[30;1m50 | [0m[35m                name = obj.get("flag")[0m
[30;1m51 | [0m[35m                if "init" in obj:[0m
[30;1m52 | [0m[35m                    cls.default_options[name] = obj.get("init")[0m
[30;1m53 | [0m[35m                elif name in cls.traits_dict:[0m

[31m--[ [0m[34mMatch #[0m[33m1001[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m40 | [0m[35m            name = change.get('name')[0m
[30;1m41 | [0m[35m            obj = Parser._OPTIONS_TABLE.get(name.lower().replace("-", "").replace("_", ""))[0m
[30;1m42 | [0m[35m            if "init" not in obj:[0m
[30;1m43 | [0m[35m                Parser.default_options[change.get('name')] = change.get('new')[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m    @classmethod[0m

[31m--[ [0m[34mMatch #[0m[33m1002[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m40 | [0m[35m            name = change.get('name')[0m
[30;1m41 | [0m[35m            obj = Parser._OPTIONS_TABLE.get(name.lower().replace("-", "").replace("_", ""))[0m
[30;1m42 | [0m[35m            if "init" not in obj:[0m
[30;1m43 | [0m[35m                Parser.default_options[change.get('name')] = change.get('new')[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m    @classmethod[0m

[31m--[ [0m[34mMatch #[0m[33m1003[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m38 | [0m[35m    def observe_config_changes(change:Dict[str,str]): [0m
[30;1m39 | [0m[35m        if change.get('type') == 'change':[0m
[30;1m40 | [0m[35m            name = change.get('name')[0m
[30;1m41 | [0m[35m            obj = Parser._OPTIONS_TABLE.get(name.lower().replace("-", "").replace("_", ""))[0m
[30;1m42 | [0m[35m            if "init" not in obj:[0m
[30;1m43 | [0m[35m                Parser.default_options[change.get('name')] = change.get('new')[0m
[30;1m44 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1004[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m37 | [0m[35m    @staticmethod[0m
[30;1m38 | [0m[35m    def observe_config_changes(change:Dict[str,str]): [0m
[30;1m39 | [0m[35m        if change.get('type') == 'change':[0m
[30;1m40 | [0m[35m            name = change.get('name')[0m
[30;1m41 | [0m[35m            obj = Parser._OPTIONS_TABLE.get(name.lower().replace("-", "").replace("_", ""))[0m
[30;1m42 | [0m[35m            if "init" not in obj:[0m
[30;1m43 | [0m[35m                Parser.default_options[change.get('name')] = change.get('new')[0m

[31m--[ [0m[34mMatch #[0m[33m1005[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    @staticmethod[0m
[30;1m38 | [0m[35m    def observe_config_changes(change:Dict[str,str]): [0m
[30;1m39 | [0m[35m        if change.get('type') == 'change':[0m
[30;1m40 | [0m[35m            name = change.get('name')[0m
[30;1m41 | [0m[35m            obj = Parser._OPTIONS_TABLE.get(name.lower().replace("-", "").replace("_", ""))[0m
[30;1m42 | [0m[35m            if "init" not in obj:[0m

[31m--[ [0m[34mMatch #[0m[33m1006[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1239 | [0m[35m                    else:[0m
[30;1m1240 | [0m[35m                        raise ValueError("invalid key/value string, missing left parethesis.")[0m
[30;1m1241 | [0m[35m[0m
[30;1m1242 | [0m[35m                # key only at end of string[0m
[30;1m1243 | [0m[35m                elif r_idx < 0:[0m
[30;1m1244 | [0m[35m                    key = rest[0m
[30;1m1245 | [0m[35m                    val = ""[0m

[31m--[ [0m[34mMatch #[0m[33m1007[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m725 | [0m[35m        # NOT DOCUMENTED - (RemoteInOperandsInQuery): Enables remoting in operands.[0m
[30;1m726 | [0m[35m        "query_remote_in_operands": {"schema": [Schema.AZURE_DATA_EXPLORER], "type": "bool"},[0m
[30;1m727 | [0m[35m[0m
[30;1m728 | [0m[35m        # (OptionProgressiveQueryMinRowCountPerUpdate): Hint for Kusto as to how many records to sen[0m
[30;1m729 | [0m[35m        # (Takes effect only if OptionProgressiveQueryIsProgressive is set)[0m
[30;1m730 | [0m[35m        "query_results_progressive_row_count": {"schema": [Schema.AZURE_DATA_EXPLORER], "type": "uin[0m
[30;1m731 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1008[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1390 | [0m[35m                else:[0m
[30;1m1391 | [0m[35m                    raise ValueError[0m
[30;1m1392 | [0m[35m            elif _type == "iso8601_duration":[0m
[30;1m1393 | [0m[35m                # There are four ways to express a time interval:[0m
[30;1m1394 | [0m[35m                # Start and end, such as "2007-03-01T13:00:00Z/2008-05-11T15:30:00Z"[0m
[30;1m1395 | [0m[35m                # Start and duration, such as "2007-03-01T13:00:00Z/P1Y2M10DT2H30M"[0m
[30;1m1396 | [0m[35m                # Duration and end, such as "P1Y2M10DT2H30M/2008-05-11T15:30:00Z"[0m

[31m--[ [0m[34mMatch #[0m[33m1009[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1018 | [0m[35m            return string[0m
[30;1m1019 | [0m[35m[0m
[30;1m1020 | [0m[35m        # if we allow to bring value from python, we also allow from env variables[0m
[30;1m1021 | [0m[35m        # when we parse env vironment with option we fon't use user_ns[0m
[30;1m1022 | [0m[35m        if string.startswith('$') and user_ns:[0m
[30;1m1023 | [0m[35m            env_var_name = string[1:][0m
[30;1m1024 | [0m[35m            if not is_env_var(env_var_name):[0m

[31m--[ [0m[34mMatch #[0m[33m1010[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1017 | [0m[35m        if string == "" and _type == "str":[0m
[30;1m1018 | [0m[35m            return string[0m
[30;1m1019 | [0m[35m[0m
[30;1m1020 | [0m[35m        # if we allow to bring value from python, we also allow from env variables[0m
[30;1m1021 | [0m[35m        # when we parse env vironment with option we fon't use user_ns[0m
[30;1m1022 | [0m[35m        if string.startswith('$') and user_ns:[0m
[30;1m1023 | [0m[35m            env_var_name = string[1:][0m

[31m--[ [0m[34mMatch #[0m[33m1011[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m796 | [0m[35m        # see: https://dev.applicationinsights.io/documentation/Using-the-API/Cross-Resource-Queries[0m
[30;1m797 | [0m[35m        "applications": {"schema": [Schema.APPLICATION_INSIGHTS, Schema.AIMON], "type": "list"},[0m
[30;1m798 | [0m[35m[0m
[30;1m799 | [0m[35m        # The timespan over which to query data. This is an ISO8601 time period value. This timespan[0m
[30;1m800 | [0m[35m        # see: https://docs.microsoft.com/en-us/rest/api/application-insights/query/get[0m
[30;1m801 | [0m[35m        "timespan": {"schema": [Schema.APPLICATION_INSIGHTS, Schema.AIMON, Schema.LOG_ANALYTICS], "t[0m
[30;1m802 | [0m[35m    }[0m

[31m--[ [0m[34mMatch #[0m[33m1012[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m750 | [0m[35m        # (OptionRequestExternalTableDisabled): If specified, indicates that the request cannot invo[0m
[30;1m751 | [0m[35m        "request_external_table_disabled": {"schema": [Schema.AZURE_DATA_EXPLORER], "type": "bool"},[0m
[30;1m752 | [0m[35m[0m
[30;1m753 | [0m[35m        # (OptionDoNotImpersonate): If specified, indicates that the service shouldn't impersonate t[0m
[30;1m754 | [0m[35m        "request_impersonation_disabled": {"schema": [Schema.AZURE_DATA_EXPLORER], "type": "bool"},[0m
[30;1m755 | [0m[35m[0m
[30;1m756 | [0m[35m        # (OptionRequestReadOnly): If specified, indicates that the request must not be able to writ[0m

[31m--[ [0m[34mMatch #[0m[33m1013[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m695 | [0m[35m        # note: cannot be relative to now()[0m
[30;1m696 | [0m[35m        "query_now": {"schema": [Schema.AZURE_DATA_EXPLORER], "type": "str"},[0m
[30;1m697 | [0m[35m[0m
[30;1m698 | [0m[35m        # (OptionDebugPython): If set, generate python debug query for the enumerated python node (d[0m
[30;1m699 | [0m[35m        "query_python_debug": {"schema": [Schema.AZURE_DATA_EXPLORER], "type": "uint"},[0m
[30;1m700 | [0m[35m[0m
[30;1m701 | [0m[35m        # (OptionQueryResultsApplyGetSchema): If set, retrieves the schema of each tabular data in t[0m

[31m--[ [0m[34mMatch #[0m[33m1014[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m670 | [0m[35m        "query_datetimescope_to": {"schema": [Schema.AZURE_DATA_EXPLORER], "type": "str"},[0m
[30;1m671 | [0m[35m[0m
[30;1m672 | [0m[35m        # (OptionQueryDistributionNodesSpanSize): If set, controls the way sub-query merge behaves: [0m
[30;1m673 | [0m[35m        # the executing node will introduce an additional level in the query hierarchy for each sub-[0m
[30;1m674 | [0m[35m        "query_distribution_nodes_span": {"schema": [Schema.AZURE_DATA_EXPLORER], "type": "int"},[0m
[30;1m675 | [0m[35m[0m
[30;1m676 | [0m[35m        # (OptionQueryFanoutNodesPercent): The percentage of nodes to fanour execution to. [Int][0m

[31m--[ [0m[34mMatch #[0m[33m1015[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m627 | [0m[35m        # (OptionPushSelectionThroughAggregation): If true, push simple selection through aggregatio[0m
[30;1m628 | [0m[35m        "push_selection_through_aggregation": {"schema": [Schema.AZURE_DATA_EXPLORER], "type": "bool[0m
[30;1m629 | [0m[35m[0m
[30;1m630 | [0m[35m        # NOT DOCUMENTED - (OptionAdminSuperSlackerMode): If true, delegate execution of the query t[0m
[30;1m631 | [0m[35m        "query_admin_super_slacker_mode": {"schema": [Schema.AZURE_DATA_EXPLORER], "type": "bool"},[0m
[30;1m632 | [0m[35m[0m
[30;1m633 | [0m[35m        # (QueryBinAutoAt): When evaluating the bin_auto() function, the start value to use. [Litera[0m

[31m--[ [0m[34mMatch #[0m[33m1016[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m618 | [0m[35m        # (OptionMaxOutputColumns): Overrides the default maximum number of columns a query is allow[0m
[30;1m619 | [0m[35m        "maxoutputcolumns": {"schema": [Schema.AZURE_DATA_EXPLORER], "type": "uint"},[0m
[30;1m620 | [0m[35m[0m
[30;1m621 | [0m[35m        # (OptionNoRequestTimeout): Enables setting the request timeout to its maximum value. [Boole[0m
[30;1m622 | [0m[35m        "norequesttimeout": {"schema": [Schema.AZURE_DATA_EXPLORER], "type": "bool"},[0m
[30;1m623 | [0m[35m[0m
[30;1m624 | [0m[35m        # (OptionNoTruncation): Enables suppressing truncation of the query results returned to the [0m

[31m--[ [0m[34mMatch #[0m[33m1017[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m281 | [0m[35m            return parsed_queries[0m
[30;1m282 | [0m[35m[0m
[30;1m283 | [0m[35m        #[0m
[30;1m284 | [0m[35m        # replace substring of the form $name or ${name}, in windows also %name% if found in env var[0m
[30;1m285 | [0m[35m        #[0m
[30;1m286 | [0m[35m[0m
[30;1m287 | [0m[35m        connection_string = None[0m

[31m--[ [0m[34mMatch #[0m[33m1018[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m184 | [0m[35m            return parsed_query[0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35m        #[0m
[30;1m187 | [0m[35m        # replace substring of the form $name or ${name}, in windows also %name% if found in env var[0m
[30;1m188 | [0m[35m        #[0m
[30;1m189 | [0m[35m[0m
[30;1m190 | [0m[35m        connection_string = None[0m

[31m--[ [0m[34mMatch #[0m[33m1019[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/parser.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mfrom typing import Tuple, Dict, List, Any[0m
[30;1m8 | [0m[35mimport itertools[0m
[30;1m9 | [0m[35mimport configparser as CP[0m
[30;1m10 | [0m[35mfrom datetime import timedelta, datetime[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mimport dateutil.parser[0m

[31m--[ [0m[34mMatch #[0m[33m1020[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/_meta.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m# --------------------------------------------------------------------------[0m
[30;1m10 | [0m[35m# because it is also executed from setup.py, make sure[0m
[30;1m11 | [0m[35m# that it imports only modules, that for sure will exist at setup.py execution[0m
[30;1m12 | [0m[35m# TRY TO KEEP IMPORTS TO MINIMUM[0m
[30;1m13 | [0m[35m# --------------------------------------------------------------------------[0m
[30;1m14 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1021[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m831 | [0m[35m            if token is not None:[0m
[30;1m832 | [0m[35m                mandatory_properties = [["tokenType", "token_type"], ["accessToken", "access_token"][0m
[30;1m833 | [0m[35m                for pair in mandatory_properties:[0m
[30;1m834 | [0m[35m                    if token.get(pair[0]) is None and token.get(pair[1]) is None:[0m
[30;1m835 | [0m[35m                        raise ValueError(f"one of '{pair}' property is mandatory and is not set in t[0m
[30;1m836 | [0m[35m        except (AttributeError, ValueError) as e:[0m
[30;1m837 | [0m[35m            message = f"The 'try_token' trait of a {Constants.MAGIC_CLASS_NAME} instance {str(e)}"[0m

[31m--[ [0m[34mMatch #[0m[33m1022[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m831 | [0m[35m            if token is not None:[0m
[30;1m832 | [0m[35m                mandatory_properties = [["tokenType", "token_type"], ["accessToken", "access_token"][0m
[30;1m833 | [0m[35m                for pair in mandatory_properties:[0m
[30;1m834 | [0m[35m                    if token.get(pair[0]) is None and token.get(pair[1]) is None:[0m
[30;1m835 | [0m[35m                        raise ValueError(f"one of '{pair}' property is mandatory and is not set in t[0m
[30;1m836 | [0m[35m        except (AttributeError, ValueError) as e:[0m
[30;1m837 | [0m[35m            message = f"The 'try_token' trait of a {Constants.MAGIC_CLASS_NAME} instance {str(e)}"[0m

[31m--[ [0m[34mMatch #[0m[33m1023[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m814 | [0m[35m                        raise ValueError(f"unknown param '{key}'. Supported params: {valid_params}")[0m
[30;1m815 | [0m[35m                exclusive_pcount = 0[0m
[30;1m816 | [0m[35m                for key in ["client_id", "object_id", "msi_res_id"]:[0m
[30;1m817 | [0m[35m                    if msi_params.get(key) is not None:[0m
[30;1m818 | [0m[35m                        exclusive_pcount += 1[0m
[30;1m819 | [0m[35m                if exclusive_pcount > 1:[0m
[30;1m820 | [0m[35m                    raise ValueError("the following parameters are mutually exclusive and can not be[0m

[31m--[ [0m[34mMatch #[0m[33m1024[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m817 | [0m[35m                    if msi_params.get(key) is not None:[0m
[30;1m818 | [0m[35m                        exclusive_pcount += 1[0m
[30;1m819 | [0m[35m                if exclusive_pcount > 1:[0m
[30;1m820 | [0m[35m                    raise ValueError("the following parameters are mutually exclusive and can not be[0m
[30;1m821 | [0m[35m        except (AttributeError, ValueError) as e:[0m
[30;1m822 | [0m[35m            message = f"The 'try_msi' trait of a {Constants.MAGIC_CLASS_NAME} instance {str(e)}"[0m
[30;1m823 | [0m[35m            raise TraitError(message)[0m

[31m--[ [0m[34mMatch #[0m[33m1025[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m594 | [0m[35m        read_only=True,[0m
[30;1m595 | [0m[35m        allow_none=True, [0m
[30;1m596 | [0m[35m        config=True, [0m
[30;1m597 | [0m[35m        help=f"""comma separated list of setup extras_require values that should be the same as spec[0m
[30;1m598 | [0m[35m        It is read on {Constants.MAGIC_CLASS_NAME} load, from environment variable {Constants.MAGIC_[0m
[30;1m599 | [0m[35m        """[0m
[30;1m600 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m1026[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m190 | [0m[35m        config=True, [0m
[30;1m191 | [0m[35m        allow_none=True, [0m
[30;1m192 | [0m[35m        help=f"""Try first to use this token.\n[0m
[30;1m193 | [0m[35m        Should be a dictionary with at least this keys: tokenType/token_type, accessToken/access_tok[0m
[30;1m194 | [0m[35m    )[0m
[30;1m195 | [0m[35m[0m
[30;1m196 | [0m[35m    try_msi = _Dict([0m

[31m--[ [0m[34mMatch #[0m[33m1027[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m639 | [0m[35m        default_value=0, [0m
[30;1m640 | [0m[35m        config=True, [0m
[30;1m641 | [0m[35m        allow_none=True, [0m
[30;1m642 | [0m[35m        help=f"""specifies, in seconds, the maximum amount of time a cached response is valid for.\n[0m
[30;1m643 | [0m[35m        if set to 0, will bypass the response cache and always query the downstream services.\n[0m
[30;1m644 | [0m[35m        if set to None, will use cached reponse as long it doesn't expires.\n[0m
[30;1m645 | [0m[35m        Abbreviation: 'maxage'"""[0m

[31m--[ [0m[34mMatch #[0m[33m1028[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m461 | [0m[35m        read_only=True,[0m
[30;1m462 | [0m[35m        config=True, [0m
[30;1m463 | [0m[35m        allow_none=True, [0m
[30;1m464 | [0m[35m        help="""Notebook service address."""        [0m
[30;1m465 | [0m[35m    )[0m
[30;1m466 | [0m[35m[0m
[30;1m467 | [0m[35m    notebook_app = Enum([0m

[31m--[ [0m[34mMatch #[0m[33m1029[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m336 | [0m[35m    plotly_fs_includejs = Bool([0m
[30;1m337 | [0m[35m        default_value=False,[0m
[30;1m338 | [0m[35m        config=Dependencies.is_installed("plotly"),[0m
[30;1m339 | [0m[35m        help="""Include plotly javascript code in popup window. If set to False (default), it downlo[0m
[30;1m340 | [0m[35m        Abbreviation: 'pfi'"""[0m
[30;1m341 | [0m[35m    )[0m
[30;1m342 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1030[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m243 | [0m[35m        default_value=None, [0m
[30;1m244 | [0m[35m        config=True, [0m
[30;1m245 | [0m[35m        allow_none=True, [0m
[30;1m246 | [0m[35m        help="""Specifies the maximum time in seconds, to wait for a query response. None, means def[0m
[30;1m247 | [0m[35m        Abbreviation: 'to' or 'wait'"""[0m
[30;1m248 | [0m[35m    )[0m
[30;1m249 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1031[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m239 | [0m[35m        Abbreviation: 'caim'"""[0m
[30;1m240 | [0m[35m    )[0m
[30;1m241 | [0m[35m[0m
[30;1m242 | [0m[35m    timeout = Int([0m
[30;1m243 | [0m[35m        default_value=None, [0m
[30;1m244 | [0m[35m        config=True, [0m
[30;1m245 | [0m[35m        allow_none=True, [0m

[31m--[ [0m[34mMatch #[0m[33m1032[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_magic.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m199 | [0m[35m allow_none=True, [0m
[30;1m200 | [0m[35m        help=f"""Try first to get MSI token from MSI endpoint.[0m
[30;1m201 | [0m[35m        Should be a dictionary with the optional MSI params: resource, client_id/object_id/mis_res_i[0m
[30;1m202 | [0m[35m        # - timeout: If provided, must be in seconds and indicates the maximum time we'll try to get[0m
[30;1m203 | [0m[35m        # - client_id: Identifies, by Azure AD client id, a specific explicit identity to use when a[0m

[31m--[ [0m[34mMatch #[0m[33m1033[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/_version.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m# --------------------------------------------------------------------------[0m
[30;1m10 | [0m[35m# because it is also executed from setup.py, make sure[0m
[30;1m11 | [0m[35m# that it imports only modules, that for sure will exist at setup.py execution[0m
[30;1m12 | [0m[35m# TRY TO KEEP IMPORTS TO MINIMUM[0m
[30;1m13 | [0m[35m# --------------------------------------------------------------------------[0m
[30;1m14 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1034[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/msal_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m103 | [0m[35m                            and len(state_obj.get("random_string")) >= 1 [0m
[30;1m104 | [0m[35m                            and len(state_obj.get("random_string")) <= 100 [0m
[30;1m105 | [0m[35m                            and state_obj.get("cache_state") is not None):[0m
[30;1m106 | [0m[35m                        self._cache_state = state_obj.get("cache_state")[0m
[30;1m107 | [0m[35m                        super(MsalTokenCache, self).deserialize(self._cache_state)[0m
[30;1m108 | [0m[35m[0m
[30;1m109 | [0m[35melse:[0m

[31m--[ [0m[34mMatch #[0m[33m1035[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/msal_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m102 | [0m[35m                            and state_obj.get("random_string")[0m
[30;1m103 | [0m[35m                            and len(state_obj.get("random_string")) >= 1 [0m
[30;1m104 | [0m[35m                            and len(state_obj.get("random_string")) <= 100 [0m
[30;1m105 | [0m[35m                            and state_obj.get("cache_state") is not None):[0m
[30;1m106 | [0m[35m                        self._cache_state = state_obj.get("cache_state")[0m
[30;1m107 | [0m[35m                        super(MsalTokenCache, self).deserialize(self._cache_state)[0m
[30;1m108 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1036[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/msal_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m101 | [0m[35m                            and state_obj.get("timestamp") < int(datetime.utcnow().timestamp())[0m
[30;1m102 | [0m[35m                            and state_obj.get("random_string")[0m
[30;1m103 | [0m[35m                            and len(state_obj.get("random_string")) >= 1 [0m
[30;1m104 | [0m[35m                            and len(state_obj.get("random_string")) <= 100 [0m
[30;1m105 | [0m[35m                            and state_obj.get("cache_state") is not None):[0m
[30;1m106 | [0m[35m                        self._cache_state = state_obj.get("cache_state")[0m
[30;1m107 | [0m[35m                        super(MsalTokenCache, self).deserialize(self._cache_state)[0m

[31m--[ [0m[34mMatch #[0m[33m1037[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/msal_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m100 | [0m[35m                            and state_obj.get("package") == "msal"[0m
[30;1m101 | [0m[35m                            and state_obj.get("timestamp") < int(datetime.utcnow().timestamp())[0m
[30;1m102 | [0m[35m                            and state_obj.get("random_string")[0m
[30;1m103 | [0m[35m                            and len(state_obj.get("random_string")) >= 1 [0m
[30;1m104 | [0m[35m                            and len(state_obj.get("random_string")) <= 100 [0m
[30;1m105 | [0m[35m                            and state_obj.get("cache_state") is not None):[0m
[30;1m106 | [0m[35m                        self._cache_state = state_obj.get("cache_state")[0m

[31m--[ [0m[34mMatch #[0m[33m1038[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/msal_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m99 | [0m[35m                            and state_obj.get("version") == 2[0m
[30;1m100 | [0m[35m                            and state_obj.get("package") == "msal"[0m
[30;1m101 | [0m[35m                            and state_obj.get("timestamp") < int(datetime.utcnow().timestamp())[0m
[30;1m102 | [0m[35m                            and state_obj.get("random_string")[0m
[30;1m103 | [0m[35m                            and len(state_obj.get("random_string")) >= 1 [0m
[30;1m104 | [0m[35m                            and len(state_obj.get("random_string")) <= 100 [0m
[30;1m105 | [0m[35m                            and state_obj.get("cache_state") is not None):[0m

[31m--[ [0m[34mMatch #[0m[33m1039[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/msal_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m98 | [0m[35m                    if (state_obj.get("description") == "kqlmagic"[0m
[30;1m99 | [0m[35m                            and state_obj.get("version") == 2[0m
[30;1m100 | [0m[35m                            and state_obj.get("package") == "msal"[0m
[30;1m101 | [0m[35m                            and state_obj.get("timestamp") < int(datetime.utcnow().timestamp())[0m
[30;1m102 | [0m[35m                            and state_obj.get("random_string")[0m
[30;1m103 | [0m[35m                            and len(state_obj.get("random_string")) >= 1 [0m
[30;1m104 | [0m[35m                            and len(state_obj.get("random_string")) <= 100 [0m

[31m--[ [0m[34mMatch #[0m[33m1040[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/msal_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m97 | [0m[35m                    state_obj = json.loads(state)[0m
[30;1m98 | [0m[35m                    if (state_obj.get("description") == "kqlmagic"[0m
[30;1m99 | [0m[35m                            and state_obj.get("version") == 2[0m
[30;1m100 | [0m[35m                            and state_obj.get("package") == "msal"[0m
[30;1m101 | [0m[35m                            and state_obj.get("timestamp") < int(datetime.utcnow().timestamp())[0m
[30;1m102 | [0m[35m                            and state_obj.get("random_string")[0m
[30;1m103 | [0m[35m                            and len(state_obj.get("random_string")) >= 1 [0m

[31m--[ [0m[34mMatch #[0m[33m1041[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/msal_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m96 | [0m[35m                if state:[0m
[30;1m97 | [0m[35m                    state_obj = json.loads(state)[0m
[30;1m98 | [0m[35m                    if (state_obj.get("description") == "kqlmagic"[0m
[30;1m99 | [0m[35m                            and state_obj.get("version") == 2[0m
[30;1m100 | [0m[35m                            and state_obj.get("package") == "msal"[0m
[30;1m101 | [0m[35m                            and state_obj.get("timestamp") < int(datetime.utcnow().timestamp())[0m
[30;1m102 | [0m[35m                            and state_obj.get("random_string")[0m

[31m--[ [0m[34mMatch #[0m[33m1042[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/msal_token_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m95 | [0m[35m                state = state or self._store.restore()[0m
[30;1m96 | [0m[35m                if state:[0m
[30;1m97 | [0m[35m                    state_obj = json.loads(state)[0m
[30;1m98 | [0m[35m                    if (state_obj.get("description") == "kqlmagic"[0m
[30;1m99 | [0m[35m                            and state_obj.get("version") == 2[0m
[30;1m100 | [0m[35m                            and state_obj.get("package") == "msal"[0m
[30;1m101 | [0m[35m                            and state_obj.get("timestamp") < int(datetime.utcnow().timestamp())[0m

[31m--[ [0m[34mMatch #[0m[33m1043[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/msal_token_cache.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m80 | [0m[35m                        "version": 2,[0m
[30;1m81 | [0m[35m                        "package": "msal",[0m
[30;1m82 | [0m[35m                        "timestamp": int(datetime.utcnow().timestamp()),[0m
[30;1m83 | [0m[35m                        "random_string": self._random_string(),  # makes length and content differen[0m
[30;1m84 | [0m[35m                        "cache_state": self._cache_state,[0m
[30;1m85 | [0m[35m                    }[0m
[30;1m86 | [0m[35m                    state = json_dumps(state_obj)[0m

[31m--[ [0m[34mMatch #[0m[33m1044[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/HISTORY.rst[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m59 | [0m[35mremoved setup dwonload_url - Oct 17, 2018[0m
[30;1m60 | [0m[35mupdate setup description and README titles - Oct 17, 2018[0m
[30;1m61 | [0m[35mupdate README - Oct 17, 2018[0m
[30;1m62 | [0m[35mupdate README - Oct 17, 2018[0m
[30;1m63 | [0m[35mupdate README - Oct 17, 2018[0m
[30;1m64 | [0m[35mupdated README, and setup - 0.1.56 - Oct 17, 2018[0m
[30;1m65 | [0m[35mfix setup.py - fix setup.py[0m
[30;1m66 | [0m[35mremoved version restriction on traitlets - 0.1.55 - Oct 17, 2018[0m

[31m--[ [0m[34mMatch #[0m[33m1045[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/HISTORY.rst[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m57 | [0m[35mFixed setup.py long description to show properly work on PyPI - 0.1.57 -  Oct 17, 2018[0m
[30;1m58 | [0m[35mremoved setup dwonload_url - Oct 17, 2018[0m
[30;1m59 | [0m[35mupdate setup description and README titles - Oct 17, 2018[0m
[30;1m60 | [0m[35mupdate README - Oct 17, 2018[0m
[30;1m61 | [0m[35mupdate README - Oct 17, 2018[0m
[30;1m62 | [0m[35mupdate README - Oct 17, 2018[0m
[30;1m63 | [0m[35mupdated README, and setup - 0.1.56 - Oct 17, 2018[0m
[30;1m64 | [0m[35mfix setup.py - fix setup.py[0m

[31m--[ [0m[34mMatch #[0m[33m1046[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/HISTORY.rst[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m56 | [0m[35mupdate notebooks with new connection string format - Oct 18, 2018[0m
[30;1m57 | [0m[35mFixed setup.py long description to show properly work on PyPI - 0.1.57 -  Oct 17, 2018[0m
[30;1m58 | [0m[35mremoved setup dwonload_url - Oct 17, 2018[0m
[30;1m59 | [0m[35mupdate setup description and README titles - Oct 17, 2018[0m
[30;1m60 | [0m[35mupdate README - Oct 17, 2018[0m
[30;1m61 | [0m[35mupdate README - Oct 17, 2018[0m
[30;1m62 | [0m[35mupdate README - Oct 17, 2018[0m
[30;1m63 | [0m[35mupdated README, and setup - 0.1.56 - Oct 17, 2018[0m

[31m--[ [0m[34mMatch #[0m[33m1047[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/HISTORY.rst[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m55 | [0m[35mupdate notebooks - Oct 18, 2018[0m
[30;1m56 | [0m[35mupdate notebooks with new connection string format - Oct 18, 2018[0m
[30;1m57 | [0m[35mFixed setup.py long description to show properly work on PyPI - 0.1.57 -  Oct 17, 2018[0m
[30;1m58 | [0m[35mremoved setup dwonload_url - Oct 17, 2018[0m
[30;1m59 | [0m[35mupdate setup description and README titles - Oct 17, 2018[0m
[30;1m60 | [0m[35mupdate README - Oct 17, 2018[0m
[30;1m61 | [0m[35mupdate README - Oct 17, 2018[0m
[30;1m62 | [0m[35mupdate README - Oct 17, 2018[0m

[31m--[ [0m[34mMatch #[0m[33m1048[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/HISTORY.rst[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m53 | [0m[35mrestructure local files - Oct 18, 2018[0m
[30;1m54 | [0m[35mUpdate notebooks, created QuikStart fro log analytics notebook, updated README, version 0.1.58 - 0.1[0m
[30;1m55 | [0m[35mupdate notebooks - Oct 18, 2018[0m
[30;1m56 | [0m[35mupdate notebooks - Oct 18, 2018[0m
[30;1m57 | [0m[35mupdate notebooks with new connection string format - Oct 18, 2018[0m
[30;1m58 | [0m[35mFixed setup.py long description to show properly work on PyPI - 0.1.57 -  Oct 17, 2018[0m
[30;1m59 | [0m[35mremoved setup dwonload_url - Oct 17, 2018[0m
[30;1m60 | [0m[35mupdate setup description and README titles - Oct 17, 2018[0m

[31m--[ [0m[34mMatch #[0m[33m1049[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/HISTORY.rst[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m51 | [0m[35mupdate notebooks, added support to certificate pem_file, version 0.1.59 - 0.1.59 - Oct 18, 2018[0m
[30;1m52 | [0m[35mrestructure local files - Oct 18, 2018[0m
[30;1m53 | [0m[35mUpdate notebooks, created QuikStart fro log analytics notebook, updated README, version 0.1.58 - 0.1[0m
[30;1m54 | [0m[35mupdate notebooks - Oct 18, 2018[0m
[30;1m55 | [0m[35mupdate notebooks - Oct 18, 2018[0m
[30;1m56 | [0m[35mupdate notebooks with new connection string format - Oct 18, 2018[0m
[30;1m57 | [0m[35mFixed setup.py long description to show properly work on PyPI - 0.1.57 -  Oct 17, 2018[0m
[30;1m58 | [0m[35mremoved setup dwonload_url - Oct 17, 2018[0m

[31m--[ [0m[34mMatch #[0m[33m1050[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/HISTORY.rst[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m50 | [0m[35mfix to pandas convertion, for the case of missing int64 or missing bool, version 0.1.60 - 0.1.60 - O[0m
[30;1m51 | [0m[35mupdate notebooks, added support to certificate pem_file, version 0.1.59 - 0.1.59 - Oct 18, 2018[0m
[30;1m52 | [0m[35mrestructure local files - Oct 18, 2018[0m
[30;1m53 | [0m[35mUpdate notebooks, created QuikStart fro log analytics notebook, updated README, version 0.1.58 - 0.1[0m
[30;1m54 | [0m[35mupdate notebooks - Oct 18, 2018[0m
[30;1m55 | [0m[35mupdate notebooks - Oct 18, 2018[0m
[30;1m56 | [0m[35mupdate notebooks with new connection string format - Oct 18, 2018[0m
[30;1m57 | [0m[35mFixed setup.py long description to show properly work on PyPI - 0.1.57 -  Oct 17, 2018[0m

[31m--[ [0m[34mMatch #[0m[33m1051[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/HISTORY.rst[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m49 | [0m[35mror later. version 0.1.61 - 0.1.61 - Oct 20, 2018[0m
[30;1m50 | [0m[35mfix to pandas convertion, for the case of missing int64 or missing bool, version 0.1.60 - 0.1.60 - O[0m
[30;1m51 | [0m[35mupdate notebooks, added support to certificate pem_file, version 0.1.59 - 0.1.59 - Oct 18, 2018[0m
[30;1m52 | [0m[35mrestructure local files - Oct 18, 2018[0m
[30;1m53 | [0m[35mUpdate notebooks, created QuikStart fro log analytics notebook, updated README, version 0.1.58 - 0.1[0m
[30;1m54 | [0m[35mupdate notebooks - Oct 18, 2018[0m
[30;1m55 | [0m[35mupdate notebooks - Oct 18, 2018[0m
[30;1m56 | [0m[35mupdate notebooks with new connection string format - Oct 18, 2018[0m

[31m--[ [0m[34mMatch #[0m[33m1052[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/HISTORY.rst[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m48 | [0m[35me refactor, version 0.1.62 - 0.1.62 - Oct 21, 2018[0m
[30;1m49 | [0m[35mmoved the saved_as earlier in the pipe, to capture raw results even if there is an error later. vers[0m
[30;1m50 | [0m[35mfix to pandas convertion, for the case of missing int64 or missing bool, version 0.1.60 - 0.1.60 - O[0m
[30;1m51 | [0m[35mupdate notebooks, added support to certificate pem_file, version 0.1.59 - 0.1.59 - Oct 18, 2018[0m
[30;1m52 | [0m[35mrestructure local files - Oct 18, 2018[0m
[30;1m53 | [0m[35mUpdate notebooks, created QuikStart fro log analytics notebook, updated README, version 0.1.58 - 0.1[0m
[30;1m54 | [0m[35mupdate notebooks - Oct 18, 2018[0m

[31m--[ [0m[34mMatch #[0m[33m1053[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/HISTORY.rst[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m42 | [0m[35mpe; - 0.1.67 - Oct 25, 2018[0m
[30;1m43 | [0m[35msupport partial result, add command concept, added commands, 0.1.66 - 0.1.66 - Oct 25, 2018[0m
[30;1m44 | [0m[35moptions and connection key values can be parametyrize from python and env variables, new -query and [0m
[30;1m45 | [0m[35mparametrized options, add file://folder, update color notebook, 0.1.64 - 0.1.64 - Oct 22, 2018[0m
[30;1m46 | [0m[35mfix notebooks - Oct 22, 2018[0m
[30;1m47 | [0m[35mrun black on code, version 0.1.63 - 0.1.63 - Oct 22, 2018[0m
[30;1m48 | [0m[35mbug fix, code refactor, version 0.1.62 - 0.1.62 - Oct 21, 2018[0m

[31m--[ [0m[34mMatch #[0m[33m1054[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/HISTORY.rst[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m39 | [0m[35m caseinsensitive, ignore underscore and hyphen-minus, covert some options to commands, modify kusto [0m
[30;1m40 | [0m[35mfix clors notebook - Oct 25, 2018[0m
[30;1m41 | [0m[35mpopup_window option to all commands, fixed banner, update notebooks, 0.1.68 - 0.1.68 - Oct 25, 2018[0m
[30;1m42 | [0m[35mupdate notebooks with --version,; allow =setting in options, more quotes flexibility with values, su[0m
[30;1m43 | [0m[35msupport partial result, add command concept, added commands, 0.1.66 - 0.1.66 - Oct 25, 2018[0m

[31m--[ [0m[34mMatch #[0m[33m1055[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/HISTORY.rst[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m38 | [0m[35mmetrization. - 0.1.70 - Oct 31, 2018[0m
[30;1m39 | [0m[35mmake keys as caseinsensitive, ignore underscore and hyphen-minus, covert some options to commands, m[0m
[30;1m40 | [0m[35mfix clors notebook - Oct 25, 2018[0m
[30;1m41 | [0m[35mpopup_window option to all commands, fixed banner, update notebooks, 0.1.68 - 0.1.68 - Oct 25, 2018[0m
[30;1m42 | [0m[35mupdate notebooks with --version,; allow =setting in options, more quotes flexibility with values, su[0m
[30;1m43 | [0m[35msupport partial result, add command concept, added commands, 0.1.66 - 0.1.66 - Oct 25, 2018[0m

[31m--[ [0m[34mMatch #[0m[33m1056[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/HISTORY.rst[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m19 | [0m[35mynamic columns that are not strict json - 0.1.84 - Dec 11, 2018[0m
[30;1m20 | [0m[35mAlign to Kusto new V2 dynamic field response; fix kql.submit() - 0.1.83 - Dec 10, 2018[0m
[30;1m21 | [0m[35mbinder to use 0.1.82 - Dec 9, 2018[0m
[30;1m22 | [0m[35madded binder folder, with requirements - Dec 9, 2018[0m
[30;1m23 | [0m[35mfixed env KQLMAGIC_CONNECTION_STR - 0.1.82 - Dec 6, 2018[0m
[30;1m24 | [0m[35mupdate notebooks with anonymous authentication - Dec 3, 2018[0m
[30;1m25 | [0m[35mremoved tell_format; added anonymous authentication (for the case of local data source) - 0.1.81 - D[0m
[30;1m26 | [0m[35mRemoved dependency on azure.kusto sdk, use rest api to kusto. - 0.1.80 - Nov 13, 2018[0m

[31m--[ [0m[34mMatch #[0m[33m1057[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/HISTORY.rst[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m14 | [0m[35mfixed run_tests.bat - fixed run_tests.bat - Dec 20, 2018[0m
[30;1m15 | [0m[35mupdate binder requirements - update binder requirements - Dec 20, 2018[0m
[30;1m16 | [0m[35mAdjusted to support VisualStudioCode (Jupyter) notebook - 0.1.86 - Dec 18, 2018[0m
[30;1m17 | [0m[35madded support to "ipython" notebook_app, started a tests suits - 0.1.85 - Dec 17, 2018[0m
[30;1m18 | [0m[35mupdate binder requirements to 0.1.84 - Dec 16, 2018[0m
[30;1m19 | [0m[35mFix dynamic columns that are not strict json - 0.1.84 - Dec 11, 2018[0m
[30;1m20 | [0m[35mAlign to Kusto new V2 dynamic field response; fix kql.submit() - 0.1.83 - Dec 10, 2018[0m
[30;1m21 | [0m[35mbinder to use 0.1.82 - Dec 9, 2018[0m

[31m--[ [0m[34mMatch #[0m[33m1058[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/HISTORY.rst[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m12 | [0m[35madded test_notebook_app for testing, , commands instead of show_window return html object result. - [0m
[30;1m13 | [0m[35madded run_upgrade.bat; enhanced run_tests.bat - Dec 24, 2018[0m
[30;1m14 | [0m[35mfixed run_tests.bat - fixed run_tests.bat - Dec 20, 2018[0m
[30;1m15 | [0m[35mupdate binder requirements - update binder requirements - Dec 20, 2018[0m
[30;1m16 | [0m[35mAdjusted to support VisualStudioCode (Jupyter) notebook - 0.1.86 - Dec 18, 2018[0m
[30;1m17 | [0m[35madded support to "ipython" notebook_app, started a tests suits - 0.1.85 - Dec 17, 2018[0m
[30;1m18 | [0m[35mupdate binder requirements to 0.1.84 - Dec 16, 2018[0m

[31m--[ [0m[34mMatch #[0m[33m1059[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/HISTORY.rst[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m11 | [0m[35mversion 01.88, added --schema command - 0.1.88 - Jan 16, 2019[0m
[30;1m12 | [0m[35madded test_notebook_app for testing, , commands instead of show_window return html object result. - [0m
[30;1m13 | [0m[35madded run_upgrade.bat; enhanced run_tests.bat - Dec 24, 2018[0m
[30;1m14 | [0m[35mfixed run_tests.bat - fixed run_tests.bat - Dec 20, 2018[0m
[30;1m15 | [0m[35mupdate binder requirements - update binder requirements - Dec 20, 2018[0m
[30;1m16 | [0m[35mAdjusted to support VisualStudioCode (Jupyter) notebook - 0.1.86 - Dec 18, 2018[0m
[30;1m17 | [0m[35madded support to "ipython" notebook_app, started a tests suits - 0.1.85 - Dec 17, 2018[0m
[30;1m18 | [0m[35mupdate binder requirements to 0.1.84 - Dec 16, 2018[0m

[31m--[ [0m[34mMatch #[0m[33m1060[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/HISTORY.rst[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m6 | [0m[35m.93 - Mar 24, 2019[0m
[30;1m7 | [0m[35msupport database names with whitespaces; support ADX proxy over AI/LA cluster names; fix charts base[0m
[30;1m8 | [0m[35mallow v1 response from kusto api v2, support adx-proxy, - 0.1.91 - Feb 20, 2019[0m
[30;1m9 | [0m[35mfix to_dataframe bool - 0.1.90 - Jan 25, 2019[0m
[30;1m10 | [0m[35mupdate binder requirements to 0.1.88 - Jan 16, 2019[0m
[30;1m11 | [0m[35mversion 01.88, added --schema command - 0.1.88 - Jan 16, 2019[0m
[30;1m12 | [0m[35madded test_notebook_app for testing, , commands instead of show_window return html object result. - [0m
[30;1m13 | [0m[35madded run_upgrade.bat; enhanced run_tests.bat - Dec 24, 2018[0m

[31m--[ [0m[34mMatch #[0m[33m1061[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/HISTORY.rst[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m42 | [0m[35mbooks with --version,; allow =setting in options, more quotes flexibility with values, support optio[0m
[30;1m43 | [0m[35msupport partial result, add command concept, added commands, 0.1.66 - 0.1.66 - Oct 25, 2018[0m
[30;1m44 | [0m[35moptions and connection key values can be parametyrize from python and env variables, new -query and [0m
[30;1m45 | [0m[35mparametrized options, add file://folder, update color notebook, 0.1.64 - 0.1.64 - Oct 22, 2018[0m
[30;1m46 | [0m[35mfix notebooks - Oct 22, 2018[0m
[30;1m47 | [0m[35mrun black on code, version 0.1.63 - 0.1.63 - Oct 22, 2018[0m

[31m--[ [0m[34mMatch #[0m[33m1062[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/HISTORY.rst[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35mAlign to Kusto new V2 dynamic field response; fix kql.submit() - 0.1.83 - Dec 10, 2018[0m
[30;1m21 | [0m[35mbinder to use 0.1.82 - Dec 9, 2018[0m
[30;1m22 | [0m[35madded binder folder, with requirements - Dec 9, 2018[0m
[30;1m23 | [0m[35mfixed env KQLMAGIC_CONNECTION_STR - 0.1.82 - Dec 6, 2018[0m
[30;1m24 | [0m[35mupdate notebooks with anonymous authentication - Dec 3, 2018[0m
[30;1m25 | [0m[35mremoved tell_format; added anonymous authentication (for the case of local data source) - 0.1.81 - D[0m
[30;1m26 | [0m[35mRemoved dependency on azure.kusto sdk, use rest api to kusto. - 0.1.80 - Nov 13, 2018[0m

[31m--[ [0m[34mMatch #[0m[33m1063[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/HISTORY.rst[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mection string; fixed &nbsp;[0m
[30;1m3 | [0m[35madded queryproperties option and "+" specific query properties for Kusto queries (supports all set c[0m
[30;1m4 | [0m[35mfix query caching  to support non standard database names; support separate logging; log Kqlmagic st[0m
[30;1m5 | [0m[35mfix http://kusto.aria.microsoft.com and other not standard cluster name [0m

[31m--[ [0m[34mMatch #[0m[33m1064[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/column_guesser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m177 | [0m[35m        col_y_min = properties.get(VisualizationKeys.Y_MIN)[0m
[30;1m178 | [0m[35m        col_y_min = col_y_min if is_quantity(col_y_min) else None[0m
[30;1m179 | [0m[35m[0m
[30;1m180 | [0m[35m        col_y_max = properties.get(VisualizationKeys.Y_MAX)[0m
[30;1m181 | [0m[35m        col_y_max = col_y_max if is_quantity(col_y_max) else None[0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35m        for tab in self.chart_sub_tables:[0m

[31m--[ [0m[34mMatch #[0m[33m1065[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/column_guesser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m174 | [0m[35m                chart_sub_table[row[x_col_idx]] = datetime_to_linear_ticks(row[qcol.idx]) if qcol.is[0m
[30;1m175 | [0m[35m        self.chart_sub_tables = list(chart_sub_tables_dict.values())[0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m        col_y_min = properties.get(VisualizationKeys.Y_MIN)[0m
[30;1m178 | [0m[35m        col_y_min = col_y_min if is_quantity(col_y_min) else None[0m
[30;1m179 | [0m[35m[0m
[30;1m180 | [0m[35m        col_y_max = properties.get(VisualizationKeys.Y_MAX)[0m

[31m--[ [0m[34mMatch #[0m[33m1066[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/column_guesser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m162 | [0m[35m                    sub_table_name = f'{":".join([str(row[col.idx]) for col in series_columns])}:{qc[0m
[30;1m163 | [0m[35m                else:[0m
[30;1m164 | [0m[35m                    sub_table_name = qcol.name[0m
[30;1m165 | [0m[35m                chart_sub_table = chart_sub_tables_dict.get(sub_table_name)[0m
[30;1m166 | [0m[35m                if chart_sub_table is None:[0m
[30;1m167 | [0m[35m                    chart_sub_table = chart_sub_tables_dict[sub_table_name] = ChartSubTable([0m
[30;1m168 | [0m[35m                        name=sub_table_name,[0m

[31m--[ [0m[34mMatch #[0m[33m1067[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/column_guesser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m141 | [0m[35m        #[0m
[30;1m142 | [0m[35m        # discover y columns[0m
[30;1m143 | [0m[35m        #[0m
[30;1m144 | [0m[35m        y_cols_name = properties.get(VisualizationKeys.Y_COLUMNS)[0m
[30;1m145 | [0m[35m        if y_cols_name is not None:[0m
[30;1m146 | [0m[35m            quantity_columns = [c for c in self.columns if c.name in y_cols_name and c.is_quantity][0m
[30;1m147 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m1068[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/column_guesser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m135 | [0m[35m        #[0m
[30;1m136 | [0m[35m        # discover series columns (each combination of values in this columns, is a serie)[0m
[30;1m137 | [0m[35m        #[0m
[30;1m138 | [0m[35m        specified_series_columns = properties.get(VisualizationKeys.SERIES) or [][0m
[30;1m139 | [0m[35m        series_columns = [c for idx, c in enumerate(self.columns) if c.name in specified_series_colu[0m
[30;1m140 | [0m[35m[0m
[30;1m141 | [0m[35m        #[0m

[31m--[ [0m[34mMatch #[0m[33m1069[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/column_guesser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m112 | [0m[35m        #[0m
[30;1m113 | [0m[35m        is_descending_sorted = None[0m
[30;1m114 | [0m[35m        if self.columns[x_col_idx].is_quantity and len(rows) >= 2:[0m
[30;1m115 | [0m[35m            if properties.get(VisualizationKeys.IS_QUERY_SORTED) is True:[0m
[30;1m116 | [0m[35m                previous_col_value = rows[0][x_col_idx][0m
[30;1m117 | [0m[35m                is_descending_sorted = True[0m
[30;1m118 | [0m[35m                for r in rows[1:]:[0m

[31m--[ [0m[34mMatch #[0m[33m1070[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/column_guesser.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m78 | [0m[35m        # discover column X index[0m
[30;1m79 | [0m[35m        #[0m
[30;1m80 | [0m[35m        x_col_idx = None[0m
[30;1m81 | [0m[35m        x_col_name = properties.get(VisualizationKeys.X_COLUMN)[0m
[30;1m82 | [0m[35m        if x_col_name is not None:[0m
[30;1m83 | [0m[35m            for idx, c in enumerate(self.columns):[0m
[30;1m84 | [0m[35m                if c.name == x_col_name:[0m

[31m--[ [0m[34mMatch #[0m[33m1071[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/column_guesser.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m264 | [0m[35m    def build_columns(self, name=None):[0m
[30;1m265 | [0m[35m        """[0m
[30;1m266 | [0m[35m        just build the columns.[0m
[30;1m267 | [0m[35m        if name specified, first sort row by name[0m
[30;1m268 | [0m[35m        """[0m
[30;1m269 | [0m[35m        self._build_columns(name)[0m
[30;1m270 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1072[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/column_guesser.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m208 | [0m[35m        rows = self[0m
[30;1m209 | [0m[35m        if name:[0m
[30;1m210 | [0m[35m            idx = self.columns_name.index(name)[0m
[30;1m211 | [0m[35m            rows = sorted(self, key=lambda row: row[idx])  # sort by index[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m        self.columns = [Column(idx, name) for (idx, name) in enumerate(self.columns_name)][0m
[30;1m214 | [0m[35m        if len(self.columns_datafarme_type) > 0:[0m

[31m--[ [0m[34mMatch #[0m[33m1073[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/column_guesser.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m108 | [0m[35m        rows = self[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m        #[0m
[30;1m111 | [0m[35m        # discover x direction, and always sort ascending[0m
[30;1m112 | [0m[35m        #[0m
[30;1m113 | [0m[35m        is_descending_sorted = None[0m
[30;1m114 | [0m[35m        if self.columns[x_col_idx].is_quantity and len(rows) >= 2:[0m

[31m--[ [0m[34mMatch #[0m[33m1074[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/column_guesser.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m95 | [0m[35m                    elif x_col_idx is None:[0m
[30;1m96 | [0m[35m                        x_col_idx = idx[0m
[30;1m97 | [0m[35m        elif x_type == "datetime":[0m
[30;1m98 | [0m[35m            # find first of type datetime[0m
[30;1m99 | [0m[35m            for idx, c in enumerate(self.columns):[0m
[30;1m100 | [0m[35m                if c.is_datetime:[0m
[30;1m101 | [0m[35m                    x_col_idx = idx[0m

[31m--[ [0m[34mMatch #[0m[33m1075[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/setup.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m204 | [0m[35mif _IS_CUSTOM_SETUP:[0m
[30;1m205 | [0m[35m    DESCRIPTION = DESCRIPTION + " (Custom Dependencies)"[0m
[30;1m206 | [0m[35melse:[0m
[30;1m207 | [0m[35m    INSTALL_REQUIRES = list_union(INSTALL_REQUIRES, EXTRAS_REQUIRE.get("default"))[0m
[30;1m208 | [0m[35m    EXTRAS_REQUIRE   = {}[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35mEXTRAS_REQUIRE["dev"] = DEV_REQUIRES[0m

[31m--[ [0m[34mMatch #[0m[33m1076[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/setup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m157 | [0m[35m                pip_message = 'Your pip version is out of date, please install pip >= 9.0.1. '\[0m
[30;1m158 | [0m[35m                'pip {} detected.'.format(pip.__version__)[0m
[30;1m159 | [0m[35m            else:[0m
[30;1m160 | [0m[35m                # pip is new enough - it must be something else[0m
[30;1m161 | [0m[35m                pip_message = ''[0m
[30;1m162 | [0m[35m        except Exception:[0m
[30;1m163 | [0m[35m            pass[0m

[31m--[ [0m[34mMatch #[0m[33m1077[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/setup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m154 | [0m[35m            import pip[0m
[30;1m155 | [0m[35m            pip_version = tuple([int(x) for x in pip.__version__.split('.')[:3]])[0m
[30;1m156 | [0m[35m            if pip_version < (9, 0, 1) :[0m
[30;1m157 | [0m[35m                pip_message = 'Your pip version is out of date, please install pip >= 9.0.1. '\[0m
[30;1m158 | [0m[35m                'pip {} detected.'.format(pip.__version__)[0m
[30;1m159 | [0m[35m            else:[0m
[30;1m160 | [0m[35m                # pip is new enough - it must be something else[0m

[31m--[ [0m[34mMatch #[0m[33m1078[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/setup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m154 | [0m[35m            import pip[0m
[30;1m155 | [0m[35m            pip_version = tuple([int(x) for x in pip.__version__.split('.')[:3]])[0m
[30;1m156 | [0m[35m            if pip_version < (9, 0, 1) :[0m
[30;1m157 | [0m[35m                pip_message = 'Your pip version is out of date, please install pip >= 9.0.1. '\[0m
[30;1m158 | [0m[35m                'pip {} detected.'.format(pip.__version__)[0m
[30;1m159 | [0m[35m            else:[0m
[30;1m160 | [0m[35m                # pip is new enough - it must be something else[0m

[31m--[ [0m[34mMatch #[0m[33m1079[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/setup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m151 | [0m[35m    if list(v[:2]) < min_python_required_ver:[0m
[30;1m152 | [0m[35m        pip_message = 'This may be due to an out of date pip. Make sure you have pip >= 9.0.1.'[0m
[30;1m153 | [0m[35m        try:[0m
[30;1m154 | [0m[35m            import pip[0m
[30;1m155 | [0m[35m            pip_version = tuple([int(x) for x in pip.__version__.split('.')[:3]])[0m
[30;1m156 | [0m[35m            if pip_version < (9, 0, 1) :[0m
[30;1m157 | [0m[35m                pip_message = 'Your pip version is out of date, please install pip >= 9.0.1. '\[0m

[31m--[ [0m[34mMatch #[0m[33m1080[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/setup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m149 | [0m[35m    v = sys.version_info[0m
[30;1m150 | [0m[35m    min_python_required_ver = get_version_tuple(python_requires)[0m
[30;1m151 | [0m[35m    if list(v[:2]) < min_python_required_ver:[0m
[30;1m152 | [0m[35m        pip_message = 'This may be due to an out of date pip. Make sure you have pip >= 9.0.1.'[0m
[30;1m153 | [0m[35m        try:[0m
[30;1m154 | [0m[35m            import pip[0m
[30;1m155 | [0m[35m            pip_version = tuple([int(x) for x in pip.__version__.split('.')[:3]])[0m

[31m--[ [0m[34mMatch #[0m[33m1081[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/setup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m24 | [0m[35m#      - KqlmagicCustom - DEPENDENCIES NEED TO BE EXPLICITLY SPECIFIED[0m
[30;1m25 | [0m[35m#==============================================================================[0m
[30;1m26 | [0m[35m# NEXT CODE LINE SHOULD NOT BE TOUCHED/MODIFIED MANUALLY, MAKE SURE IT APPEARS ONLY ONCE[0m
[30;1m27 | [0m[35m_IS_CUSTOM_SETUP = True # MODIFIED BY A SHELL PREPROCESSOR SCRIPT[0m
[30;1m28 | [0m[35m#==============================================================================[0m
[30;1m29 | [0m[35m#[0m
[30;1m30 | [0m[35m#[0m

[31m--[ [0m[34mMatch #[0m[33m1082[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/setup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m#==============================================================================[0m
[30;1m21 | [0m[35m# _IS_CUSTOM_SETUP VALUE IS MODIFIED BY A SHELL PREPROCESSOR SCRIPT[0m
[30;1m22 | [0m[35m# TO FORK TWO PACKAGES:[0m
[30;1m23 | [0m[35m#      - Kqlmagic - INCLUDES ALL DEPENDENCIES[0m
[30;1m24 | [0m[35m#      - KqlmagicCustom - DEPENDENCIES NEED TO BE EXPLICITLY SPECIFIED[0m

[31m--[ [0m[34mMatch #[0m[33m1083[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/sso_storage.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m165 | [0m[35m        raise SsoWarning(f"Warning: SSO is not activated due to {SsoCrypto.FERNET} cryptography and/[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m    if crypto_key is None or crypto_key == SsoCrypto.FERNET:[0m
[30;1m168 | [0m[35m        secret_key = key_vals.get(SsoEnvVarParam.SECRET_KEY) if crypto_key == SsoCrypto.FERNET else [0m
[30;1m169 | [0m[35m        if secret_key is None:[0m
[30;1m170 | [0m[35m            raise SsoWarning(f"Warning: SSO is not activated due to environment variable {Constants.[0m
[30;1m171 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1084[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/sso_storage.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35mdef _get_storage_type(key_vals:dict, cache_name:str) -> str:[0m
[30;1m138 | [0m[35m    storage_type = key_vals.get(SsoEnvVarParam.STORAGE, SsoStorage.DEFAULT)[0m
[30;1m139 | [0m[35m    _validate_storage_type(storage_type, cache_name)[0m
[30;1m140 | [0m[35m    return storage_type[0m
[30;1m141 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1085[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/sso_storage.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35mdef _get_crypto_type(key_vals:dict) -> str:[0m
[30;1m112 | [0m[35m    crypto_type = key_vals.get(SsoEnvVarParam.CRYPTO, SsoCrypto.DEFAULT)[0m
[30;1m113 | [0m[35m    if crypto_type == SsoCrypto.AUTO:[0m
[30;1m114 | [0m[35m        if platform.system() == 'Linux':[0m
[30;1m115 | [0m[35m            crypto_type = SsoCrypto.LINUX_LIBSECRET[0m

[31m--[ [0m[34mMatch #[0m[33m1086[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/sso_storage.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35mdef _get_secret_salt_uuid(key_vals:dict) -> str:[0m
[30;1m107 | [0m[35m    secret_salt_uuid = key_vals.get(SsoEnvVarParam.SECRET_SALT_UUID) or str(uuid.uuid4())[0m
[30;1m108 | [0m[35m    return secret_salt_uuid[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1087[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/sso_storage.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35mdef _get_secret_key(key_vals:dict) -> str:[0m
[30;1m102 | [0m[35m    secret_key = key_vals.get(SsoEnvVarParam.SECRET_KEY) or str(uuid.uuid4())[0m
[30;1m103 | [0m[35m    return secret_key[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1088[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/sso_storage.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35mdef _get_cache_name(key_vals:dict) -> str:[0m
[30;1m97 | [0m[35m    cache_name = key_vals.get(SsoEnvVarParam.CACHE_NAME, Constants.SSO_DEFAULT_CACHE_NAME)[0m
[30;1m98 | [0m[35m    return cache_name[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1089[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/sso_storage.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m        if crypto_obj is not None:[0m
[30;1m69 | [0m[35m            cache_name = _get_cache_name(key_vals)[0m
[30;1m70 | [0m[35m            gc_ttl_in_secs = options.get('sso_db_gc_interval', 0) * Constants.HOUR_SECS  # convert f[0m
[30;1m71 | [0m[35m            storage_options = {[0m
[30;1m72 | [0m[35m                SsoStorageParam.CACHE_SELECTOR_KEY: cache_selector_key,[0m
[30;1m73 | [0m[35m                SsoStorageParam.CRYPTO_OBJ: crypto_obj,[0m

[31m--[ [0m[34mMatch #[0m[33m1090[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/sso_storage.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m252 | [0m[35m* If you encountered error "Remote error from secret service:[0m
[30;1m253 | [0m[35m  org.freedesktop.DBus.Error.ServiceUnknown",[0m
[30;1m254 | [0m[35m  you may need to install gnome-keyring package.[0m
[30;1m255 | [0m[35m* Headless mode (such as in an ssh session) is not supported.[0m
[30;1m256 | [0m[35merror: {ex}[0m
[30;1m257 | [0m[35m""")[0m
[30;1m258 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m1091[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m475 | [0m[35m        items = [][0m
[30;1m476 | [0m[35m        for key in self._keys_set:[0m
[30;1m477 | [0m[35m            if key not in self._EXCLUDE_FROM_URL_KEYS:[0m
[30;1m478 | [0m[35m                items.append(f"{key}('{parsed_conn_kv.get(key)}')")[0m
[30;1m479 | [0m[35m        self.bind_url = f"{uri_schema_name}://{'.'.join(items)}"[0m
[30;1m480 | [0m[35m        logger().debug(f"kql_engine.py - _create_and_set_bind_url - setting attributes - bind_url:{s[0m
[30;1m481 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1092[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m451 | [0m[35m[0m
[30;1m452 | [0m[35m[0m
[30;1m453 | [0m[35m    def _set_and_check_for_alias(self, parsed_conn_kv:Dict[str,str], friendly_name:str)->None:[0m
[30;1m454 | [0m[35m        alias = parsed_conn_kv.get(ConnStrKeys.ALIAS) or friendly_name[0m
[30;1m455 | [0m[35m        if alias is not None:[0m
[30;1m456 | [0m[35m            if len(alias) < 1 or alias != get_valid_name(alias):[0m
[30;1m457 | [0m[35m                raise KqlEngineError(f"key {ConnStrKeys.ALIAS} cannot be empty or anything that is n[0m

[31m--[ [0m[34mMatch #[0m[33m1093[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m440 | [0m[35m[0m
[30;1m441 | [0m[35m[0m
[30;1m442 | [0m[35m    def _set_and_check_for_database_name(self, parsed_conn_kv:Dict[str,str], mandatory_key:str)->Non[0m
[30;1m443 | [0m[35m        database_name = parsed_conn_kv.get(mandatory_key)[0m
[30;1m444 | [0m[35m        if database_name is not None:[0m
[30;1m445 | [0m[35m            if len(database_name) < 1:[0m
[30;1m446 | [0m[35m                raise KqlEngineError(f"key {mandatory_key} cannot be empty")[0m

[31m--[ [0m[34mMatch #[0m[33m1094[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m429 | [0m[35m[0m
[30;1m430 | [0m[35m[0m
[30;1m431 | [0m[35m    def _set_and_check_for_cluster_name(self, parsed_conn_kv:Dict[str,str], uri_schema_name:str)->No[0m
[30;1m432 | [0m[35m        cluster_name = parsed_conn_kv.get(ConnStrKeys.CLUSTER) or uri_schema_name[0m
[30;1m433 | [0m[35m        if cluster_name is not None:[0m
[30;1m434 | [0m[35m            if len(cluster_name) < 1:[0m
[30;1m435 | [0m[35m                raise KqlEngineError(f"key {ConnStrKeys.CLUSTER} cannot be empty")[0m

[31m--[ [0m[34mMatch #[0m[33m1095[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m393 | [0m[35m        if len(inherit_keys_set) > 1:[0m
[30;1m394 | [0m[35m            if current is not None:[0m
[30;1m395 | [0m[35m                for k in inherit_keys_set:[0m
[30;1m396 | [0m[35m                    v = current._parsed_conn.get(k)[0m
[30;1m397 | [0m[35m                    if v is not None:[0m
[30;1m398 | [0m[35m                        parsed_conn_kv[k] = v[0m
[30;1m399 | [0m[35m                        matched_keys_set.add(k)[0m

[31m--[ [0m[34mMatch #[0m[33m1096[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m357 | [0m[35m                    [0m
[30;1m358 | [0m[35m            if inherited:[0m
[30;1m359 | [0m[35m                for k in self._CREDENTIAL_KEYS.intersection(matched_keys_set):[0m
[30;1m360 | [0m[35m                    if parsed_conn_kv[k] != current._parsed_conn.get(k):[0m
[30;1m361 | [0m[35m                        failed = True[0m
[30;1m362 | [0m[35m                        # raise KqlEngineError("missing keys.")[0m
[30;1m363 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1097[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m313 | [0m[35m        parsed_conn_kv = Parser.parse_and_get_kv_string(rest, user_ns)[0m
[30;1m314 | [0m[35m        logger().debug(f"kql_engine.py - _parse_connection_str - parsed_conn_kv: {parsed_conn_kv} (r[0m
[30;1m315 | [0m[35m        # In case certificate_pem_file was specified instead of certificate.[0m
[30;1m316 | [0m[35m        pem_file_name = parsed_conn_kv.get(ConnStrKeys.CERTIFICATE_PEM_FILE)[0m
[30;1m317 | [0m[35m        if pem_file_name is not None:[0m
[30;1m318 | [0m[35m            pem_file_name = adjust_path(pem_file_name)[0m
[30;1m319 | [0m[35m            with open(pem_file_name, "r") as pem_file:[0m

[31m--[ [0m[34mMatch #[0m[33m1098[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m235 | [0m[35m        [0m
[30;1m236 | [0m[35m[0m
[30;1m237 | [0m[35m    def validate_database_name(self, **options)->None:[0m
[30;1m238 | [0m[35m        if not self.options.get("validate_database_name_done"):[0m
[30;1m239 | [0m[35m            try:[0m
[30;1m240 | [0m[35m                database_name_list, databases_by_pretty_name = self._get_databases_by_pretty_name(**[0m
[30;1m241 | [0m[35m                if self.database_name not in database_name_list:[0m

[31m--[ [0m[34mMatch #[0m[33m1099[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m    def validate(self, **options)->None:[0m
[30;1m228 | [0m[35m        if not self.options.get("validate_connection_string_done") and options.get("validate_connect[0m
[30;1m229 | [0m[35m            query = "range c from 1 to 10 step 1 | count"[0m
[30;1m230 | [0m[35m            kql_response = self.execute(query, **options)[0m
[30;1m231 | [0m[35m            table = kql_response.tables[0][0m

[31m--[ [0m[34mMatch #[0m[33m1100[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_engine.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m    def validate(self, **options)->None:[0m
[30;1m228 | [0m[35m        if not self.options.get("validate_connection_string_done") and options.get("validate_connect[0m
[30;1m229 | [0m[35m            query = "range c from 1 to 10 step 1 | count"[0m
[30;1m230 | [0m[35m            kql_response = self.execute(query, **options)[0m
[30;1m231 | [0m[35m            table = kql_response.tables[0][0m

[31m--[ [0m[34mMatch #[0m[33m1101[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/kql_engine.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m339 | [0m[35m[0m
[30;1m340 | [0m[35m[0m
[30;1m341 | [0m[35m    def _find_combination_set(self, current, matched_keys_set:set, parsed_conn_kv:Dict[str,str], key[0m
[30;1m342 | [0m[35m        # find a valid combination for the set[0m
[30;1m343 | [0m[35m        valid_combinations = [c for c in keys_combinations if matched_keys_set.issubset(c)][0m
[30;1m344 | [0m[35m        logger().debug(f"kql_engine.py - _find_combination - found these valid_combinations: {valid_[0m
[30;1m345 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1102[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/magic_extension.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m65 | [0m[35m    try:[0m
[30;1m66 | [0m[35m        for cmd_name in COMMANDS_TABLE:[0m
[30;1m67 | [0m[35m            flag:str = COMMANDS_TABLE.get(cmd_name).get("flag")[0m
[30;1m68 | [0m[35m            is_cell:bool = COMMANDS_TABLE.get(cmd_name).get("cell")[0m
[30;1m69 | [0m[35m            _register_command_magics(ip, flag, is_cell)[0m
[30;1m70 | [0m[35m    except: # pylint: disable=bare-except[0m
[30;1m71 | [0m[35m        pass[0m

[31m--[ [0m[34mMatch #[0m[33m1103[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/magic_extension.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m65 | [0m[35m    try:[0m
[30;1m66 | [0m[35m        for cmd_name in COMMANDS_TABLE:[0m
[30;1m67 | [0m[35m            flag:str = COMMANDS_TABLE.get(cmd_name).get("flag")[0m
[30;1m68 | [0m[35m            is_cell:bool = COMMANDS_TABLE.get(cmd_name).get("cell")[0m
[30;1m69 | [0m[35m            _register_command_magics(ip, flag, is_cell)[0m
[30;1m70 | [0m[35m    except: # pylint: disable=bare-except[0m
[30;1m71 | [0m[35m        pass[0m

[31m--[ [0m[34mMatch #[0m[33m1104[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/magic_extension.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35mdef _set_command_magics(ip):[0m
[30;1m65 | [0m[35m    try:[0m
[30;1m66 | [0m[35m        for cmd_name in COMMANDS_TABLE:[0m
[30;1m67 | [0m[35m            flag:str = COMMANDS_TABLE.get(cmd_name).get("flag")[0m
[30;1m68 | [0m[35m            is_cell:bool = COMMANDS_TABLE.get(cmd_name).get("cell")[0m
[30;1m69 | [0m[35m            _register_command_magics(ip, flag, is_cell)[0m
[30;1m70 | [0m[35m    except: # pylint: disable=bare-except[0m

[31m--[ [0m[34mMatch #[0m[33m1105[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/magic_extension.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35mdef _set_command_magics(ip):[0m
[30;1m65 | [0m[35m    try:[0m
[30;1m66 | [0m[35m        for cmd_name in COMMANDS_TABLE:[0m
[30;1m67 | [0m[35m            flag:str = COMMANDS_TABLE.get(cmd_name).get("flag")[0m
[30;1m68 | [0m[35m            is_cell:bool = COMMANDS_TABLE.get(cmd_name).get("cell")[0m
[30;1m69 | [0m[35m            _register_command_magics(ip, flag, is_cell)[0m
[30;1m70 | [0m[35m    except: # pylint: disable=bare-except[0m

[31m--[ [0m[34mMatch #[0m[33m1106[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m251 | [0m[35m                url = self._build_url(url=url)[0m
[30;1m252 | [0m[35m                logger().debug(f"{method} Request: {url}, params: {params}, payload: {data or json},[0m
[30;1m253 | [0m[35m                data: bytes = self._get_data(data=data)[0m
[30;1m254 | [0m[35m                response = self._requests.request(method, url, params=params, headers=headers, timeo[0m
[30;1m255 | [0m[35m            else:[0m
[30;1m256 | [0m[35m                import urllib.request[0m
[30;1m257 | [0m[35m                from urllib.request import Request[0m

[31m--[ [0m[34mMatch #[0m[33m1107[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m133 | [0m[35m                pagedata = gzip.decompress(_bytes)[0m
[30;1m134 | [0m[35m            elif self.headers.get('Content-Encoding') == 'deflate':[0m
[30;1m135 | [0m[35m                pagedata = _bytes[0m
[30;1m136 | [0m[35m            elif self.headers.get('Content-Encoding'):[0m
[30;1m137 | [0m[35m                print('Encoding type unknown')[0m
[30;1m138 | [0m[35m                pagedata = _bytes[0m
[30;1m139 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m1108[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m131 | [0m[35m        def _get_pagedata_bytes(self, _bytes:bytes)-> str:[0m
[30;1m132 | [0m[35m            if self.headers.get('Content-Encoding') == 'gzip':[0m
[30;1m133 | [0m[35m                pagedata = gzip.decompress(_bytes)[0m
[30;1m134 | [0m[35m            elif self.headers.get('Content-Encoding') == 'deflate':[0m
[30;1m135 | [0m[35m                pagedata = _bytes[0m
[30;1m136 | [0m[35m            elif self.headers.get('Content-Encoding'):[0m
[30;1m137 | [0m[35m                print('Encoding type unknown')[0m

[31m--[ [0m[34mMatch #[0m[33m1109[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m        [0m
[30;1m131 | [0m[35m        def _get_pagedata_bytes(self, _bytes:bytes)-> str:[0m
[30;1m132 | [0m[35m            if self.headers.get('Content-Encoding') == 'gzip':[0m
[30;1m133 | [0m[35m                pagedata = gzip.decompress(_bytes)[0m
[30;1m134 | [0m[35m            elif self.headers.get('Content-Encoding') == 'deflate':[0m
[30;1m135 | [0m[35m                pagedata = _bytes[0m

[31m--[ [0m[34mMatch #[0m[33m1110[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/http_client.py[0m
   Pattern: [32m.hostname[0m
[30;1m262 | [0m[35m                    ssl_context = ssl.SSLContext(ssl.PROTOCOL_TLSv1_2)[0m
[30;1m263 | [0m[35m                    # ssl_context = ssl.SSLContext(ssl.PROTOCOL_TLS_CLIENT)[0m
[30;1m264 | [0m[35m                    # ssl_context.verify_mode = ssl.CERT_REQUIRED[0m
[30;1m265 | [0m[35m                    # ssl_context.check_hostname = True[0m
[30;1m266 | [0m[35m                url = self._build_url(url=url, params=params)[0m
[30;1m267 | [0m[35m                data: bytes = self._get_data(data=data, json=json)[0m
[30;1m268 | [0m[35m                request = Request(url, data=data, headers=headers, method=method)[0m

[31m--[ [0m[34mMatch #[0m[33m1111[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/http_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m245 | [0m[35m        try:[0m
[30;1m246 | [0m[35m            method = self._get_method(method=method, data=data or json)[0m
[30;1m247 | [0m[35m            headers = self._get_headers(headers=headers, json=json)[0m
[30;1m248 | [0m[35m            timeout = timeout or self._timeout[0m
[30;1m249 | [0m[35m[0m
[30;1m250 | [0m[35m            if self._requests:[0m
[30;1m251 | [0m[35m                url = self._build_url(url=url)[0m

[31m--[ [0m[34mMatch #[0m[33m1112[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/http_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m245 | [0m[35m        try:[0m
[30;1m246 | [0m[35m            method = self._get_method(method=method, data=data or json)[0m
[30;1m247 | [0m[35m            headers = self._get_headers(headers=headers, json=json)[0m
[30;1m248 | [0m[35m            timeout = timeout or self._timeout[0m
[30;1m249 | [0m[35m[0m
[30;1m250 | [0m[35m            if self._requests:[0m
[30;1m251 | [0m[35m                url = self._build_url(url=url)[0m

[31m--[ [0m[34mMatch #[0m[33m1113[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/http_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m171 | [0m[35m        global requests_module[0m
[30;1m172 | [0m[35m        self._requests = requests_module[0m
[30;1m173 | [0m[35m        self._headers: dict = headers or self._default_headers()[0m
[30;1m174 | [0m[35m        self._timeout: float = timeout[0m
[30;1m175 | [0m[35m        self._url: str = host[0m
[30;1m176 | [0m[35m        if path:[0m
[30;1m177 | [0m[35m            self._url = f"{self._url}/{path}"[0m

[31m--[ [0m[34mMatch #[0m[33m1114[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/allow_py_comments_before_cell.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m78 | [0m[35m    @staticmethod[0m
[30;1m79 | [0m[35m    def observe_is_magic(change:Dict[str,str]):[0m
[30;1m80 | [0m[35m        if change.get('type') == 'change' and change.get('name') == 'is_magic':[0m
[30;1m81 | [0m[35m            allow_py_comments_before_cell = change.get('new') and AllowPyCommentsBeforeCell.config.a[0m
[30;1m82 | [0m[35m            AllowPyCommentsBeforeCell.config.set_trait('allow_py_comments_before_cell', allow_py_com[0m
[30;1m83 | [0m[35m            AllowPyCommentsBeforeCell.allow_py_Comments_before_cell(allow_py_comments_before_cell)[0m

[31m--[ [0m[34mMatch #[0m[33m1115[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/allow_py_comments_before_cell.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m    @staticmethod[0m
[30;1m79 | [0m[35m    def observe_is_magic(change:Dict[str,str]):[0m
[30;1m80 | [0m[35m        if change.get('type') == 'change' and change.get('name') == 'is_magic':[0m
[30;1m81 | [0m[35m            allow_py_comments_before_cell = change.get('new') and AllowPyCommentsBeforeCell.config.a[0m
[30;1m82 | [0m[35m            AllowPyCommentsBeforeCell.config.set_trait('allow_py_comments_before_cell', allow_py_com[0m
[30;1m83 | [0m[35m            AllowPyCommentsBeforeCell.allow_py_Comments_before_cell(allow_py_comments_before_cell)[0m

[31m--[ [0m[34mMatch #[0m[33m1116[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/allow_py_comments_before_cell.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m    @staticmethod[0m
[30;1m79 | [0m[35m    def observe_is_magic(change:Dict[str,str]):[0m
[30;1m80 | [0m[35m        if change.get('type') == 'change' and change.get('name') == 'is_magic':[0m
[30;1m81 | [0m[35m            allow_py_comments_before_cell = change.get('new') and AllowPyCommentsBeforeCell.config.a[0m
[30;1m82 | [0m[35m            AllowPyCommentsBeforeCell.config.set_trait('allow_py_comments_before_cell', allow_py_com[0m
[30;1m83 | [0m[35m            AllowPyCommentsBeforeCell.allow_py_Comments_before_cell(allow_py_comments_before_cell)[0m

[31m--[ [0m[34mMatch #[0m[33m1117[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/allow_py_comments_before_cell.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m                if change.get('new') is True:[0m
[30;1m73 | [0m[35m                    AllowPyCommentsBeforeCell.config.set_trait('allow_py_comments_before_cell', Fals[0m
[30;1m74 | [0m[35m            else:[0m
[30;1m75 | [0m[35m                AllowPyCommentsBeforeCell.allow_py_Comments_before_cell(change.get('new'))[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m    @staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m1118[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/allow_py_comments_before_cell.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m69 | [0m[35m    def observe_allow_py_comments_before_cell(change:Dict[str,str]):[0m
[30;1m70 | [0m[35m        if change.get('type') == 'change' and change.get('name') == 'allow_py_comments_before_cell':[0m
[30;1m71 | [0m[35m            if AllowPyCommentsBeforeCell.config.is_magic is False:[0m
[30;1m72 | [0m[35m                if change.get('new') is True:[0m
[30;1m73 | [0m[35m                    AllowPyCommentsBeforeCell.config.set_trait('allow_py_comments_before_cell', Fals[0m
[30;1m74 | [0m[35m            else:[0m
[30;1m75 | [0m[35m                AllowPyCommentsBeforeCell.allow_py_Comments_before_cell(change.get('new'))[0m

[31m--[ [0m[34mMatch #[0m[33m1119[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/allow_py_comments_before_cell.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m    @staticmethod[0m
[30;1m69 | [0m[35m    def observe_allow_py_comments_before_cell(change:Dict[str,str]):[0m
[30;1m70 | [0m[35m        if change.get('type') == 'change' and change.get('name') == 'allow_py_comments_before_cell':[0m
[30;1m71 | [0m[35m            if AllowPyCommentsBeforeCell.config.is_magic is False:[0m
[30;1m72 | [0m[35m                if change.get('new') is True:[0m
[30;1m73 | [0m[35m                    AllowPyCommentsBeforeCell.config.set_trait('allow_py_comments_before_cell', Fals[0m

[31m--[ [0m[34mMatch #[0m[33m1120[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/allow_py_comments_before_cell.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m    @staticmethod[0m
[30;1m69 | [0m[35m    def observe_allow_py_comments_before_cell(change:Dict[str,str]):[0m
[30;1m70 | [0m[35m        if change.get('type') == 'change' and change.get('name') == 'allow_py_comments_before_cell':[0m
[30;1m71 | [0m[35m            if AllowPyCommentsBeforeCell.config.is_magic is False:[0m
[30;1m72 | [0m[35m                if change.get('new') is True:[0m
[30;1m73 | [0m[35m                    AllowPyCommentsBeforeCell.config.set_trait('allow_py_comments_before_cell', Fals[0m

[31m--[ [0m[34mMatch #[0m[33m1121[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m825 | [0m[35m                if key in [TokenResponseFields.ACCESS_TOKEN, OAuth2TokenFields.ACCESS_TOKEN, TokenRe[0m
[30;1m826 | [0m[35m                    token_dict[key] = f"..."[0m
[30;1m827 | [0m[35m                else:[0m
[30;1m828 | [0m[35m                    token_dict[key] = self._options.get("try_token")[key][0m
[30;1m829 | [0m[35m            kwargs = token_dict[0m
[30;1m830 | [0m[35m        else:[0m
[30;1m831 | [0m[35m            pass[0m

[31m--[ [0m[34mMatch #[0m[33m1122[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m821 | [0m[35m            kwargs = {"subscription": self._options.get("try_azcli_login_subscription")}[0m
[30;1m822 | [0m[35m        elif self._current_authentication_method is AuthenticationMethod.aux_token:[0m
[30;1m823 | [0m[35m            token_dict = {}[0m
[30;1m824 | [0m[35m            for key in self._options.get("try_token"):[0m
[30;1m825 | [0m[35m                if key in [TokenResponseFields.ACCESS_TOKEN, OAuth2TokenFields.ACCESS_TOKEN, TokenRe[0m
[30;1m826 | [0m[35m                    token_dict[key] = f"..."[0m
[30;1m827 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m1123[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m818 | [0m[35m        elif self._current_authentication_method is AuthenticationMethod.azcli_login_by_profile:[0m
[30;1m819 | [0m[35m            pass[0m
[30;1m820 | [0m[35m        elif self._current_authentication_method is AuthenticationMethod.azcli_login_subscription:[0m
[30;1m821 | [0m[35m            kwargs = {"subscription": self._options.get("try_azcli_login_subscription")}[0m
[30;1m822 | [0m[35m        elif self._current_authentication_method is AuthenticationMethod.aux_token:[0m
[30;1m823 | [0m[35m            token_dict = {}[0m
[30;1m824 | [0m[35m            for key in self._options.get("try_token"):[0m

[31m--[ [0m[34mMatch #[0m[33m1124[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m812 | [0m[35m        elif self._current_authentication_method is AuthenticationMethod.aad_application_certificate[0m
[30;1m813 | [0m[35m            kwargs = {"client_id": self._client_id, "thumbprint": self._thumbprint}[0m
[30;1m814 | [0m[35m        elif self._current_authentication_method is AuthenticationMethod.managed_service_identity:[0m
[30;1m815 | [0m[35m            kwargs = self._options.get("try_msi")[0m
[30;1m816 | [0m[35m        elif self._current_authentication_method is AuthenticationMethod.azcli_login:[0m
[30;1m817 | [0m[35m            pass[0m
[30;1m818 | [0m[35m        elif self._current_authentication_method is AuthenticationMethod.azcli_login_by_profile:[0m

[31m--[ [0m[34mMatch #[0m[33m1125[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m766 | [0m[35m[0m
[30;1m767 | [0m[35m[0m
[30;1m768 | [0m[35m    def _warn_token_diff_from_conn_str(self)->None:[0m
[30;1m769 | [0m[35m        if self._options.get("auth_token_warnings"):[0m
[30;1m770 | [0m[35m            token = self._current_token[0m
[30;1m771 | [0m[35m            if token is not None:[0m
[30;1m772 | [0m[35m                # to avoid more than one warning per connection, keep track of already displayed war[0m

[31m--[ [0m[34mMatch #[0m[33m1126[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m759 | [0m[35m[0m
[30;1m760 | [0m[35m[0m
[30;1m761 | [0m[35m    def _warn_on_token_validation_failure(self, message)->None:[0m
[30;1m762 | [0m[35m        if self._options.get("auth_token_warnings"):[0m
[30;1m763 | [0m[35m            if self._current_authentication_method is not None and message is not None:[0m
[30;1m764 | [0m[35m                warn_message =f"Can't use '{self._current_authentication_method}' token entry, {mess[0m
[30;1m765 | [0m[35m                Display.showWarningMessage(warn_message, display_handler_name='acquire_token', **sel[0m

[31m--[ [0m[34mMatch #[0m[33m1127[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m752 | [0m[35m    def _get_aad_login_url(self, aad_login_url=None):[0m
[30;1m753 | [0m[35m        if aad_login_url is None:[0m
[30;1m754 | [0m[35m            cloud = self._options.get("cloud")[0m
[30;1m755 | [0m[35m            aad_login_url = _CLOUD_AAD_URLS.get(cloud)[0m
[30;1m756 | [0m[35m            if aad_login_url is None:[0m
[30;1m757 | [0m[35m                raise KqlEngineError(f"AAD is not known for this cloud '{cloud}', please use aadurl [0m
[30;1m758 | [0m[35m        return aad_login_url[0m

[31m--[ [0m[34mMatch #[0m[33m1128[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m751 | [0m[35m[0m
[30;1m752 | [0m[35m    def _get_aad_login_url(self, aad_login_url=None):[0m
[30;1m753 | [0m[35m        if aad_login_url is None:[0m
[30;1m754 | [0m[35m            cloud = self._options.get("cloud")[0m
[30;1m755 | [0m[35m            aad_login_url = _CLOUD_AAD_URLS.get(cloud)[0m
[30;1m756 | [0m[35m            if aad_login_url is None:[0m
[30;1m757 | [0m[35m                raise KqlEngineError(f"AAD is not known for this cloud '{cloud}', please use aadurl [0m

[31m--[ [0m[34mMatch #[0m[33m1129[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m746 | [0m[35m                    cache = AdalTokenCache.get_cache(self._authority_uri, **self._options)[0m
[30;1m747 | [0m[35m                    if cache is not None:[0m
[30;1m748 | [0m[35m                        global_adal_context_sso[self._authority_uri] = AuthenticationContext(self._a[0m
[30;1m749 | [0m[35m                self._adal_context_sso = global_adal_context_sso.get(self._authority_uri)[0m
[30;1m750 | [0m[35m[0m
[30;1m751 | [0m[35m[0m
[30;1m752 | [0m[35m    def _get_aad_login_url(self, aad_login_url=None):[0m

[31m--[ [0m[34mMatch #[0m[33m1130[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m742 | [0m[35m        if self._options.get("enable_sso"):[0m
[30;1m743 | [0m[35m            self._adal_context_sso = adal_context_sso[0m
[30;1m744 | [0m[35m            if self._adal_context_sso is None:[0m
[30;1m745 | [0m[35m                if global_adal_context_sso.get(self._authority_uri) is None:[0m
[30;1m746 | [0m[35m                    cache = AdalTokenCache.get_cache(self._authority_uri, **self._options)[0m
[30;1m747 | [0m[35m                    if cache is not None:[0m
[30;1m748 | [0m[35m                        global_adal_context_sso[self._authority_uri] = AuthenticationContext(self._a[0m

[31m--[ [0m[34mMatch #[0m[33m1131[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m739 | [0m[35m            self._adal_context = global_adal_context.get(self._authority_uri)[0m
[30;1m740 | [0m[35m[0m
[30;1m741 | [0m[35m        self._adal_context_sso = None[0m
[30;1m742 | [0m[35m        if self._options.get("enable_sso"):[0m
[30;1m743 | [0m[35m            self._adal_context_sso = adal_context_sso[0m
[30;1m744 | [0m[35m            if self._adal_context_sso is None:[0m
[30;1m745 | [0m[35m                if global_adal_context_sso.get(self._authority_uri) is None:[0m

[31m--[ [0m[34mMatch #[0m[33m1132[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m736 | [0m[35m        if self._adal_context is None:[0m
[30;1m737 | [0m[35m            if global_adal_context.get(self._authority_uri) is None:[0m
[30;1m738 | [0m[35m                global_adal_context[self._authority_uri] = AuthenticationContext(self._authority_uri[0m
[30;1m739 | [0m[35m            self._adal_context = global_adal_context.get(self._authority_uri)[0m
[30;1m740 | [0m[35m[0m
[30;1m741 | [0m[35m        self._adal_context_sso = None[0m
[30;1m742 | [0m[35m        if self._options.get("enable_sso"):[0m

[31m--[ [0m[34mMatch #[0m[33m1133[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m734 | [0m[35m[0m
[30;1m735 | [0m[35m        self._adal_context = adal_context[0m
[30;1m736 | [0m[35m        if self._adal_context is None:[0m
[30;1m737 | [0m[35m            if global_adal_context.get(self._authority_uri) is None:[0m
[30;1m738 | [0m[35m                global_adal_context[self._authority_uri] = AuthenticationContext(self._authority_uri[0m
[30;1m739 | [0m[35m            self._adal_context = global_adal_context.get(self._authority_uri)[0m
[30;1m740 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1134[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m589 | [0m[35m        try:[0m
[30;1m590 | [0m[35m            claims = self._get_token_claims(self._get_token_access_token(token))[0m
[30;1m591 | [0m[35m            tenant_id = claims.get("tid")[0m
[30;1m592 | [0m[35m            issuer = claims.get("iss")[0m
[30;1m593 | [0m[35m[0m
[30;1m594 | [0m[35m            if tenant_id is None and issuer is not None and issuer.startswith("http"):[0m
[30;1m595 | [0m[35m                from urllib.parse import urlparse[0m

[31m--[ [0m[34mMatch #[0m[33m1135[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m588 | [0m[35m        authority_uri = None[0m
[30;1m589 | [0m[35m        try:[0m
[30;1m590 | [0m[35m            claims = self._get_token_claims(self._get_token_access_token(token))[0m
[30;1m591 | [0m[35m            tenant_id = claims.get("tid")[0m
[30;1m592 | [0m[35m            issuer = claims.get("iss")[0m
[30;1m593 | [0m[35m[0m
[30;1m594 | [0m[35m            if tenant_id is None and issuer is not None and issuer.startswith("http"):[0m

[31m--[ [0m[34mMatch #[0m[33m1136[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m577 | [0m[35m        "retrieve resource list from access token claims"[0m
[30;1m578 | [0m[35m        resources = None[0m
[30;1m579 | [0m[35m        claims = self._get_token_claims(self._get_token_access_token(token))[0m
[30;1m580 | [0m[35m        resources = claims.get("aud")[0m
[30;1m581 | [0m[35m        if type(resources) == str:[0m
[30;1m582 | [0m[35m            resources = [resources][0m
[30;1m583 | [0m[35m        return resources[0m

[31m--[ [0m[34mMatch #[0m[33m1137[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m569 | [0m[35m    def _get_client_id_from_token(self, token:dict)->str:[0m
[30;1m570 | [0m[35m        "retrieve client_id from access token claims"[0m
[30;1m571 | [0m[35m        claims = self._get_token_claims(self._get_token_access_token(token))[0m
[30;1m572 | [0m[35m        client_id = claims.get("client_id") or claims.get("appid") or claims.get("azp")[0m
[30;1m573 | [0m[35m        return client_id[0m
[30;1m574 | [0m[35m[0m
[30;1m575 | [0m[35m    [0m

[31m--[ [0m[34mMatch #[0m[33m1138[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m569 | [0m[35m    def _get_client_id_from_token(self, token:dict)->str:[0m
[30;1m570 | [0m[35m        "retrieve client_id from access token claims"[0m
[30;1m571 | [0m[35m        claims = self._get_token_claims(self._get_token_access_token(token))[0m
[30;1m572 | [0m[35m        client_id = claims.get("client_id") or claims.get("appid") or claims.get("azp")[0m
[30;1m573 | [0m[35m        return client_id[0m
[30;1m574 | [0m[35m[0m
[30;1m575 | [0m[35m    [0m

[31m--[ [0m[34mMatch #[0m[33m1139[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m569 | [0m[35m    def _get_client_id_from_token(self, token:dict)->str:[0m
[30;1m570 | [0m[35m        "retrieve client_id from access token claims"[0m
[30;1m571 | [0m[35m        claims = self._get_token_claims(self._get_token_access_token(token))[0m
[30;1m572 | [0m[35m        client_id = claims.get("client_id") or claims.get("appid") or claims.get("azp")[0m
[30;1m573 | [0m[35m        return client_id[0m
[30;1m574 | [0m[35m[0m
[30;1m575 | [0m[35m    [0m

[31m--[ [0m[34mMatch #[0m[33m1140[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m560 | [0m[35m        "retrieve not_before from access token claims"[0m
[30;1m561 | [0m[35m        not_before = None[0m
[30;1m562 | [0m[35m        claims = self._get_token_claims(self._get_token_access_token(token))[0m
[30;1m563 | [0m[35m        nbf = claims.get("nbf")[0m
[30;1m564 | [0m[35m        if nbf is not None:[0m
[30;1m565 | [0m[35m            not_before = time.strftime("%Y-%m-%d %H:%M:%S", time.localtime(nbf))[0m
[30;1m566 | [0m[35m        return not_before[0m

[31m--[ [0m[34mMatch #[0m[33m1141[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m550 | [0m[35m        "retrieve expires_on from access token claims"[0m
[30;1m551 | [0m[35m        expires_on = None[0m
[30;1m552 | [0m[35m        claims = self._get_token_claims(self._get_token_access_token(token))[0m
[30;1m553 | [0m[35m        exp = claims.get("exp")[0m
[30;1m554 | [0m[35m        if exp is not None:[0m
[30;1m555 | [0m[35m            expires_on = time.strftime("%Y-%m-%d %H:%M:%S", time.localtime(exp))[0m
[30;1m556 | [0m[35m        return expires_on[0m

[31m--[ [0m[34mMatch #[0m[33m1142[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m542 | [0m[35m        id_token_claims = self._get_token_claims(self._get_token_id_token(token))[0m
[30;1m543 | [0m[35m        access_token_claims = self._get_token_claims(self._get_token_access_token(token))[0m
[30;1m544 | [0m[35m        claims = {**access_token_claims, **id_token_claims}[0m
[30;1m545 | [0m[35m        username = claims.get("preferred_username") or claims.get("unique_name") or claims.get("upn"[0m
[30;1m546 | [0m[35m        return username[0m
[30;1m547 | [0m[35m[0m
[30;1m548 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1143[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m542 | [0m[35m        id_token_claims = self._get_token_claims(self._get_token_id_token(token))[0m
[30;1m543 | [0m[35m        access_token_claims = self._get_token_claims(self._get_token_access_token(token))[0m
[30;1m544 | [0m[35m        claims = {**access_token_claims, **id_token_claims}[0m
[30;1m545 | [0m[35m        username = claims.get("preferred_username") or claims.get("unique_name") or claims.get("upn"[0m
[30;1m546 | [0m[35m        return username[0m
[30;1m547 | [0m[35m[0m
[30;1m548 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1144[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m542 | [0m[35m        id_token_claims = self._get_token_claims(self._get_token_id_token(token))[0m
[30;1m543 | [0m[35m        access_token_claims = self._get_token_claims(self._get_token_access_token(token))[0m
[30;1m544 | [0m[35m        claims = {**access_token_claims, **id_token_claims}[0m
[30;1m545 | [0m[35m        username = claims.get("preferred_username") or claims.get("unique_name") or claims.get("upn"[0m
[30;1m546 | [0m[35m        return username[0m
[30;1m547 | [0m[35m[0m
[30;1m548 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1145[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m542 | [0m[35m        id_token_claims = self._get_token_claims(self._get_token_id_token(token))[0m
[30;1m543 | [0m[35m        access_token_claims = self._get_token_claims(self._get_token_access_token(token))[0m
[30;1m544 | [0m[35m        claims = {**access_token_claims, **id_token_claims}[0m
[30;1m545 | [0m[35m        username = claims.get("preferred_username") or claims.get("unique_name") or claims.get("upn"[0m
[30;1m546 | [0m[35m        return username[0m
[30;1m547 | [0m[35m[0m
[30;1m548 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1146[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m542 | [0m[35m        id_token_claims = self._get_token_claims(self._get_token_id_token(token))[0m
[30;1m543 | [0m[35m        access_token_claims = self._get_token_claims(self._get_token_access_token(token))[0m
[30;1m544 | [0m[35m        claims = {**access_token_claims, **id_token_claims}[0m
[30;1m545 | [0m[35m        username = claims.get("preferred_username") or claims.get("unique_name") or claims.get("upn"[0m
[30;1m546 | [0m[35m        return username[0m
[30;1m547 | [0m[35m[0m
[30;1m548 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1147[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m520 | [0m[35m[0m
[30;1m521 | [0m[35m[0m
[30;1m522 | [0m[35m    def _get_token_authority(self, token:dict, default_authority:str=None)->str:[0m
[30;1m523 | [0m[35m        return token.get(TokenResponseFields._AUTHORITY) or default_authority[0m
[30;1m524 | [0m[35m[0m
[30;1m525 | [0m[35m[0m
[30;1m526 | [0m[35m    def _create_authorization_header(self)->str:[0m

[31m--[ [0m[34mMatch #[0m[33m1148[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m516 | [0m[35m[0m
[30;1m517 | [0m[35m[0m
[30;1m518 | [0m[35m    def _get_token_id_token(self, token:dict, default_id_token:str=None)->str:[0m
[30;1m519 | [0m[35m        return token.get(OAuth2TokenFields.ID_TOKEN) or default_id_token[0m
[30;1m520 | [0m[35m[0m
[30;1m521 | [0m[35m[0m
[30;1m522 | [0m[35m    def _get_token_authority(self, token:dict, default_authority:str=None)->str:[0m

[31m--[ [0m[34mMatch #[0m[33m1149[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m512 | [0m[35m[0m
[30;1m513 | [0m[35m[0m
[30;1m514 | [0m[35m    def _get_token_refresh_token(self, token:dict, default_refresh_token:str=None)->str:[0m
[30;1m515 | [0m[35m        return token.get(TokenResponseFields.REFRESH_TOKEN) or token.get(OAuth2TokenFields.REFRESH_T[0m
[30;1m516 | [0m[35m[0m
[30;1m517 | [0m[35m[0m
[30;1m518 | [0m[35m    def _get_token_id_token(self, token:dict, default_id_token:str=None)->str:[0m

[31m--[ [0m[34mMatch #[0m[33m1150[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m512 | [0m[35m[0m
[30;1m513 | [0m[35m[0m
[30;1m514 | [0m[35m    def _get_token_refresh_token(self, token:dict, default_refresh_token:str=None)->str:[0m
[30;1m515 | [0m[35m        return token.get(TokenResponseFields.REFRESH_TOKEN) or token.get(OAuth2TokenFields.REFRESH_T[0m
[30;1m516 | [0m[35m[0m
[30;1m517 | [0m[35m[0m
[30;1m518 | [0m[35m    def _get_token_id_token(self, token:dict, default_id_token:str=None)->str:[0m

[31m--[ [0m[34mMatch #[0m[33m1151[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m508 | [0m[35m[0m
[30;1m509 | [0m[35m[0m
[30;1m510 | [0m[35m    def _get_token_user_id(self, token:dict, default_user_id:str=None)->str:[0m
[30;1m511 | [0m[35m        return token.get(TokenResponseFields.USER_ID) or default_user_id[0m
[30;1m512 | [0m[35m[0m
[30;1m513 | [0m[35m[0m
[30;1m514 | [0m[35m    def _get_token_refresh_token(self, token:dict, default_refresh_token:str=None)->str:[0m

[31m--[ [0m[34mMatch #[0m[33m1152[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m504 | [0m[35m[0m
[30;1m505 | [0m[35m[0m
[30;1m506 | [0m[35m    def _get_token_resource(self, token:dict, default_resource:str=None)->str:[0m
[30;1m507 | [0m[35m        return token.get(TokenResponseFields.RESOURCE) or token.get(OAuth2TokenFields.RESOURCE) or d[0m
[30;1m508 | [0m[35m[0m
[30;1m509 | [0m[35m[0m
[30;1m510 | [0m[35m    def _get_token_user_id(self, token:dict, default_user_id:str=None)->str:[0m

[31m--[ [0m[34mMatch #[0m[33m1153[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m504 | [0m[35m[0m
[30;1m505 | [0m[35m[0m
[30;1m506 | [0m[35m    def _get_token_resource(self, token:dict, default_resource:str=None)->str:[0m
[30;1m507 | [0m[35m        return token.get(TokenResponseFields.RESOURCE) or token.get(OAuth2TokenFields.RESOURCE) or d[0m
[30;1m508 | [0m[35m[0m
[30;1m509 | [0m[35m[0m
[30;1m510 | [0m[35m    def _get_token_user_id(self, token:dict, default_user_id:str=None)->str:[0m

[31m--[ [0m[34mMatch #[0m[33m1154[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m500 | [0m[35m[0m
[30;1m501 | [0m[35m[0m
[30;1m502 | [0m[35m    def _get_token_token_type(self, token:dict, default_token_type:str=None)->str:[0m
[30;1m503 | [0m[35m        return token.get(TokenResponseFields.TOKEN_TYPE) or token.get(OAuth2TokenFields.TOKEN_TYPE) [0m
[30;1m504 | [0m[35m[0m
[30;1m505 | [0m[35m[0m
[30;1m506 | [0m[35m    def _get_token_resource(self, token:dict, default_resource:str=None)->str:[0m

[31m--[ [0m[34mMatch #[0m[33m1155[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m500 | [0m[35m[0m
[30;1m501 | [0m[35m[0m
[30;1m502 | [0m[35m    def _get_token_token_type(self, token:dict, default_token_type:str=None)->str:[0m
[30;1m503 | [0m[35m        return token.get(TokenResponseFields.TOKEN_TYPE) or token.get(OAuth2TokenFields.TOKEN_TYPE) [0m
[30;1m504 | [0m[35m[0m
[30;1m505 | [0m[35m[0m
[30;1m506 | [0m[35m    def _get_token_resource(self, token:dict, default_resource:str=None)->str:[0m

[31m--[ [0m[34mMatch #[0m[33m1156[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m495 | [0m[35m        not_before = default_not_before[0m
[30;1m496 | [0m[35m        if token.get(OAuth2TokenFields.NOT_BEFORE) is not None:[0m
[30;1m497 | [0m[35m            # The date is represented as the number of seconds from "1970-01-01T0:0:0Z UTC" (corresp[0m
[30;1m498 | [0m[35m            not_before = time.strftime("%Y-%m-%d %H:%M:%S", time.localtime(token.get(OAuth2TokenFiel[0m
[30;1m499 | [0m[35m        return not_before[0m
[30;1m500 | [0m[35m[0m
[30;1m501 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1157[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m493 | [0m[35m[0m
[30;1m494 | [0m[35m    def _get_token_not_before(self, token:dict, default_not_before:str=None)->str:[0m
[30;1m495 | [0m[35m        not_before = default_not_before[0m
[30;1m496 | [0m[35m        if token.get(OAuth2TokenFields.NOT_BEFORE) is not None:[0m
[30;1m497 | [0m[35m            # The date is represented as the number of seconds from "1970-01-01T0:0:0Z UTC" (corresp[0m
[30;1m498 | [0m[35m            not_before = time.strftime("%Y-%m-%d %H:%M:%S", time.localtime(token.get(OAuth2TokenFiel[0m
[30;1m499 | [0m[35m        return not_before[0m

[31m--[ [0m[34mMatch #[0m[33m1158[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m487 | [0m[35m            expires_on = token.get(TokenResponseFields.EXPIRES_ON)[0m
[30;1m488 | [0m[35m        elif token.get(OAuth2TokenFields.EXPIRES_ON) is not None:[0m
[30;1m489 | [0m[35m            # The date is represented as the number of seconds from "1970-01-01T0:0:0Z UTC" (corresp[0m
[30;1m490 | [0m[35m            expires_on = time.strftime("%Y-%m-%d %H:%M:%S", time.localtime(token.get(OAuth2TokenFiel[0m
[30;1m491 | [0m[35m        return expires_on[0m
[30;1m492 | [0m[35m[0m
[30;1m493 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1159[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m485 | [0m[35m        expires_on = default_expires_on[0m
[30;1m486 | [0m[35m        if token.get(TokenResponseFields.EXPIRES_ON) is not None:[0m
[30;1m487 | [0m[35m            expires_on = token.get(TokenResponseFields.EXPIRES_ON)[0m
[30;1m488 | [0m[35m        elif token.get(OAuth2TokenFields.EXPIRES_ON) is not None:[0m
[30;1m489 | [0m[35m            # The date is represented as the number of seconds from "1970-01-01T0:0:0Z UTC" (corresp[0m
[30;1m490 | [0m[35m            expires_on = time.strftime("%Y-%m-%d %H:%M:%S", time.localtime(token.get(OAuth2TokenFiel[0m
[30;1m491 | [0m[35m        return expires_on[0m

[31m--[ [0m[34mMatch #[0m[33m1160[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m484 | [0m[35m    def _get_token_expires_on(self, token:dict, default_expires_on:str=None)->str:[0m
[30;1m485 | [0m[35m        expires_on = default_expires_on[0m
[30;1m486 | [0m[35m        if token.get(TokenResponseFields.EXPIRES_ON) is not None:[0m
[30;1m487 | [0m[35m            expires_on = token.get(TokenResponseFields.EXPIRES_ON)[0m
[30;1m488 | [0m[35m        elif token.get(OAuth2TokenFields.EXPIRES_ON) is not None:[0m
[30;1m489 | [0m[35m            # The date is represented as the number of seconds from "1970-01-01T0:0:0Z UTC" (corresp[0m
[30;1m490 | [0m[35m            expires_on = time.strftime("%Y-%m-%d %H:%M:%S", time.localtime(token.get(OAuth2TokenFiel[0m

[31m--[ [0m[34mMatch #[0m[33m1161[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m483 | [0m[35m[0m
[30;1m484 | [0m[35m    def _get_token_expires_on(self, token:dict, default_expires_on:str=None)->str:[0m
[30;1m485 | [0m[35m        expires_on = default_expires_on[0m
[30;1m486 | [0m[35m        if token.get(TokenResponseFields.EXPIRES_ON) is not None:[0m
[30;1m487 | [0m[35m            expires_on = token.get(TokenResponseFields.EXPIRES_ON)[0m
[30;1m488 | [0m[35m        elif token.get(OAuth2TokenFields.EXPIRES_ON) is not None:[0m
[30;1m489 | [0m[35m            # The date is represented as the number of seconds from "1970-01-01T0:0:0Z UTC" (corresp[0m

[31m--[ [0m[34mMatch #[0m[33m1162[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m478 | [0m[35m[0m
[30;1m479 | [0m[35m[0m
[30;1m480 | [0m[35m    def _get_token_client_id(self, token:dict, default_client_id:str=None)->str:[0m
[30;1m481 | [0m[35m        return token.get(TokenResponseFields._CLIENT_ID) or token.get(OAuth2TokenFields.CLIENT_ID) o[0m
[30;1m482 | [0m[35m[0m
[30;1m483 | [0m[35m[0m
[30;1m484 | [0m[35m    def _get_token_expires_on(self, token:dict, default_expires_on:str=None)->str:[0m

[31m--[ [0m[34mMatch #[0m[33m1163[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m478 | [0m[35m[0m
[30;1m479 | [0m[35m[0m
[30;1m480 | [0m[35m    def _get_token_client_id(self, token:dict, default_client_id:str=None)->str:[0m
[30;1m481 | [0m[35m        return token.get(TokenResponseFields._CLIENT_ID) or token.get(OAuth2TokenFields.CLIENT_ID) o[0m
[30;1m482 | [0m[35m[0m
[30;1m483 | [0m[35m[0m
[30;1m484 | [0m[35m    def _get_token_expires_on(self, token:dict, default_expires_on:str=None)->str:[0m

[31m--[ [0m[34mMatch #[0m[33m1164[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m474 | [0m[35m    # Assume OAuth2 format (e.g. MSI Token) too[0m
[30;1m475 | [0m[35m    #[0m
[30;1m476 | [0m[35m    def _get_token_access_token(self, token:dict, default_access_token:str=None)->str:[0m
[30;1m477 | [0m[35m        return token.get(TokenResponseFields.ACCESS_TOKEN) or token.get(OAuth2TokenFields.ACCESS_TOK[0m
[30;1m478 | [0m[35m[0m
[30;1m479 | [0m[35m[0m
[30;1m480 | [0m[35m    def _get_token_client_id(self, token:dict, default_client_id:str=None)->str:[0m

[31m--[ [0m[34mMatch #[0m[33m1165[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m474 | [0m[35m    # Assume OAuth2 format (e.g. MSI Token) too[0m
[30;1m475 | [0m[35m    #[0m
[30;1m476 | [0m[35m    def _get_token_access_token(self, token:dict, default_access_token:str=None)->str:[0m
[30;1m477 | [0m[35m        return token.get(TokenResponseFields.ACCESS_TOKEN) or token.get(OAuth2TokenFields.ACCESS_TOK[0m
[30;1m478 | [0m[35m[0m
[30;1m479 | [0m[35m[0m
[30;1m480 | [0m[35m    def _get_token_client_id(self, token:dict, default_client_id:str=None)->str:[0m

[31m--[ [0m[34mMatch #[0m[33m1166[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m432 | [0m[35m                    try:[0m
[30;1m433 | [0m[35m                        token = self._current_adal_context.acquire_token_with_device_code(self._reso[0m
[30;1m434 | [0m[35m                        logger().debug(f"_MyAadHelper::acquire_token - got token - resource: '{self.[0m
[30;1m435 | [0m[35m                        self._username = self._username or token.get(TokenResponseFields.USER_ID)[0m
[30;1m436 | [0m[35m[0m
[30;1m437 | [0m[35m                    finally:[0m
[30;1m438 | [0m[35m                        html_str = """<!DOCTYPE html>[0m

[31m--[ [0m[34mMatch #[0m[33m1167[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m374 | [0m[35m                        # TODO: add flag to prompt[0m
[30;1m375 | [0m[35m                        # input("Press Enter after signing in from another device to proceed, CTRL+C[0m
[30;1m376 | [0m[35m[0m
[30;1m377 | [0m[35m                    elif device_code_login_notification == "popup_interaction" and self._options.get[0m
[30;1m378 | [0m[35m                        before_text = f"<b>{device_code}</b>"[0m
[30;1m379 | [0m[35m                        button_text = "Copy code to clipboard and authenticate"[0m
[30;1m380 | [0m[35m                        # before_text = f"Copy code: {device_code} to verification url: {url} and "[0m

[31m--[ [0m[34mMatch #[0m[33m1168[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m350 | [0m[35met("login_code_destination") =="browser":[0m
[30;1m351 | [0m[35m                    #     raise Exception("error: using papermill without an email specified is not [0m
[30;1m352 | [0m[35m                    if device_code_login_notification == "email":[0m
[30;1m353 | [0m[35m                        params = Parser.parse_and_get_kv_string(self._options.get('device_code_notif[0m
[30;1m354 | [0m[35m                        email_notification = EmailNotification(**params)[0m
[30;1m355 | [0m[35m                        subject = f"Kqlmagic device_code {device_code} authentication (context: {ema[0m

[31m--[ [0m[34mMatch #[0m[33m1169[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m347 | [0m[35m                        except: # pylint: disable=bare-except[0m
[30;1m348 | [0m[35m                            pass[0m
[30;1m349 | [0m[35m[0m
[30;1m350 | [0m[35m                    # if  self._options.get("notebook_app")=="papermill" and self._options.get("logi[0m
[30;1m351 | [0m[35m                    #     raise Exception("error: using papermill without an email specified is not [0m
[30;1m352 | [0m[35m                    if device_code_login_notification == "email":[0m
[30;1m353 | [0m[35m                        params = Parser.parse_and_get_kv_string(self._options.get('device_code_notif[0m

[31m--[ [0m[34mMatch #[0m[33m1170[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m347 | [0m[35m                        except: # pylint: disable=bare-except[0m
[30;1m348 | [0m[35m                            pass[0m
[30;1m349 | [0m[35m[0m
[30;1m350 | [0m[35m                    # if  self._options.get("notebook_app")=="papermill" and self._options.get("logi[0m
[30;1m351 | [0m[35m                    #     raise Exception("error: using papermill without an email specified is not [0m
[30;1m352 | [0m[35m                    if device_code_login_notification == "email":[0m
[30;1m353 | [0m[35m                        params = Parser.parse_and_get_kv_string(self._options.get('device_code_notif[0m

[31m--[ [0m[34mMatch #[0m[33m1171[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m338 | [0m[35m[0m
[30;1m339 | [0m[35m                    if (self._options.get("kernel_location") == "local"[0m
[30;1m340 | [0m[35m                            or device_code_login_notification in ["browser"][0m
[30;1m341 | [0m[35m                            or (device_code_login_notification == "popup_interaction" and self._opti[0m
[30;1m342 | [0m[35m                        # copy code to local clipboard[0m
[30;1m343 | [0m[35m                        try:[0m
[30;1m344 | [0m[35m                            pyperclip = Dependencies.get_module("pyperclip", dont_throw=True)[0m

[31m--[ [0m[34mMatch #[0m[33m1172[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m336 | [0m[35m                        else:[0m
[30;1m337 | [0m[35m                            device_code_login_notification = "button"[0m
[30;1m338 | [0m[35m[0m
[30;1m339 | [0m[35m                    if (self._options.get("kernel_location") == "local"[0m
[30;1m340 | [0m[35m                            or device_code_login_notification in ["browser"][0m
[30;1m341 | [0m[35m                            or (device_code_login_notification == "popup_interaction" and self._opti[0m
[30;1m342 | [0m[35m                        # copy code to local clipboard[0m

[31m--[ [0m[34mMatch #[0m[33m1173[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m327 | [0m[35m             if self._options.get("temp_files_server_address") is not None:[0m
[30;1m328 | [0m[35m                                    import urllib.parse[0m
[30;1m329 | [0m[35m                                    indirect_url = f'{self._options.get("temp_files_server_address")[0m
[30;1m330 | [0m[35m                                    url = indirect_url[0m
[30;1m331 | [0m[35m                                    device_code_login_notification = "popup_interaction"[0m
[30;1m332 | [0m[35m                                else:[0m
[30;1m333 | [0m[35m                                    device_code_login_notification = "browser"[0m

[31m--[ [0m[34mMatch #[0m[33m1174[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m326 | [0m[35mot execute authentication script, workaround using temp_file_server webbrowser[0m
[30;1m327 | [0m[35m                                if self._options.get("temp_files_server_address") is not None:[0m
[30;1m328 | [0m[35m                                    import urllib.parse[0m
[30;1m329 | [0m[35m                                    indirect_url = f'{self._options.get("temp_files_server_address")[0m
[30;1m330 | [0m[35m                                    url = indirect_url[0m
[30;1m331 | [0m[35m                                    device_code_login_notification = "popup_interaction"[0m
[30;1m332 | [0m[35m                                else:[0m

[31m--[ [0m[34mMatch #[0m[33m1175[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m324 | [0m[35m[0m
[30;1m325 | [0m[35m                            if self._options.get("kernel_location") == "local":[0m
[30;1m326 | [0m[35m                                # ntreact cannot execute authentication script, workaround using tem[0m
[30;1m327 | [0m[35m                                if self._options.get("temp_files_server_address") is not None:[0m
[30;1m328 | [0m[35m                                    import urllib.parse[0m
[30;1m329 | [0m[35m                                    indirect_url = f'{self._options.get("temp_files_server_address")[0m
[30;1m330 | [0m[35m                                    url = indirect_url[0m

[31m--[ [0m[34mMatch #[0m[33m1176[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m322 | [0m[35m                            device_code_login_notification = "popup_interaction"[0m
[30;1m323 | [0m[35m                        elif self._options.get("notebook_app") in ["nteract"]:[0m
[30;1m324 | [0m[35m[0m
[30;1m325 | [0m[35m                            if self._options.get("kernel_location") == "local":[0m
[30;1m326 | [0m[35m                                # ntreact cannot execute authentication script, workaround using tem[0m
[30;1m327 | [0m[35m                                if self._options.get("temp_files_server_address") is not None:[0m
[30;1m328 | [0m[35m                                    import urllib.parse[0m

[31m--[ [0m[34mMatch #[0m[33m1177[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m320 | [0m[35m                            device_code_login_notification = "popup_interaction"[0m
[30;1m321 | [0m[35m                        elif self._options.get("notebook_app") in ["visualstudiocode", "azuredatastu[0m
[30;1m322 | [0m[35m                            device_code_login_notification = "popup_interaction"[0m
[30;1m323 | [0m[35m                        elif self._options.get("notebook_app") in ["nteract"]:[0m
[30;1m324 | [0m[35m[0m
[30;1m325 | [0m[35m                            if self._options.get("kernel_location") == "local":[0m
[30;1m326 | [0m[35m                                # ntreact cannot execute authentication script, workaround using tem[0m

[31m--[ [0m[34mMatch #[0m[33m1178[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m318 | [0m[35m                            device_code_login_notification = "terminal"[0m
[30;1m319 | [0m[35m                        elif self._options.get("notebook_app") in ["ipython"]:[0m
[30;1m320 | [0m[35m                            device_code_login_notification = "popup_interaction"[0m
[30;1m321 | [0m[35m                        elif self._options.get("notebook_app") in ["visualstudiocode", "azuredatastu[0m
[30;1m322 | [0m[35m                            device_code_login_notification = "popup_interaction"[0m
[30;1m323 | [0m[35m                        elif self._options.get("notebook_app") in ["nteract"]:[0m
[30;1m324 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1179[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m316 | [0m[35m                    if device_code_login_notification == "auto":[0m
[30;1m317 | [0m[35m                        if self._options.get("notebook_app") in ["azuredatastudiosaw"]:[0m
[30;1m318 | [0m[35m                            device_code_login_notification = "terminal"[0m
[30;1m319 | [0m[35m                        elif self._options.get("notebook_app") in ["ipython"]:[0m
[30;1m320 | [0m[35m                            device_code_login_notification = "popup_interaction"[0m
[30;1m321 | [0m[35m                        elif self._options.get("notebook_app") in ["visualstudiocode", "azuredatastu[0m
[30;1m322 | [0m[35m                            device_code_login_notification = "popup_interaction"[0m

[31m--[ [0m[34mMatch #[0m[33m1180[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m314 | [0m[35m[0m
[30;1m315 | [0m[35m                    device_code_login_notification = self._options.get("device_code_login_notificati[0m
[30;1m316 | [0m[35m                    if device_code_login_notification == "auto":[0m
[30;1m317 | [0m[35m                        if self._options.get("notebook_app") in ["azuredatastudiosaw"]:[0m
[30;1m318 | [0m[35m                            device_code_login_notification = "terminal"[0m
[30;1m319 | [0m[35m                        elif self._options.get("notebook_app") in ["ipython"]:[0m
[30;1m320 | [0m[35m                            device_code_login_notification = "popup_interaction"[0m

[31m--[ [0m[34mMatch #[0m[33m1181[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m312 | [0m[35m                    url = code[OAuth2DeviceCodeResponseParameters.VERIFICATION_URL][0m
[30;1m313 | [0m[35m                    device_code = code[OAuth2DeviceCodeResponseParameters.USER_CODE].strip()[0m
[30;1m314 | [0m[35m[0m
[30;1m315 | [0m[35m                    device_code_login_notification = self._options.get("device_code_login_notificati[0m
[30;1m316 | [0m[35m                    if device_code_login_notification == "auto":[0m
[30;1m317 | [0m[35m                        if self._options.get("notebook_app") in ["azuredatastudiosaw"]:[0m
[30;1m318 | [0m[35m                            device_code_login_notification = "terminal"[0m

[31m--[ [0m[34mMatch #[0m[33m1182[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m275 | [0m[35m                    self._current_token = self._validate_and_refresh_token(token)[0m
[30;1m276 | [0m[35m[0m
[30;1m277 | [0m[35m            if self._current_token is None:[0m
[30;1m278 | [0m[35m                if self._options.get("try_azcli_login_by_profile"):[0m
[30;1m279 | [0m[35m                    token = self._get_azcli_token()[0m
[30;1m280 | [0m[35m                    self._current_token = self._validate_and_refresh_token(token)[0m
[30;1m281 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1183[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m270 | [0m[35m                    self._current_token = self._validate_and_refresh_token(token)[0m
[30;1m271 | [0m[35m[0m
[30;1m272 | [0m[35m            if self._current_token is None:[0m
[30;1m273 | [0m[35m                if self._options.get("try_azcli_login"):[0m
[30;1m274 | [0m[35m                    token = self._get_azcli_token()[0m
[30;1m275 | [0m[35m                    self._current_token = self._validate_and_refresh_token(token)[0m
[30;1m276 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1184[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m266 | [0m[35m[0m
[30;1m267 | [0m[35m            if self._current_token is None:[0m
[30;1m268 | [0m[35m                if self._options.get("try_azcli_login_subscription") is not None:[0m
[30;1m269 | [0m[35m                    token = self._get_azcli_token(subscription=self._options.get("try_azcli_login_su[0m
[30;1m270 | [0m[35m                    self._current_token = self._validate_and_refresh_token(token)[0m
[30;1m271 | [0m[35m[0m
[30;1m272 | [0m[35m            if self._current_token is None:[0m

[31m--[ [0m[34mMatch #[0m[33m1185[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m265 | [0m[35m                    self._current_token = self._validate_and_refresh_token(token)[0m
[30;1m266 | [0m[35m[0m
[30;1m267 | [0m[35m            if self._current_token is None:[0m
[30;1m268 | [0m[35m                if self._options.get("try_azcli_login_subscription") is not None:[0m
[30;1m269 | [0m[35m                    token = self._get_azcli_token(subscription=self._options.get("try_azcli_login_su[0m
[30;1m270 | [0m[35m                    self._current_token = self._validate_and_refresh_token(token)[0m
[30;1m271 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1186[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m261 | [0m[35m[0m
[30;1m262 | [0m[35m            if self._current_token is None:[0m
[30;1m263 | [0m[35m                if self._options.get("try_msi") is not None:[0m
[30;1m264 | [0m[35m                    token = self._get_msi_token(msi_params=self._options.get("try_msi"))[0m
[30;1m265 | [0m[35m                    self._current_token = self._validate_and_refresh_token(token)[0m
[30;1m266 | [0m[35m[0m
[30;1m267 | [0m[35m            if self._current_token is None:[0m

[31m--[ [0m[34mMatch #[0m[33m1187[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m260 | [0m[35m                    self._current_token = self._validate_and_refresh_token(token)[0m
[30;1m261 | [0m[35m[0m
[30;1m262 | [0m[35m            if self._current_token is None:[0m
[30;1m263 | [0m[35m                if self._options.get("try_msi") is not None:[0m
[30;1m264 | [0m[35m                    token = self._get_msi_token(msi_params=self._options.get("try_msi"))[0m
[30;1m265 | [0m[35m                    self._current_token = self._validate_and_refresh_token(token)[0m
[30;1m266 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1188[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m256 | [0m[35m[0m
[30;1m257 | [0m[35m            if self._current_token is None:[0m
[30;1m258 | [0m[35m                if self._options.get("try_token") is not None:[0m
[30;1m259 | [0m[35m                    token = self._get_aux_token(token=self._options.get("try_token"))[0m
[30;1m260 | [0m[35m                    self._current_token = self._validate_and_refresh_token(token)[0m
[30;1m261 | [0m[35m[0m
[30;1m262 | [0m[35m            if self._current_token is None:[0m

[31m--[ [0m[34mMatch #[0m[33m1189[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m255 | [0m[35m                self._current_adal_context = None[0m
[30;1m256 | [0m[35m[0m
[30;1m257 | [0m[35m            if self._current_token is None:[0m
[30;1m258 | [0m[35m                if self._options.get("try_token") is not None:[0m
[30;1m259 | [0m[35m                    token = self._get_aux_token(token=self._options.get("try_token"))[0m
[30;1m260 | [0m[35m                    self._current_token = self._validate_and_refresh_token(token)[0m
[30;1m261 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1190[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m232 | [0m[35m        elif self._current_authentication_method == AuthenticationMethod.azcli_login_by_profile:[0m
[30;1m233 | [0m[35m            details["tenant"] = self._authority[0m
[30;1m234 | [0m[35m        elif self._current_authentication_method == AuthenticationMethod.managed_service_identity:[0m
[30;1m235 | [0m[35m            details["msi_params"] = self._options.get("try_msi")[0m
[30;1m236 | [0m[35m        elif self._current_authentication_method == AuthenticationMethod.aad_application_certificate[0m
[30;1m237 | [0m[35m            details["thumbprint"] = self._thumbprint[0m
[30;1m238 | [0m[35m        elif self._current_authentication_method == AuthenticationMethod.aad_application_key:[0m

[31m--[ [0m[34mMatch #[0m[33m1191[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m226 | [0m[35m            details["username"] = self._get_token_user_id(self._current_token) or self._get_username[0m
[30;1m227 | [0m[35m[0m
[30;1m228 | [0m[35m        if self._current_authentication_method == AuthenticationMethod.azcli_login_subscription:[0m
[30;1m229 | [0m[35m            details["subscription"] = self._options.get("try_azcli_login_subscription")[0m
[30;1m230 | [0m[35m        elif self._current_authentication_method == AuthenticationMethod.azcli_login:[0m
[30;1m231 | [0m[35m            details["tenant"] = self._authority[0m
[30;1m232 | [0m[35m        elif self._current_authentication_method == AuthenticationMethod.azcli_login_by_profile:[0m

[31m--[ [0m[34mMatch #[0m[33m1192[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m        self._authority = kcsb.authority_id or "common"[0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35m        self._aad_login_url = self._get_aad_login_url(kcsb.conn_kv.get(ConnStrKeys.AAD_URL))[0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35m        self._set_adal_context(adal_context=adal_context, adal_context_sso=adal_context_sso)[0m
[30;1m189 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1193[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m79 | [0m[35m        if kcsb_attr_name == "data_source":[0m
[30;1m80 | [0m[35m            return self.data_source[0m
[30;1m81 | [0m[35m        key = self.translate_map.get(kcsb_attr_name)[0m
[30;1m82 | [0m[35m        return self.conn_kv.get(key)[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35mclass AuthenticationMethod(object):[0m

[31m--[ [0m[34mMatch #[0m[33m1194[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m78 | [0m[35m    def __getattr__(self, kcsb_attr_name):[0m
[30;1m79 | [0m[35m        if kcsb_attr_name == "data_source":[0m
[30;1m80 | [0m[35m            return self.data_source[0m
[30;1m81 | [0m[35m        key = self.translate_map.get(kcsb_attr_name)[0m
[30;1m82 | [0m[35m        return self.conn_kv.get(key)[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1195[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m44 | [0m[35m        exception = exception.exception if isinstance(exception, AuthenticationError) else exception[0m
[30;1m45 | [0m[35m        self.authentication_method = kwargs.get("authentication_method")[0m
[30;1m46 | [0m[35m        self.authority = kwargs.get("authority")[0m
[30;1m47 | [0m[35m        self.resource = kwargs.get("resource")[0m
[30;1m48 | [0m[35m        self.exception = exception[0m
[30;1m49 | [0m[35m        self.kwargs = kwargs[0m
[30;1m50 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1196[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m        super(AuthenticationError, self).__init__()[0m
[30;1m44 | [0m[35m        exception = exception.exception if isinstance(exception, AuthenticationError) else exception[0m
[30;1m45 | [0m[35m        self.authentication_method = kwargs.get("authentication_method")[0m
[30;1m46 | [0m[35m        self.authority = kwargs.get("authority")[0m
[30;1m47 | [0m[35m        self.resource = kwargs.get("resource")[0m
[30;1m48 | [0m[35m        self.exception = exception[0m
[30;1m49 | [0m[35m        self.kwargs = kwargs[0m

[31m--[ [0m[34mMatch #[0m[33m1197[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m    def __init__(self, exception, **kwargs):[0m
[30;1m43 | [0m[35m        super(AuthenticationError, self).__init__()[0m
[30;1m44 | [0m[35m        exception = exception.exception if isinstance(exception, AuthenticationError) else exception[0m
[30;1m45 | [0m[35m        self.authentication_method = kwargs.get("authentication_method")[0m
[30;1m46 | [0m[35m        self.authority = kwargs.get("authority")[0m
[30;1m47 | [0m[35m        self.resource = kwargs.get("resource")[0m
[30;1m48 | [0m[35m        self.exception = exception[0m

[31m--[ [0m[34mMatch #[0m[33m1198[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m.hostname[0m
[30;1m179 | [0m[35m        self._displayed_warnings = [][0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35m        url = urlparse(kcsb.data_source)[0m
[30;1m182 | [0m[35m        self._resource = f"{url.scheme}://{url.hostname}"[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m        self._authority = kcsb.authority_id or "common"[0m
[30;1m185 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1199[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m882 | [0m[35m            elif padding_size == 1:[0m
[30;1m883 | [0m[35m                url_str += '='[0m
[30;1m884 | [0m[35m            else:[0m
[30;1m885 | [0m[35m                raise ValueError(f"Invalid base64 url string: {url_str}")[0m

[31m--[ [0m[34mMatch #[0m[33m1200[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m667 | [0m[35m[0m
[30;1m668 | [0m[35m[0m
[30;1m669 | [0m[35m    def _get_msi_token(self, msi_params=None)->str:[0m
[30;1m670 | [0m[35m        "retrieve token from managed service identity"[0m
[30;1m671 | [0m[35m        msi_params = msi_params or {}[0m
[30;1m672 | [0m[35m        token = None[0m
[30;1m673 | [0m[35m        self._current_authentication_method = AuthenticationMethod.managed_service_identity[0m

[31m--[ [0m[34mMatch #[0m[33m1201[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m132 | [0m[35mclass OAuth2TokenFields(object):[0m
[30;1m133 | [0m[35m    # taken from here: https://docs.microsoft.com/en-us/azure/app-service/overview-managed-identity?[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m    # The requested access token. The calling web service can use this token to authenticate to the [0m
[30;1m136 | [0m[35m    ACCESS_TOKEN = 'access_token'[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m    # The client ID of the identity that was used.[0m

[31m--[ [0m[34mMatch #[0m[33m1202[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14 | [0m[35mfrom urllib.parse import urlparse[0m
[30;1m15 | [0m[35m# import webbrowser[0m
[30;1m16 | [0m[35mimport json[0m
[30;1m17 | [0m[35mfrom base64 import urlsafe_b64decode[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35mimport dateutil.parser[0m

[31m--[ [0m[34mMatch #[0m[33m1203[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_aad_helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mimport os[0m
[30;1m11 | [0m[35mimport sys[0m
[30;1m12 | [0m[35mimport time[0m
[30;1m13 | [0m[35mfrom datetime import timedelta, datetime[0m
[30;1m14 | [0m[35mfrom urllib.parse import urlparse[0m
[30;1m15 | [0m[35m# import webbrowser[0m

[31m--[ [0m[34mMatch #[0m[33m1204[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m817 | [0m[35m            if display_handler_name is not None:[0m
[30;1m818 | [0m[35m                if options.get("display_id", False):[0m
[30;1m819 | [0m[35m                    html_str = Display.toHtml(**html_msg)[0m
[30;1m820 | [0m[35m                # dh = options["display_handlers"].get(display_handler_name)[0m
[30;1m821 | [0m[35m                # if dh is not None:[0m
[30;1m822 | [0m[35m                #     html_str = Display.toHtml(**html_msg)[0m
[30;1m823 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m1205[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m815 | [0m[35m        html_str = None[0m
[30;1m816 | [0m[35m        if html_msg is None or len(html_msg["body"]) == 0:[0m
[30;1m817 | [0m[35m            if display_handler_name is not None:[0m
[30;1m818 | [0m[35m                if options.get("display_id", False):[0m
[30;1m819 | [0m[35m                    html_str = Display.toHtml(**html_msg)[0m
[30;1m820 | [0m[35m                # dh = options["display_handlers"].get(display_handler_name)[0m
[30;1m821 | [0m[35m                # if dh is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m1206[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m765 | [0m[35m        if isinstance(msg, dict):[0m
[30;1m766 | [0m[35m            if isinstance(msg.get("style_options"), dict):[0m
[30;1m767 | [0m[35m                style_options = msg.get("style_options")[0m
[30;1m768 | [0m[35m                msg = msg.get("message")[0m
[30;1m769 | [0m[35m        [0m
[30;1m770 | [0m[35m        if isinstance(msg, list):[0m
[30;1m771 | [0m[35m            msg_str = "<br>".join(msg)[0m

[31m--[ [0m[34mMatch #[0m[33m1207[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m764 | [0m[35m        style_options = {}[0m
[30;1m765 | [0m[35m        if isinstance(msg, dict):[0m
[30;1m766 | [0m[35m            if isinstance(msg.get("style_options"), dict):[0m
[30;1m767 | [0m[35m                style_options = msg.get("style_options")[0m
[30;1m768 | [0m[35m                msg = msg.get("message")[0m
[30;1m769 | [0m[35m        [0m
[30;1m770 | [0m[35m        if isinstance(msg, list):[0m

[31m--[ [0m[34mMatch #[0m[33m1208[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m763 | [0m[35m[0m
[30;1m764 | [0m[35m        style_options = {}[0m
[30;1m765 | [0m[35m        if isinstance(msg, dict):[0m
[30;1m766 | [0m[35m            if isinstance(msg.get("style_options"), dict):[0m
[30;1m767 | [0m[35m                style_options = msg.get("style_options")[0m
[30;1m768 | [0m[35m                msg = msg.get("message")[0m
[30;1m769 | [0m[35m        [0m

[31m--[ [0m[34mMatch #[0m[33m1209[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m752 | [0m[35m            {title}[0m
[30;1m753 | [0m[35m        </head>[0m
[30;1m754 | [0m[35m        <body>[0m
[30;1m755 | [0m[35m            {kwargs.get('body', '')}[0m
[30;1m756 | [0m[35m        </body>[0m
[30;1m757 | [0m[35m        </html>"""[0m
[30;1m758 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1210[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m748 | [0m[35m        title = '' if kwargs.get('title') is None else f"<title>{Constants.MAGIC_PACKAGE_NAME} - {kw[0m
[30;1m749 | [0m[35m        return f"""<html>[0m
[30;1m750 | [0m[35m        <head>[0m
[30;1m751 | [0m[35m            {kwargs.get('head', '')}[0m
[30;1m752 | [0m[35m            {title}[0m
[30;1m753 | [0m[35m        </head>[0m
[30;1m754 | [0m[35m        <body>[0m

[31m--[ [0m[34mMatch #[0m[33m1211[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m745 | [0m[35m[0m
[30;1m746 | [0m[35m    @staticmethod[0m
[30;1m747 | [0m[35m    def toHtml(**kwargs):[0m
[30;1m748 | [0m[35m        title = '' if kwargs.get('title') is None else f"<title>{Constants.MAGIC_PACKAGE_NAME} - {kw[0m
[30;1m749 | [0m[35m        return f"""<html>[0m
[30;1m750 | [0m[35m        <head>[0m
[30;1m751 | [0m[35m            {kwargs.get('head', '')}[0m

[31m--[ [0m[34mMatch #[0m[33m1212[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m745 | [0m[35m[0m
[30;1m746 | [0m[35m    @staticmethod[0m
[30;1m747 | [0m[35m    def toHtml(**kwargs):[0m
[30;1m748 | [0m[35m        title = '' if kwargs.get('title') is None else f"<title>{Constants.MAGIC_PACKAGE_NAME} - {kw[0m
[30;1m749 | [0m[35m        return f"""<html>[0m
[30;1m750 | [0m[35m        <head>[0m
[30;1m751 | [0m[35m            {kwargs.get('head', '')}[0m

[31m--[ [0m[34mMatch #[0m[33m1213[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m602 | [0m[35m        options = options or {}[0m
[30;1m603 | [0m[35m        # if isText is True, file_path_or_data is the text[0m
[30;1m604 | [0m[35m        host_or_text = 'text' if isText else (options.get("notebook_service_address") or "")[0m
[30;1m605 | [0m[35m        if host_or_text != 'text' and options.get("popup_interaction") == "memory_button":[0m
[30;1m606 | [0m[35m            if file_path_or_data.startswith("http"):[0m
[30;1m607 | [0m[35m                with urllib.request.urlopen(file_path_or_data) as bytes_reader:[0m
[30;1m608 | [0m[35m                    file_path_or_data = bytes_reader.read().decode('utf-8')[0m

[31m--[ [0m[34mMatch #[0m[33m1214[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m601 | [0m[35m    def _get_Launch_page_html(window_name, file_path_or_data, close_window_timeout_in_secs, close_it[0m
[30;1m602 | [0m[35m        options = options or {}[0m
[30;1m603 | [0m[35m        # if isText is True, file_path_or_data is the text[0m
[30;1m604 | [0m[35m        host_or_text = 'text' if isText else (options.get("notebook_service_address") or "")[0m
[30;1m605 | [0m[35m        if host_or_text != 'text' and options.get("popup_interaction") == "memory_button":[0m
[30;1m606 | [0m[35m            if file_path_or_data.startswith("http"):[0m
[30;1m607 | [0m[35m                with urllib.request.urlopen(file_path_or_data) as bytes_reader:[0m

[31m--[ [0m[34mMatch #[0m[33m1215[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m470 | [0m[35m            file_path_or_data = Display._get_file_path_url(file_path_or_data, options=options)[0m
[30;1m471 | [0m[35m[0m
[30;1m472 | [0m[35m            if options.get("temp_files_server_address") is not None and content == "schema" and opti[0m
[30;1m473 | [0m[35m                indirect_url = f'{options.get("temp_files_server_address")}/webbrowser?url={urllib.p[0m
[30;1m474 | [0m[35m                file_path_or_data = indirect_url[0m
[30;1m475 | [0m[35m[0m
[30;1m476 | [0m[35m            [0m

[31m--[ [0m[34mMatch #[0m[33m1216[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m470 | [0m[35m            file_path_or_data = Display._get_file_path_url(file_path_or_data, options=options)[0m
[30;1m471 | [0m[35m[0m
[30;1m472 | [0m[35m            if options.get("temp_files_server_address") is not None and content == "schema" and opti[0m
[30;1m473 | [0m[35m                indirect_url = f'{options.get("temp_files_server_address")}/webbrowser?url={urllib.p[0m
[30;1m474 | [0m[35m                file_path_or_data = indirect_url[0m
[30;1m475 | [0m[35m[0m
[30;1m476 | [0m[35m            [0m

[31m--[ [0m[34mMatch #[0m[33m1217[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m469 | [0m[35m        if not isText and Display.showfiles_url_base_path.startswith("http"):[0m
[30;1m470 | [0m[35m            file_path_or_data = Display._get_file_path_url(file_path_or_data, options=options)[0m
[30;1m471 | [0m[35m[0m
[30;1m472 | [0m[35m            if options.get("temp_files_server_address") is not None and content == "schema" and opti[0m
[30;1m473 | [0m[35m                indirect_url = f'{options.get("temp_files_server_address")}/webbrowser?url={urllib.p[0m
[30;1m474 | [0m[35m                file_path_or_data = indirect_url[0m
[30;1m475 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1218[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m469 | [0m[35m        if not isText and Display.showfiles_url_base_path.startswith("http"):[0m
[30;1m470 | [0m[35m            file_path_or_data = Display._get_file_path_url(file_path_or_data, options=options)[0m
[30;1m471 | [0m[35m[0m
[30;1m472 | [0m[35m            if options.get("temp_files_server_address") is not None and content == "schema" and opti[0m
[30;1m473 | [0m[35m                indirect_url = f'{options.get("temp_files_server_address")}/webbrowser?url={urllib.p[0m
[30;1m474 | [0m[35m                file_path_or_data = indirect_url[0m
[30;1m475 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1219[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m437 | [0m[35m        options = options or {}[0m
[30;1m438 | [0m[35m        # if isText is True, file_path_or_data is the text[0m
[30;1m439 | [0m[35m        host_or_text = 'text' if isText else (options.get("notebook_service_address") or "")[0m
[30;1m440 | [0m[35m        if host_or_text != 'text' and options.get("popup_interaction") == "memory_button":[0m
[30;1m441 | [0m[35m            if file_path_or_data.startswith("http"):[0m
[30;1m442 | [0m[35m                with urllib.request.urlopen(file_path_or_data) as bytes_reader:[0m
[30;1m443 | [0m[35m                    file_path_or_data = bytes_reader.read().decode('utf-8')[0m

[31m--[ [0m[34mMatch #[0m[33m1220[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m436 | [0m[35mone, palette=None, before_text=None, after_text=None, close_window_timeout_in_secs=None, close_itsel[0m
[30;1m437 | [0m[35m        options = options or {}[0m
[30;1m438 | [0m[35m        # if isText is True, file_path_or_data is the text[0m
[30;1m439 | [0m[35m        host_or_text = 'text' if isText else (options.get("notebook_service_address") or "")[0m
[30;1m440 | [0m[35m        if host_or_text != 'text' and options.get("popup_interaction") == "memory_button":[0m
[30;1m441 | [0m[35m            if file_path_or_data.startswith("http"):[0m
[30;1m442 | [0m[35m                with urllib.request.urlopen(file_path_or_data) as bytes_reader:[0m

[31m--[ [0m[34mMatch #[0m[33m1221[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m385 | [0m[35m    @staticmethod[0m
[30;1m386 | [0m[35m    def _get_name(**kwargs):[0m
[30;1m387 | [0m[35m        if kwargs is not None and isinstance(kwargs.get("file_name"), str) and len(kwargs.get("file_[0m
[30;1m388 | [0m[35m            name = kwargs.get("file_name")[0m
[30;1m389 | [0m[35m        else:[0m
[30;1m390 | [0m[35m            name = uuid.uuid4().hex[0m
[30;1m391 | [0m[35m        return name[0m

[31m--[ [0m[34mMatch #[0m[33m1222[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m384 | [0m[35m[0m
[30;1m385 | [0m[35m    @staticmethod[0m
[30;1m386 | [0m[35m    def _get_name(**kwargs):[0m
[30;1m387 | [0m[35m        if kwargs is not None and isinstance(kwargs.get("file_name"), str) and len(kwargs.get("file_[0m
[30;1m388 | [0m[35m            name = kwargs.get("file_name")[0m
[30;1m389 | [0m[35m        else:[0m
[30;1m390 | [0m[35m            name = uuid.uuid4().hex[0m

[31m--[ [0m[34mMatch #[0m[33m1223[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m384 | [0m[35m[0m
[30;1m385 | [0m[35m    @staticmethod[0m
[30;1m386 | [0m[35m    def _get_name(**kwargs):[0m
[30;1m387 | [0m[35m        if kwargs is not None and isinstance(kwargs.get("file_name"), str) and len(kwargs.get("file_[0m
[30;1m388 | [0m[35m            name = kwargs.get("file_name")[0m
[30;1m389 | [0m[35m        else:[0m
[30;1m390 | [0m[35m            name = uuid.uuid4().hex[0m

[31m--[ [0m[34mMatch #[0m[33m1224[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m360 | [0m[35m    @staticmethod[0m
[30;1m361 | [0m[35m    def to_json_styled_class(item, style=None, options=None):[0m
[30;1m362 | [0m[35m        options = options or {}[0m
[30;1m363 | [0m[35m        json_display_style = style or options.get("json_display")[0m
[30;1m364 | [0m[35m        if json_display_style != "raw" and (isinstance(item, list) or isinstance(item, dict) or type[0m
[30;1m365 | [0m[35m            if json_display_style == "formatted":[0m
[30;1m366 | [0m[35m                return _getitem_FormattedJson(item)[0m

[31m--[ [0m[34mMatch #[0m[33m1225[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m331 | [0m[35murl={urllib.parse.quote(url)}&kernelid={options.get("kernel_id")}'[0m
[30;1m332 | [0m[35m            url = indirect_url[0m
[30;1m333 | [0m[35m        ref_text = ref_text or "popup window"[0m
[30;1m334 | [0m[35m        [0m
[30;1m335 | [0m[35m        style_div = f"padding: 10px; color: {palette.get('color')}; background-color: {palette.get('[0m
[30;1m336 | [0m[35m        ref_palette = ref_palette or Display.ref_style[0m

[31m--[ [0m[34mMatch #[0m[33m1226[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m331 | [0m[35mons.get("temp_files_server_address")}/webbrowser?url={urllib.parse.quote(url)}&kernelid={options.get[0m
[30;1m332 | [0m[35m            url = indirect_url[0m
[30;1m333 | [0m[35m        ref_text = ref_text or "popup window"[0m
[30;1m334 | [0m[35m        [0m
[30;1m335 | [0m[35m        style_div = f"padding: 10px; color: {palette.get('color')}; background-color: {palette.get('[0m
[30;1m336 | [0m[35m        ref_palette = ref_palette or Display.ref_style[0m

[31m--[ [0m[34mMatch #[0m[33m1227[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m330 | [0m[35m None:[0m
[30;1m331 | [0m[35m            indirect_url = f'{options.get("temp_files_server_address")}/webbrowser?url={urllib.parse[0m
[30;1m332 | [0m[35m            url = indirect_url[0m
[30;1m333 | [0m[35m        ref_text = ref_text or "popup window"[0m
[30;1m334 | [0m[35m        [0m
[30;1m335 | [0m[35m        style_div = f"padding: 10px; color: {palette.get('color')}; background-color: {palette.get('[0m
[30;1m336 | [0m[35m        ref_palette = ref_palette or Display.ref_style[0m

[31m--[ [0m[34mMatch #[0m[33m1228[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m328 | [0m[35m            url = Display._get_file_path_url(popup_file_path, options=options)[0m
[30;1m329 | [0m[35m[0m
[30;1m330 | [0m[35m        if options.get("temp_files_server_address") is not None:[0m
[30;1m331 | [0m[35m            indirect_url = f'{options.get("temp_files_server_address")}/webbrowser?url={urllib.parse[0m
[30;1m332 | [0m[35m            url = indirect_url[0m
[30;1m333 | [0m[35m        ref_text = ref_text or "popup window"[0m
[30;1m334 | [0m[35m        [0m

[31m--[ [0m[34mMatch #[0m[33m1229[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m328 | [0m[35m            url = Display._get_file_path_url(popup_file_path, options=options)[0m
[30;1m329 | [0m[35m[0m
[30;1m330 | [0m[35m        if options.get("temp_files_server_address") is not None:[0m
[30;1m331 | [0m[35m            indirect_url = f'{options.get("temp_files_server_address")}/webbrowser?url={urllib.parse[0m
[30;1m332 | [0m[35m            url = indirect_url[0m
[30;1m333 | [0m[35m        ref_text = ref_text or "popup window"[0m
[30;1m334 | [0m[35m        [0m

[31m--[ [0m[34mMatch #[0m[33m1230[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m327 | [0m[35m            popup_file_path = Display._html_to_file_path(popup_html, popup_file_name, **options)[0m
[30;1m328 | [0m[35m            url = Display._get_file_path_url(popup_file_path, options=options)[0m
[30;1m329 | [0m[35m[0m
[30;1m330 | [0m[35m        if options.get("temp_files_server_address") is not None:[0m
[30;1m331 | [0m[35m            indirect_url = f'{options.get("temp_files_server_address")}/webbrowser?url={urllib.parse[0m
[30;1m332 | [0m[35m            url = indirect_url[0m
[30;1m333 | [0m[35m        ref_text = ref_text or "popup window"[0m

[31m--[ [0m[34mMatch #[0m[33m1231[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m319 | [0m[35m        url = Display._get_file_path_url(file_path, options=options)[0m
[30;1m320 | [0m[35m        popup_window_name = window_name[0m
[30;1m321 | [0m[35m[0m
[30;1m322 | [0m[35m        if isPopupMode or options.get("temp_files_server_address") is not None:[0m
[30;1m323 | [0m[35m            close_window_timeout_in_secs = close_window_timeout_in_secs or 60  # five minutes[0m
[30;1m324 | [0m[35m            popup_window_name = f"popup_{window_name}"[0m
[30;1m325 | [0m[35m            popup_html = Display._get_popup_window_html(url, window_name, close_window_timeout_in_se[0m

[31m--[ [0m[34mMatch #[0m[33m1232[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m296 | [0m[35m            url = file_path[0m
[30;1m297 | [0m[35m[0m
[30;1m298 | [0m[35m        elif options.get("temp_files_server_address") is not None and Display.showfiles_url_base_pat[0m
[30;1m299 | [0m[35m            url = f'{Display.showfiles_url_base_path}/{adjust_path_to_uri(file_path)}?kernelid={opti[0m
[30;1m300 | [0m[35m[0m
[30;1m301 | [0m[35m        else:[0m
[30;1m302 | [0m[35m            url = Display._get_file_path_file_url(file_path, options=options)[0m

[31m--[ [0m[34mMatch #[0m[33m1233[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m295 | [0m[35m        if file_path.startswith("http"):[0m
[30;1m296 | [0m[35m            url = file_path[0m
[30;1m297 | [0m[35m[0m
[30;1m298 | [0m[35m        elif options.get("temp_files_server_address") is not None and Display.showfiles_url_base_pat[0m
[30;1m299 | [0m[35m            url = f'{Display.showfiles_url_base_path}/{adjust_path_to_uri(file_path)}?kernelid={opti[0m
[30;1m300 | [0m[35m[0m
[30;1m301 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m1234[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m266 | [0m[35m                mode = "webbrowser_open_at_kernel"[0m
[30;1m267 | [0m[35m            elif options.get("notebook_app") in ["visualstudiocode", "azuredatastudiosaw", "azuredat[0m
[30;1m268 | [0m[35m                mode = "reference"[0m
[30;1m269 | [0m[35m            elif options.get("notebook_app") in ["nteract"] and options.get("temp_files_server_addre[0m
[30;1m270 | [0m[35m                mode = "reference"[0m
[30;1m271 | [0m[35m            else:[0m
[30;1m272 | [0m[35m                mode = "button"[0m

[31m--[ [0m[34mMatch #[0m[33m1235[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m266 | [0m[35m                mode = "webbrowser_open_at_kernel"[0m
[30;1m267 | [0m[35m            elif options.get("notebook_app") in ["visualstudiocode", "azuredatastudiosaw", "azuredat[0m
[30;1m268 | [0m[35m                mode = "reference"[0m
[30;1m269 | [0m[35m            elif options.get("notebook_app") in ["nteract"] and options.get("temp_files_server_addre[0m
[30;1m270 | [0m[35m                mode = "reference"[0m
[30;1m271 | [0m[35m            else:[0m
[30;1m272 | [0m[35m                mode = "button"[0m

[31m--[ [0m[34mMatch #[0m[33m1236[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m264 | [0m[35mto":[0m
[30;1m265 | [0m[35m            if options.get("notebook_app") in ["ipython"] and options.get("test_notebook_app") in ["[0m
[30;1m266 | [0m[35m                mode = "webbrowser_open_at_kernel"[0m
[30;1m267 | [0m[35m            elif options.get("notebook_app") in ["visualstudiocode", "azuredatastudiosaw", "azuredat[0m
[30;1m268 | [0m[35m                mode = "reference"[0m
[30;1m269 | [0m[35m            elif options.get("notebook_app") in ["nteract"] and options.get("temp_files_server_addre[0m
[30;1m270 | [0m[35m                mode = "reference"[0m

[31m--[ [0m[34mMatch #[0m[33m1237[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m262 | [0m[35m html_str = None[0m
[30;1m263 | [0m[35m        mode = options.get("popup_interaction", "auto")[0m
[30;1m264 | [0m[35m        if mode == "auto":[0m
[30;1m265 | [0m[35m            if options.get("notebook_app") in ["ipython"] and options.get("test_notebook_app") in ["[0m
[30;1m266 | [0m[35m                mode = "webbrowser_open_at_kernel"[0m
[30;1m267 | [0m[35m            elif options.get("notebook_app") in ["visualstudiocode", "azuredatastudiosaw", "azuredat[0m
[30;1m268 | [0m[35m                mode = "reference"[0m

[31m--[ [0m[34mMatch #[0m[33m1238[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m262 | [0m[35m        html_str = None[0m
[30;1m263 | [0m[35m        mode = options.get("popup_interaction", "auto")[0m
[30;1m264 | [0m[35m        if mode == "auto":[0m
[30;1m265 | [0m[35m            if options.get("notebook_app") in ["ipython"] and options.get("test_notebook_app") in ["[0m
[30;1m266 | [0m[35m                mode = "webbrowser_open_at_kernel"[0m
[30;1m267 | [0m[35m            elif options.get("notebook_app") in ["visualstudiocode", "azuredatastudiosaw", "azuredat[0m
[30;1m268 | [0m[35m                mode = "reference"[0m

[31m--[ [0m[34mMatch #[0m[33m1239[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m262 | [0m[35m        html_str = None[0m
[30;1m263 | [0m[35m        mode = options.get("popup_interaction", "auto")[0m
[30;1m264 | [0m[35m        if mode == "auto":[0m
[30;1m265 | [0m[35m            if options.get("notebook_app") in ["ipython"] and options.get("test_notebook_app") in ["[0m
[30;1m266 | [0m[35m                mode = "webbrowser_open_at_kernel"[0m
[30;1m267 | [0m[35m            elif options.get("notebook_app") in ["visualstudiocode", "azuredatastudiosaw", "azuredat[0m
[30;1m268 | [0m[35m                mode = "reference"[0m

[31m--[ [0m[34mMatch #[0m[33m1240[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m260 | [0m[35m    def get_show_window_html_obj(window_name, file_path, button_text=None, onclick_visibility=None, [0m
[30;1m261 | [0m[35m        options = options or {}[0m
[30;1m262 | [0m[35m        html_str = None[0m
[30;1m263 | [0m[35m        mode = options.get("popup_interaction", "auto")[0m
[30;1m264 | [0m[35m        if mode == "auto":[0m
[30;1m265 | [0m[35m            if options.get("notebook_app") in ["ipython"] and options.get("test_notebook_app") in ["[0m
[30;1m266 | [0m[35m                mode = "webbrowser_open_at_kernel"[0m

[31m--[ [0m[34mMatch #[0m[33m1241[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m245 | [0m[35m    @staticmethod[0m
[30;1m246 | [0m[35m    def get_show_deeplink_html_obj(window_name, deep_link_url:str, close_window_timeout_in_secs: int[0m
[30;1m247 | [0m[35m        options = options or {}[0m
[30;1m248 | [0m[35m        if options.get("kernel_location") == "local":[0m
[30;1m249 | [0m[35m            url = Display.get_show_deeplink_webbrowser_html_obj(window_name, deep_link_url, close_wi[0m
[30;1m250 | [0m[35m            OsDependentAPI.webbrowser_open(url)[0m
[30;1m251 | [0m[35m            Display.showInfoMessage(f"opened popup window: {window_name}, see your browser")[0m

[31m--[ [0m[34mMatch #[0m[33m1242[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m228 | [0m[35m            if dh is not None:[0m
[30;1m229 | [0m[35m                dh.update(content)[0m
[30;1m230 | [0m[35m            else:[0m
[30;1m231 | [0m[35m                options["display_handlers"][display_handler_name] = display(content, display_id=opti[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35m    @staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m1243[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m224 | [0m[35m        elif display_handler_name is None:[0m
[30;1m225 | [0m[35m            display(content)[0m
[30;1m226 | [0m[35m        else:[0m
[30;1m227 | [0m[35m            dh = options["display_handlers"].get(display_handler_name)[0m
[30;1m228 | [0m[35m            if dh is not None:[0m
[30;1m229 | [0m[35m                dh.update(content)[0m
[30;1m230 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m1244[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m215 | [0m[35m            if options is not None and options.get("popup_window", False):[0m
[30;1m216 | [0m[35m                file_name = Display._get_name(**options)[0m
[30;1m217 | [0m[35m                file_ext = None[0m
[30;1m218 | [0m[35m                if options.get("notebook_app") in ["azuredatastudiosaw"]:[0m
[30;1m219 | [0m[35m                    file_ext = "txt"[0m
[30;1m220 | [0m[35m                file_path = Display._html_to_file_path(content, file_name, file_ext=file_ext, **opti[0m
[30;1m221 | [0m[35m                Display.show_window(file_name, file_path, display_handler_name=display_handler_name,[0m

[31m--[ [0m[34mMatch #[0m[33m1245[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m212 | [0m[35m    @staticmethod[0m
[30;1m213 | [0m[35m    def show(content, display_handler_name=None, **options):[0m
[30;1m214 | [0m[35m        if isinstance(content, str) and len(content) > 0:[0m
[30;1m215 | [0m[35m            if options is not None and options.get("popup_window", False):[0m
[30;1m216 | [0m[35m                file_name = Display._get_name(**options)[0m
[30;1m217 | [0m[35m                file_ext = None[0m
[30;1m218 | [0m[35m                if options.get("notebook_app") in ["azuredatastudiosaw"]:[0m

[31m--[ [0m[34mMatch #[0m[33m1246[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m206 | [0m[35m            if dh is not None:[0m
[30;1m207 | [0m[35m                dh.update(html_obj)[0m
[30;1m208 | [0m[35m            else:[0m
[30;1m209 | [0m[35m                options["display_handlers"][display_handler_name] = display(html_obj, display_id=opt[0m
[30;1m210 | [0m[35m        [0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m    @staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m1247[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m202 | [0m[35m        if display_handler_name is None:[0m
[30;1m203 | [0m[35m            display(html_obj)[0m
[30;1m204 | [0m[35m        else:[0m
[30;1m205 | [0m[35m            dh = options["display_handlers"].get(display_handler_name)[0m
[30;1m206 | [0m[35m            if dh is not None:[0m
[30;1m207 | [0m[35m                dh.update(html_obj)[0m
[30;1m208 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m1248[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m        if self.row is not None:[0m
[30;1m125 | [0m[35m            value = self.row.__getitem__(key)[0m
[30;1m126 | [0m[35m        else:[0m
[30;1m127 | [0m[35m            value = self.get(key)[0m
[30;1m128 | [0m[35m        return _getitem_JSON(value, key)[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m    def _repr_json_(self):[0m

[31m--[ [0m[34mMatch #[0m[33m1249[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m    def get(self, key, default=None):[0m
[30;1m119 | [0m[35m        value = super(JSONDict, self).get(key, default)[0m
[30;1m120 | [0m[35m        return _getitem_JSON(value, key or default)[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1250[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m        if self.row is not None:[0m
[30;1m62 | [0m[35m            value = self.row.__getitem__(key)[0m
[30;1m63 | [0m[35m        else:[0m
[30;1m64 | [0m[35m            value = self.get(key)[0m
[30;1m65 | [0m[35m        return _getitem_FormattedJson(value)[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1251[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m53 | [0m[35m                pass[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m    def get(self, key, default=None):[0m
[30;1m56 | [0m[35m        value = super(FormattedJsonDict, self).get(key, default)[0m
[30;1m57 | [0m[35m        return _getitem_FormattedJson(value)[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1252[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m        _dict = self[0m
[30;1m44 | [0m[35m        if len(item) == 1 and isinstance(self.get(" "), list):[0m
[30;1m45 | [0m[35m            _dict = self.get(" ")[0m
[30;1m46 | [0m[35m        formatted_json = json_dumps(_dict, indent=4, sort_keys=True)[0m
[30;1m47 | [0m[35m        self.colorful_json = formatted_json[0m
[30;1m48 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1253[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m        self.update(item)[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m        _dict = self[0m
[30;1m44 | [0m[35m        if len(item) == 1 and isinstance(self.get(" "), list):[0m
[30;1m45 | [0m[35m            _dict = self.get(" ")[0m
[30;1m46 | [0m[35m        formatted_json = json_dumps(_dict, indent=4, sort_keys=True)[0m
[30;1m47 | [0m[35m        self.colorful_json = formatted_json[0m

[31m--[ [0m[34mMatch #[0m[33m1254[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m377 | [0m[35m        text_file = open(full_file_name, "wb")[0m
[30;1m378 | [0m[35m        text_file.write(bytes(html_str, 'utf-8'))[0m
[30;1m379 | [0m[35m        text_file.close()[0m
[30;1m380 | [0m[35m        # ipython will delete file at shutdown or by restart[0m
[30;1m381 | [0m[35m        IPythonAPI.try_add_to_ipython_tempfiles(full_file_name)[0m
[30;1m382 | [0m[35m        return file_path[0m
[30;1m383 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1255[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m425 | [0m[35m the popups in your notebook, by setting popup_interaction option [0m
[30;1m426 | [0m[35m            to 'reference' (will open in a tab) or 'webbrowser_open_at_kernel' (will auto open in a [0m
[30;1m427 | [0m[35m            or 'button'. Some modes are not supported by some jupyter based implementations (try and[0m
[30;1m428 | [0m[35m            <br> To set the default mode in your notebook, run: %config Kqlmagic.popup_interaction={[0m
[30;1m429 | [0m[35m            <br> To set the mode for the current kql magic execution, add the option -pi '{{mode}}'[0m
[30;1m430 | [0m[35m            </p>[0m
[30;1m431 | [0m[35m            </body></html>"""[0m
[30;1m432 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1256[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/display.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35m# --------------------------------------------------------------------------[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mimport os[0m
[30;1m8 | [0m[35mimport base64[0m
[30;1m9 | [0m[35mimport uuid[0m
[30;1m10 | [0m[35m# import webbrowser[0m
[30;1m11 | [0m[35mimport urllib.parse[0m

[31m--[ [0m[34mMatch #[0m[33m1257[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/database_html.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m212 | [0m[35m                metadata_result = engine.client_execute(show_schema_query, **options)[0m
[30;1m213 | [0m[35m                metadata_schema_table = metadata_result.table[0m
[30;1m214 | [0m[35m                database_metadata_tree = cls._create_database_draft_metadata_tree(metadata_schema_ta[0m
[30;1m215 | [0m[35m                if options.get("cache") is not None and options.get("cache") != options.get("use_cac[0m
[30;1m216 | [0m[35m                    CacheClient(**options).save(metadata_result, engine, show_schema_query, **option[0m
[30;1m217 | [0m[35m                return database_metadata_tree[0m
[30;1m218 | [0m[35m        return None[0m

[31m--[ [0m[34mMatch #[0m[33m1258[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/database_html.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m212 | [0m[35m                metadata_result = engine.client_execute(show_schema_query, **options)[0m
[30;1m213 | [0m[35m                metadata_schema_table = metadata_result.table[0m
[30;1m214 | [0m[35m                database_metadata_tree = cls._create_database_draft_metadata_tree(metadata_schema_ta[0m
[30;1m215 | [0m[35m                if options.get("cache") is not None and options.get("cache") != options.get("use_cac[0m
[30;1m216 | [0m[35m                    CacheClient(**options).save(metadata_result, engine, show_schema_query, **option[0m
[30;1m217 | [0m[35m                return database_metadata_tree[0m
[30;1m218 | [0m[35m        return None[0m

[31m--[ [0m[34mMatch #[0m[33m1259[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/database_html.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m212 | [0m[35m                metadata_result = engine.client_execute(show_schema_query, **options)[0m
[30;1m213 | [0m[35m                metadata_schema_table = metadata_result.table[0m
[30;1m214 | [0m[35m                database_metadata_tree = cls._create_database_draft_metadata_tree(metadata_schema_ta[0m
[30;1m215 | [0m[35m                if options.get("cache") is not None and options.get("cache") != options.get("use_cac[0m
[30;1m216 | [0m[35m                    CacheClient(**options).save(metadata_result, engine, show_schema_query, **option[0m
[30;1m217 | [0m[35m                return database_metadata_tree[0m
[30;1m218 | [0m[35m        return None[0m

[31m--[ [0m[34mMatch #[0m[33m1260[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/database_html.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m203 | [0m[35m                raw_query_result = engine.execute(show_schema_query, **options)[0m
[30;1m204 | [0m[35m                raw_schema_table = raw_query_result.tables[0][0m
[30;1m205 | [0m[35m                database_metadata_tree = cls._create_database_metadata_tree(raw_schema_table.fetchal[0m
[30;1m206 | [0m[35m                if options.get("cache") is not None and options.get("cache") != options.get("use_cac[0m
[30;1m207 | [0m[35m                    CacheClient(**options).save(raw_query_result, engine, show_schema_query, **optio[0m
[30;1m208 | [0m[35m                return database_metadata_tree[0m
[30;1m209 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1261[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/database_html.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m203 | [0m[35m                raw_query_result = engine.execute(show_schema_query, **options)[0m
[30;1m204 | [0m[35m                raw_schema_table = raw_query_result.tables[0][0m
[30;1m205 | [0m[35m                database_metadata_tree = cls._create_database_metadata_tree(raw_schema_table.fetchal[0m
[30;1m206 | [0m[35m                if options.get("cache") is not None and options.get("cache") != options.get("use_cac[0m
[30;1m207 | [0m[35m                    CacheClient(**options).save(raw_query_result, engine, show_schema_query, **optio[0m
[30;1m208 | [0m[35m                return database_metadata_tree[0m
[30;1m209 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1262[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/database_html.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m203 | [0m[35m                raw_query_result = engine.execute(show_schema_query, **options)[0m
[30;1m204 | [0m[35m                raw_schema_table = raw_query_result.tables[0][0m
[30;1m205 | [0m[35m                database_metadata_tree = cls._create_database_metadata_tree(raw_schema_table.fetchal[0m
[30;1m206 | [0m[35m                if options.get("cache") is not None and options.get("cache") != options.get("use_cac[0m
[30;1m207 | [0m[35m                    CacheClient(**options).save(raw_query_result, engine, show_schema_query, **optio[0m
[30;1m208 | [0m[35m                return database_metadata_tree[0m
[30;1m209 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1263[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/database_html.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m154 | [0m[35m    def _convert_table_metadata_tree_to_item(cls, table_name:str, table_metadata_tree:Dict[str,Any],[0m
[30;1m155 | [0m[35m        metadata_items = [][0m
[30;1m156 | [0m[35m        for column_name in table_metadata_tree.keys():[0m
[30;1m157 | [0m[35m            column_type = table_metadata_tree.get(column_name)[0m
[30;1m158 | [0m[35m            if column_type.startswith("System."):[0m
[30;1m159 | [0m[35m                column_type = column_type[7:][0m
[30;1m160 | [0m[35m            metadata_item = cls._convert_column_metadata_to_item(column_name, column_type, **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m1264[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/database_html.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m146 | [0m[35m                    column_name = col["name"][0m
[30;1m147 | [0m[35m                    column_type = col["type"][0m
[30;1m148 | [0m[35m                    if column_name and len(column_name) > 0 and column_type and len(column_type) > 0[0m
[30;1m149 | [0m[35m                        database_metadata_tree.get(table_name)[column_name] = column_type[0m
[30;1m150 | [0m[35m        return database_metadata_tree[0m
[30;1m151 | [0m[35m[0m
[30;1m152 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1265[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/database_html.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m131 | [0m[35m                    if not database_metadata_tree.get(table_name):[0m
[30;1m132 | [0m[35m                        database_metadata_tree[table_name] = {}[0m
[30;1m133 | [0m[35m                    if column_name and len(column_name) > 0 and column_type and len(column_type) > 0[0m
[30;1m134 | [0m[35m                        database_metadata_tree.get(table_name)[column_name] = column_type[0m
[30;1m135 | [0m[35m        return database_metadata_tree[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1266[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/database_html.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m128 | [0m[35m            column_type = row["ColumnType"][0m
[30;1m129 | [0m[35m            if database_name.lower() == database_name.lower():[0m
[30;1m130 | [0m[35m                if table_name and len(table_name) > 0:[0m
[30;1m131 | [0m[35m                    if not database_metadata_tree.get(table_name):[0m
[30;1m132 | [0m[35m                        database_metadata_tree[table_name] = {}[0m
[30;1m133 | [0m[35m                    if column_name and len(column_name) > 0 and column_type and len(column_type) > 0[0m
[30;1m134 | [0m[35m                        database_metadata_tree.get(table_name)[column_name] = column_type[0m

[31m--[ [0m[34mMatch #[0m[33m1267[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/database_html.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m108 | [0m[35m    def _convert_database_metadata_to_html(cls, database_metadata_tree:Dict[str,Any], conn_name:str,[0m
[30;1m109 | [0m[35m        item = ""[0m
[30;1m110 | [0m[35m        for table_name in database_metadata_tree.keys():[0m
[30;1m111 | [0m[35m            table_metadata_tree = database_metadata_tree.get(table_name)[0m
[30;1m112 | [0m[35m            item += cls._convert_table_metadata_tree_to_item(table_name, table_metadata_tree, **kwar[0m
[30;1m113 | [0m[35m        header = conn_name[0m
[30;1m114 | [0m[35m        title = f"{Constants.MAGIC_PACKAGE_NAME} - {conn_name.replace('@', '_at_')} schema"[0m

[31m--[ [0m[34mMatch #[0m[33m1268[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35mdef adjust_path_to_uri(_path:str)->str:[0m
[30;1m127 | [0m[35m    path_obj = convert_to_common_path_obj(_path)[0m
[30;1m128 | [0m[35m    return path_obj.get("prefix") + path_obj.get("path")[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35mdef adjust_path(_path:str)->str:[0m

[31m--[ [0m[34mMatch #[0m[33m1269[0m[34m of [0m[33m1269[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/KqlmagicCustom-0.1.114.post26/azure/Kqlmagic/my_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35mdef adjust_path_to_uri(_path:str)->str:[0m
[30;1m127 | [0m[35m    path_obj = convert_to_common_path_obj(_path)[0m
[30;1m128 | [0m[35m    return path_obj.get("prefix") + path_obj.get("path")[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35mdef adjust_path(_path:str)->str:[0m

1269 matches found.
