[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/extractor/dashboard/mode_analytics/mode_dashboard_user_extractor.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m86 | [0m[35m        # https://mode.com/developer/api-reference/management/organization-memberships/#listMembersh[0m
[30;1m87 | [0m[35m        memberships_url_template = 'https://app.mode.com/api/{organization}/memberships'[0m
[30;1m88 | [0m[35m        params = {'auth': HTTPBasicAuth(self._conf.get_string(MODE_ACCESS_TOKEN),[0m
[30;1m89 | [0m[35m                                        self._conf.get_string(MODE_PASSWORD_TOKEN))}[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m        json_path = '(_embedded.memberships[*].member_username) | (_embedded.memberships[*]._links.u[0m
[30;1m92 | [0m[35m        field_names = ['mode_user_id', 'mode_user_resource_path'][0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/extractor/dashboard/mode_analytics/mode_dashboard_user_extractor.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m10 | [0m[35mfrom databuilder import Scoped[0m
[30;1m11 | [0m[35mfrom databuilder.extractor.base_extractor import Extractor[0m
[30;1m12 | [0m[35mfrom databuilder.extractor.dashboard.mode_analytics.mode_dashboard_constants import ([0m
[30;1m13 | [0m[35m    MODE_ACCESS_TOKEN, MODE_PASSWORD_TOKEN, ORGANIZATION,[0m
[30;1m14 | [0m[35m)[0m
[30;1m15 | [0m[35mfrom databuilder.extractor.dashboard.mode_analytics.mode_dashboard_utils import ModeDashboardUtils[0m
[30;1m16 | [0m[35mfrom databuilder.rest_api.base_rest_api_query import RestApiQuerySeed[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/extractor/dashboard/mode_analytics/mode_dashboard_constants.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mORGANIZATION = 'organization'[0m
[30;1m5 | [0m[35mMODE_ACCESS_TOKEN = 'mode_user_token'[0m
[30;1m6 | [0m[35mMODE_PASSWORD_TOKEN = 'mode_password_token'[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m# this token is needed to access batch discover endpoint[0m
[30;1m9 | [0m[35m# e.g https://mode.com/developer/discovery-api/introduction/[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/extractor/dashboard/mode_analytics/mode_dashboard_constants.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mORGANIZATION = 'organization'[0m
[30;1m5 | [0m[35mMODE_ACCESS_TOKEN = 'mode_user_token'[0m
[30;1m6 | [0m[35mMODE_PASSWORD_TOKEN = 'mode_password_token'[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m# this token is needed to access batch discover endpoint[0m
[30;1m9 | [0m[35m# e.g https://mode.com/developer/discovery-api/introduction/[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/extractor/presto_view_metadata_extractor.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m        # view_original_text is b64 encoded:[0m
[30;1m128 | [0m[35m        # https://github.com/prestodb/presto/blob/43bd519052ba4c56ff1f4fc807075637ab5f4f10/presto-hi[0m
[30;1m129 | [0m[35m        decoded_view_info = base64.b64decode(encoded_view_info)[0m
[30;1m130 | [0m[35m        columns = json.loads(decoded_view_info).get('columns')[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m        return [ColumnMetadata(name=column['name'],[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/extractor/presto_view_metadata_extractor.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35m# Copyright Contributors to the Amundsen project.[0m
[30;1m2 | [0m[35m# SPDX-License-Identifier: Apache-2.0[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mimport base64[0m
[30;1m5 | [0m[35mimport json[0m
[30;1m6 | [0m[35mimport logging[0m
[30;1m7 | [0m[35mfrom typing import ([0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/extractor/dashboard/mode_analytics/mode_dashboard_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m72 | [0m[35m        else:[0m
[30;1m73 | [0m[35m            params = {[0m
[30;1m74 | [0m[35m                'auth': HTTPBasicAuth(conf.get_string(MODE_ACCESS_TOKEN),[0m
[30;1m75 | [0m[35m                                      conf.get_string(MODE_PASSWORD_TOKEN)[0m
[30;1m76 | [0m[35m                                      )[0m
[30;1m77 | [0m[35m            }[0m
[30;1m78 | [0m[35m        return params[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/extractor/dashboard/mode_analytics/mode_dashboard_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mfrom databuilder import Scoped[0m
[30;1m10 | [0m[35mfrom databuilder.extractor.dashboard.mode_analytics.mode_dashboard_constants import ([0m
[30;1m11 | [0m[35m    MODE_ACCESS_TOKEN, MODE_BEARER_TOKEN, MODE_PASSWORD_TOKEN, ORGANIZATION,[0m
[30;1m12 | [0m[35m)[0m
[30;1m13 | [0m[35mfrom databuilder.extractor.restapi.rest_api_extractor import ([0m
[30;1m14 | [0m[35m    REST_API_QUERY, STATIC_RECORD_DICT, RestAPIExtractor,[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m291 | [0m[35m_URL_CONFIG_KEY),[0m
[30;1m292 | [0m[35m                     port=self.conf.get_string(AtlasSearchDataExtractor.ATLAS_PORT_CONFIG_KEY),[0m
[30;1m293 | [0m[35m                     username=self.conf.get_string(AtlasSearchDataExtractor.ATLAS_USERNAME_CONFIG_KE[0m
[30;1m294 | [0m[35m                     password=self.conf.get_string(AtlasSearchDataExtractor.ATLAS_PASSWORD_CONFIG_KE[0m
[30;1m295 | [0m[35m                     protocol=self.conf.get_string(AtlasSearchDataExtractor.ATLAS_PROTOCOL_CONFIG_KE[0m
[30;1m296 | [0m[35m                     validate_ssl=self.conf.get_bool(AtlasSearchDataExtractor.ATLAS_VALIDATE_SSL_CON[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m291 | [0m[35mtlas(host=self.conf.get_string(AtlasSearchDataExtractor.ATLAS_URL_CONFIG_KEY),[0m
[30;1m292 | [0m[35m                     port=self.conf.get_string(AtlasSearchDataExtractor.ATLAS_PORT_CONFIG_KEY),[0m
[30;1m293 | [0m[35m                     username=self.conf.get_string(AtlasSearchDataExtractor.ATLAS_USERNAME_CONFIG_KE[0m
[30;1m294 | [0m[35m                     password=self.conf.get_string(AtlasSearchDataExtractor.ATLAS_PASSWORD_CONFIG_KE[0m
[30;1m295 | [0m[35m                     protocol=self.conf.get_string(AtlasSearchDataExtractor.ATLAS_PROTOCOL_CONFIG_KE[0m
[30;1m296 | [0m[35m                     validate_ssl=self.conf.get_bool(AtlasSearchDataExtractor.ATLAS_VALIDATE_SSL_CON[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m127 | [0m[35m    ATLAS_PROTOCOL_CONFIG_KEY = 'atlas_protocol'[0m
[30;1m128 | [0m[35m    ATLAS_VALIDATE_SSL_CONFIG_KEY = 'atlas_validate_ssl'[0m
[30;1m129 | [0m[35m    ATLAS_USERNAME_CONFIG_KEY = 'atlas_auth_user'[0m
[30;1m130 | [0m[35m    ATLAS_PASSWORD_CONFIG_KEY = 'atlas_auth_pw'[0m
[30;1m131 | [0m[35m    ATLAS_SEARCH_CHUNK_SIZE_KEY = 'atlas_search_chunk_size'[0m
[30;1m132 | [0m[35m    ATLAS_DETAILS_CHUNK_SIZE_KEY = 'atlas_details_chunk_size'[0m
[30;1m133 | [0m[35m    ATLAS_TIMEOUT_SECONDS_KEY = 'atlas_timeout_seconds'[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/extractor/kafka_schema_registry_extractor.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m45 | [0m[35m                url=self._registry_base_url,[0m
[30;1m46 | [0m[35m                auth=Auth([0m
[30;1m47 | [0m[35m                    username=self._registry_username,[0m
[30;1m48 | [0m[35m                    password=self._registry_password[0m
[30;1m49 | [0m[35m                )[0m
[30;1m50 | [0m[35m            )[0m
[30;1m51 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/extractor/kafka_schema_registry_extractor.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m45 | [0m[35m                url=self._registry_base_url,[0m
[30;1m46 | [0m[35m                auth=Auth([0m
[30;1m47 | [0m[35m                    username=self._registry_username,[0m
[30;1m48 | [0m[35m                    password=self._registry_password[0m
[30;1m49 | [0m[35m                )[0m
[30;1m50 | [0m[35m            )[0m
[30;1m51 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/extractor/kafka_schema_registry_extractor.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m40 | [0m[35m        )[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m        # Add authentication if user and password are provided[0m
[30;1m43 | [0m[35m        if all((self._registry_username, self._registry_password)):[0m
[30;1m44 | [0m[35m            self._client = SchemaRegistryClient([0m
[30;1m45 | [0m[35m                url=self._registry_base_url,[0m
[30;1m46 | [0m[35m                auth=Auth([0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/extractor/kafka_schema_registry_extractor.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m39 | [0m[35m            KafkaSchemaRegistryExtractor.REGISTRY_PASSWORD_KEY, None[0m
[30;1m40 | [0m[35m        )[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m        # Add authentication if user and password are provided[0m
[30;1m43 | [0m[35m        if all((self._registry_username, self._registry_password)):[0m
[30;1m44 | [0m[35m            self._client = SchemaRegistryClient([0m
[30;1m45 | [0m[35m                url=self._registry_base_url,[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/extractor/kafka_schema_registry_extractor.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m36 | [0m[35m        )[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m        self._registry_password = conf.get([0m
[30;1m39 | [0m[35m            KafkaSchemaRegistryExtractor.REGISTRY_PASSWORD_KEY, None[0m
[30;1m40 | [0m[35m        )[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m        # Add authentication if user and password are provided[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/extractor/kafka_schema_registry_extractor.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m35 | [0m[35m            KafkaSchemaRegistryExtractor.REGISTRY_USERNAME_KEY, None[0m
[30;1m36 | [0m[35m        )[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m        self._registry_password = conf.get([0m
[30;1m39 | [0m[35m            KafkaSchemaRegistryExtractor.REGISTRY_PASSWORD_KEY, None[0m
[30;1m40 | [0m[35m        )[0m
[30;1m41 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/extractor/kafka_schema_registry_extractor.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m    REGISTRY_URL_KEY = "registry_url"[0m
[30;1m26 | [0m[35m    REGISTRY_USERNAME_KEY = "registry_username"[0m
[30;1m27 | [0m[35m    REGISTRY_PASSWORD_KEY = "registry_password"[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    def init(self, conf: ConfigTree) -> None:[0m
[30;1m30 | [0m[35m        self._registry_base_url = conf.get([0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/extractor/kafka_schema_registry_extractor.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m    REGISTRY_URL_KEY = "registry_url"[0m
[30;1m26 | [0m[35m    REGISTRY_USERNAME_KEY = "registry_username"[0m
[30;1m27 | [0m[35m    REGISTRY_PASSWORD_KEY = "registry_password"[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    def init(self, conf: ConfigTree) -> None:[0m
[30;1m30 | [0m[35m        self._registry_base_url = conf.get([0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/publisher/publisher_config_constants.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m55 | [0m[35m    NEO4J_CREATE_ONLY_NODES = 'neo4j_create_only_nodes'[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    NEO4J_USER = 'neo4j_user'[0m
[30;1m58 | [0m[35m    NEO4J_PASSWORD = 'neo4j_password'[0m
[30;1m59 | [0m[35m    # in Neo4j (v4.0+), we can create and use more than one active database at the same time[0m
[30;1m60 | [0m[35m    NEO4J_DATABASE_NAME = 'neo4j_database'[0m
[30;1m61 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/publisher/publisher_config_constants.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m55 | [0m[35m    NEO4J_CREATE_ONLY_NODES = 'neo4j_create_only_nodes'[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    NEO4J_USER = 'neo4j_user'[0m
[30;1m58 | [0m[35m    NEO4J_PASSWORD = 'neo4j_password'[0m
[30;1m59 | [0m[35m    # in Neo4j (v4.0+), we can create and use more than one active database at the same time[0m
[30;1m60 | [0m[35m    NEO4J_DATABASE_NAME = 'neo4j_database'[0m
[30;1m61 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_unwind_publisher.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m106 | [0m[35m            'uri': uri,[0m
[30;1m107 | [0m[35m            'max_connection_lifetime': conf.get_int(Neo4jCsvPublisherConfigs.NEO4J_MAX_CONN_LIFE_TIM[0m
[30;1m108 | [0m[35m            'auth': (conf.get_string(Neo4jCsvPublisherConfigs.NEO4J_USER),[0m
[30;1m109 | [0m[35m                     conf.get_string(Neo4jCsvPublisherConfigs.NEO4J_PASSWORD)),[0m
[30;1m110 | [0m[35m        }[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m        # if URI scheme not secure set `trust`` and `encrypted` to default values[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/extractor/dremio_metadata_extractor.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m114 | [0m[35m        self._pyodbc_cursor = connect([0m
[30;1m115 | [0m[35m            conf.get_string(DremioMetadataExtractor.DREMIO_DRIVER_KEY),[0m
[30;1m116 | [0m[35m            uid=conf.get_string(DremioMetadataExtractor.DREMIO_USER_KEY),[0m
[30;1m117 | [0m[35m            pwd=conf.get_string(DremioMetadataExtractor.DREMIO_PASSWORD_KEY),[0m
[30;1m118 | [0m[35m            host=conf.get_string(DremioMetadataExtractor.DREMIO_HOST_KEY),[0m
[30;1m119 | [0m[35m            port=conf.get_string(DremioMetadataExtractor.DREMIO_PORT_KEY),[0m
[30;1m120 | [0m[35m            autocommit=True).cursor()[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/extractor/dremio_metadata_extractor.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m76 | [0m[35m    # Default config[0m
[30;1m77 | [0m[35m    DEFAULT_CONFIG = ConfigFactory.from_dict({[0m
[30;1m78 | [0m[35m        DREMIO_USER_KEY: DEFAULT_AUTH_USER,[0m
[30;1m79 | [0m[35m        DREMIO_PASSWORD_KEY: DEFAULT_AUTH_PW,[0m
[30;1m80 | [0m[35m        DREMIO_HOST_KEY: DEFAULT_HOST,[0m
[30;1m81 | [0m[35m        DREMIO_PORT_KEY: DEFAULT_PORT,[0m
[30;1m82 | [0m[35m        DREMIO_DRIVER_KEY: DEFAULT_DRIVER,[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/extractor/dremio_metadata_extractor.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m    # Config keys[0m
[30;1m57 | [0m[35m    DREMIO_USER_KEY = 'user_key'[0m
[30;1m58 | [0m[35m    DREMIO_PASSWORD_KEY = 'password_key'[0m
[30;1m59 | [0m[35m    DREMIO_HOST_KEY = 'host_key'[0m
[30;1m60 | [0m[35m    DREMIO_PORT_KEY = 'port_key'[0m
[30;1m61 | [0m[35m    DREMIO_DRIVER_KEY = 'driver_key'[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/extractor/dremio_metadata_extractor.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m    # Config keys[0m
[30;1m57 | [0m[35m    DREMIO_USER_KEY = 'user_key'[0m
[30;1m58 | [0m[35m    DREMIO_PASSWORD_KEY = 'password_key'[0m
[30;1m59 | [0m[35m    DREMIO_HOST_KEY = 'host_key'[0m
[30;1m60 | [0m[35m    DREMIO_PORT_KEY = 'port_key'[0m
[30;1m61 | [0m[35m    DREMIO_DRIVER_KEY = 'driver_key'[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/task/neo4j_staleness_removal_task.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m134 | [0m[35m        driver_args = {[0m
[30;1m135 | [0m[35m            'uri': uri,[0m
[30;1m136 | [0m[35m            'max_connection_lifetime': conf.get_int(NEO4J_MAX_CONN_LIFE_TIME_SEC),[0m
[30;1m137 | [0m[35m            'auth': (conf.get_string(NEO4J_USER), conf.get_string(NEO4J_PASSWORD)),[0m
[30;1m138 | [0m[35m        }[0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35m        # if URI scheme not secure set `trust`` and `encrypted` to default values[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/task/neo4j_staleness_removal_task.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m23 | [0m[35mNEO4J_END_POINT_KEY = 'neo4j_endpoint'[0m
[30;1m24 | [0m[35mNEO4J_MAX_CONN_LIFE_TIME_SEC = 'neo4j_max_conn_life_time_sec'[0m
[30;1m25 | [0m[35mNEO4J_USER = 'neo4j_user'[0m
[30;1m26 | [0m[35mNEO4J_PASSWORD = 'neo4j_password'[0m
[30;1m27 | [0m[35m# in Neo4j (v4.0+), we can create and use more than one active database at the same time[0m
[30;1m28 | [0m[35mNEO4J_DATABASE_NAME = 'neo4j_database'[0m
[30;1m29 | [0m[35mNEO4J_ENCRYPTED = 'neo4j_encrypted'[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/task/neo4j_staleness_removal_task.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m23 | [0m[35mNEO4J_END_POINT_KEY = 'neo4j_endpoint'[0m
[30;1m24 | [0m[35mNEO4J_MAX_CONN_LIFE_TIME_SEC = 'neo4j_max_conn_life_time_sec'[0m
[30;1m25 | [0m[35mNEO4J_USER = 'neo4j_user'[0m
[30;1m26 | [0m[35mNEO4J_PASSWORD = 'neo4j_password'[0m
[30;1m27 | [0m[35m# in Neo4j (v4.0+), we can create and use more than one active database at the same time[0m
[30;1m28 | [0m[35mNEO4J_DATABASE_NAME = 'neo4j_database'[0m
[30;1m29 | [0m[35mNEO4J_ENCRYPTED = 'neo4j_encrypted'[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m159 | [0m[35m        driver_args = {[0m
[30;1m160 | [0m[35m            'uri': uri,[0m
[30;1m161 | [0m[35m            'max_connection_lifetime': conf.get_int(NEO4J_MAX_CONN_LIFE_TIME_SEC),[0m
[30;1m162 | [0m[35m            'auth': (conf.get_string(NEO4J_USER), conf.get_string(NEO4J_PASSWORD)),[0m
[30;1m163 | [0m[35m        }[0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35m        # if URI scheme not secure set `trust`` and `encrypted` to default values[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m56 | [0m[35mNEO4J_DEADLOCK_NODE_LABELS = 'neo4j_deadlock_node_labels'[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35mNEO4J_USER = Neo4jCsvPublisherConfigs.NEO4J_USER[0m
[30;1m59 | [0m[35mNEO4J_PASSWORD = Neo4jCsvPublisherConfigs.NEO4J_PASSWORD[0m
[30;1m60 | [0m[35m# in Neo4j (v4.0+), we can create and use more than one active database at the same time[0m
[30;1m61 | [0m[35mNEO4J_DATABASE_NAME = Neo4jCsvPublisherConfigs.NEO4J_DATABASE_NAME[0m
[30;1m62 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m56 | [0m[35mNEO4J_DEADLOCK_NODE_LABELS = 'neo4j_deadlock_node_labels'[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35mNEO4J_USER = Neo4jCsvPublisherConfigs.NEO4J_USER[0m
[30;1m59 | [0m[35mNEO4J_PASSWORD = Neo4jCsvPublisherConfigs.NEO4J_PASSWORD[0m
[30;1m60 | [0m[35m# in Neo4j (v4.0+), we can create and use more than one active database at the same time[0m
[30;1m61 | [0m[35mNEO4J_DATABASE_NAME = Neo4jCsvPublisherConfigs.NEO4J_DATABASE_NAME[0m
[30;1m62 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/extractor/salesforce_extractor.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m        self._client: Salesforce = Salesforce([0m
[30;1m40 | [0m[35m            username=conf.get_string(SalesForceExtractor.USERNAME_KEY),[0m
[30;1m41 | [0m[35m            password=conf.get_string(SalesForceExtractor.PASSWORD_KEY),[0m
[30;1m42 | [0m[35m            security_token=conf.get_string(SalesForceExtractor.SECURITY_TOKEN_KEY),[0m
[30;1m43 | [0m[35m        )[0m
[30;1m44 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/extractor/salesforce_extractor.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m        self._client: Salesforce = Salesforce([0m
[30;1m40 | [0m[35m            username=conf.get_string(SalesForceExtractor.USERNAME_KEY),[0m
[30;1m41 | [0m[35m            password=conf.get_string(SalesForceExtractor.PASSWORD_KEY),[0m
[30;1m42 | [0m[35m            security_token=conf.get_string(SalesForceExtractor.SECURITY_TOKEN_KEY),[0m
[30;1m43 | [0m[35m        )[0m
[30;1m44 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/extractor/salesforce_extractor.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m26 | [0m[35m    DATABASE_KEY = 'database_key'[0m
[30;1m27 | [0m[35m    OBJECT_NAMES_KEY = "object_names"[0m
[30;1m28 | [0m[35m    USERNAME_KEY = "username"[0m
[30;1m29 | [0m[35m    PASSWORD_KEY = "password"[0m
[30;1m30 | [0m[35m    SECURITY_TOKEN_KEY = "security_token"[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    def init(self, conf: ConfigTree) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/extractor/salesforce_extractor.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m26 | [0m[35m    DATABASE_KEY = 'database_key'[0m
[30;1m27 | [0m[35m    OBJECT_NAMES_KEY = "object_names"[0m
[30;1m28 | [0m[35m    USERNAME_KEY = "username"[0m
[30;1m29 | [0m[35m    PASSWORD_KEY = "password"[0m
[30;1m30 | [0m[35m    SECURITY_TOKEN_KEY = "security_token"[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    def init(self, conf: ConfigTree) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/extractor/dashboard/tableau/tableau_dashboard_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m98 | [0m[35m        })[0m
[30;1m99 | [0m[35m        headers = {[0m
[30;1m100 | [0m[35m            'Content-Type': 'application/json',[0m
[30;1m101 | [0m[35m            'X-Tableau-Auth': self._auth_token[0m
[30;1m102 | [0m[35m        }[0m
[30;1m103 | [0m[35m        params: Dict[str, Any] = {[0m
[30;1m104 | [0m[35m            'headers': headers[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databuilder/extractor/dashboard/tableau/tableau_dashboard_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m    def init(self, conf: ConfigTree) -> None:[0m
[30;1m80 | [0m[35m        self._conf = conf[0m
[30;1m81 | [0m[35m        self._auth_token = TableauDashboardAuth(self._conf).token[0m
[30;1m82 | [0m[35m        self._query = self._conf.get(TableauGraphQLApiExtractor.QUERY)[0m
[30;1m83 | [0m[35m        self._iterator: Optional[Iterator[Dict[str, Any]]] = None[0m
[30;1m84 | [0m[35m        self._static_dict = conf.get(STATIC_RECORD_DICT, dict())[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/redash/redash_dashboard_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m107 | [0m[35m    def row_and_col(widget: Dict[str, Any]) -> Tuple[Any, Any]:[0m
[30;1m108 | [0m[35m        # these entities usually but not always have explicit rows and cols[0m
[30;1m109 | [0m[35m        pos = widget['options'].get('position', {})[0m
[30;1m110 | [0m[35m        return (pos.get('row', 0), pos.get('col', 0))[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m    return sorted(widgets, key=row_and_col)[0m
[30;1m113 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/redash/redash_dashboard_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m107 | [0m[35m    def row_and_col(widget: Dict[str, Any]) -> Tuple[Any, Any]:[0m
[30;1m108 | [0m[35m        # these entities usually but not always have explicit rows and cols[0m
[30;1m109 | [0m[35m        pos = widget['options'].get('position', {})[0m
[30;1m110 | [0m[35m        return (pos.get('row', 0), pos.get('col', 0))[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m    return sorted(widgets, key=row_and_col)[0m
[30;1m113 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/redash/redash_dashboard_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m    def row_and_col(widget: Dict[str, Any]) -> Tuple[Any, Any]:[0m
[30;1m108 | [0m[35m        # these entities usually but not always have explicit rows and cols[0m
[30;1m109 | [0m[35m        pos = widget['options'].get('position', {})[0m
[30;1m110 | [0m[35m        return (pos.get('row', 0), pos.get('col', 0))[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m    return sorted(widgets, key=row_and_col)[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/redash/redash_dashboard_utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m101 | [0m[35m    Sort raw widget data (as returned from the API) according to the position[0m
[30;1m102 | [0m[35m    of the widgets in the dashboard (top to bottom, left to right)[0m
[30;1m103 | [0m[35m    Redash does not return widgets in order of their position,[0m
[30;1m104 | [0m[35m    so we do this to ensure that we look at widgets in a sensible order.[0m
[30;1m105 | [0m[35m    """[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m    def row_and_col(widget: Dict[str, Any]) -> Tuple[Any, Any]:[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/redash/redash_dashboard_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35mdef sort_widgets(widgets: Iterable[Dict[str, Any]]) -> List[Dict[str, Any]]:[0m
[30;1m100 | [0m[35m    """[0m
[30;1m101 | [0m[35m    Sort raw widget data (as returned from the API) according to the position[0m
[30;1m102 | [0m[35m    of the widgets in the dashboard (top to bottom, left to right)[0m
[30;1m103 | [0m[35m    Redash does not return widgets in order of their position,[0m
[30;1m104 | [0m[35m    so we do this to ensure that we look at widgets in a sensible order.[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/apache_superset/apache_superset_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m            data = self.execute_query(url)[0m
[30;1m178 | [0m[35m[0m
[30;1m179 | [0m[35m            ids = data.get('ids', [])[0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35m            if ids:[0m
[30;1m182 | [0m[35m                result += ids[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/apache_superset/apache_superset_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m146 | [0m[35m[0m
[30;1m147 | [0m[35m    @staticmethod[0m
[30;1m148 | [0m[35m    def get_nested_field(input_dict: Dict, field: str) -> Any:[0m
[30;1m149 | [0m[35m        return reduce(lambda x, y: x.get(y, dict()), field.split('.'), input_dict)[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35m    @staticmethod[0m
[30;1m152 | [0m[35m    def map_fields(data: Dict, mappings: type_fields_mapping) -> Dict:[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/apache_superset/apache_superset_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m127 | [0m[35m        return dict(dashboard_group=self.conf.get(ApacheSupersetBaseExtractor.DASHBOARD_GROUP_NAME),[0m
[30;1m128 | [0m[35m                    dashboard_group_id=self.conf.get(ApacheSupersetBaseExtractor.DASHBOARD_GROUP_ID)[0m
[30;1m129 | [0m[35m                    dashboard_group_url=self.base_url,[0m
[30;1m130 | [0m[35m                    dashboard_group_description=self.conf.get(ApacheSupersetBaseExtractor.DASHBOARD_[0m
[30;1m131 | [0m[35m                    product=self.product,[0m
[30;1m132 | [0m[35m                    cluster=self.cluster)[0m
[30;1m133 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/apache_superset/apache_superset_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m125 | [0m[35m    @property[0m
[30;1m126 | [0m[35m    def common_params(self) -> Dict[str, str]:[0m
[30;1m127 | [0m[35m        return dict(dashboard_group=self.conf.get(ApacheSupersetBaseExtractor.DASHBOARD_GROUP_NAME),[0m
[30;1m128 | [0m[35m                    dashboard_group_id=self.conf.get(ApacheSupersetBaseExtractor.DASHBOARD_GROUP_ID)[0m
[30;1m129 | [0m[35m                    dashboard_group_url=self.base_url,[0m
[30;1m130 | [0m[35m                    dashboard_group_description=self.conf.get(ApacheSupersetBaseExtractor.DASHBOARD_[0m
[30;1m131 | [0m[35m                    product=self.product,[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/apache_superset/apache_superset_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m    @property[0m
[30;1m126 | [0m[35m    def common_params(self) -> Dict[str, str]:[0m
[30;1m127 | [0m[35m        return dict(dashboard_group=self.conf.get(ApacheSupersetBaseExtractor.DASHBOARD_GROUP_NAME),[0m
[30;1m128 | [0m[35m                    dashboard_group_id=self.conf.get(ApacheSupersetBaseExtractor.DASHBOARD_GROUP_ID)[0m
[30;1m129 | [0m[35m                    dashboard_group_url=self.base_url,[0m
[30;1m130 | [0m[35m                    dashboard_group_description=self.conf.get(ApacheSupersetBaseExtractor.DASHBOARD_[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/apache_superset/apache_superset_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m    @property[0m
[30;1m122 | [0m[35m    def extract_published_only(self) -> bool:[0m
[30;1m123 | [0m[35m        return self.conf.get(ApacheSupersetBaseExtractor.APACHE_SUPERSET_EXTRACT_PUBLISHED_ONLY)[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m    @property[0m
[30;1m126 | [0m[35m    def common_params(self) -> Dict[str, str]:[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/apache_superset/apache_superset_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m    @property[0m
[30;1m118 | [0m[35m    def cluster(self) -> str:[0m
[30;1m119 | [0m[35m        return self.conf.get(ApacheSupersetBaseExtractor.CLUSTER)[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m    @property[0m
[30;1m122 | [0m[35m    def extract_published_only(self) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/apache_superset/apache_superset_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m    @property[0m
[30;1m114 | [0m[35m    def product(self) -> str:[0m
[30;1m115 | [0m[35m        return self.conf.get(ApacheSupersetBaseExtractor.PRODUCT)[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m    @property[0m
[30;1m118 | [0m[35m    def cluster(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/apache_superset/apache_superset_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m102 | [0m[35m    def base_url(self) -> str:[0m
[30;1m103 | [0m[35m        _protocol = self.conf.get(ApacheSupersetBaseExtractor.APACHE_SUPERSET_PROTOCOL)[0m
[30;1m104 | [0m[35m        _host = self.conf.get(ApacheSupersetBaseExtractor.APACHE_SUPERSET_HOST)[0m
[30;1m105 | [0m[35m        _port = self.conf.get(ApacheSupersetBaseExtractor.APACHE_SUPERSET_PORT)[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m        return f'{_protocol}://{_host}:{_port}'[0m
[30;1m108 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/apache_superset/apache_superset_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m101 | [0m[35m    @property[0m
[30;1m102 | [0m[35m    def base_url(self) -> str:[0m
[30;1m103 | [0m[35m        _protocol = self.conf.get(ApacheSupersetBaseExtractor.APACHE_SUPERSET_PROTOCOL)[0m
[30;1m104 | [0m[35m        _host = self.conf.get(ApacheSupersetBaseExtractor.APACHE_SUPERSET_HOST)[0m
[30;1m105 | [0m[35m        _port = self.conf.get(ApacheSupersetBaseExtractor.APACHE_SUPERSET_PORT)[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m        return f'{_protocol}://{_host}:{_port}'[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/apache_superset/apache_superset_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m    @property[0m
[30;1m102 | [0m[35m    def base_url(self) -> str:[0m
[30;1m103 | [0m[35m        _protocol = self.conf.get(ApacheSupersetBaseExtractor.APACHE_SUPERSET_PROTOCOL)[0m
[30;1m104 | [0m[35m        _host = self.conf.get(ApacheSupersetBaseExtractor.APACHE_SUPERSET_HOST)[0m
[30;1m105 | [0m[35m        _port = self.conf.get(ApacheSupersetBaseExtractor.APACHE_SUPERSET_PORT)[0m
[30;1m106 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/apache_superset/apache_superset_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m    def execute_query(self, url: str, params: dict = {}) -> Dict:[0m
[30;1m89 | [0m[35m        try:[0m
[30;1m90 | [0m[35m            data = requests.get(url, params=params, headers={'Authorization': f'Bearer {self.token}'[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m            if data.status_code == 401:[0m
[30;1m93 | [0m[35m                self.authenticate()[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/apache_superset/apache_superset_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m    def authenticate(self) -> None:[0m
[30;1m78 | [0m[35m        security_settings = dict(self.conf.get(ApacheSupersetBaseExtractor.APACHE_SUPERSET_SECURITY_[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m        token = requests.post(self.build_full_url('api/v1/security/login'),[0m
[30;1m81 | [0m[35m                              json=security_settings)[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m        self.token = token.json()['access_token'][0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/apache_superset/apache_superset_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m75 | [0m[35m            return None[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m    def authenticate(self) -> None:[0m
[30;1m78 | [0m[35m        security_settings = dict(self.conf.get(ApacheSupersetBaseExtractor.APACHE_SUPERSET_SECURITY_[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m        token = requests.post(self.build_full_url('api/v1/security/login'),[0m
[30;1m81 | [0m[35m                              json=security_settings)[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/apache_superset/apache_superset_table_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m    @property[0m
[30;1m99 | [0m[35m    def cluster_mapping(self) -> Dict[str, str]:[0m
[30;1m100 | [0m[35m        return self.conf.get(self.DATABASE_TO_CLUSTER_MAPPING)[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/apache_superset/apache_superset_table_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m    @property[0m
[30;1m95 | [0m[35m    def driver_mapping(self) -> Dict[str, str]:[0m
[30;1m96 | [0m[35m        return self.conf.get(self.DRIVER_TO_DATABASE_MAPPING)[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m    @property[0m
[30;1m99 | [0m[35m    def cluster_mapping(self) -> Dict[str, str]:[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/apache_superset/apache_superset_table_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m51 | [0m[35m                    for dashboard in dataset_objects.get('dashboards', dict()).get('result', []):[0m
[30;1m52 | [0m[35m                        dashboard_id = str(dashboard.get('id'))[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m                        if not dashboards.get(dashboard_id):[0m
[30;1m55 | [0m[35m                            dashboards[dashboard_id] = set()[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m                        dashboards[dashboard_id].add(table_key)[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/apache_superset/apache_superset_table_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m                                                                      tbl=tbl)[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m                    for dashboard in dataset_objects.get('dashboards', dict()).get('result', []):[0m
[30;1m52 | [0m[35m                        dashboard_id = str(dashboard.get('id'))[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m                        if not dashboards.get(dashboard_id):[0m
[30;1m55 | [0m[35m                            dashboards[dashboard_id] = set()[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/apache_superset/apache_superset_table_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m48 | [0m[35m                                                                      schema=schema,[0m
[30;1m49 | [0m[35m                                                                      tbl=tbl)[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m                    for dashboard in dataset_objects.get('dashboards', dict()).get('result', []):[0m
[30;1m52 | [0m[35m                        dashboard_id = str(dashboard.get('id'))[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m                        if not dashboards.get(dashboard_id):[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/apache_superset/apache_superset_table_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m48 | [0m[35m                                                                      schema=schema,[0m
[30;1m49 | [0m[35m                                                                      tbl=tbl)[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m                    for dashboard in dataset_objects.get('dashboards', dict()).get('result', []):[0m
[30;1m52 | [0m[35m                        dashboard_id = str(dashboard.get('id'))[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m                        if not dashboards.get(dashboard_id):[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/apache_superset/apache_superset_table_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m40 | [0m[35m                    db = self.driver_mapping.get(database_spec.drivername, database_spec.drivername)[0m
[30;1m41 | [0m[35m                    schema = database_spec.database[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m                    cluster = self.cluster_mapping.get(str(database_id), self.cluster)[0m
[30;1m44 | [0m[35m                    tbl = self.get_nested_field(dataset_details, 'result.table_name')[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m                    table_key = TableMetadata.TABLE_KEY_FORMAT.format(db=db,[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/apache_superset/apache_superset_table_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m37 | [0m[35m                    uri = self.get_nested_field(database_details, 'result.sqlalchemy_uri')[0m
[30;1m38 | [0m[35m                    database_spec = make_url(uri)[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m                    db = self.driver_mapping.get(database_spec.drivername, database_spec.drivername)[0m
[30;1m41 | [0m[35m                    schema = database_spec.database[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m                    cluster = self.cluster_mapping.get(str(database_id), self.cluster)[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/tableau/tableau_dashboard_query_extractor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m54 | [0m[35m    In terms of Tableau's Metadata API, these queries are called "custom SQL tables".[0m
[30;1m55 | [0m[35m    However, not every workbook uses custom SQL queries, and most are built with a mixture of using [0m
[30;1m56 | [0m[35m    datasource fields directly and various "calculated" columns.[0m
[30;1m57 | [0m[35m    This extractor iterates through one query at a time, yielding a new relationship for every downs[0m
[30;1m58 | [0m[35m    workbook that uses the query.[0m
[30;1m59 | [0m[35m    """[0m
[30;1m60 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/user/bamboohr/bamboohr_user_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m36 | [0m[35m        return f'https://api.bamboohr.com/api/gateway.php/{self._subdomain}/v1/employees/directory'[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m    def _get_extract_iter(self) -> Iterator[User]:[0m
[30;1m39 | [0m[35m        response = requests.get([0m
[30;1m40 | [0m[35m            self._employee_directory_uri(), auth=HTTPBasicAuth(self._api_key, 'x')[0m
[30;1m41 | [0m[35m        )[0m
[30;1m42 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/dashboard/dashboard_execution.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m76 | [0m[35m                'state': self._execution_state[0m
[30;1m77 | [0m[35m            }[0m
[30;1m78 | [0m[35m        )[0m
[30;1m79 | [0m[35m        yield node[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m    def create_next_relation(self) -> Union[GraphRelationship, None]:[0m
[30;1m82 | [0m[35m        try:[0m
[30;1m83 | [0m[35m            return next(self._relation_iterator)[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/dashboard/dashboard_execution.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m68 | [0m[35m            return None[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    def _create_node_iterator(self) -> Iterator[GraphNode]:[0m
[30;1m71 | [0m[35m        node = GraphNode([0m
[30;1m72 | [0m[35m            key=self._get_last_execution_node_key(),[0m
[30;1m73 | [0m[35m            label=DashboardExecution.DASHBOARD_EXECUTION_LABEL,[0m
[30;1m74 | [0m[35m            attributes={[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/dashboard/dashboard_chart.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m87 | [0m[35m            label=DashboardChart.DASHBOARD_CHART_LABEL,[0m
[30;1m88 | [0m[35m            attributes=node_attributes[0m
[30;1m89 | [0m[35m        )[0m
[30;1m90 | [0m[35m        yield node[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m    def create_next_relation(self) -> Union[GraphRelationship, None]:[0m
[30;1m93 | [0m[35m        try:[0m
[30;1m94 | [0m[35m            return next(self._relation_iterator)[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/dashboard/dashboard_chart.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m82 | [0m[35m        if self._chart_url:[0m
[30;1m83 | [0m[35m            node_attributes['url'] = self._chart_url[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m        node = GraphNode([0m
[30;1m86 | [0m[35m            key=self._get_chart_node_key(),[0m
[30;1m87 | [0m[35m            label=DashboardChart.DASHBOARD_CHART_LABEL,[0m
[30;1m88 | [0m[35m            attributes=node_attributes[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/dashboard/dashboard_metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m280 | [0m[35m            )[0m
[30;1m281 | [0m[35m            yield dashboard_description_node[0m
[30;1m282 | [0m[35m[0m
[30;1m283 | [0m[35m        # Dashboard tag node[0m
[30;1m284 | [0m[35m        if self.tags:[0m
[30;1m285 | [0m[35m            for tag in self.tags:[0m
[30;1m286 | [0m[35m                dashboard_tag_node = GraphNode([0m
[30;1m287 | [0m[35m                    key=TagMetadata.get_tag_key(tag),[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/dashboard/dashboard_metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m269 | [0m[35m            )[0m
[30;1m270 | [0m[35m            yield dashboard_group_description_node[0m
[30;1m271 | [0m[35m[0m
[30;1m272 | [0m[35m        # Dashboard description node[0m
[30;1m273 | [0m[35m        if self.description:[0m
[30;1m274 | [0m[35m            dashboard_description_node = GraphNode([0m
[30;1m275 | [0m[35m                key=self._get_dashboard_description_key(),[0m
[30;1m276 | [0m[35m                label=DashboardMetadata.DASHBOARD_DESCRIPTION_NODE_LABEL,[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/dashboard/dashboard_metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m222 | [0m[35m            )[0m
[30;1m223 | [0m[35m            yield cluster_node[0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35m        # Dashboard node attributes[0m
[30;1m226 | [0m[35m        dashboard_node_attributes: Dict[str, Any] = {[0m
[30;1m227 | [0m[35m            DashboardMetadata.DASHBOARD_NAME: self.dashboard_name,[0m
[30;1m228 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/dashboard/dashboard_metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m210 | [0m[35m            return None[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m    def _create_next_node(self) -> Iterator[GraphNode]:[0m
[30;1m213 | [0m[35m        # Cluster node[0m
[30;1m214 | [0m[35m        if not self._get_cluster_key() in self._processed_cluster:[0m
[30;1m215 | [0m[35m            self._processed_cluster.add(self._get_cluster_key())[0m
[30;1m216 | [0m[35m            cluster_node = GraphNode([0m
[30;1m217 | [0m[35m                key=self._get_cluster_key(),[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/dashboard/dashboard_usage.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m33 | [0m[35m        :param dashboard_id:[0m
[30;1m34 | [0m[35m        :param email:[0m
[30;1m35 | [0m[35m        :param view_count:[0m
[30;1m36 | [0m[35m        :param should_create_user_node: Enable this if it is fine to create/update User node with on[0m
[30;1m37 | [0m[35m        address. Please be advised that other fields will be emptied. Current use case is to create [0m
[30;1m38 | [0m[35m        For example, Mode dashboard does not provide which user viewed the dashboard and anonymous u[0m
[30;1m39 | [0m[35m        to show the usage.[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/dashboard/dashboard_last_modified.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m67 | [0m[35m            label=timestamp_constants.NODE_LABEL,[0m
[30;1m68 | [0m[35m            attributes=node_attributes[0m
[30;1m69 | [0m[35m        )[0m
[30;1m70 | [0m[35m        yield node[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m    def create_next_relation(self) -> Union[GraphRelationship, None]:[0m
[30;1m73 | [0m[35m        try:[0m
[30;1m74 | [0m[35m            return next(self._relation_iterator)[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/dashboard/dashboard_last_modified.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m62 | [0m[35m            timestamp_constants.TIMESTAMP_PROPERTY: self._last_modified_timestamp,[0m
[30;1m63 | [0m[35m            timestamp_constants.TIMESTAMP_NAME_PROPERTY: timestamp_constants.TimestampName.last_upda[0m
[30;1m64 | [0m[35m        }[0m
[30;1m65 | [0m[35m        node = GraphNode([0m
[30;1m66 | [0m[35m            key=self._get_last_modified_node_key(),[0m
[30;1m67 | [0m[35m            label=timestamp_constants.NODE_LABEL,[0m
[30;1m68 | [0m[35m            attributes=node_attributes[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/dashboard/dashboard_query.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m84 | [0m[35m            attributes=node_attributes[0m
[30;1m85 | [0m[35m        )[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m        yield node[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m    def create_next_relation(self) -> Union[GraphRelationship, None]:[0m
[30;1m90 | [0m[35m        try:[0m
[30;1m91 | [0m[35m            return next(self._relation_iterator)[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/dashboard/dashboard_query.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m78 | [0m[35m        if self._query_text:[0m
[30;1m79 | [0m[35m            node_attributes['query_text'] = self._query_text[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m        node = GraphNode([0m
[30;1m82 | [0m[35m            key=self._get_query_node_key(),[0m
[30;1m83 | [0m[35m            label=DashboardQuery.DASHBOARD_QUERY_LABEL,[0m
[30;1m84 | [0m[35m            attributes=node_attributes[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/query/query_join.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m24 | [0m[35m    QUERY_JOIN_RELATION_TYPE = 'QUERY_JOINS_WITH'[0m
[30;1m25 | [0m[35m    INVERSE_QUERY_JOIN_RELATION_TYPE = 'JOIN_OF_QUERY'[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    # Node attributes[0m
[30;1m28 | [0m[35m    JOIN_TYPE = 'join_type'[0m
[30;1m29 | [0m[35m    JOIN_OPERATOR = 'operator'[0m
[30;1m30 | [0m[35m    JOIN_SQL = 'join_sql'[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/query/query.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m24 | [0m[35m    By default, all tables and users must already exist in the database[0m
[30;1m25 | [0m[35m    before this QueryMetadata object in order to create the relationships.[0m
[30;1m26 | [0m[35m    Implementers have the option to set `yield_relation_nodes` = True[0m
[30;1m27 | [0m[35m    in order to create all user and table nodes on the fly at the time[0m
[30;1m28 | [0m[35m    that this QueryMetadata is created.[0m
[30;1m29 | [0m[35m    """[0m
[30;1m30 | [0m[35m    NODE_LABEL = 'Query'[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/query/query.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m24 | [0m[35m    By default, all tables and users must already exist in the database[0m
[30;1m25 | [0m[35m    before this QueryMetadata object in order to create the relationships.[0m
[30;1m26 | [0m[35m    Implementers have the option to set `yield_relation_nodes` = True[0m
[30;1m27 | [0m[35m    in order to create all user and table nodes on the fly at the time[0m
[30;1m28 | [0m[35m    that this QueryMetadata is created.[0m
[30;1m29 | [0m[35m    """[0m
[30;1m30 | [0m[35m    NODE_LABEL = 'Query'[0m
[30;1m31 | [0m[35m    KEY_FORMAT = '{sql_hash}'[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/query/query_where.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m27 | [0m[35m    QUERY_WHERE_RELATION_TYPE = 'HAS_WHERE_CLAUSE'[0m
[30;1m28 | [0m[35m    INVERSE_QUERY_WHERE_RELATION_TYPE = 'WHERE_CLAUSE_OF'[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m    # Node attributes[0m
[30;1m31 | [0m[35m    WHERE_CLAUSE = 'where_clause'[0m
[30;1m32 | [0m[35m    LEFT_ARG = 'left_arg'[0m
[30;1m33 | [0m[35m    RIGHT_ARG = 'right_arg'[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/query/query_execution.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m111 | [0m[35m        :return:[0m
[30;1m112 | [0m[35m        """[0m
[30;1m113 | [0m[35m        # TODO: Should query metadata yiled tables as well? Otherwise if a table does not exist[0m
[30;1m114 | [0m[35m        # before this script is ran then the query relatoinship will not get created.[0m
[30;1m115 | [0m[35m        # Ideally this relationship wouldn't be "lost" but created once the table is created as well[0m
[30;1m116 | [0m[35m        yield GraphNode([0m
[30;1m117 | [0m[35m            key=self.get_key_self(),[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/query/query_execution.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35m            within the window[0m
[30;1m58 | [0m[35m        :param window_duration: A description of the window duration, e.g. daily, hourly[0m
[30;1m59 | [0m[35m        :param yield_relation_nodes: A boolean, indicating whether or not the query[0m
[30;1m60 | [0m[35m            associated to this execution should have it's node created if it does not[0m
[30;1m61 | [0m[35m            already exist.[0m
[30;1m62 | [0m[35m        """[0m
[30;1m63 | [0m[35m        self.query_metadata = query_metadata[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/query/query_execution.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m51 | [0m[35m                 ):[0m
[30;1m52 | [0m[35m        """[0m
[30;1m53 | [0m[35m        :param query_metadata: The Query metadata object that this execution belongs to[0m
[30;1m54 | [0m[35m        :param start_time: The time the query execution window started. This should[0m
[30;1m55 | [0m[35m            consistently be supplied as either seconds or milliseconds since epoch.[0m
[30;1m56 | [0m[35m        :param execution_count: The count of the number of times this query was executed[0m
[30;1m57 | [0m[35m            within the window[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/query/query_execution.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m19 | [0m[35m    Query executions are aggregated to time window to enable easily adding and[0m
[30;1m20 | [0m[35m    dropping new query execution aggregations without having to maintain[0m
[30;1m21 | [0m[35m    all instances that a query was executed in the database. Query Executions only[0m
[30;1m22 | [0m[35m    contain a start time and a window duration, although the window duration is[0m
[30;1m23 | [0m[35m    only used for informational purposes. Amundsen does not apply validation that[0m
[30;1m24 | [0m[35m    query executions do not overlap, therefore, it is important that any implementation[0m
[30;1m25 | [0m[35m    of a query execution is able to deterministically retrieve non-overlapping queries[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/query/query_execution.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35m    The Amundsen Query Executions model represents an aggregation for the number[0m
[30;1m17 | [0m[35m    of times a query was executed within a given time window.[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m    Query executions are aggregated to time window to enable easily adding and[0m
[30;1m20 | [0m[35m    dropping new query execution aggregations without having to maintain[0m
[30;1m21 | [0m[35m    all instances that a query was executed in the database. Query Executions only[0m
[30;1m22 | [0m[35m    contain a start time and a window duration, although the window duration is[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/query/query_execution.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14 | [0m[35mclass QueryExecutionsMetadata(GraphSerializable):[0m
[30;1m15 | [0m[35m    """[0m
[30;1m16 | [0m[35m    The Amundsen Query Executions model represents an aggregation for the number[0m
[30;1m17 | [0m[35m    of times a query was executed within a given time window.[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m    Query executions are aggregated to time window to enable easily adding and[0m
[30;1m20 | [0m[35m    dropping new query execution aggregations without having to maintain[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/restapi/rest_api_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m36 | [0m[35m        self._static_dict = conf.get(STATIC_RECORD_DICT, dict())[0m
[30;1m37 | [0m[35m        LOGGER.info('static record: %s', self._static_dict)[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m        model_class = conf.get(MODEL_CLASS, None)[0m
[30;1m40 | [0m[35m        if model_class:[0m
[30;1m41 | [0m[35m            module_name, class_name = model_class.rsplit(".", 1)[0m
[30;1m42 | [0m[35m            mod = importlib.import_module(module_name)[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/restapi/rest_api_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m        self._restapi_query: BaseRestApiQuery = conf.get(REST_API_QUERY)[0m
[30;1m35 | [0m[35m        self._iterator: Optional[Iterator[Dict[str, Any]]] = None[0m
[30;1m36 | [0m[35m        self._static_dict = conf.get(STATIC_RECORD_DICT, dict())[0m
[30;1m37 | [0m[35m        LOGGER.info('static record: %s', self._static_dict)[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m        model_class = conf.get(MODEL_CLASS, None)[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/restapi/rest_api_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    def init(self, conf: ConfigTree) -> None:[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m        self._restapi_query: BaseRestApiQuery = conf.get(REST_API_QUERY)[0m
[30;1m35 | [0m[35m        self._iterator: Optional[Iterator[Dict[str, Any]]] = None[0m
[30;1m36 | [0m[35m        self._static_dict = conf.get(STATIC_RECORD_DICT, dict())[0m
[30;1m37 | [0m[35m        LOGGER.info('static record: %s', self._static_dict)[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/eventbridge_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m212 | [0m[35m                return "struct<" + ",".join(properties) + ">"[0m
[30;1m213 | [0m[35m            return "struct<object>"[0m
[30;1m214 | [0m[35m        elif schema["type"] == "array":[0m
[30;1m215 | [0m[35m            items = EventBridgeExtractor._get_property_type(schema.get("items", {}))[0m
[30;1m216 | [0m[35m            return "array<" + items + ">"[0m
[30;1m217 | [0m[35m        else:[0m
[30;1m218 | [0m[35m            if "format" in schema:[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/eventbridge_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m206 | [0m[35m        if schema["type"] == "object":[0m
[30;1m207 | [0m[35m            properties = [[0m
[30;1m208 | [0m[35m                f"{name}:{EventBridgeExtractor._get_property_type(_schema)}"[0m
[30;1m209 | [0m[35m                for name, _schema in schema.get("properties", {}).items()[0m
[30;1m210 | [0m[35m            ][0m
[30;1m211 | [0m[35m            if len(properties) > 0:[0m
[30;1m212 | [0m[35m                return "struct<" + ",".join(properties) + ">"[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/eventbridge_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m173 | [0m[35m            columns.append([0m
[30;1m174 | [0m[35m                ColumnMetadata([0m
[30;1m175 | [0m[35m                    column_name,[0m
[30;1m176 | [0m[35m                    properties.get("description", None),[0m
[30;1m177 | [0m[35m                    EventBridgeExtractor._get_property_type(properties),[0m
[30;1m178 | [0m[35m                    i,[0m
[30;1m179 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/eventbridge_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m168 | [0m[35m    ) -> Optional[TableMetadata]:[0m
[30;1m169 | [0m[35m        columns = [][0m
[30;1m170 | [0m[35m        for i, (column_name, properties) in enumerate([0m
[30;1m171 | [0m[35m            schema.get("properties", {}).items()[0m
[30;1m172 | [0m[35m        ):[0m
[30;1m173 | [0m[35m            columns.append([0m
[30;1m174 | [0m[35m                ColumnMetadata([0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/eventbridge_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m104 | [0m[35m                    "Root",[0m
[30;1m105 | [0m[35m                    registry_name,[0m
[30;1m106 | [0m[35m                    title,[0m
[30;1m107 | [0m[35m                    content.get("description", None),[0m
[30;1m108 | [0m[35m                )[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m                if table is None:[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/eventbridge_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m                        schema_name,[0m
[30;1m92 | [0m[35m                        registry_name,[0m
[30;1m93 | [0m[35m                        title,[0m
[30;1m94 | [0m[35m                        schema.get("description", None),[0m
[30;1m95 | [0m[35m                    )[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m                    if table is None:[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/eventbridge_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m            ):  # NOTE: JSON Schema Draft 4[0m
[30;1m86 | [0m[35m                title = content.get("title", "")[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m                for schema_name, schema in content.get("definitions", {}).items():[0m
[30;1m89 | [0m[35m                    table = EventBridgeExtractor._build_table([0m
[30;1m90 | [0m[35m                        schema,[0m
[30;1m91 | [0m[35m                        schema_name,[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/eventbridge_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m83 | [0m[35m            elif ([0m
[30;1m84 | [0m[35m                content.get("$schema", "") == "http://json-schema.org/draft-04/schema#"[0m
[30;1m85 | [0m[35m            ):  # NOTE: JSON Schema Draft 4[0m
[30;1m86 | [0m[35m                title = content.get("title", "")[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m                for schema_name, schema in content.get("definitions", {}).items():[0m
[30;1m89 | [0m[35m                    table = EventBridgeExtractor._build_table([0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/eventbridge_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m                    yield table[0m
[30;1m83 | [0m[35m            elif ([0m
[30;1m84 | [0m[35m                content.get("$schema", "") == "http://json-schema.org/draft-04/schema#"[0m
[30;1m85 | [0m[35m            ):  # NOTE: JSON Schema Draft 4[0m
[30;1m86 | [0m[35m                title = content.get("title", "")[0m
[30;1m87 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/eventbridge_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m                        schema_name,[0m
[30;1m74 | [0m[35m                        registry_name,[0m
[30;1m75 | [0m[35m                        title,[0m
[30;1m76 | [0m[35m                        content.get("description", None),[0m
[30;1m77 | [0m[35m                    )[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m                    if table is None:[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/eventbridge_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m66 | [0m[35m            if content.get("openapi", "") == "3.0.0":  # NOTE: OpenAPI 3.0[0m
[30;1m67 | [0m[35m                title = content.get("info", {}).get("title", "")[0m
[30;1m68 | [0m[35m                for schema_name, schema in ([0m
[30;1m69 | [0m[35m                    content.get("components", {}).get("schemas", {}).items()[0m
[30;1m70 | [0m[35m                ):[0m
[30;1m71 | [0m[35m                    table = EventBridgeExtractor._build_table([0m
[30;1m72 | [0m[35m                        schema,[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/eventbridge_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m66 | [0m[35m            if content.get("openapi", "") == "3.0.0":  # NOTE: OpenAPI 3.0[0m
[30;1m67 | [0m[35m                title = content.get("info", {}).get("title", "")[0m
[30;1m68 | [0m[35m                for schema_name, schema in ([0m
[30;1m69 | [0m[35m                    content.get("components", {}).get("schemas", {}).items()[0m
[30;1m70 | [0m[35m                ):[0m
[30;1m71 | [0m[35m                    table = EventBridgeExtractor._build_table([0m
[30;1m72 | [0m[35m                        schema,[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/eventbridge_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m            content = jsonref.loads(schema_desc["Content"])[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m            if content.get("openapi", "") == "3.0.0":  # NOTE: OpenAPI 3.0[0m
[30;1m67 | [0m[35m                title = content.get("info", {}).get("title", "")[0m
[30;1m68 | [0m[35m                for schema_name, schema in ([0m
[30;1m69 | [0m[35m                    content.get("components", {}).get("schemas", {}).items()[0m
[30;1m70 | [0m[35m                ):[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/eventbridge_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m            content = jsonref.loads(schema_desc["Content"])[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m            if content.get("openapi", "") == "3.0.0":  # NOTE: OpenAPI 3.0[0m
[30;1m67 | [0m[35m                title = content.get("info", {}).get("title", "")[0m
[30;1m68 | [0m[35m                for schema_name, schema in ([0m
[30;1m69 | [0m[35m                    content.get("components", {}).get("schemas", {}).items()[0m
[30;1m70 | [0m[35m                ):[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/eventbridge_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m            content = jsonref.loads(schema_desc["Content"])[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m            if content.get("openapi", "") == "3.0.0":  # NOTE: OpenAPI 3.0[0m
[30;1m67 | [0m[35m                title = content.get("info", {}).get("title", "")[0m
[30;1m68 | [0m[35m                for schema_name, schema in ([0m
[30;1m69 | [0m[35m                    content.get("components", {}).get("schemas", {}).items()[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/eventbridge_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m34 | [0m[35m        )[0m
[30;1m35 | [0m[35m        self._schemas = boto3.client("schemas")[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m        self._registry_name = conf.get(EventBridgeExtractor.REGISTRY_NAME_KEY)[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m        self._extract_iter: Union[None, Iterator] = None[0m
[30;1m40 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/eventbridge_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m30 | [0m[35m        conf = conf.with_fallback(EventBridgeExtractor.DEFAULT_CONFIG)[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m        boto3.setup_default_session([0m
[30;1m33 | [0m[35m            region_name=conf.get(EventBridgeExtractor.REGION_NAME_KEY)[0m
[30;1m34 | [0m[35m        )[0m
[30;1m35 | [0m[35m        self._schemas = boto3.client("schemas")[0m
[30;1m36 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/mysql_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m486 | [0m[35m                                     connect_args=connect_args)[0m
[30;1m487 | [0m[35m        self._session_factory = sessionmaker(bind=self._engine)[0m
[30;1m488 | [0m[35m[0m
[30;1m489 | [0m[35m        model_class = conf.get(MySQLSearchDataExtractor.MODEL_CLASS, None)[0m
[30;1m490 | [0m[35m        if model_class:[0m
[30;1m491 | [0m[35m            module_name, class_name = model_class.rsplit(".", 1)[0m
[30;1m492 | [0m[35m            mod = importlib.import_module(module_name)[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/mysql_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m473 | [0m[35m        self.conf = conf[0m
[30;1m474 | [0m[35m        self.entity = conf.get_string(MySQLSearchDataExtractor.ENTITY_TYPE, default='table').lower()[0m
[30;1m475 | [0m[35m        if MySQLSearchDataExtractor.SEARCH_FUNCTION in conf:[0m
[30;1m476 | [0m[35m            self.search_function = conf.get(MySQLSearchDataExtractor.SEARCH_FUNCTION)[0m
[30;1m477 | [0m[35m        else:[0m
[30;1m478 | [0m[35m            self.search_function = MySQLSearchDataExtractor._DEFAULT_SEARCH_BY_ENTITY[self.entity][0m
[30;1m479 | [0m[35m        self.published_tag = conf.get_string(MySQLSearchDataExtractor.JOB_PUBLISH_TAG, '')[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/task/mysql_staleness_removal_task.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m157 | [0m[35m        target_table = target_model_class.__tablename__[0m
[30;1m158 | [0m[35m        if stale_records_count:[0m
[30;1m159 | [0m[35m            staleness_pct = stale_records_count * 100 / total_records_count[0m
[30;1m160 | [0m[35m            threshold = self.staleness_max_pct_dict.get(target_table, self.staleness_max_pct)[0m
[30;1m161 | [0m[35m            if staleness_pct >= threshold:[0m
[30;1m162 | [0m[35m                raise Exception(f'Staleness percentage of {target_table} is {staleness_pct} %. '[0m
[30;1m163 | [0m[35m                                f'Stopping due to over threshold {threshold} %')[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/task/mysql_staleness_removal_task.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m126 | [0m[35m            self.target_tables, key=lambda table: sorted_table_names.index(table), reverse=True)[0m
[30;1m127 | [0m[35m        try:[0m
[30;1m128 | [0m[35m            for table_name in sorted_target_tables:[0m
[30;1m129 | [0m[35m                target_model_class = self.target_table_model_dict.get(table_name, None)[0m
[30;1m130 | [0m[35m                if target_model_class:[0m
[30;1m131 | [0m[35m                    staleness_pct = self._validate_record_staleness_pct(target_model_class=target_mo[0m
[30;1m132 | [0m[35m                    if self.dry_run:[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/task/mysql_staleness_removal_task.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m        self.target_table_model_dict = self._get_target_table_model_dict(self.target_tables)[0m
[30;1m68 | [0m[35m        self.dry_run = conf.get_bool(MySQLStalenessRemovalTask.DRY_RUN)[0m
[30;1m69 | [0m[35m        self.staleness_max_pct = conf.get_int(MySQLStalenessRemovalTask.STALENESS_MAX_PCT)[0m
[30;1m70 | [0m[35m        self.staleness_max_pct_dict = conf.get(MySQLStalenessRemovalTask.STALENESS_PCT_MAX_DICT)[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m        if MySQLStalenessRemovalTask.PUBLISHED_TAG in conf and MySQLStalenessRemovalTask.MS_TO_EXPIR[0m
[30;1m73 | [0m[35m            raise Exception(f'Cannot have both {MySQLStalenessRemovalTask.PUBLISHED_TAG} and '[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/task/mysql_staleness_removal_task.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35m# SPDX-License-Identifier: Apache-2.0[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mimport logging[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35mfrom typing import ([0m
[30;1m7 | [0m[35m    Any, Dict, Set, Type,[0m
[30;1m8 | [0m[35m)[0m
[30;1m9 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/kafka_source_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m70 | [0m[35m                                                          default=False)[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m        # Transform the protoBuf message with a transformer[0m
[30;1m73 | [0m[35m        val_transformer = conf.get(KafkaSourceExtractor.RAW_VALUE_TRANSFORMER)[0m
[30;1m74 | [0m[35m        if val_transformer is None:[0m
[30;1m75 | [0m[35m            raise Exception('A message transformer should be provided.')[0m
[30;1m76 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/kafka_source_extractor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m                # The consumer exceeds consume timeout[0m
[30;1m150 | [0m[35m                if (end - start) > timedelta(seconds=self.consumer_total_timeout):[0m
[30;1m151 | [0m[35m                    # Exceed the consume timeout[0m
[30;1m152 | [0m[35m                    break[0m
[30;1m153 | [0m[35m[0m
[30;1m154 | [0m[35m                if msg is None:[0m
[30;1m155 | [0m[35m                    continue[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/kafka_source_extractor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m146 | [0m[35m                msg = self.consumer.poll(timeout=self.consumer_poll_timeout)[0m
[30;1m147 | [0m[35m                end = datetime.now()[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m                # The consumer exceeds consume timeout[0m
[30;1m150 | [0m[35m                if (end - start) > timedelta(seconds=self.consumer_total_timeout):[0m
[30;1m151 | [0m[35m                    # Exceed the consume timeout[0m
[30;1m152 | [0m[35m                    break[0m
[30;1m153 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/kafka_source_extractor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m41 | [0m[35m    # Time out config. It will abort from reading the Kafka topic after timeout is reached. Unit is [0m
[30;1m42 | [0m[35m    CONSUMER_TOTAL_TIMEOUT_SEC = 'consumer_total_timeout_sec'[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m    # The timeout for consumer polling messages. Default to 1 sec[0m
[30;1m45 | [0m[35m    CONSUMER_POLL_TIMEOUT_SEC = 'consumer_poll_timeout_sec'[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    # Config on whether we throw exception if transformation fails[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/kafka_source_extractor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35m    # Each Kafka extractor should only consume one single topic. We could extend to consume more top[0m
[30;1m39 | [0m[35m    TOPIC_NAME_LIST = 'topic_name_list'[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m    # Time out config. It will abort from reading the Kafka topic after timeout is reached. Unit is [0m
[30;1m42 | [0m[35m    CONSUMER_TOTAL_TIMEOUT_SEC = 'consumer_total_timeout_sec'[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m    # The timeout for consumer polling messages. Default to 1 sec[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/kafka_source_extractor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35m    # Each Kafka extractor should only consume one single topic. We could extend to consume more top[0m
[30;1m39 | [0m[35m    TOPIC_NAME_LIST = 'topic_name_list'[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m    # Time out config. It will abort from reading the Kafka topic after timeout is reached. Unit is [0m
[30;1m42 | [0m[35m    CONSUMER_TOTAL_TIMEOUT_SEC = 'consumer_total_timeout_sec'[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m    # The timeout for consumer polling messages. Default to 1 sec[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/utils/publisher_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m    For any label seen first time for this publisher it will try to create unique index.[0m
[30;1m41 | [0m[35m    Neo4j ignores a second creation in 3.x, but raises an error in 4.x.[0m
[30;1m42 | [0m[35m    """[0m
[30;1m43 | [0m[35m    LOGGER.info('Creating indices using Node file: %s. (Existing indices will be ignored)', node_fil[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m    labels = set(current_labels)[0m
[30;1m46 | [0m[35m    with open(node_file, 'r', encoding='utf8') as node_csv:[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/utils/publisher_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m37 | [0m[35m                                     db_name: str) -> Set:[0m
[30;1m38 | [0m[35m    """[0m
[30;1m39 | [0m[35m    Go over the node file and try creating unique indices.[0m
[30;1m40 | [0m[35m    For any label seen first time for this publisher it will try to create unique index.[0m
[30;1m41 | [0m[35m    Neo4j ignores a second creation in 3.x, but raises an error in 4.x.[0m
[30;1m42 | [0m[35m    """[0m
[30;1m43 | [0m[35m    LOGGER.info('Creating indices using Node file: %s. (Existing indices will be ignored)', node_fil[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/utils/publisher_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m36 | [0m[35m                                     driver: Neo4jDriver,[0m
[30;1m37 | [0m[35m                                     db_name: str) -> Set:[0m
[30;1m38 | [0m[35m    """[0m
[30;1m39 | [0m[35m    Go over the node file and try creating unique indices.[0m
[30;1m40 | [0m[35m    For any label seen first time for this publisher it will try to create unique index.[0m
[30;1m41 | [0m[35m    Neo4j ignores a second creation in 3.x, but raises an error in 4.x.[0m
[30;1m42 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/neo4j_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m        self._extract_iter: Union[None, Iterator] = None[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m        model_class = self.conf.get(Neo4jExtractor.MODEL_CLASS_CONFIG_KEY, None)[0m
[30;1m88 | [0m[35m        if model_class:[0m
[30;1m89 | [0m[35m            module_name, class_name = model_class.rsplit(".", 1)[0m
[30;1m90 | [0m[35m            mod = importlib.import_module(module_name)[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/neo4j_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m        # if NEO4J_VALIDATE_SSL or NEO4J_ENCRYPTED are set in config pass them to the driver[0m
[30;1m75 | [0m[35m        validate_ssl_conf = self.conf.get(Neo4jExtractor.NEO4J_VALIDATE_SSL, None)[0m
[30;1m76 | [0m[35m        encrypted_conf = self.conf.get(Neo4jExtractor.NEO4J_ENCRYPTED, None)[0m
[30;1m77 | [0m[35m        if validate_ssl_conf is not None:[0m
[30;1m78 | [0m[35m            driver_args['trust'] = neo4j.TRUST_SYSTEM_CA_SIGNED_CERTIFICATES if validate_ssl_conf \[0m
[30;1m79 | [0m[35m                else neo4j.TRUST_ALL_CERTIFICATES[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/neo4j_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m            driver_args.update(default_security_conf)[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m        # if NEO4J_VALIDATE_SSL or NEO4J_ENCRYPTED are set in config pass them to the driver[0m
[30;1m75 | [0m[35m        validate_ssl_conf = self.conf.get(Neo4jExtractor.NEO4J_VALIDATE_SSL, None)[0m
[30;1m76 | [0m[35m        encrypted_conf = self.conf.get(Neo4jExtractor.NEO4J_ENCRYPTED, None)[0m
[30;1m77 | [0m[35m        if validate_ssl_conf is not None:[0m
[30;1m78 | [0m[35m            driver_args['trust'] = neo4j.TRUST_SYSTEM_CA_SIGNED_CERTIFICATES if validate_ssl_conf \[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/neo4j_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m        self.graph_url = self.conf.get_string(Neo4jExtractor.GRAPH_URL_CONFIG_KEY)[0m
[30;1m55 | [0m[35m        self.cypher_query = self.conf.get_string(Neo4jExtractor.CYPHER_QUERY_CONFIG_KEY)[0m
[30;1m56 | [0m[35m        self.db_name = self.conf.get_string(Neo4jExtractor.NEO4J_DATABASE_NAME)[0m
[30;1m57 | [0m[35m        self.use_implicit_transactions = self.conf.get(Neo4jExtractor.NEO4J_USE_IMPLICIT_TRANSACTION[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m        uri = self.conf.get_string(Neo4jExtractor.GRAPH_URL_CONFIG_KEY)[0m
[30;1m60 | [0m[35m        driver_args = {[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/neo4j_extractor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m    def _get_extract_iter(self) -> Iterator[Any]:[0m
[30;1m111 | [0m[35m        """[0m
[30;1m112 | [0m[35m        Execute {cypher_query} and yield result one at a time[0m
[30;1m113 | [0m[35m        """[0m
[30;1m114 | [0m[35m        with self.driver.session([0m
[30;1m115 | [0m[35m            database=self.db_name,[0m
[30;1m116 | [0m[35m            default_access_mode=neo4j.READ_ACCESS[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/neo4j_extractor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m28 | [0m[35m    MODEL_CLASS_CONFIG_KEY = 'model_class'[0m
[30;1m29 | [0m[35m    NEO4J_AUTH_USER = 'neo4j_auth_user'[0m
[30;1m30 | [0m[35m    NEO4J_AUTH_PW = 'neo4j_auth_pw'[0m
[30;1m31 | [0m[35m    # in Neo4j (v4.0+), we can create and use more than one active database at the same time[0m
[30;1m32 | [0m[35m    NEO4J_DATABASE_NAME = 'neo4j_database'[0m
[30;1m33 | [0m[35m    NEO4J_MAX_CONN_LIFE_TIME_SEC = 'neo4j_max_conn_life_time_sec'[0m
[30;1m34 | [0m[35m    NEO4J_ENCRYPTED = 'neo4j_encrypted'[0m
[30;1m35 | [0m[35m    """NEO4J_ENCRYPTED is a boolean indicating whether to use SSL/TLS when connecting."""[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/neo4j_extractor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m    def _get_extract_iter(self) -> Iterator[Any]:[0m
[30;1m111 | [0m[35m        """[0m
[30;1m112 | [0m[35m        Execute {cypher_query} and yield result one at a time[0m
[30;1m113 | [0m[35m        """[0m
[30;1m114 | [0m[35m        with self.driver.session([0m
[30;1m115 | [0m[35m            database=self.db_name,[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/neo4j_extractor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m28 | [0m[35m    MODEL_CLASS_CONFIG_KEY = 'model_class'[0m
[30;1m29 | [0m[35m    NEO4J_AUTH_USER = 'neo4j_auth_user'[0m
[30;1m30 | [0m[35m    NEO4J_AUTH_PW = 'neo4j_auth_pw'[0m
[30;1m31 | [0m[35m    # in Neo4j (v4.0+), we can create and use more than one active database at the same time[0m
[30;1m32 | [0m[35m    NEO4J_DATABASE_NAME = 'neo4j_database'[0m
[30;1m33 | [0m[35m    NEO4J_MAX_CONN_LIFE_TIME_SEC = 'neo4j_max_conn_life_time_sec'[0m
[30;1m34 | [0m[35m    NEO4J_ENCRYPTED = 'neo4j_encrypted'[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dbt_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m317 | [0m[35m                # Only extract column-level tags IF converting to badges, Amundsen does not have col[0m
[30;1m318 | [0m[35m                badges = None[0m
[30;1m319 | [0m[35m                if self._extract_tags and self._dbt_tag_as == DBT_TAG_AS.BADGE:[0m
[30;1m320 | [0m[35m                    badges = manifest_col_content.get('tags')[0m
[30;1m321 | [0m[35m[0m
[30;1m322 | [0m[35m                col_metadata = ColumnMetadata([0m
[30;1m323 | [0m[35m                    name=self._default_sanitize(catalog_col_content['name']),[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dbt_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m312 | [0m[35m            if catalog_col_content:[0m
[30;1m313 | [0m[35m                col_desc = None[0m
[30;1m314 | [0m[35m                if self._extract_descriptions:[0m
[30;1m315 | [0m[35m                    col_desc = manifest_col_content.get('description')[0m
[30;1m316 | [0m[35m[0m
[30;1m317 | [0m[35m                # Only extract column-level tags IF converting to badges, Amundsen does not have col[0m
[30;1m318 | [0m[35m                badges = None[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dbt_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m308 | [0m[35m        """[0m
[30;1m309 | [0m[35m        tbl_columns = [][0m
[30;1m310 | [0m[35m        for catalog_col_name, catalog_col_content in catalog_columns.items():[0m
[30;1m311 | [0m[35m            manifest_col_content = manifest_columns.get(catalog_col_name, {})[0m
[30;1m312 | [0m[35m            if catalog_col_content:[0m
[30;1m313 | [0m[35m                col_desc = None[0m
[30;1m314 | [0m[35m                if self._extract_descriptions:[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dbt_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m287 | [0m[35m                    continue[0m
[30;1m288 | [0m[35m                valid_downstreams = [[0m
[30;1m289 | [0m[35m                    dbt_id_to_table_key[k] for k in downstreams[0m
[30;1m290 | [0m[35m                    if k.startswith(DBT_MODEL_PREFIX) and dbt_id_to_table_key.get(k)[0m
[30;1m291 | [0m[35m                ][0m
[30;1m292 | [0m[35m                if valid_downstreams:[0m
[30;1m293 | [0m[35m                    yield TableLineage([0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dbt_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m279 | [0m[35m                                      cluster=tbl_metadata.cluster,[0m
[30;1m280 | [0m[35m                                      schema=tbl_metadata.schema,[0m
[30;1m281 | [0m[35m                                      table_name=tbl_metadata.name,[0m
[30;1m282 | [0m[35m                                      source=os.path.join(self._source_url, manifest_content.get('or[0m
[30;1m283 | [0m[35m[0m
[30;1m284 | [0m[35m        if self._extract_lineage:[0m
[30;1m285 | [0m[35m            for upstream, downstreams in self._dbt_manifest['child_map'].items():[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dbt_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m218 | [0m[35m            if self._dbt_tag_as == DBT_TAG_AS.BADGE:[0m
[30;1m219 | [0m[35m                tbl_badges = manifest_content.get('tags')[0m
[30;1m220 | [0m[35m            elif self._dbt_tag_as == DBT_TAG_AS.TAG:[0m
[30;1m221 | [0m[35m                tags = manifest_content.get('tags')[0m
[30;1m222 | [0m[35m        return tags, tbl_badges[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m    def _can_yield_schema(self, schema: str) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dbt_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m216 | [0m[35m        tags, tbl_badges = None, None[0m
[30;1m217 | [0m[35m        if self._extract_tags:[0m
[30;1m218 | [0m[35m            if self._dbt_tag_as == DBT_TAG_AS.BADGE:[0m
[30;1m219 | [0m[35m                tbl_badges = manifest_content.get('tags')[0m
[30;1m220 | [0m[35m            elif self._dbt_tag_as == DBT_TAG_AS.TAG:[0m
[30;1m221 | [0m[35m                tags = manifest_content.get('tags')[0m
[30;1m222 | [0m[35m        return tags, tbl_badges[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dbt_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m205 | [0m[35m        """[0m
[30;1m206 | [0m[35m        desc, desc_src = None, None[0m
[30;1m207 | [0m[35m        if self._extract_descriptions:[0m
[30;1m208 | [0m[35m            desc = manifest_content.get('description')[0m
[30;1m209 | [0m[35m            desc_src = 'dbt description'[0m
[30;1m210 | [0m[35m        return desc, desc_src[0m
[30;1m211 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dbt_extractor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m    def _get_table_tags_badges(self, manifest_content: Dict) -> Tuple[Optional[List[str]], Optional[[0m
[30;1m213 | [0m[35m        """[0m
[30;1m214 | [0m[35m        Gets tags or badges for a given table. At most one of these values will not be null.[0m
[30;1m215 | [0m[35m        """[0m
[30;1m216 | [0m[35m        tags, tbl_badges = None, None[0m
[30;1m217 | [0m[35m        if self._extract_tags:[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dbt_extractor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35m    def _clean_inputs(self) -> None:[0m
[30;1m157 | [0m[35m        """[0m
[30;1m158 | [0m[35m        Validates the dbt input to ensure that at least one of the inputs[0m
[30;1m159 | [0m[35m        (manifest.json or catalog.json) are provided. Once validated, the[0m
[30;1m160 | [0m[35m        inputs are sanitized to ensure that the `self._dbt_manifest` and[0m
[30;1m161 | [0m[35m        `self._dbt_catalog` are valid Python dictionaries.[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dbt_extractor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m44 | [0m[35mclass DbtExtractor(Extractor):[0m
[30;1m45 | [0m[35m    """[0m
[30;1m46 | [0m[35m    Extracts metadata from the dbt manifest.json and catalog.json files.[0m
[30;1m47 | [0m[35m    At least one of a manifest or a catalog (or both) must be provided.[0m
[30;1m48 | [0m[35m    The location of the file or a valid Python dictionary of the content[0m
[30;1m49 | [0m[35m    can be provided.[0m
[30;1m50 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/snowflake_table_last_updated_extractor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m        snowflake-sqlalchemy[0m
[30;1m22 | [0m[35m    """[0m
[30;1m23 | [0m[35m    # https://docs.snowflake.com/en/sql-reference/info-schema/views.html#columns[0m
[30;1m24 | [0m[35m    # 'last_altered' column in 'TABLES` metadata view under 'INFORMATION_SCHEMA' contains last time [0m
[30;1m25 | [0m[35m    # updated (both DML and DDL update). Below query fetches that column for each table.[0m
[30;1m26 | [0m[35m    SQL_STATEMENT = """[0m
[30;1m27 | [0m[35m        SELECT[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/snowflake_table_last_updated_extractor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35mclass SnowflakeTableLastUpdatedExtractor(Extractor):[0m
[30;1m17 | [0m[35m    """[0m
[30;1m18 | [0m[35m    Extracts Snowflake table last update time from INFORMATION_SCHEMA metadata tables using SQLAlche[0m
[30;1m19 | [0m[35m    Requirements:[0m
[30;1m20 | [0m[35m        snowflake-connector-python[0m
[30;1m21 | [0m[35m        snowflake-sqlalchemy[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/snowflake_table_last_updated_extractor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35mclass SnowflakeTableLastUpdatedExtractor(Extractor):[0m
[30;1m17 | [0m[35m    """[0m
[30;1m18 | [0m[35m    Extracts Snowflake table last update time from INFORMATION_SCHEMA metadata tables using SQLAlche[0m
[30;1m19 | [0m[35m    Requirements:[0m
[30;1m20 | [0m[35m        snowflake-connector-python[0m
[30;1m21 | [0m[35m        snowflake-sqlalchemy[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/sql_alchemy_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m        self.extract_sql = conf.get_string(SQLAlchemyExtractor.EXTRACT_SQL)[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m        model_class = conf.get('model_class', None)[0m
[30;1m36 | [0m[35m        if model_class:[0m
[30;1m37 | [0m[35m            module_name, class_name = model_class.rsplit(".", 1)[0m
[30;1m38 | [0m[35m            mod = importlib.import_module(module_name)[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/sql_alchemy_extractor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m    def extract(self) -> Any:[0m
[30;1m79 | [0m[35m        """[0m
[30;1m80 | [0m[35m        Yield the sql result one at a time.[0m
[30;1m81 | [0m[35m        convert the result to model if a model_class is provided[0m
[30;1m82 | [0m[35m        """[0m
[30;1m83 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m    def _create_node_iterator(self) -> Iterator[GraphNode]:[0m
[30;1m98 | [0m[35m        """[0m
[30;1m99 | [0m[35m        Create an application node[0m
[30;1m100 | [0m[35m        :return:[0m
[30;1m101 | [0m[35m        """[0m
[30;1m102 | [0m[35m        attrs = {[0m
[30;1m103 | [0m[35m            GenericApplication.APP_NAME: self.application_type,[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/application.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m76 | [0m[35m        self._atlas_relation_iterator = self._create_atlas_relation_iterator()[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m    def create_next_node(self) -> Union[GraphNode, None]:[0m
[30;1m79 | [0m[35m        # creates new node[0m
[30;1m80 | [0m[35m        try:[0m
[30;1m81 | [0m[35m            return next(self._node_iter)[0m
[30;1m82 | [0m[35m        except StopIteration:[0m
[30;1m83 | [0m[35m            return None[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/rest_api/query_merger.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m51 | [0m[35m            self._computed_query_result = self._compute_query_result()[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m        value_of_merge_key = record_dict.get(self._merge_key)[0m
[30;1m54 | [0m[35m        record_dict_to_merge = self._computed_query_result.get(value_of_merge_key)[0m
[30;1m55 | [0m[35m        if not record_dict_to_merge:[0m
[30;1m56 | [0m[35m            raise Exception(f'{self._merge_key} {value_of_merge_key} not found in query_to_merge res[0m
[30;1m57 | [0m[35m        # we don't want the query merger to overwrite values of existing keys in record_dict[0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/rest_api/query_merger.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m50 | [0m[35m        if not self._computed_query_result:[0m
[30;1m51 | [0m[35m            self._computed_query_result = self._compute_query_result()[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m        value_of_merge_key = record_dict.get(self._merge_key)[0m
[30;1m54 | [0m[35m        record_dict_to_merge = self._computed_query_result.get(value_of_merge_key)[0m
[30;1m55 | [0m[35m        if not record_dict_to_merge:[0m
[30;1m56 | [0m[35m            raise Exception(f'{self._merge_key} {value_of_merge_key} not found in query_to_merge res[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/rest_api/query_merger.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35m        :param record_dict: the record_dict to be updated in place[0m
[30;1m47 | [0m[35m        :return:[0m
[30;1m48 | [0m[35m        """[0m
[30;1m49 | [0m[35m        # compute query results for easy lookup later to find the exact record to merge[0m
[30;1m50 | [0m[35m        if not self._computed_query_result:[0m
[30;1m51 | [0m[35m            self._computed_query_result = self._compute_query_result()[0m
[30;1m52 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/rest_api/query_merger.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m    def merge_into(self, record_dict: dict) -> None:[0m
[30;1m43 | [0m[35m        """[0m
[30;1m44 | [0m[35m        Merge results of query_to_merge into record_dict. Update record_dict in place.[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m        :param record_dict: the record_dict to be updated in place[0m
[30;1m47 | [0m[35m        :return:[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/loader/generic_loader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m33 | [0m[35m        :param conf:[0m
[30;1m34 | [0m[35m        """[0m
[30;1m35 | [0m[35m        self.conf = conf[0m
[30;1m36 | [0m[35m        self._callback_func = self.conf.get(CALLBACK_FUNCTION, log_call_back)[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m    def load(self, record: Optional[Any]) -> None:[0m
[30;1m39 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/snowflake_metadata_extractor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m30 | [0m[35m    """[0m
[30;1m31 | [0m[35m    # SELECT statement from snowflake information_schema to extract table and column metadata[0m
[30;1m32 | [0m[35m    # https://docs.snowflake.com/en/sql-reference/account-usage.html#label-account-usage-views[0m
[30;1m33 | [0m[35m    # This can be modified to use account_usage for performance at the cost of latency if necessary.[0m
[30;1m34 | [0m[35m    SQL_STATEMENT = """[0m
[30;1m35 | [0m[35m    SELECT[0m
[30;1m36 | [0m[35m        lower(c.column_name) AS col_name,[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/loader/file_system_neptune_csv_loader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m150 | [0m[35m        If writer does not exist, it's creates a csv writer and update the[0m
[30;1m151 | [0m[35m        mapping.[0m
[30;1m152 | [0m[35m        """[0m
[30;1m153 | [0m[35m        writer = file_mapping.get(key)[0m
[30;1m154 | [0m[35m        if writer:[0m
[30;1m155 | [0m[35m            return writer[0m
[30;1m156 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/loader/file_system_neptune_csv_loader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m117 | [0m[35m                    file_suffix[0m
[30;1m118 | [0m[35m                )[0m
[30;1m119 | [0m[35m                node_writer.writerow(node_dict)[0m
[30;1m120 | [0m[35m            node = csv_serializable.next_node()[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m        relation = csv_serializable.next_relation()[0m
[30;1m123 | [0m[35m        while relation:[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/loader/file_system_neptune_csv_loader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m101 | [0m[35m        :return:[0m
[30;1m102 | [0m[35m        """[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m        node = csv_serializable.next_node()[0m
[30;1m105 | [0m[35m        while node:[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m            node.attributes[PUBLISHED_TAG_PROPERTY_NAME] = self.job_publisher_tag[0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/loader/file_system_neptune_csv_loader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m90 | [0m[35m        """[0m
[30;1m91 | [0m[35m        Writes GraphSerializable into CSV files.[0m
[30;1m92 | [0m[35m        There are multiple CSV files that this method writes.[0m
[30;1m93 | [0m[35m        This is because there're not only node and relationship, but also it[0m
[30;1m94 | [0m[35m        can also have different nodes, and relationships.[0m
[30;1m95 | [0m[35m        Common pattern for both nodes and relations:[0m
[30;1m96 | [0m[35m         1. retrieve csv row (a dict where keys represent a header,[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/loader/file_system_neptune_csv_loader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    def init(self, conf: ConfigTree) -> None:[0m
[30;1m48 | [0m[35m        """[0m
[30;1m49 | [0m[35m        Initializing FSNeptuneCSVLoader by creating directory for node files[0m
[30;1m50 | [0m[35m        and relationship files. Note that the directory defined in[0m
[30;1m51 | [0m[35m        configuration should not exist.[0m
[30;1m52 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/loader/file_system_neptune_csv_loader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35mclass FSNeptuneCSVLoader(Loader):[0m
[30;1m25 | [0m[35m    """[0m
[30;1m26 | [0m[35m    Write node and relationship CSV file(s) that can be consumed by[0m
[30;1m27 | [0m[35m    NeptuneCsvPublisher.[0m
[30;1m28 | [0m[35m    It assumes that the record it consumes is instance of GraphSerializable[0m
[30;1m29 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/loader/file_system_neptune_csv_loader.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m147 | [0m[35m                    ) -> DictWriter:[0m
[30;1m148 | [0m[35m        """[0m
[30;1m149 | [0m[35m        Finds a writer based on csv record, key.[0m
[30;1m150 | [0m[35m        If writer does not exist, it's creates a csv writer and update the[0m
[30;1m151 | [0m[35m        mapping.[0m
[30;1m152 | [0m[35m        """[0m
[30;1m153 | [0m[35m        writer = file_mapping.get(key)[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/glue_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m95 | [0m[35m                row['Name'],[0m
[30;1m96 | [0m[35m                row.get('Description') or row.get('Parameters', {}).get('comment'),[0m
[30;1m97 | [0m[35m                columns,[0m
[30;1m98 | [0m[35m                row.get('TableType') == 'VIRTUAL_VIEW',[0m
[30;1m99 | [0m[35m            )[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m    def _get_raw_extract_iter(self) -> Iterator[Dict[str, Any]]:[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/glue_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m93 | [0m[35m                self._cluster,[0m
[30;1m94 | [0m[35m                row['DatabaseName'],[0m
[30;1m95 | [0m[35m                row['Name'],[0m
[30;1m96 | [0m[35m                row.get('Description') or row.get('Parameters', {}).get('comment'),[0m
[30;1m97 | [0m[35m                columns,[0m
[30;1m98 | [0m[35m                row.get('TableType') == 'VIRTUAL_VIEW',[0m
[30;1m99 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/glue_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m93 | [0m[35m                self._cluster,[0m
[30;1m94 | [0m[35m                row['DatabaseName'],[0m
[30;1m95 | [0m[35m                row['Name'],[0m
[30;1m96 | [0m[35m                row.get('Description') or row.get('Parameters', {}).get('comment'),[0m
[30;1m97 | [0m[35m                columns,[0m
[30;1m98 | [0m[35m                row.get('TableType') == 'VIRTUAL_VIEW',[0m
[30;1m99 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/glue_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m93 | [0m[35m                self._cluster,[0m
[30;1m94 | [0m[35m                row['DatabaseName'],[0m
[30;1m95 | [0m[35m                row['Name'],[0m
[30;1m96 | [0m[35m                row.get('Description') or row.get('Parameters', {}).get('comment'),[0m
[30;1m97 | [0m[35m                columns,[0m
[30;1m98 | [0m[35m                row.get('TableType') == 'VIRTUAL_VIEW',[0m
[30;1m99 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/glue_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m            for column in row.get('PartitionKeys', []):[0m
[30;1m82 | [0m[35m                columns.append(ColumnMetadata([0m
[30;1m83 | [0m[35m                    name=column["Name"],[0m
[30;1m84 | [0m[35m                    description=column.get("Comment"),[0m
[30;1m85 | [0m[35m                    col_type=column["Type"],[0m
[30;1m86 | [0m[35m                    sort_order=i,[0m
[30;1m87 | [0m[35m                    badges=[self._partition_badge_label] if self._partition_badge_label else None,[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/glue_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m78 | [0m[35m                ))[0m
[30;1m79 | [0m[35m                i += 1[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m            for column in row.get('PartitionKeys', []):[0m
[30;1m82 | [0m[35m                columns.append(ColumnMetadata([0m
[30;1m83 | [0m[35m                    name=column["Name"],[0m
[30;1m84 | [0m[35m                    description=column.get("Comment"),[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/glue_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m            for column in row['StorageDescriptor']['Columns']:[0m
[30;1m73 | [0m[35m                columns.append(ColumnMetadata([0m
[30;1m74 | [0m[35m                    name=column["Name"],[0m
[30;1m75 | [0m[35m                    description=column.get("Comment"),[0m
[30;1m76 | [0m[35m                    col_type=column["Type"],[0m
[30;1m77 | [0m[35m                    sort_order=i,[0m
[30;1m78 | [0m[35m                ))[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/glue_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m40 | [0m[35m        self._max_results = conf.get(GlueExtractor.MAX_RESULTS_KEY)[0m
[30;1m41 | [0m[35m        self._resource_share_type = conf.get(GlueExtractor.RESOURCE_SHARE_TYPE)[0m
[30;1m42 | [0m[35m        self._region_name = conf.get(GlueExtractor.REGION_NAME_KEY)[0m
[30;1m43 | [0m[35m        self._partition_badge_label = conf.get(GlueExtractor.PARTITION_BADGE_LABEL_KEY)[0m
[30;1m44 | [0m[35m        if self._region_name is not None:[0m
[30;1m45 | [0m[35m            self._glue = boto3.client('glue', region_name=self._region_name)[0m
[30;1m46 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/glue_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m39 | [0m[35m        self._filters = conf.get(GlueExtractor.FILTER_KEY)[0m
[30;1m40 | [0m[35m        self._max_results = conf.get(GlueExtractor.MAX_RESULTS_KEY)[0m
[30;1m41 | [0m[35m        self._resource_share_type = conf.get(GlueExtractor.RESOURCE_SHARE_TYPE)[0m
[30;1m42 | [0m[35m        self._region_name = conf.get(GlueExtractor.REGION_NAME_KEY)[0m
[30;1m43 | [0m[35m        self._partition_badge_label = conf.get(GlueExtractor.PARTITION_BADGE_LABEL_KEY)[0m
[30;1m44 | [0m[35m        if self._region_name is not None:[0m
[30;1m45 | [0m[35m            self._glue = boto3.client('glue', region_name=self._region_name)[0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/glue_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m38 | [0m[35m        self._cluster = conf.get_string(GlueExtractor.CLUSTER_KEY)[0m
[30;1m39 | [0m[35m        self._filters = conf.get(GlueExtractor.FILTER_KEY)[0m
[30;1m40 | [0m[35m        self._max_results = conf.get(GlueExtractor.MAX_RESULTS_KEY)[0m
[30;1m41 | [0m[35m        self._resource_share_type = conf.get(GlueExtractor.RESOURCE_SHARE_TYPE)[0m
[30;1m42 | [0m[35m        self._region_name = conf.get(GlueExtractor.REGION_NAME_KEY)[0m
[30;1m43 | [0m[35m        self._partition_badge_label = conf.get(GlueExtractor.PARTITION_BADGE_LABEL_KEY)[0m
[30;1m44 | [0m[35m        if self._region_name is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/glue_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m37 | [0m[35m        conf = conf.with_fallback(GlueExtractor.DEFAULT_CONFIG)[0m
[30;1m38 | [0m[35m        self._cluster = conf.get_string(GlueExtractor.CLUSTER_KEY)[0m
[30;1m39 | [0m[35m        self._filters = conf.get(GlueExtractor.FILTER_KEY)[0m
[30;1m40 | [0m[35m        self._max_results = conf.get(GlueExtractor.MAX_RESULTS_KEY)[0m
[30;1m41 | [0m[35m        self._resource_share_type = conf.get(GlueExtractor.RESOURCE_SHARE_TYPE)[0m
[30;1m42 | [0m[35m        self._region_name = conf.get(GlueExtractor.REGION_NAME_KEY)[0m
[30;1m43 | [0m[35m        self._partition_badge_label = conf.get(GlueExtractor.PARTITION_BADGE_LABEL_KEY)[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/glue_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m36 | [0m[35m    def init(self, conf: ConfigTree) -> None:[0m
[30;1m37 | [0m[35m        conf = conf.with_fallback(GlueExtractor.DEFAULT_CONFIG)[0m
[30;1m38 | [0m[35m        self._cluster = conf.get_string(GlueExtractor.CLUSTER_KEY)[0m
[30;1m39 | [0m[35m        self._filters = conf.get(GlueExtractor.FILTER_KEY)[0m
[30;1m40 | [0m[35m        self._max_results = conf.get(GlueExtractor.MAX_RESULTS_KEY)[0m
[30;1m41 | [0m[35m        self._resource_share_type = conf.get(GlueExtractor.RESOURCE_SHARE_TYPE)[0m
[30;1m42 | [0m[35m        self._region_name = conf.get(GlueExtractor.REGION_NAME_KEY)[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/transformer/regex_str_replace_transformer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m    def transform(self, record: Any) -> Any:[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m        if isinstance(record, dict):[0m
[30;1m34 | [0m[35m            val = record.get(self._attribute_name)[0m
[30;1m35 | [0m[35m        else:[0m
[30;1m36 | [0m[35m            val = getattr(record, self._attribute_name)[0m
[30;1m37 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/cassandra_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m        self._cluster = conf.get_string(CassandraExtractor.CLUSTER_KEY)[0m
[30;1m44 | [0m[35m        self._filter = conf.get(CassandraExtractor.FILTER_FUNCTION_KEY)[0m
[30;1m45 | [0m[35m        ips = conf.get_list(CassandraExtractor.IPS_KEY)[0m
[30;1m46 | [0m[35m        kwargs = conf.get(CassandraExtractor.KWARGS_KEY)[0m
[30;1m47 | [0m[35m        self._client = Cluster(ips, **kwargs)[0m
[30;1m48 | [0m[35m        self._client.connect()[0m
[30;1m49 | [0m[35m        self._extract_iter: Union[None, Iterator] = None[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/cassandra_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m    def init(self, conf: ConfigTree) -> None:[0m
[30;1m42 | [0m[35m        conf = conf.with_fallback(CassandraExtractor.DEFAULT_CONFIG)[0m
[30;1m43 | [0m[35m        self._cluster = conf.get_string(CassandraExtractor.CLUSTER_KEY)[0m
[30;1m44 | [0m[35m        self._filter = conf.get(CassandraExtractor.FILTER_FUNCTION_KEY)[0m
[30;1m45 | [0m[35m        ips = conf.get_list(CassandraExtractor.IPS_KEY)[0m
[30;1m46 | [0m[35m        kwargs = conf.get(CassandraExtractor.KWARGS_KEY)[0m
[30;1m47 | [0m[35m        self._client = Cluster(ips, **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/report.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m    def _create_node_iterator(self) -> Iterator[GraphNode]:[0m
[30;1m73 | [0m[35m        """[0m
[30;1m74 | [0m[35m        Create an application node[0m
[30;1m75 | [0m[35m        :return:[0m
[30;1m76 | [0m[35m        """[0m
[30;1m77 | [0m[35m        report_node = GraphNode([0m
[30;1m78 | [0m[35m            key=self.resource_report_key,[0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/report.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35m        return ResourceReport.REPORT_KEY_FORMAT.format(resource_uri=self.resource_uri, report_name=s[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m    def create_next_node(self) -> Union[GraphNode, None]:[0m
[30;1m60 | [0m[35m        # creates new node[0m
[30;1m61 | [0m[35m        try:[0m
[30;1m62 | [0m[35m            return next(self._node_iter)[0m
[30;1m63 | [0m[35m        except StopIteration:[0m
[30;1m64 | [0m[35m            return None[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/hive_table_last_updated_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m317 | [0m[35m             for path in paths][0m
[30;1m318 | [0m[35m        for time_stamp_future in time_stamp_futures:[0m
[30;1m319 | [0m[35m            try:[0m
[30;1m320 | [0m[35m                time_stamp = time_stamp_future.get(timeout=self._fs_worker_timeout)[0m
[30;1m321 | [0m[35m                if time_stamp:[0m
[30;1m322 | [0m[35m                    last_updated = max(time_stamp, last_updated)[0m
[30;1m323 | [0m[35m            except TimeoutError:[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/hive_table_last_updated_extractor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35m# SPDX-License-Identifier: Apache-2.0[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mimport logging[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35mfrom datetime import datetime[0m
[30;1m7 | [0m[35mfrom functools import wraps[0m
[30;1m8 | [0m[35mfrom multiprocessing.pool import ThreadPool[0m
[30;1m9 | [0m[35mfrom typing import ([0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/feast_extractor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m101 | [0m[35m                created_at = datetime.utcfromtimestamp([0m
[30;1m102 | [0m[35m                    feature_view.created_timestamp.timestamp()[0m
[30;1m103 | [0m[35m                )[0m
[30;1m104 | [0m[35m                description = f"* Created at **{created_at}**\n"[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m            if feature_view.tags:[0m
[30;1m107 | [0m[35m                description += "* Tags:\n"[0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/apache_superset/apache_superset_chart_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m        _data = self.execute_query(url)[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m        dashboard_data = _data.get('dashboards', [dict()])[0].get('__Dashboard__', dict())[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m        data = dashboard_id, dashboard_data[0m
[30;1m64 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/apache_superset/apache_superset_chart_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m        _data = self.execute_query(url)[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m        dashboard_data = _data.get('dashboards', [dict()])[0].get('__Dashboard__', dict())[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m        data = dashboard_id, dashboard_data[0m
[30;1m64 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/apache_superset/apache_superset_chart_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m            yield DashboardQuery(**dashboard_query_data)[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m            charts = [s.get('__Slice__') for s in dashboard_data.get('slices', [])][0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m            for chart in charts:[0m
[30;1m49 | [0m[35m                if chart:[0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/apache_superset/apache_superset_chart_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m            yield DashboardQuery(**dashboard_query_data)[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m            charts = [s.get('__Slice__') for s in dashboard_data.get('slices', [])][0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m            for chart in charts:[0m
[30;1m49 | [0m[35m                if chart:[0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/apache_superset/apache_superset_chart_extractor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m33 | [0m[35m            dashboard_id, dashboard_data = entry[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m            # Since Apache Superset doesn't support dashboard <> query <> chart relation we create a[0m
[30;1m36 | [0m[35m            # query node so we can connect charts to a dashboard[0m
[30;1m37 | [0m[35m            dashboard_query_data = dict(dashboard_id=dashboard_id,[0m
[30;1m38 | [0m[35m                                        query_name='default',[0m
[30;1m39 | [0m[35m                                        query_id=self.dummy_query_id,[0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/utils/atlas.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35mclass AtlasSerializedEntityOperation:[0m
[30;1m47 | [0m[35m    CREATE = 'CREATE'[0m
[30;1m48 | [0m[35m    UPDATE = 'UPDATE'[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/atlas_csv_publisher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m316 | [0m[35m[0m
[30;1m317 | [0m[35m    def _render_classification(self, classification_spec: Dict, super_type: bool) -> AtlasClassifica[0m
[30;1m318 | [0m[35m        name = classification_spec.get('category') if super_type else classification_spec.get('name'[0m
[30;1m319 | [0m[35m        sub_types = [classification_spec.get('category')] if not super_type else [][0m
[30;1m320 | [0m[35m[0m
[30;1m321 | [0m[35m        result = AtlasClassificationDef(attrs=dict(name=name,[0m
[30;1m322 | [0m[35m                                                   attributeDefs=[],[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/atlas_csv_publisher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m315 | [0m[35m        return self._render_classification(classification_spec, False)[0m
[30;1m316 | [0m[35m[0m
[30;1m317 | [0m[35m    def _render_classification(self, classification_spec: Dict, super_type: bool) -> AtlasClassifica[0m
[30;1m318 | [0m[35m        name = classification_spec.get('category') if super_type else classification_spec.get('name'[0m
[30;1m319 | [0m[35m        sub_types = [classification_spec.get('category')] if not super_type else [][0m
[30;1m320 | [0m[35m[0m
[30;1m321 | [0m[35m        result = AtlasClassificationDef(attrs=dict(name=name,[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/atlas_csv_publisher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m315 | [0m[35m        return self._render_classification(classification_spec, False)[0m
[30;1m316 | [0m[35m[0m
[30;1m317 | [0m[35m    def _render_classification(self, classification_spec: Dict, super_type: bool) -> AtlasClassifica[0m
[30;1m318 | [0m[35m        name = classification_spec.get('category') if super_type else classification_spec.get('name'[0m
[30;1m319 | [0m[35m        sub_types = [classification_spec.get('category')] if not super_type else [][0m
[30;1m320 | [0m[35m[0m
[30;1m321 | [0m[35m        result = AtlasClassificationDef(attrs=dict(name=name,[0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/atlas_csv_publisher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m293 | [0m[35m[0m
[30;1m294 | [0m[35m        glossary_guid = glossary[AtlasCommonParams.guid][0m
[30;1m295 | [0m[35m[0m
[30;1m296 | [0m[35m        term = next(filter(lambda t: t.get('name') == term_name,[0m
[30;1m297 | [0m[35m                           self._atlas_client.glossary.get_glossary_terms(glossary_guid)))[0m
[30;1m298 | [0m[35m[0m
[30;1m299 | [0m[35m        entity = self._atlas_client.entity.get_entity_by_attribute(entity_type, uniq_attributes=[[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/atlas_csv_publisher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m288 | [0m[35m        entity_type = relationship_spec[AtlasSerializedRelationshipFields.entity_type_1][0m
[30;1m289 | [0m[35m        entity_qn = relationship_spec[AtlasSerializedRelationshipFields.qualified_name_1][0m
[30;1m290 | [0m[35m[0m
[30;1m291 | [0m[35m        glossary = next(filter(lambda g: g.get('name') == glossary_name,[0m
[30;1m292 | [0m[35m                               self._atlas_client.glossary.get_all_glossaries()))[0m
[30;1m293 | [0m[35m[0m
[30;1m294 | [0m[35m        glossary_guid = glossary[AtlasCommonParams.guid][0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/atlas_csv_publisher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m267 | [0m[35m                glossary = self._atlas_client.glossary.create_glossary(glossary_def)[0m
[30;1m268 | [0m[35m            except AtlasServiceException:[0m
[30;1m269 | [0m[35m                LOGGER.info(f'Glossary: {glossary_name} already exists.')[0m
[30;1m270 | [0m[35m                glossary = next(filter(lambda x: x.get('name') == glossary_name,[0m
[30;1m271 | [0m[35m                                       self._atlas_client.glossary.get_all_glossaries()))[0m
[30;1m272 | [0m[35m[0m
[30;1m273 | [0m[35m            glossary_guid = glossary['guid'][0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/atlas_csv_publisher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m259 | [0m[35m    def _create_glossary_terms(self, glossary_terms: List[Dict]) -> None:[0m
[30;1m260 | [0m[35m        for glossary_term_spec in glossary_terms:[0m
[30;1m261 | [0m[35m            glossary_name = glossary_term_spec.get('glossary')[0m
[30;1m262 | [0m[35m            term_name = glossary_term_spec.get('term')[0m
[30;1m263 | [0m[35m[0m
[30;1m264 | [0m[35m            glossary_def = AtlasGlossary({'name': glossary_name, 'shortDescription': ''})[0m
[30;1m265 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/atlas_csv_publisher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m258 | [0m[35m[0m
[30;1m259 | [0m[35m    def _create_glossary_terms(self, glossary_terms: List[Dict]) -> None:[0m
[30;1m260 | [0m[35m        for glossary_term_spec in glossary_terms:[0m
[30;1m261 | [0m[35m            glossary_name = glossary_term_spec.get('glossary')[0m
[30;1m262 | [0m[35m            term_name = glossary_term_spec.get('term')[0m
[30;1m263 | [0m[35m[0m
[30;1m264 | [0m[35m            glossary_def = AtlasGlossary({'name': glossary_name, 'shortDescription': ''})[0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/atlas_csv_publisher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m221 | [0m[35m        type_name = {AtlasCommonParams.type_name: entity_dict[AtlasCommonParams.type_name]}[0m
[30;1m222 | [0m[35m        entity = AtlasEntity(type_name)[0m
[30;1m223 | [0m[35m        entity.attributes = entity_dict[0m
[30;1m224 | [0m[35m        relationships = entity_dict.get(AtlasSerializedEntityFields.relationships)[0m
[30;1m225 | [0m[35m        if relationships:[0m
[30;1m226 | [0m[35m            relations = {}[0m
[30;1m227 | [0m[35m            for relation_attr, rel_type, rel_qn in self._extract_entity_relations_details(relationsh[0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/atlas_csv_publisher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m        self._entity_files = self._list_files(conf, AtlasCSVPublisher.ENTITY_DIR_PATH)[0m
[30;1m50 | [0m[35m        self._relationship_files = self._list_files(conf, AtlasCSVPublisher.RELATIONSHIP_DIR_PATH)[0m
[30;1m51 | [0m[35m        self._config = conf[0m
[30;1m52 | [0m[35m        self._atlas_client = self._config.get(AtlasCSVPublisher.ATLAS_CLIENT)[0m
[30;1m53 | [0m[35m        self._register_entity_types = self._config.get_bool(AtlasCSVPublisher.REGISTER_ENTITY_TYPES,[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m        if self._register_entity_types:[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/atlas_csv_publisher.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m109 | [0m[35m            try:[0m
[30;1m110 | [0m[35m                self._atlas_client.entity.update_entity(existing_entity)[0m
[30;1m111 | [0m[35m            except AtlasServiceException:[0m
[30;1m112 | [0m[35m                LOGGER.error('Fail to update entity', exc_info=True)[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m    def _create_relations(self, relation_file: str) -> None:[0m
[30;1m115 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/tableau/tableau_external_table_extractor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m67 | [0m[35m        Salesforce connections[0m
[30;1m68 | [0m[35m        Google Sheets connections[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    Excel spreadsheets, Salesforce connections, and Google Sheets connections are all classified as[0m
[30;1m71 | [0m[35m    "databases" in terms of Tableau's Metadata API, with their "subsheets" forming their "tables" wh[0m
[30;1m72 | [0m[35m    present. However, these tables are not assigned a schema, this extractor chooses to use the name[0m
[30;1m73 | [0m[35m    parent sheet as the schema, and assign a new table to each subsheet. The connection type is[0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/tableau/tableau_external_table_extractor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m62 | [0m[35m    In this context, "external" tables are "tables" that are not from a typical database, and are lo[0m
[30;1m63 | [0m[35m    using some other data format, like CSV files.[0m
[30;1m64 | [0m[35m    This extractor has been tested with the following types of external tables:[0m
[30;1m65 | [0m[35m        Excel spreadsheets[0m
[30;1m66 | [0m[35m        Text files (including CSV files)[0m
[30;1m67 | [0m[35m        Salesforce connections[0m
[30;1m68 | [0m[35m        Google Sheets connections[0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/table_lineage.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m    def _create_node_iterator(self) -> Iterator[GraphNode]:[0m
[30;1m55 | [0m[35m        """[0m
[30;1m56 | [0m[35m        It won't create any node for this model[0m
[30;1m57 | [0m[35m        :return:[0m
[30;1m58 | [0m[35m        """[0m
[30;1m59 | [0m[35m        return[0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/tableau/tableau_dashboard_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m52 | [0m[35m            data = {[0m
[30;1m53 | [0m[35m                'dashboard_group': workbook['projectName'],[0m
[30;1m54 | [0m[35m                'dashboard_name': TableauDashboardUtils.sanitize_workbook_name(workbook['name']),[0m
[30;1m55 | [0m[35m                'description': workbook.get('description', ''),[0m
[30;1m56 | [0m[35m                'created_timestamp': workbook['createdAt'],[0m
[30;1m57 | [0m[35m                'dashboard_group_url': f'{base_url}/#{site_url_path}/projects/{workbook["projectVizp[0m
[30;1m58 | [0m[35m                'dashboard_url': f'{base_url}/#{site_url_path}/workbooks/{workbook["vizportalUrlId"][0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/tableau/tableau_dashboard_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m39 | [0m[35m        workbooks_data = [workbook for workbook in response['workbooks'][0m
[30;1m40 | [0m[35m                          if workbook['projectName'] not in[0m
[30;1m41 | [0m[35m                          self._conf.get_list(TableauGraphQLApiMetadataExtractor.EXCLUDED_PROJECTS, [0m
[30;1m42 | [0m[35m        base_url = self._conf.get(TableauGraphQLApiMetadataExtractor.TABLEAU_BASE_URL)[0m
[30;1m43 | [0m[35m        site_name = self._conf.get_string(TableauGraphQLApiMetadataExtractor.SITE_NAME, '')[0m
[30;1m44 | [0m[35m        site_url_path = ''[0m
[30;1m45 | [0m[35m        if site_name != '':[0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/amundsen_databuilder-7.5.1.dist-info/NOTICE[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35mamundsendatabuilder[0m
[30;1m2 | [0m[35mCopyright 2018-2019 Lyft Inc.[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mThis product includes software developed at Lyft Inc.[0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/presto_view_metadata_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m127 | [0m[35m        # view_original_text is b64 encoded:[0m
[30;1m128 | [0m[35m        # https://github.com/prestodb/presto/blob/43bd519052ba4c56ff1f4fc807075637ab5f4f10/presto-hi[0m
[30;1m129 | [0m[35m        decoded_view_info = base64.b64decode(encoded_view_info)[0m
[30;1m130 | [0m[35m        columns = json.loads(decoded_view_info).get('columns')[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m        return [ColumnMetadata(name=column['name'],[0m
[30;1m133 | [0m[35m                               description=None,[0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/presto_view_metadata_extractor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# Copyright Contributors to the Amundsen project.[0m
[30;1m2 | [0m[35m# SPDX-License-Identifier: Apache-2.0[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mimport base64[0m
[30;1m5 | [0m[35mimport json[0m
[30;1m6 | [0m[35mimport logging[0m
[30;1m7 | [0m[35mfrom typing import ([0m
[30;1m8 | [0m[35m    Iterator, List, Union,[0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/transformer/generic_transformer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m20 | [0m[35m    """[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m    def init(self, conf: ConfigTree) -> None:[0m
[30;1m23 | [0m[35m        self._callback_function = conf.get(CALLBACK_FUNCTION)[0m
[30;1m24 | [0m[35m        self._field_name = conf.get_string(FIELD_NAME)[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    def transform(self, record: Dict[str, Any]) -> Dict[str, Any]:[0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/tableau/tableau_dashboard_last_modified_extractor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m114 | [0m[35m    def _build_extractor(self) -> TableauGraphQLApiLastModifiedExtractor:[0m
[30;1m115 | [0m[35m        """[0m
[30;1m116 | [0m[35m        Builds a TableauGraphQLApiExtractor. All data required can be retrieved with a single GraphQ[0m
[30;1m117 | [0m[35m        :return: A TableauGraphQLApiLastModifiedExtractor that provides dashboard update metadata.[0m
[30;1m118 | [0m[35m        """[0m
[30;1m119 | [0m[35m        extractor = TableauGraphQLApiLastModifiedExtractor()[0m
[30;1m120 | [0m[35m        tableau_extractor_conf = \[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/tableau/tableau_dashboard_last_modified_extractor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35mclass TableauDashboardLastModifiedExtractor(Extractor):[0m
[30;1m56 | [0m[35m    """[0m
[30;1m57 | [0m[35m    Extracts metadata about the time of last update for Tableau dashboards.[0m
[30;1m58 | [0m[35m    For the purposes of this extractor, Tableau "workbooks" are mapped to Amundsen dashboards, and t[0m
[30;1m59 | [0m[35m    top-level project in which these workbooks preside is the dashboard group. The metadata it gathe[0m
[30;1m60 | [0m[35m        Dashboard last modified timestamp (Workbook last modified timestamp)[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/tableau/tableau_dashboard_last_modified_extractor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35mclass TableauDashboardLastModifiedExtractor(Extractor):[0m
[30;1m56 | [0m[35m    """[0m
[30;1m57 | [0m[35m    Extracts metadata about the time of last update for Tableau dashboards.[0m
[30;1m58 | [0m[35m    For the purposes of this extractor, Tableau "workbooks" are mapped to Amundsen dashboards, and t[0m
[30;1m59 | [0m[35m    top-level project in which these workbooks preside is the dashboard group. The metadata it gathe[0m
[30;1m60 | [0m[35m        Dashboard last modified timestamp (Workbook last modified timestamp)[0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/table_metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m459 | [0m[35m                badges=col.badges)[0m
[30;1m460 | [0m[35m            badge_nodes = col_badge_metadata.get_badge_nodes()[0m
[30;1m461 | [0m[35m            for node in badge_nodes:[0m
[30;1m462 | [0m[35m                yield node[0m
[30;1m463 | [0m[35m[0m
[30;1m464 | [0m[35m        type_metadata = col.get_type_metadata()[0m
[30;1m465 | [0m[35m        if type_metadata:[0m
[30;1m466 | [0m[35m            yield from type_metadata.create_node_iterator()[0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/table_metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m458 | [0m[35m                start_key=self._get_col_key(col),[0m
[30;1m459 | [0m[35m                badges=col.badges)[0m
[30;1m460 | [0m[35m            badge_nodes = col_badge_metadata.get_badge_nodes()[0m
[30;1m461 | [0m[35m            for node in badge_nodes:[0m
[30;1m462 | [0m[35m                yield node[0m
[30;1m463 | [0m[35m[0m
[30;1m464 | [0m[35m        type_metadata = col.get_type_metadata()[0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/table_metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m    def _create_node_iterator(self) -> Iterator[GraphNode]:[0m
[30;1m125 | [0m[35m        node = self.get_node()[0m
[30;1m126 | [0m[35m        yield node[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    def _create_relation_iterator(self) -> Iterator[GraphRelationship]:[0m
[30;1m129 | [0m[35m        return[0m
[30;1m130 | [0m[35m        yield[0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/table_metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m122 | [0m[35m            return None[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m    def _create_node_iterator(self) -> Iterator[GraphNode]:[0m
[30;1m125 | [0m[35m        node = self.get_node()[0m
[30;1m126 | [0m[35m        yield node[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    def _create_relation_iterator(self) -> Iterator[GraphRelationship]:[0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/table_metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m92 | [0m[35m                TagMetadata.TAG_TYPE: self._tag_type[0m
[30;1m93 | [0m[35m            }[0m
[30;1m94 | [0m[35m        )[0m
[30;1m95 | [0m[35m        return node[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m    def get_record(self) -> RDSModel:[0m
[30;1m98 | [0m[35m        record = RDSTag([0m
[30;1m99 | [0m[35m            rk=TagMetadata.get_tag_key(self._name),[0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/table_metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m85 | [0m[35m        return TagMetadata.TAG_KEY_FORMAT.format(tag=name)[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m    def get_node(self) -> GraphNode:[0m
[30;1m88 | [0m[35m        node = GraphNode([0m
[30;1m89 | [0m[35m            key=TagMetadata.get_tag_key(self._name),[0m
[30;1m90 | [0m[35m            label=TagMetadata.TAG_NODE_LABEL,[0m
[30;1m91 | [0m[35m            attributes={[0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/bigquery_usage_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m139 | [0m[35m                                            column='*',[0m
[30;1m140 | [0m[35m                                            email=email)[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m            new_count = self.table_usage_counts.get(key, 0) + 1[0m
[30;1m143 | [0m[35m            self.table_usage_counts[key] = new_count[0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35m    def _retrieve_records(self) -> Iterator[Optional[Dict]]:[0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/bigquery_usage_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m        for refResource in refResources:[0m
[30;1m111 | [0m[35m            tableId = refResource.get('tableId')[0m
[30;1m112 | [0m[35m            datasetId = refResource.get('datasetId')[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m            if not datasetId or not tableId:[0m
[30;1m115 | [0m[35m                # handling case when the referenced table is an external table[0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/bigquery_usage_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m108 | [0m[35m            return[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m        for refResource in refResources:[0m
[30;1m111 | [0m[35m            tableId = refResource.get('tableId')[0m
[30;1m112 | [0m[35m            datasetId = refResource.get('datasetId')[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m            if not datasetId or not tableId:[0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/bigquery_usage_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m88 | [0m[35m                        job['jobStatistics']['totalTablesProcessed'], email,[0m
[30;1m89 | [0m[35m                        job['jobName']['jobId'])[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m            refViews = job['jobStatistics'].get('referencedViews', None)[0m
[30;1m92 | [0m[35m            if refViews:[0m
[30;1m93 | [0m[35m                if 'totalViewsProcessed' in job['jobStatistics']:[0m
[30;1m94 | [0m[35m                    self._create_records([0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/bigquery_usage_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m80 | [0m[35m            # case, referencedTables has been observed to be empty:[0m
[30;1m81 | [0m[35m            # https://cloud.google.com/logging/docs/reference/audit/bigquery/rest/Shared.Types/Audit[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m            refTables = job['jobStatistics'].get('referencedTables', None)[0m
[30;1m84 | [0m[35m            if refTables:[0m
[30;1m85 | [0m[35m                if 'totalTablesProcessed' in job['jobStatistics']:[0m
[30;1m86 | [0m[35m                    self._create_records([0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/bigquery_usage_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m70 | [0m[35m            if job['jobStatus']['state'] != 'DONE':[0m
[30;1m71 | [0m[35m                # This job seems not to have finished yet, so we ignore it.[0m
[30;1m72 | [0m[35m                continue[0m
[30;1m73 | [0m[35m            if len(job['jobStatus'].get('error', {})) > 0:[0m
[30;1m74 | [0m[35m                # This job has errors, so we ignore it[0m
[30;1m75 | [0m[35m                continue[0m
[30;1m76 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/bigquery_usage_extractor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35m    def _retrieve_records(self) -> Iterator[Optional[Dict]]:[0m
[30;1m146 | [0m[35m        """[0m
[30;1m147 | [0m[35m        Extracts bigquery log data by looking at the principalEmail in the authenticationInfo block [0m
[30;1m148 | [0m[35m        referencedTables in the jobStatistics and filters out log entries of metadata queries.[0m
[30;1m149 | [0m[35m        :return: Provides a record or None if no more to extract[0m
[30;1m150 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/bigquery_usage_extractor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mfrom datetime import ([0m
[30;1m8 | [0m[35m    datetime, timedelta, timezone,[0m
[30;1m9 | [0m[35m)[0m
[30;1m10 | [0m[35mfrom time import sleep[0m
[30;1m11 | [0m[35mfrom typing import ([0m
[30;1m12 | [0m[35m    Any, Dict, Iterator, List, Optional, Tuple,[0m
[30;1m13 | [0m[35m)[0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m415 | [0m[35m                    atlas_values = [][0m
[30;1m416 | [0m[35m                    for atlas_field_path in atlas_fields_paths:[0m
[30;1m417 | [0m[35m[0m
[30;1m418 | [0m[35m                        atlas_value = reduce(lambda x, y: x.get(y, dict()), atlas_field_path.split('[0m
[30;1m419 | [0m[35m                                             data) or default_value[0m
[30;1m420 | [0m[35m                        atlas_values.append(atlas_value)[0m
[30;1m421 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m309 | [0m[35m        entity_metrics = self._get_latest_entity_metrics()[0m
[30;1m310 | [0m[35m[0m
[30;1m311 | [0m[35m        if entity_metrics:[0m
[30;1m312 | [0m[35m            count = entity_metrics.get('entityActive-typeAndSubTypes', dict()).get(self.entity_type,[0m
[30;1m313 | [0m[35m[0m
[30;1m314 | [0m[35m            return int(count)[0m
[30;1m315 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m309 | [0m[35m        entity_metrics = self._get_latest_entity_metrics()[0m
[30;1m310 | [0m[35m[0m
[30;1m311 | [0m[35m        if entity_metrics:[0m
[30;1m312 | [0m[35m            count = entity_metrics.get('entityActive-typeAndSubTypes', dict()).get(self.entity_type,[0m
[30;1m313 | [0m[35m[0m
[30;1m314 | [0m[35m            return int(count)[0m
[30;1m315 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m273 | [0m[35m[0m
[30;1m274 | [0m[35m    @property[0m
[30;1m275 | [0m[35m    def relationships(self) -> Optional[List[str]]:[0m
[30;1m276 | [0m[35m        return AtlasSearchDataExtractor.REQUIRED_RELATIONSHIPS_BY_TYPE.get(self.entity_type)  # type[0m
[30;1m277 | [0m[35m[0m
[30;1m278 | [0m[35m    def extract(self) -> Any:[0m
[30;1m279 | [0m[35m        if not self._extract_iter:[0m

[31m--[ [0m[34mMatch #[0m[33m232[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35m    @property[0m
[30;1m267 | [0m[35m    def field_mappings(self) -> type_fields_mapping:[0m
[30;1m268 | [0m[35m        return AtlasSearchDataExtractor.FIELDS_MAPPING_SPEC.get(self.entity_type) or [][0m
[30;1m269 | [0m[35m[0m
[30;1m270 | [0m[35m    @property[0m
[30;1m271 | [0m[35m    def search_chunk_size(self) -> int:[0m

[31m--[ [0m[34mMatch #[0m[33m233[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35m    @property[0m
[30;1m257 | [0m[35m    def model_class(self) -> Any:[0m
[30;1m258 | [0m[35m        model_class = AtlasSearchDataExtractor.ENTITY_MODEL_BY_TYPE.get(self.entity_type)[0m
[30;1m259 | [0m[35m[0m
[30;1m260 | [0m[35m        if model_class:[0m
[30;1m261 | [0m[35m            module_name, class_name = model_class.rsplit(".", 1)[0m

[31m--[ [0m[34mMatch #[0m[33m234[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m241 | [0m[35m[0m
[30;1m242 | [0m[35m    @property[0m
[30;1m243 | [0m[35m    def entity_type(self) -> str:[0m
[30;1m244 | [0m[35m        return self.conf.get(AtlasSearchDataExtractor.ENTITY_TYPE_KEY)[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m    @property[0m
[30;1m247 | [0m[35m    def dsl_search_query(self) -> Dict:[0m

[31m--[ [0m[34mMatch #[0m[33m235[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m113 | [0m[35m                                                         dict()).get('relationshipStatus', '')[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m            if reader_status == entity_status == relationship_status == 'ACTIVE':[0m
[30;1m116 | [0m[35m                score += reader.get('attributes', dict()).get('count', 0)[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m                if score > 0:[0m
[30;1m119 | [0m[35m                    unique += 1[0m

[31m--[ [0m[34mMatch #[0m[33m236[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m113 | [0m[35m                                                         dict()).get('relationshipStatus', '')[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m            if reader_status == entity_status == relationship_status == 'ACTIVE':[0m
[30;1m116 | [0m[35m                score += reader.get('attributes', dict()).get('count', 0)[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m                if score > 0:[0m
[30;1m119 | [0m[35m                    unique += 1[0m

[31m--[ [0m[34mMatch #[0m[33m237[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m110 | [0m[35m            entity_status = reader.get('relationshipAttributes', dict()).get('entity', dict()).get('[0m
[30;1m111 | [0m[35m            relationship_status = reader.get('relationshipAttributes',[0m
[30;1m112 | [0m[35m                                             dict()).get('entity',[0m
[30;1m113 | [0m[35m                                                         dict()).get('relationshipStatus', '')[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m            if reader_status == entity_status == relationship_status == 'ACTIVE':[0m
[30;1m116 | [0m[35m                score += reader.get('attributes', dict()).get('count', 0)[0m

[31m--[ [0m[34mMatch #[0m[33m238[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m109 | [0m[35m            reader_status = reader.get('status')[0m
[30;1m110 | [0m[35m            entity_status = reader.get('relationshipAttributes', dict()).get('entity', dict()).get('[0m
[30;1m111 | [0m[35m            relationship_status = reader.get('relationshipAttributes',[0m
[30;1m112 | [0m[35m                                             dict()).get('entity',[0m
[30;1m113 | [0m[35m                                                         dict()).get('relationshipStatus', '')[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m            if reader_status == entity_status == relationship_status == 'ACTIVE':[0m

[31m--[ [0m[34mMatch #[0m[33m239[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m108 | [0m[35m        for reader in readers:[0m
[30;1m109 | [0m[35m            reader_status = reader.get('status')[0m
[30;1m110 | [0m[35m            entity_status = reader.get('relationshipAttributes', dict()).get('entity', dict()).get('[0m
[30;1m111 | [0m[35m            relationship_status = reader.get('relationshipAttributes',[0m
[30;1m112 | [0m[35m                                             dict()).get('entity',[0m
[30;1m113 | [0m[35m                                                         dict()).get('relationshipStatus', '')[0m
[30;1m114 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m240[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35m        for reader in readers:[0m
[30;1m109 | [0m[35m            reader_status = reader.get('status')[0m
[30;1m110 | [0m[35m            entity_status = reader.get('relationshipAttributes', dict()).get('entity', dict()).get('[0m
[30;1m111 | [0m[35m            relationship_status = reader.get('relationshipAttributes',[0m
[30;1m112 | [0m[35m                                             dict()).get('entity',[0m
[30;1m113 | [0m[35m                                                         dict()).get('relationshipStatus', '')[0m

[31m--[ [0m[34mMatch #[0m[33m241[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35m        for reader in readers:[0m
[30;1m109 | [0m[35m            reader_status = reader.get('status')[0m
[30;1m110 | [0m[35m            entity_status = reader.get('relationshipAttributes', dict()).get('entity', dict()).get('[0m
[30;1m111 | [0m[35m            relationship_status = reader.get('relationshipAttributes',[0m
[30;1m112 | [0m[35m                                             dict()).get('entity',[0m
[30;1m113 | [0m[35m                                                         dict()).get('relationshipStatus', '')[0m

[31m--[ [0m[34mMatch #[0m[33m242[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35m        for reader in readers:[0m
[30;1m109 | [0m[35m            reader_status = reader.get('status')[0m
[30;1m110 | [0m[35m            entity_status = reader.get('relationshipAttributes', dict()).get('entity', dict()).get('[0m
[30;1m111 | [0m[35m            relationship_status = reader.get('relationshipAttributes',[0m
[30;1m112 | [0m[35m                                             dict()).get('entity',[0m
[30;1m113 | [0m[35m                                                         dict()).get('relationshipStatus', '')[0m

[31m--[ [0m[34mMatch #[0m[33m243[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m106 | [0m[35m        unique = 0[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35m        for reader in readers:[0m
[30;1m109 | [0m[35m            reader_status = reader.get('status')[0m
[30;1m110 | [0m[35m            entity_status = reader.get('relationshipAttributes', dict()).get('entity', dict()).get('[0m
[30;1m111 | [0m[35m            relationship_status = reader.get('relationshipAttributes',[0m
[30;1m112 | [0m[35m                                             dict()).get('entity',[0m

[31m--[ [0m[34mMatch #[0m[33m244[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m96 | [0m[35m    def get_source_description(parameters: Optional[dict]) -> str:[0m
[30;1m97 | [0m[35m        parameters = parameters or dict()[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m        return parameters.get('sourceDescription', '')[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m    @staticmethod[0m
[30;1m102 | [0m[35m    def get_usage(readers: Optional[List]) -> Tuple[int, int]:[0m

[31m--[ [0m[34mMatch #[0m[33m245[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m    @staticmethod[0m
[30;1m90 | [0m[35m    def get_table_database(table_key: str) -> str:[0m
[30;1m91 | [0m[35m        result = AtlasTableKey(table_key).get_details().get('database', 'hive_table')[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m        return result[0m
[30;1m94 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m246[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m        charts = [][0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m        for query in queries:[0m
[30;1m84 | [0m[35m            _charts = query.get('relationshipAttributes', dict()).get('charts', [])[0m
[30;1m85 | [0m[35m            charts += _charts[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m        return AtlasSearchDataExtractorHelpers.get_display_text(charts)[0m

[31m--[ [0m[34mMatch #[0m[33m247[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m        charts = [][0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m        for query in queries:[0m
[30;1m84 | [0m[35m            _charts = query.get('relationshipAttributes', dict()).get('charts', [])[0m
[30;1m85 | [0m[35m            charts += _charts[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m        return AtlasSearchDataExtractorHelpers.get_display_text(charts)[0m

[31m--[ [0m[34mMatch #[0m[33m248[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m        executions = executions or [][0m
[30;1m69 | [0m[35m        successful_executions = AtlasSearchDataExtractorHelpers._filter_none([0m
[30;1m70 | [0m[35m            [e.get('attributes').get('timestamp') for e in executions[0m
[30;1m71 | [0m[35m             if e.get('status', '').lower() == 'active' and e.get('attributes', dict()).get('state')[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m        try:[0m
[30;1m74 | [0m[35m            return max(successful_executions)[0m

[31m--[ [0m[34mMatch #[0m[33m249[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m        executions = executions or [][0m
[30;1m69 | [0m[35m        successful_executions = AtlasSearchDataExtractorHelpers._filter_none([0m
[30;1m70 | [0m[35m            [e.get('attributes').get('timestamp') for e in executions[0m
[30;1m71 | [0m[35m             if e.get('status', '').lower() == 'active' and e.get('attributes', dict()).get('state')[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m        try:[0m
[30;1m74 | [0m[35m            return max(successful_executions)[0m

[31m--[ [0m[34mMatch #[0m[33m250[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m        executions = executions or [][0m
[30;1m69 | [0m[35m        successful_executions = AtlasSearchDataExtractorHelpers._filter_none([0m
[30;1m70 | [0m[35m            [e.get('attributes').get('timestamp') for e in executions[0m
[30;1m71 | [0m[35m             if e.get('status', '').lower() == 'active' and e.get('attributes', dict()).get('state')[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m        try:[0m
[30;1m74 | [0m[35m            return max(successful_executions)[0m

[31m--[ [0m[34mMatch #[0m[33m251[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m    def get_last_successful_execution_timestamp(executions: Optional[List]) -> int:[0m
[30;1m68 | [0m[35m        executions = executions or [][0m
[30;1m69 | [0m[35m        successful_executions = AtlasSearchDataExtractorHelpers._filter_none([0m
[30;1m70 | [0m[35m            [e.get('attributes').get('timestamp') for e in executions[0m
[30;1m71 | [0m[35m             if e.get('status', '').lower() == 'active' and e.get('attributes', dict()).get('state')[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m252[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m    def get_last_successful_execution_timestamp(executions: Optional[List]) -> int:[0m
[30;1m68 | [0m[35m        executions = executions or [][0m
[30;1m69 | [0m[35m        successful_executions = AtlasSearchDataExtractorHelpers._filter_none([0m
[30;1m70 | [0m[35m            [e.get('attributes').get('timestamp') for e in executions[0m
[30;1m71 | [0m[35m             if e.get('status', '').lower() == 'active' and e.get('attributes', dict()).get('state')[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m253[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m    def get_display_text(meanings: Optional[List]) -> List:[0m
[30;1m62 | [0m[35m        meanings = meanings or [][0m
[30;1m63 | [0m[35m        return AtlasSearchDataExtractorHelpers._filter_none([0m
[30;1m64 | [0m[35m            [c.get('displayText') for c in meanings if c.get('entityStatus', '').lower() == 'active'[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m    @staticmethod[0m
[30;1m67 | [0m[35m    def get_last_successful_execution_timestamp(executions: Optional[List]) -> int:[0m

[31m--[ [0m[34mMatch #[0m[33m254[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m    def get_display_text(meanings: Optional[List]) -> List:[0m
[30;1m62 | [0m[35m        meanings = meanings or [][0m
[30;1m63 | [0m[35m        return AtlasSearchDataExtractorHelpers._filter_none([0m
[30;1m64 | [0m[35m            [c.get('displayText') for c in meanings if c.get('entityStatus', '').lower() == 'active'[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m    @staticmethod[0m
[30;1m67 | [0m[35m    def get_last_successful_execution_timestamp(executions: Optional[List]) -> int:[0m

[31m--[ [0m[34mMatch #[0m[33m255[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m    def get_badges_from_classifications(classifications: Optional[List]) -> List:[0m
[30;1m56 | [0m[35m        classifications = classifications or [][0m
[30;1m57 | [0m[35m        return AtlasSearchDataExtractorHelpers._filter_none([0m
[30;1m58 | [0m[35m            [c.get('typeName') for c in classifications if c.get('entityStatus', '').lower() == 'act[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    @staticmethod[0m
[30;1m61 | [0m[35m    def get_display_text(meanings: Optional[List]) -> List:[0m

[31m--[ [0m[34mMatch #[0m[33m256[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m    def get_badges_from_classifications(classifications: Optional[List]) -> List:[0m
[30;1m56 | [0m[35m        classifications = classifications or [][0m
[30;1m57 | [0m[35m        return AtlasSearchDataExtractorHelpers._filter_none([0m
[30;1m58 | [0m[35m            [c.get('typeName') for c in classifications if c.get('entityStatus', '').lower() == 'act[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    @staticmethod[0m
[30;1m61 | [0m[35m    def get_display_text(meanings: Optional[List]) -> List:[0m

[31m--[ [0m[34mMatch #[0m[33m257[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m        entity_list = entity_list or [][0m
[30;1m50 | [0m[35m        return AtlasSearchDataExtractorHelpers._filter_none([0m
[30;1m51 | [0m[35m            [e.get('attributes', dict()).get('description') for e in entity_list[0m
[30;1m52 | [0m[35m             if e.get('status').lower() == 'active'])[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m    @staticmethod[0m
[30;1m55 | [0m[35m    def get_badges_from_classifications(classifications: Optional[List]) -> List:[0m

[31m--[ [0m[34mMatch #[0m[33m258[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m48 | [0m[35m    def get_entity_descriptions(entity_list: Optional[List]) -> List:[0m
[30;1m49 | [0m[35m        entity_list = entity_list or [][0m
[30;1m50 | [0m[35m        return AtlasSearchDataExtractorHelpers._filter_none([0m
[30;1m51 | [0m[35m            [e.get('attributes', dict()).get('description') for e in entity_list[0m
[30;1m52 | [0m[35m             if e.get('status').lower() == 'active'])[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m    @staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m259[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m48 | [0m[35m    def get_entity_descriptions(entity_list: Optional[List]) -> List:[0m
[30;1m49 | [0m[35m        entity_list = entity_list or [][0m
[30;1m50 | [0m[35m        return AtlasSearchDataExtractorHelpers._filter_none([0m
[30;1m51 | [0m[35m            [e.get('attributes', dict()).get('description') for e in entity_list[0m
[30;1m52 | [0m[35m             if e.get('status').lower() == 'active'])[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m    @staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m260[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m37 | [0m[35m    def get_entity_names(entity_list: Optional[List]) -> List:[0m
[30;1m38 | [0m[35m        entity_list = entity_list or [][0m
[30;1m39 | [0m[35m        return AtlasSearchDataExtractorHelpers._filter_none([0m
[30;1m40 | [0m[35m            [e.get('attributes').get('name') for e in entity_list if e.get('status').lower() == 'act[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m    @staticmethod[0m
[30;1m43 | [0m[35m    def get_entity_uri(qualified_name: str, type_name: str) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m261[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m37 | [0m[35m    def get_entity_names(entity_list: Optional[List]) -> List:[0m
[30;1m38 | [0m[35m        entity_list = entity_list or [][0m
[30;1m39 | [0m[35m        return AtlasSearchDataExtractorHelpers._filter_none([0m
[30;1m40 | [0m[35m            [e.get('attributes').get('name') for e in entity_list if e.get('status').lower() == 'act[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m    @staticmethod[0m
[30;1m43 | [0m[35m    def get_entity_uri(qualified_name: str, type_name: str) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m262[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/atlas_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m37 | [0m[35m    def get_entity_names(entity_list: Optional[List]) -> List:[0m
[30;1m38 | [0m[35m        entity_list = entity_list or [][0m
[30;1m39 | [0m[35m        return AtlasSearchDataExtractorHelpers._filter_none([0m
[30;1m40 | [0m[35m            [e.get('attributes').get('name') for e in entity_list if e.get('status').lower() == 'act[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m    @staticmethod[0m
[30;1m43 | [0m[35m    def get_entity_uri(qualified_name: str, type_name: str) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m263[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_last_updated_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m23 | [0m[35m        """[0m
[30;1m24 | [0m[35m        self.conf = conf[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m        model_class = conf.get('model_class', None)[0m
[30;1m27 | [0m[35m        if model_class:[0m
[30;1m28 | [0m[35m            module_name, class_name = model_class.rsplit(".", 1)[0m
[30;1m29 | [0m[35m            mod = importlib.import_module(module_name)[0m

[31m--[ [0m[34mMatch #[0m[33m264[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_last_updated_extractor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35m# SPDX-License-Identifier: Apache-2.0[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mimport importlib[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35mfrom typing import Any[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mfrom pyhocon import ConfigTree[0m
[30;1m9 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m265[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/mode_analytics/mode_dashboard_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m        record = self._extractor.extract()[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m        # determine whether we want to skip these records[0m
[30;1m88 | [0m[35m        while record and record.get('dashboard_group_id') in self.dashboard_group_ids_to_skip:[0m
[30;1m89 | [0m[35m            record = self._extractor.extract()[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m        if not record:[0m

[31m--[ [0m[34mMatch #[0m[33m266[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/badge.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m147 | [0m[35m        """[0m
[30;1m148 | [0m[35m        nodes = self.get_badge_nodes()[0m
[30;1m149 | [0m[35m        for node in nodes:[0m
[30;1m150 | [0m[35m            yield node[0m
[30;1m151 | [0m[35m[0m
[30;1m152 | [0m[35m    def _create_relation_iterator(self) -> Iterator[GraphRelationship]:[0m
[30;1m153 | [0m[35m        relations = self.get_badge_relations()[0m
[30;1m154 | [0m[35m        for relation in relations:[0m

[31m--[ [0m[34mMatch #[0m[33m267[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/badge.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m146 | [0m[35m        :return:[0m
[30;1m147 | [0m[35m        """[0m
[30;1m148 | [0m[35m        nodes = self.get_badge_nodes()[0m
[30;1m149 | [0m[35m        for node in nodes:[0m
[30;1m150 | [0m[35m            yield node[0m
[30;1m151 | [0m[35m[0m
[30;1m152 | [0m[35m    def _create_relation_iterator(self) -> Iterator[GraphRelationship]:[0m

[31m--[ [0m[34mMatch #[0m[33m268[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/badge.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m103 | [0m[35m        nodes = [][0m
[30;1m104 | [0m[35m        for badge in self.badges:[0m
[30;1m105 | [0m[35m            if badge:[0m
[30;1m106 | [0m[35m                node = GraphNode([0m
[30;1m107 | [0m[35m                    key=self.get_badge_key(badge.name),[0m
[30;1m108 | [0m[35m                    label=self.BADGE_NODE_LABEL,[0m
[30;1m109 | [0m[35m                    attributes={[0m

[31m--[ [0m[34mMatch #[0m[33m269[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/graph_serializable.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m66 | [0m[35m        return relation_dict[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m    def _validate_node(self, node: GraphNode) -> None:[0m
[30;1m69 | [0m[35m        node_id, node_label, _ = node[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m        if node_id is None:[0m
[30;1m72 | [0m[35m            raise RuntimeError('Required header missing. Required attributes id and label , Missing:[0m
[30;1m73 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m270[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/graph_serializable.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35mclass GraphSerializable(object, metaclass=abc.ABCMeta):[0m
[30;1m22 | [0m[35m    """[0m
[30;1m23 | [0m[35m    A Serializable abstract class asks subclass to implement next node or[0m
[30;1m24 | [0m[35m    next relation in dict form so that it can be serialized to CSV file.[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    Any model class that needs to be pushed to a graph database should inherit this class.[0m

[31m--[ [0m[34mMatch #[0m[33m271[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_metadata_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m            if self._extract_technical_details:[0m
[30;1m54 | [0m[35m                _settings = index_metadata.get('settings', dict())[0m
[30;1m55 | [0m[35m                _aliases = index_metadata.get('aliases', dict())[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m                settings = self._render_programmatic_description(_settings)[0m
[30;1m58 | [0m[35m                aliases = self._render_programmatic_description(_aliases)[0m

[31m--[ [0m[34mMatch #[0m[33m272[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_metadata_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m51 | [0m[35m            yield table_metadata[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m            if self._extract_technical_details:[0m
[30;1m54 | [0m[35m                _settings = index_metadata.get('settings', dict())[0m
[30;1m55 | [0m[35m                _aliases = index_metadata.get('aliases', dict())[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m                settings = self._render_programmatic_description(_settings)[0m

[31m--[ [0m[34mMatch #[0m[33m273[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/databricks_sql/databricks_sql_dashboard_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m    def row_and_col(widget: Dict[str, Any]) -> Tuple[Any, Any]:[0m
[30;1m78 | [0m[35m        # these entities usually but not always have explicit rows and cols[0m
[30;1m79 | [0m[35m        pos = widget["options"].get("position", {})[0m
[30;1m80 | [0m[35m        return (pos.get("row", 0), pos.get("col", 0))[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m    return sorted(widgets, key=row_and_col)[0m
[30;1m83 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m274[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/databricks_sql/databricks_sql_dashboard_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m    def row_and_col(widget: Dict[str, Any]) -> Tuple[Any, Any]:[0m
[30;1m78 | [0m[35m        # these entities usually but not always have explicit rows and cols[0m
[30;1m79 | [0m[35m        pos = widget["options"].get("position", {})[0m
[30;1m80 | [0m[35m        return (pos.get("row", 0), pos.get("col", 0))[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m    return sorted(widgets, key=row_and_col)[0m
[30;1m83 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m275[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/databricks_sql/databricks_sql_dashboard_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m    def row_and_col(widget: Dict[str, Any]) -> Tuple[Any, Any]:[0m
[30;1m78 | [0m[35m        # these entities usually but not always have explicit rows and cols[0m
[30;1m79 | [0m[35m        pos = widget["options"].get("position", {})[0m
[30;1m80 | [0m[35m        return (pos.get("row", 0), pos.get("col", 0))[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m    return sorted(widgets, key=row_and_col)[0m

[31m--[ [0m[34mMatch #[0m[33m276[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/databricks_sql/databricks_sql_dashboard_utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m71 | [0m[35m    Sort raw widget data (as returned from the API) according to the position[0m
[30;1m72 | [0m[35m    of the widgets in the dashboard (top to bottom, left to right)[0m
[30;1m73 | [0m[35m    Redash does not return widgets in order of their position,[0m
[30;1m74 | [0m[35m    so we do this to ensure that we look at widgets in a sensible order.[0m
[30;1m75 | [0m[35m    """[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m    def row_and_col(widget: Dict[str, Any]) -> Tuple[Any, Any]:[0m

[31m--[ [0m[34mMatch #[0m[33m277[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/databricks_sql/databricks_sql_dashboard_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35mdef sort_widgets(widgets: Iterable[Dict[str, Any]]) -> List[Dict[str, Any]]:[0m
[30;1m70 | [0m[35m    """[0m
[30;1m71 | [0m[35m    Sort raw widget data (as returned from the API) according to the position[0m
[30;1m72 | [0m[35m    of the widgets in the dashboard (top to bottom, left to right)[0m
[30;1m73 | [0m[35m    Redash does not return widgets in order of their position,[0m
[30;1m74 | [0m[35m    so we do this to ensure that we look at widgets in a sensible order.[0m

[31m--[ [0m[34mMatch #[0m[33m278[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/table_last_updated.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m128 | [0m[35m        yield record[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m    # Atlas automatically updates `updateTime` of an entity if it's changed (along with storing audi[0m
[30;1m131 | [0m[35m    # so we don't really need to implement those methods. The reason they exist at all is so loader [0m
[30;1m132 | [0m[35m    # if extractor extracts this info.[0m
[30;1m133 | [0m[35m    def create_next_atlas_entity(self) -> Union[AtlasEntity, None]:[0m
[30;1m134 | [0m[35m        pass[0m

[31m--[ [0m[34mMatch #[0m[33m279[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/table_last_updated.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m    def _create_relation_iterator(self) -> Iterator[GraphRelationship]:[0m
[30;1m101 | [0m[35m        """[0m
[30;1m102 | [0m[35m        Create relations mapping last updated node with table node[0m
[30;1m103 | [0m[35m        :return:[0m
[30;1m104 | [0m[35m        """[0m
[30;1m105 | [0m[35m        relationship = GraphRelationship([0m
[30;1m106 | [0m[35m            start_label=TableMetadata.TABLE_NODE_LABEL,[0m

[31m--[ [0m[34mMatch #[0m[33m280[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/table_last_updated.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m    def _create_relation_iterator(self) -> Iterator[GraphRelationship]:[0m
[30;1m101 | [0m[35m        """[0m
[30;1m102 | [0m[35m        Create relations mapping last updated node with table node[0m
[30;1m103 | [0m[35m        :return:[0m
[30;1m104 | [0m[35m        """[0m
[30;1m105 | [0m[35m        relationship = GraphRelationship([0m

[31m--[ [0m[34mMatch #[0m[33m281[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/table_last_updated.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m95 | [0m[35m                TableLastUpdated.TIMESTAMP_NAME_PROPERTY: timestamp_constants.TimestampName.last_upd[0m
[30;1m96 | [0m[35m            }[0m
[30;1m97 | [0m[35m        )[0m
[30;1m98 | [0m[35m        yield node[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m    def _create_relation_iterator(self) -> Iterator[GraphRelationship]:[0m
[30;1m101 | [0m[35m        """[0m
[30;1m102 | [0m[35m        Create relations mapping last updated node with table node[0m

[31m--[ [0m[34mMatch #[0m[33m282[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/table_last_updated.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m86 | [0m[35m        Create a last_updated node[0m
[30;1m87 | [0m[35m        :return:[0m
[30;1m88 | [0m[35m        """[0m
[30;1m89 | [0m[35m        node = GraphNode([0m
[30;1m90 | [0m[35m            key=self.get_last_updated_model_key(),[0m
[30;1m91 | [0m[35m            label=TableLastUpdated.LAST_UPDATED_NODE_LABEL,[0m
[30;1m92 | [0m[35m            attributes={[0m

[31m--[ [0m[34mMatch #[0m[33m283[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/table_last_updated.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m    def _create_node_iterator(self) -> Iterator[GraphNode]:[0m
[30;1m85 | [0m[35m        """[0m
[30;1m86 | [0m[35m        Create a last_updated node[0m
[30;1m87 | [0m[35m        :return:[0m
[30;1m88 | [0m[35m        """[0m
[30;1m89 | [0m[35m        node = GraphNode([0m
[30;1m90 | [0m[35m            key=self.get_last_updated_model_key(),[0m

[31m--[ [0m[34mMatch #[0m[33m284[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/table_last_updated.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m49 | [0m[35m               f"schema={self.schema!r}, db={self.db!r}, cluster={self.cluster!r})"[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    def create_next_node(self) -> Union[GraphNode, None]:[0m
[30;1m52 | [0m[35m        # creates new node[0m
[30;1m53 | [0m[35m        try:[0m
[30;1m54 | [0m[35m            return next(self._node_iter)[0m
[30;1m55 | [0m[35m        except StopIteration:[0m
[30;1m56 | [0m[35m            return None[0m

[31m--[ [0m[34mMatch #[0m[33m285[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/kafka_schema_registry_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m176 | [0m[35m            return 'struct<object>'[0m
[30;1m177 | [0m[35m        elif schema['type'] == 'array':[0m
[30;1m178 | [0m[35m            items = KafkaSchemaRegistryExtractor._get_property_type([0m
[30;1m179 | [0m[35m                schema.get("items", {})[0m
[30;1m180 | [0m[35m            )[0m
[30;1m181 | [0m[35m            return 'array<' + items + '>'[0m
[30;1m182 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m286[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/kafka_schema_registry_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m166 | [0m[35m            properties = [[0m
[30;1m167 | [0m[35m                f"{field['name']}:"[0m
[30;1m168 | [0m[35m                f"{KafkaSchemaRegistryExtractor._get_property_type(field)}"[0m
[30;1m169 | [0m[35m                for field in schema.get('fields', {})[0m
[30;1m170 | [0m[35m            ][0m
[30;1m171 | [0m[35m            if len(properties) > 0:[0m
[30;1m172 | [0m[35m                if 'name' in schema:[0m

[31m--[ [0m[34mMatch #[0m[33m287[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/kafka_schema_registry_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m127 | [0m[35m            columns.append([0m
[30;1m128 | [0m[35m                ColumnMetadata([0m
[30;1m129 | [0m[35m                    name=field['name'],[0m
[30;1m130 | [0m[35m                    description=field.get('doc', None),[0m
[30;1m131 | [0m[35m                    col_type=KafkaSchemaRegistryExtractor._get_property_type([0m
[30;1m132 | [0m[35m                        field[0m
[30;1m133 | [0m[35m                    ),[0m

[31m--[ [0m[34mMatch #[0m[33m288[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/kafka_schema_registry_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m89 | [0m[35m                        'namespace', 'kafka-schema-registry'[0m
[30;1m90 | [0m[35m                    ),[0m
[30;1m91 | [0m[35m                    schema_name=schema.get('name', ''),[0m
[30;1m92 | [0m[35m                    schema_description=schema.get('doc', None),[0m
[30;1m93 | [0m[35m                )[0m
[30;1m94 | [0m[35m            except Exception as e:[0m
[30;1m95 | [0m[35m                logger.warning(f'Failed to generate table for {subject}: {e}')[0m

[31m--[ [0m[34mMatch #[0m[33m289[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/kafka_schema_registry_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m88 | [0m[35m                    cluster_name=schema.get([0m
[30;1m89 | [0m[35m                        'namespace', 'kafka-schema-registry'[0m
[30;1m90 | [0m[35m                    ),[0m
[30;1m91 | [0m[35m                    schema_name=schema.get('name', ''),[0m
[30;1m92 | [0m[35m                    schema_description=schema.get('doc', None),[0m
[30;1m93 | [0m[35m                )[0m
[30;1m94 | [0m[35m            except Exception as e:[0m

[31m--[ [0m[34mMatch #[0m[33m290[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/kafka_schema_registry_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m                yield KafkaSchemaRegistryExtractor._create_table([0m
[30;1m86 | [0m[35m                    schema=schema,[0m
[30;1m87 | [0m[35m                    subject_name=subject,[0m
[30;1m88 | [0m[35m                    cluster_name=schema.get([0m
[30;1m89 | [0m[35m                        'namespace', 'kafka-schema-registry'[0m
[30;1m90 | [0m[35m                    ),[0m
[30;1m91 | [0m[35m                    schema_name=schema.get('name', ''),[0m

[31m--[ [0m[34mMatch #[0m[33m291[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/kafka_schema_registry_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35m            KafkaSchemaRegistryExtractor.REGISTRY_USERNAME_KEY, None[0m
[30;1m36 | [0m[35m        )[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m        self._registry_password = conf.get([0m
[30;1m39 | [0m[35m            KafkaSchemaRegistryExtractor.REGISTRY_PASSWORD_KEY, None[0m
[30;1m40 | [0m[35m        )[0m
[30;1m41 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m292[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/kafka_schema_registry_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m            KafkaSchemaRegistryExtractor.REGISTRY_URL_KEY[0m
[30;1m32 | [0m[35m        )[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m        self._registry_username = conf.get([0m
[30;1m35 | [0m[35m            KafkaSchemaRegistryExtractor.REGISTRY_USERNAME_KEY, None[0m
[30;1m36 | [0m[35m        )[0m
[30;1m37 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m293[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/kafka_schema_registry_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m    REGISTRY_PASSWORD_KEY = "registry_password"[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    def init(self, conf: ConfigTree) -> None:[0m
[30;1m30 | [0m[35m        self._registry_base_url = conf.get([0m
[30;1m31 | [0m[35m            KafkaSchemaRegistryExtractor.REGISTRY_URL_KEY[0m
[30;1m32 | [0m[35m        )[0m
[30;1m33 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m294[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/publisher_config_constants.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    NEO4J_USER = 'neo4j_user'[0m
[30;1m58 | [0m[35m    NEO4J_PASSWORD = 'neo4j_password'[0m
[30;1m59 | [0m[35m    # in Neo4j (v4.0+), we can create and use more than one active database at the same time[0m
[30;1m60 | [0m[35m    NEO4J_DATABASE_NAME = 'neo4j_database'[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m    # NEO4J_ENCRYPTED is a boolean indicating whether to use SSL/TLS when connecting[0m
[30;1m63 | [0m[35m    NEO4J_ENCRYPTED = 'neo4j_encrypted'[0m

[31m--[ [0m[34mMatch #[0m[33m295[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/publisher_config_constants.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35m    PRESERVE_ADHOC_UI_DATA = 'preserve_adhoc_ui_data'[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m    # If enabled, the default behavior will continue to publish properties with empty values.[0m
[30;1m42 | [0m[35m    # If False, empty properties will be set to NULL and will not show up on the node or relation.[0m
[30;1m43 | [0m[35m    PRESERVE_EMPTY_PROPS = 'preserve_empty_props'[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m296[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/publisher_config_constants.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m33 | [0m[35m    # to false, reverse relationships will not be published.[0m
[30;1m34 | [0m[35m    PUBLISH_REVERSE_RELATIONSHIPS = 'publish_reverse_relationships'[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m    # If enabled, stops the publisher from updating a node or relationship[0m
[30;1m37 | [0m[35m    # created via the UI, e.g. a description or owner added manually by an Amundsen user.[0m
[30;1m38 | [0m[35m    # Such nodes/relationships will not have a 'published_tag' property that is set by databuilder.[0m
[30;1m39 | [0m[35m    PRESERVE_ADHOC_UI_DATA = 'preserve_adhoc_ui_data'[0m

[31m--[ [0m[34mMatch #[0m[33m297[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/publisher_config_constants.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35m    # A CSV header with this suffix will be passed to the statement without quotes[0m
[30;1m11 | [0m[35m    UNQUOTED_SUFFIX = ':UNQUOTED'[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m    # This will be used to provide unique tag to the node and relationship[0m
[30;1m14 | [0m[35m    JOB_PUBLISH_TAG = 'job_publish_tag'[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m    # any additional fields that should be added to nodes and rels through config[0m

[31m--[ [0m[34mMatch #[0m[33m298[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/publisher_config_constants.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    NEO4J_USER = 'neo4j_user'[0m
[30;1m58 | [0m[35m    NEO4J_PASSWORD = 'neo4j_password'[0m
[30;1m59 | [0m[35m    # in Neo4j (v4.0+), we can create and use more than one active database at the same time[0m
[30;1m60 | [0m[35m    NEO4J_DATABASE_NAME = 'neo4j_database'[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m    # NEO4J_ENCRYPTED is a boolean indicating whether to use SSL/TLS when connecting[0m

[31m--[ [0m[34mMatch #[0m[33m299[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/db_api_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m33 | [0m[35m        self.cursor = self.connection.cursor()[0m
[30;1m34 | [0m[35m        self.sql = conf.get(DBAPIExtractor.SQL_CONFIG_KEY)[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m        model_class = conf.get('model_class', None)[0m
[30;1m37 | [0m[35m        if model_class:[0m
[30;1m38 | [0m[35m            module_name, class_name = model_class.rsplit(".", 1)[0m
[30;1m39 | [0m[35m            mod = importlib.import_module(module_name)[0m

[31m--[ [0m[34mMatch #[0m[33m300[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/db_api_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m        self.conf = conf[0m
[30;1m32 | [0m[35m        self.connection: Any = conf.get(DBAPIExtractor.CONNECTION_CONFIG_KEY)[0m
[30;1m33 | [0m[35m        self.cursor = self.connection.cursor()[0m
[30;1m34 | [0m[35m        self.sql = conf.get(DBAPIExtractor.SQL_CONFIG_KEY)[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m        model_class = conf.get('model_class', None)[0m
[30;1m37 | [0m[35m        if model_class:[0m

[31m--[ [0m[34mMatch #[0m[33m301[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/db_api_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m29 | [0m[35m        :return:[0m
[30;1m30 | [0m[35m        """[0m
[30;1m31 | [0m[35m        self.conf = conf[0m
[30;1m32 | [0m[35m        self.connection: Any = conf.get(DBAPIExtractor.CONNECTION_CONFIG_KEY)[0m
[30;1m33 | [0m[35m        self.cursor = self.connection.cursor()[0m
[30;1m34 | [0m[35m        self.sql = conf.get(DBAPIExtractor.SQL_CONFIG_KEY)[0m
[30;1m35 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m302[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/base_bigquery_extractor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m62 | [0m[35m                    google.oauth2.service_account.Credentials.from_service_account_info([0m
[30;1m63 | [0m[35m                        service_account_info, scopes=self._DEFAULT_SCOPES))[0m
[30;1m64 | [0m[35m            else:[0m
[30;1m65 | [0m[35m                # FIXME: mypy can't find this attribute[0m
[30;1m66 | [0m[35m                google_auth: Any = getattr(google, 'auth')[0m
[30;1m67 | [0m[35m                credentials, _ = google_auth.default(scopes=self._DEFAULT_SCOPES)[0m
[30;1m68 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m303[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/base_bigquery_extractor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35m    CRED_KEY = 'project_cred'[0m
[30;1m32 | [0m[35m    PAGE_SIZE_KEY = 'page_size'[0m
[30;1m33 | [0m[35m    FILTER_KEY = 'filter'[0m
[30;1m34 | [0m[35m    # metadata for tables created after the cutoff time would not be extracted from bigquery.[0m
[30;1m35 | [0m[35m    CUTOFF_TIME_KEY = 'cutoff_time'[0m
[30;1m36 | [0m[35m    _DEFAULT_SCOPES = ['https://www.googleapis.com/auth/bigquery.readonly'][0m
[30;1m37 | [0m[35m    DEFAULT_PAGE_SIZE = 300[0m

[31m--[ [0m[34mMatch #[0m[33m304[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/neptune_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m259 | [0m[35m        neptune_client_conf = Scoped.get_scoped_conf(conf, self.neptune_client.get_scope())[0m
[30;1m260 | [0m[35m        self.neptune_client.init(neptune_client_conf)[0m
[30;1m261 | [0m[35m[0m
[30;1m262 | [0m[35m        model_class = conf.get(NeptuneSearchDataExtractor.MODEL_CLASS_CONFIG_KEY, None)[0m
[30;1m263 | [0m[35m        if model_class:[0m
[30;1m264 | [0m[35m            module_name, class_name = model_class.rsplit(".", 1)[0m
[30;1m265 | [0m[35m            mod = importlib.import_module(module_name)[0m

[31m--[ [0m[34mMatch #[0m[33m305[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/neptune_search_data_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m249 | [0m[35m        self.entity = conf.get_string(NeptuneSearchDataExtractor.ENTITY_TYPE_CONFIG_KEY, default='ta[0m
[30;1m250 | [0m[35m[0m
[30;1m251 | [0m[35m        if NeptuneSearchDataExtractor.QUERY_FUNCTION_CONFIG_KEY in conf:[0m
[30;1m252 | [0m[35m            self.query_function = conf.get(NeptuneSearchDataExtractor.QUERY_FUNCTION_CONFIG_KEY)[0m
[30;1m253 | [0m[35m        else:[0m
[30;1m254 | [0m[35m            self.query_function = NeptuneSearchDataExtractor.DEFAULT_QUERY_BY_ENTITY[self.entity][0m
[30;1m255 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m306[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_unwind_publisher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m        # if NEO4J_VALIDATE_SSL or NEO4J_ENCRYPTED are set in config pass them to the driver[0m
[30;1m120 | [0m[35m        validate_ssl_conf = conf.get(Neo4jCsvPublisherConfigs.NEO4J_VALIDATE_SSL, None)[0m
[30;1m121 | [0m[35m        encrypted_conf = conf.get(Neo4jCsvPublisherConfigs.NEO4J_ENCRYPTED, None)[0m
[30;1m122 | [0m[35m        if validate_ssl_conf is not None:[0m
[30;1m123 | [0m[35m            driver_args['trust'] = neo4j.TRUST_SYSTEM_CA_SIGNED_CERTIFICATES if validate_ssl_conf \[0m
[30;1m124 | [0m[35m                else neo4j.TRUST_ALL_CERTIFICATES[0m

[31m--[ [0m[34mMatch #[0m[33m307[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_unwind_publisher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m117 | [0m[35m            driver_args.update(default_security_conf)[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m        # if NEO4J_VALIDATE_SSL or NEO4J_ENCRYPTED are set in config pass them to the driver[0m
[30;1m120 | [0m[35m        validate_ssl_conf = conf.get(Neo4jCsvPublisherConfigs.NEO4J_VALIDATE_SSL, None)[0m
[30;1m121 | [0m[35m        encrypted_conf = conf.get(Neo4jCsvPublisherConfigs.NEO4J_ENCRYPTED, None)[0m
[30;1m122 | [0m[35m        if validate_ssl_conf is not None:[0m
[30;1m123 | [0m[35m            driver_args['trust'] = neo4j.TRUST_SYSTEM_CA_SIGNED_CERTIFICATES if validate_ssl_conf \[0m

[31m--[ [0m[34mMatch #[0m[33m308[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_unwind_publisher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m92 | [0m[35m        self._preserve_adhoc_ui_data = conf.get_bool(PublishBehaviorConfigs.PRESERVE_ADHOC_UI_DATA)[0m
[30;1m93 | [0m[35m        self._preserve_empty_props: bool = conf.get_bool(PublishBehaviorConfigs.PRESERVE_EMPTY_PROPS[0m
[30;1m94 | [0m[35m        self._prop_types_to_configure: Dict =\[0m
[30;1m95 | [0m[35m            dict(conf.get(Neo4jCsvPublisherConfigs.NEO4J_PROP_TYPES_TO_CONFIGURE, default={}))[0m
[30;1m96 | [0m[35m        if self._add_publisher_metadata and not self._publish_tag:[0m
[30;1m97 | [0m[35m            raise Exception(f'{PublisherConfigs.JOB_PUBLISH_TAG} should not be empty')[0m
[30;1m98 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m309[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_unwind_publisher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m        self._labels: Set[str] = set()[0m
[30;1m87 | [0m[35m        self._publish_tag: str = conf.get_string(PublisherConfigs.JOB_PUBLISH_TAG)[0m
[30;1m88 | [0m[35m        self._additional_publisher_metadata_fields: Dict =\[0m
[30;1m89 | [0m[35m            dict(conf.get(PublisherConfigs.ADDITIONAL_PUBLISHER_METADATA_FIELDS, default={}))[0m
[30;1m90 | [0m[35m        self._add_publisher_metadata: bool = conf.get_bool(PublishBehaviorConfigs.ADD_PUBLISHER_META[0m
[30;1m91 | [0m[35m        self._publish_reverse_relationships: bool = conf.get_bool(PublishBehaviorConfigs.PUBLISH_REV[0m
[30;1m92 | [0m[35m        self._preserve_adhoc_ui_data = conf.get_bool(PublishBehaviorConfigs.PRESERVE_ADHOC_UI_DATA)[0m

[31m--[ [0m[34mMatch #[0m[33m310[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_unwind_publisher.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m197 | [0m[35m            UNWIND $batch AS row[0m
[30;1m198 | [0m[35m            MERGE (node:{{ LABEL }} {key: row.KEY})[0m
[30;1m199 | [0m[35m            ON CREATE SET {{ PROPS_BODY_CREATE }}[0m
[30;1m200 | [0m[35m            {% if update %} ON MATCH SET {{ PROPS_BODY_UPDATE }} {% endif %}[0m
[30;1m201 | [0m[35m        """)[0m
[30;1m202 | [0m[35m[0m
[30;1m203 | [0m[35m        props_body_create = self._create_props_body(get_props_body_keys(node_keys,[0m

[31m--[ [0m[34mMatch #[0m[33m311[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_unwind_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m186 | [0m[35m            csv_dataframe = pandas.read_csv(node_csv, na_filter=False)[0m
[30;1m187 | [0m[35m            all_node_records = csv_dataframe.to_dict(orient="records")[0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m            # Get the first node label since they will be the same for all records in the file[0m
[30;1m190 | [0m[35m            merge_stmt = self._create_node_merge_statement(node_keys=csv_dataframe.columns.tolist(),[0m
[30;1m191 | [0m[35m                                                           node_label=all_node_records[0][NODE_LABEL[0m
[30;1m192 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m312[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_unwind_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m144 | [0m[35m        for node_file in self._node_files:[0m
[30;1m145 | [0m[35m            self.pre_publish_node_file(node_file)[0m
[30;1m146 | [0m[35m[0m
[30;1m147 | [0m[35m        LOGGER.info('Publishing Node files: %s', self._node_files)[0m
[30;1m148 | [0m[35m        while True:[0m
[30;1m149 | [0m[35m            try:[0m
[30;1m150 | [0m[35m                node_file = next(self._node_files_iter)[0m

[31m--[ [0m[34mMatch #[0m[33m313[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_unwind_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m96 | [0m[35m        if self._add_publisher_metadata and not self._publish_tag:[0m
[30;1m97 | [0m[35m            raise Exception(f'{PublisherConfigs.JOB_PUBLISH_TAG} should not be empty')[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m        LOGGER.info('Publishing Node csv files %s, and Relation CSV files %s',[0m
[30;1m100 | [0m[35m                    self._node_files,[0m
[30;1m101 | [0m[35m                    self._relation_files)[0m
[30;1m102 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m314[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_unwind_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m80 | [0m[35m        self._db_name = conf.get_string(Neo4jCsvPublisherConfigs.NEO4J_DATABASE_NAME)[0m
[30;1m81 | [0m[35m        self._transaction_size = conf.get_int(Neo4jCsvPublisherConfigs.NEO4J_TRANSACTION_SIZE)[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m        # config is list of node label.[0m
[30;1m84 | [0m[35m        # When set, this list specifies a list of nodes that shouldn't be updated, if exists[0m
[30;1m85 | [0m[35m        self._create_only_nodes = set(conf.get_list(Neo4jCsvPublisherConfigs.NEO4J_CREATE_ONLY_NODES[0m
[30;1m86 | [0m[35m        self._labels: Set[str] = set()[0m

[31m--[ [0m[34mMatch #[0m[33m315[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_unwind_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m37 | [0m[35m# https://stackoverflow.com/a/54517228/5972935[0m
[30;1m38 | [0m[35mcsv.field_size_limit(int(ctypes.c_ulong(-1).value // 2))[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m# Required columns for Node[0m
[30;1m41 | [0m[35mNODE_REQUIRED_KEYS = {NODE_LABEL, NODE_KEY}[0m
[30;1m42 | [0m[35m# Required columns for Relationship[0m
[30;1m43 | [0m[35mRELATION_REQUIRED_KEYS = {RELATION_START_LABEL, RELATION_START_KEY,[0m
[30;1m44 | [0m[35m                          RELATION_END_LABEL, RELATION_END_KEY,[0m

[31m--[ [0m[34mMatch #[0m[33m316[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_unwind_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mimport csv[0m
[30;1m5 | [0m[35mimport ctypes[0m
[30;1m6 | [0m[35mimport logging[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35mfrom io import open[0m
[30;1m9 | [0m[35mfrom typing import ([0m
[30;1m10 | [0m[35m    Dict, List, Set,[0m
[30;1m11 | [0m[35m)[0m

[31m--[ [0m[34mMatch #[0m[33m317[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/type_metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m461 | [0m[35m                                           badges=self._badges)[0m
[30;1m462 | [0m[35m            badge_nodes = badge_metadata.get_badge_nodes()[0m
[30;1m463 | [0m[35m            for node in badge_nodes:[0m
[30;1m464 | [0m[35m                yield node[0m
[30;1m465 | [0m[35m[0m
[30;1m466 | [0m[35m        if not self.is_terminal_type():[0m
[30;1m467 | [0m[35m            assert self.struct_items, f"Struct items must be set for {self.name}"[0m
[30;1m468 | [0m[35m            for name, data_type in self.struct_items.items():[0m

[31m--[ [0m[34mMatch #[0m[33m318[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/type_metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m460 | [0m[35m                                           start_key=self.key(),[0m
[30;1m461 | [0m[35m                                           badges=self._badges)[0m
[30;1m462 | [0m[35m            badge_nodes = badge_metadata.get_badge_nodes()[0m
[30;1m463 | [0m[35m            for node in badge_nodes:[0m
[30;1m464 | [0m[35m                yield node[0m
[30;1m465 | [0m[35m[0m
[30;1m466 | [0m[35m        if not self.is_terminal_type():[0m

[31m--[ [0m[34mMatch #[0m[33m319[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/type_metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m382 | [0m[35m                                           badges=self._badges)[0m
[30;1m383 | [0m[35m            badge_nodes = badge_metadata.get_badge_nodes()[0m
[30;1m384 | [0m[35m            for node in badge_nodes:[0m
[30;1m385 | [0m[35m                yield node[0m
[30;1m386 | [0m[35m[0m
[30;1m387 | [0m[35m    def create_relation_iterator(self) -> Iterator[GraphRelationship]:[0m
[30;1m388 | [0m[35m        yield GraphRelationship([0m
[30;1m389 | [0m[35m            start_label=self.parent_label(),[0m

[31m--[ [0m[34mMatch #[0m[33m320[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/type_metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m381 | [0m[35m                                           start_key=self.key(),[0m
[30;1m382 | [0m[35m                                           badges=self._badges)[0m
[30;1m383 | [0m[35m            badge_nodes = badge_metadata.get_badge_nodes()[0m
[30;1m384 | [0m[35m            for node in badge_nodes:[0m
[30;1m385 | [0m[35m                yield node[0m
[30;1m386 | [0m[35m[0m
[30;1m387 | [0m[35m    def create_relation_iterator(self) -> Iterator[GraphRelationship]:[0m

[31m--[ [0m[34mMatch #[0m[33m321[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/type_metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m288 | [0m[35m                                           badges=self._badges)[0m
[30;1m289 | [0m[35m            badge_nodes = badge_metadata.get_badge_nodes()[0m
[30;1m290 | [0m[35m            for node in badge_nodes:[0m
[30;1m291 | [0m[35m                yield node[0m
[30;1m292 | [0m[35m[0m
[30;1m293 | [0m[35m        if not self.is_terminal_type():[0m
[30;1m294 | [0m[35m            assert self.map_key_type is not None, f"Map key type must be set for {self.name}"[0m
[30;1m295 | [0m[35m            assert self.map_value_type is not None, f"Map value type must be set for {self.name}"[0m

[31m--[ [0m[34mMatch #[0m[33m322[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/type_metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m287 | [0m[35m                                           start_key=self.key(),[0m
[30;1m288 | [0m[35m                                           badges=self._badges)[0m
[30;1m289 | [0m[35m            badge_nodes = badge_metadata.get_badge_nodes()[0m
[30;1m290 | [0m[35m            for node in badge_nodes:[0m
[30;1m291 | [0m[35m                yield node[0m
[30;1m292 | [0m[35m[0m
[30;1m293 | [0m[35m        if not self.is_terminal_type():[0m

[31m--[ [0m[34mMatch #[0m[33m323[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/type_metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m199 | [0m[35m                                           badges=self._badges)[0m
[30;1m200 | [0m[35m            badge_nodes = badge_metadata.get_badge_nodes()[0m
[30;1m201 | [0m[35m            for node in badge_nodes:[0m
[30;1m202 | [0m[35m                yield node[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m        if not self.is_terminal_type():[0m
[30;1m205 | [0m[35m            assert self.array_inner_type is not None, f"Array inner type must be set for {self.name}[0m
[30;1m206 | [0m[35m            yield from self.array_inner_type.create_node_iterator()[0m

[31m--[ [0m[34mMatch #[0m[33m324[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/type_metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m198 | [0m[35m                                           start_key=self.key(),[0m
[30;1m199 | [0m[35m                                           badges=self._badges)[0m
[30;1m200 | [0m[35m            badge_nodes = badge_metadata.get_badge_nodes()[0m
[30;1m201 | [0m[35m            for node in badge_nodes:[0m
[30;1m202 | [0m[35m                yield node[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m        if not self.is_terminal_type():[0m

[31m--[ [0m[34mMatch #[0m[33m325[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/type_metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m71 | [0m[35m    def set_badges(self, badges: Union[List[str], None] = None) -> None:[0m
[30;1m72 | [0m[35m        if isinstance(self.parent, ColumnMetadata):[0m
[30;1m73 | [0m[35m            LOGGER.warning("""Frontend does not currently support setting badges for type metadata[0m
[30;1m74 | [0m[35m                           objects with a ColumnMetadata parent, since the top level type metadata d[0m
[30;1m75 | [0m[35m                           not have its own row in the column table""")[0m
[30;1m76 | [0m[35m        elif isinstance(self.parent, ArrayTypeMetadata):[0m
[30;1m77 | [0m[35m            LOGGER.warning("""Frontend does not currently support setting badges for type metadata[0m

[31m--[ [0m[34mMatch #[0m[33m326[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/type_metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m52 | [0m[35m    def set_description(self, description: str) -> None:[0m
[30;1m53 | [0m[35m        if isinstance(self.parent, ColumnMetadata):[0m
[30;1m54 | [0m[35m            LOGGER.warning("""Frontend does not currently support setting descriptions for type meta[0m
[30;1m55 | [0m[35m                           objects with a ColumnMetadata parent, since the top level type metadata d[0m
[30;1m56 | [0m[35m                           not have its own row in the column table""")[0m
[30;1m57 | [0m[35m        elif isinstance(self.parent, ArrayTypeMetadata):[0m
[30;1m58 | [0m[35m            LOGGER.warning("""Frontend does not currently support setting descriptions for type meta[0m

[31m--[ [0m[34mMatch #[0m[33m327[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/type_metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m37 | [0m[35m        self.name = name[0m
[30;1m38 | [0m[35m        self.parent = parent[0m
[30;1m39 | [0m[35m        self.type_str = type_str[0m
[30;1m40 | [0m[35m        # Sort order among TypeMetadata objects with the same parent[0m
[30;1m41 | [0m[35m        self.sort_order = sort_order[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m        self._description: Optional[DescriptionMetadata] = None[0m

[31m--[ [0m[34mMatch #[0m[33m328[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/bigquery_watermark_extractor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35m                tableRef = table['tableReference'][0m
[30;1m45 | [0m[35m                table_id = tableRef['tableId'][0m
[30;1m46 | [0m[35m                table_creation_time = float(table['creationTime']) / 1000[0m
[30;1m47 | [0m[35m                # only extract watermark metadata for tables created before the cut-off time[0m
[30;1m48 | [0m[35m                if table_creation_time < cutoff_time_in_epoch:[0m
[30;1m49 | [0m[35m                    # BigQuery tables that have numeric suffix starts with a date are[0m
[30;1m50 | [0m[35m                    # considered date range tables.[0m
[30;1m51 | [0m[35m                    # ( e.g. ga_sessions_20190101, ga_sessions_20190102, etc. )[0m

[31m--[ [0m[34mMatch #[0m[33m329[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/bigquery_watermark_extractor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mimport datetime[0m
[30;1m5 | [0m[35mimport logging[0m
[30;1m6 | [0m[35mimport textwrap[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35mfrom calendar import timegm[0m
[30;1m9 | [0m[35mfrom collections import namedtuple[0m
[30;1m10 | [0m[35mfrom typing import ([0m
[30;1m11 | [0m[35m    Any, Dict, Iterator, List, Tuple, Union,[0m

[31m--[ [0m[34mMatch #[0m[33m330[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/pandas_profiling_column_stats_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m    @property[0m
[30;1m192 | [0m[35m    def table_name(self) -> str:[0m
[30;1m193 | [0m[35m        return self.conf.get(PandasProfilingColumnStatsExtractor.TABLE_NAME)[0m

[31m--[ [0m[34mMatch #[0m[33m331[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/pandas_profiling_column_stats_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m    @property[0m
[30;1m188 | [0m[35m    def schema_name(self) -> str:[0m
[30;1m189 | [0m[35m        return self.conf.get(PandasProfilingColumnStatsExtractor.SCHEMA_NAME)[0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m    @property[0m
[30;1m192 | [0m[35m    def table_name(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m332[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/pandas_profiling_column_stats_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35m    @property[0m
[30;1m184 | [0m[35m    def database_name(self) -> str:[0m
[30;1m185 | [0m[35m        return self.conf.get(PandasProfilingColumnStatsExtractor.DATABASE_NAME)[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m    @property[0m
[30;1m188 | [0m[35m    def schema_name(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m333[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/pandas_profiling_column_stats_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m178 | [0m[35m[0m
[30;1m179 | [0m[35m    @property[0m
[30;1m180 | [0m[35m    def cluster_name(self) -> str:[0m
[30;1m181 | [0m[35m        return self.conf.get(PandasProfilingColumnStatsExtractor.CLUSTER_NAME)[0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35m    @property[0m
[30;1m184 | [0m[35m    def database_name(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m334[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/pandas_profiling_column_stats_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m174 | [0m[35m[0m
[30;1m175 | [0m[35m    @property[0m
[30;1m176 | [0m[35m    def stat_mappings(self) -> Dict[str, Tuple[str, Any]]:[0m
[30;1m177 | [0m[35m        return dict(self.conf.get(PandasProfilingColumnStatsExtractor.STAT_MAPPINGS))[0m
[30;1m178 | [0m[35m[0m
[30;1m179 | [0m[35m    @property[0m
[30;1m180 | [0m[35m    def cluster_name(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m335[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/pandas_profiling_column_stats_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m170 | [0m[35m            return '0'[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m    def round_value(self, value: float) -> float:[0m
[30;1m173 | [0m[35m        return round(value, self.conf.get(PandasProfilingColumnStatsExtractor.PRECISION))[0m
[30;1m174 | [0m[35m[0m
[30;1m175 | [0m[35m    @property[0m
[30;1m176 | [0m[35m    def stat_mappings(self) -> Dict[str, Tuple[str, Any]]:[0m

[31m--[ [0m[34mMatch #[0m[33m336[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/pandas_profiling_column_stats_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m144 | [0m[35m                    yield stat[0m
[30;1m145 | [0m[35m[0m
[30;1m146 | [0m[35m    def _load_report(self) -> Dict[str, Any]:[0m
[30;1m147 | [0m[35m        path = self.conf.get(PandasProfilingColumnStatsExtractor.FILE_PATH)[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m        try:[0m
[30;1m150 | [0m[35m            with open(path, 'r') as f:[0m

[31m--[ [0m[34mMatch #[0m[33m337[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/pandas_profiling_column_stats_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m        for column_name, column_stats in variables.items():[0m
[30;1m131 | [0m[35m            for _stat_name, stat_value in column_stats.items():[0m
[30;1m132 | [0m[35m                stat_spec = self.stat_mappings.get(_stat_name)[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m                if stat_spec:[0m
[30;1m135 | [0m[35m                    stat_name, stat_modifier = stat_spec[0m

[31m--[ [0m[34mMatch #[0m[33m338[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/pandas_profiling_column_stats_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m125 | [0m[35m        report = self._load_report()[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m        variables = report.get('variables', dict())[0m
[30;1m128 | [0m[35m        report_time = self.parse_date(report.get('analysis', dict()).get('date_start'))[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m        for column_name, column_stats in variables.items():[0m
[30;1m131 | [0m[35m            for _stat_name, stat_value in column_stats.items():[0m

[31m--[ [0m[34mMatch #[0m[33m339[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/pandas_profiling_column_stats_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m125 | [0m[35m        report = self._load_report()[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m        variables = report.get('variables', dict())[0m
[30;1m128 | [0m[35m        report_time = self.parse_date(report.get('analysis', dict()).get('date_start'))[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m        for column_name, column_stats in variables.items():[0m
[30;1m131 | [0m[35m            for _stat_name, stat_value in column_stats.items():[0m

[31m--[ [0m[34mMatch #[0m[33m340[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/pandas_profiling_column_stats_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m    def _get_extract_iter(self) -> Any:[0m
[30;1m125 | [0m[35m        report = self._load_report()[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m        variables = report.get('variables', dict())[0m
[30;1m128 | [0m[35m        report_time = self.parse_date(report.get('analysis', dict()).get('date_start'))[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m        for column_name, column_stats in variables.items():[0m

[31m--[ [0m[34mMatch #[0m[33m341[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/pandas_profiling_column_stats_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35m        '50%': ('Quantile 50%', float),[0m
[30;1m36 | [0m[35m        '75%': ('Quantile 75%', float),[0m
[30;1m37 | [0m[35m        '95%': ('Quantile 95%', float),[0m
[30;1m38 | [0m[35m        'chi_squared': ('Chi squared', lambda x: float(x.get('statistic'))),[0m
[30;1m39 | [0m[35m        'count': ('Count', int),[0m
[30;1m40 | [0m[35m        'is_unique': ('Unique', bool),[0m
[30;1m41 | [0m[35m        'kurtosis': ('Kurtosis', float),[0m

[31m--[ [0m[34mMatch #[0m[33m342[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/pandas_profiling_column_stats_extractor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m    CLUSTER_NAME = 'cluster_name'[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    # if you wish to collect only selected set of metrics configure stat_mappings option of the extr[0m
[30;1m24 | [0m[35m    # similar dictionary but containing only keys of metrics you wish to collect.[0m
[30;1m25 | [0m[35m    # For example - if you want only min and max value of a column, provide extractor with configura[0m
[30;1m26 | [0m[35m    # PandasProfilingColumnStatsExtractor.STAT_MAPPINGS = {'max': ('Maximum', float), 'min': ('Minim[0m
[30;1m27 | [0m[35m    STAT_MAPPINGS = 'stat_mappings'[0m

[31m--[ [0m[34mMatch #[0m[33m343[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/pandas_profiling_column_stats_extractor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35m    SCHEMA_NAME = 'schema_name'[0m
[30;1m21 | [0m[35m    CLUSTER_NAME = 'cluster_name'[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    # if you wish to collect only selected set of metrics configure stat_mappings option of the extr[0m
[30;1m24 | [0m[35m    # similar dictionary but containing only keys of metrics you wish to collect.[0m
[30;1m25 | [0m[35m    # For example - if you want only min and max value of a column, provide extractor with configura[0m
[30;1m26 | [0m[35m    # PandasProfilingColumnStatsExtractor.STAT_MAPPINGS = {'max': ('Maximum', float), 'min': ('Minim[0m

[31m--[ [0m[34mMatch #[0m[33m344[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/filesystem/filesystem.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m74 | [0m[35m        """[0m
[30;1m75 | [0m[35m        self._conf = conf.with_fallback(FileSystem.DEFAULT_CONFIG)[0m
[30;1m76 | [0m[35m        self._dask_fs = self._conf.get(FileSystem.DASK_FILE_SYSTEM)[0m
[30;1m77 | [0m[35m        self._metadata_key_mapping = self._conf.get(FileSystem.FILE_METADATA_MAPPING_KEY).as_plain_o[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m    @retry(retry_on_exception=is_retriable_error, stop_max_attempt_number=3, wait_exponential_multip[0m
[30;1m80 | [0m[35m           wait_exponential_max=5000)[0m

[31m--[ [0m[34mMatch #[0m[33m345[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/filesystem/filesystem.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m        :return:[0m
[30;1m74 | [0m[35m        """[0m
[30;1m75 | [0m[35m        self._conf = conf.with_fallback(FileSystem.DEFAULT_CONFIG)[0m
[30;1m76 | [0m[35m        self._dask_fs = self._conf.get(FileSystem.DASK_FILE_SYSTEM)[0m
[30;1m77 | [0m[35m        self._metadata_key_mapping = self._conf.get(FileSystem.FILE_METADATA_MAPPING_KEY).as_plain_o[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m    @retry(retry_on_exception=is_retriable_error, stop_max_attempt_number=3, wait_exponential_multip[0m

[31m--[ [0m[34mMatch #[0m[33m346[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/user.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m194 | [0m[35m[0m
[30;1m195 | [0m[35m        record = RDSUser(rk=User.get_user_model_key(email=self.email))[0m
[30;1m196 | [0m[35m        # set value for attributes of user record if the value is not empty[0m
[30;1m197 | [0m[35m        # or the flag allows to update empty values[0m
[30;1m198 | [0m[35m        for attr, value in record_attr_map.items():[0m
[30;1m199 | [0m[35m            if value or not self.do_not_update_empty_attribute:[0m
[30;1m200 | [0m[35m                record.__setattr__(attr.key, value)  # type: ignore[0m

[31m--[ [0m[34mMatch #[0m[33m347[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/user.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m92 | [0m[35m        self.team_name = team_name[0m
[30;1m93 | [0m[35m        self.manager_email = manager_email[0m
[30;1m94 | [0m[35m        self.employee_type = employee_type[0m
[30;1m95 | [0m[35m        # this attr not available in team service, either update team service, update with FE[0m
[30;1m96 | [0m[35m        self.slack_id = slack_id[0m
[30;1m97 | [0m[35m        self.is_active = is_active[0m
[30;1m98 | [0m[35m        self.profile_url = profile_url[0m

[31m--[ [0m[34mMatch #[0m[33m348[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/user.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m92 | [0m[35m        self.team_name = team_name[0m
[30;1m93 | [0m[35m        self.manager_email = manager_email[0m
[30;1m94 | [0m[35m        self.employee_type = employee_type[0m
[30;1m95 | [0m[35m        # this attr not available in team service, either update team service, update with FE[0m
[30;1m96 | [0m[35m        self.slack_id = slack_id[0m
[30;1m97 | [0m[35m        self.is_active = is_active[0m
[30;1m98 | [0m[35m        self.profile_url = profile_url[0m

[31m--[ [0m[34mMatch #[0m[33m349[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/user.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m80 | [0m[35m        :param role_name: the role_name of the user (e.g swe)[0m
[30;1m81 | [0m[35m        :param do_not_update_empty_attribute: If False, all empty or not defined params will be over[0m
[30;1m82 | [0m[35m        empty string.[0m
[30;1m83 | [0m[35m        :param kwargs: Any K/V attributes we want to update the[0m
[30;1m84 | [0m[35m        """[0m
[30;1m85 | [0m[35m        self.first_name = first_name[0m
[30;1m86 | [0m[35m        self.last_name = last_name[0m

[31m--[ [0m[34mMatch #[0m[33m350[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/user.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m75 | [0m[35m        :param is_active:[0m
[30;1m76 | [0m[35m        :param profile_url:[0m
[30;1m77 | [0m[35m        :param updated_at: everytime we update the node, we will push the timestamp.[0m
[30;1m78 | [0m[35m                           then we will have a cron job to update the ex-employee nodes based on[0m
[30;1m79 | [0m[35m                           the case if this timestamp hasn't been updated for two weeks.[0m
[30;1m80 | [0m[35m        :param role_name: the role_name of the user (e.g swe)[0m
[30;1m81 | [0m[35m        :param do_not_update_empty_attribute: If False, all empty or not defined params will be over[0m

[31m--[ [0m[34mMatch #[0m[33m351[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/user.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m74 | [0m[35m        :param manager_email:[0m
[30;1m75 | [0m[35m        :param is_active:[0m
[30;1m76 | [0m[35m        :param profile_url:[0m
[30;1m77 | [0m[35m        :param updated_at: everytime we update the node, we will push the timestamp.[0m
[30;1m78 | [0m[35m                           then we will have a cron job to update the ex-employee nodes based on[0m
[30;1m79 | [0m[35m                           the case if this timestamp hasn't been updated for two weeks.[0m
[30;1m80 | [0m[35m        :param role_name: the role_name of the user (e.g swe)[0m

[31m--[ [0m[34mMatch #[0m[33m352[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/user.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m206 | [0m[35m[0m
[30;1m207 | [0m[35m    def _create_node_iterator(self) -> Iterator[GraphNode]:[0m
[30;1m208 | [0m[35m        """[0m
[30;1m209 | [0m[35m        Create an user node[0m
[30;1m210 | [0m[35m        :return:[0m
[30;1m211 | [0m[35m        """[0m
[30;1m212 | [0m[35m        user_node = self.get_user_node()[0m
[30;1m213 | [0m[35m        yield user_node[0m

[31m--[ [0m[34mMatch #[0m[33m353[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/user.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m174 | [0m[35m            attributes=node_attributes[0m
[30;1m175 | [0m[35m        )[0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m        return node[0m
[30;1m178 | [0m[35m[0m
[30;1m179 | [0m[35m    def get_user_record(self) -> RDSModel:[0m
[30;1m180 | [0m[35m        record_attr_map = {[0m
[30;1m181 | [0m[35m            RDSUser.email: self.email,[0m

[31m--[ [0m[34mMatch #[0m[33m354[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/user.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m168 | [0m[35m                if not v:[0m
[30;1m169 | [0m[35m                    del node_attributes[k][0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35m        node = GraphNode([0m
[30;1m172 | [0m[35m            key=User.get_user_model_key(email=self.email),[0m
[30;1m173 | [0m[35m            label=User.USER_NODE_LABEL,[0m
[30;1m174 | [0m[35m            attributes=node_attributes[0m

[31m--[ [0m[34mMatch #[0m[33m355[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/user.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m        self.email = email[0m
[30;1m90 | [0m[35m        self.github_username = github_username[0m
[30;1m91 | [0m[35m        # todo: team will be a separate node once Amundsen People supports team[0m
[30;1m92 | [0m[35m        self.team_name = team_name[0m
[30;1m93 | [0m[35m        self.manager_email = manager_email[0m
[30;1m94 | [0m[35m        self.employee_type = employee_type[0m

[31m--[ [0m[34mMatch #[0m[33m356[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/user.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m62 | [0m[35m                 **kwargs: Any[0m
[30;1m63 | [0m[35m                 ) -> None:[0m
[30;1m64 | [0m[35m        """[0m
[30;1m65 | [0m[35m        This class models user node for Amundsen people.[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m        :param first_name:[0m
[30;1m68 | [0m[35m        :param last_name:[0m

[31m--[ [0m[34mMatch #[0m[33m357[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/atlas_serializable.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mclass AtlasSerializable(object, metaclass=abc.ABCMeta):[0m
[30;1m12 | [0m[35m    """[0m
[30;1m13 | [0m[35m    A Serializable abstract class asks subclass to implement next node or[0m
[30;1m14 | [0m[35m    next relation in dict form so that it can be serialized to CSV file.[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m    Any model class that needs to be pushed to a atlas should inherit this class.[0m

[31m--[ [0m[34mMatch #[0m[33m358[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_base_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m144 | [0m[35m    # See https://www.elastic.co/guide/en/ecs/master/ecs-base.html[0m
[30;1m145 | [0m[35m    @property[0m
[30;1m146 | [0m[35m    def _time_field(self) -> str:[0m
[30;1m147 | [0m[35m        return self.conf.get(ElasticsearchBaseExtractor.ELASTICSEARCH_TIME_FIELD, '@timestamp')[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m    @abc.abstractmethod[0m
[30;1m150 | [0m[35m    def _get_extract_iter(self) -> Iterator[Union[Any, None]]:[0m

[31m--[ [0m[34mMatch #[0m[33m359[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_base_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m    @property[0m
[30;1m137 | [0m[35m    def _correct_sort_order(self) -> bool:[0m
[30;1m138 | [0m[35m        try:[0m
[30;1m139 | [0m[35m            return self.conf.get(ElasticsearchBaseExtractor.ELASTICSEARCH_CORRECT_SORT_ORDER)[0m
[30;1m140 | [0m[35m        except Exception:[0m
[30;1m141 | [0m[35m            return False[0m
[30;1m142 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m360[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_base_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m129 | [0m[35m    @property[0m
[30;1m130 | [0m[35m    def _extract_technical_details(self) -> bool:[0m
[30;1m131 | [0m[35m        try:[0m
[30;1m132 | [0m[35m            return self.conf.get(ElasticsearchBaseExtractor.ELASTICSEARCH_EXTRACT_TECHNICAL_DETAILS)[0m
[30;1m133 | [0m[35m        except Exception:[0m
[30;1m134 | [0m[35m            return False[0m
[30;1m135 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m361[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_base_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m    @property[0m
[30;1m126 | [0m[35m    def schema(self) -> str:[0m
[30;1m127 | [0m[35m        return self.conf.get(ElasticsearchBaseExtractor.SCHEMA)[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m    @property[0m
[30;1m130 | [0m[35m    def _extract_technical_details(self) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m362[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_base_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m    @property[0m
[30;1m122 | [0m[35m    def cluster(self) -> str:[0m
[30;1m123 | [0m[35m        return self.conf.get(ElasticsearchBaseExtractor.CLUSTER)[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m    @property[0m
[30;1m126 | [0m[35m    def schema(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m363[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_base_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m101 | [0m[35m                else:[0m
[30;1m102 | [0m[35m                    cols.append(ColumnMetadata(name=qualified_col_name,[0m
[30;1m103 | [0m[35m                                               description='',[0m
[30;1m104 | [0m[35m                                               col_type=col_mapping.get('type', ''),[0m
[30;1m105 | [0m[35m                                               sort_order=0))[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m        return cols[0m

[31m--[ [0m[34mMatch #[0m[33m364[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_base_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m94 | [0m[35m            if isinstance(col_mapping, dict):[0m
[30;1m95 | [0m[35m                if col_mapping.__contains__('properties'):[0m
[30;1m96 | [0m[35m                    # Need to recurse[0m
[30;1m97 | [0m[35m                    inner_mapping: Dict = col_mapping.get('properties', {})[0m
[30;1m98 | [0m[35m                    cols.extend(self._get_attributes(input_mapping=inner_mapping,[0m
[30;1m99 | [0m[35m                                                     parent_col_name=qualified_col_name,[0m
[30;1m100 | [0m[35m                                                     separator=separator))[0m

[31m--[ [0m[34mMatch #[0m[33m365[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_base_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m            if int(version.split('.')[0]) >= 7:[0m
[30;1m78 | [0m[35m                properties = mappings.get('properties', dict())[0m
[30;1m79 | [0m[35m            else:[0m
[30;1m80 | [0m[35m                properties = list(mappings.values())[0].get('properties', dict())[0m
[30;1m81 | [0m[35m        except Exception:[0m
[30;1m82 | [0m[35m            properties = dict()[0m
[30;1m83 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m366[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_base_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m        try:[0m
[30;1m77 | [0m[35m            if int(version.split('.')[0]) >= 7:[0m
[30;1m78 | [0m[35m                properties = mappings.get('properties', dict())[0m
[30;1m79 | [0m[35m            else:[0m
[30;1m80 | [0m[35m                properties = list(mappings.values())[0].get('properties', dict())[0m
[30;1m81 | [0m[35m        except Exception:[0m

[31m--[ [0m[34mMatch #[0m[33m367[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_base_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m            return None[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m    def _get_index_mapping_properties(self, index: Dict) -> Optional[Dict]:[0m
[30;1m70 | [0m[35m        mappings = index.get('mappings', dict())[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m        # Mapping types were removed in Elasticsearch 7. As a result, index mappings are formatted d[0m
[30;1m73 | [0m[35m        # See https://www.elastic.co/guide/en/elasticsearch/reference/current/removal-of-types.html[0m

[31m--[ [0m[34mMatch #[0m[33m368[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_base_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m    def _get_index_creation_date(self, index_metadata: Dict) -> Optional[float]:[0m
[30;1m64 | [0m[35m        try:[0m
[30;1m65 | [0m[35m            return float(index_metadata.get('settings', dict()).get('index').get('creation_date'))[0m
[30;1m66 | [0m[35m        except Exception:[0m
[30;1m67 | [0m[35m            return None[0m
[30;1m68 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m369[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_base_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m    def _get_index_creation_date(self, index_metadata: Dict) -> Optional[float]:[0m
[30;1m64 | [0m[35m        try:[0m
[30;1m65 | [0m[35m            return float(index_metadata.get('settings', dict()).get('index').get('creation_date'))[0m
[30;1m66 | [0m[35m        except Exception:[0m
[30;1m67 | [0m[35m            return None[0m
[30;1m68 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m370[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_base_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m    def _get_index_creation_date(self, index_metadata: Dict) -> Optional[float]:[0m
[30;1m64 | [0m[35m        try:[0m
[30;1m65 | [0m[35m            return float(index_metadata.get('settings', dict()).get('index').get('creation_date'))[0m
[30;1m66 | [0m[35m        except Exception:[0m
[30;1m67 | [0m[35m            return None[0m
[30;1m68 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m371[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_base_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m50 | [0m[35m        result = dict()[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m        try:[0m
[30;1m53 | [0m[35m            _indexes = self.es.indices.get('*')[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m            for k, v in _indexes.items():[0m
[30;1m56 | [0m[35m                if not k.startswith('.'):[0m

[31m--[ [0m[34mMatch #[0m[33m372[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_base_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m44 | [0m[35m        self.es = self.conf.get(ElasticsearchBaseExtractor.ELASTICSEARCH_CLIENT_CONFIG_KEY)[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m    def _get_es_version(self) -> str:[0m
[30;1m47 | [0m[35m        return self.es.info().get('version').get('number')[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m    def _get_indexes(self) -> Dict:[0m
[30;1m50 | [0m[35m        result = dict()[0m

[31m--[ [0m[34mMatch #[0m[33m373[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_base_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m44 | [0m[35m        self.es = self.conf.get(ElasticsearchBaseExtractor.ELASTICSEARCH_CLIENT_CONFIG_KEY)[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m    def _get_es_version(self) -> str:[0m
[30;1m47 | [0m[35m        return self.es.info().get('version').get('number')[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m    def _get_indexes(self) -> Dict:[0m
[30;1m50 | [0m[35m        result = dict()[0m

[31m--[ [0m[34mMatch #[0m[33m374[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_base_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m        self.conf = conf[0m
[30;1m42 | [0m[35m        self._extract_iter = self._get_extract_iter()[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m        self.es = self.conf.get(ElasticsearchBaseExtractor.ELASTICSEARCH_CLIENT_CONFIG_KEY)[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m    def _get_es_version(self) -> str:[0m
[30;1m47 | [0m[35m        return self.es.info().get('version').get('number')[0m

[31m--[ [0m[34mMatch #[0m[33m375[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_base_extractor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m140 | [0m[35m        except Exception:[0m
[30;1m141 | [0m[35m            return False[0m
[30;1m142 | [0m[35m[0m
[30;1m143 | [0m[35m    # Default time field is @timestamp to match ECS[0m
[30;1m144 | [0m[35m    # See https://www.elastic.co/guide/en/ecs/master/ecs-base.html[0m
[30;1m145 | [0m[35m    @property[0m
[30;1m146 | [0m[35m    def _time_field(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m376[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_base_extractor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35m    ELASTICSEARCH_EXTRACT_TECHNICAL_DETAILS = 'extract_technical_details'[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    # For backwards compatibility, the Elasticsearch extractor does not add sort_order to columns by[0m
[30;1m28 | [0m[35m    # Set this to true in the conf for columns to have correct sort order.[0m
[30;1m29 | [0m[35m    ELASTICSEARCH_CORRECT_SORT_ORDER = 'correct_sort_order'[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m    # Set this to the name of the field representing time.[0m

[31m--[ [0m[34mMatch #[0m[33m377[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_base_extractor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35m    Extractor to extract index metadata from Elasticsearch[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m    By default, the extractor does not add sort_order to columns. Set ELASTICSEARCH_CORRECT_SORT_ORD[0m
[30;1m19 | [0m[35m    for columns to have correct sort order.[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m    Set ELASTICSEARCH_TIME_FIELD to the name of the field representing time.[0m
[30;1m22 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m378[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/description_metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m    def _create_relation_iterator(self) -> Iterator[GraphRelationship]:[0m
[30;1m139 | [0m[35m        if not self.start_label:[0m
[30;1m140 | [0m[35m            raise Exception('Required relation start node label cannot be None')[0m
[30;1m141 | [0m[35m        if not self.start_key:[0m
[30;1m142 | [0m[35m            raise Exception('Required relation start key cannot be None')[0m
[30;1m143 | [0m[35m        if not self.description_key:[0m

[31m--[ [0m[34mMatch #[0m[33m379[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/description_metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m    def _create_node_iterator(self) -> Iterator[GraphNode]:[0m
[30;1m134 | [0m[35m        if not self.description_key:[0m
[30;1m135 | [0m[35m            raise Exception('Required description node key cannot be None')[0m
[30;1m136 | [0m[35m        yield self.get_node(self.description_key)[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m    def _create_relation_iterator(self) -> Iterator[GraphRelationship]:[0m

[31m--[ [0m[34mMatch #[0m[33m380[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/description_metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m99 | [0m[35m                DescriptionMetadata.DESCRIPTION_TEXT: self.text[0m
[30;1m100 | [0m[35m            }[0m
[30;1m101 | [0m[35m        )[0m
[30;1m102 | [0m[35m        return node[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m    def get_relation(self,[0m
[30;1m105 | [0m[35m                     start_node: str,[0m
[30;1m106 | [0m[35m                     start_key: str,[0m

[31m--[ [0m[34mMatch #[0m[33m381[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/description_metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m91 | [0m[35m        return f'{start_key}/{self.get_description_id()}' if start_key else None[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m    def get_node(self, node_key: str) -> GraphNode:[0m
[30;1m94 | [0m[35m        node = GraphNode([0m
[30;1m95 | [0m[35m            key=node_key,[0m
[30;1m96 | [0m[35m            label=self.label,[0m
[30;1m97 | [0m[35m            attributes={[0m

[31m--[ [0m[34mMatch #[0m[33m382[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/description_metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m71 | [0m[35m                                    start_label: Optional[str] = None,  # Table, Column, Schema[0m
[30;1m72 | [0m[35m                                    start_key: Optional[str] = None,[0m
[30;1m73 | [0m[35m                                    ) -> Optional['DescriptionMetadata']:[0m
[30;1m74 | [0m[35m        # We do not want to create a node if there is no description text![0m
[30;1m75 | [0m[35m        if text is None:[0m
[30;1m76 | [0m[35m            return None[0m
[30;1m77 | [0m[35m        description_node = DescriptionMetadata(text=text,[0m

[31m--[ [0m[34mMatch #[0m[33m383[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/mysql_metadata_extractor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m        self.sql_stmt = sql_alch_conf.get_string(SQLAlchemyExtractor.EXTRACT_SQL)[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m        LOGGER.info('SQL for mysql metadata: %s', self.sql_stmt)[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m        self._alchemy_extractor.init(sql_alch_conf)[0m
[30;1m87 | [0m[35m        self._extract_iter: Union[None, Iterator] = None[0m

[31m--[ [0m[34mMatch #[0m[33m384[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/mysql_metadata_extractor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m24 | [0m[35m    """[0m
[30;1m25 | [0m[35m    Extracts mysql table and column metadata from underlying meta store database using SQLAlchemyExt[0m
[30;1m26 | [0m[35m    """[0m
[30;1m27 | [0m[35m    # SELECT statement from mysql information_schema to extract table and column metadata[0m
[30;1m28 | [0m[35m    SQL_STATEMENT = """[0m
[30;1m29 | [0m[35m        SELECT[0m
[30;1m30 | [0m[35m        lower(c.column_name) AS col_name,[0m

[31m--[ [0m[34mMatch #[0m[33m385[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/mysql_metadata_extractor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mclass MysqlMetadataExtractor(Extractor):[0m
[30;1m24 | [0m[35m    """[0m
[30;1m25 | [0m[35m    Extracts mysql table and column metadata from underlying meta store database using SQLAlchemyExt[0m
[30;1m26 | [0m[35m    """[0m
[30;1m27 | [0m[35m    # SELECT statement from mysql information_schema to extract table and column metadata[0m
[30;1m28 | [0m[35m    SQL_STATEMENT = """[0m

[31m--[ [0m[34mMatch #[0m[33m386[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/query/base.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m63 | [0m[35m        Returns the first non-whitespace character encountered.[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m        This should never return `None` since the query text is striped before being processed.[0m
[30;1m66 | [0m[35m        That is, if the current character is a whitespace character, then there remains at least one[0m
[30;1m67 | [0m[35m        character in the stream.[0m
[30;1m68 | [0m[35m        """[0m
[30;1m69 | [0m[35m        for c in it:[0m

[31m--[ [0m[34mMatch #[0m[33m387[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/query/base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m        Note:[0m
[30;1m23 | [0m[35m        Making characters outside quoted regions lower case does not in general result in an equival[0m
[30;1m24 | [0m[35m        For example, with MySQL the case sensitivity of table names is operating system dependant.[0m
[30;1m25 | [0m[35m        In practice, modern systems rarely rely on case sensitivity, and since making the non-quoted[0m
[30;1m26 | [0m[35m        query lowercase is very helpful in identifying queries, we go ahead and do so.[0m
[30;1m27 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m388[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/loader/file_system_mysql_csv_loader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m128 | [0m[35m        :param file_suffix:[0m
[30;1m129 | [0m[35m        :return:[0m
[30;1m130 | [0m[35m        """[0m
[30;1m131 | [0m[35m        writer = file_mapping.get(key)[0m
[30;1m132 | [0m[35m        if writer:[0m
[30;1m133 | [0m[35m            return writer[0m
[30;1m134 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m389[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/loader/file_system_mysql_csv_loader.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m119 | [0m[35m                    ) -> DictWriter:[0m
[30;1m120 | [0m[35m        """[0m
[30;1m121 | [0m[35m        Finds a writer based on csv record, key.[0m
[30;1m122 | [0m[35m        If writer does not exist, it's creates a csv writer and update the mapping.[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m        :param csv_record_dict:[0m
[30;1m125 | [0m[35m        :param file_mapping:[0m

[31m--[ [0m[34mMatch #[0m[33m390[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/task/neo4j_staleness_removal_task.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m251 | [0m[35m[0m
[30;1m252 | [0m[35m        stale_pct = stale_record_count * 100 / total_record_count[0m
[30;1m253 | [0m[35m[0m
[30;1m254 | [0m[35m        threshold = self.staleness_pct_dict.get(target_type, self.staleness_pct)[0m
[30;1m255 | [0m[35m        if stale_pct >= threshold:[0m
[30;1m256 | [0m[35m            raise Exception(f'Staleness percentage of {target_type} is {stale_pct} %. '[0m
[30;1m257 | [0m[35m                            f'Stopping due to over threshold {threshold} %')[0m

[31m--[ [0m[34mMatch #[0m[33m391[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/task/neo4j_staleness_removal_task.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35m        self._driver = GraphDatabase.driver(**driver_args)[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m        self.db_name = conf.get(NEO4J_DATABASE_NAME)[0m
[30;1m159 | [0m[35m[0m
[30;1m160 | [0m[35m    def run(self) -> None:[0m
[30;1m161 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m392[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/task/neo4j_staleness_removal_task.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m146 | [0m[35m[0m
[30;1m147 | [0m[35m        # if NEO4J_VALIDATE_SSL or NEO4J_ENCRYPTED are set in config pass them to the driver[0m
[30;1m148 | [0m[35m        validate_ssl_conf = conf.get(NEO4J_VALIDATE_SSL, None)[0m
[30;1m149 | [0m[35m        encrypted_conf = conf.get(NEO4J_ENCRYPTED, None)[0m
[30;1m150 | [0m[35m        if validate_ssl_conf is not None:[0m
[30;1m151 | [0m[35m            driver_args['trust'] = neo4j.TRUST_SYSTEM_CA_SIGNED_CERTIFICATES if validate_ssl_conf \[0m
[30;1m152 | [0m[35m                else neo4j.TRUST_ALL_CERTIFICATES[0m

[31m--[ [0m[34mMatch #[0m[33m393[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/task/neo4j_staleness_removal_task.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m145 | [0m[35m            driver_args.update(default_security_conf)[0m
[30;1m146 | [0m[35m[0m
[30;1m147 | [0m[35m        # if NEO4J_VALIDATE_SSL or NEO4J_ENCRYPTED are set in config pass them to the driver[0m
[30;1m148 | [0m[35m        validate_ssl_conf = conf.get(NEO4J_VALIDATE_SSL, None)[0m
[30;1m149 | [0m[35m        encrypted_conf = conf.get(NEO4J_ENCRYPTED, None)[0m
[30;1m150 | [0m[35m        if validate_ssl_conf is not None:[0m
[30;1m151 | [0m[35m            driver_args['trust'] = neo4j.TRUST_SYSTEM_CA_SIGNED_CERTIFICATES if validate_ssl_conf \[0m

[31m--[ [0m[34mMatch #[0m[33m394[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/task/neo4j_staleness_removal_task.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m115 | [0m[35m        self.batch_size = conf.get_int(BATCH_SIZE)[0m
[30;1m116 | [0m[35m        self.dry_run = conf.get_bool(DRY_RUN)[0m
[30;1m117 | [0m[35m        self.staleness_pct = conf.get_int(STALENESS_MAX_PCT)[0m
[30;1m118 | [0m[35m        self.staleness_pct_dict = conf.get(STALENESS_PCT_MAX_DICT)[0m
[30;1m119 | [0m[35m        self.retain_data_with_no_publisher_metadata = conf.get_bool(RETAIN_DATA_WITH_NO_PUBLISHER_ME[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m        if JOB_PUBLISH_TAG in conf and MS_TO_EXPIRE in conf:[0m

[31m--[ [0m[34mMatch #[0m[33m395[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/task/neo4j_staleness_removal_task.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m24 | [0m[35mNEO4J_MAX_CONN_LIFE_TIME_SEC = 'neo4j_max_conn_life_time_sec'[0m
[30;1m25 | [0m[35mNEO4J_USER = 'neo4j_user'[0m
[30;1m26 | [0m[35mNEO4J_PASSWORD = 'neo4j_password'[0m
[30;1m27 | [0m[35m# in Neo4j (v4.0+), we can create and use more than one active database at the same time[0m
[30;1m28 | [0m[35mNEO4J_DATABASE_NAME = 'neo4j_database'[0m
[30;1m29 | [0m[35mNEO4J_ENCRYPTED = 'neo4j_encrypted'[0m
[30;1m30 | [0m[35m"""NEO4J_ENCRYPTED is a boolean indicating whether to use SSL/TLS when connecting."""[0m

[31m--[ [0m[34mMatch #[0m[33m396[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/task/neo4j_staleness_removal_task.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m70 | [0m[35m    A Specific task that is to remove stale nodes and relations in Neo4j.[0m
[30;1m71 | [0m[35m    It will use "published_tag" attribute assigned from Neo4jCsvPublisher and if "published_tag" is [0m
[30;1m72 | [0m[35m    the one it is getting it from the config, it will regard the node/relation as stale.[0m
[30;1m73 | [0m[35m    Not all resource is being published by Neo4jCsvPublisher and you can only set specific LABEL of [0m
[30;1m74 | [0m[35m    of relation to perform this deletion.[0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m397[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/task/neo4j_staleness_removal_task.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m24 | [0m[35mNEO4J_MAX_CONN_LIFE_TIME_SEC = 'neo4j_max_conn_life_time_sec'[0m
[30;1m25 | [0m[35mNEO4J_USER = 'neo4j_user'[0m
[30;1m26 | [0m[35mNEO4J_PASSWORD = 'neo4j_password'[0m
[30;1m27 | [0m[35m# in Neo4j (v4.0+), we can create and use more than one active database at the same time[0m
[30;1m28 | [0m[35mNEO4J_DATABASE_NAME = 'neo4j_database'[0m
[30;1m29 | [0m[35mNEO4J_ENCRYPTED = 'neo4j_encrypted'[0m
[30;1m30 | [0m[35m"""NEO4J_ENCRYPTED is a boolean indicating whether to use SSL/TLS when connecting."""[0m
[30;1m31 | [0m[35mNEO4J_VALIDATE_SSL = 'neo4j_validate_ssl'[0m

[31m--[ [0m[34mMatch #[0m[33m398[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/task/neo4j_staleness_removal_task.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mimport logging[0m
[30;1m5 | [0m[35mimport textwrap[0m
[30;1m6 | [0m[35mimport time[0m
[30;1m7 | [0m[35mfrom typing import ([0m
[30;1m8 | [0m[35m    Any, Dict, Iterable, Union,[0m
[30;1m9 | [0m[35m)[0m
[30;1m10 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m399[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m197 | [0m[35m        if self.add_publisher_metadata and not self.publish_tag:[0m
[30;1m198 | [0m[35m            raise Exception(f'{JOB_PUBLISH_TAG} should not be empty')[0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35m        self._relation_preprocessor = conf.get(RELATION_PREPROCESSOR)[0m
[30;1m201 | [0m[35m[0m
[30;1m202 | [0m[35m        LOGGER.info('Publishing Node csv files %s, and Relation CSV files %s',[0m
[30;1m203 | [0m[35m                    self._node_files,[0m

[31m--[ [0m[34mMatch #[0m[33m400[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m192 | [0m[35m        self.deadlock_node_labels = set(conf.get_list(NEO4J_DEADLOCK_NODE_LABELS, default=[]))[0m
[30;1m193 | [0m[35m        self.labels: Set[str] = set()[0m
[30;1m194 | [0m[35m        self.publish_tag: str = conf.get_string(JOB_PUBLISH_TAG)[0m
[30;1m195 | [0m[35m        self.additional_fields: Dict = conf.get(ADDITIONAL_FIELDS)[0m
[30;1m196 | [0m[35m        self.add_publisher_metadata: bool = conf.get_bool(ADD_PUBLISHER_METADATA)[0m
[30;1m197 | [0m[35m        if self.add_publisher_metadata and not self.publish_tag:[0m
[30;1m198 | [0m[35m            raise Exception(f'{JOB_PUBLISH_TAG} should not be empty')[0m

[31m--[ [0m[34mMatch #[0m[33m401[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m        # if NEO4J_VALIDATE_SSL or NEO4J_ENCRYPTED are set in config pass them to the driver[0m
[30;1m173 | [0m[35m        validate_ssl_conf = conf.get(NEO4J_VALIDATE_SSL, None)[0m
[30;1m174 | [0m[35m        encrypted_conf = conf.get(NEO4J_ENCRYPTED, None)[0m
[30;1m175 | [0m[35m        if validate_ssl_conf is not None:[0m
[30;1m176 | [0m[35m            driver_args['trust'] = neo4j.TRUST_SYSTEM_CA_SIGNED_CERTIFICATES if validate_ssl_conf \[0m
[30;1m177 | [0m[35m                else neo4j.TRUST_ALL_CERTIFICATES[0m

[31m--[ [0m[34mMatch #[0m[33m402[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m170 | [0m[35m            driver_args.update(default_security_conf)[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m        # if NEO4J_VALIDATE_SSL or NEO4J_ENCRYPTED are set in config pass them to the driver[0m
[30;1m173 | [0m[35m        validate_ssl_conf = conf.get(NEO4J_VALIDATE_SSL, None)[0m
[30;1m174 | [0m[35m        encrypted_conf = conf.get(NEO4J_ENCRYPTED, None)[0m
[30;1m175 | [0m[35m        if validate_ssl_conf is not None:[0m
[30;1m176 | [0m[35m            driver_args['trust'] = neo4j.TRUST_SYSTEM_CA_SIGNED_CERTIFICATES if validate_ssl_conf \[0m

[31m--[ [0m[34mMatch #[0m[33m403[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m325 | [0m[35m        template = Template("""[0m
[30;1m326 | [0m[35m            MERGE (node:{{ LABEL }} {key: $KEY})[0m
[30;1m327 | [0m[35m            ON CREATE SET {{ PROP_BODY }}[0m
[30;1m328 | [0m[35m            {% if update %} ON MATCH SET {{ PROP_BODY }} {% endif %}[0m
[30;1m329 | [0m[35m        """)[0m
[30;1m330 | [0m[35m[0m
[30;1m331 | [0m[35m        prop_body = self._create_props_body(node_record, NODE_REQUIRED_KEYS, 'node')[0m

[31m--[ [0m[34mMatch #[0m[33m404[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35mNEO4J_USER = Neo4jCsvPublisherConfigs.NEO4J_USER[0m
[30;1m59 | [0m[35mNEO4J_PASSWORD = Neo4jCsvPublisherConfigs.NEO4J_PASSWORD[0m
[30;1m60 | [0m[35m# in Neo4j (v4.0+), we can create and use more than one active database at the same time[0m
[30;1m61 | [0m[35mNEO4J_DATABASE_NAME = Neo4jCsvPublisherConfigs.NEO4J_DATABASE_NAME[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m# NEO4J_ENCRYPTED is a boolean indicating whether to use SSL/TLS when connecting[0m

[31m--[ [0m[34mMatch #[0m[33m405[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m504 | [0m[35m[0m
[30;1m505 | [0m[35m    def _try_create_index(self, label: str) -> None:[0m
[30;1m506 | [0m[35m        """[0m
[30;1m507 | [0m[35m        For any label seen first time for this publisher it will try to create unique index.[0m
[30;1m508 | [0m[35m        Neo4j ignores a second creation in 3.x, but raises an error in 4.x.[0m
[30;1m509 | [0m[35m        :param label:[0m
[30;1m510 | [0m[35m        :return:[0m

[31m--[ [0m[34mMatch #[0m[33m406[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m356 | [0m[35m            with open(relation_file, 'r', encoding='utf8') as relation_csv:[0m
[30;1m357 | [0m[35m                for rel_record in pandas.read_csv(relation_csv,[0m
[30;1m358 | [0m[35m                                                  na_filter=False).to_dict(orient="records"):[0m
[30;1m359 | [0m[35m                    # TODO not sure if deadlock on badge node arises in preporcessing or not[0m
[30;1m360 | [0m[35m                    stmt, params = self._relation_preprocessor.preprocess_cypher([0m
[30;1m361 | [0m[35m                        start_label=rel_record[RELATION_START_LABEL],[0m
[30;1m362 | [0m[35m                        end_label=rel_record[RELATION_END_LABEL],[0m

[31m--[ [0m[34mMatch #[0m[33m407[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m318 | [0m[35m[0m
[30;1m319 | [0m[35m    def create_node_merge_statement(self, node_record: dict) -> str:[0m
[30;1m320 | [0m[35m        """[0m
[30;1m321 | [0m[35m        Creates node merge statement[0m
[30;1m322 | [0m[35m        :param node_record:[0m
[30;1m323 | [0m[35m        :return:[0m
[30;1m324 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m408[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m307 | [0m[35m[0m
[30;1m308 | [0m[35m    def is_create_only_node(self, node_record: dict) -> bool:[0m
[30;1m309 | [0m[35m        """[0m
[30;1m310 | [0m[35m        Check if node can be updated[0m
[30;1m311 | [0m[35m        :param node_record:[0m
[30;1m312 | [0m[35m        :return:[0m
[30;1m313 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m409[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m283 | [0m[35m        Iterate over the csv records of a file, each csv record transform to Merge statement[0m
[30;1m284 | [0m[35m        and will be executed.[0m
[30;1m285 | [0m[35m        All nodes should have a unique key, and this method will try to create unique index on[0m
[30;1m286 | [0m[35m        the LABEL when it sees first time within a job scope.[0m
[30;1m287 | [0m[35m        Example of Cypher query executed by this method:[0m
[30;1m288 | [0m[35m        MERGE (col_test_id1:Column {key: 'presto://gold.test_schema1/test_table1/test_id1'})[0m
[30;1m289 | [0m[35m        ON CREATE SET col_test_id1.name = 'test_id1',[0m

[31m--[ [0m[34mMatch #[0m[33m410[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m    def _create_indices(self, node_file: str) -> None:[0m
[30;1m264 | [0m[35m        """[0m
[30;1m265 | [0m[35m        Go over the node file and try creating unique index[0m
[30;1m266 | [0m[35m        :param node_file:[0m
[30;1m267 | [0m[35m        :return:[0m
[30;1m268 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m411[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m228 | [0m[35m        for node_file in self._node_files:[0m
[30;1m229 | [0m[35m            self._create_indices(node_file=node_file)[0m
[30;1m230 | [0m[35m[0m
[30;1m231 | [0m[35m        LOGGER.info('Publishing Node files: %s', self._node_files)[0m
[30;1m232 | [0m[35m        try:[0m
[30;1m233 | [0m[35m            tx = self._session.begin_transaction()[0m
[30;1m234 | [0m[35m            while True:[0m

[31m--[ [0m[34mMatch #[0m[33m412[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35m        start = time.time()[0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m        LOGGER.info('Creating indices using Node files: %s', self._node_files)[0m
[30;1m228 | [0m[35m        for node_file in self._node_files:[0m
[30;1m229 | [0m[35m            self._create_indices(node_file=node_file)[0m
[30;1m230 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m413[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35m        self._relation_preprocessor = conf.get(RELATION_PREPROCESSOR)[0m
[30;1m201 | [0m[35m[0m
[30;1m202 | [0m[35m        LOGGER.info('Publishing Node csv files %s, and Relation CSV files %s',[0m
[30;1m203 | [0m[35m                    self._node_files,[0m
[30;1m204 | [0m[35m                    self._relation_files)[0m
[30;1m205 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m414[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m186 | [0m[35m        self._transaction_size = conf.get_int(NEO4J_TRANSACTION_SIZE)[0m
[30;1m187 | [0m[35m        self._confirm_rel_created = conf.get_bool(NEO4J_RELATIONSHIP_CREATION_CONFIRM)[0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m        # config is list of node label.[0m
[30;1m190 | [0m[35m        # When set, this list specifies a list of nodes that shouldn't be updated, if exists[0m
[30;1m191 | [0m[35m        self.create_only_nodes = set(conf.get_list(NEO4J_CREATE_ONLY_NODES, default=[]))[0m
[30;1m192 | [0m[35m        self.deadlock_node_labels = set(conf.get_list(NEO4J_DEADLOCK_NODE_LABELS, default=[]))[0m

[31m--[ [0m[34mMatch #[0m[33m415[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m135 | [0m[35m    One folder will contain CSV file(s) for Node where the other folder will contain CSV[0m
[30;1m136 | [0m[35m    file(s) for Relationship.[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m    Neo4j follows Label Node properties Graph and more information about this is in:[0m
[30;1m139 | [0m[35m    https://neo4j.com/docs/developer-manual/current/introduction/graphdb-concepts/[0m
[30;1m140 | [0m[35m[0m
[30;1m141 | [0m[35m    #TODO User UNWIND batch operation for better performance[0m

[31m--[ [0m[34mMatch #[0m[33m416[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m132 | [0m[35mclass Neo4jCsvPublisher(Publisher):[0m
[30;1m133 | [0m[35m    """[0m
[30;1m134 | [0m[35m    A Publisher takes two folders for input and publishes to Neo4j.[0m
[30;1m135 | [0m[35m    One folder will contain CSV file(s) for Node where the other folder will contain CSV[0m
[30;1m136 | [0m[35m    file(s) for Relationship.[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m    Neo4j follows Label Node properties Graph and more information about this is in:[0m

[31m--[ [0m[34mMatch #[0m[33m417[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m122 | [0m[35m                                          ADD_PUBLISHER_METADATA: True,[0m
[30;1m123 | [0m[35m                                          RELATION_PREPROCESSOR: NoopRelationPreprocessor()})[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m# transient error retries and sleep time[0m
[30;1m126 | [0m[35mRETRIES_NUMBER = 5[0m
[30;1m127 | [0m[35mSLEEP_TIME = 2[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35mLOGGER = logging.getLogger(__name__)[0m

[31m--[ [0m[34mMatch #[0m[33m418[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m102 | [0m[35mRELATION_START_KEY = 'START_KEY'[0m
[30;1m103 | [0m[35m# End node label[0m
[30;1m104 | [0m[35mRELATION_END_LABEL = 'END_LABEL'[0m
[30;1m105 | [0m[35m# Node node key[0m
[30;1m106 | [0m[35mRELATION_END_KEY = 'END_KEY'[0m
[30;1m107 | [0m[35m# Type for relationship (Start Node)->(End Node)[0m
[30;1m108 | [0m[35mRELATION_TYPE = 'TYPE'[0m

[31m--[ [0m[34mMatch #[0m[33m419[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m100 | [0m[35mRELATION_START_LABEL = 'START_LABEL'[0m
[30;1m101 | [0m[35m# Start node key[0m
[30;1m102 | [0m[35mRELATION_START_KEY = 'START_KEY'[0m
[30;1m103 | [0m[35m# End node label[0m
[30;1m104 | [0m[35mRELATION_END_LABEL = 'END_LABEL'[0m
[30;1m105 | [0m[35m# Node node key[0m
[30;1m106 | [0m[35mRELATION_END_KEY = 'END_KEY'[0m

[31m--[ [0m[34mMatch #[0m[33m420[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m98 | [0m[35m# Relationship relates two nodes together[0m
[30;1m99 | [0m[35m# Start node label[0m
[30;1m100 | [0m[35mRELATION_START_LABEL = 'START_LABEL'[0m
[30;1m101 | [0m[35m# Start node key[0m
[30;1m102 | [0m[35mRELATION_START_KEY = 'START_KEY'[0m
[30;1m103 | [0m[35m# End node label[0m
[30;1m104 | [0m[35mRELATION_END_LABEL = 'END_LABEL'[0m

[31m--[ [0m[34mMatch #[0m[33m421[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m96 | [0m[35mNODE_REQUIRED_KEYS = {NODE_LABEL_KEY, NODE_KEY_KEY}[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m# Relationship relates two nodes together[0m
[30;1m99 | [0m[35m# Start node label[0m
[30;1m100 | [0m[35mRELATION_START_LABEL = 'START_LABEL'[0m
[30;1m101 | [0m[35m# Start node key[0m
[30;1m102 | [0m[35mRELATION_START_KEY = 'START_KEY'[0m

[31m--[ [0m[34mMatch #[0m[33m422[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m92 | [0m[35mNODE_LABEL_KEY = 'LABEL'[0m
[30;1m93 | [0m[35m# A header for Node key[0m
[30;1m94 | [0m[35mNODE_KEY_KEY = 'KEY'[0m
[30;1m95 | [0m[35m# Required columns for Node[0m
[30;1m96 | [0m[35mNODE_REQUIRED_KEYS = {NODE_LABEL_KEY, NODE_KEY_KEY}[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m# Relationship relates two nodes together[0m
[30;1m99 | [0m[35m# Start node label[0m

[31m--[ [0m[34mMatch #[0m[33m423[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m90 | [0m[35mUNQUOTED_SUFFIX = ':UNQUOTED'[0m
[30;1m91 | [0m[35m# A header for Node label[0m
[30;1m92 | [0m[35mNODE_LABEL_KEY = 'LABEL'[0m
[30;1m93 | [0m[35m# A header for Node key[0m
[30;1m94 | [0m[35mNODE_KEY_KEY = 'KEY'[0m
[30;1m95 | [0m[35m# Required columns for Node[0m
[30;1m96 | [0m[35mNODE_REQUIRED_KEYS = {NODE_LABEL_KEY, NODE_KEY_KEY}[0m

[31m--[ [0m[34mMatch #[0m[33m424[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m88 | [0m[35m# CSV HEADER[0m
[30;1m89 | [0m[35m# A header with this suffix will be pass to Neo4j statement without quote[0m
[30;1m90 | [0m[35mUNQUOTED_SUFFIX = ':UNQUOTED'[0m
[30;1m91 | [0m[35m# A header for Node label[0m
[30;1m92 | [0m[35mNODE_LABEL_KEY = 'LABEL'[0m
[30;1m93 | [0m[35m# A header for Node key[0m
[30;1m94 | [0m[35mNODE_KEY_KEY = 'KEY'[0m

[31m--[ [0m[34mMatch #[0m[33m425[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m66 | [0m[35m# cert against system CAs[0m
[30;1m67 | [0m[35mNEO4J_VALIDATE_SSL = Neo4jCsvPublisherConfigs.NEO4J_VALIDATE_SSL[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m# This will be used to provide unique tag to the node and relationship[0m
[30;1m70 | [0m[35mJOB_PUBLISH_TAG = PublisherConfigs.JOB_PUBLISH_TAG[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m# any additional fields that should be added to nodes and rels through config[0m

[31m--[ [0m[34mMatch #[0m[33m426[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35mNEO4J_USER = Neo4jCsvPublisherConfigs.NEO4J_USER[0m
[30;1m59 | [0m[35mNEO4J_PASSWORD = Neo4jCsvPublisherConfigs.NEO4J_PASSWORD[0m
[30;1m60 | [0m[35m# in Neo4j (v4.0+), we can create and use more than one active database at the same time[0m
[30;1m61 | [0m[35mNEO4J_DATABASE_NAME = Neo4jCsvPublisherConfigs.NEO4J_DATABASE_NAME[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m# NEO4J_ENCRYPTED is a boolean indicating whether to use SSL/TLS when connecting[0m
[30;1m64 | [0m[35mNEO4J_ENCRYPTED = Neo4jCsvPublisherConfigs.NEO4J_ENCRYPTED[0m

[31m--[ [0m[34mMatch #[0m[33m427[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m52 | [0m[35m# list of nodes that are create only, and not updated if match exists[0m
[30;1m53 | [0m[35mNEO4J_CREATE_ONLY_NODES = Neo4jCsvPublisherConfigs.NEO4J_CREATE_ONLY_NODES[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m# list of node labels that could attempt to be accessed simultaneously[0m
[30;1m56 | [0m[35mNEO4J_DEADLOCK_NODE_LABELS = 'neo4j_deadlock_node_labels'[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35mNEO4J_USER = Neo4jCsvPublisherConfigs.NEO4J_USER[0m

[31m--[ [0m[34mMatch #[0m[33m428[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_csv_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mimport csv[0m
[30;1m5 | [0m[35mimport ctypes[0m
[30;1m6 | [0m[35mimport logging[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35mfrom io import open[0m
[30;1m9 | [0m[35mfrom os import listdir[0m
[30;1m10 | [0m[35mfrom os.path import isfile, join[0m
[30;1m11 | [0m[35mfrom typing import ([0m

[31m--[ [0m[34mMatch #[0m[33m429[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neptune_csv_publisher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m141 | [0m[35m                str(load_id),[0m
[30;1m142 | [0m[35m                repr(load_status_response)[0m
[30;1m143 | [0m[35m            ))[0m
[30;1m144 | [0m[35m        return load_status, load_status_payload.get('errors', {}).get('errorLogs', [])[0m
[30;1m145 | [0m[35m[0m
[30;1m146 | [0m[35m    def _get_file_paths(self) -> List[str]:[0m
[30;1m147 | [0m[35m        node_names = [[0m

[31m--[ [0m[34mMatch #[0m[33m430[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neptune_csv_publisher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m141 | [0m[35m                str(load_id),[0m
[30;1m142 | [0m[35m                repr(load_status_response)[0m
[30;1m143 | [0m[35m            ))[0m
[30;1m144 | [0m[35m        return load_status, load_status_payload.get('errors', {}).get('errorLogs', [])[0m
[30;1m145 | [0m[35m[0m
[30;1m146 | [0m[35m    def _get_file_paths(self) -> List[str]:[0m
[30;1m147 | [0m[35m        node_names = [[0m

[31m--[ [0m[34mMatch #[0m[33m431[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neptune_csv_publisher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m133 | [0m[35m            load_id=load_id,[0m
[30;1m134 | [0m[35m            errors=True[0m
[30;1m135 | [0m[35m        )[0m
[30;1m136 | [0m[35m        load_status_payload = load_status_response.get('payload', {})[0m
[30;1m137 | [0m[35m        try:[0m
[30;1m138 | [0m[35m            load_status = load_status_payload['overallStatus']['status'][0m
[30;1m139 | [0m[35m        except KeyError:[0m

[31m--[ [0m[34mMatch #[0m[33m432[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neptune_csv_publisher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m            """.format([0m
[30;1m125 | [0m[35m                error_code=error.get('errorCode'),[0m
[30;1m126 | [0m[35m                error_message=error.get('errorMessage'),[0m
[30;1m127 | [0m[35m                s3_path=error.get('fileName')[0m
[30;1m128 | [0m[35m            )[0m
[30;1m129 | [0m[35m            LOGGER.exception(exception_message)[0m
[30;1m130 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m433[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neptune_csv_publisher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m123 | [0m[35m            Failed File: {s3_path}[0m
[30;1m124 | [0m[35m            """.format([0m
[30;1m125 | [0m[35m                error_code=error.get('errorCode'),[0m
[30;1m126 | [0m[35m                error_message=error.get('errorMessage'),[0m
[30;1m127 | [0m[35m                s3_path=error.get('fileName')[0m
[30;1m128 | [0m[35m            )[0m
[30;1m129 | [0m[35m            LOGGER.exception(exception_message)[0m

[31m--[ [0m[34mMatch #[0m[33m434[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neptune_csv_publisher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m122 | [0m[35m            Error Message: {error_message}[0m
[30;1m123 | [0m[35m            Failed File: {s3_path}[0m
[30;1m124 | [0m[35m            """.format([0m
[30;1m125 | [0m[35m                error_code=error.get('errorCode'),[0m
[30;1m126 | [0m[35m                error_message=error.get('errorMessage'),[0m
[30;1m127 | [0m[35m                s3_path=error.get('fileName')[0m
[30;1m128 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m435[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neptune_csv_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35mclass NeptuneCSVPublisher(Publisher):[0m
[30;1m22 | [0m[35m    """[0m
[30;1m23 | [0m[35m    This Publisher takes two folders for input and publishes to Neptune.[0m
[30;1m24 | [0m[35m    One folder will contain CSV file(s) for Node where the other folder will contain CSV file(s) for[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    This publisher uses the bulk api found in[0m
[30;1m27 | [0m[35m    https://github.com/amundsen-io/amundsengremlin/blob/master/amundsen_gremlin/neptune_bulk_loader/[0m

[31m--[ [0m[34mMatch #[0m[33m436[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neptune_csv_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mimport datetime[0m
[30;1m5 | [0m[35mimport logging[0m
[30;1m6 | [0m[35mimport os[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35mfrom os import listdir[0m
[30;1m9 | [0m[35mfrom os.path import isfile, join[0m
[30;1m10 | [0m[35mfrom typing import List, Tuple[0m
[30;1m11 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m437[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/salesforce_extractor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m76 | [0m[35m    def _extract_table_metadata([0m
[30;1m77 | [0m[35m        self, object_name: str, data: Dict[str, Any][0m
[30;1m78 | [0m[35m    ) -> TableMetadata:[0m
[30;1m79 | [0m[35m        # sort the fields by name because Amundsen requires a sort order for the columns and I did[0m
[30;1m80 | [0m[35m        # not see one in the response[0m
[30;1m81 | [0m[35m        fields = sorted(data["fields"], key=lambda x: x["name"])[0m
[30;1m82 | [0m[35m        columns = [[0m

[31m--[ [0m[34mMatch #[0m[33m438[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/salesforce_extractor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m76 | [0m[35m    def _extract_table_metadata([0m
[30;1m77 | [0m[35m        self, object_name: str, data: Dict[str, Any][0m
[30;1m78 | [0m[35m    ) -> TableMetadata:[0m
[30;1m79 | [0m[35m        # sort the fields by name because Amundsen requires a sort order for the columns and I did[0m
[30;1m80 | [0m[35m        # not see one in the response[0m
[30;1m81 | [0m[35m        fields = sorted(data["fields"], key=lambda x: x["name"])[0m
[30;1m82 | [0m[35m        columns = [[0m

[31m--[ [0m[34mMatch #[0m[33m439[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/rest_api/rest_api_query.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m206 | [0m[35m        :return:[0m
[30;1m207 | [0m[35m        """[0m
[30;1m208 | [0m[35m        LOGGER.info('Calling URL %s', url)[0m
[30;1m209 | [0m[35m        response = requests.get(url, **self._params)[0m
[30;1m210 | [0m[35m        response.raise_for_status()[0m
[30;1m211 | [0m[35m        return response[0m
[30;1m212 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m440[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/rest_api/rest_api_query.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m140 | [0m[35m[0m
[30;1m141 | [0m[35m        for record_dict in self._inner_rest_api_query.execute():[0m
[30;1m142 | [0m[35m[0m
[30;1m143 | [0m[35m            first_try = True  # To control pagination. Always pass the while loop on the first try[0m
[30;1m144 | [0m[35m            while first_try or self._more_pages:[0m
[30;1m145 | [0m[35m                first_try = False[0m
[30;1m146 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m441[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/rest_api/rest_api_query.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m124 | [0m[35m        self._params = params[0m
[30;1m125 | [0m[35m        self._json_path = json_path[0m
[30;1m126 | [0m[35m        if ',' in json_path and '|' in json_path:[0m
[30;1m127 | [0m[35m            raise Exception('RestApiQuery does not support "and (,)" and "or (|)" at the same time')[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m        self._jsonpath_expr = parse(self._json_path)[0m
[30;1m130 | [0m[35m        self._fail_no_result = fail_no_result[0m

[31m--[ [0m[34mMatch #[0m[33m442[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/rest_api/rest_api_query.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m103 | [0m[35m        :param json_path_contains_or: JSON Path expression accepts | ( OR ) operation, mostly to ext[0m
[30;1m104 | [0m[35m        different level. In this case, JSON Path will extract the value from first expression and th[0m
[30;1m105 | [0m[35m        and so forth.[0m
[30;1m106 | [0m[35m        :param query_merger: to update record_dict yield by this rest api query with the query_merge[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35m        Example:[0m
[30;1m109 | [0m[35m            JSON result:[0m

[31m--[ [0m[34mMatch #[0m[33m443[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/rest_api/rest_api_query.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m271 | [0m[35m[0m
[30;1m272 | [0m[35m        For example, Tableau's authentication pattern is that of Oauth where you need to call end po[0m
[30;1m273 | [0m[35m        payload via POST method. This call will return one-time token along with LUID. On following [0m
[30;1m274 | [0m[35m        one time token needs to be added on header, and LUID needs to be used to form URL to fetch i[0m
[30;1m275 | [0m[35m[0m
[30;1m276 | [0m[35m        This is why url and params is part of RestApiQuery's member variable and above operation can[0m
[30;1m277 | [0m[35m        mutating these two values.[0m

[31m--[ [0m[34mMatch #[0m[33m444[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/csv_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m39 | [0m[35m        self.conf = conf[0m
[30;1m40 | [0m[35m        self.file_location = conf.get_string(CsvExtractor.FILE_LOCATION)[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m        model_class = conf.get('model_class', None)[0m
[30;1m43 | [0m[35m        if model_class:[0m
[30;1m44 | [0m[35m            module_name, class_name = model_class.rsplit(".", 1)[0m
[30;1m45 | [0m[35m            mod = importlib.import_module(module_name)[0m

[31m--[ [0m[34mMatch #[0m[33m445[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/csv_extractor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m348 | [0m[35m[0m
[30;1m349 | [0m[35m    def extract(self) -> Any:[0m
[30;1m350 | [0m[35m        """[0m
[30;1m351 | [0m[35m        Yield the csv result one at a time.[0m
[30;1m352 | [0m[35m        convert the result to model if a model_class is provided[0m
[30;1m353 | [0m[35m        """[0m
[30;1m354 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m446[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/csv_extractor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m296 | [0m[35m[0m
[30;1m297 | [0m[35m    def extract(self) -> Any:[0m
[30;1m298 | [0m[35m        """[0m
[30;1m299 | [0m[35m        Yield the csv result one at a time.[0m
[30;1m300 | [0m[35m        convert the result to model if a model_class is provided[0m
[30;1m301 | [0m[35m        """[0m
[30;1m302 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m447[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/csv_extractor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m244 | [0m[35m[0m
[30;1m245 | [0m[35m    def extract(self) -> Any:[0m
[30;1m246 | [0m[35m        """[0m
[30;1m247 | [0m[35m        Yield the csv result one at a time.[0m
[30;1m248 | [0m[35m        convert the result to model if a model_class is provided[0m
[30;1m249 | [0m[35m        """[0m
[30;1m250 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m448[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/csv_extractor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35m    def extract(self) -> Any:[0m
[30;1m146 | [0m[35m        """[0m
[30;1m147 | [0m[35m        Yield the csv result one at a time.[0m
[30;1m148 | [0m[35m        convert the result to model if a model_class is provided[0m
[30;1m149 | [0m[35m        """[0m
[30;1m150 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m449[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/csv_extractor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m    def extract(self) -> Any:[0m
[30;1m65 | [0m[35m        """[0m
[30;1m66 | [0m[35m        Yield the csv result one at a time.[0m
[30;1m67 | [0m[35m        convert the result to model if a model_class is provided[0m
[30;1m68 | [0m[35m        """[0m
[30;1m69 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m450[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/schema/schema.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m131 | [0m[35m        entity_attrs = get_entity_attrs(attrs_mapping)[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m        # Since Schema cannot exist without Cluster (COMPOSITION relationship type), we assume Schem[0m
[30;1m134 | [0m[35m        # by different process and we only update schema description here using UPDATE operation.[0m
[30;1m135 | [0m[35m        entity = AtlasEntity([0m
[30;1m136 | [0m[35m            typeName=AtlasTableTypes.schema,[0m
[30;1m137 | [0m[35m            operation=AtlasSerializedEntityOperation.UPDATE,[0m

[31m--[ [0m[34mMatch #[0m[33m451[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/schema/schema.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m131 | [0m[35m        entity_attrs = get_entity_attrs(attrs_mapping)[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m        # Since Schema cannot exist without Cluster (COMPOSITION relationship type), we assume Schem[0m
[30;1m134 | [0m[35m        # by different process and we only update schema description here using UPDATE operation.[0m
[30;1m135 | [0m[35m        entity = AtlasEntity([0m
[30;1m136 | [0m[35m            typeName=AtlasTableTypes.schema,[0m
[30;1m137 | [0m[35m            operation=AtlasSerializedEntityOperation.UPDATE,[0m

[31m--[ [0m[34mMatch #[0m[33m452[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/schema/schema.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m61 | [0m[35m                SCHEMA_NAME_ATTR: self._schema,[0m
[30;1m62 | [0m[35m            }[0m
[30;1m63 | [0m[35m        )[0m
[30;1m64 | [0m[35m        yield node[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m        if self._description:[0m
[30;1m67 | [0m[35m            yield self._description.get_node(self._get_description_node_key())[0m
[30;1m68 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m453[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/schema/schema.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35m            return None[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m    def _create_node_iterator(self) -> Iterator[GraphNode]:[0m
[30;1m57 | [0m[35m        node = GraphNode([0m
[30;1m58 | [0m[35m            key=self._schema_key,[0m
[30;1m59 | [0m[35m            label=SCHEMA_NODE_LABEL,[0m
[30;1m60 | [0m[35m            attributes={[0m

[31m--[ [0m[34mMatch #[0m[33m454[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_preprocessor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m128 | [0m[35md have certain PII tags),[0m
[30;1m129 | [0m[35m    and push that information.[0m
[30;1m130 | [0m[35m    Now the challenge is how Amundsen apply desired state. This is where DeleteRelationPreprocessor [0m
[30;1m131 | [0m[35m    picture. We can utilize DeleteRelationPreprocessor to let it delete certain relations in the job[0m
[30;1m132 | [0m[35m    and let Neo4jPublisher update to desired state. Should there be a small window (between delete a[0m
[30;1m133 | [0m[35m    Amundsen data is not complete, you can increase Neo4jPublisher's transaction size to make it ato[0m

[31m--[ [0m[34mMatch #[0m[33m455[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_preprocessor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m    Example use case: Take an example of an external privacy service trying to push personal identif[0m
[30;1m125 | [0m[35m    identification (PII) tag into Amundsen. It is fine to push set of PII tags for the first push, b[0m
[30;1m126 | [0m[35m    challenge when it comes to following update as external service does not know current PII state [0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    The easy solution is for external service to know desired state (certain columns should have cer[0m
[30;1m129 | [0m[35m    and push that information.[0m

[31m--[ [0m[34mMatch #[0m[33m456[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_preprocessor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m125 | [0m[35m    identification (PII) tag into Amundsen. It is fine to push set of PII tags for the first push, b[0m
[30;1m126 | [0m[35m    challenge when it comes to following update as external service does not know current PII state [0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    The easy solution is for external service to know desired state (certain columns should have cer[0m
[30;1m129 | [0m[35m    and push that information.[0m
[30;1m130 | [0m[35m    Now the challenge is how Amundsen apply desired state. This is where DeleteRelationPreprocessor [0m
[30;1m131 | [0m[35m    picture. We can utilize DeleteRelationPreprocessor to let it delete certain relations in the job[0m

[31m--[ [0m[34mMatch #[0m[33m457[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_preprocessor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m    Example use case: Take an example of an external privacy service trying to push personal identif[0m
[30;1m125 | [0m[35m    identification (PII) tag into Amundsen. It is fine to push set of PII tags for the first push, b[0m
[30;1m126 | [0m[35m    challenge when it comes to following update as external service does not know current PII state [0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    The easy solution is for external service to know desired state (certain columns should have cer[0m
[30;1m129 | [0m[35m    and push that information.[0m

[31m--[ [0m[34mMatch #[0m[33m458[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/neo4j_preprocessor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m121 | [0m[35m    """[0m
[30;1m122 | [0m[35m    A Relation Pre-processor that delete relationship before Neo4jPublisher publishes relations.[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m    Example use case: Take an example of an external privacy service trying to push personal identif[0m
[30;1m125 | [0m[35m    identification (PII) tag into Amundsen. It is fine to push set of PII tags for the first push, b[0m
[30;1m126 | [0m[35m    challenge when it comes to following update as external service does not know current PII state [0m
[30;1m127 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m459[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/serializers/neptune_serializer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35mdef convert_node(node: Optional[GraphNode]) -> Dict[str, Any]:[0m
[30;1m120 | [0m[35m    if node is None:[0m
[30;1m121 | [0m[35m        return {}[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m    if not node.key:[0m

[31m--[ [0m[34mMatch #[0m[33m460[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/serializers/neptune_serializer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35mNEPTUNE_LAST_EXTRACTED_AT_RELATIONSHIP_PROPERTY_NAME_BULK_LOADER_FORMAT = "{name}:Date(single)".form[0m
[30;1m30 | [0m[35m    name=NEPTUNE_LAST_EXTRACTED_AT_RELATIONSHIP_PROPERTY_NAME[0m
[30;1m31 | [0m[35m)[0m
[30;1m32 | [0m[35m# Add a property showing where the the node or relationship comes from[0m
[30;1m33 | [0m[35mNEPTUNE_CREATION_TYPE_NODE_PROPERTY_NAME = "creation_type"[0m
[30;1m34 | [0m[35mNEPTUNE_CREATION_TYPE_NODE_PROPERTY_NAME_BULK_LOADER_FORMAT = "{name}:String(single)".format([0m
[30;1m35 | [0m[35m    name=NEPTUNE_CREATION_TYPE_NODE_PROPERTY_NAME[0m

[31m--[ [0m[34mMatch #[0m[33m461[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/es_last_updated.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m53 | [0m[35m                ESLastUpdated.LATEST_TIMESTAMP: self.timestamp[0m
[30;1m54 | [0m[35m            }[0m
[30;1m55 | [0m[35m        )[0m
[30;1m56 | [0m[35m        yield node[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m    def create_next_relation(self) -> Union[GraphRelationship, None]:[0m
[30;1m59 | [0m[35m        try:[0m
[30;1m60 | [0m[35m            return next(self._rel_iter)[0m

[31m--[ [0m[34mMatch #[0m[33m462[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/es_last_updated.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35m        """[0m
[30;1m47 | [0m[35m        Create an es_updated_timestamp node[0m
[30;1m48 | [0m[35m        """[0m
[30;1m49 | [0m[35m        node = GraphNode([0m
[30;1m50 | [0m[35m            key=ESLastUpdated.KEY,[0m
[30;1m51 | [0m[35m            label=ESLastUpdated.LABEL,[0m
[30;1m52 | [0m[35m            attributes={[0m

[31m--[ [0m[34mMatch #[0m[33m463[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/es_last_updated.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m    def _create_node_iterator(self) -> Iterator[GraphNode]:[0m
[30;1m46 | [0m[35m        """[0m
[30;1m47 | [0m[35m        Create an es_updated_timestamp node[0m
[30;1m48 | [0m[35m        """[0m
[30;1m49 | [0m[35m        node = GraphNode([0m
[30;1m50 | [0m[35m            key=ESLastUpdated.KEY,[0m
[30;1m51 | [0m[35m            label=ESLastUpdated.LABEL,[0m

[31m--[ [0m[34mMatch #[0m[33m464[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/es_last_updated.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m    def create_next_node(self) -> Union[GraphNode, None]:[0m
[30;1m37 | [0m[35m        """[0m
[30;1m38 | [0m[35m        Will create an orphan node for last updated timestamp.[0m
[30;1m39 | [0m[35m        """[0m
[30;1m40 | [0m[35m        try:[0m
[30;1m41 | [0m[35m            return next(self._node_iter)[0m

[31m--[ [0m[34mMatch #[0m[33m465[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/feature/feature_generation_code.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m# FeatureGenerationCode allows ingesting as text the generation code - whether sql or not -[0m
[30;1m15 | [0m[35m# which was used to create a feature. Unlike the Query node for Dashboards, it has no inherent[0m
[30;1m16 | [0m[35m# concept of name, url, id, or hierarchical structure. This allows for maximum flexibility to[0m
[30;1m17 | [0m[35m# ingest generation code regardless of source.[0m
[30;1m18 | [0m[35mclass FeatureGenerationCode(GraphSerializable):[0m

[31m--[ [0m[34mMatch #[0m[33m466[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/openlineage_extractor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m    def extract(self) -> Any:[0m
[30;1m93 | [0m[35m        """[0m
[30;1m94 | [0m[35m        Yield the csv result one at a time.[0m
[30;1m95 | [0m[35m        convert the result to model if a model_class is provided[0m
[30;1m96 | [0m[35m        """[0m
[30;1m97 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m467[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/serializers/neo4_serializer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mdef serialize_node(node: Optional[GraphNode]) -> Dict[str, Any]:[0m
[30;1m18 | [0m[35m    if node is None:[0m
[30;1m19 | [0m[35m        return {}[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m    node_dict = {[0m

[31m--[ [0m[34mMatch #[0m[33m468[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/elasticsearch_publisher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m        self.elasticsearch_mapping = self.conf.get(ElasticsearchPublisher.ELASTICSEARCH_MAPPING_CONF[0m
[30;1m62 | [0m[35m                                                   ElasticsearchPublisher.DEFAULT_ELASTICSEARCH_INDE[0m
[30;1m63 | [0m[35m        self.elasticsearch_batch_size = self.conf.get(ElasticsearchPublisher.ELASTICSEARCH_PUBLISHER[0m
[30;1m64 | [0m[35m                                                      10000)[0m
[30;1m65 | [0m[35m        self.file_handler = open(self.file_path, self.file_mode)[0m
[30;1m66 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m469[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/elasticsearch_publisher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m57 | [0m[35mher.ELASTICSEARCH_CLIENT_CONFIG_KEY)[0m
[30;1m58 | [0m[35m        self.elasticsearch_new_index = self.conf.get(ElasticsearchPublisher.ELASTICSEARCH_NEW_INDEX_[0m
[30;1m59 | [0m[35m        self.elasticsearch_alias = self.conf.get(ElasticsearchPublisher.ELASTICSEARCH_ALIAS_CONFIG_K[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m        self.elasticsearch_mapping = self.conf.get(ElasticsearchPublisher.ELASTICSEARCH_MAPPING_CONF[0m
[30;1m62 | [0m[35m                                                   ElasticsearchPublisher.DEFAULT_ELASTICSEARCH_INDE[0m
[30;1m63 | [0m[35m        self.elasticsearch_batch_size = self.conf.get(ElasticsearchPublisher.ELASTICSEARCH_PUBLISHER[0m

[31m--[ [0m[34mMatch #[0m[33m470[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/elasticsearch_publisher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35mer.ELASTICSEARCH_DOC_TYPE_CONFIG_KEY)[0m
[30;1m57 | [0m[35m        self.elasticsearch_client = self.conf.get(ElasticsearchPublisher.ELASTICSEARCH_CLIENT_CONFIG[0m
[30;1m58 | [0m[35m        self.elasticsearch_new_index = self.conf.get(ElasticsearchPublisher.ELASTICSEARCH_NEW_INDEX_[0m
[30;1m59 | [0m[35m        self.elasticsearch_alias = self.conf.get(ElasticsearchPublisher.ELASTICSEARCH_ALIAS_CONFIG_K[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m        self.elasticsearch_mapping = self.conf.get(ElasticsearchPublisher.ELASTICSEARCH_MAPPING_CONF[0m
[30;1m62 | [0m[35m                                                   ElasticsearchPublisher.DEFAULT_ELASTICSEARCH_INDE[0m

[31m--[ [0m[34mMatch #[0m[33m471[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/elasticsearch_publisher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m        self.elasticsearch_type = self.conf.get_string(ElasticsearchPublisher.ELASTICSEARCH_DOC_TYPE[0m
[30;1m57 | [0m[35m        self.elasticsearch_client = self.conf.get(ElasticsearchPublisher.ELASTICSEARCH_CLIENT_CONFIG[0m
[30;1m58 | [0m[35m        self.elasticsearch_new_index = self.conf.get(ElasticsearchPublisher.ELASTICSEARCH_NEW_INDEX_[0m
[30;1m59 | [0m[35m        self.elasticsearch_alias = self.conf.get(ElasticsearchPublisher.ELASTICSEARCH_ALIAS_CONFIG_K[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m        self.elasticsearch_mapping = self.conf.get(ElasticsearchPublisher.ELASTICSEARCH_MAPPING_CONF[0m

[31m--[ [0m[34mMatch #[0m[33m472[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/elasticsearch_publisher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m        self.file_mode = self.conf.get_string(ElasticsearchPublisher.FILE_MODE_CONFIG_KEY, 'r')[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m        self.elasticsearch_type = self.conf.get_string(ElasticsearchPublisher.ELASTICSEARCH_DOC_TYPE[0m
[30;1m57 | [0m[35m        self.elasticsearch_client = self.conf.get(ElasticsearchPublisher.ELASTICSEARCH_CLIENT_CONFIG[0m
[30;1m58 | [0m[35m        self.elasticsearch_new_index = self.conf.get(ElasticsearchPublisher.ELASTICSEARCH_NEW_INDEX_[0m
[30;1m59 | [0m[35m        self.elasticsearch_alias = self.conf.get(ElasticsearchPublisher.ELASTICSEARCH_ALIAS_CONFIG_K[0m
[30;1m60 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m473[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/elasticsearch_publisher.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m        update_action = {"actions": actions}[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m        # perform alias update and index delete in single atomic operation[0m
[30;1m136 | [0m[35m        self.elasticsearch_client.indices.update_aliases(update_action)[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m    def close(self) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m474[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/elasticsearch_publisher.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m123 | [0m[35m        # fetch indices that have {elasticsearch_alias} as alias[0m
[30;1m124 | [0m[35m        elasticsearch_old_indices = self._fetch_old_index()[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m        # update alias to point to the new index[0m
[30;1m127 | [0m[35m        actions = [{"add": {"index": self.elasticsearch_new_index, "alias": self.elasticsearch_alias[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m        # delete old indices[0m

[31m--[ [0m[34mMatch #[0m[33m475[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/elasticsearch_publisher.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m39 | [0m[35m    ELASTICSEARCH_ALIAS_CONFIG_KEY = 'alias'[0m
[30;1m40 | [0m[35m    ELASTICSEARCH_MAPPING_CONFIG_KEY = 'mapping'[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m    # config to control how many max documents to publish at a time[0m
[30;1m43 | [0m[35m    ELASTICSEARCH_PUBLISHER_BATCH_SIZE = 'batch_size'[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m    DEFAULT_ELASTICSEARCH_INDEX_MAPPING = TABLE_INDEX_MAP[0m

[31m--[ [0m[34mMatch #[0m[33m476[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/elasticsearch_publisher.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m39 | [0m[35m    ELASTICSEARCH_ALIAS_CONFIG_KEY = 'alias'[0m
[30;1m40 | [0m[35m    ELASTICSEARCH_MAPPING_CONFIG_KEY = 'mapping'[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m    # config to control how many max documents to publish at a time[0m
[30;1m43 | [0m[35m    ELASTICSEARCH_PUBLISHER_BATCH_SIZE = 'batch_size'[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m    DEFAULT_ELASTICSEARCH_INDEX_MAPPING = TABLE_INDEX_MAP[0m

[31m--[ [0m[34mMatch #[0m[33m477[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/elasticsearch_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35m    ELASTICSEARCH_ALIAS_CONFIG_KEY = 'alias'[0m
[30;1m40 | [0m[35m    ELASTICSEARCH_MAPPING_CONFIG_KEY = 'mapping'[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m    # config to control how many max documents to publish at a time[0m
[30;1m43 | [0m[35m    ELASTICSEARCH_PUBLISHER_BATCH_SIZE = 'batch_size'[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m    DEFAULT_ELASTICSEARCH_INDEX_MAPPING = TABLE_INDEX_MAP[0m
[30;1m46 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m478[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/mysql_csv_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m    def _sort_record_files(self, files: List[str]) -> List[str]:[0m
[30;1m95 | [0m[35m        """[0m
[30;1m96 | [0m[35m        Sort record files in the order of table dependencies[0m
[30;1m97 | [0m[35m        :param files:[0m
[30;1m98 | [0m[35m        :return:[0m
[30;1m99 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m479[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/publisher/mysql_csv_publisher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35m# SPDX-License-Identifier: Apache-2.0[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mimport logging[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35mfrom os import listdir[0m
[30;1m7 | [0m[35mfrom os.path import ([0m
[30;1m8 | [0m[35m    basename, isfile, join, splitext,[0m
[30;1m9 | [0m[35m)[0m

[31m--[ [0m[34mMatch #[0m[33m480[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/bigquery_metadata_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m121 | [0m[35m        else:[0m
[30;1m122 | [0m[35m            col = ColumnMetadata([0m
[30;1m123 | [0m[35m                name=col_name,[0m
[30;1m124 | [0m[35m                description=column.get('description', None),[0m
[30;1m125 | [0m[35m                col_type=get_column_type(column),[0m
[30;1m126 | [0m[35m                sort_order=total_cols)[0m
[30;1m127 | [0m[35m            cols.append(col)[0m

[31m--[ [0m[34mMatch #[0m[33m481[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/bigquery_metadata_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m106 | [0m[35m        if column['type'] == 'RECORD':[0m
[30;1m107 | [0m[35m            col = ColumnMetadata([0m
[30;1m108 | [0m[35m                name=col_name,[0m
[30;1m109 | [0m[35m                description=column.get('description', None),[0m
[30;1m110 | [0m[35m                col_type=get_column_type(column),[0m
[30;1m111 | [0m[35m                sort_order=total_cols)[0m
[30;1m112 | [0m[35m            cols.append(col)[0m

[31m--[ [0m[34mMatch #[0m[33m482[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/bigquery_metadata_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m97 | [0m[35m                           cols: List[ColumnMetadata],[0m
[30;1m98 | [0m[35m                           total_cols: int) -> int:[0m
[30;1m99 | [0m[35m        get_column_type: Callable[[dict], str] = lambda column: column['type'] + ':' + column['mode'[0m
[30;1m100 | [0m[35m            if column.get('mode') else column['type'][0m
[30;1m101 | [0m[35m        if len(parent) > 0:[0m
[30;1m102 | [0m[35m            col_name = f'{parent}.{column["name"]}'[0m
[30;1m103 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m483[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/bigquery_metadata_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m                    cluster=tableRef['projectId'],[0m
[30;1m86 | [0m[35m                    schema=tableRef['datasetId'],[0m
[30;1m87 | [0m[35m                    name=table_id,[0m
[30;1m88 | [0m[35m                    description=table.get('description', None),[0m
[30;1m89 | [0m[35m                    columns=cols,[0m
[30;1m90 | [0m[35m                    is_view=table['type'] == 'VIEW')[0m
[30;1m91 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m484[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/bigquery_metadata_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m58 | [0m[35m                    grouped_tables.add(table_prefix)[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m                try:[0m
[30;1m61 | [0m[35m                    table = self.bigquery_service.tables().get([0m
[30;1m62 | [0m[35m                        projectId=tableRef['projectId'],[0m
[30;1m63 | [0m[35m                        datasetId=tableRef['datasetId'],[0m
[30;1m64 | [0m[35m                        tableId=tableRef['tableId']).execute(num_retries=BigQueryMetadataExtractor.N[0m

[31m--[ [0m[34mMatch #[0m[33m485[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/bigquery_metadata_extractor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m    from the google cloud bigquery API's. This extractor goes through all visible[0m
[30;1m22 | [0m[35m    datasets in the project identified by project_id and iterates over all tables[0m
[30;1m23 | [0m[35m    it finds. A separate account is configurable through the key_path parameter,[0m
[30;1m24 | [0m[35m    which should point to a valid json file corresponding to a service account.[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    This extractor supports nested columns, which are delimited by a dot (.) in the[0m
[30;1m27 | [0m[35m    column name.[0m

[31m--[ [0m[34mMatch #[0m[33m486[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/task/neptune_staleness_removal_task.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m141 | [0m[35m            node_count = total_count_dict[type_str][0m
[30;1m142 | [0m[35m            stale_pct = stale_count * 100 / node_count[0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m            threshold = self.staleness_pct_dict.get(type_str, self.staleness_pct)[0m
[30;1m145 | [0m[35m            if stale_pct >= threshold:[0m
[30;1m146 | [0m[35m                raise Exception('Staleness percentage of {} is {} %. Stopping due to over threshold [0m
[30;1m147 | [0m[35m                                .format(type_str, stale_pct, threshold))[0m

[31m--[ [0m[34mMatch #[0m[33m487[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/task/neptune_staleness_removal_task.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m71 | [0m[35mIONS)))[0m
[30;1m72 | [0m[35m        self.dry_run = conf.get_bool(NeptuneStalenessRemovalTask.DRY_RUN)[0m
[30;1m73 | [0m[35m        self.staleness_pct = conf.get_int(NeptuneStalenessRemovalTask.STALENESS_MAX_PCT)[0m
[30;1m74 | [0m[35m        self.staleness_pct_dict = conf.get(NeptuneStalenessRemovalTask.STALENESS_PCT_MAX_DICT)[0m
[30;1m75 | [0m[35m        self.graph_label_id = conf.get(NeptuneStalenessRemovalTask.GRAPH_LABEL_ID_PROPERTY_NAME)[0m
[30;1m76 | [0m[35m        self.staleness_cut_off_in_seconds = conf.get_int(NeptuneStalenessRemovalTask.STALENESS_CUT_O[0m
[30;1m77 | [0m[35m        self.cutoff_datetime = datetime.utcnow() - timedelta(seconds=self.staleness_cut_off_in_secon[0m

[31m--[ [0m[34mMatch #[0m[33m488[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/task/neptune_staleness_removal_task.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m71 | [0m[35m    self.target_relations = list(set(conf.get_list(NeptuneStalenessRemovalTask.TARGET_RELATIONS)))[0m
[30;1m72 | [0m[35m        self.dry_run = conf.get_bool(NeptuneStalenessRemovalTask.DRY_RUN)[0m
[30;1m73 | [0m[35m        self.staleness_pct = conf.get_int(NeptuneStalenessRemovalTask.STALENESS_MAX_PCT)[0m
[30;1m74 | [0m[35m        self.staleness_pct_dict = conf.get(NeptuneStalenessRemovalTask.STALENESS_PCT_MAX_DICT)[0m
[30;1m75 | [0m[35m        self.graph_label_id = conf.get(NeptuneStalenessRemovalTask.GRAPH_LABEL_ID_PROPERTY_NAME)[0m
[30;1m76 | [0m[35m        self.staleness_cut_off_in_seconds = conf.get_int(NeptuneStalenessRemovalTask.STALENESS_CUT_O[0m

[31m--[ [0m[34mMatch #[0m[33m489[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/task/neptune_staleness_removal_task.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m43 | [0m[35m    TARGET_NODES = "target_nodes"[0m
[30;1m44 | [0m[35m    TARGET_RELATIONS = "target_relations"[0m
[30;1m45 | [0m[35m    DRY_RUN = "dry_run"[0m
[30;1m46 | [0m[35m    # What is the property name that uniquely identifies each node and edge. Typically is T.id for n[0m
[30;1m47 | [0m[35m    GRAPH_LABEL_ID_PROPERTY_NAME = "graph_label_id_property_name"[0m
[30;1m48 | [0m[35m    # Staleness max percentage. Safety net to prevent majority of data being deleted.[0m
[30;1m49 | [0m[35m    STALENESS_MAX_PCT = "staleness_max_pct"[0m

[31m--[ [0m[34mMatch #[0m[33m490[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/task/neptune_staleness_removal_task.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m28 | [0m[35m    A Specific task that is to remove stale nodes and relations in Neptune.[0m
[30;1m29 | [0m[35m    It will use "last_extracted_datetime" attribute assigned from FSNeptuneCSVLoader and if "creatio[0m
[30;1m30 | [0m[35m    the one it is getting it from the config, it will regard the node/relation as stale.[0m
[30;1m31 | [0m[35m    Not all resources are being published by NeptuneCSVPublisher and you can only set specific LABEL[0m
[30;1m32 | [0m[35m    of relation to perform this deletion.[0m
[30;1m33 | [0m[35m    """[0m
[30;1m34 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m491[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m        if not scope:[0m
[30;1m73 | [0m[35m            return Scoped._EMPTY_CONFIG[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m        return conf.get(scope, Scoped._EMPTY_CONFIG)[0m

[31m--[ [0m[34mMatch #[0m[33m492[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m     For MySQLExtractor, if you defined scope as "extractor.mysql", scoped[0m
[30;1m25 | [0m[35m     config will basically reduce it to the config that is only for MySQL.[0m
[30;1m26 | [0m[35m     config.get("extractor.mysql") provides you all the config within[0m
[30;1m27 | [0m[35m     'extractor.mysql'. By removing outer context from the config,[0m
[30;1m28 | [0m[35m     MySQLExtractor is highly reusable.[0m
[30;1m29 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m493[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m33 | [0m[35m        """[0m
[30;1m34 | [0m[35m        All scoped instance is expected to be lazily initialized. Means that[0m
[30;1m35 | [0m[35m        __init__ should not have any heavy operation such as service call.[0m
[30;1m36 | [0m[35m        The reason behind is that Databuilder is a code at the same time,[0m
[30;1m37 | [0m[35m        code itself is used as a configuration. For example, you can[0m
[30;1m38 | [0m[35m        instantiate scoped instance with all the parameters already set,[0m
[30;1m39 | [0m[35m        ready to run, and actual execution will be executing init() and[0m

[31m--[ [0m[34mMatch #[0m[33m494[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m32 | [0m[35m    def init(self, conf: ConfigTree) -> None:[0m
[30;1m33 | [0m[35m        """[0m
[30;1m34 | [0m[35m        All scoped instance is expected to be lazily initialized. Means that[0m
[30;1m35 | [0m[35m        __init__ should not have any heavy operation such as service call.[0m
[30;1m36 | [0m[35m        The reason behind is that Databuilder is a code at the same time,[0m
[30;1m37 | [0m[35m        code itself is used as a configuration. For example, you can[0m
[30;1m38 | [0m[35m        instantiate scoped instance with all the parameters already set,[0m

[31m--[ [0m[34mMatch #[0m[33m495[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/types/atlas/__init__.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m    def assign_subtypes(self, regex: str, super_type: str) -> None:[0m
[30;1m32 | [0m[35m        LOGGER.info(f'\nAssigning {super_type} entity to all the subtypes entity definitions with po[0m
[30;1m33 | [0m[35m        entities_to_update = [][0m
[30;1m34 | [0m[35m        entity_defs = self.driver.typedef.get_all_typedefs(search_filter=SearchFilter()).get('entity[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m        for e in entity_defs:[0m
[30;1m37 | [0m[35m            if re.compile(regex).match(e.name) is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m496[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/types/atlas/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35mfrom apache_atlas.exceptions import AtlasServiceException[0m
[30;1m11 | [0m[35mfrom apache_atlas.model.misc import SearchFilter[0m
[30;1m12 | [0m[35mfrom apache_atlas.model.typedef import AtlasTypesDef[0m
[30;1m13 | [0m[35mfrom requests import Timeout[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mfrom databuilder.types.atlas.types_def import ([0m
[30;1m16 | [0m[35m    application_schema, bookmark_schema, cluster_schema, column_schema, column_table_relation, dashb[0m
[30;1m17 | [0m[35m    dashboard_execution_schema, dashboard_group_schema, dashboard_query_schema, dashboard_schema, da[0m

[31m--[ [0m[34mMatch #[0m[33m497[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/task/search/document_mappings.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35mclass Subfield:[0m
[30;1m62 | [0m[35m    # combinations of field types and analyzers for additional index time analysis[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m    keyword = Keyword()[0m
[30;1m65 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m498[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/generic_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m24 | [0m[35m        self.conf = conf[0m
[30;1m25 | [0m[35m        self.values: Iterable[Any] = conf.get(GenericExtractor.EXTRACTION_ITEMS)[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m        model_class = conf.get('model_class', None)[0m
[30;1m28 | [0m[35m        if model_class:[0m
[30;1m29 | [0m[35m            module_name, class_name = model_class.rsplit(".", 1)[0m
[30;1m30 | [0m[35m            mod = importlib.import_module(module_name)[0m

[31m--[ [0m[34mMatch #[0m[33m499[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/generic_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35m        :return:[0m
[30;1m23 | [0m[35m        """[0m
[30;1m24 | [0m[35m        self.conf = conf[0m
[30;1m25 | [0m[35m        self.values: Iterable[Any] = conf.get(GenericExtractor.EXTRACTION_ITEMS)[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m        model_class = conf.get('model_class', None)[0m
[30;1m28 | [0m[35m        if model_class:[0m

[31m--[ [0m[34mMatch #[0m[33m500[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/redash/redash_dashboard_extractor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35mclass TableRelationData:[0m
[30;1m31 | [0m[35m    """[0m
[30;1m32 | [0m[35m    This is sort of like a stripped down version of `TableMetadata`.[0m
[30;1m33 | [0m[35m    It is used as the type returned by the (optional) table parser.[0m
[30;1m34 | [0m[35m    """[0m
[30;1m35 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m501[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/table_stats.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m205 | [0m[35m                'end_epoch': self.end_epoch,[0m
[30;1m206 | [0m[35m            }[0m
[30;1m207 | [0m[35m        )[0m
[30;1m208 | [0m[35m        yield node[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m    def _create_relation_iterator(self) -> Iterator[GraphRelationship]:[0m
[30;1m211 | [0m[35m        """[0m
[30;1m212 | [0m[35m        Create relation map between table stat record with original hive table[0m

[31m--[ [0m[34mMatch #[0m[33m502[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/table_stats.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m195 | [0m[35m        Create a table stat node[0m
[30;1m196 | [0m[35m        :return:[0m
[30;1m197 | [0m[35m        """[0m
[30;1m198 | [0m[35m        node = GraphNode([0m
[30;1m199 | [0m[35m            key=self.get_column_stat_model_key(),[0m
[30;1m200 | [0m[35m            label=LABEL,[0m
[30;1m201 | [0m[35m            attributes={[0m

[31m--[ [0m[34mMatch #[0m[33m503[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/table_stats.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m    def _create_node_iterator(self) -> Iterator[GraphNode]:[0m
[30;1m194 | [0m[35m        """[0m
[30;1m195 | [0m[35m        Create a table stat node[0m
[30;1m196 | [0m[35m        :return:[0m
[30;1m197 | [0m[35m        """[0m
[30;1m198 | [0m[35m        node = GraphNode([0m
[30;1m199 | [0m[35m            key=self.get_column_stat_model_key(),[0m

[31m--[ [0m[34mMatch #[0m[33m504[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/table_stats.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m101 | [0m[35m                'is_metric': self.is_metric,[0m
[30;1m102 | [0m[35m            }[0m
[30;1m103 | [0m[35m        )[0m
[30;1m104 | [0m[35m        yield node[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m    def _create_relation_iterator(self) -> Iterator[GraphRelationship]:[0m
[30;1m107 | [0m[35m        """[0m
[30;1m108 | [0m[35m        Create relation map between table stat record with original table[0m

[31m--[ [0m[34mMatch #[0m[33m505[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/table_stats.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m90 | [0m[35m        Create a table stat node[0m
[30;1m91 | [0m[35m        :return:[0m
[30;1m92 | [0m[35m        """[0m
[30;1m93 | [0m[35m        node = GraphNode([0m
[30;1m94 | [0m[35m            key=self.get_table_stat_model_key(),[0m
[30;1m95 | [0m[35m            label=LABEL,[0m
[30;1m96 | [0m[35m            attributes={[0m

[31m--[ [0m[34mMatch #[0m[33m506[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/table_stats.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m    def _create_node_iterator(self) -> Iterator[GraphNode]:[0m
[30;1m89 | [0m[35m        """[0m
[30;1m90 | [0m[35m        Create a table stat node[0m
[30;1m91 | [0m[35m        :return:[0m
[30;1m92 | [0m[35m        """[0m
[30;1m93 | [0m[35m        node = GraphNode([0m
[30;1m94 | [0m[35m            key=self.get_table_stat_model_key(),[0m

[31m--[ [0m[34mMatch #[0m[33m507[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/transformer/timestamp_string_to_epoch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m        self._field_name = self._conf.get_string(FIELD_NAME)[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m    def transform(self, record: Dict[str, Any]) -> Dict[str, Any]:[0m
[30;1m31 | [0m[35m        timestamp_str = record.get(self._field_name, '')[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m        if not timestamp_str:[0m
[30;1m34 | [0m[35m            return record[0m

[31m--[ [0m[34mMatch #[0m[33m508[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/tableau/tableau_dashboard_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m195 | [0m[35m        if self._verify_request is not None:[0m
[30;1m196 | [0m[35m            params['verify'] = self._verify_request[0m
[30;1m197 | [0m[35m[0m
[30;1m198 | [0m[35m        response_json = requests.post(url=self._auth_url, data=payload, **params).json()[0m
[30;1m199 | [0m[35m        return response_json['credentials']['token'][0m

[31m--[ [0m[34mMatch #[0m[33m509[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/tableau/tableau_dashboard_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m158 | [0m[35m        self._api_version = self._conf.get_string(TableauDashboardAuth.API_VERSION)[0m
[30;1m159 | [0m[35m        self._site_name = self._conf.get_string(TableauDashboardAuth.SITE_NAME, '')[0m
[30;1m160 | [0m[35m        self._api_base_url = self._conf.get_string(TableauDashboardAuth.API_BASE_URL)[0m
[30;1m161 | [0m[35m        self._verify_request = self._conf.get(TableauDashboardAuth.VERIFY_REQUEST, None)[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m    @property[0m
[30;1m164 | [0m[35m    def token(self) -> Optional[str]:[0m

[31m--[ [0m[34mMatch #[0m[33m510[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/tableau/tableau_dashboard_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m106 | [0m[35m        if self._verify_request is not None:[0m
[30;1m107 | [0m[35m            params['verify'] = self._verify_request[0m
[30;1m108 | [0m[35m[0m
[30;1m109 | [0m[35m        response = requests.post(url=self._metadata_url, data=query_payload, **params)[0m
[30;1m110 | [0m[35m        return response.json()['data'][0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m    @abc.abstractmethod[0m

[31m--[ [0m[34mMatch #[0m[33m511[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/tableau/tableau_dashboard_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m            api_base_url=self._conf.get_string(TableauGraphQLApiExtractor.API_BASE_URL)[0m
[30;1m87 | [0m[35m        )[0m
[30;1m88 | [0m[35m        self._query_variables = self._conf.get(TableauGraphQLApiExtractor.QUERY_VARIABLES, {})[0m
[30;1m89 | [0m[35m        self._verify_request = self._conf.get(TableauGraphQLApiExtractor.VERIFY_REQUEST, None)[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m    def execute_query(self) -> Dict[str, Any]:[0m
[30;1m92 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m512[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/tableau/tableau_dashboard_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m        self._metadata_url = '{api_base_url}/api/metadata/graphql'.format([0m
[30;1m86 | [0m[35m            api_base_url=self._conf.get_string(TableauGraphQLApiExtractor.API_BASE_URL)[0m
[30;1m87 | [0m[35m        )[0m
[30;1m88 | [0m[35m        self._query_variables = self._conf.get(TableauGraphQLApiExtractor.QUERY_VARIABLES, {})[0m
[30;1m89 | [0m[35m        self._verify_request = self._conf.get(TableauGraphQLApiExtractor.VERIFY_REQUEST, None)[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m    def execute_query(self) -> Dict[str, Any]:[0m

[31m--[ [0m[34mMatch #[0m[33m513[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/tableau/tableau_dashboard_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m        self._auth_token = TableauDashboardAuth(self._conf).token[0m
[30;1m82 | [0m[35m        self._query = self._conf.get(TableauGraphQLApiExtractor.QUERY)[0m
[30;1m83 | [0m[35m        self._iterator: Optional[Iterator[Dict[str, Any]]] = None[0m
[30;1m84 | [0m[35m        self._static_dict = conf.get(STATIC_RECORD_DICT, dict())[0m
[30;1m85 | [0m[35m        self._metadata_url = '{api_base_url}/api/metadata/graphql'.format([0m
[30;1m86 | [0m[35m            api_base_url=self._conf.get_string(TableauGraphQLApiExtractor.API_BASE_URL)[0m
[30;1m87 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m514[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/tableau/tableau_dashboard_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m79 | [0m[35m    def init(self, conf: ConfigTree) -> None:[0m
[30;1m80 | [0m[35m        self._conf = conf[0m
[30;1m81 | [0m[35m        self._auth_token = TableauDashboardAuth(self._conf).token[0m
[30;1m82 | [0m[35m        self._query = self._conf.get(TableauGraphQLApiExtractor.QUERY)[0m
[30;1m83 | [0m[35m        self._iterator: Optional[Iterator[Dict[str, Any]]] = None[0m
[30;1m84 | [0m[35m        self._static_dict = conf.get(STATIC_RECORD_DICT, dict())[0m
[30;1m85 | [0m[35m        self._metadata_url = '{api_base_url}/api/metadata/graphql'.format([0m

[31m--[ [0m[34mMatch #[0m[33m515[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/tableau/tableau_dashboard_utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m    def extract(self) -> Any:[0m
[30;1m121 | [0m[35m        """[0m
[30;1m122 | [0m[35m        Fetch one result at a time from the generator created by self.execute(), updating using the[0m
[30;1m123 | [0m[35m        static record values if needed.[0m
[30;1m124 | [0m[35m        """[0m
[30;1m125 | [0m[35m        if not self._iterator:[0m

[31m--[ [0m[34mMatch #[0m[33m516[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/dashboard/tableau/tableau_dashboard_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m    def extract(self) -> Any:[0m
[30;1m121 | [0m[35m        """[0m
[30;1m122 | [0m[35m        Fetch one result at a time from the generator created by self.execute(), updating using the[0m
[30;1m123 | [0m[35m        static record values if needed.[0m
[30;1m124 | [0m[35m        """[0m
[30;1m125 | [0m[35m        if not self._iterator:[0m

[31m--[ [0m[34mMatch #[0m[33m517[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/loader/file_system_atlas_csv_loader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m162 | [0m[35m        :param file_suffix:[0m
[30;1m163 | [0m[35m        :return:[0m
[30;1m164 | [0m[35m        """[0m
[30;1m165 | [0m[35m        writer = file_mapping.get(key)[0m
[30;1m166 | [0m[35m        if writer:[0m
[30;1m167 | [0m[35m            return writer[0m
[30;1m168 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m518[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/loader/file_system_atlas_csv_loader.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m153 | [0m[35m    ) -> DictWriter:[0m
[30;1m154 | [0m[35m        """[0m
[30;1m155 | [0m[35m        Finds a writer based on csv record, key.[0m
[30;1m156 | [0m[35m        If writer does not exist, it's creates a csv writer and update the[0m
[30;1m157 | [0m[35m        mapping.[0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35m        :param csv_record_dict:[0m

[31m--[ [0m[34mMatch #[0m[33m519[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/loader/file_system_atlas_csv_loader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m95 | [0m[35m        """[0m
[30;1m96 | [0m[35m        Writes AtlasSerializable into CSV files.[0m
[30;1m97 | [0m[35m        There are multiple CSV files that this method writes.[0m
[30;1m98 | [0m[35m        This is because there're not only node and relationship, but also it[0m
[30;1m99 | [0m[35m        can also have different entities, and relationships.[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m        Common pattern for both entities and relations:[0m

[31m--[ [0m[34mMatch #[0m[33m520[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/rest_api/mode_analytics/mode_paginated_rest_api_query.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m22 | [0m[35m    Certain API such as get list of reports on a space is paginated with query term page.[0m
[30;1m23 | [0m[35m    https://mode.com/developer/api-cookbook/management/get-all-reports/[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m    This subclass makes sure to detect if there's more page and update URL to get next page.[0m
[30;1m26 | [0m[35m    """[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    def __init__(self,[0m

[31m--[ [0m[34mMatch #[0m[33m521[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/table_source.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m93 | [0m[35m                'source_type': self.source_type[0m
[30;1m94 | [0m[35m            }[0m
[30;1m95 | [0m[35m        )[0m
[30;1m96 | [0m[35m        yield node[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m    def _create_relation_iterator(self) -> Iterator[GraphRelationship]:[0m
[30;1m99 | [0m[35m        """[0m
[30;1m100 | [0m[35m        Create relation map between owner record with original hive table[0m

[31m--[ [0m[34mMatch #[0m[33m522[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/table_source.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m85 | [0m[35m        Create a table source node[0m
[30;1m86 | [0m[35m        :return:[0m
[30;1m87 | [0m[35m        """[0m
[30;1m88 | [0m[35m        node = GraphNode([0m
[30;1m89 | [0m[35m            key=self.get_source_model_key(),[0m
[30;1m90 | [0m[35m            label=TableSource.LABEL,[0m
[30;1m91 | [0m[35m            attributes={[0m

[31m--[ [0m[34mMatch #[0m[33m523[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/table_source.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m    def _create_node_iterator(self) -> Iterator[GraphNode]:[0m
[30;1m84 | [0m[35m        """[0m
[30;1m85 | [0m[35m        Create a table source node[0m
[30;1m86 | [0m[35m        :return:[0m
[30;1m87 | [0m[35m        """[0m
[30;1m88 | [0m[35m        node = GraphNode([0m
[30;1m89 | [0m[35m            key=self.get_source_model_key(),[0m

[31m--[ [0m[34mMatch #[0m[33m524[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/table_column_usage.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m74 | [0m[35m            node = usage.create_next_node()[0m
[30;1m75 | [0m[35m            while node is not None:[0m
[30;1m76 | [0m[35m                yield node[0m
[30;1m77 | [0m[35m                node = usage.create_next_node()[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m    def create_next_relation(self) -> Union[GraphRelationship, None]:[0m
[30;1m80 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m525[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/table_column_usage.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m70 | [0m[35m        for usage in self.col_readers:[0m
[30;1m71 | [0m[35m            node = usage.create_next_node()[0m
[30;1m72 | [0m[35m            while node is not None:[0m
[30;1m73 | [0m[35m                yield node[0m
[30;1m74 | [0m[35m                node = usage.create_next_node()[0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m    def create_next_relation(self) -> Union[GraphRelationship, None]:[0m
[30;1m77 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m526[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/table_column_usage.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m69 | [0m[35m    def _create_node_iterator(self) -> Iterator[GraphNode]:[0m
[30;1m70 | [0m[35m        for usage in self.col_readers:[0m
[30;1m71 | [0m[35m            node = usage.create_next_node()[0m
[30;1m72 | [0m[35m            while node is not None:[0m
[30;1m73 | [0m[35m                yield node[0m
[30;1m74 | [0m[35m                node = usage.create_next_node()[0m
[30;1m75 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m527[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/models/table_column_usage.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m    def _create_node_iterator(self) -> Iterator[GraphNode]:[0m
[30;1m70 | [0m[35m        for usage in self.col_readers:[0m
[30;1m71 | [0m[35m            node = usage.create_next_node()[0m
[30;1m72 | [0m[35m            while node is not None:[0m
[30;1m73 | [0m[35m                yield node[0m
[30;1m74 | [0m[35m                node = usage.create_next_node()[0m

[31m--[ [0m[34mMatch #[0m[33m528[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/loader/file_system_neo4j_csv_loader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m156 | [0m[35m        :param file_suffix:[0m
[30;1m157 | [0m[35m        :return:[0m
[30;1m158 | [0m[35m        """[0m
[30;1m159 | [0m[35m        writer = file_mapping.get(key)[0m
[30;1m160 | [0m[35m        if writer:[0m
[30;1m161 | [0m[35m            return writer[0m
[30;1m162 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m529[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/loader/file_system_neo4j_csv_loader.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m147 | [0m[35m                    ) -> DictWriter:[0m
[30;1m148 | [0m[35m        """[0m
[30;1m149 | [0m[35m        Finds a writer based on csv record, key.[0m
[30;1m150 | [0m[35m        If writer does not exist, it's creates a csv writer and update the[0m
[30;1m151 | [0m[35m        mapping.[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m        :param csv_record_dict:[0m

[31m--[ [0m[34mMatch #[0m[33m530[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/loader/file_system_neo4j_csv_loader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m119 | [0m[35m                                           self._node_dir,[0m
[30;1m120 | [0m[35m                                           file_suffix)[0m
[30;1m121 | [0m[35m            node_writer.writerow(node_dict)[0m
[30;1m122 | [0m[35m            node = csv_serializable.next_node()[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m        relation = csv_serializable.next_relation()[0m
[30;1m125 | [0m[35m        while relation:[0m

[31m--[ [0m[34mMatch #[0m[33m531[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/loader/file_system_neo4j_csv_loader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m108 | [0m[35m        :return:[0m
[30;1m109 | [0m[35m        """[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m        node = csv_serializable.next_node()[0m
[30;1m112 | [0m[35m        while node:[0m
[30;1m113 | [0m[35m            node_dict = neo4_serializer.serialize_node(node)[0m
[30;1m114 | [0m[35m            key = (node.label, self._make_key(node_dict))[0m

[31m--[ [0m[34mMatch #[0m[33m532[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/loader/file_system_neo4j_csv_loader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m95 | [0m[35m        """[0m
[30;1m96 | [0m[35m        Writes Neo4jCsvSerializable into CSV files.[0m
[30;1m97 | [0m[35m        There are multiple CSV files that this method writes.[0m
[30;1m98 | [0m[35m        This is because there're not only node and relationship, but also it[0m
[30;1m99 | [0m[35m        can also have different nodes, and relationships.[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m        Common pattern for both nodes and relations:[0m

[31m--[ [0m[34mMatch #[0m[33m533[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/loader/file_system_neo4j_csv_loader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    def init(self, conf: ConfigTree) -> None:[0m
[30;1m48 | [0m[35m        """[0m
[30;1m49 | [0m[35m        Initializing FsNeo4jCsvLoader by creating directory for node files[0m
[30;1m50 | [0m[35m        and relationship files. Note that the directory defined in[0m
[30;1m51 | [0m[35m        configuration should not exist.[0m
[30;1m52 | [0m[35m        :param conf:[0m

[31m--[ [0m[34mMatch #[0m[33m534[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/loader/file_system_neo4j_csv_loader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35mclass FsNeo4jCSVLoader(Loader):[0m
[30;1m25 | [0m[35m    """[0m
[30;1m26 | [0m[35m    Write node and relationship CSV file(s) that can be consumed by[0m
[30;1m27 | [0m[35m    Neo4jCsvPublisher.[0m
[30;1m28 | [0m[35m    It assumes that the record it consumes is instance of Neo4jCsvSerializable[0m
[30;1m29 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m535[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/task/search/search_metadata_to_elasticsearch_task.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m79 | [0m[35m        self.elasticsearch_batch_size = conf.get([0m
[30;1m80 | [0m[35m            SearchMetadatatoElasticasearchTask.ELASTICSEARCH_PUBLISHER_BATCH_SIZE, 10000[0m
[30;1m81 | [0m[35m        )[0m
[30;1m82 | [0m[35m        self.elasticsearch_timeout_sec = conf.get([0m
[30;1m83 | [0m[35m            SearchMetadatatoElasticasearchTask.ELASTICSEARCH_TIMEOUT_SEC, 120[0m
[30;1m84 | [0m[35m        )[0m
[30;1m85 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m536[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/task/search/search_metadata_to_elasticsearch_task.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m76 | [0m[35m            LOGGER.error(msg)[0m
[30;1m77 | [0m[35m            raise TypeError(msg)[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m        self.elasticsearch_batch_size = conf.get([0m
[30;1m80 | [0m[35m            SearchMetadatatoElasticasearchTask.ELASTICSEARCH_PUBLISHER_BATCH_SIZE, 10000[0m
[30;1m81 | [0m[35m        )[0m
[30;1m82 | [0m[35m        self.elasticsearch_timeout_sec = conf.get([0m

[31m--[ [0m[34mMatch #[0m[33m537[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/task/search/search_metadata_to_elasticsearch_task.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m        self.elasticsearch_new_index = conf.get([0m
[30;1m68 | [0m[35m            SearchMetadatatoElasticasearchTask.ELASTICSEARCH_NEW_INDEX,[0m
[30;1m69 | [0m[35m            self.create_new_index_name())[0m
[30;1m70 | [0m[35m        self.document_mapping = conf.get(SearchMetadatatoElasticasearchTask.MAPPING_CLASS,[0m
[30;1m71 | [0m[35m                                         RESOURCE_TO_MAPPING[self.entity])[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m        if not issubclass(self.document_mapping, SearchableResource):[0m

[31m--[ [0m[34mMatch #[0m[33m538[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/task/search/search_metadata_to_elasticsearch_task.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m        self.elasticsearch_alias = conf.get([0m
[30;1m65 | [0m[35m            SearchMetadatatoElasticasearchTask.ELASTICSEARCH_ALIAS_CONFIG_KEY[0m
[30;1m66 | [0m[35m        )[0m
[30;1m67 | [0m[35m        self.elasticsearch_new_index = conf.get([0m
[30;1m68 | [0m[35m            SearchMetadatatoElasticasearchTask.ELASTICSEARCH_NEW_INDEX,[0m
[30;1m69 | [0m[35m            self.create_new_index_name())[0m
[30;1m70 | [0m[35m        self.document_mapping = conf.get(SearchMetadatatoElasticasearchTask.MAPPING_CLASS,[0m

[31m--[ [0m[34mMatch #[0m[33m539[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/task/search/search_metadata_to_elasticsearch_task.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m        self.elasticsearch_client = conf.get([0m
[30;1m62 | [0m[35m            SearchMetadatatoElasticasearchTask.ELASTICSEARCH_CLIENT_CONFIG_KEY[0m
[30;1m63 | [0m[35m        )[0m
[30;1m64 | [0m[35m        self.elasticsearch_alias = conf.get([0m
[30;1m65 | [0m[35m            SearchMetadatatoElasticasearchTask.ELASTICSEARCH_ALIAS_CONFIG_KEY[0m
[30;1m66 | [0m[35m        )[0m
[30;1m67 | [0m[35m        self.elasticsearch_new_index = conf.get([0m

[31m--[ [0m[34mMatch #[0m[33m540[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/task/search/search_metadata_to_elasticsearch_task.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m58 | [0m[35m        conf = Scoped.get_scoped_conf(conf, self.get_scope())[0m
[30;1m59 | [0m[35m        self.date = conf.get_string(SearchMetadatatoElasticasearchTask.DATE, self.today)[0m
[30;1m60 | [0m[35m        self.entity = conf.get_string(SearchMetadatatoElasticasearchTask.ENTITY_TYPE).lower()[0m
[30;1m61 | [0m[35m        self.elasticsearch_client = conf.get([0m
[30;1m62 | [0m[35m            SearchMetadatatoElasticasearchTask.ELASTICSEARCH_CLIENT_CONFIG_KEY[0m
[30;1m63 | [0m[35m        )[0m
[30;1m64 | [0m[35m        self.elasticsearch_alias = conf.get([0m

[31m--[ [0m[34mMatch #[0m[33m541[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_watermark_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m32 | [0m[35m                }[0m
[30;1m33 | [0m[35m            )[0m
[30;1m34 | [0m[35m            watermark_min = search_result.get('aggregations').get('min_watermark').get('value')[0m
[30;1m35 | [0m[35m            watermark_max = search_result.get('aggregations').get('max_watermark').get('value')[0m
[30;1m36 | [0m[35m            if watermark_min is not None and watermark_max is not None:[0m
[30;1m37 | [0m[35m                return float(watermark_min), float(watermark_max)[0m
[30;1m38 | [0m[35m        except Exception:[0m

[31m--[ [0m[34mMatch #[0m[33m542[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_watermark_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m32 | [0m[35m                }[0m
[30;1m33 | [0m[35m            )[0m
[30;1m34 | [0m[35m            watermark_min = search_result.get('aggregations').get('min_watermark').get('value')[0m
[30;1m35 | [0m[35m            watermark_max = search_result.get('aggregations').get('max_watermark').get('value')[0m
[30;1m36 | [0m[35m            if watermark_min is not None and watermark_max is not None:[0m
[30;1m37 | [0m[35m                return float(watermark_min), float(watermark_max)[0m
[30;1m38 | [0m[35m        except Exception:[0m

[31m--[ [0m[34mMatch #[0m[33m543[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_watermark_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m32 | [0m[35m                }[0m
[30;1m33 | [0m[35m            )[0m
[30;1m34 | [0m[35m            watermark_min = search_result.get('aggregations').get('min_watermark').get('value')[0m
[30;1m35 | [0m[35m            watermark_max = search_result.get('aggregations').get('max_watermark').get('value')[0m
[30;1m36 | [0m[35m            if watermark_min is not None and watermark_max is not None:[0m
[30;1m37 | [0m[35m                return float(watermark_min), float(watermark_max)[0m
[30;1m38 | [0m[35m        except Exception:[0m

[31m--[ [0m[34mMatch #[0m[33m544[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_watermark_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m                    'max_watermark': {'max': {'field': self._time_field}}[0m
[30;1m32 | [0m[35m                }[0m
[30;1m33 | [0m[35m            )[0m
[30;1m34 | [0m[35m            watermark_min = search_result.get('aggregations').get('min_watermark').get('value')[0m
[30;1m35 | [0m[35m            watermark_max = search_result.get('aggregations').get('max_watermark').get('value')[0m
[30;1m36 | [0m[35m            if watermark_min is not None and watermark_max is not None:[0m
[30;1m37 | [0m[35m                return float(watermark_min), float(watermark_max)[0m

[31m--[ [0m[34mMatch #[0m[33m545[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_watermark_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m                    'max_watermark': {'max': {'field': self._time_field}}[0m
[30;1m32 | [0m[35m                }[0m
[30;1m33 | [0m[35m            )[0m
[30;1m34 | [0m[35m            watermark_min = search_result.get('aggregations').get('min_watermark').get('value')[0m
[30;1m35 | [0m[35m            watermark_max = search_result.get('aggregations').get('max_watermark').get('value')[0m
[30;1m36 | [0m[35m            if watermark_min is not None and watermark_max is not None:[0m
[30;1m37 | [0m[35m                return float(watermark_min), float(watermark_max)[0m

[31m--[ [0m[34mMatch #[0m[33m546[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_watermark_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m                    'max_watermark': {'max': {'field': self._time_field}}[0m
[30;1m32 | [0m[35m                }[0m
[30;1m33 | [0m[35m            )[0m
[30;1m34 | [0m[35m            watermark_min = search_result.get('aggregations').get('min_watermark').get('value')[0m
[30;1m35 | [0m[35m            watermark_max = search_result.get('aggregations').get('max_watermark').get('value')[0m
[30;1m36 | [0m[35m            if watermark_min is not None and watermark_max is not None:[0m
[30;1m37 | [0m[35m                return float(watermark_min), float(watermark_max)[0m

[31m--[ [0m[34mMatch #[0m[33m547[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_column_stats_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m        _data = self.es.search(index=index_name, body=query)[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m        data = _data.get('aggregations', dict()).get('stats', dict()).get('fields', list())[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m        return data[0m
[30;1m38 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m548[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_column_stats_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m        _data = self.es.search(index=index_name, body=query)[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m        data = _data.get('aggregations', dict()).get('stats', dict()).get('fields', list())[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m        return data[0m
[30;1m38 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m549[0m[34m of [0m[33m549[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databuilder/extractor/es_column_stats_extractor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m        _data = self.es.search(index=index_name, body=query)[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m        data = _data.get('aggregations', dict()).get('stats', dict()).get('fields', list())[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m        return data[0m
[30;1m38 | [0m[35m[0m

549 matches found.
