[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/torchao/prototype/autoround/eval_autoround.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35mAO_USE_DETERMINISTIC_ALGORITHMS = ([0m
[30;1m38 | [0m[35m    os.environ.get("AO_USE_DETERMINISTIC_ALGORITHMS", "0") == "1"[0m
[30;1m39 | [0m[35m)[0m
[30;1m40 | [0m[35mif AO_USE_DETERMINISTIC_ALGORITHMS:[0m
[30;1m41 | [0m[35m    _use_deterministic()[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/torchao/quantization/quant_api.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m123 | [0m[35m    "float8_static_activation_float8_weight",[0m
[30;1m124 | [0m[35m    "Int8DynActInt4WeightQuantizer",[0m
[30;1m125 | [0m[35m    "Int8DynActInt4WeightGPTQQuantizer",[0m
[30;1m126 | [0m[35m    "Float8DynamicActivationFloat8SemiSparseWeightConfig",[0m
[30;1m127 | [0m[35m][0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35mLAYOUT_TO_ZERO_POINT_DOMAIN = {[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/torchao/experimental/packed_linear_int8_dynamic_activation_intx_weight_layout.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m22 | [0m[35m)[0m
[30;1m23 | [0m[35m__all__ = [[0m
[30;1m24 | [0m[35m    "to_affine_quantized_intx_experimental",[0m
[30;1m25 | [0m[35m    "PackedLinearInt8DynamicActivationIntxWeightLayout",[0m
[30;1m26 | [0m[35m    "Target",[0m
[30;1m27 | [0m[35m][0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/torchao/quantization/linear_activation_scale.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m12 | [0m[35m)[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m__all__ = [[0m
[30;1m15 | [0m[35m    "WeightTensorWithLinearActivationScaleMetadata",[0m
[30;1m16 | [0m[35m    "to_weight_tensor_with_linear_activation_scale_metadata",[0m
[30;1m17 | [0m[35m][0m
[30;1m18 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/torchao/quantization/__init__.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m136 | [0m[35m    "Float8WeightOnlyConfig",[0m
[30;1m137 | [0m[35m    "Float8DynamicActivationFloat8WeightConfig",[0m
[30;1m138 | [0m[35m    "Float8StaticActivationFloat8WeightConfig",[0m
[30;1m139 | [0m[35m    "Float8DynamicActivationFloat8SemiSparseWeightConfig",[0m
[30;1m140 | [0m[35m    "UIntXWeightOnlyConfig",[0m
[30;1m141 | [0m[35m    "FPXWeightOnlyConfig",[0m
[30;1m142 | [0m[35m    "GemliteUIntXWeightOnlyConfig",[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/torchao/quantization/__init__.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m135 | [0m[35m    "Int8WeightOnlyConfig",[0m
[30;1m136 | [0m[35m    "Float8WeightOnlyConfig",[0m
[30;1m137 | [0m[35m    "Float8DynamicActivationFloat8WeightConfig",[0m
[30;1m138 | [0m[35m    "Float8StaticActivationFloat8WeightConfig",[0m
[30;1m139 | [0m[35m    "Float8DynamicActivationFloat8SemiSparseWeightConfig",[0m
[30;1m140 | [0m[35m    "UIntXWeightOnlyConfig",[0m
[30;1m141 | [0m[35m    "FPXWeightOnlyConfig",[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/torchao/quantization/__init__.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m134 | [0m[35m    "Int4WeightOnlyConfig",[0m
[30;1m135 | [0m[35m    "Int8WeightOnlyConfig",[0m
[30;1m136 | [0m[35m    "Float8WeightOnlyConfig",[0m
[30;1m137 | [0m[35m    "Float8DynamicActivationFloat8WeightConfig",[0m
[30;1m138 | [0m[35m    "Float8StaticActivationFloat8WeightConfig",[0m
[30;1m139 | [0m[35m    "Float8DynamicActivationFloat8SemiSparseWeightConfig",[0m
[30;1m140 | [0m[35m    "UIntXWeightOnlyConfig",[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/torchao/dtypes/__init__.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m58 | [0m[35m    "CutlassInt4PackedLayout",[0m
[30;1m59 | [0m[35m    "CutlassSemiSparseLayout",[0m
[30;1m60 | [0m[35m    "QDQLayout",[0m
[30;1m61 | [0m[35m    "PackedLinearInt8DynamicActivationIntxWeightLayout",[0m
[30;1m62 | [0m[35m    "to_affine_quantized_packed_linear_int8_dynamic_activation_intx_weight",[0m
[30;1m63 | [0m[35m][0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/torchao/dtypes/uintx/__init__.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m44 | [0m[35m    "to_marlinqqq_quantized_intx",[0m
[30;1m45 | [0m[35m    "CutlassInt4PackedLayout",[0m
[30;1m46 | [0m[35m    "to_affine_quantized_packed_linear_int8_dynamic_activation_intx_weight",[0m
[30;1m47 | [0m[35m    "PackedLinearInt8DynamicActivationIntxWeightLayout",[0m
[30;1m48 | [0m[35m    "QDQLayout",[0m
[30;1m49 | [0m[35m][0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/torchao/quantization/prototype/qat/_module_swap_api.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m21 | [0m[35m)[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m__all__ = [[0m
[30;1m24 | [0m[35m    "Int8DynActInt4WeightQATQuantizerModuleSwap",[0m
[30;1m25 | [0m[35m    "Int4WeightOnlyQATQuantizerModuleSwap",[0m
[30;1m26 | [0m[35m    "enable_8da4w_fake_quant_module_swap",[0m
[30;1m27 | [0m[35m    "disable_8da4w_fake_quant_module_swap",[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/torchao/quantization/weight_tensor_linear_activation_quantization.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m14 | [0m[35m)[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m__all__ = [[0m
[30;1m17 | [0m[35m    "WeightTensorWithLinearActivationQuantizationMetadata",[0m
[30;1m18 | [0m[35m    "to_weight_tensor_with_linear_activation_quantization_metadata",[0m
[30;1m19 | [0m[35m][0m
[30;1m20 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/nf4tensor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m        kwargs.get("quantization_factor", nf4tensor.quantization_factor),[0m
[30;1m82 | [0m[35m        kwargs.get("scaler_mean", nf4tensor.scaler_mean),[0m
[30;1m83 | [0m[35m        kwargs.get("quantized_data", nf4tensor.quantized_data),[0m
[30;1m84 | [0m[35m        kwargs.get("nf4", nf4tensor.nf4),[0m
[30;1m85 | [0m[35m    )[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/nf4tensor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m80 | [0m[35m        kwargs.get("quantized_scalers", nf4tensor.quantized_scalers),[0m
[30;1m81 | [0m[35m        kwargs.get("quantization_factor", nf4tensor.quantization_factor),[0m
[30;1m82 | [0m[35m        kwargs.get("scaler_mean", nf4tensor.scaler_mean),[0m
[30;1m83 | [0m[35m        kwargs.get("quantized_data", nf4tensor.quantized_data),[0m
[30;1m84 | [0m[35m        kwargs.get("nf4", nf4tensor.nf4),[0m
[30;1m85 | [0m[35m    )[0m
[30;1m86 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/nf4tensor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m79 | [0m[35m        kwargs.get("scaler_block_size", nf4tensor.scaler_block_size),[0m
[30;1m80 | [0m[35m        kwargs.get("quantized_scalers", nf4tensor.quantized_scalers),[0m
[30;1m81 | [0m[35m        kwargs.get("quantization_factor", nf4tensor.quantization_factor),[0m
[30;1m82 | [0m[35m        kwargs.get("scaler_mean", nf4tensor.scaler_mean),[0m
[30;1m83 | [0m[35m        kwargs.get("quantized_data", nf4tensor.quantized_data),[0m
[30;1m84 | [0m[35m        kwargs.get("nf4", nf4tensor.nf4),[0m
[30;1m85 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/nf4tensor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m78 | [0m[35m        kwargs.get("n_blocks", nf4tensor.n_blocks),[0m
[30;1m79 | [0m[35m        kwargs.get("scaler_block_size", nf4tensor.scaler_block_size),[0m
[30;1m80 | [0m[35m        kwargs.get("quantized_scalers", nf4tensor.quantized_scalers),[0m
[30;1m81 | [0m[35m        kwargs.get("quantization_factor", nf4tensor.quantization_factor),[0m
[30;1m82 | [0m[35m        kwargs.get("scaler_mean", nf4tensor.scaler_mean),[0m
[30;1m83 | [0m[35m        kwargs.get("quantized_data", nf4tensor.quantized_data),[0m
[30;1m84 | [0m[35m        kwargs.get("nf4", nf4tensor.nf4),[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/nf4tensor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m        kwargs.get("block_size", nf4tensor.block_size),[0m
[30;1m78 | [0m[35m        kwargs.get("n_blocks", nf4tensor.n_blocks),[0m
[30;1m79 | [0m[35m        kwargs.get("scaler_block_size", nf4tensor.scaler_block_size),[0m
[30;1m80 | [0m[35m        kwargs.get("quantized_scalers", nf4tensor.quantized_scalers),[0m
[30;1m81 | [0m[35m        kwargs.get("quantization_factor", nf4tensor.quantization_factor),[0m
[30;1m82 | [0m[35m        kwargs.get("scaler_mean", nf4tensor.scaler_mean),[0m
[30;1m83 | [0m[35m        kwargs.get("quantized_data", nf4tensor.quantized_data),[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/nf4tensor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m76 | [0m[35m        tensor_meta,[0m
[30;1m77 | [0m[35m        kwargs.get("block_size", nf4tensor.block_size),[0m
[30;1m78 | [0m[35m        kwargs.get("n_blocks", nf4tensor.n_blocks),[0m
[30;1m79 | [0m[35m        kwargs.get("scaler_block_size", nf4tensor.scaler_block_size),[0m
[30;1m80 | [0m[35m        kwargs.get("quantized_scalers", nf4tensor.quantized_scalers),[0m
[30;1m81 | [0m[35m        kwargs.get("quantization_factor", nf4tensor.quantization_factor),[0m
[30;1m82 | [0m[35m        kwargs.get("scaler_mean", nf4tensor.scaler_mean),[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/nf4tensor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m75 | [0m[35m    return ([0m
[30;1m76 | [0m[35m        tensor_meta,[0m
[30;1m77 | [0m[35m        kwargs.get("block_size", nf4tensor.block_size),[0m
[30;1m78 | [0m[35m        kwargs.get("n_blocks", nf4tensor.n_blocks),[0m
[30;1m79 | [0m[35m        kwargs.get("scaler_block_size", nf4tensor.scaler_block_size),[0m
[30;1m80 | [0m[35m        kwargs.get("quantized_scalers", nf4tensor.quantized_scalers),[0m
[30;1m81 | [0m[35m        kwargs.get("quantization_factor", nf4tensor.quantization_factor),[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/nf4tensor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m74 | [0m[35m    )[0m
[30;1m75 | [0m[35m    return ([0m
[30;1m76 | [0m[35m        tensor_meta,[0m
[30;1m77 | [0m[35m        kwargs.get("block_size", nf4tensor.block_size),[0m
[30;1m78 | [0m[35m        kwargs.get("n_blocks", nf4tensor.n_blocks),[0m
[30;1m79 | [0m[35m        kwargs.get("scaler_block_size", nf4tensor.scaler_block_size),[0m
[30;1m80 | [0m[35m        kwargs.get("quantized_scalers", nf4tensor.quantized_scalers),[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/nf4tensor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m70 | [0m[35m        kwargs.get("storage_offset", nf4tensor.storage_offset()),[0m
[30;1m71 | [0m[35m        kwargs.get("dtype", nf4tensor.dtype),[0m
[30;1m72 | [0m[35m        kwargs.get("device", nf4tensor.device),[0m
[30;1m73 | [0m[35m        kwargs.get("requires_grad", nf4tensor.requires_grad),[0m
[30;1m74 | [0m[35m    )[0m
[30;1m75 | [0m[35m    return ([0m
[30;1m76 | [0m[35m        tensor_meta,[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/nf4tensor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m69 | [0m[35m        kwargs.get("stride", nf4tensor.stride()),[0m
[30;1m70 | [0m[35m        kwargs.get("storage_offset", nf4tensor.storage_offset()),[0m
[30;1m71 | [0m[35m        kwargs.get("dtype", nf4tensor.dtype),[0m
[30;1m72 | [0m[35m        kwargs.get("device", nf4tensor.device),[0m
[30;1m73 | [0m[35m        kwargs.get("requires_grad", nf4tensor.requires_grad),[0m
[30;1m74 | [0m[35m    )[0m
[30;1m75 | [0m[35m    return ([0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/nf4tensor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m        kwargs.get("size", nf4tensor.size()),[0m
[30;1m69 | [0m[35m        kwargs.get("stride", nf4tensor.stride()),[0m
[30;1m70 | [0m[35m        kwargs.get("storage_offset", nf4tensor.storage_offset()),[0m
[30;1m71 | [0m[35m        kwargs.get("dtype", nf4tensor.dtype),[0m
[30;1m72 | [0m[35m        kwargs.get("device", nf4tensor.device),[0m
[30;1m73 | [0m[35m        kwargs.get("requires_grad", nf4tensor.requires_grad),[0m
[30;1m74 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/nf4tensor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m    tensor_meta = SubclassTensorArgs([0m
[30;1m68 | [0m[35m        kwargs.get("size", nf4tensor.size()),[0m
[30;1m69 | [0m[35m        kwargs.get("stride", nf4tensor.stride()),[0m
[30;1m70 | [0m[35m        kwargs.get("storage_offset", nf4tensor.storage_offset()),[0m
[30;1m71 | [0m[35m        kwargs.get("dtype", nf4tensor.dtype),[0m
[30;1m72 | [0m[35m        kwargs.get("device", nf4tensor.device),[0m
[30;1m73 | [0m[35m        kwargs.get("requires_grad", nf4tensor.requires_grad),[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/nf4tensor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m66 | [0m[35m        kwargs = {}[0m
[30;1m67 | [0m[35m    tensor_meta = SubclassTensorArgs([0m
[30;1m68 | [0m[35m        kwargs.get("size", nf4tensor.size()),[0m
[30;1m69 | [0m[35m        kwargs.get("stride", nf4tensor.stride()),[0m
[30;1m70 | [0m[35m        kwargs.get("storage_offset", nf4tensor.storage_offset()),[0m
[30;1m71 | [0m[35m        kwargs.get("dtype", nf4tensor.dtype),[0m
[30;1m72 | [0m[35m        kwargs.get("device", nf4tensor.device),[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/nf4tensor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m65 | [0m[35m    if kwargs is None:[0m
[30;1m66 | [0m[35m        kwargs = {}[0m
[30;1m67 | [0m[35m    tensor_meta = SubclassTensorArgs([0m
[30;1m68 | [0m[35m        kwargs.get("size", nf4tensor.size()),[0m
[30;1m69 | [0m[35m        kwargs.get("stride", nf4tensor.stride()),[0m
[30;1m70 | [0m[35m        kwargs.get("storage_offset", nf4tensor.storage_offset()),[0m
[30;1m71 | [0m[35m        kwargs.get("dtype", nf4tensor.dtype),[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/nf4tensor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m843 | [0m[35m    @classmethod[0m
[30;1m844 | [0m[35m    @torch._dynamo.disable[0m
[30;1m845 | [0m[35m    def __torch_dispatch__(cls, func, types, args, kwargs=None):[0m
[30;1m846 | [0m[35m        """TODO we are not supporting torch dispatch at the moment[0m
[30;1m847 | [0m[35m        instead we have created a Autograd.Function to handle the linear[0m
[30;1m848 | [0m[35m        """[0m
[30;1m849 | [0m[35m        # All ops in the  NF4_OPS_TABLE expect NF4 Tensors as inputs[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/nf4tensor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m766 | [0m[35m[0m
[30;1m767 | [0m[35m        # Build up matrix of scalers repeated for each element in the block[0m
[30;1m768 | [0m[35m        # Since first and second elements make up a full block[0m
[30;1m769 | [0m[35m        # we expand out to half the size of the full block[0m
[30;1m770 | [0m[35m        scalers = self.dequantize_scalers([0m
[30;1m771 | [0m[35m            self.quantized_scalers, self.quantization_factor, self.scaler_block_size[0m
[30;1m772 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/nf4tensor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m846 | [0m[35m        """TODO we are not supporting torch dispatch at the moment[0m
[30;1m847 | [0m[35m        instead we have created a Autograd.Function to handle the linear[0m
[30;1m848 | [0m[35m        """[0m
[30;1m849 | [0m[35m        # All ops in the  NF4_OPS_TABLE expect NF4 Tensors as inputs[0m
[30;1m850 | [0m[35m        # And don't support mixed tensor subclasses. This will trigger the handler for[0m
[30;1m851 | [0m[35m        # the next type in the dispatch list[0m
[30;1m852 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/nf4tensor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m786 | [0m[35m        """Quantize a float16 tensor to nf4 format to nearest and not rounded up"""[0m
[30;1m787 | [0m[35m        value = value.unsqueeze(-1)  # (numel, 1)[0m
[30;1m788 | [0m[35m        # Compare the value tensor with the nf4 tensor element-wise[0m
[30;1m789 | [0m[35m        diff = (value - nf4).abs()[0m
[30;1m790 | [0m[35m        closest_nf4 = diff.min(dim=-1).indices[0m
[30;1m791 | [0m[35m        return closest_nf4[0m
[30;1m792 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/nf4tensor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m766 | [0m[35m[0m
[30;1m767 | [0m[35m        # Build up matrix of scalers repeated for each element in the block[0m
[30;1m768 | [0m[35m        # Since first and second elements make up a full block[0m
[30;1m769 | [0m[35m        # we expand out to half the size of the full block[0m
[30;1m770 | [0m[35m        scalers = self.dequantize_scalers([0m
[30;1m771 | [0m[35m            self.quantized_scalers, self.quantization_factor, self.scaler_block_size[0m
[30;1m772 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/nf4tensor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m636 | [0m[35m    ) -> Tuple[torch.Tensor, torch.Tensor, torch.Tensor]:[0m
[30;1m637 | [0m[35m        """Used to achieve the double quantization of the scalers[0m
[30;1m638 | [0m[35m        We take the input tensor first calculate the absmax quantization factors for each block.[0m
[30;1m639 | [0m[35m        We then find the mean of our positive absmax scalers. We subtract this mean from the scalers[0m
[30;1m640 | [0m[35m        And then we calculate the absmax quantization factors for each block again. We then quantize[0m
[30;1m641 | [0m[35m[0m
[30;1m642 | [0m[35m        Args:[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/testing/float8/roofline_utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m21 | [0m[35m        "peak_mem_bw_bytes_sec": 2.4e12,[0m
[30;1m22 | [0m[35m        # based on experimental observation with sample large inputs[0m
[30;1m23 | [0m[35m        "pct_achievable_gemm_tops": 0.78,[0m
[30;1m24 | [0m[35m        # based on previous experience looking at pointwise triton kernels with large inputs,[0m
[30;1m25 | [0m[35m        # which would hit about 2.2k GBPS on Meta's H100 variant[0m
[30;1m26 | [0m[35m        "pct_achievable_mem_bw": 0.92,[0m
[30;1m27 | [0m[35m    },[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/testing/float8/roofline_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m200 | [0m[35m        for x in res_bytes[0m
[30;1m201 | [0m[35m    ][0m
[30;1m202 | [0m[35m[0m
[30;1m203 | [0m[35m    # take max of kernel_overhead, r/w time[0m
[30;1m204 | [0m[35m    res_s = [sympy.Max(x, KERNEL_LAUNCH_OVERHEAD_SEC) for x in res_s][0m
[30;1m205 | [0m[35m[0m
[30;1m206 | [0m[35m    return res_s[0m
[30;1m207 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/testing/float8/roofline_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m# Source: run a triton kernel with a single element read/write on an H100 and[0m
[30;1m67 | [0m[35m# measure GPU time from the trace[0m
[30;1m68 | [0m[35m# TODO(future): audit this across different hardware and triton/non-triton[0m
[30;1m69 | [0m[35mKERNEL_LAUNCH_OVERHEAD_SEC = 0.002 * 0.001[0m
[30;1m70 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/modeling/sam/transformer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m303 | [0m[35m        # whether to repeat q rope to match k length[0m
[30;1m304 | [0m[35m        # this is needed for cross-attention to memories[0m
[30;1m305 | [0m[35m        rope_k_repeat=False,[0m
[30;1m306 | [0m[35m        feat_sizes=(32, 32),  # [w, h] for stride 16 feats at 512 resolution[0m
[30;1m307 | [0m[35m        **kwargs,[0m
[30;1m308 | [0m[35m    ):[0m
[30;1m309 | [0m[35m        super().__init__(*args, **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/mixed_precision/scripts/hessian_grad.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m142 | [0m[35m        seed = 0[0m
[30;1m143 | [0m[35m        trainloader, testloader = get_wikitext2(128, seed, 2048, tokenizer)[0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35m        # calculate Hessian for only one layer each time[0m
[30;1m146 | [0m[35m        params = [][0m
[30;1m147 | [0m[35m        layer_ = model.model.layers[layer_id][0m
[30;1m148 | [0m[35m        for param in layer_.self_attn.parameters():[0m
[30;1m149 | [0m[35m            params.append(param)[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/mixed_precision/scripts/hessian_grad.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35m        i = random.randint(0, trainenc.input_ids.shape[1] - seqlen - 1)[0m
[30;1m31 | [0m[35m        j = i + seqlen[0m
[30;1m32 | [0m[35m        inp = trainenc.input_ids[:, i:j][0m
[30;1m33 | [0m[35m        tar = inp.clone()[0m
[30;1m34 | [0m[35m        tar[:, :-1] = -100[0m
[30;1m35 | [0m[35m        trainloader.append((inp, tar))[0m
[30;1m36 | [0m[35m    return trainloader, testenc.input_ids[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/mixed_precision/scripts/mp_quant_eval.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m168 | [0m[35m        "--max_length",[0m
[30;1m169 | [0m[35m        type=int,[0m
[30;1m170 | [0m[35m        default=None,[0m
[30;1m171 | [0m[35m        help="Length of text to process at one time",[0m
[30;1m172 | [0m[35m    )[0m
[30;1m173 | [0m[35m    parser.add_argument([0m
[30;1m174 | [0m[35m        "--sensi_bit",[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/mixed_precision/scripts/BO_acc_throughput.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m386 | [0m[35m[0m
[30;1m387 | [0m[35m"""[0m
[30;1m388 | [0m[35mThis function will run BO trials sequentially on a single GPU.[0m
[30;1m389 | [0m[35mEach time the BO gets one new trial, evaluates the trial on the GPU and return the evaluation result[0m
[30;1m390 | [0m[35mOne trial, one BO update.[0m
[30;1m391 | [0m[35m"""[0m
[30;1m392 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/mixed_precision/scripts/BO_acc_throughput.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m386 | [0m[35m[0m
[30;1m387 | [0m[35m"""[0m
[30;1m388 | [0m[35mThis function will run BO trials sequentially on a single GPU.[0m
[30;1m389 | [0m[35mEach time the BO gets one new trial, evaluates the trial on the GPU and return the evaluation result[0m
[30;1m390 | [0m[35mOne trial, one BO update.[0m
[30;1m391 | [0m[35m"""[0m
[30;1m392 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/mixed_precision/scripts/BO_acc_throughput.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m# This source code is licensed under the BSD 3-Clause license found in the[0m
[30;1m5 | [0m[35m# LICENSE file in the root directory of this source tree.[0m
[30;1m6 | [0m[35mimport random[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35mfrom pathlib import Path[0m
[30;1m9 | [0m[35mfrom typing import Optional[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mimport torch[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/quant_api.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1351 | [0m[35m    Applies float8 dynamic quantization to activations and float8 quantization followed by compressi[0m
[30;1m1352 | [0m[35m[0m
[30;1m1353 | [0m[35m    Args:[0m
[30;1m1354 | [0m[35m        `layout`: layout type for quantized weight tensor, only supports `CutlassSemiSparseLayout` a[0m
[30;1m1355 | [0m[35m        `activation_dtype`: data type for quantized activation tensor.[0m
[30;1m1356 | [0m[35m        `weight_dtype`: data type for quantized weight tensor.[0m
[30;1m1357 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/quant_api.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1093 | [0m[35m    Applies int8 dnynamic symmetric per-token activation and int8 per-channel weight[0m
[30;1m1094 | [0m[35m    quantization + 2:4 sparsity to linear layers.[0m
[30;1m1095 | [0m[35m    """[0m
[30;1m1096 | [0m[35m    warnings.warn("""int8_dyanmic_activation_int8_semi_sparse_weight() will be deprecated at a later[0m
[30;1m1097 | [0m[35m[0m
[30;1m1098 | [0m[35m    from torchao.dtypes import SemiSparseLayout[0m
[30;1m1099 | [0m[35m    int8_dynamic_activation_int8_weight(layout=SemiSparseLayout()""")[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/quant_api.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m535 | [0m[35m[0m
[30;1m536 | [0m[35m    else:[0m
[30;1m537 | [0m[35m        raise AssertionError([0m
[30;1m538 | [0m[35m            """Passing a generic Callable to `quantize_` is no longer recommended and will be deprec[0m
[30;1m539 | [0m[35m        )[0m
[30;1m540 | [0m[35m[0m
[30;1m541 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/llama/eval.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m309 | [0m[35m        "--max_length",[0m
[30;1m310 | [0m[35m        type=int,[0m
[30;1m311 | [0m[35m        default=None,[0m
[30;1m312 | [0m[35m        help="Length of text to process at one time",[0m
[30;1m313 | [0m[35m    )[0m
[30;1m314 | [0m[35m    parser.add_argument([0m
[30;1m315 | [0m[35m        "--calibration_tasks",[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/llama/eval.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35m# This source code is licensed under the license found in the[0m
[30;1m5 | [0m[35m# LICENSE file in the root directory of this source tree.[0m
[30;1m6 | [0m[35mimport time[0m
[30;1m7 | [0m[35mfrom pathlib import Path[0m
[30;1m8 | [0m[35mfrom typing import List, Optional[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mimport torch[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/modeling/sam/mask_decoder.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m221 | [0m[35m[0m
[30;1m222 | [0m[35m        # TODO: These outputs are being immediately indexed.[0m
[30;1m223 | [0m[35m        # Is there something to remove?[0m
[30;1m224 | [0m[35m        # TODO: The fact that there's a crop box and we try to find stuff at the[0m
[30;1m225 | [0m[35m        # boundary later and there's generally cropping going on smells of padding.[0m
[30;1m226 | [0m[35m        iou_token_out = hs[:, s, :][0m
[30;1m227 | [0m[35m        mask_tokens_out = hs[:, s + 1 : (s + 1 + self.num_mask_tokens), :][0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/modeling/sam/mask_decoder.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m197 | [0m[35m        )[0m
[30;1m198 | [0m[35m        tokens = torch.cat((output_tokens, sparse_prompt_embeddings), dim=1)[0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35m        # Expand per-image data in batch direction to be per-mask[0m
[30;1m201 | [0m[35m        if repeat_image:[0m
[30;1m202 | [0m[35m            src = torch.repeat_interleave(image_embeddings, tokens.shape[0], dim=0)[0m
[30;1m203 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/modeling/sam/mask_decoder.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m157 | [0m[35m            sam_tokens_out = mask_tokens_out[:, 1:]  # [b, 3, c] shape[0m
[30;1m158 | [0m[35m        else:[0m
[30;1m159 | [0m[35m            # Take the mask output token. Here we *always* use the token for single mask output.[0m
[30;1m160 | [0m[35m            # At test time, even if we track after 1-click (and using multimask_output=True),[0m
[30;1m161 | [0m[35m            # we still take the single mask token here. The rationale is that we always track[0m
[30;1m162 | [0m[35m            # after multiple clicks during training, so the past tokens seen during training[0m
[30;1m163 | [0m[35m            # are always the single mask token (and we'll let it be the object-memory token).[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/modeling/sam/mask_decoder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m221 | [0m[35m[0m
[30;1m222 | [0m[35m        # TODO: These outputs are being immediately indexed.[0m
[30;1m223 | [0m[35m        # Is there something to remove?[0m
[30;1m224 | [0m[35m        # TODO: The fact that there's a crop box and we try to find stuff at the[0m
[30;1m225 | [0m[35m        # boundary later and there's generally cropping going on smells of padding.[0m
[30;1m226 | [0m[35m        iou_token_out = hs[:, s, :][0m
[30;1m227 | [0m[35m        mask_tokens_out = hs[:, s + 1 : (s + 1 + self.num_mask_tokens), :][0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/modeling/sam/mask_decoder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m197 | [0m[35m        )[0m
[30;1m198 | [0m[35m        tokens = torch.cat((output_tokens, sparse_prompt_embeddings), dim=1)[0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35m        # Expand per-image data in batch direction to be per-mask[0m
[30;1m201 | [0m[35m        if repeat_image:[0m
[30;1m202 | [0m[35m            src = torch.repeat_interleave(image_embeddings, tokens.shape[0], dim=0)[0m
[30;1m203 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/sparsifier/base_sparsifier.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m292 | [0m[35m                global_params = {k: config[k] for k in params_to_keep}[0m
[30;1m293 | [0m[35m                sparse_params.update(global_params)[0m
[30;1m294 | [0m[35m            if params_to_keep_per_layer is not None:[0m
[30;1m295 | [0m[35m                params = params_to_keep_per_layer.get(config["module_fqn"], None)[0m
[30;1m296 | [0m[35m                if params is not None:[0m
[30;1m297 | [0m[35m                    per_layer_params = {k: config[k] for k in params}[0m
[30;1m298 | [0m[35m                    sparse_params.update(per_layer_params)[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/sparsifier/base_sparsifier.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m216 | [0m[35m            module = config["module"][0m
[30;1m217 | [0m[35m            tensor_name = config["tensor_name"][0m
[30;1m218 | [0m[35m            parametrization = config.get("parametrization", FakeSparsity)[0m
[30;1m219 | [0m[35m            mask = config.get("mask", torch.ones_like(getattr(module, tensor_name)))[0m
[30;1m220 | [0m[35m            self.state[config["tensor_fqn"]]["mask"] = mask[0m
[30;1m221 | [0m[35m            parametrize.register_parametrization([0m
[30;1m222 | [0m[35m                module, tensor_name, parametrization(mask)[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/sparsifier/base_sparsifier.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m215 | [0m[35m        for config in self.groups:[0m
[30;1m216 | [0m[35m            module = config["module"][0m
[30;1m217 | [0m[35m            tensor_name = config["tensor_name"][0m
[30;1m218 | [0m[35m            parametrization = config.get("parametrization", FakeSparsity)[0m
[30;1m219 | [0m[35m            mask = config.get("mask", torch.ones_like(getattr(module, tensor_name)))[0m
[30;1m220 | [0m[35m            self.state[config["tensor_fqn"]]["mask"] = mask[0m
[30;1m221 | [0m[35m            parametrize.register_parametrization([0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/sparsifier/base_sparsifier.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m185 | [0m[35m            local_args = copy.deepcopy(self.defaults)[0m
[30;1m186 | [0m[35m            local_args.update(module_config)[0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35m            tensor_fqn = local_args.get("tensor_fqn", None)[0m
[30;1m189 | [0m[35m            assert tensor_fqn is not None, ([0m
[30;1m190 | [0m[35m                "tensor_fqn is a required argument in the sparsity config which"[0m
[30;1m191 | [0m[35m                "replaces previous `module` and [module]`fqn` arguments"[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/sparsifier/base_sparsifier.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m133 | [0m[35m            if not found:[0m
[30;1m134 | [0m[35m                p = FakeSparsity(torch.ones(getattr(module, tensor_name).shape))[0m
[30;1m135 | [0m[35m                parametrize.register_parametrization(module, tensor_name, p)[0m
[30;1m136 | [0m[35m            if s.get("mask", None) is not None:[0m
[30;1m137 | [0m[35m                mask = s.pop("mask")[0m
[30;1m138 | [0m[35m                p.mask = mask[0m
[30;1m139 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/sparsifier/base_sparsifier.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m30 | [0m[35m__all__ = ["BaseSparsifier"][0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m# TODO update desc with new config args[0m
[30;1m34 | [0m[35mclass BaseSparsifier(abc.ABC):[0m
[30;1m35 | [0m[35m    r"""Base class for all sparsifiers.[0m
[30;1m36 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/sparsifier/base_sparsifier.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m324 | [0m[35m[0m
[30;1m325 | [0m[35m        reassign = {}[0m
[30;1m326 | [0m[35m        for name, mod in module.named_children():[0m
[30;1m327 | [0m[35m            # leaf node[0m
[30;1m328 | [0m[35m            if ([0m
[30;1m329 | [0m[35m                module_contains_param(mod, parameterization)[0m
[30;1m330 | [0m[35m                and type_before_parametrizations(mod) in mapping[0m
[30;1m331 | [0m[35m            ):[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/float8/float8_linear.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m    def __init__(self, *args, **kwargs):[0m
[30;1m264 | [0m[35m        """[0m
[30;1m265 | [0m[35m        Additional arguments on top of `torch.nn.Linear`'s arguments:[0m
[30;1m266 | [0m[35m        * `config`: Float8LinearConfig[0m
[30;1m267 | [0m[35m        """[0m
[30;1m268 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/superblock/evaluate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m52 | [0m[35m            model.load_state_dict(checkpoint["model"])[0m
[30;1m53 | [0m[35m            print(f"Loaded checkpoint successfully from: {args.weights_path}")[0m
[30;1m54 | [0m[35m        except FileNotFoundError:[0m
[30;1m55 | [0m[35m            raise FileNotFoundError(f"No checkpoint found at {args.weights_path}")[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    model.to(device).bfloat16()[0m
[30;1m58 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/scheduler/cubic_scheduler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m81 | [0m[35m                If False, sets to s_0[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m        Returns:[0m
[30;1m84 | [0m[35m            The sparsity level :math:`s_t` at the current step :math:`t`[0m
[30;1m85 | [0m[35m        """[0m
[30;1m86 | [0m[35m        if initially_zero and t < t_0:[0m
[30;1m87 | [0m[35m            return 0[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/scheduler/cubic_scheduler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m25 | [0m[35m    where :math:`s_i` is the sparsity at epoch :math:`t`, :math;`s_f` is the final[0m
[30;1m26 | [0m[35m    sparsity level, :math:`f(i)` is the function to be applied to the current epoch[0m
[30;1m27 | [0m[35m    :math:`t`, initial epoch :math:`t_0`, and final epoch :math:`t_f`.[0m
[30;1m28 | [0m[35m    :math:`\Delta t` is used to control how often the update of the sparsity level[0m
[30;1m29 | [0m[35m    happens. By default,[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m    Args:[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/scheduler/cubic_scheduler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m25 | [0m[35m    where :math:`s_i` is the sparsity at epoch :math:`t`, :math;`s_f` is the final[0m
[30;1m26 | [0m[35m    sparsity level, :math:`f(i)` is the function to be applied to the current epoch[0m
[30;1m27 | [0m[35m    :math:`t`, initial epoch :math:`t_0`, and final epoch :math:`t_f`.[0m
[30;1m28 | [0m[35m    :math:`\Delta t` is used to control how often the update of the sparsity level[0m
[30;1m29 | [0m[35m    happens. By default,[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m    Args:[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/scheduler/cubic_scheduler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m        s_i = s_f + (s_0 - s_f) \cdot \left( 1 - \frac{t - t_0}{n\Delta t} \right)^3[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m    where :math:`s_i` is the sparsity at epoch :math:`t`, :math;`s_f` is the final[0m
[30;1m26 | [0m[35m    sparsity level, :math:`f(i)` is the function to be applied to the current epoch[0m
[30;1m27 | [0m[35m    :math:`t`, initial epoch :math:`t_0`, and final epoch :math:`t_f`.[0m
[30;1m28 | [0m[35m    :math:`\Delta t` is used to control how often the update of the sparsity level[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/automatic_mask_generator.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m734 | [0m[35m            if scores[i_mask] == 0.0:[0m
[30;1m735 | [0m[35m                mask_torch = masks[i_mask].unsqueeze(0)[0m
[30;1m736 | [0m[35m                mask_data["rles"][i_mask] = mask_to_rle_pytorch(mask_torch)[0][0m
[30;1m737 | [0m[35m                mask_data["boxes"][i_mask] = boxes[i_mask]  # update res directly[0m
[30;1m738 | [0m[35m        mask_data.filter(keep_by_nms)[0m
[30;1m739 | [0m[35m[0m
[30;1m740 | [0m[35m        return mask_data[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/automatic_mask_generator.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m468 | [0m[35m                        data["masks"], crop_box, orig_h, orig_w[0m
[30;1m469 | [0m[35m                    )[0m
[30;1m470 | [0m[35m                    # TODO: Capture all these masks in a single NT for mask_to_rle_pytorch_2[0m
[30;1m471 | [0m[35m                    # or at a minimum create a mask_to_rle_pytorch_2_list and use loops[0m
[30;1m472 | [0m[35m                    # to cause a single DtoH sync[0m
[30;1m473 | [0m[35m                    data["rles"] = _mask_to_rle_pytorch_2_0(data["masks"])[0m
[30;1m474 | [0m[35m                    del data["masks"][0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/automatic_mask_generator.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m106 | [0m[35m            For large resolutions, 'binary_mask' may consume large amounts of[0m
[30;1m107 | [0m[35m            memory.[0m
[30;1m108 | [0m[35m          use_m2m (bool): Whether to add a one step refinement using previous mask predictions.[0m
[30;1m109 | [0m[35m          multimask_output (bool): Whether to output multimask at each point of the grid.[0m
[30;1m110 | [0m[35m        """[0m
[30;1m111 | [0m[35m        super().__init__()[0m
[30;1m112 | [0m[35m        assert (points_per_side is None) != ([0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/autoquant.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1147 | [0m[35m        "qtensor_class_list", DEFAULT_AUTOQUANT_CLASS_LIST[0m
[30;1m1148 | [0m[35m    )[0m
[30;1m1149 | [0m[35m    kwargs["mode"] = kwargs.get("mode", ["relu", None])[0m
[30;1m1150 | [0m[35m    kwargs["min_sqnr"] = kwargs.get("min_sqnr", None)[0m
[30;1m1151 | [0m[35m    from torchao.quantization.quant_api import ([0m
[30;1m1152 | [0m[35m        _get_subclass_inserter,[0m
[30;1m1153 | [0m[35m        _replace_with_custom_fn_if_matches_filter,[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/autoquant.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1146 | [0m[35m    kwargs["qtensor_class_list"] = kwargs.get([0m
[30;1m1147 | [0m[35m        "qtensor_class_list", DEFAULT_AUTOQUANT_CLASS_LIST[0m
[30;1m1148 | [0m[35m    )[0m
[30;1m1149 | [0m[35m    kwargs["mode"] = kwargs.get("mode", ["relu", None])[0m
[30;1m1150 | [0m[35m    kwargs["min_sqnr"] = kwargs.get("min_sqnr", None)[0m
[30;1m1151 | [0m[35m    from torchao.quantization.quant_api import ([0m
[30;1m1152 | [0m[35m        _get_subclass_inserter,[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/autoquant.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1143 | [0m[35m    _ = kwargs.pop([0m
[30;1m1144 | [0m[35m        "error_on_unseen", True[0m
[30;1m1145 | [0m[35m    )  # same kwargs used for this and to_quantized[0m
[30;1m1146 | [0m[35m    kwargs["qtensor_class_list"] = kwargs.get([0m
[30;1m1147 | [0m[35m        "qtensor_class_list", DEFAULT_AUTOQUANT_CLASS_LIST[0m
[30;1m1148 | [0m[35m    )[0m
[30;1m1149 | [0m[35m    kwargs["mode"] = kwargs.get("mode", ["relu", None])[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/autoquant.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m804 | [0m[35m        kwargs = {}[0m
[30;1m805 | [0m[35m        kwargs["device"] = weight.device[0m
[30;1m806 | [0m[35m        kwargs["layout"] = ([0m
[30;1m807 | [0m[35m            kwargs.get("layout") if kwargs.get("layout", False) else weight.layout[0m
[30;1m808 | [0m[35m        )[0m
[30;1m809 | [0m[35m        kwargs["dtype"] = weight.dtype[0m
[30;1m810 | [0m[35m        kwargs["requires_grad"] = False[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/autoquant.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m804 | [0m[35m        kwargs = {}[0m
[30;1m805 | [0m[35m        kwargs["device"] = weight.device[0m
[30;1m806 | [0m[35m        kwargs["layout"] = ([0m
[30;1m807 | [0m[35m            kwargs.get("layout") if kwargs.get("layout", False) else weight.layout[0m
[30;1m808 | [0m[35m        )[0m
[30;1m809 | [0m[35m        kwargs["dtype"] = weight.dtype[0m
[30;1m810 | [0m[35m        kwargs["requires_grad"] = False[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/autoquant.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m142 | [0m[35m            None if bias is None else bias.shape,[0m
[30;1m143 | [0m[35m        )[0m
[30;1m144 | [0m[35m        shapes_and_dtype = logged_shapes + (logged_dtype,)[0m
[30;1m145 | [0m[35m        w_autoquant.logged_data[shapes_and_dtype] = 1 + w_autoquant.logged_data.get([0m
[30;1m146 | [0m[35m            shapes_and_dtype, 0[0m
[30;1m147 | [0m[35m        )[0m
[30;1m148 | [0m[35m        for q_cls in w_autoquant.qtensor_class_list:[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/autoquant.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m105 | [0m[35m            kwargs.get("layout") if kwargs.get("layout", False) else weight.layout[0m
[30;1m106 | [0m[35m        )[0m
[30;1m107 | [0m[35m        kwargs["dtype"] = ([0m
[30;1m108 | [0m[35m            kwargs.get("dtype") if kwargs.get("dtype", False) else weight.dtype[0m
[30;1m109 | [0m[35m        )[0m
[30;1m110 | [0m[35m        kwargs["requires_grad"] = False[0m
[30;1m111 | [0m[35m        shape = kwargs.pop("shape", weight.shape)[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/autoquant.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m105 | [0m[35m            kwargs.get("layout") if kwargs.get("layout", False) else weight.layout[0m
[30;1m106 | [0m[35m        )[0m
[30;1m107 | [0m[35m        kwargs["dtype"] = ([0m
[30;1m108 | [0m[35m            kwargs.get("dtype") if kwargs.get("dtype", False) else weight.dtype[0m
[30;1m109 | [0m[35m        )[0m
[30;1m110 | [0m[35m        kwargs["requires_grad"] = False[0m
[30;1m111 | [0m[35m        shape = kwargs.pop("shape", weight.shape)[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/autoquant.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m102 | [0m[35m    ):[0m
[30;1m103 | [0m[35m        kwargs["device"] = weight.device[0m
[30;1m104 | [0m[35m        kwargs["layout"] = ([0m
[30;1m105 | [0m[35m            kwargs.get("layout") if kwargs.get("layout", False) else weight.layout[0m
[30;1m106 | [0m[35m        )[0m
[30;1m107 | [0m[35m        kwargs["dtype"] = ([0m
[30;1m108 | [0m[35m            kwargs.get("dtype") if kwargs.get("dtype", False) else weight.dtype[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/autoquant.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m102 | [0m[35m    ):[0m
[30;1m103 | [0m[35m        kwargs["device"] = weight.device[0m
[30;1m104 | [0m[35m        kwargs["layout"] = ([0m
[30;1m105 | [0m[35m            kwargs.get("layout") if kwargs.get("layout", False) else weight.layout[0m
[30;1m106 | [0m[35m        )[0m
[30;1m107 | [0m[35m        kwargs["dtype"] = ([0m
[30;1m108 | [0m[35m            kwargs.get("dtype") if kwargs.get("dtype", False) else weight.dtype[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/autoquant.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35mdef check_cache(cls, shapes_and_dtype):[0m
[30;1m71 | [0m[35m    return AUTOQUANT_CACHE.get((cls,) + shapes_and_dtype, None)[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35mdef update_cache(cls, shapes_and_dtype, res):[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/autoquant.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1010 | [0m[35m        weight = to_linear_activation_quantized([0m
[30;1m1011 | [0m[35m            weight, input_quant_func, quant_kwargs=input_quant_kwargs[0m
[30;1m1012 | [0m[35m        )[0m
[30;1m1013 | [0m[35m        # at inference time,[0m
[30;1m1014 | [0m[35m        # we first convert the input, weight and bias to bfloat16, and then quantize activation[0m
[30;1m1015 | [0m[35m        # and then dispatch to the quantized ops[0m
[30;1m1016 | [0m[35m        return super([0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/autoquant.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m524 | [0m[35m        if res_matmul >= best_time:[0m
[30;1m525 | [0m[35m            return res_matmul[0m
[30;1m526 | [0m[35m[0m
[30;1m527 | [0m[35m        # calculate what time full op needs to beat for dynamic quant to be best given INTERPOLATION[0m
[30;1m528 | [0m[35m        to_beat = best_time + INTERPOLATION_CONSTANT / (1 - INTERPOLATION_CONSTANT) * ([0m
[30;1m529 | [0m[35m            best_time - res_matmul[0m
[30;1m530 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/autoquant.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m491 | [0m[35m                                   (e.g., "relu"), and the second element is the mode value (e.g., N[0m
[30;1m492 | [0m[35m[0m
[30;1m493 | [0m[35m        Returns:[0m
[30;1m494 | [0m[35m            float: The benchmarked time for the autoquantization process.[0m
[30;1m495 | [0m[35m        """[0m
[30;1m496 | [0m[35m        if not _is_interpolate_mode(mode):[0m
[30;1m497 | [0m[35m            return super()._autoquant_test(act_mat, weight, bias, best_time, mode)[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/autoquant.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m486 | [0m[35m            act_mat (torch.Tensor): The activation matrix.[0m
[30;1m487 | [0m[35m            weight (torch.Tensor): The weight tensor.[0m
[30;1m488 | [0m[35m            bias (torch.Tensor or None): The bias tensor.[0m
[30;1m489 | [0m[35m            best_time (float): The best time to beat for the quantization process.[0m
[30;1m490 | [0m[35m            mode (list, optional): A list containing mode settings for quantization. The first eleme[0m
[30;1m491 | [0m[35m                                   (e.g., "relu"), and the second element is the mode value (e.g., N[0m
[30;1m492 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/autoquant.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m401 | [0m[35m                                (e.g., "relu"), and the second element is the mode value (e.g., None[0m
[30;1m402 | [0m[35m[0m
[30;1m403 | [0m[35m    Returns:[0m
[30;1m404 | [0m[35m        float: The benchmarked time for the autoquantization process.[0m
[30;1m405 | [0m[35m    """[0m
[30;1m406 | [0m[35m[0m
[30;1m407 | [0m[35m    @classmethod[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/autoquant.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m396 | [0m[35m        act_mat (torch.Tensor): The activation matrix.[0m
[30;1m397 | [0m[35m        weight (torch.Tensor): The weight tensor.[0m
[30;1m398 | [0m[35m        bias (torch.Tensor or None): The bias tensor.[0m
[30;1m399 | [0m[35m        best_time (float): The best time to beat for the quantization process.[0m
[30;1m400 | [0m[35m        mode (list, optional): A list containing mode settings for quantization. The first element i[0m
[30;1m401 | [0m[35m                                (e.g., "relu"), and the second element is the mode value (e.g., None[0m
[30;1m402 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/autoquant.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m242 | [0m[35m                cur_time += check_cache(q_cls, shapes_and_dtype) * times_seen[0m
[30;1m243 | [0m[35m                total_seen += times_seen[0m
[30;1m244 | [0m[35m            cur_time = cur_time / total_seen[0m
[30;1m245 | [0m[35m            # print aggregated time if there were multiple shapes to aggregate and some new benchmar[0m
[30;1m246 | [0m[35m            if shape_count is not None and shape_count > 1 and ran_new_benchmarks:[0m
[30;1m247 | [0m[35m                print([0m
[30;1m248 | [0m[35m                    f">time (all shapes): {cur_time:0.4f}ms for {q_cls}, prev_best: {best_time:0.4f}[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/uintx/int4_cpu_layout.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m        kwargs["device"] = packed_weight.device[0m
[30;1m65 | [0m[35m        kwargs["layout"] = ([0m
[30;1m66 | [0m[35m            kwargs.get("layout")[0m
[30;1m67 | [0m[35m            if kwargs.get("layout", False)[0m
[30;1m68 | [0m[35m            else packed_weight.layout[0m
[30;1m69 | [0m[35m        )[0m
[30;1m70 | [0m[35m        kwargs["dtype"] = packed_weight.dtype[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/uintx/int4_cpu_layout.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m63 | [0m[35m        kwargs = {}[0m
[30;1m64 | [0m[35m        kwargs["device"] = packed_weight.device[0m
[30;1m65 | [0m[35m        kwargs["layout"] = ([0m
[30;1m66 | [0m[35m            kwargs.get("layout")[0m
[30;1m67 | [0m[35m            if kwargs.get("layout", False)[0m
[30;1m68 | [0m[35m            else packed_weight.layout[0m
[30;1m69 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/uintx/int4_cpu_layout.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m309 | [0m[35mdef _linear_fp_act_uint4_weight_cpu_impl(input_tensor, weight_tensor, bias):[0m
[30;1m310 | [0m[35m    assert ([0m
[30;1m311 | [0m[35m        TORCH_VERSION_AT_LEAST_2_6[0m
[30;1m312 | [0m[35m    ), f"Requires PyTorch version at least 2.6, but got: {torch.__version__}"[0m
[30;1m313 | [0m[35m    assert is_device([0m
[30;1m314 | [0m[35m        input_tensor.device.type, "cpu"[0m
[30;1m315 | [0m[35m    ), f"For CPU device only but got: {input_tensor.device}"[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/uintx/int4_cpu_layout.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m30 | [0m[35m@dataclass(frozen=True)[0m
[30;1m31 | [0m[35mclass Int4CPULayout(Layout):[0m
[30;1m32 | [0m[35m    """Layout class for int4 CPU layout for affine quantized tensor, used by tinygemm kernels `_weig[0m
[30;1m33 | [0m[35m    Only for PyTorch version at least 2.6[0m
[30;1m34 | [0m[35m    """[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m    pass[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/kernel/bsr_triton_ops.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m377 | [0m[35m    ) = prepare_inputs(bsr, input, dense, left_alpha, right_alpha, out)[0m
[30;1m378 | [0m[35m[0m
[30;1m379 | [0m[35m    BM, BK = blocksize[0m
[30;1m380 | [0m[35m    SPLIT_N = meta.get("SPLIT_N", max(N // BM, 1))[0m
[30;1m381 | [0m[35m    BN = N // SPLIT_N[0m
[30;1m382 | [0m[35m[0m
[30;1m383 | [0m[35m    out_untiled = out[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/kernel/bsr_triton_ops.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m122 | [0m[35m        # value. The input value is assumed to be valid.[0m
[30;1m123 | [0m[35m        is_log = name in {"SPLIT_N", "num_warps"}[0m
[30;1m124 | [0m[35m        min_value = dict(SPLIT_N=1, num_warps=1, num_stages=1, GROUP_SIZE_ROW=1)[name][0m
[30;1m125 | [0m[35m        max_value = dict(SPLIT_N=max(N // BM, 1)).get(name)[0m
[30;1m126 | [0m[35m        value_step = dict(SPLIT_N=2, num_warps=2, num_stages=1, GROUP_SIZE_ROW=1)[name][0m
[30;1m127 | [0m[35m        if is_log:[0m
[30;1m128 | [0m[35m            next_value = ([0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/kernel/bsr_triton_ops.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m25 | [0m[35m    ptr_stride_extractor,[0m
[30;1m26 | [0m[35m    tile_to_blocksize,[0m
[30;1m27 | [0m[35m)[0m
[30;1m28 | [0m[35mfrom torch.sparse._triton_ops_meta import get_meta, minimize, update[0m
[30;1m29 | [0m[35mfrom torch.utils._triton import has_triton[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35mAUTOTUNE = os.getenv("BSR_AUTOTUNE", False)[0m
[30;1m32 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/kernel/bsr_triton_ops.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m605 | [0m[35m        for _ in range(row_nnz):[0m
[30;1m606 | [0m[35m            values_block = tl.load(values_block_ptrs)[0m
[30;1m607 | [0m[35m[0m
[30;1m608 | [0m[35m            # find which row of dense needs to get loaded[0m
[30;1m609 | [0m[35m            # for multiplication with values_block.[0m
[30;1m610 | [0m[35m            dense_row_idx = tl.load(col_index_nnz_ptr)[0m
[30;1m611 | [0m[35m            dense_block = tl.load([0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/kernel/bsr_triton_ops.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m248 | [0m[35m            warn_once([0m
[30;1m249 | [0m[35m                "bsr_dense_addmm uses non-optimal triton kernel parameters"[0m
[30;1m250 | [0m[35m                f" for {M=} {K=} {N=} {Ms=}, {Ks=} {beta=} {alpha=} {dtype=} {out_dtype=}. "[0m
[30;1m251 | [0m[35m                "To find optimal triton kernel parameters, run with BSR_AUTOTUNE=1"[0m
[30;1m252 | [0m[35m            )[0m
[30;1m253 | [0m[35m[0m
[30;1m254 | [0m[35m    SPLIT_N = SPLIT_N or max(N // Ms, 1)[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/kernel/bsr_triton_ops.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m219 | [0m[35m                "bsr_dense_addmm", key, device_name, version=(_version, dtype, 0.5)[0m
[30;1m220 | [0m[35m            )[0m
[30;1m221 | [0m[35m        if meta is None:[0m
[30;1m222 | [0m[35m            # find approximate meta such that N % SPLIT_N == 0.[0m
[30;1m223 | [0m[35m            matching_meta = get_meta([0m
[30;1m224 | [0m[35m                "bsr_dense_addmm",[0m
[30;1m225 | [0m[35m                (*key[:2], "*", *key[3:]),[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/floatx/float8_layout.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m79 | [0m[35m        kwargs = {}[0m
[30;1m80 | [0m[35m        kwargs["device"] = float8_data.device[0m
[30;1m81 | [0m[35m        kwargs["layout"] = ([0m
[30;1m82 | [0m[35m            kwargs.get("layout") if kwargs.get("layout", False) else float8_data.layout[0m
[30;1m83 | [0m[35m        )[0m
[30;1m84 | [0m[35m        kwargs["dtype"] = float8_data.dtype[0m
[30;1m85 | [0m[35m        kwargs["requires_grad"] = False[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/floatx/float8_layout.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m79 | [0m[35m        kwargs = {}[0m
[30;1m80 | [0m[35m        kwargs["device"] = float8_data.device[0m
[30;1m81 | [0m[35m        kwargs["layout"] = ([0m
[30;1m82 | [0m[35m            kwargs.get("layout") if kwargs.get("layout", False) else float8_data.layout[0m
[30;1m83 | [0m[35m        )[0m
[30;1m84 | [0m[35m        kwargs["dtype"] = float8_data.dtype[0m
[30;1m85 | [0m[35m        kwargs["requires_grad"] = False[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/superblock/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m793 | [0m[35mdef store_model_weights(model, checkpoint_path, checkpoint_key="model", strict=True):[0m
[30;1m794 | [0m[35m    """[0m
[30;1m795 | [0m[35m    This method can be used to prepare weights files for new models. It receives as[0m
[30;1m796 | [0m[35m    input a model architecture and a checkpoint from the training script and produces[0m
[30;1m797 | [0m[35m    a file with the weights ready for release.[0m
[30;1m798 | [0m[35m[0m
[30;1m799 | [0m[35m    Examples:[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/superblock/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m635 | [0m[35m[0m
[30;1m636 | [0m[35m[0m
[30;1m637 | [0m[35mdef accuracy(output, target, topk=(1,)):[0m
[30;1m638 | [0m[35m    """Computes the accuracy over the k top predictions for the specified values of k"""[0m
[30;1m639 | [0m[35m    with torch.inference_mode():[0m
[30;1m640 | [0m[35m        maxk = max(topk)[0m
[30;1m641 | [0m[35m        batch_size = target.size(0)[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/superblock/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m468 | [0m[35m        self.deque = deque(maxlen=window_size)[0m
[30;1m469 | [0m[35m        self.total = 0.0[0m
[30;1m470 | [0m[35m        self.count = 0[0m
[30;1m471 | [0m[35m        self.fmt = fmt[0m
[30;1m472 | [0m[35m[0m
[30;1m473 | [0m[35m    def update(self, value, n=1):[0m
[30;1m474 | [0m[35m        self.deque.append(value)[0m
[30;1m475 | [0m[35m        self.count += n[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/superblock/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m464 | [0m[35m[0m
[30;1m465 | [0m[35m    def __init__(self, window_size=20, fmt=None):[0m
[30;1m466 | [0m[35m        if fmt is None:[0m
[30;1m467 | [0m[35m            fmt = "{median:.4f} ({global_avg:.4f})"[0m
[30;1m468 | [0m[35m        self.deque = deque(maxlen=window_size)[0m
[30;1m469 | [0m[35m        self.total = 0.0[0m
[30;1m470 | [0m[35m        self.count = 0[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/superblock/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m463 | [0m[35m    """[0m
[30;1m464 | [0m[35m[0m
[30;1m465 | [0m[35m    def __init__(self, window_size=20, fmt=None):[0m
[30;1m466 | [0m[35m        if fmt is None:[0m
[30;1m467 | [0m[35m            fmt = "{median:.4f} ({global_avg:.4f})"[0m
[30;1m468 | [0m[35m        self.deque = deque(maxlen=window_size)[0m
[30;1m469 | [0m[35m        self.total = 0.0[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/superblock/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mimport hashlib[0m
[30;1m8 | [0m[35mimport math[0m
[30;1m9 | [0m[35mimport os[0m
[30;1m10 | [0m[35mimport time[0m
[30;1m11 | [0m[35mfrom collections import OrderedDict, defaultdict, deque[0m
[30;1m12 | [0m[35mfrom typing import List, Optional, Tuple[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mimport torch[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/superblock/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m855 | [0m[35m        # Read and update hash string value in blocks of 4K[0m
[30;1m856 | [0m[35m        for byte_block in iter(lambda: f.read(4096), b""):[0m
[30;1m857 | [0m[35m            sha256_hash.update(byte_block)[0m
[30;1m858 | [0m[35m        hh = sha256_hash.hexdigest()[0m
[30;1m859 | [0m[35m[0m
[30;1m860 | [0m[35m    output_path = os.path.join(output_dir, "weights-" + str(hh[:8]) + ".pth")[0m
[30;1m861 | [0m[35m    os.replace(tmp_path, output_path)[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/superblock/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m852 | [0m[35m[0m
[30;1m853 | [0m[35m    sha256_hash = hashlib.sha256()[0m
[30;1m854 | [0m[35m    with open(tmp_path, "rb") as f:[0m
[30;1m855 | [0m[35m        # Read and update hash string value in blocks of 4K[0m
[30;1m856 | [0m[35m        for byte_block in iter(lambda: f.read(4096), b""):[0m
[30;1m857 | [0m[35m            sha256_hash.update(byte_block)[0m
[30;1m858 | [0m[35m        hh = sha256_hash.hexdigest()[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/superblock/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m282 | [0m[35m            "--model-ema-steps",[0m
[30;1m283 | [0m[35m            type=int,[0m
[30;1m284 | [0m[35m            default=32,[0m
[30;1m285 | [0m[35m            help="the number of iterations that controls how often to update the EMA model (default:[0m
[30;1m286 | [0m[35m        )[0m
[30;1m287 | [0m[35m        parser.add_argument([0m
[30;1m288 | [0m[35m            "--model-ema-decay",[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/llama/generate.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35m    # format model input[0m
[30;1m182 | [0m[35m    prompt, input_pos = prepare_inputs_for_model(prompt)[0m
[30;1m183 | [0m[35m    prompt = prompt.repeat(batch_size, 1)  # expand prompt based on batchsize[0m
[30;1m184 | [0m[35m[0m
[30;1m185 | [0m[35m    # full prompt+output will be stored in seq[0m
[30;1m186 | [0m[35m    seq = torch.empty(batch_size, max_seq_length, dtype=prompt.dtype, device=device)[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/llama/generate.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m993 | [0m[35m        aggregate_metrics["prefill_time"].append(prefill_time)[0m
[30;1m994 | [0m[35m        print([0m
[30;1m995 | [0m[35m            f"Sample {i+1} | overall time {t:.04f} s {tokens_sec:.02f} tokens/sec",[0m
[30;1m996 | [0m[35m            f"| prefill time {prefill_time:.04f} s decode {decode_tokens_sec:.02f} tokens/sec",[0m
[30;1m997 | [0m[35m        )[0m
[30;1m998 | [0m[35m        print(f"Bandwidth achieved: {model_size * tokens_sec:.02f} GB/s")[0m
[30;1m999 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/llama/generate.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m992 | [0m[35m        prefill_time = prefill_start_event.elapsed_time(prefill_end_event) / 1000[0m
[30;1m993 | [0m[35m        aggregate_metrics["prefill_time"].append(prefill_time)[0m
[30;1m994 | [0m[35m        print([0m
[30;1m995 | [0m[35m            f"Sample {i+1} | overall time {t:.04f} s {tokens_sec:.02f} tokens/sec",[0m
[30;1m996 | [0m[35m            f"| prefill time {prefill_time:.04f} s decode {decode_tokens_sec:.02f} tokens/sec",[0m
[30;1m997 | [0m[35m        )[0m
[30;1m998 | [0m[35m        print(f"Bandwidth achieved: {model_size * tokens_sec:.02f} GB/s")[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/llama/generate.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35m    # format model input[0m
[30;1m182 | [0m[35m    prompt, input_pos = prepare_inputs_for_model(prompt)[0m
[30;1m183 | [0m[35m    prompt = prompt.repeat(batch_size, 1)  # expand prompt based on batchsize[0m
[30;1m184 | [0m[35m[0m
[30;1m185 | [0m[35m    # full prompt+output will be stored in seq[0m
[30;1m186 | [0m[35m    seq = torch.empty(batch_size, max_seq_length, dtype=prompt.dtype, device=device)[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/llama/generate.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m# This source code is licensed under the license found in the[0m
[30;1m5 | [0m[35m# LICENSE file in the root directory of this source tree.[0m
[30;1m6 | [0m[35mimport sys[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35mfrom datetime import datetime[0m
[30;1m9 | [0m[35mfrom pathlib import Path[0m
[30;1m10 | [0m[35mfrom typing import Optional, Tuple[0m
[30;1m11 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/kernel/autotuner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m231 | [0m[35m            " ".join([f"{i:4d}/{len(configs):4d}", f"{time:6.3f}", str(config)])[0m
[30;1m232 | [0m[35m        )[0m
[30;1m233 | [0m[35m        if time < best_time:[0m
[30;1m234 | [0m[35m            best_time = time[0m
[30;1m235 | [0m[35m            best_config = config[0m
[30;1m236 | [0m[35m        i += 1[0m
[30;1m237 | [0m[35m    # Also store time, so it can be proven that the config works[0m
[30;1m238 | [0m[35m    BEST_CONFIGS[key] = (best_config, best_time)[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/kernel/autotuner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m230 | [0m[35m        logging.info([0m
[30;1m231 | [0m[35m            " ".join([f"{i:4d}/{len(configs):4d}", f"{time:6.3f}", str(config)])[0m
[30;1m232 | [0m[35m        )[0m
[30;1m233 | [0m[35m        if time < best_time:[0m
[30;1m234 | [0m[35m            best_time = time[0m
[30;1m235 | [0m[35m            best_config = config[0m
[30;1m236 | [0m[35m        i += 1[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/kernel/autotuner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m226 | [0m[35m    # is maybe better to end up with a reasonable config that can be[0m
[30;1m227 | [0m[35m    # used to filter bad configs sooner.[0m
[30;1m228 | [0m[35m    for config in configs[1:]:[0m
[30;1m229 | [0m[35m        time = do_bench(fn, args, config, best_time)[0m
[30;1m230 | [0m[35m        logging.info([0m
[30;1m231 | [0m[35m            " ".join([f"{i:4d}/{len(configs):4d}", f"{time:6.3f}", str(config)])[0m
[30;1m232 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/kernel/autotuner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m    # Run it five times and skip if it is 10x slower[0m
[30;1m188 | [0m[35m    time = do_bench_basic(wrapped_fn, 5)[0m
[30;1m189 | [0m[35m    if best_time is not None and time > best_time * 10:[0m
[30;1m190 | [0m[35m        return float("inf")[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m    # Do a regular bench[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/kernel/autotuner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m185 | [0m[35m        return float("inf")[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m    # Run it five times and skip if it is 10x slower[0m
[30;1m188 | [0m[35m    time = do_bench_basic(wrapped_fn, 5)[0m
[30;1m189 | [0m[35m    if best_time is not None and time > best_time * 10:[0m
[30;1m190 | [0m[35m        return float("inf")[0m
[30;1m191 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/kernel/autotuner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m181 | [0m[35m        time = None[0m
[30;1m182 | [0m[35m    except triton.runtime.OutOfResources:[0m
[30;1m183 | [0m[35m        time = None[0m
[30;1m184 | [0m[35m    if time is None or (best_time is not None and time > best_time * 100):[0m
[30;1m185 | [0m[35m        return float("inf")[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m    # Run it five times and skip if it is 10x slower[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/kernel/autotuner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m181 | [0m[35m        time = None[0m
[30;1m182 | [0m[35m    except triton.runtime.OutOfResources:[0m
[30;1m183 | [0m[35m        time = None[0m
[30;1m184 | [0m[35m    if time is None or (best_time is not None and time > best_time * 100):[0m
[30;1m185 | [0m[35m        return float("inf")[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m    # Run it five times and skip if it is 10x slower[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/kernel/autotuner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m182 | [0m[35m    except RuntimeError:[0m
[30;1m183 | [0m[35m        time = None[0m
[30;1m184 | [0m[35m    except triton.runtime.OutOfResources:[0m
[30;1m185 | [0m[35m        time = None[0m
[30;1m186 | [0m[35m    if time is None or (best_time is not None and time > best_time * 100):[0m
[30;1m187 | [0m[35m        return float("inf")[0m
[30;1m188 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/kernel/autotuner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m178 | [0m[35m    try:[0m
[30;1m179 | [0m[35m        time = do_bench_basic(wrapped_fn, 1)[0m
[30;1m180 | [0m[35m    except RuntimeError:[0m
[30;1m181 | [0m[35m        time = None[0m
[30;1m182 | [0m[35m    except triton.runtime.OutOfResources:[0m
[30;1m183 | [0m[35m        time = None[0m
[30;1m184 | [0m[35m    if time is None or (best_time is not None and time > best_time * 100):[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/kernel/autotuner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m    # Run it once and skip if it crashes or is 100x slower[0m
[30;1m178 | [0m[35m    try:[0m
[30;1m179 | [0m[35m        time = do_bench_basic(wrapped_fn, 1)[0m
[30;1m180 | [0m[35m    except RuntimeError:[0m
[30;1m181 | [0m[35m        time = None[0m
[30;1m182 | [0m[35m    except triton.runtime.OutOfResources:[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/kernel/autotuner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m83 | [0m[35m                x.grad = None[0m
[30;1m84 | [0m[35m        # we clear the L2 cache before each run[0m
[30;1m85 | [0m[35m        cache.zero_()[0m
[30;1m86 | [0m[35m        # record time of `fn`[0m
[30;1m87 | [0m[35m        start_event[i].record()[0m
[30;1m88 | [0m[35m        fn()[0m
[30;1m89 | [0m[35m        end_event[i].record()[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/kernel/autotuner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m33 | [0m[35m    :type fn: Callable[0m
[30;1m34 | [0m[35m    :param warmup: Warmup time (in ms)[0m
[30;1m35 | [0m[35m    :type warmup: int[0m
[30;1m36 | [0m[35m    :param rep: Repetition time (in ms)[0m
[30;1m37 | [0m[35m    :type rep: int[0m
[30;1m38 | [0m[35m    :param grad_to_none: Reset the gradient of the provided tensor to None[0m
[30;1m39 | [0m[35m    :type grad_to_none: torch.tensor, optional[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/kernel/autotuner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    :param fn: Function to benchmark[0m
[30;1m33 | [0m[35m    :type fn: Callable[0m
[30;1m34 | [0m[35m    :param warmup: Warmup time (in ms)[0m
[30;1m35 | [0m[35m    :type warmup: int[0m
[30;1m36 | [0m[35m    :param rep: Repetition time (in ms)[0m
[30;1m37 | [0m[35m    :type rep: int[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m    requirement: make sure `fn.__name__[1:]` is the operator name you want to register[0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35m    NOTE: This should be applied at the top, after all other decorators have been applied[0m
[30;1m187 | [0m[35m    NOTE: We haven't tested the case when `fn` accepts tensor subclass instance as input,[0m
[30;1m188 | [0m[35m    e.g. uint4 tensor subclass instance, and we'll probably need to figure out what would make[0m
[30;1m189 | [0m[35m    sense for downstream system (like executorch) to accept as well[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35mimport functools[0m
[30;1m7 | [0m[35mimport itertools[0m
[30;1m8 | [0m[35mimport re[0m
[30;1m9 | [0m[35mimport time[0m
[30;1m10 | [0m[35mfrom functools import reduce[0m
[30;1m11 | [0m[35mfrom importlib.metadata import version[0m
[30;1m12 | [0m[35mfrom math import gcd[0m
[30;1m13 | [0m[35mfrom typing import Any, Callable, Tuple[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/superblock/benchmark.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m74 | [0m[35m            checkpoint = torch.load(args.weights_path, map_location="cpu")[0m
[30;1m75 | [0m[35m            model.load_state_dict(checkpoint["model"])[0m
[30;1m76 | [0m[35m        except FileNotFoundError:[0m
[30;1m77 | [0m[35m            raise FileNotFoundError(f"No checkpoint found at {args.weights_path}.")[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m    model.to(device).to(dtype)[0m
[30;1m80 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/superblock/benchmark.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m64 | [0m[35m        args.model, weights=args.weights, num_classes=num_classes[0m
[30;1m65 | [0m[35m    ).eval()[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m    # Fake sparsity necessary for BSR, since we find based on SuperBlock[0m
[30;1m68 | [0m[35m    sparsifier_or_none = simulate_sparsity(model, args)[0m
[30;1m69 | [0m[35m    if sparsifier_or_none is not None:[0m
[30;1m70 | [0m[35m        sparsifier_or_none.squash_mask()[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/pruner/base_structured_sparsifier.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m305 | [0m[35m                    convert_block = [][0m
[30;1m306 | [0m[35m                    for node in matched:[0m
[30;1m307 | [0m[35m                        if node.op == "call_module":[0m
[30;1m308 | [0m[35m                            convert_block.append(modules.get(node.target))[0m
[30;1m309 | [0m[35m                        elif node.op == "call_function":[0m
[30;1m310 | [0m[35m                            convert_block.append(node.target)[0m
[30;1m311 | [0m[35m                    convert_fn(*convert_block)[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/pruner/base_structured_sparsifier.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m295 | [0m[35m                if matched is None:[0m
[30;1m296 | [0m[35m                    continue[0m
[30;1m297 | [0m[35m[0m
[30;1m298 | [0m[35m                first_module = modules.get(node.target)[0m
[30;1m299 | [0m[35m                # check if first module exists and has appropriate parameterization, otherwise skip[0m
[30;1m300 | [0m[35m                if ([0m
[30;1m301 | [0m[35m                    first_module is not None[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/pruner/base_structured_sparsifier.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m263 | [0m[35m[0m
[30;1m264 | [0m[35m            # if linear / conv, we add in bias hooks[0m
[30;1m265 | [0m[35m            if isinstance(module, (nn.Linear, nn.Conv2d)):[0m
[30;1m266 | [0m[35m                prune_bias = config.get("prune_bias", True)[0m
[30;1m267 | [0m[35m                if module.bias is not None:[0m
[30;1m268 | [0m[35m                    module.register_parameter([0m
[30;1m269 | [0m[35m                        "_bias", nn.Parameter(module.bias.detach())[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/pruner/base_structured_sparsifier.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m252 | [0m[35m            parametrization = config.get("parametrization", FakeStructuredSparsity)[0m
[30;1m253 | [0m[35m            tensor = getattr(module, tensor_name)[0m
[30;1m254 | [0m[35m[0m
[30;1m255 | [0m[35m            mask = config.get([0m
[30;1m256 | [0m[35m                "mask",[0m
[30;1m257 | [0m[35m                torch.ones(tensor.shape[0], dtype=torch.bool, device=tensor.device),[0m
[30;1m258 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/pruner/base_structured_sparsifier.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m249 | [0m[35m        for config in self.groups:[0m
[30;1m250 | [0m[35m            module = config["module"][0m
[30;1m251 | [0m[35m            tensor_name = config["tensor_name"][0m
[30;1m252 | [0m[35m            parametrization = config.get("parametrization", FakeStructuredSparsity)[0m
[30;1m253 | [0m[35m            tensor = getattr(module, tensor_name)[0m
[30;1m254 | [0m[35m[0m
[30;1m255 | [0m[35m            mask = config.get([0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/pruner/base_structured_sparsifier.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m244 | [0m[35m[0m
[30;1m245 | [0m[35m    def _prepare(self, *args, **kwargs) -> None:[0m
[30;1m246 | [0m[35m        r"""This function will attach the FakeStructuredSparsity parameterizations[0m
[30;1m247 | [0m[35m        and BiasHooks at the appropriate points in the model.[0m
[30;1m248 | [0m[35m        """[0m
[30;1m249 | [0m[35m        for config in self.groups:[0m
[30;1m250 | [0m[35m            module = config["module"][0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/pruner/base_structured_sparsifier.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m303 | [0m[35m                    and module_contains_param(first_module, FakeStructuredSparsity)[0m
[30;1m304 | [0m[35m                ):[0m
[30;1m305 | [0m[35m                    convert_block = [][0m
[30;1m306 | [0m[35m                    for node in matched:[0m
[30;1m307 | [0m[35m                        if node.op == "call_module":[0m
[30;1m308 | [0m[35m                            convert_block.append(modules.get(node.target))[0m
[30;1m309 | [0m[35m                        elif node.op == "call_function":[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/pruner/base_structured_sparsifier.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m289 | [0m[35m[0m
[30;1m290 | [0m[35m        # Right now we check for matches simply by iterating across all the patterns[0m
[30;1m291 | [0m[35m        # if this is slow we can store patterns in a trie-structure and modify this code for faster [0m
[30;1m292 | [0m[35m        for node in self.traced.graph.nodes:[0m
[30;1m293 | [0m[35m            for pattern, convert_fn in self.patterns.items():[0m
[30;1m294 | [0m[35m                matched = apply_match(modules, pattern, node, [])[0m
[30;1m295 | [0m[35m                if matched is None:[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/pruner/base_structured_sparsifier.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m277 | [0m[35m[0m
[30;1m278 | [0m[35m    def prune(self) -> None:[0m
[30;1m279 | [0m[35m        r"""[0m
[30;1m280 | [0m[35m        This function will FX symbolically trace the model and then find instances of the patterns[0m
[30;1m281 | [0m[35m        defined in self.patterns (by default SUPPORTED_STRUCTURED_PRUNING_PATTERNS ).[0m
[30;1m282 | [0m[35m[0m
[30;1m283 | [0m[35m        For each pattern, it will apply to corresponding conversion function, which will modify the [0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/pruner/base_structured_sparsifier.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m117 | [0m[35m        (nn.Conv2d, "output"): prune_conv2d,[0m
[30;1m118 | [0m[35m        (nn.Conv2d, nn.Conv2d): prune_conv2d_conv2d,[0m
[30;1m119 | [0m[35m        # TODO LSTM Structured pruning does not support returned state currently.[0m
[30;1m120 | [0m[35m        # Should find a way to explicitly match getitem(0) instead of getitem.[0m
[30;1m121 | [0m[35m        # This will also require changing the pruning function.[0m
[30;1m122 | [0m[35m        # lstm -> getitem(0) -> linear[0m
[30;1m123 | [0m[35m        (nn.LSTM, getitem, nn.Linear): prune_lstm_output_linear,[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/pruner/saliency_pruner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m    This pruner works on N-Dimensional weight tensors.[0m
[30;1m14 | [0m[35m    For each row, we will calculate the saliency, whic is the sum the L1 norm of all weights in that[0m
[30;1m15 | [0m[35m    We expect that the resulting saliency vector has the same shape as our mask.[0m
[30;1m16 | [0m[35m    We then pick elements to remove until we reach the target sparsity_level.[0m
[30;1m17 | [0m[35m    """[0m
[30;1m18 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/quant_primitives.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m258 | [0m[35m        if block_size[i] != input_size[i] and block_size[i] > 1:[0m
[30;1m259 | [0m[35m            assert ([0m
[30;1m260 | [0m[35m                input_size[i] % block_size[i] == 0[0m
[30;1m261 | [0m[35m            ), f"Expecting input size at {i} dimension: {input_size[i]} to be divisible by block_siz[0m
[30;1m262 | [0m[35m            shape_for_reduction.append(input_size[i] // block_size[i])[0m
[30;1m263 | [0m[35m            shape_for_reduction.append(block_size[i])[0m
[30;1m264 | [0m[35m            # reduce over the block_size[i] dim[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/quant_primitives.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m258 | [0m[35m        if block_size[i] != input_size[i] and block_size[i] > 1:[0m
[30;1m259 | [0m[35m            assert ([0m
[30;1m260 | [0m[35m                input_size[i] % block_size[i] == 0[0m
[30;1m261 | [0m[35m            ), f"Expecting input size at {i} dimension: {input_size[i]} to be divisible by block_siz[0m
[30;1m262 | [0m[35m            shape_for_reduction.append(input_size[i] // block_size[i])[0m
[30;1m263 | [0m[35m            shape_for_reduction.append(block_size[i])[0m
[30;1m264 | [0m[35m            # reduce over the block_size[i] dim[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/quant_primitives.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m852 | [0m[35m[0m
[30;1m853 | [0m[35m    The op does the following:[0m
[30;1m854 | [0m[35m    1. figure out the dimension for reduction based on block_size[0m
[30;1m855 | [0m[35m    2. find min_val/max_val based on the dimension for reduction[0m
[30;1m856 | [0m[35m    3. calculate quantization parameters based on min_val/max_val based on args like `preserve_zero`[0m
[30;1m857 | [0m[35m       and `zero_point_domain`[0m
[30;1m858 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/quant_primitives.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m235 | [0m[35m[0m
[30;1m236 | [0m[35m[0m
[30;1m237 | [0m[35mdef _get_reduction_params(block_size, input_size):[0m
[30;1m238 | [0m[35m    """Given block_size and input size find the parameters for reduction:[0m
[30;1m239 | [0m[35m[0m
[30;1m240 | [0m[35m    Output:[0m
[30;1m241 | [0m[35m        shape_for_reduction: the shape we use to `view` input to prepare it for reduction[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/linear_activation_quantized_tensor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35mght_tensor`: the weight tensor, if weight need to be quantized as well, we'd need[0m
[30;1m32 | [0m[35m        to apply quantization to weight first, e.g. for int8 dynamic activation int8 weight quantiza[0m
[30;1m33 | [0m[35m        we will first apply int8 quantization to weight and then apply LinearActivationQuantizedTens[0m
[30;1m34 | [0m[35m        on top of it[0m
[30;1m35 | [0m[35m      `input_quant_func` (Callable[[torch.Tensor], torch.Tensor]): a function that takes a high prec[0m
[30;1m36 | [0m[35m        a quantized tensor, this is used to quantize input[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/uintx/gemlite_layout.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m123 | [0m[35m        kwargs["device"] = packed_weight.device[0m
[30;1m124 | [0m[35m        kwargs["layout"] = ([0m
[30;1m125 | [0m[35m            kwargs.get("layout")[0m
[30;1m126 | [0m[35m            if kwargs.get("layout", False)[0m
[30;1m127 | [0m[35m            else packed_weight.layout[0m
[30;1m128 | [0m[35m        )[0m
[30;1m129 | [0m[35m        kwargs["dtype"] = packed_weight.dtype[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/uintx/gemlite_layout.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m122 | [0m[35m        kwargs = {}[0m
[30;1m123 | [0m[35m        kwargs["device"] = packed_weight.device[0m
[30;1m124 | [0m[35m        kwargs["layout"] = ([0m
[30;1m125 | [0m[35m            kwargs.get("layout")[0m
[30;1m126 | [0m[35m            if kwargs.get("layout", False)[0m
[30;1m127 | [0m[35m            else packed_weight.layout[0m
[30;1m128 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/float8/float8_tensor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m355 | [0m[35m        # Lazy import to avoid circular dependency[0m
[30;1m356 | [0m[35m        from torchao.float8.float8_ops import FLOAT8_OPS_TABLE[0m
[30;1m357 | [0m[35m[0m
[30;1m358 | [0m[35m        # All ops in the FLOAT8_OPS_TABLE expect Float8Tensor as inputs[0m
[30;1m359 | [0m[35m        # And don't support mixed tensor subclasses. This will trigger the handler for[0m
[30;1m360 | [0m[35m        # the next type in the dispatch list[0m
[30;1m361 | [0m[35m        def allowed_subclasses(type):[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/uintx/marlin_qqq_tensor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m127 | [0m[35m        kwargs = {}[0m
[30;1m128 | [0m[35m        kwargs["device"] = int_data.device[0m
[30;1m129 | [0m[35m        kwargs["layout"] = ([0m
[30;1m130 | [0m[35m            kwargs.get("layout") if kwargs.get("layout", False) else int_data.layout[0m
[30;1m131 | [0m[35m        )[0m
[30;1m132 | [0m[35m        kwargs["dtype"] = int_data.dtype[0m
[30;1m133 | [0m[35m        kwargs["requires_grad"] = False[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/uintx/marlin_qqq_tensor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m127 | [0m[35m        kwargs = {}[0m
[30;1m128 | [0m[35m        kwargs["device"] = int_data.device[0m
[30;1m129 | [0m[35m        kwargs["layout"] = ([0m
[30;1m130 | [0m[35m            kwargs.get("layout") if kwargs.get("layout", False) else int_data.layout[0m
[30;1m131 | [0m[35m        )[0m
[30;1m132 | [0m[35m        kwargs["dtype"] = int_data.dtype[0m
[30;1m133 | [0m[35m        kwargs["requires_grad"] = False[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m112 | [0m[35m    "DEFAULT_SPARSE_AUTOQUANT_CLASS_LIST",[0m
[30;1m113 | [0m[35m    "OTHER_AUTOQUANT_CLASS_LIST",[0m
[30;1m114 | [0m[35m    "ALL_AUTOQUANT_CLASS_LIST",[0m
[30;1m115 | [0m[35m    # top level API - manual[0m
[30;1m116 | [0m[35m    "quantize_",[0m
[30;1m117 | [0m[35m    "int4_dynamic_activation_int4_weight",[0m
[30;1m118 | [0m[35m    "int8_dynamic_activation_int4_weight",[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m103 | [0m[35mfrom .weight_only import WeightOnlyInt8QuantLinear[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m__all__ = [[0m
[30;1m106 | [0m[35m    # top level API - auto[0m
[30;1m107 | [0m[35m    "autoquant",[0m
[30;1m108 | [0m[35m    "DEFAULT_AUTOQUANT_CLASS_LIST",[0m
[30;1m109 | [0m[35m    "DEFAULT_INT4_AUTOQUANT_CLASS_LIST",[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m62 | [0m[35mdef write_json_result_local(output_json_path, headers, row):[0m
[30;1m63 | [0m[35m    """[0m
[30;1m64 | [0m[35m    Write the result into JSON format, so that it can be uploaded to the benchmark database[0m
[30;1m65 | [0m[35m    to be displayed on OSS dashboard. The JSON format is defined at[0m
[30;1m66 | [0m[35m    https://github.com/pytorch/pytorch/wiki/How-to-integrate-with-PyTorch-OSS-benchmark-database[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m    Local version (filling in dummy values for fields that should be populated by CI)[0m
[30;1m69 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m24 | [0m[35mdef write_json_result_ossci(output_json_path, headers, row):[0m
[30;1m25 | [0m[35m    """[0m
[30;1m26 | [0m[35m    Write the result into JSON format, so that it can be uploaded to the benchmark database[0m
[30;1m27 | [0m[35m    to be displayed on OSS dashboard. The JSON format is defined at[0m
[30;1m28 | [0m[35m    https://github.com/pytorch/pytorch/wiki/How-to-integrate-with-PyTorch-OSS-benchmark-database[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m    OSS CI version, that will leave many fields to be filled in by CI[0m
[30;1m31 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35mimport json[0m
[30;1m9 | [0m[35mimport os[0m
[30;1m10 | [0m[35mimport platform[0m
[30;1m11 | [0m[35mimport time[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mimport torch[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/pruner/lstm_saliency_pruner.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m24 | [0m[35m    Pruning this tensor directly will lead to weights being misassigned when unpacked.[0m
[30;1m25 | [0m[35m    To ensure that each packed linear layer is pruned the same amount:[0m
[30;1m26 | [0m[35m        1. We split the packed weight into the 4 constituent linear parts[0m
[30;1m27 | [0m[35m        2. Update the mask for each individual piece using saliency individually[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    This applies to both weight_ih_l{k} and weight_hh_l{k}.[0m
[30;1m30 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/experimental/quant_api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m479 | [0m[35m    bit_width = kwargs.get("bit_width", None)[0m
[30;1m480 | [0m[35m    use_fallback = kwargs.get("use_fallback", None)[0m
[30;1m481 | [0m[35m    has_weight_zeros = kwargs.get("has_weight_zeros", None)[0m
[30;1m482 | [0m[35m    embedding_fqn_to_quantized_unembedding = kwargs.get([0m
[30;1m483 | [0m[35m        "embedding_fqn_to_quantized_unembedding", None[0m
[30;1m484 | [0m[35m    )[0m
[30;1m485 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/experimental/quant_api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m478 | [0m[35m    group_size = kwargs.get("group_size", None)[0m
[30;1m479 | [0m[35m    bit_width = kwargs.get("bit_width", None)[0m
[30;1m480 | [0m[35m    use_fallback = kwargs.get("use_fallback", None)[0m
[30;1m481 | [0m[35m    has_weight_zeros = kwargs.get("has_weight_zeros", None)[0m
[30;1m482 | [0m[35m    embedding_fqn_to_quantized_unembedding = kwargs.get([0m
[30;1m483 | [0m[35m        "embedding_fqn_to_quantized_unembedding", None[0m
[30;1m484 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/experimental/quant_api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m477 | [0m[35m):[0m
[30;1m478 | [0m[35m    group_size = kwargs.get("group_size", None)[0m
[30;1m479 | [0m[35m    bit_width = kwargs.get("bit_width", None)[0m
[30;1m480 | [0m[35m    use_fallback = kwargs.get("use_fallback", None)[0m
[30;1m481 | [0m[35m    has_weight_zeros = kwargs.get("has_weight_zeros", None)[0m
[30;1m482 | [0m[35m    embedding_fqn_to_quantized_unembedding = kwargs.get([0m
[30;1m483 | [0m[35m        "embedding_fqn_to_quantized_unembedding", None[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/experimental/quant_api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m476 | [0m[35m    fqn: str = "",[0m
[30;1m477 | [0m[35m):[0m
[30;1m478 | [0m[35m    group_size = kwargs.get("group_size", None)[0m
[30;1m479 | [0m[35m    bit_width = kwargs.get("bit_width", None)[0m
[30;1m480 | [0m[35m    use_fallback = kwargs.get("use_fallback", None)[0m
[30;1m481 | [0m[35m    has_weight_zeros = kwargs.get("has_weight_zeros", None)[0m
[30;1m482 | [0m[35m    embedding_fqn_to_quantized_unembedding = kwargs.get([0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/experimental/quant_api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m475 | [0m[35m    kwargs={},[0m
[30;1m476 | [0m[35m    fqn: str = "",[0m
[30;1m477 | [0m[35m):[0m
[30;1m478 | [0m[35m    group_size = kwargs.get("group_size", None)[0m
[30;1m479 | [0m[35m    bit_width = kwargs.get("bit_width", None)[0m
[30;1m480 | [0m[35m    use_fallback = kwargs.get("use_fallback", None)[0m
[30;1m481 | [0m[35m    has_weight_zeros = kwargs.get("has_weight_zeros", None)[0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/experimental/quant_api.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m34 | [0m[35m        torch.ops.torchao._pack_8bit_act_4bit_weight[0m
[30;1m35 | [0m[35m    except AttributeError:[0m
[30;1m36 | [0m[35m        raise Exception([0m
[30;1m37 | [0m[35m            "TorchAO experimental kernels are not loaded.  To install the kernels, run `USE_CPP=1 pi[0m
[30;1m38 | [0m[35m            + " You can also set target to 'aten' if you are using ARM CPU."[0m
[30;1m39 | [0m[35m        )[0m
[30;1m40 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao-0.10.0.dist-info/METADATA[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m241 | [0m[35m* [Keynote talk at GPU MODE IRL](https://youtu.be/FH5wiwOyPX4?si=VZK22hHz25GRzBG1&t=1009)[0m
[30;1m242 | [0m[35m* [Low precision dtypes at PyTorch conference](https://youtu.be/xcKwEZ77Cps?si=7BS6cXMGgYtFlnrA)[0m
[30;1m243 | [0m[35m* [Slaying OOMs at the Mastering LLM's course](https://www.youtube.com/watch?v=UvRl4ansfCg)[0m
[30;1m244 | [0m[35m* [Advanced Quantization at CUDA MODE](https://youtu.be/1u9xUK3G4VM?si=4JcPlw2w8chPXW8J)[0m
[30;1m245 | [0m[35m* [Chip Huyen's GPU Optimization Workshop](https://www.youtube.com/live/v_q2JTIqE20?si=mf7HeZ63rS-uY[0m
[30;1m246 | [0m[35m* [Cohere for AI community talk](https://www.youtube.com/watch?v=lVgrE36ZUw0)[0m
[30;1m247 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao-0.10.0.dist-info/METADATA[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m240 | [0m[35m## Videos[0m
[30;1m241 | [0m[35m* [Keynote talk at GPU MODE IRL](https://youtu.be/FH5wiwOyPX4?si=VZK22hHz25GRzBG1&t=1009)[0m
[30;1m242 | [0m[35m* [Low precision dtypes at PyTorch conference](https://youtu.be/xcKwEZ77Cps?si=7BS6cXMGgYtFlnrA)[0m
[30;1m243 | [0m[35m* [Slaying OOMs at the Mastering LLM's course](https://www.youtube.com/watch?v=UvRl4ansfCg)[0m
[30;1m244 | [0m[35m* [Advanced Quantization at CUDA MODE](https://youtu.be/1u9xUK3G4VM?si=4JcPlw2w8chPXW8J)[0m
[30;1m245 | [0m[35m* [Chip Huyen's GPU Optimization Workshop](https://www.youtube.com/live/v_q2JTIqE20?si=mf7HeZ63rS-uY[0m
[30;1m246 | [0m[35m* [Cohere for AI community talk](https://www.youtube.com/watch?v=lVgrE36ZUw0)[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao-0.10.0.dist-info/METADATA[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m239 | [0m[35m[0m
[30;1m240 | [0m[35m## Videos[0m
[30;1m241 | [0m[35m* [Keynote talk at GPU MODE IRL](https://youtu.be/FH5wiwOyPX4?si=VZK22hHz25GRzBG1&t=1009)[0m
[30;1m242 | [0m[35m* [Low precision dtypes at PyTorch conference](https://youtu.be/xcKwEZ77Cps?si=7BS6cXMGgYtFlnrA)[0m
[30;1m243 | [0m[35m* [Slaying OOMs at the Mastering LLM's course](https://www.youtube.com/watch?v=UvRl4ansfCg)[0m
[30;1m244 | [0m[35m* [Advanced Quantization at CUDA MODE](https://youtu.be/1u9xUK3G4VM?si=4JcPlw2w8chPXW8J)[0m
[30;1m245 | [0m[35m* [Chip Huyen's GPU Optimization Workshop](https://www.youtube.com/live/v_q2JTIqE20?si=mf7HeZ63rS-uY[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao-0.10.0.dist-info/METADATA[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m238 | [0m[35m6. SGLang for LLM serving: [usage](https://github.com/sgl-project/sglang/blob/4f2ee48ed1c66ee0e189da[0m
[30;1m239 | [0m[35m[0m
[30;1m240 | [0m[35m## Videos[0m
[30;1m241 | [0m[35m* [Keynote talk at GPU MODE IRL](https://youtu.be/FH5wiwOyPX4?si=VZK22hHz25GRzBG1&t=1009)[0m
[30;1m242 | [0m[35m* [Low precision dtypes at PyTorch conference](https://youtu.be/xcKwEZ77Cps?si=7BS6cXMGgYtFlnrA)[0m
[30;1m243 | [0m[35m* [Slaying OOMs at the Mastering LLM's course](https://www.youtube.com/watch?v=UvRl4ansfCg)[0m
[30;1m244 | [0m[35m* [Advanced Quantization at CUDA MODE](https://youtu.be/1u9xUK3G4VM?si=4JcPlw2w8chPXW8J)[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao-0.10.0.dist-info/METADATA[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m189 | [0m[35m2. [2:4 Sparse Marlin GEMM](https://github.com/pytorch/ao/pull/733) 2x speedups for FP16xINT4 kernel[0m
[30;1m190 | [0m[35m3. [int4 tinygemm unpacker](https://github.com/pytorch/ao/pull/415) which makes it easier to switch [0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35mIf you believe there's other CUDA kernels we should be taking a closer look at please leave a commen[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m[0m
[30;1m195 | [0m[35m## Alpha features[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao-0.10.0.dist-info/METADATA[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m186 | [0m[35mr your custom ops. We have a few examples you can follow[0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35m1. [fp6](torchao/dtypes/floatx) for 2x faster inference over fp16 with an easy to use API `quantize_[0m
[30;1m189 | [0m[35m2. [2:4 Sparse Marlin GEMM](https://github.com/pytorch/ao/pull/733) 2x speedups for FP16xINT4 kernel[0m
[30;1m190 | [0m[35m3. [int4 tinygemm unpacker](https://github.com/pytorch/ao/pull/415) which makes it easier to switch [0m
[30;1m191 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao-0.10.0.dist-info/METADATA[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m180 | [0m[35ming distributed algorithms and quantization.[0m
[30;1m181 | [0m[35m[0m
[30;1m182 | [0m[35mThe best example we have combining the composability of lower bit dtype with compile and fsdp is [NF[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m## Custom Kernels[0m
[30;1m185 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao-0.10.0.dist-info/METADATA[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m76 | [0m[35mquantize_(m, Int4WeightOnlyConfig())[0m
[30;1m77 | [0m[35m```[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35mFor gpt-fast `Int4WeightOnlyConfig()` is the best option at bs=1 as it **2x the tok/s and reduces th[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35mIf you don't have enough VRAM to quantize your entire model on GPU and you find CPU quantization to [0m
[30;1m82 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao-0.10.0.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m252 | [0m[35m[0m
[30;1m253 | [0m[35m# Citation[0m
[30;1m254 | [0m[35m[0m
[30;1m255 | [0m[35mIf you find the torchao library useful, please cite it in your work as below.[0m
[30;1m256 | [0m[35m[0m
[30;1m257 | [0m[35m```bibtex[0m
[30;1m258 | [0m[35m@software{torchao,[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao-0.10.0.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m224 | [0m[35mFor *most* developers you probably want to skip building custom C++/CUDA extensions for faster itera[0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m```Shell[0m
[30;1m227 | [0m[35mUSE_CPP=0 pip install -e .[0m
[30;1m228 | [0m[35m```[0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35m## OSS Integrations[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao-0.10.0.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m217 | [0m[35m```[0m
[30;1m218 | [0m[35m[0m
[30;1m219 | [0m[35mNightly Release[0m
[30;1m220 | [0m[35m```Shell[0m
[30;1m221 | [0m[35mpip install --pre torchao --index-url https://download.pytorch.org/whl/nightly/cu126 # full options [0m
[30;1m222 | [0m[35m```[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35mFor *most* developers you probably want to skip building custom C++/CUDA extensions for faster itera[0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao-0.10.0.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m212 | [0m[35m```[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35mStable Release from the PyTorch index[0m
[30;1m215 | [0m[35m```Shell[0m
[30;1m216 | [0m[35mpip install torchao --extra-index-url https://download.pytorch.org/whl/cu124 # full options are cpu/[0m
[30;1m217 | [0m[35m```[0m
[30;1m218 | [0m[35m[0m
[30;1m219 | [0m[35mNightly Release[0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao-0.10.0.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35mStable release from Pypi which will default to CUDA 12.4[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m```Shell[0m
[30;1m211 | [0m[35mpip install torchao[0m
[30;1m212 | [0m[35m```[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35mStable Release from the PyTorch index[0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao-0.10.0.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m190 | [0m[35mao/pull/415) which makes it easier to switch quantized backends for inference[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35mIf you believe there's other CUDA kernels we should be taking a closer look at please leave a commen[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m[0m
[30;1m195 | [0m[35m## Alpha features[0m
[30;1m196 | [0m[35m[0m
[30;1m197 | [0m[35mThings we're excited about but need more time to cook in the oven[0m
[30;1m198 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao-0.10.0.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m74 | [0m[35mghtOnlyConfig[0m
[30;1m75 | [0m[35m)[0m
[30;1m76 | [0m[35mquantize_(m, Int4WeightOnlyConfig())[0m
[30;1m77 | [0m[35m```[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35mFor gpt-fast `Int4WeightOnlyConfig()` is the best option at bs=1 as it **2x the tok/s and reduces th[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35mIf you don't have enough VRAM to quantize your entire model on GPU and you find CPU quantization to [0m
[30;1m82 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao-0.10.0.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m### Post Training Quantization[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35mQuantizing and Sparsifying your models is a 1 liner that should work on any model with an `nn.Linear[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35mFor inference, we have the option of[0m
[30;1m65 | [0m[35m1. Quantize only the weights: works best for memory bound models[0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/smoothquant/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m105 | [0m[35m        if isinstance(module, SmoothQuantObservedLinear):[0m
[30;1m106 | [0m[35m            smoothing_factor = recipe.get(name + ".smoothing_factor", None)[0m
[30;1m107 | [0m[35m            act_scales = recipe.get(name + ".act_scales", None)[0m
[30;1m108 | [0m[35m            wei_scales = recipe.get(name + ".wei_scales", None)[0m
[30;1m109 | [0m[35m            if device is not None:[0m
[30;1m110 | [0m[35m                module.to(device=device)[0m
[30;1m111 | [0m[35m            # act_scales is None for dynamic quantization[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/smoothquant/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m104 | [0m[35m    def recurse(module: torch.nn.Module, name: str = ""):[0m
[30;1m105 | [0m[35m        if isinstance(module, SmoothQuantObservedLinear):[0m
[30;1m106 | [0m[35m            smoothing_factor = recipe.get(name + ".smoothing_factor", None)[0m
[30;1m107 | [0m[35m            act_scales = recipe.get(name + ".act_scales", None)[0m
[30;1m108 | [0m[35m            wei_scales = recipe.get(name + ".wei_scales", None)[0m
[30;1m109 | [0m[35m            if device is not None:[0m
[30;1m110 | [0m[35m                module.to(device=device)[0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/smoothquant/api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m    def recurse(module: torch.nn.Module, name: str = ""):[0m
[30;1m105 | [0m[35m        if isinstance(module, SmoothQuantObservedLinear):[0m
[30;1m106 | [0m[35m            smoothing_factor = recipe.get(name + ".smoothing_factor", None)[0m
[30;1m107 | [0m[35m            act_scales = recipe.get(name + ".act_scales", None)[0m
[30;1m108 | [0m[35m            wei_scales = recipe.get(name + ".wei_scales", None)[0m
[30;1m109 | [0m[35m            if device is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/floatx/floatx_tensor_core_layout.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m649 | [0m[35m[0m
[30;1m650 | [0m[35m    # https://github.com/microsoft/DeepSpeed/blob/3a3a6db3332e339cc9fd94efd4982f6d60635a3d/deepspeed[0m
[30;1m651 | [0m[35m    bsize = act_reshaped.shape[0][0m
[30;1m652 | [0m[35m    splitK = _SPLIT_K_MAP[(bsize - 1) // 64].get(out_dim, 1) if bsize <= 768 else 1[0m
[30;1m653 | [0m[35m[0m
[30;1m654 | [0m[35m    out = quant_llm_linear([0m
[30;1m655 | [0m[35m        weight._layout.ebits,[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/floatx/floatx_tensor_core_layout.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m503 | [0m[35m        kwargs["device"] = packed_floatx_data.device[0m
[30;1m504 | [0m[35m        kwargs["layout"] = ([0m
[30;1m505 | [0m[35m            kwargs.get("layout")[0m
[30;1m506 | [0m[35m            if kwargs.get("layout", False)[0m
[30;1m507 | [0m[35m            else packed_floatx_data.layout[0m
[30;1m508 | [0m[35m        )[0m
[30;1m509 | [0m[35m        kwargs["dtype"] = packed_floatx_data.dtype[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/floatx/floatx_tensor_core_layout.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m502 | [0m[35m        kwargs = {}[0m
[30;1m503 | [0m[35m        kwargs["device"] = packed_floatx_data.device[0m
[30;1m504 | [0m[35m        kwargs["layout"] = ([0m
[30;1m505 | [0m[35m            kwargs.get("layout")[0m
[30;1m506 | [0m[35m            if kwargs.get("layout", False)[0m
[30;1m507 | [0m[35m            else packed_floatx_data.layout[0m
[30;1m508 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/floatx/floatx_tensor_core_layout.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m472 | [0m[35m    The packing is optimized for TensorCore, from the fp6-llm paper: https://arxiv.org/abs/2401.1411[0m
[30;1m473 | [0m[35m    github repo: https://github.com/usyd-fsalab/fp6_llm, now renamed to quant-llm[0m
[30;1m474 | [0m[35m[0m
[30;1m475 | [0m[35m    At a high level packing is done by grouping bits into 1 bit fragments (shards), 2 bit fragments [0m
[30;1m476 | [0m[35m    4 bit fragments each fragments are packed separately and concatenated together.[0m
[30;1m477 | [0m[35m    For example for 6 bit dtype, we can extract the first 4 bits for all elements and pack them toge[0m
[30;1m478 | [0m[35m    in a fragment, and extract the last 2 bits for all elements and pack them into fragment, in the [0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/smoothquant.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m70 | [0m[35m        self.store_w_int_repr_t = False[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m    def update_x_running_abs_max(self, X):[0m
[30;1m73 | [0m[35m        # update the running max of incoming activations[0m
[30;1m74 | [0m[35m        all_dims_except_last = tuple(range(len(X.shape) - 1))[0m
[30;1m75 | [0m[35m        cur_abs_max = torch.amax(torch.abs(X), dim=all_dims_except_last)[0m
[30;1m76 | [0m[35m        if self.x_running_abs_max is None:[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/smoothquant.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m86 | [0m[35m        W = self.weight[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m        # scale weight[0m
[30;1m89 | [0m[35m        # in the future, this can be done ahead of time instead of[0m
[30;1m90 | [0m[35m        # during inference[0m
[30;1m91 | [0m[35m        if not self.debug_skip_scaling:[0m
[30;1m92 | [0m[35m            # TODO(future): do below in `to_inference` instead of here[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/parq/quant/lsbq.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m186 | [0m[35m            boundaries = v * torch.tensor([-0.5, 0.5], device=p.device)[0m
[30;1m187 | [0m[35m            q = Q[torch.bucketize(p, boundaries)][0m
[30;1m188 | [0m[35m        else:[0m
[30;1m189 | [0m[35m            # for each row, find the element-wise index of least upper bound[0m
[30;1m190 | [0m[35m            boundaries = v * torch.tensor([[-0.5, 0.5]], device=p.device)[0m
[30;1m191 | [0m[35m            q = Q.gather(1, channel_bucketize(p, boundaries))[0m
[30;1m192 | [0m[35m        return q, Q[0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/parq/quant/lsbq.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m159 | [0m[35m            if v >= p_abs_sorted[i] and v < p_abs_sorted[i + 1]:[0m
[30;1m160 | [0m[35m                v_feasible.append(v)[0m
[30;1m161 | [0m[35m        assert len(v_feasible) > 0, "LSBQ ternary optimal: No solution found."[0m
[30;1m162 | [0m[35m        # find the best solution with least-square quantization error[0m
[30;1m163 | [0m[35m        min_error = p.norm()[0m
[30;1m164 | [0m[35m        q_best = torch.zeros_like(p)[0m
[30;1m165 | [0m[35m        v_best = torch.zeros_like(v)[0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/parq/quant/lsbq.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m147 | [0m[35m        p_abs_sorted = torch.msort(torch.flatten(p.abs()))[0m
[30;1m148 | [0m[35m        cumsum = torch.cumsum(p_abs_sorted, dim=0)[0m
[30;1m149 | [0m[35m        n = cumsum.numel()[0m
[30;1m150 | [0m[35m        # find all solutions v1 to an inclusion problem (after sorting |p|)[0m
[30;1m151 | [0m[35m        # |p|_{i} <= v < |p|_{i+1} where v = (1/2) * avg_{i+1:n-1}(|p|))[0m
[30;1m152 | [0m[35m        v_feasible = [][0m
[30;1m153 | [0m[35m        v = cumsum[-1] / n / 2[0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/parq/quant/lsbq.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m124 | [0m[35m                assert v1 >= v2, "LSBQ 2-bit optimal: v1 should >= v2."[0m
[30;1m125 | [0m[35m                V1V2.append((v1, v2))[0m
[30;1m126 | [0m[35m        assert len(V1V2) > 0, "LSBQ 2-bit optimal: No solution found."[0m
[30;1m127 | [0m[35m        # find the best solution with least-square quantization error[0m
[30;1m128 | [0m[35m        min_error = p.norm()[0m
[30;1m129 | [0m[35m        for v1v2 in V1V2:[0m
[30;1m130 | [0m[35m            r = binary_quant_residue(p, v1v2)[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/parq/quant/lsbq.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m102 | [0m[35m        p_abs_sorted = torch.msort(torch.flatten(p.abs()))[0m
[30;1m103 | [0m[35m        cumsum = torch.cumsum(p_abs_sorted, dim=0)[0m
[30;1m104 | [0m[35m        n = cumsum.numel()[0m
[30;1m105 | [0m[35m        # find all solutions v1 to an inclusion problem (after sorting |p|)[0m
[30;1m106 | [0m[35m        # |p|_{i} <= v1 < |p|_{i+1}[0m
[30;1m107 | [0m[35m        # where v1 = (1/2) * (avg_{0:i}(|p|) + avg_{i+1:n-1}(|p|))[0m
[30;1m108 | [0m[35m        V1V2 = [][0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/affine_quantized_tensor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m        kwargs = {}[0m
[30;1m92 | [0m[35m        kwargs["device"] = tensor_impl.device[0m
[30;1m93 | [0m[35m        kwargs["layout"] = ([0m
[30;1m94 | [0m[35m            kwargs.get("layout") if kwargs.get("layout", False) else tensor_impl.layout[0m
[30;1m95 | [0m[35m        )[0m
[30;1m96 | [0m[35m        kwargs["dtype"] = dtype[0m
[30;1m97 | [0m[35m        if strides is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/affine_quantized_tensor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m        kwargs = {}[0m
[30;1m92 | [0m[35m        kwargs["device"] = tensor_impl.device[0m
[30;1m93 | [0m[35m        kwargs["layout"] = ([0m
[30;1m94 | [0m[35m            kwargs.get("layout") if kwargs.get("layout", False) else tensor_impl.layout[0m
[30;1m95 | [0m[35m        )[0m
[30;1m96 | [0m[35m        kwargs["dtype"] = dtype[0m
[30;1m97 | [0m[35m        if strides is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/uintx/marlin_sparse_layout.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m140 | [0m[35m        kwargs = {}[0m
[30;1m141 | [0m[35m        kwargs["device"] = int_data.device[0m
[30;1m142 | [0m[35m        kwargs["layout"] = ([0m
[30;1m143 | [0m[35m            kwargs.get("layout") if kwargs.get("layout", False) else int_data.layout[0m
[30;1m144 | [0m[35m        )[0m
[30;1m145 | [0m[35m        kwargs["dtype"] = int_data.dtype[0m
[30;1m146 | [0m[35m        kwargs["requires_grad"] = False[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/uintx/marlin_sparse_layout.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m140 | [0m[35m        kwargs = {}[0m
[30;1m141 | [0m[35m        kwargs["device"] = int_data.device[0m
[30;1m142 | [0m[35m        kwargs["layout"] = ([0m
[30;1m143 | [0m[35m            kwargs.get("layout") if kwargs.get("layout", False) else int_data.layout[0m
[30;1m144 | [0m[35m        )[0m
[30;1m145 | [0m[35m        kwargs["dtype"] = int_data.dtype[0m
[30;1m146 | [0m[35m        kwargs["requires_grad"] = False[0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/float8/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35m    "Float8GemmConfig",[0m
[30;1m39 | [0m[35m    "Float8LinearConfig",[0m
[30;1m40 | [0m[35m    "CastConfig",[0m
[30;1m41 | [0m[35m    # top level UX[0m
[30;1m42 | [0m[35m    "convert_to_float8_training",[0m
[30;1m43 | [0m[35m    "precompute_float8_dynamic_scale_for_fsdp",[0m
[30;1m44 | [0m[35m    # note: Float8Tensor and Float8Linear are not public APIs[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/float8/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# Lets define a few top level things here[0m
[30;1m2 | [0m[35mfrom torchao.float8.config import ([0m
[30;1m3 | [0m[35m    CastConfig,[0m
[30;1m4 | [0m[35m    Float8GemmConfig,[0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/llama/model.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m60 | [0m[35m            if config in str(name).upper() or config in str(name)[0m
[30;1m61 | [0m[35m        ][0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m        # We may have two or more configs matched (e.g. "7B" and "Mistral-7B"). Find the best config[0m
[30;1m64 | [0m[35m        # take longer name (as it have more symbols matched)[0m
[30;1m65 | [0m[35m        if len(config) > 1:[0m
[30;1m66 | [0m[35m            config.sort(key=len, reverse=True)[0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/ops.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m443 | [0m[35m        s_tok: `torch.float32` activation per-token quantization scales of shape `(m, 1)`.[0m
[30;1m444 | [0m[35m        s_ch: `torch.float32` weight per-channel quantization scales of shape `(1, n)`.[0m
[30;1m445 | [0m[35m        s_group: `torch.half` weight per-group quantization scales of shape `(m / groupsize, n)`, it[0m
[30;1m446 | [0m[35m        workspace: `torch.int32` tensor with at least `n / 128 * max_par` entries that are all zero.[0m
[30;1m447 | [0m[35m        size_m: number of rows in input matrix.[0m
[30;1m448 | [0m[35m        size_n: number of columns in weight matrix.[0m
[30;1m449 | [0m[35m        size_k: number of columns in input matrix.[0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/ops.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m296 | [0m[35m        weight_marlin: weight matrix of original shape `(m, k)` in Marlin format; see `Layer.pack()`[0m
[30;1m297 | [0m[35m        meta: metadata information for 2:4 sparsity.[0m
[30;1m298 | [0m[35m        s: scales of shape `(n / groupsize / 2, m)`.[0m
[30;1m299 | [0m[35m        workspace: tensor with at least `m / 128 * max_par` entries that are all zero.[0m
[30;1m300 | [0m[35m        bits: number of bits for quantization.[0m
[30;1m301 | [0m[35m        size_m: number of rows in input matrix.[0m
[30;1m302 | [0m[35m        size_n: number of columns in weight matrix.[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/ops.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m272 | [0m[35m        scales_and_zeros.size(1) == N, lambda: "scales_and_zeros must have N at dim 1"[0m
[30;1m273 | [0m[35m    )[0m
[30;1m274 | [0m[35m    torch._check([0m
[30;1m275 | [0m[35m        scales_and_zeros.size(2) == 2, lambda: "scales_and_zeros must have 2 at dim 2"[0m
[30;1m276 | [0m[35m    )[0m
[30;1m277 | [0m[35m[0m
[30;1m278 | [0m[35m    return torch.empty((N, K), dtype=torch.bfloat16, device=packed_w.device)[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/ops.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m269 | [0m[35m        lambda: "scales_and_zeros must have K // qGroupSize at dim 0",[0m
[30;1m270 | [0m[35m    )[0m
[30;1m271 | [0m[35m    torch._check([0m
[30;1m272 | [0m[35m        scales_and_zeros.size(1) == N, lambda: "scales_and_zeros must have N at dim 1"[0m
[30;1m273 | [0m[35m    )[0m
[30;1m274 | [0m[35m    torch._check([0m
[30;1m275 | [0m[35m        scales_and_zeros.size(2) == 2, lambda: "scales_and_zeros must have 2 at dim 2"[0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/ops.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m266 | [0m[35m    )[0m
[30;1m267 | [0m[35m    torch._check([0m
[30;1m268 | [0m[35m        scales_and_zeros.size(0) == K // group_size,[0m
[30;1m269 | [0m[35m        lambda: "scales_and_zeros must have K // qGroupSize at dim 0",[0m
[30;1m270 | [0m[35m    )[0m
[30;1m271 | [0m[35m    torch._check([0m
[30;1m272 | [0m[35m        scales_and_zeros.size(1) == N, lambda: "scales_and_zeros must have N at dim 1"[0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/ops.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m246 | [0m[35m    torch._check(packed_w.size(2) == 32, lambda: "packed weight must have 32 at dim 2")[0m
[30;1m247 | [0m[35m    torch._check([0m
[30;1m248 | [0m[35m        packed_w.size(3) == inner_k_tiles / 2,[0m
[30;1m249 | [0m[35m        lambda: "packed weight must have inner_k_tiles/2 at dim 3",[0m
[30;1m250 | [0m[35m    )[0m
[30;1m251 | [0m[35m    N = packed_w.size(0) * 8[0m
[30;1m252 | [0m[35m    K = packed_w.size(1) * inner_k_tiles * 16[0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/ops.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m243 | [0m[35m        inner_k_tiles == 2 or inner_k_tiles == 4 or inner_k_tiles == 8,[0m
[30;1m244 | [0m[35m        lambda: "inner_k_tiles must be 2, 4, or 8",[0m
[30;1m245 | [0m[35m    )[0m
[30;1m246 | [0m[35m    torch._check(packed_w.size(2) == 32, lambda: "packed weight must have 32 at dim 2")[0m
[30;1m247 | [0m[35m    torch._check([0m
[30;1m248 | [0m[35m        packed_w.size(3) == inner_k_tiles / 2,[0m
[30;1m249 | [0m[35m        lambda: "packed weight must have inner_k_tiles/2 at dim 3",[0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/ops.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m189 | [0m[35m    torch._check(packed_w.size(2) == 32, lambda: "packed weight must have 32 at dim 2")[0m
[30;1m190 | [0m[35m    torch._check([0m
[30;1m191 | [0m[35m        packed_w.size(3) == inner_k_tiles / 2,[0m
[30;1m192 | [0m[35m        lambda: "packed weight must have inner_k_tiles/2 at dim 3",[0m
[30;1m193 | [0m[35m    )[0m
[30;1m194 | [0m[35m    N = packed_w.size(0) * 8[0m
[30;1m195 | [0m[35m    K = packed_w.size(1) * inner_k_tiles * 16[0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/ops.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m186 | [0m[35m        inner_k_tiles == 2 or inner_k_tiles == 4 or inner_k_tiles == 8,[0m
[30;1m187 | [0m[35m        lambda: "inner_k_tiles must be 2, 4, or 8",[0m
[30;1m188 | [0m[35m    )[0m
[30;1m189 | [0m[35m    torch._check(packed_w.size(2) == 32, lambda: "packed weight must have 32 at dim 2")[0m
[30;1m190 | [0m[35m    torch._check([0m
[30;1m191 | [0m[35m        packed_w.size(3) == inner_k_tiles / 2,[0m
[30;1m192 | [0m[35m        lambda: "packed weight must have inner_k_tiles/2 at dim 3",[0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/ops.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m144 | [0m[35m        lambda: f"scale must be FP16 or BF16, got {_scales.dtype}",[0m
[30;1m145 | [0m[35m    )[0m
[30;1m146 | [0m[35m[0m
[30;1m147 | [0m[35m    BS, IC = _in_feats.shape[0m
[30;1m148 | [0m[35m    OC, _ = _weights.shape[0m
[30;1m149 | [0m[35m    N_BITS = 1 + EXPONENT + MANTISSA[0m
[30;1m150 | [0m[35m    torch._check(IC // 8 * N_BITS == _weights.shape[1], lambda: "Dimensions mismatched")[0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/uintx/uint4_layout.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m79 | [0m[35m    @staticmethod[0m
[30;1m80 | [0m[35m    def __new__(cls, elem, **kwargs):[0m
[30;1m81 | [0m[35m        assert elem.dtype is torch.uint8[0m
[30;1m82 | [0m[35m        assert not kwargs.get("requires_grad", False)[0m
[30;1m83 | [0m[35m        kwargs["requires_grad"] = False[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m        return torch.Tensor._make_wrapper_subclass([0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/uintx/tensor_core_tiled_layout.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m201 | [0m[35m        kwargs["device"] = packed_weight.device[0m
[30;1m202 | [0m[35m        kwargs["layout"] = ([0m
[30;1m203 | [0m[35m            kwargs.get("layout")[0m
[30;1m204 | [0m[35m            if kwargs.get("layout", False)[0m
[30;1m205 | [0m[35m            else packed_weight.layout[0m
[30;1m206 | [0m[35m        )[0m
[30;1m207 | [0m[35m        kwargs["dtype"] = packed_weight.dtype[0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/uintx/tensor_core_tiled_layout.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m200 | [0m[35m        kwargs = {}[0m
[30;1m201 | [0m[35m        kwargs["device"] = packed_weight.device[0m
[30;1m202 | [0m[35m        kwargs["layout"] = ([0m
[30;1m203 | [0m[35m            kwargs.get("layout")[0m
[30;1m204 | [0m[35m            if kwargs.get("layout", False)[0m
[30;1m205 | [0m[35m            else packed_weight.layout[0m
[30;1m206 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/codebook/codebook_quantized_tensor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m        kwargs = {}[0m
[30;1m56 | [0m[35m        kwargs["device"] = codes.device[0m
[30;1m57 | [0m[35m        kwargs["layout"] = ([0m
[30;1m58 | [0m[35m            kwargs.get("layout") if kwargs.get("layout", False) else codes.layout[0m
[30;1m59 | [0m[35m        )[0m
[30;1m60 | [0m[35m        kwargs["dtype"] = dtype[0m
[30;1m61 | [0m[35m        if strides is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/codebook/codebook_quantized_tensor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m        kwargs = {}[0m
[30;1m56 | [0m[35m        kwargs["device"] = codes.device[0m
[30;1m57 | [0m[35m        kwargs["layout"] = ([0m
[30;1m58 | [0m[35m            kwargs.get("layout") if kwargs.get("layout", False) else codes.layout[0m
[30;1m59 | [0m[35m        )[0m
[30;1m60 | [0m[35m        kwargs["dtype"] = dtype[0m
[30;1m61 | [0m[35m        if strides is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/codebook/codebook_quantized_tensor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m284 | [0m[35m[0m
[30;1m285 | [0m[35m    Args:[0m
[30;1m286 | [0m[35m        dtype: torch.uint1 to torch.uint8, torch.int32 supported.[0m
[30;1m287 | [0m[35m        block_size: Tuple of (out_features, in_features) to control quantization granularity.[0m
[30;1m288 | [0m[35m        scale_block_size (int): The size of the blocks that share a scale[0m
[30;1m289 | [0m[35m    Returns:[0m
[30;1m290 | [0m[35m        Callable for quantization transformation.[0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/codebook/codebook_quantized_tensor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m147 | [0m[35m            input_tensor (torch.Tensor): The input floating-point tensor to quantize.[0m
[30;1m148 | [0m[35m            block_size (Tuple[int, ...]): The size of the blocks for which codes are assigned.[0m
[30;1m149 | [0m[35m            code_dtype (torch.dtype): The dtype of the codes.[0m
[30;1m150 | [0m[35m            chunk_size (int): The chunk size to use during quantization (to control memory usage).[0m
[30;1m151 | [0m[35m        """[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m        codebook, scales = choose_qparams_codebook([0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/autoquant_v2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1178 | [0m[35m    kwargs["qtensor_class_list"] = kwargs.get([0m
[30;1m1179 | [0m[35m        "qtensor_class_list", DEFAULT_AUTOQUANT_CLASS_LIST[0m
[30;1m1180 | [0m[35m    )[0m
[30;1m1181 | [0m[35m    kwargs["mode"] = kwargs.get("mode", ["relu", None])[0m
[30;1m1182 | [0m[35m    kwargs["model"] = model[0m
[30;1m1183 | [0m[35m    kwargs["example_inputs"] = example_input[0m
[30;1m1184 | [0m[35m    kwargs["fqn_to_submodule"] = fqn_to_submodule[0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/autoquant_v2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1175 | [0m[35m    _ = kwargs.pop([0m
[30;1m1176 | [0m[35m        "error_on_unseen", True[0m
[30;1m1177 | [0m[35m    )  # same kwargs used for this and to_quantized[0m
[30;1m1178 | [0m[35m    kwargs["qtensor_class_list"] = kwargs.get([0m
[30;1m1179 | [0m[35m        "qtensor_class_list", DEFAULT_AUTOQUANT_CLASS_LIST[0m
[30;1m1180 | [0m[35m    )[0m
[30;1m1181 | [0m[35m    kwargs["mode"] = kwargs.get("mode", ["relu", None])[0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/autoquant_v2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m245 | [0m[35m            None if bias is None else bias.shape,[0m
[30;1m246 | [0m[35m        )[0m
[30;1m247 | [0m[35m        shapes_and_dtype = logged_shapes + (logged_dtype,)[0m
[30;1m248 | [0m[35m        w_autoquant.logged_data[shapes_and_dtype] = 1 + w_autoquant.logged_data.get([0m
[30;1m249 | [0m[35m            shapes_and_dtype, 0[0m
[30;1m250 | [0m[35m        )[0m
[30;1m251 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/autoquant_v2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m200 | [0m[35m            kwargs.get("layout") if kwargs.get("layout", False) else weight.layout[0m
[30;1m201 | [0m[35m        )[0m
[30;1m202 | [0m[35m        kwargs["dtype"] = ([0m
[30;1m203 | [0m[35m            kwargs.get("dtype") if kwargs.get("dtype", False) else weight.dtype[0m
[30;1m204 | [0m[35m        )[0m
[30;1m205 | [0m[35m        kwargs["requires_grad"] = False[0m
[30;1m206 | [0m[35m        shape = kwargs.pop("shape", weight.shape)[0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/autoquant_v2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m200 | [0m[35m            kwargs.get("layout") if kwargs.get("layout", False) else weight.layout[0m
[30;1m201 | [0m[35m        )[0m
[30;1m202 | [0m[35m        kwargs["dtype"] = ([0m
[30;1m203 | [0m[35m            kwargs.get("dtype") if kwargs.get("dtype", False) else weight.dtype[0m
[30;1m204 | [0m[35m        )[0m
[30;1m205 | [0m[35m        kwargs["requires_grad"] = False[0m
[30;1m206 | [0m[35m        shape = kwargs.pop("shape", weight.shape)[0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/autoquant_v2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m197 | [0m[35m    ):[0m
[30;1m198 | [0m[35m        kwargs["device"] = weight.device[0m
[30;1m199 | [0m[35m        kwargs["layout"] = ([0m
[30;1m200 | [0m[35m            kwargs.get("layout") if kwargs.get("layout", False) else weight.layout[0m
[30;1m201 | [0m[35m        )[0m
[30;1m202 | [0m[35m        kwargs["dtype"] = ([0m
[30;1m203 | [0m[35m            kwargs.get("dtype") if kwargs.get("dtype", False) else weight.dtype[0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/autoquant_v2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m197 | [0m[35m    ):[0m
[30;1m198 | [0m[35m        kwargs["device"] = weight.device[0m
[30;1m199 | [0m[35m        kwargs["layout"] = ([0m
[30;1m200 | [0m[35m            kwargs.get("layout") if kwargs.get("layout", False) else weight.layout[0m
[30;1m201 | [0m[35m        )[0m
[30;1m202 | [0m[35m        kwargs["dtype"] = ([0m
[30;1m203 | [0m[35m            kwargs.get("dtype") if kwargs.get("dtype", False) else weight.dtype[0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/autoquant_v2.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35mAUTOQUANT_CACHE = {}[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m# This is a flag to control whether we do some rewrite for graph[0m
[30;1m116 | [0m[35m# to account for different batch sizes, it's a temporary solution for llama model[0m
[30;1m117 | [0m[35m# we'll need to think about how to support this more generally[0m
[30;1m118 | [0m[35mLLAMA = True[0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/autoquant_v2.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1346 | [0m[35m        os.path.join(target_folder, "summary_0.csv")[0m
[30;1m1347 | [0m[35m    ), "No debug log saved, autoquant_v2 can't work for this model right now"[0m
[30;1m1348 | [0m[35m[0m
[30;1m1349 | [0m[35m    # first, find how many torch.compile'd regions we have[0m
[30;1m1350 | [0m[35m    extraction_idxs = [][0m
[30;1m1351 | [0m[35m    for f in os.listdir(target_folder):[0m
[30;1m1352 | [0m[35m        match = re.match(r"summary_([0-9]+).csv", f)[0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/autoquant_v2.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m663 | [0m[35m        if res_matmul >= best_time:[0m
[30;1m664 | [0m[35m            return res_matmul[0m
[30;1m665 | [0m[35m[0m
[30;1m666 | [0m[35m        # calculate what time full op needs to beat for dynamic quant to be best given INTERPOLATION[0m
[30;1m667 | [0m[35m        to_beat = best_time + INTERPOLATION_CONSTANT / (1 - INTERPOLATION_CONSTANT) * ([0m
[30;1m668 | [0m[35m            best_time - res_matmul[0m
[30;1m669 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/autoquant_v2.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m630 | [0m[35m                                   (e.g., "relu"), and the second element is the mode value (e.g., N[0m
[30;1m631 | [0m[35m[0m
[30;1m632 | [0m[35m        Returns:[0m
[30;1m633 | [0m[35m            float: The benchmarked time for the autoquantization process.[0m
[30;1m634 | [0m[35m        """[0m
[30;1m635 | [0m[35m        if not _is_interpolate_mode(mode):[0m
[30;1m636 | [0m[35m            return super()._autoquant_test(act_mat, weight, bias, best_time, mode)[0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/autoquant_v2.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m625 | [0m[35m            act_mat (torch.Tensor): The activation matrix.[0m
[30;1m626 | [0m[35m            weight (torch.Tensor): The weight tensor.[0m
[30;1m627 | [0m[35m            bias (torch.Tensor or None): The bias tensor.[0m
[30;1m628 | [0m[35m            best_time (float): The best time to beat for the quantization process.[0m
[30;1m629 | [0m[35m            mode (list, optional): A list containing mode settings for quantization. The first eleme[0m
[30;1m630 | [0m[35m                                   (e.g., "relu"), and the second element is the mode value (e.g., N[0m
[30;1m631 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/autoquant_v2.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m528 | [0m[35m                                (e.g., "relu"), and the second element is the mode value (e.g., None[0m
[30;1m529 | [0m[35m[0m
[30;1m530 | [0m[35m    Returns:[0m
[30;1m531 | [0m[35m        float: The benchmarked time for the autoquantization process.[0m
[30;1m532 | [0m[35m    """[0m
[30;1m533 | [0m[35m[0m
[30;1m534 | [0m[35m    @classmethod[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/autoquant_v2.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m523 | [0m[35m        act_mat (torch.Tensor): The activation matrix.[0m
[30;1m524 | [0m[35m        weight (torch.Tensor): The weight tensor.[0m
[30;1m525 | [0m[35m        bias (torch.Tensor or None): The bias tensor.[0m
[30;1m526 | [0m[35m        best_time (float): The best time to beat for the quantization process.[0m
[30;1m527 | [0m[35m        mode (list, optional): A list containing mode settings for quantization. The first element i[0m
[30;1m528 | [0m[35m                                (e.g., "relu"), and the second element is the mode value (e.g., None[0m
[30;1m529 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/autoquant_v2.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m360 | [0m[35m            if total_seen != 0:[0m
[30;1m361 | [0m[35m                cur_time = cur_time / total_seen[0m
[30;1m362 | [0m[35m[0m
[30;1m363 | [0m[35m                # print aggregated time if there were multiple shapes to aggregate and some new benc[0m
[30;1m364 | [0m[35m                if shape_count is not None and shape_count > 1 and ran_new_benchmarks:[0m
[30;1m365 | [0m[35m                    print([0m
[30;1m366 | [0m[35m                        f">time (all shapes): {cur_time:0.4f}ms for {q_cls}, prev_best: {best_time:0[0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/GPTQ.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m995 | [0m[35m        scales_precision: torch.dtype = torch.float32,[0m
[30;1m996 | [0m[35m    ) -> None:[0m
[30;1m997 | [0m[35m        super().__init__()[0m
[30;1m998 | [0m[35m        # always pad if needed since it becomes a noop at runtime if not needed[0m
[30;1m999 | [0m[35m        # self.origin_in_features = in_features[0m
[30;1m1000 | [0m[35m        assert ([0m
[30;1m1001 | [0m[35m            in_features % groupsize == 0[0m

[31m--[ [0m[34mMatch #[0m[33m232[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/GPTQ.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m168 | [0m[35m[0m
[30;1m169 | [0m[35m        # flatten args and kwargs together[0m
[30;1m170 | [0m[35m        flat_args, spec = tree_flatten((args, kwargs))[0m
[30;1m171 | [0m[35m        # move all single tensors to cuda, will move _MultiInputs to cuda one at a time[0m
[30;1m172 | [0m[35m        flat_args = tensors_to_cuda(flat_args)[0m
[30;1m173 | [0m[35m[0m
[30;1m174 | [0m[35m        has_multi_input = _MultiInput in [type(x) for x in flat_args][0m

[31m--[ [0m[34mMatch #[0m[33m233[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/GPTQ.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m        #  `combine_qparams_list_func`.[0m
[30;1m124 | [0m[35m        self.combine_qparams_list_func = combine_qparams_list_func[0m
[30;1m125 | [0m[35m        # accepts [`list` of qparams] from quantizing one group at a time,[0m
[30;1m126 | [0m[35m        # outputs a qparams object that could be passed into quant/dequantize_func[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m        self.skip_layer_func = skip_layer_func  # accepts [weight tensor], outputs a bool on whether[0m

[31m--[ [0m[34mMatch #[0m[33m234[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/GPTQ.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m57 | [0m[35m    This is a generic GPTQ runner that takes an existing model and applies GPTQ.[0m
[30;1m58 | [0m[35m    It uses torch._dynamo.export to obtain a graph of the model and then hooks[0m
[30;1m59 | [0m[35m    into function calls and when it detects a linear, it applies GPTQ to the weight[0m
[30;1m60 | [0m[35m    given the calibration of inputs passed in at initialization. It puts the results[0m
[30;1m61 | [0m[35m    into the state_dict so that the quantized model weights/qparams can be loaded[0m
[30;1m62 | [0m[35m    directly into the model.[0m
[30;1m63 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m235[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/GPTQ.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m168 | [0m[35m[0m
[30;1m169 | [0m[35m        # flatten args and kwargs together[0m
[30;1m170 | [0m[35m        flat_args, spec = tree_flatten((args, kwargs))[0m
[30;1m171 | [0m[35m        # move all single tensors to cuda, will move _MultiInputs to cuda one at a time[0m
[30;1m172 | [0m[35m        flat_args = tensors_to_cuda(flat_args)[0m
[30;1m173 | [0m[35m[0m
[30;1m174 | [0m[35m        has_multi_input = _MultiInput in [type(x) for x in flat_args][0m
[30;1m175 | [0m[35m        if has_multi_input:[0m

[31m--[ [0m[34mMatch #[0m[33m236[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/sam2_image_predictor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m475 | [0m[35m            box_labels = torch.tensor([[2, 3]], dtype=torch.int, device=boxes.device)[0m
[30;1m476 | [0m[35m            box_labels = box_labels.repeat(boxes.size(0), 1)[0m
[30;1m477 | [0m[35m            # we merge "boxes" and "points" into a single "concat_points" input (where[0m
[30;1m478 | [0m[35m            # boxes are added at the beginning) to sam_prompt_encoder[0m
[30;1m479 | [0m[35m            if concat_points is not None:[0m
[30;1m480 | [0m[35m                concat_coords = torch.cat([box_coords, concat_points[0]], dim=1)[0m
[30;1m481 | [0m[35m                concat_labels = torch.cat([box_labels, concat_points[1]], dim=1)[0m

[31m--[ [0m[34mMatch #[0m[33m237[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/sam2_image_predictor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m32 | [0m[35m        Arguments:[0m
[30;1m33 | [0m[35m          sam_model (Sam-2): The model to use for mask prediction.[0m
[30;1m34 | [0m[35m          mask_threshold (float): The threshold to use when converting mask logits[0m
[30;1m35 | [0m[35m            to binary masks. Masks are thresholded at 0 by default.[0m
[30;1m36 | [0m[35m          max_hole_area (int): If max_hole_area > 0, we fill small holes in up to[0m
[30;1m37 | [0m[35m            the maximum area of max_hole_area in low_res_masks.[0m
[30;1m38 | [0m[35m          max_sprinkle_area (int): If max_sprinkle_area > 0, we remove small sprinkles up to[0m

[31m--[ [0m[34mMatch #[0m[33m238[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/sparsity/blocksparse.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m189 | [0m[35m            blocksize=blocksize,[0m
[30;1m190 | [0m[35m            bsr_crow_indices=inner_tensors.get("bsr_crow_indices", None),[0m
[30;1m191 | [0m[35m            bsr_col_indices=inner_tensors.get("bsr_col_indices", None),[0m
[30;1m192 | [0m[35m            bsr_values=inner_tensors.get("bsr_values", None),[0m
[30;1m193 | [0m[35m            requires_grad=requires_grad,[0m
[30;1m194 | [0m[35m        )[0m
[30;1m195 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m239[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/sparsity/blocksparse.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m188 | [0m[35m            shape=shape,[0m
[30;1m189 | [0m[35m            blocksize=blocksize,[0m
[30;1m190 | [0m[35m            bsr_crow_indices=inner_tensors.get("bsr_crow_indices", None),[0m
[30;1m191 | [0m[35m            bsr_col_indices=inner_tensors.get("bsr_col_indices", None),[0m
[30;1m192 | [0m[35m            bsr_values=inner_tensors.get("bsr_values", None),[0m
[30;1m193 | [0m[35m            requires_grad=requires_grad,[0m
[30;1m194 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m240[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/sparsity/blocksparse.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m187 | [0m[35m        return cls([0m
[30;1m188 | [0m[35m            shape=shape,[0m
[30;1m189 | [0m[35m            blocksize=blocksize,[0m
[30;1m190 | [0m[35m            bsr_crow_indices=inner_tensors.get("bsr_crow_indices", None),[0m
[30;1m191 | [0m[35m            bsr_col_indices=inner_tensors.get("bsr_col_indices", None),[0m
[30;1m192 | [0m[35m            bsr_values=inner_tensors.get("bsr_values", None),[0m
[30;1m193 | [0m[35m            requires_grad=requires_grad,[0m

[31m--[ [0m[34mMatch #[0m[33m241[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/GPTQ_MT.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m550 | [0m[35m        self.id_to_name = {id(v): k for k, v in model.named_parameters()}[0m
[30;1m551 | [0m[35m[0m
[30;1m552 | [0m[35m    def get_name_for_param(self, param):[0m
[30;1m553 | [0m[35m        return self.id_to_name.get(id(param), None)[0m
[30;1m554 | [0m[35m[0m
[30;1m555 | [0m[35m    def update_param(self, name, new_value):[0m
[30;1m556 | [0m[35m        if name in self.state_dict:[0m

[31m--[ [0m[34mMatch #[0m[33m242[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/GPTQ_MT.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m    ) -> "MultiTensor":[0m
[30;1m55 | [0m[35m        if isinstance(input, (list, tuple)):[0m
[30;1m56 | [0m[35m            input = input[0][0m
[30;1m57 | [0m[35m        kwargs["dtype"] = kwargs.get("dtype", input.dtype)[0m
[30;1m58 | [0m[35m        shape = kwargs.pop("shape", input.shape)[0m
[30;1m59 | [0m[35m        return torch.Tensor._make_wrapper_subclass(cls, shape, **kwargs)[0m
[30;1m60 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m243[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/GPTQ_MT.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m700 | [0m[35m            quant_max = 15[0m
[30;1m701 | [0m[35m            zero_point_domain = ZeroPointDomain.FLOAT[0m
[30;1m702 | [0m[35m            _layout = TensorCoreTiledLayout(inner_k_tiles=8)[0m
[30;1m703 | [0m[35m            # at least the big up to here should be a util[0m
[30;1m704 | [0m[35m[0m
[30;1m705 | [0m[35m            quantized_tensor = to_affine_quantized_intx_static([0m
[30;1m706 | [0m[35m                weight,[0m

[31m--[ [0m[34mMatch #[0m[33m244[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/GPTQ_MT.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m692 | [0m[35m            scale = qparams[0][0m
[30;1m693 | [0m[35m            zero_point = qparams[1][0m
[30;1m694 | [0m[35m[0m
[30;1m695 | [0m[35m            # copied from quant_api apply_int4_weight_only_quant (this should probably be made into [0m
[30;1m696 | [0m[35m            # mapping_type = MappingType.ASYMMETRIC[0m
[30;1m697 | [0m[35m            block_size = (1, group_size)[0m
[30;1m698 | [0m[35m            target_dtype = torch.int32[0m

[31m--[ [0m[34mMatch #[0m[33m245[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/GPTQ_MT.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m230 | [0m[35my those values back a1.copy_(a1_cuda).[0m
[30;1m231 | [0m[35m        # There's not really a great way to resolve the 2 issues, when there's an in place op you ha[0m
[30;1m232 | [0m[35m        # there's not an in place op you can throw all singular tensors onto cuda at the start and g[0m
[30;1m233 | [0m[35m        # This brings up the final issue, how do we know if we have an in place op? In general we do[0m

[31m--[ [0m[34mMatch #[0m[33m246[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/GPTQ_MT.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m226 | [0m[35m. Additionally the originals are often[0m
[30;1m227 | [0m[35m        # singular MultiTensors i.e. MultiTensor(a) that only has a single value, we don't want each[0m
[30;1m228 | [0m[35m        # we can modify MultiTensor(a) -> MultiTensor(a1, a2, ...) at the start so that each change [0m

[31m--[ [0m[34mMatch #[0m[33m247[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/GPTQ_MT.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m217 | [0m[35mnput1, input2)) the output for the[0m
[30;1m218 | [0m[35m        # second case should be MultiTensor(out1, out2) and all the activations along the way should[0m
[30;1m219 | [0m[35m        # running the func for each set of inputs and then combine the outputs back into MultiTensor[0m
[30;1m220 | [0m[35m        # normally want to execute the function on cuda, we can move them over to cuda before we eva[0m
[30;1m221 | [0m[35m        # this scheme works pretty well but has a few issues[0m

[31m--[ [0m[34mMatch #[0m[33m248[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/sparsity/wanda.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m100 | [0m[35m        block_size = pruning_metric.numel()[0m
[30;1m101 | [0m[35m        num_specified = int(block_size * sparsity_level)[0m
[30;1m102 | [0m[35m        # if set to use semi-structured, ignore sparsity_level[0m
[30;1m103 | [0m[35m        if kwargs.get("semi_structured_block_size", None) is not None:[0m
[30;1m104 | [0m[35m            block_size = kwargs["semi_structured_block_size"][0m
[30;1m105 | [0m[35m            num_specified = block_size // 2[0m
[30;1m106 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m249[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/sparsity/wanda.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m            )  # type: ignore[assignment][0m
[30;1m60 | [0m[35m        else:[0m
[30;1m61 | [0m[35m            for module_config in config:[0m
[30;1m62 | [0m[35m                tensor_fqn = module_config.get("tensor_fqn", None)[0m
[30;1m63 | [0m[35m                if tensor_fqn is None:[0m
[30;1m64 | [0m[35m                    raise ValueError("Each config must contain a 'tensor_fqn'.")[0m
[30;1m65 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m250[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/sparsity/wanda.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m108 | [0m[35m        pruning_inds = pruning_metric.view(-1, block_size).argsort(dim=1)[[0m
[30;1m109 | [0m[35m            :, :num_specified[0m
[30;1m110 | [0m[35m        ][0m
[30;1m111 | [0m[35m        # update mask[0m
[30;1m112 | [0m[35m        mask.data.view(-1, block_size).scatter_([0m
[30;1m113 | [0m[35m            1, pruning_inds, torch.zeros_like(pruning_inds, dtype=mask.dtype)[0m
[30;1m114 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m251[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/sparsifier/weight_norm_sparsifier.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m31 | [0m[35m    This sparsifier is controlled by three variables:[0m
[30;1m32 | [0m[35m    1. `sparsity_level` defines the number of *sparse blocks* that are zeroed-out[0m
[30;1m33 | [0m[35m    2. `sparse_block_shape` defines the shape of the sparse blocks. Note that[0m
[30;1m34 | [0m[35m        the sparse blocks originate at the zero-index of the tensor.[0m
[30;1m35 | [0m[35m    3. `zeros_per_block` is the number of zeros that we are expecting in each[0m
[30;1m36 | [0m[35m        sparse block. By default we assume that all elements within a block are[0m
[30;1m37 | [0m[35m        zeroed-out. However, setting this variable sets the target number of[0m

[31m--[ [0m[34mMatch #[0m[33m252[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/sparsity/marlin/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m285 | [0m[35m    # In case there are less than two True values, than False value or[0m
[30;1m286 | [0m[35m    # values at some index or indices are considered True for the[0m
[30;1m287 | [0m[35m    # encoding.  In case there are more than two True values, then the[0m
[30;1m288 | [0m[35m    # excess True value(s) at some indices are considered False for[0m
[30;1m289 | [0m[35m    # the encoding.  The exact encodings used for these cases are as[0m
[30;1m290 | [0m[35m    # follows:[0m
[30;1m291 | [0m[35m    #     [False, False, False, False] -> 0b1110[0m

[31m--[ [0m[34mMatch #[0m[33m253[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/sparsity/marlin/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m283 | [0m[35m    # at the lowest index in the quadruple, and the higher two bits in[0m
[30;1m284 | [0m[35m    # the encoding are index of the other True value in the quadruple.[0m
[30;1m285 | [0m[35m    # In case there are less than two True values, than False value or[0m
[30;1m286 | [0m[35m    # values at some index or indices are considered True for the[0m
[30;1m287 | [0m[35m    # encoding.  In case there are more than two True values, then the[0m
[30;1m288 | [0m[35m    # excess True value(s) at some indices are considered False for[0m
[30;1m289 | [0m[35m    # the encoding.  The exact encodings used for these cases are as[0m

[31m--[ [0m[34mMatch #[0m[33m254[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/sparsity/marlin/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m280 | [0m[35m    #     [False, True,  False, True ] -> 0b1101[0m
[30;1m281 | [0m[35m    #     [False, False, True,  True ] -> 0b1110[0m
[30;1m282 | [0m[35m    # Thus, lower two bits in the encoding are index of the True value[0m
[30;1m283 | [0m[35m    # at the lowest index in the quadruple, and the higher two bits in[0m
[30;1m284 | [0m[35m    # the encoding are index of the other True value in the quadruple.[0m
[30;1m285 | [0m[35m    # In case there are less than two True values, than False value or[0m
[30;1m286 | [0m[35m    # values at some index or indices are considered True for the[0m

[31m--[ [0m[34mMatch #[0m[33m255[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/sparsity/marlin/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m184 | [0m[35m# This is PyTorch implementation of main part of reorder_meta()[0m
[30;1m185 | [0m[35m# function, from tools/util/include/cutlass/util/host_reorder.h file[0m
[30;1m186 | [0m[35m# of CUTLASS source tree.  Furthermore, CUTLASS template for sparse[0m
[30;1m187 | [0m[35m# GEMM decides upon layout of this matrix, and at the moment for the[0m
[30;1m188 | [0m[35m# sparse GEMM executed on tensor cores, this is layout described by[0m
[30;1m189 | [0m[35m# ColumnMajorInterleaved<2> data structure, in[0m
[30;1m190 | [0m[35m# include/cutlass/layout/matrix.h of CUTLASS source tree.  The[0m

[31m--[ [0m[34mMatch #[0m[33m256[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/optim/subclass_4bit.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m149 | [0m[35m@OptimState4bit.implements(aten._to_copy.default)[0m
[30;1m150 | [0m[35mdef _(func, types, args, kwargs):[0m
[30;1m151 | [0m[35m    # ignore dtype[0m
[30;1m152 | [0m[35m    device = kwargs.get("device", None)[0m
[30;1m153 | [0m[35m    out = OptimState4bit([0m
[30;1m154 | [0m[35m        args[0].codes.to(device=device),[0m
[30;1m155 | [0m[35m        args[0].scale.to(device=device),[0m

[31m--[ [0m[34mMatch #[0m[33m257[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/uintx/cutlass_int4_packed_layout.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m        kwargs = {}[0m
[30;1m68 | [0m[35m        kwargs["device"] = int_data.device[0m
[30;1m69 | [0m[35m        kwargs["layout"] = ([0m
[30;1m70 | [0m[35m            kwargs.get("layout") if kwargs.get("layout", False) else int_data.layout[0m
[30;1m71 | [0m[35m        )[0m
[30;1m72 | [0m[35m        kwargs["dtype"] = int_data.dtype[0m
[30;1m73 | [0m[35m        kwargs["requires_grad"] = False[0m

[31m--[ [0m[34mMatch #[0m[33m258[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/uintx/cutlass_int4_packed_layout.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m        kwargs = {}[0m
[30;1m68 | [0m[35m        kwargs["device"] = int_data.device[0m
[30;1m69 | [0m[35m        kwargs["layout"] = ([0m
[30;1m70 | [0m[35m            kwargs.get("layout") if kwargs.get("layout", False) else int_data.layout[0m
[30;1m71 | [0m[35m        )[0m
[30;1m72 | [0m[35m        kwargs["dtype"] = int_data.dtype[0m
[30;1m73 | [0m[35m        kwargs["requires_grad"] = False[0m

[31m--[ [0m[34mMatch #[0m[33m259[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/uintx/block_sparse_layout.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m122 | [0m[35m            bsr_col_indices=inner_tensors.get("bsr_col_indices", None),[0m
[30;1m123 | [0m[35m            bsr_values=inner_tensors.get("bsr_values", None),[0m
[30;1m124 | [0m[35m            scale=inner_tensors.get("scale", None),[0m
[30;1m125 | [0m[35m            zero_point=inner_tensors.get("zero_point", None),[0m
[30;1m126 | [0m[35m            _layout=_layout,[0m
[30;1m127 | [0m[35m            requires_grad=requires_grad,[0m
[30;1m128 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m260[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/uintx/block_sparse_layout.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m121 | [0m[35m            bsr_crow_indices=inner_tensors.get("bsr_crow_indices", None),[0m
[30;1m122 | [0m[35m            bsr_col_indices=inner_tensors.get("bsr_col_indices", None),[0m
[30;1m123 | [0m[35m            bsr_values=inner_tensors.get("bsr_values", None),[0m
[30;1m124 | [0m[35m            scale=inner_tensors.get("scale", None),[0m
[30;1m125 | [0m[35m            zero_point=inner_tensors.get("zero_point", None),[0m
[30;1m126 | [0m[35m            _layout=_layout,[0m
[30;1m127 | [0m[35m            requires_grad=requires_grad,[0m

[31m--[ [0m[34mMatch #[0m[33m261[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/uintx/block_sparse_layout.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m120 | [0m[35m            shape=shape,[0m
[30;1m121 | [0m[35m            bsr_crow_indices=inner_tensors.get("bsr_crow_indices", None),[0m
[30;1m122 | [0m[35m            bsr_col_indices=inner_tensors.get("bsr_col_indices", None),[0m
[30;1m123 | [0m[35m            bsr_values=inner_tensors.get("bsr_values", None),[0m
[30;1m124 | [0m[35m            scale=inner_tensors.get("scale", None),[0m
[30;1m125 | [0m[35m            zero_point=inner_tensors.get("zero_point", None),[0m
[30;1m126 | [0m[35m            _layout=_layout,[0m

[31m--[ [0m[34mMatch #[0m[33m262[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/uintx/block_sparse_layout.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m119 | [0m[35m        return cls([0m
[30;1m120 | [0m[35m            shape=shape,[0m
[30;1m121 | [0m[35m            bsr_crow_indices=inner_tensors.get("bsr_crow_indices", None),[0m
[30;1m122 | [0m[35m            bsr_col_indices=inner_tensors.get("bsr_col_indices", None),[0m
[30;1m123 | [0m[35m            bsr_values=inner_tensors.get("bsr_values", None),[0m
[30;1m124 | [0m[35m            scale=inner_tensors.get("scale", None),[0m
[30;1m125 | [0m[35m            zero_point=inner_tensors.get("zero_point", None),[0m

[31m--[ [0m[34mMatch #[0m[33m263[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/uintx/block_sparse_layout.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m        shape, _layout, requires_grad = tensor_meta[0m
[30;1m119 | [0m[35m        return cls([0m
[30;1m120 | [0m[35m            shape=shape,[0m
[30;1m121 | [0m[35m            bsr_crow_indices=inner_tensors.get("bsr_crow_indices", None),[0m
[30;1m122 | [0m[35m            bsr_col_indices=inner_tensors.get("bsr_col_indices", None),[0m
[30;1m123 | [0m[35m            bsr_values=inner_tensors.get("bsr_values", None),[0m
[30;1m124 | [0m[35m            scale=inner_tensors.get("scale", None),[0m

[31m--[ [0m[34mMatch #[0m[33m264[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/uintx/block_sparse_layout.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m225 | [0m[35m    y_shape = (*x_vals_int8.shape[:-1], w_scales.shape[-1])[0m
[30;1m226 | [0m[35m    y = y.reshape(*y_shape)[0m
[30;1m227 | [0m[35m[0m
[30;1m228 | [0m[35m    # can downcast only at the very end[0m
[30;1m229 | [0m[35m    output_dtype = input_tensor.dtype[0m
[30;1m230 | [0m[35m    y = y.to(output_dtype)[0m
[30;1m231 | [0m[35m    if bias is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m265[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/mixed_precision/scripts/fit.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35m        i = random.randint(0, trainenc.input_ids.shape[1] - seqlen - 1)[0m
[30;1m26 | [0m[35m        j = i + seqlen[0m
[30;1m27 | [0m[35m        inp = trainenc.input_ids[:, i:j][0m
[30;1m28 | [0m[35m        tar = inp.clone()[0m
[30;1m29 | [0m[35m        tar[:, :-1] = -100[0m
[30;1m30 | [0m[35m        trainloader.append((inp, tar))[0m
[30;1m31 | [0m[35m    return trainloader, testenc[0m

[31m--[ [0m[34mMatch #[0m[33m266[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/custom_fp_utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m219 | [0m[35m                )[0m
[30;1m220 | [0m[35m                exp_biased_f32 = (denormal_exp_biased - left_shift) << MBITS_F32[0m
[30;1m221 | [0m[35m[0m
[30;1m222 | [0m[35m                # we can update this in-place since the values won't overlap[0m
[30;1m223 | [0m[35m                # torch.compile() may complain unsupported operand type(s) for |: 'SymInt' and 'int'[0m
[30;1m224 | [0m[35m                # thus we use + instead of | here[0m
[30;1m225 | [0m[35m                mantissa_lp_int32[mantissa_lp_int32 == mantissa_cmp] = ([0m

[31m--[ [0m[34mMatch #[0m[33m267[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/custom_fp_utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m164 | [0m[35m    # save the sign[0m
[30;1m165 | [0m[35m    sign_lp = x & sign_mask[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m    # set everything to positive, will add sign back at the end[0m
[30;1m168 | [0m[35m    x_pos = x ^ sign_lp[0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35m    #[0m

[31m--[ [0m[34mMatch #[0m[33m268[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/custom_fp_utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m113 | [0m[35m    normal_x = x.view(torch.int32)[0m
[30;1m114 | [0m[35m    # resulting mantissa is odd[0m
[30;1m115 | [0m[35m    mant_odd = (normal_x >> (MBITS_F32 - mbits)) & 1[0m
[30;1m116 | [0m[35m    # update exponent, rounding bias part 1[0m
[30;1m117 | [0m[35m    val_to_add = ((exp_bias - F32_EXP_BIAS) << MBITS_F32) + magic_adder[0m
[30;1m118 | [0m[35m    normal_x += val_to_add[0m
[30;1m119 | [0m[35m    # rounding bias part 2[0m

[31m--[ [0m[34mMatch #[0m[33m269[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/custom_fp_utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m89 | [0m[35m    x = x.view(torch.float)[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m    # rewrite saturate/denorm/norm branches without explicit data dependent[0m
[30;1m92 | [0m[35m    # control flow, to be more compiler friendly[0m
[30;1m93 | [0m[35m    saturate_mask = x >= max_normal[0m
[30;1m94 | [0m[35m    denormal_mask = torch.logical_and(torch.logical_not(saturate_mask), x < min_normal)[0m
[30;1m95 | [0m[35m    normal_mask = torch.logical_not(torch.logical_or(saturate_mask, denormal_mask))[0m

[31m--[ [0m[34mMatch #[0m[33m270[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/custom_fp_utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m81 | [0m[35m    x = x.view(torch.int32)[0m
[30;1m82 | [0m[35m    sign = x & 0x80000000[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m    # set everything to positive, will add sign back at the end[0m
[30;1m85 | [0m[35m    x = x ^ sign[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m    # TODO: can the branch floating point comparisons below be done without[0m

[31m--[ [0m[34mMatch #[0m[33m271[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/custom_fp_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m# This source code is licensed under the license found in the[0m
[30;1m5 | [0m[35m# LICENSE file in the root directory of this source tree.[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35m# This script was initially developed for sub-byte MX dtypes (FP4 E2M1, FP6 E3M2, and FP6 E2M3).[0m
[30;1m8 | [0m[35m# It has been refactored to support any sub-byte FP dtypes. However, some behaviors of MX dtypes rem[0m
[30;1m9 | [0m[35m#   1. No encodings are reserved for special values (+/-inf, NaN).[0m
[30;1m10 | [0m[35m#   2. When downcasting from FP32 to Floatx,[0m

[31m--[ [0m[34mMatch #[0m[33m272[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/modeling/memory_attention.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m103 | [0m[35m        pos_enc_at_input: bool,[0m
[30;1m104 | [0m[35m        layer: nn.Module,[0m
[30;1m105 | [0m[35m        num_layers: int,[0m
[30;1m106 | [0m[35m        batch_first: bool = True,  # Do layers expect batch first input?[0m
[30;1m107 | [0m[35m    ):[0m
[30;1m108 | [0m[35m        super().__init__()[0m
[30;1m109 | [0m[35m        self.d_model = d_model[0m

[31m--[ [0m[34mMatch #[0m[33m273[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/mx_formats/fp_format_spec.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35m# LICENSE file in the root directory of this source tree.[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35m"""[0m
[30;1m8 | [0m[35mA helper script to summarize the key numerical values of various floating[0m
[30;1m9 | [0m[35mpoint formats relevant to the MX spec.[0m
[30;1m10 | [0m[35m"""[0m
[30;1m11 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m274[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/mixed_precision/scripts/hessian_vhp.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35m        i = random.randint(0, trainenc.input_ids.shape[1] - seqlen - 1)[0m
[30;1m32 | [0m[35m        j = i + seqlen[0m
[30;1m33 | [0m[35m        inp = trainenc.input_ids[:, i:j][0m
[30;1m34 | [0m[35m        tar = inp.clone()[0m
[30;1m35 | [0m[35m        tar[:, :-1] = -100[0m
[30;1m36 | [0m[35m        trainloader.append((inp, tar))[0m
[30;1m37 | [0m[35m    return trainloader, testenc.input_ids[0m

[31m--[ [0m[34mMatch #[0m[33m275[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/optim/subclass_8bit.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m133 | [0m[35m@OptimState8bit.implements(aten._to_copy.default)[0m
[30;1m134 | [0m[35mdef _(func, types, args, kwargs):[0m
[30;1m135 | [0m[35m    # ignore dtype[0m
[30;1m136 | [0m[35m    device = kwargs.get("device", None)[0m
[30;1m137 | [0m[35m    out = OptimState8bit([0m
[30;1m138 | [0m[35m        args[0].codes.to(device=device),[0m
[30;1m139 | [0m[35m        args[0].scale.to(device=device),[0m

[31m--[ [0m[34mMatch #[0m[33m276[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/hqq/hqq_tinygemm_linear.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35m#[0m
[30;1m4 | [0m[35m# This source code is licensed under the BSD 3-Clause license found in the[0m
[30;1m5 | [0m[35m# LICENSE file in the root directory of this source tree.[0m
[30;1m6 | [0m[35m# mobicham's tinygemm hqq eval script[0m
[30;1m7 | [0m[35mimport torch[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mdevice = "cuda"[0m
[30;1m10 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m277[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/floatx/cutlass_semi_sparse_layout.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m        kwargs = {}[0m
[30;1m63 | [0m[35m        kwargs["device"] = sparse.device[0m
[30;1m64 | [0m[35m        kwargs["layout"] = ([0m
[30;1m65 | [0m[35m            kwargs.get("layout") if kwargs.get("layout", False) else sparse.layout[0m
[30;1m66 | [0m[35m        )[0m
[30;1m67 | [0m[35m        kwargs["dtype"] = sparse.dtype[0m
[30;1m68 | [0m[35m        kwargs["requires_grad"] = False[0m

[31m--[ [0m[34mMatch #[0m[33m278[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/floatx/cutlass_semi_sparse_layout.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m        kwargs = {}[0m
[30;1m63 | [0m[35m        kwargs["device"] = sparse.device[0m
[30;1m64 | [0m[35m        kwargs["layout"] = ([0m
[30;1m65 | [0m[35m            kwargs.get("layout") if kwargs.get("layout", False) else sparse.layout[0m
[30;1m66 | [0m[35m        )[0m
[30;1m67 | [0m[35m        kwargs["dtype"] = sparse.dtype[0m
[30;1m68 | [0m[35m        kwargs["requires_grad"] = False[0m

[31m--[ [0m[34mMatch #[0m[33m279[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/optim/subclass_fp8.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m110 | [0m[35m@OptimStateFp8.implements(aten._to_copy.default)[0m
[30;1m111 | [0m[35mdef _(func, types, args, kwargs):[0m
[30;1m112 | [0m[35m    # ignore dtype[0m
[30;1m113 | [0m[35m    device = kwargs.get("device", None)[0m
[30;1m114 | [0m[35m    out = OptimStateFp8([0m
[30;1m115 | [0m[35m        args[0].codes.to(device=device),[0m
[30;1m116 | [0m[35m        args[0].scale.to(device=device),[0m

[31m--[ [0m[34mMatch #[0m[33m280[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/sparsity/training/pointwise_ops.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m17 | [0m[35m    """[0m
[30;1m18 | [0m[35m    adds pointwise op support for semi-structured tensors.[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m    Assumes that at least one of the arguments in arg is a SparseSemiStructuredTensor.[0m
[30;1m21 | [0m[35m    The last instance of a SparseSemiStructuredTensor is used as the reference mask to sparsify the [0m
[30;1m22 | [0m[35m    sparsify_like_args_list is used to specify which arguments to sparsify like the reference tensor[0m
[30;1m23 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m281[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/testing/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m110 | [0m[35m            if xfail_prop is not None and hasattr(value, xfail_prop):[0m
[30;1m111 | [0m[35m                new_test = unittest.expectedFailure(new_test)[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m            tf = test_failures and test_failures.get(name)[0m
[30;1m114 | [0m[35m            if tf is not None and suffix in tf.suffixes:[0m
[30;1m115 | [0m[35m                skip_func = ([0m
[30;1m116 | [0m[35m                    unittest.skip("Skipped!")[0m

[31m--[ [0m[34mMatch #[0m[33m282[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/galore/optim/galore_torch.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m285 | [0m[35m                # Instead we want to decay the weights in a manner that doesn't interact[0m
[30;1m286 | [0m[35m                # with the m/v parameters. This is equivalent to adding the square[0m
[30;1m287 | [0m[35m                # of the weights to the loss with plain (non-momentum) SGD.[0m
[30;1m288 | [0m[35m                # Add weight decay at the end (fixed version)[0m
[30;1m289 | [0m[35m                if group["weight_decay"] > 0.0:[0m
[30;1m290 | [0m[35m                    p.add_(p, alpha=(-group["lr"] * group["weight_decay"]))[0m
[30;1m291 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m283[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/galore/optim/galore_torch.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m256 | [0m[35m                state["step"] += 1[0m
[30;1m257 | [0m[35m[0m
[30;1m258 | [0m[35m                # Decay the first and second moment running average coefficient[0m
[30;1m259 | [0m[35m                # In-place operations to update the averages at the same time[0m
[30;1m260 | [0m[35m                exp_avg.mul_(beta1).add_(grad, alpha=(1.0 - beta1))[0m
[30;1m261 | [0m[35m                exp_avg_sq.mul_(beta2).addcmul_(grad, grad, value=1.0 - beta2)[0m
[30;1m262 | [0m[35m                denom = exp_avg_sq.sqrt().add_(group["eps"])[0m

[31m--[ [0m[34mMatch #[0m[33m284[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/galore/optim/galore_torch.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m256 | [0m[35m                state["step"] += 1[0m
[30;1m257 | [0m[35m[0m
[30;1m258 | [0m[35m                # Decay the first and second moment running average coefficient[0m
[30;1m259 | [0m[35m                # In-place operations to update the averages at the same time[0m
[30;1m260 | [0m[35m                exp_avg.mul_(beta1).add_(grad, alpha=(1.0 - beta1))[0m
[30;1m261 | [0m[35m                exp_avg_sq.mul_(beta2).addcmul_(grad, grad, value=1.0 - beta2)[0m
[30;1m262 | [0m[35m                denom = exp_avg_sq.sqrt().add_(group["eps"])[0m

[31m--[ [0m[34mMatch #[0m[33m285[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/galore/optim/galore_torch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m256 | [0m[35m                state["step"] += 1[0m
[30;1m257 | [0m[35m[0m
[30;1m258 | [0m[35m                # Decay the first and second moment running average coefficient[0m
[30;1m259 | [0m[35m                # In-place operations to update the averages at the same time[0m
[30;1m260 | [0m[35m                exp_avg.mul_(beta1).add_(grad, alpha=(1.0 - beta1))[0m
[30;1m261 | [0m[35m                exp_avg_sq.mul_(beta2).addcmul_(grad, grad, value=1.0 - beta2)[0m
[30;1m262 | [0m[35m                denom = exp_avg_sq.sqrt().add_(group["eps"])[0m
[30;1m263 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m286[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/common/triton/matmul_perf_model.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m154 | [0m[35m    # loading time in ms[0m
[30;1m155 | [0m[35m    load_ms = total_dram / dram_bw + total_l2 / l2_bw[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m    # estimate storing time[0m
[30;1m158 | [0m[35m    store_bw = dram_bw * 0.6  # :o[0m
[30;1m159 | [0m[35m    store_c_dram = M * N * dtsize * SPLIT_K / (1024 * 1024)  # MB[0m
[30;1m160 | [0m[35m    if SPLIT_K == 1:[0m
[30;1m161 | [0m[35m        store_ms = store_c_dram / store_bw[0m

[31m--[ [0m[34mMatch #[0m[33m287[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/common/triton/matmul_perf_model.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m151 | [0m[35m    # total[0m
[30;1m152 | [0m[35m    total_dram = (load_a_dram + load_b_dram) / (1024 * 1024)  # MB[0m
[30;1m153 | [0m[35m    total_l2 = (load_a_l2 + load_b_l2) / (1024 * 1024)[0m
[30;1m154 | [0m[35m    # loading time in ms[0m
[30;1m155 | [0m[35m    load_ms = total_dram / dram_bw + total_l2 / l2_bw[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m    # estimate storing time[0m

[31m--[ [0m[34mMatch #[0m[33m288[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/common/triton/matmul_perf_model.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m124 | [0m[35m    tput = get_tflops(device, num_ctas, num_warps, dtype)[0m
[30;1m125 | [0m[35m    compute_ms = total_ops / tput[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m    # time to load data[0m
[30;1m128 | [0m[35m    if hasattr(driver, "active"):[0m
[30;1m129 | [0m[35m        num_sm = driver.active.utils.get_device_properties(device)[[0m
[30;1m130 | [0m[35m            "multiprocessor_count"[0m

[31m--[ [0m[34mMatch #[0m[33m289[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/common/triton/matmul_perf_model.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m119 | [0m[35m    # If the input is smaller than the block size[0m
[30;1m120 | [0m[35m    M, N = max(M, BLOCK_M), max(N, BLOCK_N)[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m    # time to compute[0m
[30;1m123 | [0m[35m    total_ops = 2 * M * N * K / (1024 * 1024 * 1024)  # GOPS[0m
[30;1m124 | [0m[35m    tput = get_tflops(device, num_ctas, num_warps, dtype)[0m
[30;1m125 | [0m[35m    compute_ms = total_ops / tput[0m

[31m--[ [0m[34mMatch #[0m[33m290[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/common/triton/matmul_perf_model.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m105 | [0m[35m    debug=False,[0m
[30;1m106 | [0m[35m    **kwargs,  #[0m
[30;1m107 | [0m[35m):[0m
[30;1m108 | [0m[35m    """return estimated running time in ms[0m
[30;1m109 | [0m[35m    = max(compute, loading) + store"""[0m
[30;1m110 | [0m[35m    device = torch.cuda.current_device()[0m
[30;1m111 | [0m[35m    dtype = A.dtype[0m

[31m--[ [0m[34mMatch #[0m[33m291[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/autoround/eval_autoround.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35mAO_USE_DETERMINISTIC_ALGORITHMS = ([0m
[30;1m38 | [0m[35m    os.environ.get("AO_USE_DETERMINISTIC_ALGORITHMS", "0") == "1"[0m
[30;1m39 | [0m[35m)[0m
[30;1m40 | [0m[35mif AO_USE_DETERMINISTIC_ALGORITHMS:[0m
[30;1m41 | [0m[35m    _use_deterministic()[0m

[31m--[ [0m[34mMatch #[0m[33m292[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/autoround/eval_autoround.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m52 | [0m[35m            """[0m
[30;1m53 | [0m[35m    Error: The 'lm_eval' module was not found.[0m
[30;1m54 | [0m[35m    To install, follow these steps:[0m
[30;1m55 | [0m[35m    pip install git+https://github.com/EleutherAI/lm-evaluation-harness.git[0m
[30;1m56 | [0m[35m    """[0m
[30;1m57 | [0m[35m        )[0m
[30;1m58 | [0m[35m        raise  # Re-raise the ImportError[0m

[31m--[ [0m[34mMatch #[0m[33m293[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/float8nocompile/kernels/fp8_dynamic_tensorwise.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m993 | [0m[35m        EPS=EPS,[0m
[30;1m994 | [0m[35m    )[0m
[30;1m995 | [0m[35m[0m
[30;1m996 | [0m[35m    # for col major we need to update the strides to reflect the new memory layout[0m
[30;1m997 | [0m[35m    col_major_strides = (1, input_num_rows)[0m
[30;1m998 | [0m[35m    fp8_output_col_major = fp8_output_col_major.as_strided([0m
[30;1m999 | [0m[35m        fp8_output_col_major.size(), col_major_strides[0m

[31m--[ [0m[34mMatch #[0m[33m294[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/float8nocompile/kernels/fp8_dynamic_tensorwise.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m824 | [0m[35m        EPS=EPS,[0m
[30;1m825 | [0m[35m    )[0m
[30;1m826 | [0m[35m[0m
[30;1m827 | [0m[35m    # for col major we need to update the strides to reflect the new memory layout[0m
[30;1m828 | [0m[35m    col_major_strides = (1, num_rows)[0m
[30;1m829 | [0m[35m    fp8_output_col_major = fp8_output_col_major.as_strided([0m
[30;1m830 | [0m[35m        fp8_output_col_major.size(), col_major_strides[0m

[31m--[ [0m[34mMatch #[0m[33m295[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/float8nocompile/kernels/fp8_dynamic_tensorwise.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m701 | [0m[35m        EPS=EPS,[0m
[30;1m702 | [0m[35m    )[0m
[30;1m703 | [0m[35m[0m
[30;1m704 | [0m[35m    # for col major we need to update the strides to reflect the new memory layout[0m
[30;1m705 | [0m[35m    col_major_strides = (1, num_rows)[0m
[30;1m706 | [0m[35m    output_buffer = output_buffer.as_strided(output_buffer.size(), col_major_strides)[0m
[30;1m707 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m296[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/float8nocompile/kernels/fp8_dynamic_tensorwise.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35m    # use atomic max to compute global amax between blocks[0m
[30;1m55 | [0m[35m    ATOMIC_MAX = "atomic_max"[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    # reduce shared buffer containing local block amaxes to find global amax[0m
[30;1m58 | [0m[35m    REDUCTION = "reduction"[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m297[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/sam2_video_predictor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1064 | [0m[35m        Remove an object id from the tracking state. If strict is True, we check whether[0m
[30;1m1065 | [0m[35m        the object id actually exists and raise an error if it doesn't exist.[0m
[30;1m1066 | [0m[35m        """[0m
[30;1m1067 | [0m[35m        old_obj_idx_to_rm = inference_state["obj_id_to_idx"].get(obj_id, None)[0m
[30;1m1068 | [0m[35m        updated_frames = [][0m
[30;1m1069 | [0m[35m        # Check whether this object_id to remove actually exists and possibly raise an error.[0m
[30;1m1070 | [0m[35m        if old_obj_idx_to_rm is None:[0m

[31m--[ [0m[34mMatch #[0m[33m298[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/sam2_video_predictor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m898 | [0m[35m    def _get_image_feature(self, inference_state, frame_idx, batch_size):[0m
[30;1m899 | [0m[35m        """Compute the image features on a given frame."""[0m
[30;1m900 | [0m[35m        # Look up in the cache first[0m
[30;1m901 | [0m[35m        image, backbone_out = inference_state["cached_features"].get([0m
[30;1m902 | [0m[35m            frame_idx, (None, None)[0m
[30;1m903 | [0m[35m        )[0m
[30;1m904 | [0m[35m        if backbone_out is None:[0m

[31m--[ [0m[34mMatch #[0m[33m299[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/sam2_video_predictor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m512 | [0m[35m            if out is None:[0m
[30;1m513 | [0m[35m                out = obj_output_dict["cond_frame_outputs"].get(frame_idx, None)[0m
[30;1m514 | [0m[35m            if out is None:[0m
[30;1m515 | [0m[35m                out = obj_output_dict["non_cond_frame_outputs"].get(frame_idx, None)[0m
[30;1m516 | [0m[35m            # If the object doesn't appear in "output_dict_per_obj" either, we skip it[0m
[30;1m517 | [0m[35m            # and leave its mask scores to the default scores (i.e. the NO_OBJ_SCORE[0m
[30;1m518 | [0m[35m            # placeholder above) and set its object pointer to be a dummy pointer.[0m

[31m--[ [0m[34mMatch #[0m[33m300[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/sam2_video_predictor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m510 | [0m[35m            # We look up both "cond_frame_outputs" and "non_cond_frame_outputs" in[0m
[30;1m511 | [0m[35m            # "output_dict_per_obj" to find a previous output for this object.[0m
[30;1m512 | [0m[35m            if out is None:[0m
[30;1m513 | [0m[35m                out = obj_output_dict["cond_frame_outputs"].get(frame_idx, None)[0m
[30;1m514 | [0m[35m            if out is None:[0m
[30;1m515 | [0m[35m                out = obj_output_dict["non_cond_frame_outputs"].get(frame_idx, None)[0m
[30;1m516 | [0m[35m            # If the object doesn't appear in "output_dict_per_obj" either, we skip it[0m

[31m--[ [0m[34mMatch #[0m[33m301[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/sam2_video_predictor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m504 | [0m[35m        for obj_idx in range(batch_size):[0m
[30;1m505 | [0m[35m            obj_temp_output_dict = inference_state["temp_output_dict_per_obj"][obj_idx][0m
[30;1m506 | [0m[35m            obj_output_dict = inference_state["output_dict_per_obj"][obj_idx][0m
[30;1m507 | [0m[35m            out = obj_temp_output_dict[storage_key].get(frame_idx, None)[0m
[30;1m508 | [0m[35m            # If the object doesn't appear in "temp_output_dict_per_obj" on this frame,[0m
[30;1m509 | [0m[35m            # we fall back and look up its previous output in "output_dict_per_obj".[0m
[30;1m510 | [0m[35m            # We look up both "cond_frame_outputs" and "non_cond_frame_outputs" in[0m

[31m--[ [0m[34mMatch #[0m[33m302[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/sam2_video_predictor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m292 | [0m[35m        if prev_out is None:[0m
[30;1m293 | [0m[35m            prev_out = obj_output_dict["cond_frame_outputs"].get(frame_idx)[0m
[30;1m294 | [0m[35m            if prev_out is None:[0m
[30;1m295 | [0m[35m                prev_out = obj_output_dict["non_cond_frame_outputs"].get(frame_idx)[0m
[30;1m296 | [0m[35m[0m
[30;1m297 | [0m[35m        if prev_out is not None and prev_out["pred_masks"] is not None:[0m
[30;1m298 | [0m[35m            device = inference_state["device"][0m

[31m--[ [0m[34mMatch #[0m[33m303[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/sam2_video_predictor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m290 | [0m[35m        # (if not found, then lookup conditioning and non-conditioning frame output)[0m
[30;1m291 | [0m[35m        prev_out = obj_temp_output_dict[storage_key].get(frame_idx)[0m
[30;1m292 | [0m[35m        if prev_out is None:[0m
[30;1m293 | [0m[35m            prev_out = obj_output_dict["cond_frame_outputs"].get(frame_idx)[0m
[30;1m294 | [0m[35m            if prev_out is None:[0m
[30;1m295 | [0m[35m                prev_out = obj_output_dict["non_cond_frame_outputs"].get(frame_idx)[0m
[30;1m296 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m304[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/sam2_video_predictor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m288 | [0m[35m        prev_sam_mask_logits = None[0m
[30;1m289 | [0m[35m        # lookup temporary output dict first, which contains the most recent output[0m
[30;1m290 | [0m[35m        # (if not found, then lookup conditioning and non-conditioning frame output)[0m
[30;1m291 | [0m[35m        prev_out = obj_temp_output_dict[storage_key].get(frame_idx)[0m
[30;1m292 | [0m[35m        if prev_out is None:[0m
[30;1m293 | [0m[35m            prev_out = obj_output_dict["cond_frame_outputs"].get(frame_idx)[0m
[30;1m294 | [0m[35m            if prev_out is None:[0m

[31m--[ [0m[34mMatch #[0m[33m305[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/sam2_video_predictor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m259 | [0m[35m        labels = labels.to(inference_state["device"])[0m
[30;1m260 | [0m[35m[0m
[30;1m261 | [0m[35m        if not clear_old_points:[0m
[30;1m262 | [0m[35m            point_inputs = point_inputs_per_frame.get(frame_idx, None)[0m
[30;1m263 | [0m[35m        else:[0m
[30;1m264 | [0m[35m            point_inputs = None[0m
[30;1m265 | [0m[35m        point_inputs = concat_points(point_inputs, points, labels)[0m

[31m--[ [0m[34mMatch #[0m[33m306[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/sam2_video_predictor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m    def _obj_id_to_idx(self, inference_state, obj_id):[0m
[30;1m150 | [0m[35m        """Map client-side object id to model-side object index."""[0m
[30;1m151 | [0m[35m        obj_idx = inference_state["obj_id_to_idx"].get(obj_id, None)[0m
[30;1m152 | [0m[35m        if obj_idx is not None:[0m
[30;1m153 | [0m[35m            return obj_idx[0m
[30;1m154 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m307[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/sam2_video_predictor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1141 | [0m[35m                out["object_score_logits"] = out["object_score_logits"][[0m
[30;1m1142 | [0m[35m                    remain_old_obj_inds[0m
[30;1m1143 | [0m[35m                ][0m
[30;1m1144 | [0m[35m                # also update the per-object slices[0m
[30;1m1145 | [0m[35m                self._add_output_per_object([0m
[30;1m1146 | [0m[35m                    inference_state, frame_idx, out, storage_key[0m
[30;1m1147 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m308[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/sam2_video_predictor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1097 | [0m[35m                inference_state, frame_idx, obj_id, need_output=False[0m
[30;1m1098 | [0m[35m            )[0m
[30;1m1099 | [0m[35m[0m
[30;1m1100 | [0m[35m        # Step 1: Update the object id mapping (note that it must be done after Step 0,[0m
[30;1m1101 | [0m[35m        # since Step 0 still requires the old object id mappings in inference_state)[0m
[30;1m1102 | [0m[35m        old_obj_ids = inference_state["obj_ids"][0m
[30;1m1103 | [0m[35m        old_obj_inds = list(range(len(old_obj_ids)))[0m

[31m--[ [0m[34mMatch #[0m[33m309[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/sam2_video_predictor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1049 | [0m[35m                model_constants["maskmem_pos_enc"] = maskmem_pos_enc[0m
[30;1m1050 | [0m[35m            else:[0m
[30;1m1051 | [0m[35m                maskmem_pos_enc = model_constants["maskmem_pos_enc"][0m
[30;1m1052 | [0m[35m            # expand the cached maskmem_pos_enc to the actual batch size[0m
[30;1m1053 | [0m[35m            batch_size = out_maskmem_pos_enc[0].size(0)[0m
[30;1m1054 | [0m[35m            expanded_maskmem_pos_enc = [[0m
[30;1m1055 | [0m[35m                x.expand(batch_size, -1, -1, -1) for x in maskmem_pos_enc[0m

[31m--[ [0m[34mMatch #[0m[33m310[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/sam2_video_predictor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m910 | [0m[35m            # a frame; we can use an LRU cache for more frames in the future).[0m
[30;1m911 | [0m[35m            inference_state["cached_features"] = {frame_idx: (image, backbone_out)}[0m
[30;1m912 | [0m[35m[0m
[30;1m913 | [0m[35m        # expand the features to have the same dimension as the number of objects[0m
[30;1m914 | [0m[35m        expanded_image = image.expand(batch_size, -1, -1, -1)[0m
[30;1m915 | [0m[35m        expanded_backbone_out = {[0m
[30;1m916 | [0m[35m            "backbone_fpn": backbone_out["backbone_fpn"].copy(),[0m

[31m--[ [0m[34mMatch #[0m[33m311[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/sam2_video_predictor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m464 | [0m[35m        # Optionally, we allow consolidating the temporary outputs at the original[0m
[30;1m465 | [0m[35m        # video resolution (to provide a better editing experience for mask prompts).[0m
[30;1m466 | [0m[35m        if consolidate_at_video_res:[0m
[30;1m467 | [0m[35m            assert not run_mem_encoder, "memory encoder cannot run at video resolution"[0m
[30;1m468 | [0m[35m            consolidated_H = inference_state["video_height"][0m
[30;1m469 | [0m[35m            consolidated_W = inference_state["video_width"][0m
[30;1m470 | [0m[35m            consolidated_mask_key = "pred_masks_video_res"[0m

[31m--[ [0m[34mMatch #[0m[33m312[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/sam2_video_predictor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m461 | [0m[35m        """[0m
[30;1m462 | [0m[35m        batch_size = self._get_obj_num(inference_state)[0m
[30;1m463 | [0m[35m        storage_key = "cond_frame_outputs" if is_cond else "non_cond_frame_outputs"[0m
[30;1m464 | [0m[35m        # Optionally, we allow consolidating the temporary outputs at the original[0m
[30;1m465 | [0m[35m        # video resolution (to provide a better editing experience for mask prompts).[0m
[30;1m466 | [0m[35m        if consolidate_at_video_res:[0m
[30;1m467 | [0m[35m            assert not run_mem_encoder, "memory encoder cannot run at video resolution"[0m

[31m--[ [0m[34mMatch #[0m[33m313[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/sam2_video_predictor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m398 | [0m[35m            mask_inputs=mask_inputs,[0m
[30;1m399 | [0m[35m            reverse=reverse,[0m
[30;1m400 | [0m[35m            # Skip the memory encoder when adding clicks or mask. We execute the memory encoder[0m
[30;1m401 | [0m[35m            # at the beginning of `propagate_in_video` (after user finalize their clicks). This[0m
[30;1m402 | [0m[35m            # allows us to enforce non-overlapping constraints on all objects before encoding[0m
[30;1m403 | [0m[35m            # them into memory.[0m
[30;1m404 | [0m[35m            run_mem_encoder=False,[0m

[31m--[ [0m[34mMatch #[0m[33m314[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/sam2_video_predictor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m309 | [0m[35m            mask_inputs=None,[0m
[30;1m310 | [0m[35m            reverse=reverse,[0m
[30;1m311 | [0m[35m            # Skip the memory encoder when adding clicks or mask. We execute the memory encoder[0m
[30;1m312 | [0m[35m            # at the beginning of `propagate_in_video` (after user finalize their clicks). This[0m
[30;1m313 | [0m[35m            # allows us to enforce non-overlapping constraints on all objects before encoding[0m
[30;1m314 | [0m[35m            # them into memory.[0m
[30;1m315 | [0m[35m            run_mem_encoder=False,[0m

[31m--[ [0m[34mMatch #[0m[33m315[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/sam2_video_predictor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m83 | [0m[35m        # turning on this option saves the GPU memory with only a very small overhead[0m
[30;1m84 | [0m[35m        inference_state["offload_video_to_cpu"] = offload_video_to_cpu[0m
[30;1m85 | [0m[35m        # whether to offload the inference state to CPU memory[0m
[30;1m86 | [0m[35m        # turning on this option saves the GPU memory at the cost of a lower tracking fps[0m
[30;1m87 | [0m[35m        # (e.g. in a test case of 768x768 model, fps dropped from 27 to 24 when tracking one object[0m
[30;1m88 | [0m[35m        # and from 24 to 21 when tracking two objects)[0m
[30;1m89 | [0m[35m        inference_state["offload_state_to_cpu"] = offload_state_to_cpu[0m

[31m--[ [0m[34mMatch #[0m[33m316[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/sam2_video_predictor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1049 | [0m[35m                model_constants["maskmem_pos_enc"] = maskmem_pos_enc[0m
[30;1m1050 | [0m[35m            else:[0m
[30;1m1051 | [0m[35m                maskmem_pos_enc = model_constants["maskmem_pos_enc"][0m
[30;1m1052 | [0m[35m            # expand the cached maskmem_pos_enc to the actual batch size[0m
[30;1m1053 | [0m[35m            batch_size = out_maskmem_pos_enc[0].size(0)[0m
[30;1m1054 | [0m[35m            expanded_maskmem_pos_enc = [[0m
[30;1m1055 | [0m[35m                x.expand(batch_size, -1, -1, -1) for x in maskmem_pos_enc[0m

[31m--[ [0m[34mMatch #[0m[33m317[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/sam2_video_predictor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m910 | [0m[35m            # a frame; we can use an LRU cache for more frames in the future).[0m
[30;1m911 | [0m[35m            inference_state["cached_features"] = {frame_idx: (image, backbone_out)}[0m
[30;1m912 | [0m[35m[0m
[30;1m913 | [0m[35m        # expand the features to have the same dimension as the number of objects[0m
[30;1m914 | [0m[35m        expanded_image = image.expand(batch_size, -1, -1, -1)[0m
[30;1m915 | [0m[35m        expanded_backbone_out = {[0m
[30;1m916 | [0m[35m            "backbone_fpn": backbone_out["backbone_fpn"].copy(),[0m

[31m--[ [0m[34mMatch #[0m[33m318[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/sam2_video_predictor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m626 | [0m[35m        for is_cond in [False, True]:[0m
[30;1m627 | [0m[35m            # Separately consolidate conditioning and non-conditioning temp outputs[0m
[30;1m628 | [0m[35m            storage_key = "cond_frame_outputs" if is_cond else "non_cond_frame_outputs"[0m
[30;1m629 | [0m[35m            # Find all the frames that contain temporary outputs for any objects[0m
[30;1m630 | [0m[35m            # (these should be the frames that have just received clicks for mask inputs[0m
[30;1m631 | [0m[35m            # via `add_new_points_or_box` or `add_new_mask`)[0m
[30;1m632 | [0m[35m            temp_frame_inds = set()[0m

[31m--[ [0m[34mMatch #[0m[33m319[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/sam2_video_predictor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m508 | [0m[35m            # If the object doesn't appear in "temp_output_dict_per_obj" on this frame,[0m
[30;1m509 | [0m[35m            # we fall back and look up its previous output in "output_dict_per_obj".[0m
[30;1m510 | [0m[35m            # We look up both "cond_frame_outputs" and "non_cond_frame_outputs" in[0m
[30;1m511 | [0m[35m            # "output_dict_per_obj" to find a previous output for this object.[0m
[30;1m512 | [0m[35m            if out is None:[0m
[30;1m513 | [0m[35m                out = obj_output_dict["cond_frame_outputs"].get(frame_idx, None)[0m
[30;1m514 | [0m[35m            if out is None:[0m

[31m--[ [0m[34mMatch #[0m[33m320[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/sam2_video_predictor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m376 | [0m[35m        # using any memory from other frames, like in SAM. Otherwise (if it has been tracked),[0m
[30;1m377 | [0m[35m        # the input points will be used to correct the already tracked masks.[0m
[30;1m378 | [0m[35m        is_init_cond_frame = frame_idx not in inference_state["frames_already_tracked"][0m
[30;1m379 | [0m[35m        # whether to track in reverse time order[0m
[30;1m380 | [0m[35m        if is_init_cond_frame:[0m
[30;1m381 | [0m[35m            reverse = False[0m
[30;1m382 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m321[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/sam2_video_predictor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m271 | [0m[35m        # using any memory from other frames, like in SAM. Otherwise (if it has been tracked),[0m
[30;1m272 | [0m[35m        # the input points will be used to correct the already tracked masks.[0m
[30;1m273 | [0m[35m        is_init_cond_frame = frame_idx not in inference_state["frames_already_tracked"][0m
[30;1m274 | [0m[35m        # whether to track in reverse time order[0m
[30;1m275 | [0m[35m        if is_init_cond_frame:[0m
[30;1m276 | [0m[35m            reverse = False[0m
[30;1m277 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m322[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/autoround/core.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m321 | [0m[35m        _optimization_tracker.num_layers,[0m
[30;1m322 | [0m[35m    )[0m
[30;1m323 | [0m[35m[0m
[30;1m324 | [0m[35m    # Start the training process to update the v, alpha and beta.[0m
[30;1m325 | [0m[35m    rounder = auto_round.AutoRound([0m
[30;1m326 | [0m[35m        model=block,[0m
[30;1m327 | [0m[35m        tokenizer=None,[0m

[31m--[ [0m[34mMatch #[0m[33m323[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/autoround/core.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m167 | [0m[35mdef apply_auto_round():[0m
[30;1m168 | [0m[35m    """Create the quantized model from the model optimized by auto-round.[0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35m    More details about the auto-round can be found at https://arxiv.org/abs/2309.05516.[0m
[30;1m171 | [0m[35m    """[0m
[30;1m172 | [0m[35m[0m
[30;1m173 | [0m[35m    raise AssertionError([0m

[31m--[ [0m[34mMatch #[0m[33m324[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/autoround/multi_tensor.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m37 | [0m[35m    def __new__(cls, input, **kwargs):[0m
[30;1m38 | [0m[35m        if isinstance(input, (list, tuple)):[0m
[30;1m39 | [0m[35m            input = input[0][0m
[30;1m40 | [0m[35m        kwargs["dtype"] = kwargs.get("dtype", input.dtype)[0m
[30;1m41 | [0m[35m        shape = kwargs.pop("shape", input.shape)[0m
[30;1m42 | [0m[35m        return torch.Tensor._make_wrapper_subclass(cls, shape, **kwargs)[0m
[30;1m43 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m325[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/autoround/multi_tensor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m111 | [0m[35m                    ][0m
[30;1m112 | [0m[35m                )[0m
[30;1m113 | [0m[35m                for tup in flat_tups[0m
[30;1m114 | [0m[35m                if not isinstance(tup[0], torch.Tensor)  # look at tuples of nonTensors[0m
[30;1m115 | [0m[35m            ][0m
[30;1m116 | [0m[35m        )[0m
[30;1m117 | [0m[35m        return flattened, non_tensors_equal[0m

[31m--[ [0m[34mMatch #[0m[33m326[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/parq/optim/parq.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m95 | [0m[35m                q = torch.minimum([0m
[30;1m96 | [0m[35m                    torch.maximum(center + (p - center) / inv_slope, q_lower), q_upper[0m
[30;1m97 | [0m[35m                )[0m
[30;1m98 | [0m[35m            # in-place update of model parameters[0m
[30;1m99 | [0m[35m            p.copy_(q)[0m
[30;1m100 | [0m[35m        return inv_slope[0m

[31m--[ [0m[34mMatch #[0m[33m327[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/parq/optim/parq.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m27 | [0m[35m    """Sigmoid-like function decreasing from 1 to 0 over interval [t1, t2).[0m
[30;1m28 | [0m[35m    s is steepness of the sigmoid-like function, almost linear for s < 1.[0m
[30;1m29 | [0m[35m    'mirror' means decreasing instead of increasing as true sigmoid,[0m
[30;1m30 | [0m[35m    'normalized' means value 1 at starting point t1 and 0 at end point t2."""[0m
[30;1m31 | [0m[35m    assert t >= t1 and t < t2, "Normalized sigmoid: ensure t1 <= t < t2"[0m
[30;1m32 | [0m[35m    ft = (t - t1) / (t2 - t1)  # fraction of progress from t1 to t2[0m
[30;1m33 | [0m[35m    st = 1 / (1 + math.exp(s * (ft - 0.5)))  # scaled and shifted mirror sigmoid[0m

[31m--[ [0m[34mMatch #[0m[33m328[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/parq/optim/parq.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m27 | [0m[35m    """Sigmoid-like function decreasing from 1 to 0 over interval [t1, t2).[0m
[30;1m28 | [0m[35m    s is steepness of the sigmoid-like function, almost linear for s < 1.[0m
[30;1m29 | [0m[35m    'mirror' means decreasing instead of increasing as true sigmoid,[0m
[30;1m30 | [0m[35m    'normalized' means value 1 at starting point t1 and 0 at end point t2."""[0m
[30;1m31 | [0m[35m    assert t >= t1 and t < t2, "Normalized sigmoid: ensure t1 <= t < t2"[0m
[30;1m32 | [0m[35m    ft = (t - t1) / (t2 - t1)  # fraction of progress from t1 to t2[0m
[30;1m33 | [0m[35m    st = 1 / (1 + math.exp(s * (ft - 0.5)))  # scaled and shifted mirror sigmoid[0m

[31m--[ [0m[34mMatch #[0m[33m329[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/qat/api.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m262 | [0m[35m) -> torch.nn.Module:[0m
[30;1m263 | [0m[35m    """[0m
[30;1m264 | [0m[35m    THIS IS NOT A PUBLIC API - any usage of this outside of torchao[0m
[30;1m265 | [0m[35m    can break at any time.[0m
[30;1m266 | [0m[35m[0m
[30;1m267 | [0m[35m    Apply fake quantization to a `torch.nn.Module`.[0m
[30;1m268 | [0m[35m    to be used with :func:`~torchao.quantization.quant_api.quantize_`.[0m

[31m--[ [0m[34mMatch #[0m[33m330[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantized_training/bitnet.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m69 | [0m[35m    ):[0m
[30;1m70 | [0m[35m        return cls([0m
[30;1m71 | [0m[35m            tensor_data_dict["_data"],[0m
[30;1m72 | [0m[35m            tensor_data_dict.get("_precomputed_scale", None),[0m
[30;1m73 | [0m[35m            *tensor_attributes,[0m
[30;1m74 | [0m[35m        )[0m
[30;1m75 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m331[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantized_training/bitnet.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m4 | [0m[35m# This source code is licensed under the BSD 3-Clause license found in the[0m
[30;1m5 | [0m[35m# LICENSE file in the root directory of this source tree.[0m
[30;1m6 | [0m[35m# this file implements BitNet b1.58 https://arxiv.org/abs/2402.17764[0m
[30;1m7 | [0m[35m# a reference implementation is available at[0m
[30;1m8 | [0m[35m# https://github.com/microsoft/unilm/blob/master/bitnet/The-Era-of-1-bit-LLMs__Training_Tips_Code_FA[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mfrom typing import Any, Optional, Tuple[0m
[30;1m11 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m332[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/subgraph_utils/extract_subgraphs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m74 | [0m[35mdef get_meta_val(n: torch.fx.Node):[0m
[30;1m75 | [0m[35m    # from https://github.com/pytorch/pytorch/blob/8d708090c0eb306facfd8f85d58c578a8cbbe689/torch/fx[0m
[30;1m76 | [0m[35m    meta_val = n.meta.get([0m
[30;1m77 | [0m[35m        "val", n.meta.get("tensor_meta", n.meta.get("example_value", None))[0m
[30;1m78 | [0m[35m    )[0m
[30;1m79 | [0m[35m    return meta_val[0m
[30;1m80 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m333[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/subgraph_utils/extract_subgraphs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m74 | [0m[35mdef get_meta_val(n: torch.fx.Node):[0m
[30;1m75 | [0m[35m    # from https://github.com/pytorch/pytorch/blob/8d708090c0eb306facfd8f85d58c578a8cbbe689/torch/fx[0m
[30;1m76 | [0m[35m    meta_val = n.meta.get([0m
[30;1m77 | [0m[35m        "val", n.meta.get("tensor_meta", n.meta.get("example_value", None))[0m
[30;1m78 | [0m[35m    )[0m
[30;1m79 | [0m[35m    return meta_val[0m
[30;1m80 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m334[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/subgraph_utils/extract_subgraphs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35mdef get_meta_val(n: torch.fx.Node):[0m
[30;1m75 | [0m[35m    # from https://github.com/pytorch/pytorch/blob/8d708090c0eb306facfd8f85d58c578a8cbbe689/torch/fx[0m
[30;1m76 | [0m[35m    meta_val = n.meta.get([0m
[30;1m77 | [0m[35m        "val", n.meta.get("tensor_meta", n.meta.get("example_value", None))[0m
[30;1m78 | [0m[35m    )[0m
[30;1m79 | [0m[35m    return meta_val[0m

[31m--[ [0m[34mMatch #[0m[33m335[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/subgraph_utils/extract_subgraphs.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m636 | [0m[35m                continue[0m
[30;1m637 | [0m[35m[0m
[30;1m638 | [0m[35m            # Note: we special case for linear -> linear,[0m
[30;1m639 | [0m[35m            # so if we are at the second linear then skip debug/extract to avoid duplication[0m
[30;1m640 | [0m[35m            is_second_linear_of_dual_linear = ([0m
[30;1m641 | [0m[35m                n.args[0].op == "call_function"[0m
[30;1m642 | [0m[35m                and n.args[0].target is torch._C._nn.linear[0m

[31m--[ [0m[34mMatch #[0m[33m336[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/subgraph_utils/extract_subgraphs.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m617 | [0m[35m                continue[0m
[30;1m618 | [0m[35m[0m
[30;1m619 | [0m[35m            # Note: we special case for linear -> linear,[0m
[30;1m620 | [0m[35m            # so if we are at the second linear then skip debug/extract to avoid duplication[0m
[30;1m621 | [0m[35m            is_second_linear_of_dual_linear = ([0m
[30;1m622 | [0m[35m                n.args[0].op == "call_module"[0m
[30;1m623 | [0m[35m                and type(getattr(gm, n.args[0].target)) is torch.nn.Linear[0m

[31m--[ [0m[34mMatch #[0m[33m337[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/subgraph_utils/extract_subgraphs.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m173 | [0m[35m        printme(f"cur_linear 2 stack_summary: {get_stack_summary(linear_node_2)}")[0m
[30;1m174 | [0m[35m        linear_node_to_use = linear_node_2[0m
[30;1m175 | [0m[35m[0m
[30;1m176 | [0m[35m    # look at the subsequent ops[0m
[30;1m177 | [0m[35m    # note: sometimes this is a view, so might need to look farther[0m
[30;1m178 | [0m[35m    printme(f"num users: {len(linear_node_to_use.users)}")[0m
[30;1m179 | [0m[35m    for next_n, _ in linear_node_to_use.users.items():[0m

[31m--[ [0m[34mMatch #[0m[33m338[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/subgraph_utils/extract_subgraphs.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m131 | [0m[35m    for prev_n in linear_node.all_input_nodes:[0m
[30;1m132 | [0m[35m        if prev_n.op == "placeholder":[0m
[30;1m133 | [0m[35m            continue[0m
[30;1m134 | [0m[35m        # to get the shape of the input, we need to look at the previous node[0m
[30;1m135 | [0m[35m        for prev_prev_n in prev_n.all_input_nodes:[0m
[30;1m136 | [0m[35m            prev_prev_meta = get_meta_val(prev_prev_n)[0m
[30;1m137 | [0m[35m            if isinstance(prev_prev_meta, tuple):[0m

[31m--[ [0m[34mMatch #[0m[33m339[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/subgraph_utils/extract_subgraphs.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m127 | [0m[35m    cur_linear_2_size = None, None[0m
[30;1m128 | [0m[35m    next_node_types = [][0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m    # look at the preceding activation[0m
[30;1m131 | [0m[35m    for prev_n in linear_node.all_input_nodes:[0m
[30;1m132 | [0m[35m        if prev_n.op == "placeholder":[0m
[30;1m133 | [0m[35m            continue[0m

[31m--[ [0m[34mMatch #[0m[33m340[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/subgraph_utils/extract_subgraphs.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m39 | [0m[35m    """[0m
[30;1m40 | [0m[35m    Tries to format things like[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m      '<built-in method cat of type object at 0x7f3f7a202c60>'[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m    as[0m
[30;1m45 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m341[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/subgraph_utils/extract_subgraphs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m545 | [0m[35m    Inputs:[0m
[30;1m546 | [0m[35m    - `g` - the graph to debug, assumed to come from dynamo's pre-dispatch trace and have torch IR[0m
[30;1m547 | [0m[35m    - `target_folder` - the folder to save metadata and microbenchmarks to, note that all folder[0m
[30;1m548 | [0m[35m      content is overwritten every time the script is run. The contents of this folder will be:[0m
[30;1m549 | [0m[35m        target_folder/[0m
[30;1m550 | [0m[35m          debug_logs_0.txt[0m
[30;1m551 | [0m[35m          skip_logs_0.txt[0m

[31m--[ [0m[34mMatch #[0m[33m342[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/subgraph_utils/extract_subgraphs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m545 | [0m[35m    Inputs:[0m
[30;1m546 | [0m[35m    - `g` - the graph to debug, assumed to come from dynamo's pre-dispatch trace and have torch IR[0m
[30;1m547 | [0m[35m    - `target_folder` - the folder to save metadata and microbenchmarks to, note that all folder[0m
[30;1m548 | [0m[35m      content is overwritten every time the script is run. The contents of this folder will be:[0m
[30;1m549 | [0m[35m        target_folder/[0m
[30;1m550 | [0m[35m          debug_logs_0.txt[0m
[30;1m551 | [0m[35m          skip_logs_0.txt[0m

[31m--[ [0m[34mMatch #[0m[33m343[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/subgraph_utils/extract_subgraphs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m470 | [0m[35m        assert n.meta is not None and n.meta != {}, f"{n}.meta is {n.meta}!"[0m
[30;1m471 | [0m[35m[0m
[30;1m472 | [0m[35m    test_inputs = [][0m
[30;1m473 | [0m[35m    for node in new_g.nodes:[0m
[30;1m474 | [0m[35m        if node.op != "placeholder":[0m
[30;1m475 | [0m[35m            continue[0m
[30;1m476 | [0m[35m        meta = get_meta_val(node)[0m

[31m--[ [0m[34mMatch #[0m[33m344[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/subgraph_utils/extract_subgraphs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m463 | [0m[35m        new_gm.recompile()[0m
[30;1m464 | [0m[35m        # print(f'after new output, {new_gm}')[0m
[30;1m465 | [0m[35m[0m
[30;1m466 | [0m[35m    # ensure every node has metas[0m
[30;1m467 | [0m[35m    for n in new_g.nodes:[0m
[30;1m468 | [0m[35m        if n.op == "output":[0m
[30;1m469 | [0m[35m            continue[0m

[31m--[ [0m[34mMatch #[0m[33m345[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/subgraph_utils/extract_subgraphs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m272 | [0m[35m    # before: input -> linear[0m
[30;1m273 | [0m[35m    # after: input_args -> prev_op -> linear[0m
[30;1m274 | [0m[35m[0m
[30;1m275 | [0m[35m    # add the node inputs as placeholders, and copy the non-node inputs as is[0m
[30;1m276 | [0m[35m    prev_old_arg_to_new_arg = {}[0m
[30;1m277 | [0m[35m[0m
[30;1m278 | [0m[35m    def prev_node_map_arg(old_arg):[0m

[31m--[ [0m[34mMatch #[0m[33m346[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/subgraph_utils/extract_subgraphs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m267 | [0m[35m    new_linear_node.args[0].meta = old_linear_node.args[0].meta[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m    #[0m
[30;1m270 | [0m[35m    # step 1: add the preceding activation node[0m
[30;1m271 | [0m[35m    #[0m
[30;1m272 | [0m[35m    # before: input -> linear[0m
[30;1m273 | [0m[35m    # after: input_args -> prev_op -> linear[0m
[30;1m274 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m347[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/subgraph_utils/extract_subgraphs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m221 | [0m[35m    Input: a GraphModule with a `linear_node` calling `linear_mod`.[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m    This function does the following:[0m
[30;1m224 | [0m[35m    * find the subgraph prev_op -> linear_node -> [*next_ops][0m
[30;1m225 | [0m[35m    * create a new GraphModule containing this subgraph[0m
[30;1m226 | [0m[35m    * save it to disk for further debugging[0m
[30;1m227 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m348[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/subgraph_utils/extract_subgraphs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m131 | [0m[35m    for prev_n in linear_node.all_input_nodes:[0m
[30;1m132 | [0m[35m        if prev_n.op == "placeholder":[0m
[30;1m133 | [0m[35m            continue[0m
[30;1m134 | [0m[35m        # to get the shape of the input, we need to look at the previous node[0m
[30;1m135 | [0m[35m        for prev_prev_n in prev_n.all_input_nodes:[0m
[30;1m136 | [0m[35m            prev_prev_meta = get_meta_val(prev_prev_n)[0m
[30;1m137 | [0m[35m            if isinstance(prev_prev_meta, tuple):[0m
[30;1m138 | [0m[35m                prev_input_shape = ",".join(str(x.shape) for x in prev_prev_meta)[0m

[31m--[ [0m[34mMatch #[0m[33m349[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/subgraph_utils/extract_subgraphs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35m      'torch.cat'[0m
[30;1m47 | [0m[35m    """[0m
[30;1m48 | [0m[35m    if hasattr(torch_fn, "__name__"):[0m
[30;1m49 | [0m[35m        # torch.cat -> cat[0m
[30;1m50 | [0m[35m        if hasattr(torch, torch_fn.__name__):[0m
[30;1m51 | [0m[35m            if getattr(torch, torch_fn.__name__) == torch_fn:[0m
[30;1m52 | [0m[35m                return torch_fn.__name__[0m
[30;1m53 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m350[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/subgraph_utils/extract_subgraphs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35m    """[0m
[30;1m40 | [0m[35m    Tries to format things like[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m      '<built-in method cat of type object at 0x7f3f7a202c60>'[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m    as[0m
[30;1m45 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m351[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/subgraph_utils/extract_subgraphs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35m# A model can have multiple regions torch.compile'd separately. Because we currently[0m
[30;1m31 | [0m[35m# depend on torch._inductor.config.pre_grad_custom_pass, that means we will run[0m
[30;1m32 | [0m[35m# the extraction logic once per torch.compile'd region. The variable below tracks[0m
[30;1m33 | [0m[35m# how many times we have called the top level subgraph extractor, so we can[0m
[30;1m34 | [0m[35m# save results from each run without overwriting data.[0m
[30;1m35 | [0m[35mDEBUG_LINEARS_CALL_COUNTER = 0[0m
[30;1m36 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m352[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/subgraph_utils/extract_subgraphs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mgraph_tabular_log = torch._logging.getArtifactLogger(__name__, "graph")[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m# TODO(future): might be nice to have input shapes here, but needs a refactor since[0m
[30;1m18 | [0m[35m# they are easiest to get from the subgraph extraction function, but currently summary[0m
[30;1m19 | [0m[35m# is generated from the subgraph debug function.[0m
[30;1m20 | [0m[35msummary_headers = [[0m

[31m--[ [0m[34mMatch #[0m[33m353[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/autoround/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m166 | [0m[35m        customized_msg (string, optional): The parameter passed to decorator. Defaults to None.[0m
[30;1m167 | [0m[35m    """[0m
[30;1m168 | [0m[35m    import logging[0m
[30;1m169 | [0m[35m    import time[0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35m    def f(func):[0m
[30;1m172 | [0m[35m        def fi(*args, **kwargs):[0m
[30;1m173 | [0m[35m            start = time.time()[0m

[31m--[ [0m[34mMatch #[0m[33m354[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/autoround/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35m[0m
[30;1m162 | [0m[35mdef dump_elapsed_time(customized_msg="", record=False):[0m
[30;1m163 | [0m[35m    """Get the elapsed time for decorated functions.[0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35m    Args:[0m
[30;1m166 | [0m[35m        customized_msg (string, optional): The parameter passed to decorator. Defaults to None.[0m

[31m--[ [0m[34mMatch #[0m[33m355[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/float8nocompile/float8nocompile_linear.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m122 | [0m[35mclass matmul_with_args_in_hp(torch.autograd.Function):[0m
[30;1m123 | [0m[35m    """FP8 matmul with args in high precision to be used in a region without AC.[0m
[30;1m124 | [0m[35m    FP8 tensors only needed for backward are computed as part of kernels in the forward pass,[0m
[30;1m125 | [0m[35m    to reduce number of kernel dispatches and increase throughput, at the cost of higher[0m
[30;1m126 | [0m[35m    peak memory usage."""[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    @staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m356[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/float8nocompile/float8nocompile_linear.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m    def __init__(self, *args, **kwargs):[0m
[30;1m36 | [0m[35m        """[0m
[30;1m37 | [0m[35m        Additional arguments on top of `torch.nn.Linear`'s arguments:[0m
[30;1m38 | [0m[35m        * `config`: Float8LinearConfig[0m
[30;1m39 | [0m[35m        """[0m
[30;1m40 | [0m[35m        self.config = kwargs.pop("config")[0m

[31m--[ [0m[34mMatch #[0m[33m357[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/pruner/match_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35m    matched_node_pattern: List[Node],[0m
[30;1m49 | [0m[35m) -> Optional[List[Node]]:[0m
[30;1m50 | [0m[35m    r"""[0m
[30;1m51 | [0m[35m    This function will return the matched nodes if the pattern matches the node given[0m
[30;1m52 | [0m[35m    If there is no match, it will return None[0m
[30;1m53 | [0m[35m    """[0m
[30;1m54 | [0m[35m    if isinstance(pattern, tuple):[0m

[31m--[ [0m[34mMatch #[0m[33m358[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/pruner/match_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m    modules: Dict[str, nn.ModuleDict], node: Node, current: Union[nn.Module, Any][0m
[30;1m23 | [0m[35m) -> bool:[0m
[30;1m24 | [0m[35m    r"""[0m
[30;1m25 | [0m[35m    checks to see if a single node of a pattern matches[0m
[30;1m26 | [0m[35m    """[0m
[30;1m27 | [0m[35m    if isinstance(current, type) and issubclass(current, MatchAllNode):[0m
[30;1m28 | [0m[35m        return True[0m

[31m--[ [0m[34mMatch #[0m[33m359[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/pruner/match_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14 | [0m[35mfrom torch.ao.quantization.utils import ([0m
[30;1m15 | [0m[35m    MatchAllNode,[0m
[30;1m16 | [0m[35m)[0m
[30;1m17 | [0m[35mfrom torch.fx import Node[0m
[30;1m18 | [0m[35mfrom torch.nn.utils import parametrize[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35mdef _match([0m

[31m--[ [0m[34mMatch #[0m[33m360[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/utils/amg.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m332 | [0m[35m    """[0m
[30;1m333 | [0m[35m    Computes the stability score for a batch of masks. The stability[0m
[30;1m334 | [0m[35m    score is the IoU between the binary masks obtained by thresholding[0m
[30;1m335 | [0m[35m    the predicted mask logits at high and low values.[0m
[30;1m336 | [0m[35m    """[0m
[30;1m337 | [0m[35m    # One mask is always contained inside the other.[0m
[30;1m338 | [0m[35m    # Save memory by preventing unnecessary cast to torch.int64[0m

[31m--[ [0m[34mMatch #[0m[33m361[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/utils/amg.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m142 | [0m[35m    orig_box_torch: torch.Tensor,[0m
[30;1m143 | [0m[35m    atol: float = 20.0,[0m
[30;1m144 | [0m[35m) -> torch.Tensor:[0m
[30;1m145 | [0m[35m    """Filter masks at the edge of a crop, but not at the edge of the original image."""[0m
[30;1m146 | [0m[35m    boxes = uncrop_boxes_xyxy(boxes, crop_box).float()[0m
[30;1m147 | [0m[35m    near_crop_edge = torch.isclose(boxes, crop_box_torch[None, :], atol=atol, rtol=0)[0m
[30;1m148 | [0m[35m    near_image_edge = torch.isclose(boxes, orig_box_torch[None, :], atol=atol, rtol=0)[0m

[31m--[ [0m[34mMatch #[0m[33m362[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/utils/amg.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m142 | [0m[35m    orig_box_torch: torch.Tensor,[0m
[30;1m143 | [0m[35m    atol: float = 20.0,[0m
[30;1m144 | [0m[35m) -> torch.Tensor:[0m
[30;1m145 | [0m[35m    """Filter masks at the edge of a crop, but not at the edge of the original image."""[0m
[30;1m146 | [0m[35m    boxes = uncrop_boxes_xyxy(boxes, crop_box).float()[0m
[30;1m147 | [0m[35m    near_crop_edge = torch.isclose(boxes, crop_box_torch[None, :], atol=atol, rtol=0)[0m
[30;1m148 | [0m[35m    near_image_edge = torch.isclose(boxes, orig_box_torch[None, :], atol=atol, rtol=0)[0m

[31m--[ [0m[34mMatch #[0m[33m363[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/utils/amg.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m494 | [0m[35m    else:[0m
[30;1m495 | [0m[35m        masks = masks.unsqueeze(0)[0m
[30;1m496 | [0m[35m[0m
[30;1m497 | [0m[35m    # Get top and bottom edges[0m
[30;1m498 | [0m[35m    in_height, _ = torch.max(masks, dim=-1)[0m
[30;1m499 | [0m[35m    in_height_coords = in_height * torch.arange(h, device=in_height.device)[None, :][0m
[30;1m500 | [0m[35m    bottom_edges, _ = torch.max(in_height_coords, dim=-1)[0m

[31m--[ [0m[34mMatch #[0m[33m364[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/utils/amg.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m272 | [0m[35m    with torch.autograd.profiler.record_function([0m
[30;1m273 | [0m[35m        "mask_to_rle_pytorch_2: _mask_to_rle_pytorch_2_0_0"[0m
[30;1m274 | [0m[35m    ):[0m
[30;1m275 | [0m[35m        diff = _mask_to_rle_pytorch_2_0_0(tensor)[0m
[30;1m276 | [0m[35m    with torch.autograd.profiler.record_function("mask_to_rle_pytorch_2: nonzero"):[0m
[30;1m277 | [0m[35m        # NOTE: While we could operate on less chunks, a set number of chunks prevents recompilation[0m
[30;1m278 | [0m[35m        # if diff.numel() > 2147483646:[0m

[31m--[ [0m[34mMatch #[0m[33m365[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/utils/amg.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m240 | [0m[35m    #     # a = a.to(diff.device)[0m
[30;1m241 | [0m[35m    a = a.expand_as(diff.narrow(1, 0, 1))[0m
[30;1m242 | [0m[35m    diff = torch.cat([a, diff, a], dim=1)[0m
[30;1m243 | [0m[35m    return diff[0m
[30;1m244 | [0m[35m[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m# @torch.compile(fullgraph=True, dynamic=True)[0m
[30;1m247 | [0m[35mdef _mask_to_rle_pytorch_2_0_1([0m

[31m--[ [0m[34mMatch #[0m[33m366[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/utils/amg.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m239 | [0m[35m    #     a = a.pin_memory().cuda()[0m
[30;1m240 | [0m[35m    #     # a = a.to(diff.device)[0m
[30;1m241 | [0m[35m    a = a.expand_as(diff.narrow(1, 0, 1))[0m
[30;1m242 | [0m[35m    diff = torch.cat([a, diff, a], dim=1)[0m
[30;1m243 | [0m[35m    return diff[0m
[30;1m244 | [0m[35m[0m
[30;1m245 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m367[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/utils/amg.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m232 | [0m[35m    tensor = tensor.permute(0, 2, 1).flatten(1)[0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35m    # Compute change indices[0m
[30;1m235 | [0m[35m    diff = tensor[:, 1:] ^ tensor[:, :-1][0m
[30;1m236 | [0m[35m    # a = torch.tensor([[True]])[0m
[30;1m237 | [0m[35m    a = torch.ones((1, 1), dtype=bool, device=diff.device)[0m
[30;1m238 | [0m[35m    # if diff.is_cuda:[0m

[31m--[ [0m[34mMatch #[0m[33m368[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/utils/amg.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m186 | [0m[35m    tensor = tensor.permute(0, 2, 1).flatten(1)[0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35m    # Compute change indices[0m
[30;1m189 | [0m[35m    diff = tensor[:, 1:] ^ tensor[:, :-1][0m
[30;1m190 | [0m[35m    change_indices = diff.nonzero()[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m    # Encode run length[0m

[31m--[ [0m[34mMatch #[0m[33m369[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/spinquant/hadamard_utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m90 | [0m[35m@register_custom_op_abstract("torchao::hadamard_transform")[0m
[30;1m91 | [0m[35mdef _(x: torch.Tensor, scale: float = 1.0) -> torch.Tensor:[0m
[30;1m92 | [0m[35m    torch._check([0m
[30;1m93 | [0m[35m        x.dim() >= 1, lambda: f"input should be at least a 1D tensor, got {x.dim()}D"[0m
[30;1m94 | [0m[35m    )[0m
[30;1m95 | [0m[35m    return torch.empty_like(x)[0m
[30;1m96 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m370[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantized_training/int8.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m284 | [0m[35m[0m
[30;1m285 | [0m[35m    # TODO: handle pin_memory kwarg?[0m
[30;1m286 | [0m[35m    device = kwargs.get("device", args[0].device)[0m
[30;1m287 | [0m[35m    dtype = kwargs.get("dtype", args[0].dtype)[0m
[30;1m288 | [0m[35m    int_data = torch.zeros(size, device=device, dtype=torch.int8)[0m
[30;1m289 | [0m[35m    scale = torch.zeros(size[0], device=device, dtype=dtype)[0m
[30;1m290 | [0m[35m    return Int8QuantizedTrainingLinearWeight(int_data, scale)[0m

[31m--[ [0m[34mMatch #[0m[33m371[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantized_training/int8.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m283 | [0m[35m        raise NotImplementedError[0m
[30;1m284 | [0m[35m[0m
[30;1m285 | [0m[35m    # TODO: handle pin_memory kwarg?[0m
[30;1m286 | [0m[35m    device = kwargs.get("device", args[0].device)[0m
[30;1m287 | [0m[35m    dtype = kwargs.get("dtype", args[0].dtype)[0m
[30;1m288 | [0m[35m    int_data = torch.zeros(size, device=device, dtype=torch.int8)[0m
[30;1m289 | [0m[35m    scale = torch.zeros(size[0], device=device, dtype=dtype)[0m

[31m--[ [0m[34mMatch #[0m[33m372[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantized_training/int8.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m219 | [0m[35m@implements(aten.zeros_like.default)[0m
[30;1m220 | [0m[35mdef _(func, types, args, kwargs):[0m
[30;1m221 | [0m[35m    dtype = kwargs.get("dtype", args[0].dtype)[0m
[30;1m222 | [0m[35m    device = kwargs.get("device", args[0].device)[0m
[30;1m223 | [0m[35m    return torch.zeros(args[0].shape, dtype=dtype, device=device)[0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m373[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantized_training/int8.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m218 | [0m[35m# to make training work with existing PyTorch optimizers, we return a normal tensor[0m
[30;1m219 | [0m[35m@implements(aten.zeros_like.default)[0m
[30;1m220 | [0m[35mdef _(func, types, args, kwargs):[0m
[30;1m221 | [0m[35m    dtype = kwargs.get("dtype", args[0].dtype)[0m
[30;1m222 | [0m[35m    device = kwargs.get("device", args[0].device)[0m
[30;1m223 | [0m[35m    return torch.zeros(args[0].shape, dtype=dtype, device=device)[0m
[30;1m224 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m374[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantized_training/int8.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m207 | [0m[35m    # only perform dtype casting on scale, which determines the appearance dtype[0m
[30;1m208 | [0m[35m    # TODO: handle non_blocking kwarg?[0m
[30;1m209 | [0m[35m    device = kwargs.get("device", None)[0m
[30;1m210 | [0m[35m    dtype = kwargs.get("dtype", None)[0m
[30;1m211 | [0m[35m    out = Int8QuantizedTrainingLinearWeight([0m
[30;1m212 | [0m[35m        args[0].int_data.to(device=device),[0m
[30;1m213 | [0m[35m        args[0].scale.to(device=device, dtype=dtype),[0m

[31m--[ [0m[34mMatch #[0m[33m375[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantized_training/int8.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m206 | [0m[35mdef _(func, types, args, kwargs):[0m
[30;1m207 | [0m[35m    # only perform dtype casting on scale, which determines the appearance dtype[0m
[30;1m208 | [0m[35m    # TODO: handle non_blocking kwarg?[0m
[30;1m209 | [0m[35m    device = kwargs.get("device", None)[0m
[30;1m210 | [0m[35m    dtype = kwargs.get("dtype", None)[0m
[30;1m211 | [0m[35m    out = Int8QuantizedTrainingLinearWeight([0m
[30;1m212 | [0m[35m        args[0].int_data.to(device=device),[0m

[31m--[ [0m[34mMatch #[0m[33m376[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantized_training/int8.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m263 | [0m[35m@implements(aten.split.Tensor)[0m
[30;1m264 | [0m[35mdef _(func, types, args, kwargs):[0m
[30;1m265 | [0m[35m    if len(args) == 3 and args[2] != 0:[0m
[30;1m266 | [0m[35m        raise NotImplementedError("Int8QTLinearWeight only supports split at dim=0")[0m
[30;1m267 | [0m[35m[0m
[30;1m268 | [0m[35m    int8_weight: Int8QuantizedTrainingLinearWeight = args[0][0m
[30;1m269 | [0m[35m    int_data_list = func(int8_weight.int_data, *args[1:], **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m377[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantized_training/int8.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m75 | [0m[35m    @torch._dynamo.disable[0m
[30;1m76 | [0m[35m    def __init__(self, int_data: Tensor, scale: Tensor):[0m
[30;1m77 | [0m[35m        """Create a symmetric quantized INT8 weight. This tensor will appear to have the same dtype[0m
[30;1m78 | [0m[35m        as `scale.dtype`. All in-place update ops will perform stochastic rounding.[0m
[30;1m79 | [0m[35m        """[0m
[30;1m80 | [0m[35m        # NOTE: should scale always be FP32?[0m
[30;1m81 | [0m[35m        assert int_data.dtype is torch.int8[0m

[31m--[ [0m[34mMatch #[0m[33m378[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/module_swap/quantizers.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m335 | [0m[35m        # Avoid division by zero[0m
[30;1m336 | [0m[35m        counts = counts.unsqueeze(1).clamp(min=1.0)[0m
[30;1m337 | [0m[35m[0m
[30;1m338 | [0m[35m        # Update each centroid with the average of assigned inputs[0m
[30;1m339 | [0m[35m        codebook.copy_(sums / counts)[0m
[30;1m340 | [0m[35m[0m
[30;1m341 | [0m[35m        quantized = codebook[indices].view_as(inputs)[0m

[31m--[ [0m[34mMatch #[0m[33m379[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/optim/adam.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m132 | [0m[35m                        state["step"],[0m
[30;1m133 | [0m[35m                        state["exp_avg"],[0m
[30;1m134 | [0m[35m                        state["exp_avg_sq"],[0m
[30;1m135 | [0m[35m                        state.get("max_exp_avg_sq", None),[0m
[30;1m136 | [0m[35m                        group["lr"],[0m
[30;1m137 | [0m[35m                        group["betas"][0],[0m
[30;1m138 | [0m[35m                        group["betas"][1],[0m

[31m--[ [0m[34mMatch #[0m[33m380[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/optim/adam.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m174 | [0m[35m    bias_correction1 = 1 - beta1**step[0m
[30;1m175 | [0m[35m    bias_correction2 = 1 - beta2**step[0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m    # keep high precision copy for param update[0m
[30;1m178 | [0m[35m    exp_avg_f32 = exp_avg.float().lerp(grad_f32, 1 - beta1)[0m
[30;1m179 | [0m[35m    exp_avg_sq_f32 = exp_avg_sq.float().lerp(grad_f32.square(), 1 - beta2)[0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35m    exp_avg.copy_(exp_avg_f32)[0m

[31m--[ [0m[34mMatch #[0m[33m381[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/optim/adam.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m                    if not isinstance(group["lr"], Tensor):[0m
[30;1m120 | [0m[35m                        raise RuntimeError([0m
[30;1m121 | [0m[35m                            "lr was changed to a non-Tensor object. If you want to update lr, please[0m
[30;1m122 | [0m[35m                            "optim.param_groups[0]['lr'].fill_(new_lr)"[0m
[30;1m123 | [0m[35m                        )[0m
[30;1m124 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m382[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/optim/adam.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m37 | [0m[35m        if not 0.0 <= betas[0] < 1.0:[0m
[30;1m38 | [0m[35m            raise ValueError("Invalid beta parameter at index 0: {}".format(betas[0]))[0m
[30;1m39 | [0m[35m        if not 0.0 <= betas[1] < 1.0:[0m
[30;1m40 | [0m[35m            raise ValueError("Invalid beta parameter at index 1: {}".format(betas[1]))[0m
[30;1m41 | [0m[35m        defaults = dict([0m
[30;1m42 | [0m[35m            lr=torch.tensor(lr),[0m
[30;1m43 | [0m[35m            betas=betas,[0m

[31m--[ [0m[34mMatch #[0m[33m383[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/optim/adam.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m35 | [0m[35m        if not 0.0 <= eps:[0m
[30;1m36 | [0m[35m            raise ValueError("Invalid epsilon value: {}".format(eps))[0m
[30;1m37 | [0m[35m        if not 0.0 <= betas[0] < 1.0:[0m
[30;1m38 | [0m[35m            raise ValueError("Invalid beta parameter at index 0: {}".format(betas[0]))[0m
[30;1m39 | [0m[35m        if not 0.0 <= betas[1] < 1.0:[0m
[30;1m40 | [0m[35m            raise ValueError("Invalid beta parameter at index 1: {}".format(betas[1]))[0m
[30;1m41 | [0m[35m        defaults = dict([0m

[31m--[ [0m[34mMatch #[0m[33m384[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/codebook/codebook_ops.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m373 | [0m[35m    for i in range(input.dim()):[0m
[30;1m374 | [0m[35m        assert ([0m
[30;1m375 | [0m[35m            input_size[i] % block_size[i] == 0[0m
[30;1m376 | [0m[35m        ), f"Input size at dim {i} ({input_size[i]}) must be divisible by block_size[i] ({block_size[0m
[30;1m377 | [0m[35m        reshaped_dims.extend([input_size[i] // block_size[i], block_size[i]])[0m
[30;1m378 | [0m[35m[0m
[30;1m379 | [0m[35m    input_reshaped = input.view(*reshaped_dims)  # Shape: [g1, b1, g2, b2, ..., gD, bD][0m

[31m--[ [0m[34mMatch #[0m[33m385[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/codebook/codebook_ops.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m261 | [0m[35m    :param check_every: check for convergence (allclose(new_centroids, old_centroids)) once in this [0m
[30;1m262 | [0m[35m    :param rtol: early stopping relative tolerance for centroids[0m
[30;1m263 | [0m[35m    :param atol: early stopping absolute tolerance for centroids[0m
[30;1m264 | [0m[35m    :param block_size_vals: how many dot products to compute at a time[0m
[30;1m265 | [0m[35m    :param devices: if specified, run kmeans in data-parallel mode across these devices[0m
[30;1m266 | [0m[35m    :return: (clusters float[k, dim], data_indices int[nsamples], reconstructed_data: float[nsamples[0m
[30;1m267 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m386[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/codebook/codebook_ops.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m257 | [0m[35m    code modified from: https://github.com/Vahe1994/AQLM/blob/main/src/kmeans.py not sure if I shoul[0m
[30;1m258 | [0m[35m    :param data: [nsamples, dim][0m
[30;1m259 | [0m[35m    :param k: number of centroids[0m
[30;1m260 | [0m[35m    :param max_iter: run at most this many iterations[0m
[30;1m261 | [0m[35m    :param check_every: check for convergence (allclose(new_centroids, old_centroids)) once in this [0m
[30;1m262 | [0m[35m    :param rtol: early stopping relative tolerance for centroids[0m
[30;1m263 | [0m[35m    :param atol: early stopping absolute tolerance for centroids[0m

[31m--[ [0m[34mMatch #[0m[33m387[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/codebook/codebook_ops.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m27 | [0m[35m        input (torch.Tensor): Input tensor to quantize, shape (d1, d2, ..., dN).[0m
[30;1m28 | [0m[35m        codebook (torch.Tensor): Codebook tensor for quantization, shape (k, b1, b2, ..., bN) where [0m
[30;1m29 | [0m[35m        scales (torch.Tensor): Scales, shape (d1, d2, ..., dN // scale_block_size, 1).[0m
[30;1m30 | [0m[35m        chunk_size (int): Number of elements to process per chunk to control memory usage.[0m
[30;1m31 | [0m[35m        code_dtype (torch.dtype): dtype for the codes.[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    Output:[0m

[31m--[ [0m[34mMatch #[0m[33m388[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/codebook/codebook_ops.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m261 | [0m[35m    :param check_every: check for convergence (allclose(new_centroids, old_centroids)) once in this [0m
[30;1m262 | [0m[35m    :param rtol: early stopping relative tolerance for centroids[0m
[30;1m263 | [0m[35m    :param atol: early stopping absolute tolerance for centroids[0m
[30;1m264 | [0m[35m    :param block_size_vals: how many dot products to compute at a time[0m
[30;1m265 | [0m[35m    :param devices: if specified, run kmeans in data-parallel mode across these devices[0m
[30;1m266 | [0m[35m    :return: (clusters float[k, dim], data_indices int[nsamples], reconstructed_data: float[nsamples[0m
[30;1m267 | [0m[35m    """[0m
[30;1m268 | [0m[35m    if devices is None:[0m

[31m--[ [0m[34mMatch #[0m[33m389[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/codebook/codebook_ops.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m77 | [0m[35m        input_chunk = input_flat[chunk_start:chunk_end][0m
[30;1m78 | [0m[35m        input_chunk = input_chunk[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m        # Compute distances and find nearest codebook entries for the chunk[0m
[30;1m81 | [0m[35m        distances = torch.addmm([0m
[30;1m82 | [0m[35m            torch.bmm(codebook_flat[:, None, :], codebook_flat[:, :, None]).flatten(),[0m
[30;1m83 | [0m[35m            input_chunk,[0m

[31m--[ [0m[34mMatch #[0m[33m390[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/float8/float8_tensor_parallel.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m178 | [0m[35m    so that if there are multiple float8 users of the input activation, we perform fp8 allgather[0m
[30;1m179 | [0m[35m    only once.[0m
[30;1m180 | [0m[35m    FP8 Args:[0m
[30;1m181 | [0m[35m      float8_dtype (torch.dtype, optional): control what float8 dtype to cast to when prepare the mo[0m
[30;1m182 | [0m[35m          we currently only support torch.float8_e4m3fn. default: torch.float8_e4m3fn[0m
[30;1m183 | [0m[35m      fwd_config_submodule_fqn (str, optional): the fqn of the submodule that contains the forward c[0m
[30;1m184 | [0m[35m          for the float8 cast. If not specified, we will search for the Float8Linear in the submodul[0m

[31m--[ [0m[34mMatch #[0m[33m391[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/awq/example.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m209 | [0m[35m        quant_dtype = getattr(torch, quant_dtype, torch.bfloat16)[0m
[30;1m210 | [0m[35m        print(f"running {quant_dtype} calibration")[0m
[30;1m211 | [0m[35m        t0 = time.time()[0m
[30;1m212 | [0m[35m        # insert observers to find average magnitude and calculate scales[0m
[30;1m213 | [0m[35m        insert_awq_observer_([0m
[30;1m214 | [0m[35m            model,[0m
[30;1m215 | [0m[35m            validation_size,[0m

[31m--[ [0m[34mMatch #[0m[33m392[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/awq/example.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m# This source code is licensed under the BSD 3-Clause license found in the[0m
[30;1m5 | [0m[35m# LICENSE file in the root directory of this source tree.[0m
[30;1m6 | [0m[35mimport argparse[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mimport torch[0m
[30;1m10 | [0m[35mfrom datasets import load_dataset[0m
[30;1m11 | [0m[35mfrom tqdm import tqdm[0m

[31m--[ [0m[34mMatch #[0m[33m393[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/low_bit_optim/subclass_4bit.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m149 | [0m[35m@OptimState4bit.implements(aten._to_copy.default)[0m
[30;1m150 | [0m[35mdef _(func, types, args, kwargs):[0m
[30;1m151 | [0m[35m    # ignore dtype[0m
[30;1m152 | [0m[35m    device = kwargs.get("device", None)[0m
[30;1m153 | [0m[35m    out = OptimState4bit([0m
[30;1m154 | [0m[35m        args[0].codes.to(device=device),[0m
[30;1m155 | [0m[35m        args[0].scale.to(device=device),[0m

[31m--[ [0m[34mMatch #[0m[33m394[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/mx_formats/mx_tensor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m315 | [0m[35m        # need to reshape at the end to help inductor fuse things[0m
[30;1m316 | [0m[35m        data_lp = data_lp.reshape(orig_shape)[0m
[30;1m317 | [0m[35m    elif elem_dtype == DTYPE_FP4:[0m
[30;1m318 | [0m[35m        # can't reshape at the end without handling it in the packing code,[0m
[30;1m319 | [0m[35m        # punt until later since we'll need to rethink the torch.compile[0m
[30;1m320 | [0m[35m        # approach for fp4x2 in any case[0m
[30;1m321 | [0m[35m        data_lp = data_lp.reshape(orig_shape)[0m

[31m--[ [0m[34mMatch #[0m[33m395[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/mx_formats/mx_tensor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m312 | [0m[35m        if pack_fp6:[0m
[30;1m313 | [0m[35m            orig_shape = [*orig_shape[:-1], 3 * orig_shape[-1] // 4][0m
[30;1m314 | [0m[35m            data_lp = pack_uint6(data_lp)[0m
[30;1m315 | [0m[35m        # need to reshape at the end to help inductor fuse things[0m
[30;1m316 | [0m[35m        data_lp = data_lp.reshape(orig_shape)[0m
[30;1m317 | [0m[35m    elif elem_dtype == DTYPE_FP4:[0m
[30;1m318 | [0m[35m        # can't reshape at the end without handling it in the packing code,[0m

[31m--[ [0m[34mMatch #[0m[33m396[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/mx_formats/mx_tensor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m305 | [0m[35m        if pack_fp6:[0m
[30;1m306 | [0m[35m            orig_shape = [*orig_shape[:-1], 3 * orig_shape[-1] // 4][0m
[30;1m307 | [0m[35m            data_lp = pack_uint6(data_lp)[0m
[30;1m308 | [0m[35m        # need to reshape at the end to help inductor fuse things[0m
[30;1m309 | [0m[35m        data_lp = data_lp.reshape(orig_shape)[0m
[30;1m310 | [0m[35m    elif elem_dtype == DTYPE_FP6_E3M2:[0m
[30;1m311 | [0m[35m        data_lp = f32_to_f6_e3m2_unpacked(data_lp)[0m

[31m--[ [0m[34mMatch #[0m[33m397[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/mx_formats/mx_tensor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m298 | [0m[35m    # cast to target dtype[0m
[30;1m299 | [0m[35m    if elem_dtype in (torch.float8_e4m3fn, torch.float8_e5m2):[0m
[30;1m300 | [0m[35m        data_lp = data_lp.to(elem_dtype)[0m
[30;1m301 | [0m[35m        # need to reshape at the end to help inductor fuse things[0m
[30;1m302 | [0m[35m        data_lp = data_lp.reshape(orig_shape)[0m
[30;1m303 | [0m[35m    elif elem_dtype == DTYPE_FP6_E2M3:[0m
[30;1m304 | [0m[35m        data_lp = f32_to_f6_e2m3_unpacked(data_lp)[0m

[31m--[ [0m[34mMatch #[0m[33m398[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/mx_formats/mx_tensor.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m181 | [0m[35m[0m
[30;1m182 | [0m[35m    # Set X to be the largest power-of-two less than or equal to[0m
[30;1m183 | [0m[35m    # max_abs(v), divided by the largest power of two representable[0m
[30;1m184 | [0m[35m    # in the element data type, and get the mbits at the same time[0m
[30;1m185 | [0m[35m    if elem_dtype == torch.float8_e4m3fn:[0m
[30;1m186 | [0m[35m        target_max_pow2 = F8E4M3_MAX_POW2[0m
[30;1m187 | [0m[35m        mbits = MBITS_F8_E4M3[0m

[31m--[ [0m[34mMatch #[0m[33m399[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/mx_formats/mx_tensor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m484 | [0m[35m            # Note: `is_contiguous` is going to return True for a tensor of size[0m
[30;1m485 | [0m[35m            # (M, 1) regardless or the order of dims, so this logic is currently[0m
[30;1m486 | [0m[35m            # broken for tensors of size (M, 1) or (1, M). Leaving broken until[0m
[30;1m487 | [0m[35m            # a time when fixing this becomes important.[0m
[30;1m488 | [0m[35m            new_size = tensor_size_fp4x2_to_hp([0m
[30;1m489 | [0m[35m                new_size,[0m
[30;1m490 | [0m[35m                data_bits.is_contiguous(),[0m

[31m--[ [0m[34mMatch #[0m[33m400[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/mx_formats/mx_tensor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m332 | [0m[35mdef get_fp_scale(scale_e8m0):[0m
[30;1m333 | [0m[35m    scale_e8m0 = scale_e8m0.view(torch.uint8)[0m
[30;1m334 | [0m[35m    s_offset = scale_e8m0.to(torch.int16) - E8M0_EXPONENT_BIAS[0m
[30;1m335 | [0m[35m    # TODO(later): it would be nice if there was a way to do the 2^x operation[0m
[30;1m336 | [0m[35m    # in PyTorch without creating a tensor of twos[0m
[30;1m337 | [0m[35m    two = torch.full(s_offset.size(), 2.0, device=scale_e8m0.device)[0m
[30;1m338 | [0m[35m    # pow(two, s_offset) can be out of range of floating point formats.[0m

[31m--[ [0m[34mMatch #[0m[33m401[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/mx_formats/mx_tensor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m181 | [0m[35m[0m
[30;1m182 | [0m[35m    # Set X to be the largest power-of-two less than or equal to[0m
[30;1m183 | [0m[35m    # max_abs(v), divided by the largest power of two representable[0m
[30;1m184 | [0m[35m    # in the element data type, and get the mbits at the same time[0m
[30;1m185 | [0m[35m    if elem_dtype == torch.float8_e4m3fn:[0m
[30;1m186 | [0m[35m        target_max_pow2 = F8E4M3_MAX_POW2[0m
[30;1m187 | [0m[35m        mbits = MBITS_F8_E4M3[0m
[30;1m188 | [0m[35m        max_pos = F8E4M3_MAX[0m

[31m--[ [0m[34mMatch #[0m[33m402[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/mx_formats/mx_tensor.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m169 | [0m[35m    orig_shape = data_hp.shape[0m
[30;1m170 | [0m[35m    data_hp = data_hp.reshape(-1, block_size)[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m    # find max value of the data[0m
[30;1m173 | [0m[35m    # Note: this only implements the `minimally supported` version of[0m
[30;1m174 | [0m[35m    # https://www.opencompute.org/documents/ocp-microscaling-formats-mx-v1-0-spec-final-pdf[0m
[30;1m175 | [0m[35m    # section 6.3.[0m

[31m--[ [0m[34mMatch #[0m[33m403[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/common/profiling_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m213 | [0m[35m][0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m[0m
[30;1m216 | [0m[35m# cuda_time, cpu_time are avg times -- corresponds to CUDA time avg and CPU time avg in table() abov[0m
[30;1m217 | [0m[35m# "self" times is not meaningful for annotated regions, since they only have child regions[0m
[30;1m218 | [0m[35mdef is_function(obj):[0m
[30;1m219 | [0m[35m    return isinstance(obj, types.FunctionType)[0m

[31m--[ [0m[34mMatch #[0m[33m404[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/common/profiling_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m213 | [0m[35m][0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m[0m
[30;1m216 | [0m[35m# cuda_time, cpu_time are avg times -- corresponds to CUDA time avg and CPU time avg in table() abov[0m
[30;1m217 | [0m[35m# "self" times is not meaningful for annotated regions, since they only have child regions[0m
[30;1m218 | [0m[35mdef is_function(obj):[0m
[30;1m219 | [0m[35m    return isinstance(obj, types.FunctionType)[0m

[31m--[ [0m[34mMatch #[0m[33m405[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/common/profiling_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35mdef check(expected, actual, atol=1e-3):[0m
[30;1m31 | [0m[35m    diff = (expected - actual).abs().max()[0m
[30;1m32 | [0m[35m    print(f"diff: {diff}")[0m
[30;1m33 | [0m[35m    # assert diff < atol[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35mdef benchmark_mm([0m

[31m--[ [0m[34mMatch #[0m[33m406[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/common/profiling_tools.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35mdef check(expected, actual, atol=1e-3):[0m
[30;1m31 | [0m[35m    diff = (expected - actual).abs().max()[0m
[30;1m32 | [0m[35m    print(f"diff: {diff}")[0m
[30;1m33 | [0m[35m    # assert diff < atol[0m
[30;1m34 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m407[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/weight_tensor_linear_activation_quantization.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m89 | [0m[35m    ):[0m
[30;1m90 | [0m[35m        original_weight_tensor = tensor_data_dict["original_weight_tensor"][0m
[30;1m91 | [0m[35m        input_quant_func_static, quant_kwargs = tensor_attributes[0m
[30;1m92 | [0m[35m        zero_point = tensor_data_dict.get("zero_point", None)[0m
[30;1m93 | [0m[35m        return cls([0m
[30;1m94 | [0m[35m            original_weight_tensor,[0m
[30;1m95 | [0m[35m            input_quant_func_static,[0m

[31m--[ [0m[34mMatch #[0m[33m408[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/observer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m165 | [0m[35m            ), f"Can't update existing min_val - shape mismatch, self.min_val:{self.min_val.shape} ![0m
[30;1m166 | [0m[35m            assert ([0m
[30;1m167 | [0m[35m                self.max_val.shape == max_val.shape[0m
[30;1m168 | [0m[35m            ), f"Can't update existing max_val - shape mismatch, self.max_val {self.max_val.shape} ![0m
[30;1m169 | [0m[35m            min_val = torch.min(self.min_val, min_val)[0m
[30;1m170 | [0m[35m            max_val = torch.max(self.max_val, max_val)[0m
[30;1m171 | [0m[35m            self.min_val.copy_(min_val)[0m

[31m--[ [0m[34mMatch #[0m[33m409[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/observer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m162 | [0m[35m        else:[0m
[30;1m163 | [0m[35m            assert ([0m
[30;1m164 | [0m[35m                self.min_val.shape == min_val.shape[0m
[30;1m165 | [0m[35m            ), f"Can't update existing min_val - shape mismatch, self.min_val:{self.min_val.shape} ![0m
[30;1m166 | [0m[35m            assert ([0m
[30;1m167 | [0m[35m                self.max_val.shape == max_val.shape[0m
[30;1m168 | [0m[35m            ), f"Can't update existing max_val - shape mismatch, self.max_val {self.max_val.shape} ![0m

[31m--[ [0m[34mMatch #[0m[33m410[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/observer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m    Args:[0m
[30;1m93 | [0m[35m      `granularity` and `block_size`: The granularity of the quantization,[0m
[30;1m94 | [0m[35m        must specify at least one, if both are specified `block_size` takes precedence[0m
[30;1m95 | [0m[35m        Current supported granularity type are `PerTensor` and `PerAxis`[0m
[30;1m96 | [0m[35m      other args: please see `:class:torchao.dtypes.AffineQuantizedTensor`[0m
[30;1m97 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m411[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/modeling/backbones/hieradet.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m195 | [0m[35m        q_stride: Tuple[int, int] = (2, 2),  # downsample stride bet. stages[0m
[30;1m196 | [0m[35m        stages: Tuple[int, ...] = (2, 3, 16, 3),  # blocks per stage[0m
[30;1m197 | [0m[35m        dim_mul: float = 2.0,  # dim_mul factor at stage shift[0m
[30;1m198 | [0m[35m        head_mul: float = 2.0,  # head_mul factor at stage shift[0m
[30;1m199 | [0m[35m        window_pos_embed_bkg_spatial_size: Tuple[int, int] = (14, 14),[0m
[30;1m200 | [0m[35m        # window size per stage, when not using global att.[0m
[30;1m201 | [0m[35m        window_spec: Tuple[int, ...] = ([0m

[31m--[ [0m[34mMatch #[0m[33m412[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/modeling/backbones/hieradet.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m194 | [0m[35m        q_pool: int = 3,  # number of q_pool stages[0m
[30;1m195 | [0m[35m        q_stride: Tuple[int, int] = (2, 2),  # downsample stride bet. stages[0m
[30;1m196 | [0m[35m        stages: Tuple[int, ...] = (2, 3, 16, 3),  # blocks per stage[0m
[30;1m197 | [0m[35m        dim_mul: float = 2.0,  # dim_mul factor at stage shift[0m
[30;1m198 | [0m[35m        head_mul: float = 2.0,  # head_mul factor at stage shift[0m
[30;1m199 | [0m[35m        window_pos_embed_bkg_spatial_size: Tuple[int, int] = (14, 14),[0m
[30;1m200 | [0m[35m        # window size per stage, when not using global att.[0m

[31m--[ [0m[34mMatch #[0m[33m413[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/modeling/backbones/hieradet.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m59 | [0m[35m        # q, k, v with shape (B, H * W, nheads, C)[0m
[30;1m60 | [0m[35m        q, k, v = torch.unbind(qkv, 2)[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m        # Q pooling (for downsample at stage changes)[0m
[30;1m63 | [0m[35m        if self.q_pool:[0m
[30;1m64 | [0m[35m            q = do_pool(q.reshape(B, H, W, -1), self.q_pool)[0m
[30;1m65 | [0m[35m            H, W = q.shape[1:3]  # downsampled shape[0m

[31m--[ [0m[34mMatch #[0m[33m414[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/modeling/backbones/hieradet.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m73 | [0m[35m            k_chunks = k.chunk(num_chunks)[0m
[30;1m74 | [0m[35m            v_chunks = v.chunk(num_chunks)[0m
[30;1m75 | [0m[35m            x_chunks = [][0m
[30;1m76 | [0m[35m            for qi, ki, vi in zip(q_chunks, k_chunks, v_chunks):[0m
[30;1m77 | [0m[35m                xi = F.scaled_dot_product_attention([0m
[30;1m78 | [0m[35m                    qi.transpose(1, 2),[0m
[30;1m79 | [0m[35m                    ki.transpose(1, 2),[0m

[31m--[ [0m[34mMatch #[0m[33m415[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/hqq/kernels.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m213 | [0m[35m    per mainloop iteration.[0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m    In the transposed case, A is M x N and B is K x N, and we reduce along "N":[0m
[30;1m216 | [0m[35m    - TLDR: we are loading rows of A and B blocks at a time, dequantizing and transposing each block[0m
[30;1m217 | [0m[35m    effect of a transposed matmul. This is necessary to perform a transposed matmul without unpackin[0m
[30;1m218 | [0m[35m        - Indexing remains the same for A (the reduction dim (BLK_K / K) corresponds to axis 1 of A [0m
[30;1m219 | [0m[35m            - We load a BLK_M x BLK_K block of A[0m

[31m--[ [0m[34mMatch #[0m[33m416[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/hqq/kernels.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mimport triton.language as tl[0m
[30;1m8 | [0m[35mfrom triton import Config[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m# TODO: add early config prune and estimate_matmul_time to reduce autotuning time[0m
[30;1m11 | [0m[35m# from triton.ops.matmul_perf_model import early_config_prune, estimate_matmul_time[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mdef get_configs_io_bound():[0m

[31m--[ [0m[34mMatch #[0m[33m417[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/smoothquant/example.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m137 | [0m[35m        print(f"Time to load model: {time.time() - t0:.02f} seconds")[0m
[30;1m138 | [0m[35m        print("running calibration")[0m
[30;1m139 | [0m[35m        t0 = time.time()[0m
[30;1m140 | [0m[35m        # insert observers to find average magnitude and calculate scales[0m
[30;1m141 | [0m[35m        insert_smooth_quant_observer_(model, alpha, quant_mode)[0m
[30;1m142 | [0m[35m        calibration_data = get_calib_dataset([0m
[30;1m143 | [0m[35m            tokenizer=tokenizer, n_samples=calibration_size, block_size=sequence_length[0m

[31m--[ [0m[34mMatch #[0m[33m418[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/smoothquant/example.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35m# LICENSE file in the root directory of this source tree.[0m
[30;1m6 | [0m[35mimport argparse[0m
[30;1m7 | [0m[35mimport os[0m
[30;1m8 | [0m[35mimport time[0m
[30;1m9 | [0m[35mfrom typing import Optional[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mimport torch[0m
[30;1m12 | [0m[35mfrom datasets import load_dataset[0m

[31m--[ [0m[34mMatch #[0m[33m419[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/parq/optim/quantopt.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m108 | [0m[35m    def regularized_param_groups(self):  # pyre-ignore[3][0m
[30;1m109 | [0m[35m        """Yield parameter groups that need to be quantized."""[0m
[30;1m110 | [0m[35m        for group in self.param_groups:[0m
[30;1m111 | [0m[35m            if group.get("quant_bits", 16) < 16:[0m
[30;1m112 | [0m[35m                yield group[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m    @torch._disable_dynamo[0m

[31m--[ [0m[34mMatch #[0m[33m420[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/parq/optim/quantopt.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m178 | [0m[35m                    p.div_(gamma)[0m
[30;1m179 | [0m[35m[0m
[30;1m180 | [0m[35m                # quantization by channel or by layer[0m
[30;1m181 | [0m[35m                # update quantization targets periodically[0m
[30;1m182 | [0m[35m                per_channel = self.quant_per_channel and p.dim() > 1[0m
[30;1m183 | [0m[35m                if quant_update:[0m
[30;1m184 | [0m[35m                    quants_size = 3 if b == 0 else 2**b[0m

[31m--[ [0m[34mMatch #[0m[33m421[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/parq/optim/quantopt.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m154 | [0m[35m            # qat: restore latent params for update by the base optimizer[0m
[30;1m155 | [0m[35m            self.restore_latent_params()[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m        # check if it is time to update set of quantization values Q[0m
[30;1m158 | [0m[35m        if (self.num_steps - self.warmup_steps) % self.quant_period == 0:[0m
[30;1m159 | [0m[35m            quant_update = True[0m
[30;1m160 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m422[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/parq/optim/quantopt.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m151 | [0m[35m            # first step of qat, save latent params, instead of restore[0m
[30;1m152 | [0m[35m            self.save_latent_params()[0m
[30;1m153 | [0m[35m        else:[0m
[30;1m154 | [0m[35m            # qat: restore latent params for update by the base optimizer[0m
[30;1m155 | [0m[35m            self.restore_latent_params()[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m        # check if it is time to update set of quantization values Q[0m

[31m--[ [0m[34mMatch #[0m[33m423[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/parq/optim/quantopt.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m144 | [0m[35m            self.num_steps += 1[0m
[30;1m145 | [0m[35m            return loss[0m
[30;1m146 | [0m[35m[0m
[30;1m147 | [0m[35m        # call base optimizer step() method to update latent parameters[0m
[30;1m148 | [0m[35m        loss = self.base_optimizer.step(closure=closure)  # pyre-ignore[6][0m
[30;1m149 | [0m[35m[0m
[30;1m150 | [0m[35m        if self.num_steps == self.warmup_steps:[0m

[31m--[ [0m[34mMatch #[0m[33m424[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/parq/optim/quantopt.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m98 | [0m[35m        """Optionally update the quantization targets `quants` in place.[0m
[30;1m99 | [0m[35m        Return the quantized `p` as a by-product if `quant_update=True`.[0m
[30;1m100 | [0m[35m        """[0m
[30;1m101 | [0m[35m        if quant_update:  # update Q for each channel[0m
[30;1m102 | [0m[35m            q, Q = quantizer.quantize(p, b, dim=dim)  # pyre-ignore[28][0m
[30;1m103 | [0m[35m            quants.copy_(Q)[0m
[30;1m104 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m425[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/parq/optim/quantopt.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m95 | [0m[35m        quant_update: bool,[0m
[30;1m96 | [0m[35m        dim: Optional[int] = None,[0m
[30;1m97 | [0m[35m    ) -> Optional[Tensor]:[0m
[30;1m98 | [0m[35m        """Optionally update the quantization targets `quants` in place.[0m
[30;1m99 | [0m[35m        Return the quantized `p` as a by-product if `quant_update=True`.[0m
[30;1m100 | [0m[35m        """[0m
[30;1m101 | [0m[35m        if quant_update:  # update Q for each channel[0m

[31m--[ [0m[34mMatch #[0m[33m426[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/parq/optim/quantopt.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m70 | [0m[35m            if self.anneal_wd_frac > 0:[0m
[30;1m71 | [0m[35m                group["initial_wd"] = group["weight_decay"][0m
[30;1m72 | [0m[35m        # NOTE: Filling state dict here cause Adam(W) error, which assumes[0m
[30;1m73 | [0m[35m        # empty state[p] at first step() where optimizer states are initialized[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    def __getattribute__(self, name: str):[0m
[30;1m76 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m427[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/parq/optim/quantopt.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m29 | [0m[35m    a quantizer (e.g., UnifQuantizer, LSBQuantizer, LearnedScale)[0m
[30;1m30 | [0m[35m        - update target quantization values for model parameters[0m
[30;1m31 | [0m[35m    a proximal mapping (e.g, HardQuant/STE, PARQ, BinaryRelax)[0m
[30;1m32 | [0m[35m        - update model parameters based on the above two updates[0m
[30;1m33 | [0m[35m    Other parameters:[0m
[30;1m34 | [0m[35m        - warmup_steps: int > 0[0m
[30;1m35 | [0m[35m        - quant_period: int > 0[0m

[31m--[ [0m[34mMatch #[0m[33m428[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/parq/optim/quantopt.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m27 | [0m[35m    a base optimizer (e.g., SGD or AdamW)[0m
[30;1m28 | [0m[35m        - update the latent variables for QAT[0m
[30;1m29 | [0m[35m    a quantizer (e.g., UnifQuantizer, LSBQuantizer, LearnedScale)[0m
[30;1m30 | [0m[35m        - update target quantization values for model parameters[0m
[30;1m31 | [0m[35m    a proximal mapping (e.g, HardQuant/STE, PARQ, BinaryRelax)[0m
[30;1m32 | [0m[35m        - update model parameters based on the above two updates[0m
[30;1m33 | [0m[35m    Other parameters:[0m

[31m--[ [0m[34mMatch #[0m[33m429[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/parq/optim/quantopt.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m25 | [0m[35mclass QuantOptimizer(Optimizer):[0m
[30;1m26 | [0m[35m    """QuantOptimizer assembles functionalities of the following objects:[0m
[30;1m27 | [0m[35m    a base optimizer (e.g., SGD or AdamW)[0m
[30;1m28 | [0m[35m        - update the latent variables for QAT[0m
[30;1m29 | [0m[35m    a quantizer (e.g., UnifQuantizer, LSBQuantizer, LearnedScale)[0m
[30;1m30 | [0m[35m        - update target quantization values for model parameters[0m
[30;1m31 | [0m[35m    a proximal mapping (e.g, HardQuant/STE, PARQ, BinaryRelax)[0m

[31m--[ [0m[34mMatch #[0m[33m430[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/parq/optim/quantopt.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m154 | [0m[35m            # qat: restore latent params for update by the base optimizer[0m
[30;1m155 | [0m[35m            self.restore_latent_params()[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m        # check if it is time to update set of quantization values Q[0m
[30;1m158 | [0m[35m        if (self.num_steps - self.warmup_steps) % self.quant_period == 0:[0m
[30;1m159 | [0m[35m            quant_update = True[0m
[30;1m160 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m431[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/spinquant/spinquant.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m215 | [0m[35m[0m
[30;1m216 | [0m[35m[0m
[30;1m217 | [0m[35mdef _add_activation_wrappers_r4(model):[0m
[30;1m218 | [0m[35m    """Modify the forward pass to rotate the activations at specific points."""[0m
[30;1m219 | [0m[35m    # eval_utils/main.py:36[0m
[30;1m220 | [0m[35m    had_K, K = get_hadK(model.config.intermediate_size)[0m
[30;1m221 | [0m[35m    # print(f"K: {K}")[0m

[31m--[ [0m[34mMatch #[0m[33m432[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/uintx/plain_layout.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m97 | [0m[35m        int_data, scale, zero_point = ([0m
[30;1m98 | [0m[35m            tensor_data_dict["int_data"],[0m
[30;1m99 | [0m[35m            tensor_data_dict["scale"],[0m
[30;1m100 | [0m[35m            tensor_data_dict.get("zero_point", None),[0m
[30;1m101 | [0m[35m        )[0m
[30;1m102 | [0m[35m        (_layout,) = tensor_attributes[0m
[30;1m103 | [0m[35m        return cls(int_data, scale, zero_point, _layout)[0m

[31m--[ [0m[34mMatch #[0m[33m433[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/uintx/plain_layout.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m66 | [0m[35m        kwargs = {}[0m
[30;1m67 | [0m[35m        kwargs["device"] = int_data.device[0m
[30;1m68 | [0m[35m        kwargs["layout"] = ([0m
[30;1m69 | [0m[35m            kwargs.get("layout") if kwargs.get("layout", False) else int_data.layout[0m
[30;1m70 | [0m[35m        )[0m
[30;1m71 | [0m[35m        kwargs["dtype"] = int_data.dtype[0m
[30;1m72 | [0m[35m        kwargs["requires_grad"] = False[0m

[31m--[ [0m[34mMatch #[0m[33m434[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/uintx/plain_layout.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m66 | [0m[35m        kwargs = {}[0m
[30;1m67 | [0m[35m        kwargs["device"] = int_data.device[0m
[30;1m68 | [0m[35m        kwargs["layout"] = ([0m
[30;1m69 | [0m[35m            kwargs.get("layout") if kwargs.get("layout", False) else int_data.layout[0m
[30;1m70 | [0m[35m        )[0m
[30;1m71 | [0m[35m        kwargs["dtype"] = int_data.dtype[0m
[30;1m72 | [0m[35m        kwargs["requires_grad"] = False[0m

[31m--[ [0m[34mMatch #[0m[33m435[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/dtypes/uintx/plain_layout.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m299 | [0m[35m        *x_vals_int8.shape[:-1], y_dot_scaled.shape[-1][0m
[30;1m300 | [0m[35m    )[0m
[30;1m301 | [0m[35m[0m
[30;1m302 | [0m[35m    # can downcast only at the very end[0m
[30;1m303 | [0m[35m    output_dtype = input_tensor.dtype[0m
[30;1m304 | [0m[35m    y = y.to(output_dtype)[0m
[30;1m305 | [0m[35m    if bias is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m436[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/mx_formats/mx_ops.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m111 | [0m[35m        # emulated MX gemm[0m
[30;1m112 | [0m[35m        a_hp = a.to_dtype(a._orig_dtype)[0m
[30;1m113 | [0m[35m        b_hp = b.to_dtype(b._orig_dtype)[0m
[30;1m114 | [0m[35m        # assert memory layout we expect to be required in hardware[0m
[30;1m115 | [0m[35m        assert a_hp.is_contiguous()[0m
[30;1m116 | [0m[35m        assert b_hp.t().is_contiguous()[0m
[30;1m117 | [0m[35m        res = aten_op(a_hp, b_hp)[0m

[31m--[ [0m[34mMatch #[0m[33m437[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/low_bit_optim/subclass_8bit.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m133 | [0m[35m@OptimState8bit.implements(aten._to_copy.default)[0m
[30;1m134 | [0m[35mdef _(func, types, args, kwargs):[0m
[30;1m135 | [0m[35m    # ignore dtype[0m
[30;1m136 | [0m[35m    device = kwargs.get("device", None)[0m
[30;1m137 | [0m[35m    out = OptimState8bit([0m
[30;1m138 | [0m[35m        args[0].codes.to(device=device),[0m
[30;1m139 | [0m[35m        args[0].scale.to(device=device),[0m

[31m--[ [0m[34mMatch #[0m[33m438[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/galore/kernels/custom_autotune.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m82 | [0m[35m        if prune_configs_by:[0m
[30;1m83 | [0m[35m            self.perf_model = prune_configs_by.get("perf_model", self.perf_model)[0m
[30;1m84 | [0m[35m            self.configs_top_k = prune_configs_by.get("top_k", self.configs_top_k)[0m
[30;1m85 | [0m[35m            self.early_config_prune = prune_configs_by.get([0m
[30;1m86 | [0m[35m                "early_config_prune", self.early_config_prune[0m
[30;1m87 | [0m[35m            )[0m
[30;1m88 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m439[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/galore/kernels/custom_autotune.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m        self.early_config_prune = None[0m
[30;1m82 | [0m[35m        if prune_configs_by:[0m
[30;1m83 | [0m[35m            self.perf_model = prune_configs_by.get("perf_model", self.perf_model)[0m
[30;1m84 | [0m[35m            self.configs_top_k = prune_configs_by.get("top_k", self.configs_top_k)[0m
[30;1m85 | [0m[35m            self.early_config_prune = prune_configs_by.get([0m
[30;1m86 | [0m[35m                "early_config_prune", self.early_config_prune[0m
[30;1m87 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m440[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/galore/kernels/custom_autotune.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m80 | [0m[35m        self.configs_top_k = 1.0[0m
[30;1m81 | [0m[35m        self.early_config_prune = None[0m
[30;1m82 | [0m[35m        if prune_configs_by:[0m
[30;1m83 | [0m[35m            self.perf_model = prune_configs_by.get("perf_model", self.perf_model)[0m
[30;1m84 | [0m[35m            self.configs_top_k = prune_configs_by.get("top_k", self.configs_top_k)[0m
[30;1m85 | [0m[35m            self.early_config_prune = prune_configs_by.get([0m
[30;1m86 | [0m[35m                "early_config_prune", self.early_config_prune[0m

[31m--[ [0m[34mMatch #[0m[33m441[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/galore/kernels/custom_autotune.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m340 | [0m[35m    :type restore_value: list[str][0m
[30;1m341 | [0m[35m    :param warmup: Warmup time (in ms) to pass to benchmarking, defaults to 25.[0m
[30;1m342 | [0m[35m    :type warmup: int[0m
[30;1m343 | [0m[35m    :param rep: Repetition time (in ms) to pass to benchmarking, defaults to 100.[0m
[30;1m344 | [0m[35m    :type rep: int[0m
[30;1m345 | [0m[35m    """[0m
[30;1m346 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m442[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/galore/kernels/custom_autotune.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m338 | [0m[35m    :type reset_to_zero: list[str][0m
[30;1m339 | [0m[35m    :param restore_value: a list of argument names whose value will be restored after evaluating any[0m
[30;1m340 | [0m[35m    :type restore_value: list[str][0m
[30;1m341 | [0m[35m    :param warmup: Warmup time (in ms) to pass to benchmarking, defaults to 25.[0m
[30;1m342 | [0m[35m    :type warmup: int[0m
[30;1m343 | [0m[35m    :param rep: Repetition time (in ms) to pass to benchmarking, defaults to 100.[0m
[30;1m344 | [0m[35m    :type rep: int[0m

[31m--[ [0m[34mMatch #[0m[33m443[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/galore/kernels/custom_autotune.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m331 | [0m[35m whose change in value will trigger the evaluation of all provided configs.[0m
[30;1m332 | [0m[35m    :type key: list[str][0m
[30;1m333 | [0m[35m    :param prune_configs_by: a dict of functions that are used to prune configs, fields:[0m
[30;1m334 | [0m[35m        'perf_model': performance model used to predicate running time with different configs, retur[0m
[30;1m335 | [0m[35m        'top_k': number of configs to bench[0m
[30;1m336 | [0m[35m        'early_config_prune'(optional): a function used to do early prune (eg, num_stages). It takes[0m

[31m--[ [0m[34mMatch #[0m[33m444[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/galore/kernels/custom_autotune.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m330 | [0m[35mfig][0m
[30;1m331 | [0m[35m    :param key: a list of argument names whose change in value will trigger the evaluation of all pr[0m
[30;1m332 | [0m[35m    :type key: list[str][0m
[30;1m333 | [0m[35m    :param prune_configs_by: a dict of functions that are used to prune configs, fields:[0m
[30;1m334 | [0m[35m        'perf_model': performance model used to predicate running time with different configs, retur[0m
[30;1m335 | [0m[35m        'top_k': number of configs to bench[0m
[30;1m336 | [0m[35m        'early_config_prune'(optional): a function used to do early prune (eg, num_stages). It takes[0m

[31m--[ [0m[34mMatch #[0m[33m445[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/galore/kernels/custom_autotune.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m    ):[0m
[30;1m36 | [0m[35m        """[0m
[30;1m37 | [0m[35m        :param prune_configs_by: a dict of functions that are used to prune configs, fields:[0m
[30;1m38 | [0m[35m            'perf_model': performance model used to predicate running time with different configs, r[0m
[30;1m39 | [0m[35m            'top_k': number of configs to bench[0m
[30;1m40 | [0m[35m            'prune_num_stages_by'(optional): a function used to prune num_stages. It takes configs:L[0m
[30;1m41 | [0m[35m        """[0m
[30;1m42 | [0m[35m        if not configs:[0m

[31m--[ [0m[34mMatch #[0m[33m446[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/galore/kernels/custom_autotune.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m    ):[0m
[30;1m36 | [0m[35m        """[0m
[30;1m37 | [0m[35m        :param prune_configs_by: a dict of functions that are used to prune configs, fields:[0m
[30;1m38 | [0m[35m            'perf_model': performance model used to predicate running time with different configs, r[0m
[30;1m39 | [0m[35m            'top_k': number of configs to bench[0m
[30;1m40 | [0m[35m            'prune_num_stages_by'(optional): a function used to prune num_stages. It takes configs:L[0m
[30;1m41 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m447[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/galore/kernels/custom_autotune.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35mimport builtins[0m
[30;1m9 | [0m[35mimport logging[0m
[30;1m10 | [0m[35mimport os[0m
[30;1m11 | [0m[35mimport time[0m
[30;1m12 | [0m[35mfrom typing import Dict[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mimport numpy as np[0m
[30;1m15 | [0m[35mfrom triton.runtime.cache import default_cache_dir[0m

[31m--[ [0m[34mMatch #[0m[33m448[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/mx_formats/custom_cast.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m356 | [0m[35m        # save the sign[0m
[30;1m357 | [0m[35m        sign_f6 = x & sign_mask_f6[0m
[30;1m358 | [0m[35m[0m
[30;1m359 | [0m[35m        # set everything to positive, will add sign back at the end[0m
[30;1m360 | [0m[35m        x_pos = x ^ sign_f6[0m
[30;1m361 | [0m[35m[0m
[30;1m362 | [0m[35m        # shift the exponent and mantissa[0m

[31m--[ [0m[34mMatch #[0m[33m449[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/mx_formats/custom_cast.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m147 | [0m[35m        # save the sign[0m
[30;1m148 | [0m[35m        sign_f4 = x & sign_mask_f4[0m
[30;1m149 | [0m[35m[0m
[30;1m150 | [0m[35m        # set everything to positive, will add sign back at the end[0m
[30;1m151 | [0m[35m        x_pos = x ^ sign_f4[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m        # Special case zero[0m

[31m--[ [0m[34mMatch #[0m[33m450[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/mx_formats/custom_cast.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m# TODO(future): if needed, make the below work on previous PyTorch versions,[0m
[30;1m20 | [0m[35m# just need to hunt down the previous location of `libdevice`. An assert[0m
[30;1m21 | [0m[35m# at the callsite prevents usage of this on unsupported versions.[0m
[30;1m22 | [0m[35mif TORCH_VERSION_AT_LEAST_2_4 and has_triton():[0m
[30;1m23 | [0m[35m    from torch._inductor.runtime.triton_helpers import libdevice[0m
[30;1m24 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m451[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/mx_formats/custom_cast.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1253 | [0m[35m        # Calculate the absolute values of elements in the block[0m
[30;1m1254 | [0m[35m        x_block_abs_t_r = tl.abs(x_block_t_r)[0m
[30;1m1255 | [0m[35m[0m
[30;1m1256 | [0m[35m        # Find the maximum absolute value for each column[0m
[30;1m1257 | [0m[35m        # shape: (COL_TILE_SIZE * BLOCKS_PER_ROW_TILE,)[0m
[30;1m1258 | [0m[35m        col_scale_r, col_scale_e8m0_r = _triton_calculate_scale(x_block_abs_t_r, axis=1)[0m
[30;1m1259 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m452[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/mx_formats/custom_cast.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1105 | [0m[35m        # We use a small epsilon to avoid division by zero[0m
[30;1m1106 | [0m[35m        epsilon = 1e-10[0m
[30;1m1107 | [0m[35m[0m
[30;1m1108 | [0m[35m        # Find the maximum absolute value for each row[0m
[30;1m1109 | [0m[35m        max_abs = tl.max(x, axis=axis)[0m
[30;1m1110 | [0m[35m[0m
[30;1m1111 | [0m[35m        # Calculate the e8m0 scale by extracting the exponent (floor)[0m

[31m--[ [0m[34mMatch #[0m[33m453[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/mx_formats/custom_cast.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m987 | [0m[35m    # Shift elements down 4 and select out the bottom 4 bits[0m
[30;1m988 | [0m[35m    #[0m
[30;1m989 | [0m[35m    # Note: known slow with triton[0m
[30;1m990 | [0m[35m    # * currently generates two kernels with a cat in between[0m
[30;1m991 | [0m[35m    # * after https://github.com/pytorch/pytorch/pull/123278 lands I[0m
[30;1m992 | [0m[35m    #   verified that we get a single triton kernel, but that is even slower[0m
[30;1m993 | [0m[35m    #   than the two kernels before this PR[0m

[31m--[ [0m[34mMatch #[0m[33m454[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/mx_formats/custom_cast.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35mdef get_bits(x: torch.Tensor) -> str:[0m
[30;1m36 | [0m[35m    bits_per_byte = 8[0m
[30;1m37 | [0m[35m    # Numpy has a nice function to get the string representation of binary.[0m
[30;1m38 | [0m[35m    # Since we are using ints as views of floats, need to specify the width[0m
[30;1m39 | [0m[35m    # to avoid numpy from using two's complement for negative numbers.[0m
[30;1m40 | [0m[35m    return np.binary_repr(x.cpu().numpy(), width=x.element_size() * bits_per_byte)  # noqa: E501[0m

[31m--[ [0m[34mMatch #[0m[33m455[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/subclass.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35m            kwargs.get("layout") if kwargs.get("layout", False) else int_data.layout[0m
[30;1m46 | [0m[35m        )[0m
[30;1m47 | [0m[35m        assert "dtype" in kwargs[0m
[30;1m48 | [0m[35m        assert not kwargs.get("requires_grad", False)[0m
[30;1m49 | [0m[35m        kwargs["requires_grad"] = False[0m
[30;1m50 | [0m[35m        return torch.Tensor._make_wrapper_subclass(cls, shape, **kwargs)  # type: ignore[attr-define[0m
[30;1m51 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m456[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/subclass.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m    def __new__(cls, int_data, transposed, shape, *args, **kwargs):[0m
[30;1m43 | [0m[35m        kwargs["device"] = int_data.device[0m
[30;1m44 | [0m[35m        kwargs["layout"] = ([0m
[30;1m45 | [0m[35m            kwargs.get("layout") if kwargs.get("layout", False) else int_data.layout[0m
[30;1m46 | [0m[35m        )[0m
[30;1m47 | [0m[35m        assert "dtype" in kwargs[0m
[30;1m48 | [0m[35m        assert not kwargs.get("requires_grad", False)[0m

[31m--[ [0m[34mMatch #[0m[33m457[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/subclass.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m    def __new__(cls, int_data, transposed, shape, *args, **kwargs):[0m
[30;1m43 | [0m[35m        kwargs["device"] = int_data.device[0m
[30;1m44 | [0m[35m        kwargs["layout"] = ([0m
[30;1m45 | [0m[35m            kwargs.get("layout") if kwargs.get("layout", False) else int_data.layout[0m
[30;1m46 | [0m[35m        )[0m
[30;1m47 | [0m[35m        assert "dtype" in kwargs[0m
[30;1m48 | [0m[35m        assert not kwargs.get("requires_grad", False)[0m

[31m--[ [0m[34mMatch #[0m[33m458[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/mixed_precision/scripts/BO_acc_modelsize.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m"""[0m
[30;1m195 | [0m[35mThis function will run BO trials in parallel on multiple GPUs.[0m
[30;1m196 | [0m[35mEach time the BO gets multiple new trials, evaluates the trials on the GPUs and return the evaluatio[0m
[30;1m197 | [0m[35mMultiple trials, one BO update.[0m
[30;1m198 | [0m[35m"""[0m
[30;1m199 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m459[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/mixed_precision/scripts/BO_acc_modelsize.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m"""[0m
[30;1m83 | [0m[35mThis function will run BO trials sequentially on a single GPU.[0m
[30;1m84 | [0m[35mEach time the BO gets one new trial, evaluates the trial on the GPU and return the evaluation result[0m
[30;1m85 | [0m[35mOne trial, one BO update.[0m
[30;1m86 | [0m[35mTODO: refactor the sequential BO and parallel BO into a single function[0m
[30;1m87 | [0m[35m"""[0m

[31m--[ [0m[34mMatch #[0m[33m460[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/mixed_precision/scripts/BO_acc_modelsize.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m"""[0m
[30;1m195 | [0m[35mThis function will run BO trials in parallel on multiple GPUs.[0m
[30;1m196 | [0m[35mEach time the BO gets multiple new trials, evaluates the trials on the GPUs and return the evaluatio[0m
[30;1m197 | [0m[35mMultiple trials, one BO update.[0m
[30;1m198 | [0m[35m"""[0m
[30;1m199 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m461[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/quantization/mixed_precision/scripts/BO_acc_modelsize.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m"""[0m
[30;1m83 | [0m[35mThis function will run BO trials sequentially on a single GPU.[0m
[30;1m84 | [0m[35mEach time the BO gets one new trial, evaluates the trial on the GPU and return the evaluation result[0m
[30;1m85 | [0m[35mOne trial, one BO update.[0m
[30;1m86 | [0m[35mTODO: refactor the sequential BO and parallel BO into a single function[0m
[30;1m87 | [0m[35m"""[0m

[31m--[ [0m[34mMatch #[0m[33m462[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/modeling/sam2_base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m618 | [0m[35m                    if t < 0 or (num_frames is not None and t >= num_frames):[0m
[30;1m619 | [0m[35m                        break[0m
[30;1m620 | [0m[35m                    out = output_dict["non_cond_frame_outputs"].get([0m
[30;1m621 | [0m[35m                        t, unselected_cond_outputs.get(t, None)[0m
[30;1m622 | [0m[35m                    )[0m
[30;1m623 | [0m[35m                    if out is not None:[0m
[30;1m624 | [0m[35m                        pos_and_ptrs.append((t_diff, out["obj_ptr"]))[0m

[31m--[ [0m[34mMatch #[0m[33m463[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/modeling/sam2_base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m617 | [0m[35m                    t = frame_idx + t_diff if track_in_reverse else frame_idx - t_diff[0m
[30;1m618 | [0m[35m                    if t < 0 or (num_frames is not None and t >= num_frames):[0m
[30;1m619 | [0m[35m                        break[0m
[30;1m620 | [0m[35m                    out = output_dict["non_cond_frame_outputs"].get([0m
[30;1m621 | [0m[35m                        t, unselected_cond_outputs.get(t, None)[0m
[30;1m622 | [0m[35m                    )[0m
[30;1m623 | [0m[35m                    if out is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m464[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/modeling/sam2_base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m568 | [0m[35m                if out is None:[0m
[30;1m569 | [0m[35m                    # If an unselected conditioning frame is among the last (self.num_maskmem - 1)[0m
[30;1m570 | [0m[35m                    # frames, we still attend to it as if it's a non-conditioning frame.[0m
[30;1m571 | [0m[35m                    out = unselected_cond_outputs.get(prev_frame_idx, None)[0m
[30;1m572 | [0m[35m                t_pos_and_prevs.append((t_pos, out))[0m
[30;1m573 | [0m[35m[0m
[30;1m574 | [0m[35m            for t_pos, prev in t_pos_and_prevs:[0m

[31m--[ [0m[34mMatch #[0m[33m465[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/modeling/sam2_base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m564 | [0m[35m                        prev_frame_idx = -(-(frame_idx + 2) // stride) * stride[0m
[30;1m565 | [0m[35m                        # then seek further among every r-th frames[0m
[30;1m566 | [0m[35m                        prev_frame_idx = prev_frame_idx + (t_rel - 2) * stride[0m
[30;1m567 | [0m[35m                out = output_dict["non_cond_frame_outputs"].get(prev_frame_idx, None)[0m
[30;1m568 | [0m[35m                if out is None:[0m
[30;1m569 | [0m[35m                    # If an unselected conditioning frame is among the last (self.num_maskmem - 1)[0m
[30;1m570 | [0m[35m                    # frames, we still attend to it as if it's a non-conditioning frame.[0m

[31m--[ [0m[34mMatch #[0m[33m466[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/modeling/sam2_base.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m917 | [0m[35m            return pred_masks[0m
[30;1m918 | [0m[35m[0m
[30;1m919 | [0m[35m        device = pred_masks.device[0m
[30;1m920 | [0m[35m        # "max_obj_inds": object index of the object with the highest score at each location[0m
[30;1m921 | [0m[35m        max_obj_inds = torch.argmax(pred_masks, dim=0, keepdim=True)[0m
[30;1m922 | [0m[35m        # "batch_obj_inds": object index of each object slice (along dim 0) in `pred_masks`[0m
[30;1m923 | [0m[35m        batch_obj_inds = torch.arange(batch_size, device=device)[:, None, None, None][0m

[31m--[ [0m[34mMatch #[0m[33m467[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/modeling/sam2_base.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m910 | [0m[35m    def _apply_non_overlapping_constraints(self, pred_masks):[0m
[30;1m911 | [0m[35m        """[0m
[30;1m912 | [0m[35m        Apply non-overlapping constraints to the object scores in pred_masks. Here we[0m
[30;1m913 | [0m[35m        keep only the highest scoring object at each spatial location in pred_masks.[0m
[30;1m914 | [0m[35m        """[0m
[30;1m915 | [0m[35m        batch_size = pred_masks.size(0)[0m
[30;1m916 | [0m[35m        if batch_size == 1:[0m

[31m--[ [0m[34mMatch #[0m[33m468[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/modeling/sam2_base.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m622 | [0m[35m                    )[0m
[30;1m623 | [0m[35m                    if out is not None:[0m
[30;1m624 | [0m[35m                        pos_and_ptrs.append((t_diff, out["obj_ptr"]))[0m
[30;1m625 | [0m[35m                # If we have at least one object pointer, add them to the across attention[0m
[30;1m626 | [0m[35m                if len(pos_and_ptrs) > 0:[0m
[30;1m627 | [0m[35m                    pos_list, ptrs_list = zip(*pos_and_ptrs)[0m
[30;1m628 | [0m[35m                    # stack object pointers along dim=0 into [ptr_seq_len, B, C] shape[0m

[31m--[ [0m[34mMatch #[0m[33m469[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/modeling/sam2_base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m841 | [0m[35m        mask_inputs,[0m
[30;1m842 | [0m[35m        output_dict,[0m
[30;1m843 | [0m[35m        num_frames,[0m
[30;1m844 | [0m[35m        track_in_reverse=False,  # tracking in reverse time order (for demo usage)[0m
[30;1m845 | [0m[35m        # Whether to run the memory encoder on the predicted masks. Sometimes we might want[0m
[30;1m846 | [0m[35m        # to skip the memory encoder with `run_mem_encoder=False`. For example,[0m
[30;1m847 | [0m[35m        # in demo we might call `track_step` multiple times for each user click,[0m

[31m--[ [0m[34mMatch #[0m[33m470[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/modeling/sam2_base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m781 | [0m[35m                num_frames=num_frames,[0m
[30;1m782 | [0m[35m                track_in_reverse=track_in_reverse,[0m
[30;1m783 | [0m[35m            )[0m
[30;1m784 | [0m[35m            # apply SAM-style segmentation head[0m
[30;1m785 | [0m[35m            # here we might feed previously predicted low-res SAM mask logits into the SAM mask deco[0m
[30;1m786 | [0m[35m            # e.g. in demo where such logits come from earlier interaction instead of correction sam[0m
[30;1m787 | [0m[35m            # (in this case, any `mask_inputs` shouldn't reach here as they are sent to _use_mask_as[0m
[30;1m788 | [0m[35m            if prev_sam_mask_logits is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m471[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/modeling/sam2_base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m559 | [0m[35m                        # then seek further among every r-th frames[0m
[30;1m560 | [0m[35m                        prev_frame_idx = prev_frame_idx - (t_rel - 2) * stride[0m
[30;1m561 | [0m[35m                    else:[0m
[30;1m562 | [0m[35m                        # first find the nearest frame among every r-th frames after this frame[0m
[30;1m563 | [0m[35m                        # for r=1, this would be (frame_idx + 2)[0m
[30;1m564 | [0m[35m                        prev_frame_idx = -(-(frame_idx + 2) // stride) * stride[0m
[30;1m565 | [0m[35m                        # then seek further among every r-th frames[0m

[31m--[ [0m[34mMatch #[0m[33m472[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/modeling/sam2_base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m553 | [0m[35m                else:[0m
[30;1m554 | [0m[35m                    # for t_rel >= 2, we take the memory frame from every r-th frames[0m
[30;1m555 | [0m[35m                    if not track_in_reverse:[0m
[30;1m556 | [0m[35m                        # first find the nearest frame among every r-th frames before this frame[0m
[30;1m557 | [0m[35m                        # for r=1, this would be (frame_idx - 2)[0m
[30;1m558 | [0m[35m                        prev_frame_idx = ((frame_idx - 2) // stride) * stride[0m
[30;1m559 | [0m[35m                        # then seek further among every r-th frames[0m

[31m--[ [0m[34mMatch #[0m[33m473[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/modeling/sam2_base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m507 | [0m[35m        feat_sizes,[0m
[30;1m508 | [0m[35m        output_dict,[0m
[30;1m509 | [0m[35m        num_frames,[0m
[30;1m510 | [0m[35m        track_in_reverse=False,  # tracking in reverse time order (for demo usage)[0m
[30;1m511 | [0m[35m    ):[0m
[30;1m512 | [0m[35m        """Fuse the current frame's visual feature map with previous memory."""[0m
[30;1m513 | [0m[35m        B = current_vision_feats[-1].size(1)  # batch size on this frame[0m

[31m--[ [0m[34mMatch #[0m[33m474[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/modeling/memory_encoder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m63 | [0m[35m    r"""ConvNeXt Block. There are two equivalent implementations:[0m
[30;1m64 | [0m[35m    (1) DwConv -> LayerNorm (channels_first) -> 1x1 Conv -> GELU -> 1x1 Conv; all in (N, C, H, W)[0m
[30;1m65 | [0m[35m    (2) DwConv -> Permute to (N, H, W, C); LayerNorm (channels_last) -> Linear -> GELU -> Linear; Pe[0m
[30;1m66 | [0m[35m    We use (2) as we find it slightly faster in PyTorch[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m    Args:[0m
[30;1m69 | [0m[35m        dim (int): Number of input channels.[0m

[31m--[ [0m[34mMatch #[0m[33m475[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/modeling/memory_encoder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mclass MaskDownSampler(nn.Module):[0m
[30;1m18 | [0m[35m    """[0m
[30;1m19 | [0m[35m    Progressively downsample a mask by total_stride, each time by stride.[0m
[30;1m20 | [0m[35m    Note that LayerNorm is applied per *token*, like in ViT.[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m    With each downsample (by a factor stride**2), channel capacity increases by the same factor.[0m

[31m--[ [0m[34mMatch #[0m[33m476[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/low_bit_optim/adam.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m132 | [0m[35m                        state["step"],[0m
[30;1m133 | [0m[35m                        state["exp_avg"],[0m
[30;1m134 | [0m[35m                        state["exp_avg_sq"],[0m
[30;1m135 | [0m[35m                        state.get("max_exp_avg_sq", None),[0m
[30;1m136 | [0m[35m                        group["lr"],[0m
[30;1m137 | [0m[35m                        group["betas"][0],[0m
[30;1m138 | [0m[35m                        group["betas"][1],[0m

[31m--[ [0m[34mMatch #[0m[33m477[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/low_bit_optim/adam.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m174 | [0m[35m    bias_correction1 = 1 - beta1**step[0m
[30;1m175 | [0m[35m    bias_correction2 = 1 - beta2**step[0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m    # keep high precision copy for param update[0m
[30;1m178 | [0m[35m    exp_avg_f32 = exp_avg.float().lerp(grad_f32, 1 - beta1)[0m
[30;1m179 | [0m[35m    exp_avg_sq_f32 = exp_avg_sq.float().lerp(grad_f32.square(), 1 - beta2)[0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35m    exp_avg.copy_(exp_avg_f32)[0m

[31m--[ [0m[34mMatch #[0m[33m478[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/low_bit_optim/adam.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m                    if not isinstance(group["lr"], Tensor):[0m
[30;1m120 | [0m[35m                        raise RuntimeError([0m
[30;1m121 | [0m[35m                            "lr was changed to a non-Tensor object. If you want to update lr, please[0m
[30;1m122 | [0m[35m                            "optim.param_groups[0]['lr'].fill_(new_lr)"[0m
[30;1m123 | [0m[35m                        )[0m
[30;1m124 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m479[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/low_bit_optim/adam.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m37 | [0m[35m        if not 0.0 <= betas[0] < 1.0:[0m
[30;1m38 | [0m[35m            raise ValueError("Invalid beta parameter at index 0: {}".format(betas[0]))[0m
[30;1m39 | [0m[35m        if not 0.0 <= betas[1] < 1.0:[0m
[30;1m40 | [0m[35m            raise ValueError("Invalid beta parameter at index 1: {}".format(betas[1]))[0m
[30;1m41 | [0m[35m        defaults = dict([0m
[30;1m42 | [0m[35m            lr=torch.tensor(lr),[0m
[30;1m43 | [0m[35m            betas=betas,[0m

[31m--[ [0m[34mMatch #[0m[33m480[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/low_bit_optim/adam.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m35 | [0m[35m        if not 0.0 <= eps:[0m
[30;1m36 | [0m[35m            raise ValueError("Invalid epsilon value: {}".format(eps))[0m
[30;1m37 | [0m[35m        if not 0.0 <= betas[0] < 1.0:[0m
[30;1m38 | [0m[35m            raise ValueError("Invalid beta parameter at index 0: {}".format(betas[0]))[0m
[30;1m39 | [0m[35m        if not 0.0 <= betas[1] < 1.0:[0m
[30;1m40 | [0m[35m            raise ValueError("Invalid beta parameter at index 1: {}".format(betas[1]))[0m
[30;1m41 | [0m[35m        defaults = dict([0m

[31m--[ [0m[34mMatch #[0m[33m481[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/parq/quant/quantizer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m24 | [0m[35m        Outputs:[0m
[30;1m25 | [0m[35m            q (Tensor): quantized tensor of same size as p[0m
[30;1m26 | [0m[35m            Q (Tensor): set of 2^b quantization values[0m
[30;1m27 | [0m[35m        Instantiation should not modify p, leaving update to ProxMap.[0m
[30;1m28 | [0m[35m        """[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m    @staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m482[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/low_bit_optim/subclass_fp8.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m110 | [0m[35m@OptimStateFp8.implements(aten._to_copy.default)[0m
[30;1m111 | [0m[35mdef _(func, types, args, kwargs):[0m
[30;1m112 | [0m[35m    # ignore dtype[0m
[30;1m113 | [0m[35m    device = kwargs.get("device", None)[0m
[30;1m114 | [0m[35m    out = OptimStateFp8([0m
[30;1m115 | [0m[35m        args[0].codes.to(device=device),[0m
[30;1m116 | [0m[35m        args[0].scale.to(device=device),[0m

[31m--[ [0m[34mMatch #[0m[33m483[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/galore/kernels/adam_downproj_fused.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m124 | [0m[35m    exp_avg = tl.load(exp_avg_ptr + epilogue_offsets, mask=mask)[0m
[30;1m125 | [0m[35m    exp_avg2 = tl.load(exp_avg2_ptr + epilogue_offsets, mask=mask)[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m    # Perform update[0m
[30;1m128 | [0m[35m    exp_avg = BETA1 * exp_avg.to(acc.dtype) + (1.0 - BETA1) * acc[0m
[30;1m129 | [0m[35m    exp_avg2 = BETA2 * exp_avg2.to(acc.dtype) + (1.0 - BETA2) * (acc * acc)[0m
[30;1m130 | [0m[35m    denom = tl.sqrt(exp_avg2) + EPS[0m
[30;1m131 | [0m[35m    norm_grad = exp_avg / denom[0m

[31m--[ [0m[34mMatch #[0m[33m484[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/smoothquant/core.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m121 | [0m[35m            max_val_pos = torch.max(-min_val_neg, max_val_pos)[0m
[30;1m122 | [0m[35m            act_scale = max_val_pos / (float(self.quant_max - self.quant_min) / 2)[0m
[30;1m123 | [0m[35m            act_scales = act_scale.to(self.device)[0m
[30;1m124 | [0m[35m        # 4 update weight and find scales[0m
[30;1m125 | [0m[35m        self.wei_oc_obs(self.weight * smoothing_factor.to(self.device))[0m
[30;1m126 | [0m[35m        wei_scales, _ = self.wei_oc_obs.calculate_qparams()[0m
[30;1m127 | [0m[35m        # 5 return results[0m

[31m--[ [0m[34mMatch #[0m[33m485[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/smoothquant/core.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m78 | [0m[35m        return input[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m    def calculate_qparams(self):[0m
[30;1m81 | [0m[35m        # 1 Get min/max per IC from observers[0m
[30;1m82 | [0m[35m        wei_min_per_ic = self.wei_ic_obs.min_val[0m
[30;1m83 | [0m[35m        wei_max_per_ic = self.wei_ic_obs.max_val[0m
[30;1m84 | [0m[35m        act_min_per_ic = self.act_ic_obs.min_val[0m

[31m--[ [0m[34mMatch #[0m[33m486[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/smoothquant/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m121 | [0m[35m            max_val_pos = torch.max(-min_val_neg, max_val_pos)[0m
[30;1m122 | [0m[35m            act_scale = max_val_pos / (float(self.quant_max - self.quant_min) / 2)[0m
[30;1m123 | [0m[35m            act_scales = act_scale.to(self.device)[0m
[30;1m124 | [0m[35m        # 4 update weight and find scales[0m
[30;1m125 | [0m[35m        self.wei_oc_obs(self.weight * smoothing_factor.to(self.device))[0m
[30;1m126 | [0m[35m        wei_scales, _ = self.wei_oc_obs.calculate_qparams()[0m
[30;1m127 | [0m[35m        # 5 return results[0m

[31m--[ [0m[34mMatch #[0m[33m487[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/smoothquant/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m101 | [0m[35m            smoothing_factor = torch.pow(x_abs_max_per_ic, self.alpha) / torch.pow([0m
[30;1m102 | [0m[35m                w_abs_max_per_ic.to(x_abs_max_per_ic.device), 1 - self.alpha[0m
[30;1m103 | [0m[35m            )[0m
[30;1m104 | [0m[35m        # 3 apply smoothing factor to activations and find scales for static quantization[0m
[30;1m105 | [0m[35m        act_scales = None[0m
[30;1m106 | [0m[35m        if self.quant_mode == "static":[0m
[30;1m107 | [0m[35m            act_min_per_ic_new = act_min_per_ic / smoothing_factor.reshape([0m

[31m--[ [0m[34mMatch #[0m[33m488[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/smoothquant/core.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m49 | [0m[35m        self.eps = eps[0m
[30;1m50 | [0m[35m        # act.shape = [mb, ic] (reshape if needed), wei.shape = [oc, ic][0m
[30;1m51 | [0m[35m        # *_ic_obs are used to determine smoothing_factor[0m
[30;1m52 | [0m[35m        # wei_oc_obs is used to find qparams for quantization[0m
[30;1m53 | [0m[35m        self.act_ic_obs = AffineQuantizedMinMaxObserver([0m
[30;1m54 | [0m[35m            MappingType.SYMMETRIC,[0m
[30;1m55 | [0m[35m            torch.int8,[0m

[31m--[ [0m[34mMatch #[0m[33m489[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/experimental/op_lib.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m15 | [0m[35mlibs = list(lib_path.glob("libtorchao_ops_aten.*"))[0m
[30;1m16 | [0m[35massert ([0m
[30;1m17 | [0m[35m    len(libs) == 1[0m
[30;1m18 | [0m[35m), f"Expected to find one libtorchao_ops_aten.* library at {lib_path}, but found {len(libs)}"[0m
[30;1m19 | [0m[35mtorch.ops.load_library(str(libs[0]))[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m490[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/experimental/op_lib.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m15 | [0m[35mlibs = list(lib_path.glob("libtorchao_ops_aten.*"))[0m
[30;1m16 | [0m[35massert ([0m
[30;1m17 | [0m[35m    len(libs) == 1[0m
[30;1m18 | [0m[35m), f"Expected to find one libtorchao_ops_aten.* library at {lib_path}, but found {len(libs)}"[0m
[30;1m19 | [0m[35mtorch.ops.load_library(str(libs[0]))[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m491[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/utils/misc.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m340 | [0m[35m[0m
[30;1m341 | [0m[35m[0m
[30;1m342 | [0m[35mdef concat_points(old_point_inputs, new_points, new_labels):[0m
[30;1m343 | [0m[35m    """Add new points and labels to previous point inputs (add at the end)."""[0m
[30;1m344 | [0m[35m    if old_point_inputs is None:[0m
[30;1m345 | [0m[35m        points, labels = new_points, new_labels[0m
[30;1m346 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m492[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/utils/misc.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m232 | [0m[35m        jpg_folder = video_path[0m
[30;1m233 | [0m[35m    else:[0m
[30;1m234 | [0m[35m        raise NotImplementedError([0m
[30;1m235 | [0m[35m            "Only JPEG frames are supported at this moment. For video files, you may use "[0m
[30;1m236 | [0m[35m            "ffmpeg (https://ffmpeg.org/) to extract frames into a folder of JPEG files, such as \n"[0m
[30;1m237 | [0m[35m            "```\n"[0m
[30;1m238 | [0m[35m            "ffmpeg -i <your_video>.mp4 -q:v 2 -start_number 0 <output_dir>/'%05d.jpg'\n"[0m

[31m--[ [0m[34mMatch #[0m[33m493[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/utils/misc.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m207 | [0m[35m        )[0m
[30;1m208 | [0m[35m    else:[0m
[30;1m209 | [0m[35m        raise NotImplementedError([0m
[30;1m210 | [0m[35m            "Only MP4 video and JPEG folder are supported at this moment"[0m
[30;1m211 | [0m[35m        )[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m494[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/utils/misc.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m72 | [0m[35m    - masks: [B, 1, H, W] masks, dtype=torch.Tensor[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m    Returns:[0m
[30;1m75 | [0m[35m    - box_coords: [B, 1, 4], contains (x, y) coordinates of top left and bottom right box corners, d[0m
[30;1m76 | [0m[35m    """[0m
[30;1m77 | [0m[35m    B, _, h, w = masks.shape[0m
[30;1m78 | [0m[35m    device = masks.device[0m

[31m--[ [0m[34mMatch #[0m[33m495[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/__init__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m32 | [0m[35m    # The following library contains CPU kernels from torchao/experimental[0m
[30;1m33 | [0m[35m    # They are built automatically by ao/setup.py if on an ARM machine.[0m
[30;1m34 | [0m[35m    # They can also be built outside of the torchao install process by[0m
[30;1m35 | [0m[35m    # running the script `torchao/experimental/build_torchao_ops.sh <aten|executorch>`[0m
[30;1m36 | [0m[35m    # For more information, see https://github.com/pytorch/ao/blob/main/torchao/experimental/docs/re[0m
[30;1m37 | [0m[35m    from torchao.experimental.op_lib import *  # noqa: F403[0m
[30;1m38 | [0m[35mexcept Exception as e:[0m

[31m--[ [0m[34mMatch #[0m[33m496[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/superblock/train.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m473 | [0m[35m                print(f"Resumed training from epoch {args.start_epoch}.")[0m
[30;1m474 | [0m[35m            except FileNotFoundError:[0m
[30;1m475 | [0m[35m                print([0m
[30;1m476 | [0m[35m                    f"No checkpoint found at {latest_checkpoint}. Starting training from scratch."[0m
[30;1m477 | [0m[35m                )[0m
[30;1m478 | [0m[35m                args.start_epoch = 0[0m
[30;1m479 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m497[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/superblock/train.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m534 | [0m[35m[0m
[30;1m535 | [0m[35m    total_time = time.time() - start_time[0m
[30;1m536 | [0m[35m    total_time_str = str(datetime.timedelta(seconds=int(total_time)))[0m
[30;1m537 | [0m[35m    print(f"Training time {total_time_str}")[0m
[30;1m538 | [0m[35m[0m
[30;1m539 | [0m[35m[0m
[30;1m540 | [0m[35mif __name__ == "__main__":[0m

[31m--[ [0m[34mMatch #[0m[33m498[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/superblock/train.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m112 | [0m[35m            # run encoder[0m
[30;1m113 | [0m[35m            output = model(image)[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m            # measure time in encoder[0m
[30;1m116 | [0m[35m            end_event.record()[0m
[30;1m117 | [0m[35m            torch.cuda.synchronize()[0m
[30;1m118 | [0m[35m            encoder_time += start_event.elapsed_time(end_event)[0m

[31m--[ [0m[34mMatch #[0m[33m499[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/prototype/sparsity/superblock/train.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mimport datetime[0m
[30;1m4 | [0m[35mimport glob[0m
[30;1m5 | [0m[35mimport os[0m
[30;1m6 | [0m[35mimport time[0m
[30;1m7 | [0m[35mimport warnings[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mimport torch[0m
[30;1m10 | [0m[35mimport torch.utils.data[0m

[31m--[ [0m[34mMatch #[0m[33m500[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/modeling/position_encoding.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m220 | [0m[35m            freqs_cis = freqs_cis.repeat(*([1] * (freqs_cis.ndim - 2)), r, 1)[0m
[30;1m221 | [0m[35m        else:[0m
[30;1m222 | [0m[35m            # torch.repeat on complex numbers may not be supported on non-CUDA devices[0m
[30;1m223 | [0m[35m            # (freqs_cis has 4 dims and we repeat on dim 2) so we use expand + flatten[0m
[30;1m224 | [0m[35m            freqs_cis = freqs_cis.unsqueeze(2).expand(-1, -1, r, -1, -1).flatten(2, 3)[0m
[30;1m225 | [0m[35m    xk_out = torch.view_as_real(xk_ * freqs_cis).flatten(3)[0m
[30;1m226 | [0m[35m    return xq_out.type_as(xq).to(xq.device), xk_out.type_as(xk).to(xk.device)[0m

[31m--[ [0m[34mMatch #[0m[33m501[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/modeling/position_encoding.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m220 | [0m[35m            freqs_cis = freqs_cis.repeat(*([1] * (freqs_cis.ndim - 2)), r, 1)[0m
[30;1m221 | [0m[35m        else:[0m
[30;1m222 | [0m[35m            # torch.repeat on complex numbers may not be supported on non-CUDA devices[0m
[30;1m223 | [0m[35m            # (freqs_cis has 4 dims and we repeat on dim 2) so we use expand + flatten[0m
[30;1m224 | [0m[35m            freqs_cis = freqs_cis.unsqueeze(2).expand(-1, -1, r, -1, -1).flatten(2, 3)[0m
[30;1m225 | [0m[35m    xk_out = torch.view_as_real(xk_ * freqs_cis).flatten(3)[0m
[30;1m226 | [0m[35m    return xq_out.type_as(xq).to(xq.device), xk_out.type_as(xk).to(xk.device)[0m

[31m--[ [0m[34mMatch #[0m[33m502[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/modeling/position_encoding.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m68 | [0m[35m    @torch.no_grad()[0m
[30;1m69 | [0m[35m    def encode_points(self, x, y, labels):[0m
[30;1m70 | [0m[35m        (bx, nx), (by, ny), (bl, nl) = x.shape, y.shape, labels.shape[0m
[30;1m71 | [0m[35m        assert bx == by and nx == ny and bx == bl and nx == nl[0m
[30;1m72 | [0m[35m        pos_x, pos_y = self._encode_xy(x.flatten(), y.flatten())[0m
[30;1m73 | [0m[35m        pos_x, pos_y = pos_x.reshape(bx, nx, -1), pos_y.reshape(by, ny, -1)[0m
[30;1m74 | [0m[35m        pos = torch.cat((pos_y, pos_x, labels[:, :, None]), dim=2)[0m
[30;1m75 | [0m[35m        return pos[0m

[31m--[ [0m[34mMatch #[0m[33m503[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/modeling/sam2_utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m19 | [0m[35mdef select_closest_cond_frames(frame_idx, cond_frame_outputs, max_cond_frame_num):[0m
[30;1m20 | [0m[35m    """[0m
[30;1m21 | [0m[35m    Select up to `max_cond_frame_num` conditioning frames from `cond_frame_outputs`[0m
[30;1m22 | [0m[35m    that are temporally closest to the current frame at `frame_idx`. Here, we take[0m
[30;1m23 | [0m[35m    - a) the closest conditioning frame before `frame_idx` (if any);[0m
[30;1m24 | [0m[35m    - b) the closest conditioning frame after `frame_idx` (if any);[0m
[30;1m25 | [0m[35m    - c) any other temporally closest conditioning frames until reaching a total[0m

[31m--[ [0m[34mMatch #[0m[33m504[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/modeling/sam2_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35m    Returns:[0m
[30;1m172 | [0m[35m    - box_coords: [B, num_pt, 2], contains (x, y) coordinates of top left and bottom right box corne[0m
[30;1m173 | [0m[35m    - box_labels: [B, num_pt], label 2 is reserverd for top left and 3 for bottom right corners, dty[0m
[30;1m174 | [0m[35m    """[0m
[30;1m175 | [0m[35m    device = masks.device[0m
[30;1m176 | [0m[35m    box_coords = mask_to_box(masks)[0m

[31m--[ [0m[34mMatch #[0m[33m505[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/modeling/sam2_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m169 | [0m[35m    - noise_bound: maximum amount of noise (in pure pixesl), dtype=int[0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35m    Returns:[0m
[30;1m172 | [0m[35m    - box_coords: [B, num_pt, 2], contains (x, y) coordinates of top left and bottom right box corne[0m
[30;1m173 | [0m[35m    - box_labels: [B, num_pt], label 2 is reserverd for top left and 3 for bottom right corners, dty[0m
[30;1m174 | [0m[35m    """[0m
[30;1m175 | [0m[35m    device = masks.device[0m

[31m--[ [0m[34mMatch #[0m[33m506[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/_models/sam2/modeling/sam2_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m161 | [0m[35m    bottom_right_label: int = 3,[0m
[30;1m162 | [0m[35m) -> Tuple[np.array, np.array]:[0m
[30;1m163 | [0m[35m    """[0m
[30;1m164 | [0m[35m    Sample a noised version of the top left and bottom right corners of a given `bbox`[0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35m    Inputs:[0m
[30;1m167 | [0m[35m    - masks: [B, 1, H,W] boxes, dtype=torch.Tensor[0m

[31m--[ [0m[34mMatch #[0m[33m507[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/float8/float8_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m74 | [0m[35m    if reduce_amax and dist.is_initialized():[0m
[30;1m75 | [0m[35m        pg = device_mesh.get_group() if device_mesh is not None else None[0m
[30;1m76 | [0m[35m        # dist.all_reduce(amax, op=dist.ReduceOp.MAX, group=pg)[0m
[30;1m77 | [0m[35m        group = list(range(dist.get_world_size())) if pg is None else pg[0m
[30;1m78 | [0m[35m        amax = all_reduce(amax, "MAX", group)[0m
[30;1m79 | [0m[35m        if isinstance(amax, AsyncCollectiveTensor):[0m
[30;1m80 | [0m[35m            amax = amax.wait()[0m
[30;1m81 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m508[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/float8/float8_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m74 | [0m[35m    if reduce_amax and dist.is_initialized():[0m
[30;1m75 | [0m[35m        pg = device_mesh.get_group() if device_mesh is not None else None[0m
[30;1m76 | [0m[35m        # dist.all_reduce(amax, op=dist.ReduceOp.MAX, group=pg)[0m
[30;1m77 | [0m[35m        group = list(range(dist.get_world_size())) if pg is None else pg[0m
[30;1m78 | [0m[35m        amax = all_reduce(amax, "MAX", group)[0m
[30;1m79 | [0m[35m        if isinstance(amax, AsyncCollectiveTensor):[0m
[30;1m80 | [0m[35m            amax = amax.wait()[0m

[31m--[ [0m[34mMatch #[0m[33m509[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/float8/float8_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m72 | [0m[35m    # If the user did not ask for it, assume that it will[0m
[30;1m73 | [0m[35m    # happen elsewhere.[0m
[30;1m74 | [0m[35m    if reduce_amax and dist.is_initialized():[0m
[30;1m75 | [0m[35m        pg = device_mesh.get_group() if device_mesh is not None else None[0m
[30;1m76 | [0m[35m        # dist.all_reduce(amax, op=dist.ReduceOp.MAX, group=pg)[0m
[30;1m77 | [0m[35m        group = list(range(dist.get_world_size())) if pg is None else pg[0m
[30;1m78 | [0m[35m        amax = all_reduce(amax, "MAX", group)[0m

[31m--[ [0m[34mMatch #[0m[33m510[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/core/config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m195 | [0m[35m        raise ValueError("Input dictionary missing required '_type' or '_data' fields")[0m
[30;1m196 | [0m[35m[0m
[30;1m197 | [0m[35m    type_path = data["_type"][0m
[30;1m198 | [0m[35m    stored_version = data.get("_version", 1)[0m
[30;1m199 | [0m[35m    obj_data = data["_data"][0m
[30;1m200 | [0m[35m[0m
[30;1m201 | [0m[35m    # Handle torch.dtype[0m

[31m--[ [0m[34mMatch #[0m[33m511[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/core/config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m217 | [0m[35m    if cls is None:[0m
[30;1m218 | [0m[35m        allowed_modules_str = ", ".join(ALLOWED_AO_MODULES)[0m
[30;1m219 | [0m[35m        raise ValueError([0m
[30;1m220 | [0m[35m            f"Failed to find class {type_path} in any of the allowed modules: {allowed_modules_str}"[0m
[30;1m221 | [0m[35m        )[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m    # Check version - require exact match[0m

[31m--[ [0m[34mMatch #[0m[33m512[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/core/config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m213 | [0m[35m        except (ImportError, AttributeError):[0m
[30;1m214 | [0m[35m            continue  # Try the next module[0m
[30;1m215 | [0m[35m[0m
[30;1m216 | [0m[35m    # If we couldn't find the class in any allowed module, raise an error[0m
[30;1m217 | [0m[35m    if cls is None:[0m
[30;1m218 | [0m[35m        allowed_modules_str = ", ".join(ALLOWED_AO_MODULES)[0m
[30;1m219 | [0m[35m        raise ValueError([0m

[31m--[ [0m[34mMatch #[0m[33m513[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/core/config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m203 | [0m[35m        import torch[0m
[30;1m204 | [0m[35m[0m
[30;1m205 | [0m[35m        return getattr(torch, obj_data)[0m
[30;1m206 | [0m[35m    # Try to find the class in any of the allowed modules[0m
[30;1m207 | [0m[35m    cls = None[0m
[30;1m208 | [0m[35m    for module_path in ALLOWED_AO_MODULES:[0m
[30;1m209 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m514[0m[34m of [0m[33m514[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/torchao/quantization/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m250 | [0m[35m        *x_vals_int8.shape[:-1], y_dot_scaled.shape[-1][0m
[30;1m251 | [0m[35m    )[0m
[30;1m252 | [0m[35m[0m
[30;1m253 | [0m[35m    # can downcast only at the very end[0m
[30;1m254 | [0m[35m    y = y.to(output_dtype)[0m
[30;1m255 | [0m[35m    return y[0m
[30;1m256 | [0m[35m[0m

514 matches found.
