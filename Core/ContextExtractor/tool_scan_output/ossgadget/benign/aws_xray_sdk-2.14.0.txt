[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/bottle/middleware.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m59 | [0m[35m            segment.put_http_meta(http.METHOD, request.method)[0m
[30;1m60 | [0m[35m            segment.put_http_meta(http.USER_AGENT, headers.get('User-Agent'))[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m            client_ip = request.environ.get('HTTP_X_FORWARDED_FOR') or request.environ.get('REMOTE_A[0m
[30;1m63 | [0m[35m            if client_ip:[0m
[30;1m64 | [0m[35m                segment.put_http_meta(http.CLIENT_IP, client_ip)[0m
[30;1m65 | [0m[35m                segment.put_http_meta(http.X_FORWARDED_FOR, True)[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/bottle/middleware.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m59 | [0m[35m            segment.put_http_meta(http.METHOD, request.method)[0m
[30;1m60 | [0m[35m            segment.put_http_meta(http.USER_AGENT, headers.get('User-Agent'))[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m            client_ip = request.environ.get('HTTP_X_FORWARDED_FOR') or request.environ.get('REMOTE_A[0m
[30;1m63 | [0m[35m            if client_ip:[0m
[30;1m64 | [0m[35m                segment.put_http_meta(http.CLIENT_IP, client_ip)[0m
[30;1m65 | [0m[35m                segment.put_http_meta(http.X_FORWARDED_FOR, True)[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/httpx/patch.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m61 | [0m[35m                subsegment.put_http_meta(http.METHOD, request.method)[0m
[30;1m62 | [0m[35m                subsegment.put_http_meta([0m
[30;1m63 | [0m[35m                    http.URL,[0m
[30;1m64 | [0m[35m                    str(request.url.copy_with(password=None, query=None, fragment=None)),[0m
[30;1m65 | [0m[35m                )[0m
[30;1m66 | [0m[35m                inject_trace_header(request.headers, subsegment)[0m
[30;1m67 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/httpx/patch.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m39 | [0m[35m                subsegment.put_http_meta(http.METHOD, request.method)[0m
[30;1m40 | [0m[35m                subsegment.put_http_meta([0m
[30;1m41 | [0m[35m                    http.URL,[0m
[30;1m42 | [0m[35m                    str(request.url.copy_with(password=None, query=None, fragment=None)),[0m
[30;1m43 | [0m[35m                )[0m
[30;1m44 | [0m[35m                inject_trace_header(request.headers, subsegment)[0m
[30;1m45 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_xray_sdk-2.14.0/PKG-INFO[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m288 | [0m[35m```[0m
[30;1m289 | [0m[35m[0m
[30;1m290 | [0m[35m**Important Notes:**[0m
[30;1m291 | [0m[35m* Environment Variables always take precedence over the SDKConfig module when disabling/enabling. If[0m
[30;1m292 | [0m[35m[0m
[30;1m293 | [0m[35m* If you need to re-enable X-Ray again during runtime and acknowledge disabling/enabling through the[0m
[30;1m294 | [0m[35m```[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_xray_sdk-2.14.0/README.md[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m262 | [0m[35m```[0m
[30;1m263 | [0m[35m[0m
[30;1m264 | [0m[35m**Important Notes:**[0m
[30;1m265 | [0m[35m* Environment Variables always take precedence over the SDKConfig module when disabling/enabling. If[0m
[30;1m266 | [0m[35m[0m
[30;1m267 | [0m[35m* If you need to re-enable X-Ray again during runtime and acknowledge disabling/enabling through the[0m
[30;1m268 | [0m[35m```[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk.egg-info/PKG-INFO[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m288 | [0m[35m```[0m
[30;1m289 | [0m[35m[0m
[30;1m290 | [0m[35m**Important Notes:**[0m
[30;1m291 | [0m[35m* Environment Variables always take precedence over the SDKConfig module when disabling/enabling. If[0m
[30;1m292 | [0m[35m[0m
[30;1m293 | [0m[35m* If you need to re-enable X-Ray again during runtime and acknowledge disabling/enabling through the[0m
[30;1m294 | [0m[35m```[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/sdk_config.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m        Environment variables AWS_XRAY_SDK_ENABLED overrides argument value.[0m
[30;1m70 | [0m[35m        """[0m
[30;1m71 | [0m[35m        # Environment Variables take precedence over hardcoded configurations.[0m
[30;1m72 | [0m[35m        if cls.XRAY_ENABLED_KEY in os.environ:[0m
[30;1m73 | [0m[35m            cls.__SDK_ENABLED = cls.__get_enabled_from_env()[0m
[30;1m74 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/sdk_config.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m        :return: bool - True if it is enabled, False otherwise.[0m
[30;1m41 | [0m[35m        """[0m
[30;1m42 | [0m[35m        env_var_str = os.getenv(cls.XRAY_ENABLED_KEY, 'true').lower()[0m
[30;1m43 | [0m[35m        if env_var_str in ('y', 'yes', 't', 'true', 'on', '1'):[0m
[30;1m44 | [0m[35m            return True[0m
[30;1m45 | [0m[35m        elif env_var_str in ('n', 'no', 'f', 'false', 'off', '0'):[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/sqlalchemy/util/decorators.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m105 | [0m[35m        if u.password is None:[0m
[30;1m106 | [0m[35m            safe_url = u.geturl()[0m
[30;1m107 | [0m[35m        else:[0m
[30;1m108 | [0m[35m            # Strip password from URL[0m
[30;1m109 | [0m[35m            host_info = u.netloc.rpartition('@')[-1][0m
[30;1m110 | [0m[35m            parts = u._replace(netloc='{}@{}'.format(u.username, host_info))[0m
[30;1m111 | [0m[35m            safe_url = parts.geturl()[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/sqlalchemy/util/decorators.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m102 | [0m[35m        # Add Scheme to uses_netloc or // will be missing from url.[0m
[30;1m103 | [0m[35m        uses_netloc.append(u.scheme)[0m
[30;1m104 | [0m[35m        safe_url = ""[0m
[30;1m105 | [0m[35m        if u.password is None:[0m
[30;1m106 | [0m[35m            safe_url = u.geturl()[0m
[30;1m107 | [0m[35m        else:[0m
[30;1m108 | [0m[35m            # Strip password from URL[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/sqlalchemy/util/decorators.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m76 | [0m[35m# query	3	Query component	empty string[0m
[30;1m77 | [0m[35m# fragment	4	Fragment identifier	empty string[0m
[30;1m78 | [0m[35m# username	 	User name	None[0m
[30;1m79 | [0m[35m# password	 	Password	None[0m
[30;1m80 | [0m[35m# hostname	 	Host name (lower case)	None[0m
[30;1m81 | [0m[35m# port	 	Port number as integer, if present	None[0m
[30;1m82 | [0m[35m#[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/sqlalchemy/util/decorators.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m76 | [0m[35m# query	3	Query component	empty string[0m
[30;1m77 | [0m[35m# fragment	4	Fragment identifier	empty string[0m
[30;1m78 | [0m[35m# username	 	User name	None[0m
[30;1m79 | [0m[35m# password	 	Password	None[0m
[30;1m80 | [0m[35m# hostname	 	Host name (lower case)	None[0m
[30;1m81 | [0m[35m# port	 	Port number as integer, if present	None[0m
[30;1m82 | [0m[35m#[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_lambda_context.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m    # Reset header value and ensure behaviour returns to normal[0m
[30;1m106 | [0m[35m    del os.environ[lambda_launcher.LAMBDA_TRACE_HEADER_KEY][0m
[30;1m107 | [0m[35m    os.environ[lambda_launcher.LAMBDA_TRACE_HEADER_KEY] = temp_header_var[0m
[30;1m108 | [0m[35m    temp_context.put_subsegment(subsegment)[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m    assert temp_context.get_trace_entity() == subsegment[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_lambda_context.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m103 | [0m[35m    assert isinstance(temp_context.get_trace_entity(), DummySegment)[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m    # Reset header value and ensure behaviour returns to normal[0m
[30;1m106 | [0m[35m    del os.environ[lambda_launcher.LAMBDA_TRACE_HEADER_KEY][0m
[30;1m107 | [0m[35m    os.environ[lambda_launcher.LAMBDA_TRACE_HEADER_KEY] = temp_header_var[0m
[30;1m108 | [0m[35m    temp_context.put_subsegment(subsegment)[0m
[30;1m109 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_lambda_context.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m92 | [0m[35m    del os.environ[lambda_launcher.LAMBDA_TRACE_HEADER_KEY][0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m    # Set header to lambda passthrough style header[0m
[30;1m95 | [0m[35m    os.environ[lambda_launcher.LAMBDA_TRACE_HEADER_KEY] = "Root=%s;Lineage=10:1234abcd:3" % TRACE_ID[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m    temp_context = lambda_launcher.LambdaContext()[0m
[30;1m98 | [0m[35m    dummy_segment = temp_context.get_trace_entity()[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_lambda_context.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m89 | [0m[35mdef test_lambda_passthrough():[0m
[30;1m90 | [0m[35m    # Hold previous environment value[0m
[30;1m91 | [0m[35m    temp_header_var = os.environ[lambda_launcher.LAMBDA_TRACE_HEADER_KEY][0m
[30;1m92 | [0m[35m    del os.environ[lambda_launcher.LAMBDA_TRACE_HEADER_KEY][0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m    # Set header to lambda passthrough style header[0m
[30;1m95 | [0m[35m    os.environ[lambda_launcher.LAMBDA_TRACE_HEADER_KEY] = "Root=%s;Lineage=10:1234abcd:3" % TRACE_ID[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_lambda_context.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35mdef test_lambda_passthrough():[0m
[30;1m90 | [0m[35m    # Hold previous environment value[0m
[30;1m91 | [0m[35m    temp_header_var = os.environ[lambda_launcher.LAMBDA_TRACE_HEADER_KEY][0m
[30;1m92 | [0m[35m    del os.environ[lambda_launcher.LAMBDA_TRACE_HEADER_KEY][0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m    # Set header to lambda passthrough style header[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_lambda_context.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m    # "Lambda" container added metadata now. Should see subsegment now.[0m
[30;1m83 | [0m[35m    # The following put_segment call will overwrite the dummy segment in the context with an intiali[0m
[30;1m84 | [0m[35m    os.environ[lambda_launcher.LAMBDA_TRACE_HEADER_KEY] = temp_header_var[0m
[30;1m85 | [0m[35m    temp_context.put_subsegment(subsegment)[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m    assert temp_context.get_trace_entity() == subsegment[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_lambda_context.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m70 | [0m[35mdef test_non_initialized():[0m
[30;1m71 | [0m[35m    # Context that hasn't been initialized by lambda container should not add subsegments to the dum[0m
[30;1m72 | [0m[35m    temp_header_var = os.environ[lambda_launcher.LAMBDA_TRACE_HEADER_KEY][0m
[30;1m73 | [0m[35m    del os.environ[lambda_launcher.LAMBDA_TRACE_HEADER_KEY][0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    temp_context = lambda_launcher.LambdaContext()[0m
[30;1m76 | [0m[35m    dummy_segment = temp_context.get_trace_entity()[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_lambda_context.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35mdef test_non_initialized():[0m
[30;1m71 | [0m[35m    # Context that hasn't been initialized by lambda container should not add subsegments to the dum[0m
[30;1m72 | [0m[35m    temp_header_var = os.environ[lambda_launcher.LAMBDA_TRACE_HEADER_KEY][0m
[30;1m73 | [0m[35m    del os.environ[lambda_launcher.LAMBDA_TRACE_HEADER_KEY][0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    temp_context = lambda_launcher.LambdaContext()[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_lambda_context.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m12 | [0m[35mDATA = 'Foo=Bar'[0m
[30;1m13 | [0m[35mHEADER_VAR = "Root=%s;Parent=%s;Sampled=1;%s" % (TRACE_ID, PARENT_ID, DATA)[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mos.environ[lambda_launcher.LAMBDA_TRACE_HEADER_KEY] = HEADER_VAR[0m
[30;1m16 | [0m[35mcontext = lambda_launcher.LambdaContext()[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/sqlalchemy_core/patch.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m19 | [0m[35m        # This will continue to work once sqlalchemy fixes the bug.[0m
[30;1m20 | [0m[35m        sa_url = engine_instance.engine.url[0m
[30;1m21 | [0m[35m        username = sa_url.username[0m
[30;1m22 | [0m[35m        sa_url = sa_url._replace(username=None, password=None)[0m
[30;1m23 | [0m[35m        url = urlparse(str(sa_url))[0m
[30;1m24 | [0m[35m        name = url.netloc[0m
[30;1m25 | [0m[35m        if username:[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/sqlalchemy_core/patch.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m15 | [0m[35m    try:[0m
[30;1m16 | [0m[35m        metadata = {}[0m
[30;1m17 | [0m[35m        # Workaround for https://github.com/sqlalchemy/sqlalchemy/issues/10662[0m
[30;1m18 | [0m[35m        # sqlalchemy.engine.url.URL's __repr__ does not url encode username nor password.[0m
[30;1m19 | [0m[35m        # This will continue to work once sqlalchemy fixes the bug.[0m
[30;1m20 | [0m[35m        sa_url = engine_instance.engine.url[0m
[30;1m21 | [0m[35m        username = sa_url.username[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_sdk_config.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35mdef test_invalid_env_string():[0m
[30;1m85 | [0m[35m    os.environ[XRAY_ENABLED_KEY] = "INVALID"[0m
[30;1m86 | [0m[35m    # Env Variable takes precedence. This is called to activate the internal check[0m
[30;1m87 | [0m[35m    global_sdk_config.set_sdk_enabled(True)[0m
[30;1m88 | [0m[35m    assert global_sdk_config.sdk_enabled() is True[0m
[30;1m89 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_sdk_config.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35mdef test_env_enable_case():[0m
[30;1m50 | [0m[35m    os.environ[XRAY_ENABLED_KEY] = "TrUE"[0m
[30;1m51 | [0m[35m    # Env Variable takes precedence. This is called to activate the internal check[0m
[30;1m52 | [0m[35m    global_sdk_config.set_sdk_enabled(True)[0m
[30;1m53 | [0m[35m    assert global_sdk_config.sdk_enabled() is True[0m
[30;1m54 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_sdk_config.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35mdef test_env_var_precedence():[0m
[30;1m31 | [0m[35m    os.environ[XRAY_ENABLED_KEY] = "true"[0m
[30;1m32 | [0m[35m    # Env Variable takes precedence. This is called to activate the internal check[0m
[30;1m33 | [0m[35m    global_sdk_config.set_sdk_enabled(False)[0m
[30;1m34 | [0m[35m    assert global_sdk_config.sdk_enabled() is True[0m
[30;1m35 | [0m[35m    os.environ[XRAY_ENABLED_KEY] = "false"[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_sdk_config.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m27 | [0m[35m    assert global_sdk_config.sdk_enabled() is True[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35mdef test_env_var_precedence():[0m
[30;1m31 | [0m[35m    os.environ[XRAY_ENABLED_KEY] = "true"[0m
[30;1m32 | [0m[35m    # Env Variable takes precedence. This is called to activate the internal check[0m
[30;1m33 | [0m[35m    global_sdk_config.set_sdk_enabled(False)[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_wildcard_match.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m142 | [0m[35m    assert wildcard_match('a*a*', 'aaa')[0m
[30;1m143 | [0m[35m    assert wildcard_match('a*a*', 'aaaaaaaaaaaaaaaaaaaaaaaaaa')[0m
[30;1m144 | [0m[35m    assert wildcard_match('a*b*a*b*a*b*a*b*a*',[0m
[30;1m145 | [0m[35m                          'akljd9gsdfbkjhaabajkhbbyiaahkjbjhbuykjakjhabkjhbabjhkaabbabbaaakljdfsjkla[0m
[30;1m146 | [0m[35m    assert not wildcard_match('a*na*ha', 'anananahahanahana')[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/aiohttp/client.py[0m
   Pattern: [32m.hostname[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35masync def begin_subsegment(session, trace_config_ctx, params):[0m
[30;1m25 | [0m[35m    name = trace_config_ctx.name if trace_config_ctx.name else get_hostname(str(params.url))[0m
[30;1m26 | [0m[35m    subsegment = xray_recorder.begin_subsegment(name, REMOTE_NAMESPACE)[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    # No-op if subsegment is `None` due to `LOG_ERROR`.[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/aiohttp/client.py[0m
   Pattern: [32m.hostname[0m
[30;1m8 | [0m[35mfrom aws_xray_sdk.core import xray_recorder[0m
[30;1m9 | [0m[35mfrom aws_xray_sdk.core.models import http[0m
[30;1m10 | [0m[35mfrom aws_xray_sdk.core.utils import stacktrace[0m
[30;1m11 | [0m[35mfrom aws_xray_sdk.ext.util import inject_trace_header, strip_url, get_hostname[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m# All aiohttp calls will entail outgoing HTTP requests, only in some ad-hoc[0m
[30;1m14 | [0m[35m# exceptions the namespace will be flip back to local.[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/plugins/ec2_plugin.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m17 | [0m[35m    """[0m
[30;1m18 | [0m[35m    global runtime_context[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m    # get session token with 60 seconds TTL to not have the token lying around for a long time[0m
[30;1m21 | [0m[35m    token = get_token()[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    # get instance metadata[0m
[30;1m24 | [0m[35m    runtime_context = get_metadata(token)[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/bottle/middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m            resp_header_str = prepare_response_header(origin_header, segment)[0m
[30;1m86 | [0m[35m            response.set_header(http.XRAY_HEADER, resp_header_str)[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m            cont_len = response.headers.get('Content-Length')[0m
[30;1m89 | [0m[35m            if cont_len:[0m
[30;1m90 | [0m[35m                segment.put_http_meta(http.CONTENT_LENGTH, int(cont_len))[0m
[30;1m91 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/bottle/middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m            segment.put_http_meta(http.METHOD, request.method)[0m
[30;1m60 | [0m[35m            segment.put_http_meta(http.USER_AGENT, headers.get('User-Agent'))[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m            client_ip = request.environ.get('HTTP_X_FORWARDED_FOR') or request.environ.get('REMOTE_A[0m
[30;1m63 | [0m[35m            if client_ip:[0m
[30;1m64 | [0m[35m                segment.put_http_meta(http.CLIENT_IP, client_ip)[0m
[30;1m65 | [0m[35m                segment.put_http_meta(http.X_FORWARDED_FOR, True)[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/bottle/middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m            segment.put_http_meta(http.METHOD, request.method)[0m
[30;1m60 | [0m[35m            segment.put_http_meta(http.USER_AGENT, headers.get('User-Agent'))[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m            client_ip = request.environ.get('HTTP_X_FORWARDED_FOR') or request.environ.get('REMOTE_A[0m
[30;1m63 | [0m[35m            if client_ip:[0m
[30;1m64 | [0m[35m                segment.put_http_meta(http.CLIENT_IP, client_ip)[0m
[30;1m65 | [0m[35m                segment.put_http_meta(http.X_FORWARDED_FOR, True)[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/bottle/middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m57 | [0m[35m            segment.save_origin_trace_header(xray_header)[0m
[30;1m58 | [0m[35m            segment.put_http_meta(http.URL, request.url)[0m
[30;1m59 | [0m[35m            segment.put_http_meta(http.METHOD, request.method)[0m
[30;1m60 | [0m[35m            segment.put_http_meta(http.USER_AGENT, headers.get('User-Agent'))[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m            client_ip = request.environ.get('HTTP_X_FORWARDED_FOR') or request.environ.get('REMOTE_A[0m
[30;1m63 | [0m[35m            if client_ip:[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/connector.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m144 | [0m[35m        return record.get('Version', None) == 1 and \[0m
[30;1m145 | [0m[35m            record.get('ResourceARN', None) == '*' and \[0m
[30;1m146 | [0m[35m            record.get('ServiceType', None) and \[0m
[30;1m147 | [0m[35m            not record.get('Attributes', None)[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m    def _create_xray_client(self, ip='127.0.0.1', port='2000'):[0m
[30;1m150 | [0m[35m        session = botocore.session.get_session()[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/connector.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m143 | [0m[35m        # We currently only handle v1 sampling rules.[0m
[30;1m144 | [0m[35m        return record.get('Version', None) == 1 and \[0m
[30;1m145 | [0m[35m            record.get('ResourceARN', None) == '*' and \[0m
[30;1m146 | [0m[35m            record.get('ServiceType', None) and \[0m
[30;1m147 | [0m[35m            not record.get('Attributes', None)[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m    def _create_xray_client(self, ip='127.0.0.1', port='2000'):[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/connector.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m142 | [0m[35m    def _is_rule_valid(self, record):[0m
[30;1m143 | [0m[35m        # We currently only handle v1 sampling rules.[0m
[30;1m144 | [0m[35m        return record.get('Version', None) == 1 and \[0m
[30;1m145 | [0m[35m            record.get('ResourceARN', None) == '*' and \[0m
[30;1m146 | [0m[35m            record.get('ServiceType', None) and \[0m
[30;1m147 | [0m[35m            not record.get('Attributes', None)[0m
[30;1m148 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/connector.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m    def _is_rule_valid(self, record):[0m
[30;1m143 | [0m[35m        # We currently only handle v1 sampling rules.[0m
[30;1m144 | [0m[35m        return record.get('Version', None) == 1 and \[0m
[30;1m145 | [0m[35m            record.get('ResourceARN', None) == '*' and \[0m
[30;1m146 | [0m[35m            record.get('ServiceType', None) and \[0m
[30;1m147 | [0m[35m            not record.get('Attributes', None)[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/connector.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m92 | [0m[35m                'rate': doc['FixedRate'],[0m
[30;1m93 | [0m[35m                'quota': doc.get('ReservoirQuota', None),[0m
[30;1m94 | [0m[35m                'TTL': TTL,[0m
[30;1m95 | [0m[35m                'interval': doc.get('Interval', None),[0m
[30;1m96 | [0m[35m            }[0m
[30;1m97 | [0m[35m            targets_mapping[doc['RuleName']] = target[0m
[30;1m98 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/connector.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m90 | [0m[35m            TTL = self._dt_to_epoch(doc['ReservoirQuotaTTL']) if doc.get('ReservoirQuotaTTL', None) [0m
[30;1m91 | [0m[35m            target = {[0m
[30;1m92 | [0m[35m                'rate': doc['FixedRate'],[0m
[30;1m93 | [0m[35m                'quota': doc.get('ReservoirQuota', None),[0m
[30;1m94 | [0m[35m                'TTL': TTL,[0m
[30;1m95 | [0m[35m                'interval': doc.get('Interval', None),[0m
[30;1m96 | [0m[35m            }[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/connector.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m        targets_mapping = {}[0m
[30;1m89 | [0m[35m        for doc in new_docs:[0m
[30;1m90 | [0m[35m            TTL = self._dt_to_epoch(doc['ReservoirQuotaTTL']) if doc.get('ReservoirQuotaTTL', None) [0m
[30;1m91 | [0m[35m            target = {[0m
[30;1m92 | [0m[35m                'rate': doc['FixedRate'],[0m
[30;1m93 | [0m[35m                'quota': doc.get('ReservoirQuota', None),[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/connector.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m101 | [0m[35m    def setup_xray_client(self, ip, port, client):[0m
[30;1m102 | [0m[35m        """[0m
[30;1m103 | [0m[35m        Setup the xray client based on ip and port.[0m
[30;1m104 | [0m[35m        If a preset client is specified, ip and port[0m
[30;1m105 | [0m[35m        will be ignored.[0m
[30;1m106 | [0m[35m        """[0m
[30;1m107 | [0m[35m        if not client:[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/connector.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m    def setup_xray_client(self, ip, port, client):[0m
[30;1m102 | [0m[35m        """[0m
[30;1m103 | [0m[35m        Setup the xray client based on ip and port.[0m
[30;1m104 | [0m[35m        If a preset client is specified, ip and port[0m
[30;1m105 | [0m[35m        will be ignored.[0m
[30;1m106 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/connector.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport binascii[0m
[30;1m2 | [0m[35mimport os[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mfrom datetime import datetime[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mimport botocore.session[0m
[30;1m7 | [0m[35mfrom botocore import UNSIGNED[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/dbapi2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m70 | [0m[35m        subsegment.name = meta['name'][0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m    sql_meta = copy.copy(meta)[0m
[30;1m73 | [0m[35m    if sql_meta.get('name', None):[0m
[30;1m74 | [0m[35m        del sql_meta['name'][0m
[30;1m75 | [0m[35m    subsegment.set_sql(sql_meta)[0m
[30;1m76 | [0m[35m    subsegment.namespace = 'remote'[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/dbapi2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m66 | [0m[35m    if not subsegment:[0m
[30;1m67 | [0m[35m        return[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m    if meta.get('name', None):[0m
[30;1m70 | [0m[35m        subsegment.name = meta['name'][0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m    sql_meta = copy.copy(meta)[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/dbapi2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m29 | [0m[35m        self._xray_meta = meta[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m        # we preset database type if db is framework built-in[0m
[30;1m32 | [0m[35m        if not self._xray_meta.get('database_type'):[0m
[30;1m33 | [0m[35m            db_type = cursor.__class__.__module__.split('.')[0][0m
[30;1m34 | [0m[35m            self._xray_meta['database_type'] = db_type[0m
[30;1m35 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/psycopg2/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m            parameterized_dsn.get('port', 'unknown'),[0m
[30;1m42 | [0m[35m            parameterized_dsn.get('dbname', 'unknown'),[0m
[30;1m43 | [0m[35m        ),[0m
[30;1m44 | [0m[35m        'user': parameterized_dsn.get('user', 'unknown'),[0m
[30;1m45 | [0m[35m        'database_version': str(conn.server_version),[0m
[30;1m46 | [0m[35m        'driver_version': 'Psycopg 2'[0m
[30;1m47 | [0m[35m    }[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/psycopg2/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m39 | [0m[35m            parameterized_dsn.get('user', 'unknown'),[0m
[30;1m40 | [0m[35m            parameterized_dsn.get('host', 'unknown'),[0m
[30;1m41 | [0m[35m            parameterized_dsn.get('port', 'unknown'),[0m
[30;1m42 | [0m[35m            parameterized_dsn.get('dbname', 'unknown'),[0m
[30;1m43 | [0m[35m        ),[0m
[30;1m44 | [0m[35m        'user': parameterized_dsn.get('user', 'unknown'),[0m
[30;1m45 | [0m[35m        'database_version': str(conn.server_version),[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/psycopg2/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m38 | [0m[35m        'url': 'postgresql://{}@{}:{}/{}'.format([0m
[30;1m39 | [0m[35m            parameterized_dsn.get('user', 'unknown'),[0m
[30;1m40 | [0m[35m            parameterized_dsn.get('host', 'unknown'),[0m
[30;1m41 | [0m[35m            parameterized_dsn.get('port', 'unknown'),[0m
[30;1m42 | [0m[35m            parameterized_dsn.get('dbname', 'unknown'),[0m
[30;1m43 | [0m[35m        ),[0m
[30;1m44 | [0m[35m        'user': parameterized_dsn.get('user', 'unknown'),[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/psycopg2/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m37 | [0m[35m        'database_type': 'PostgreSQL',[0m
[30;1m38 | [0m[35m        'url': 'postgresql://{}@{}:{}/{}'.format([0m
[30;1m39 | [0m[35m            parameterized_dsn.get('user', 'unknown'),[0m
[30;1m40 | [0m[35m            parameterized_dsn.get('host', 'unknown'),[0m
[30;1m41 | [0m[35m            parameterized_dsn.get('port', 'unknown'),[0m
[30;1m42 | [0m[35m            parameterized_dsn.get('dbname', 'unknown'),[0m
[30;1m43 | [0m[35m        ),[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/psycopg2/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m36 | [0m[35m    meta = {[0m
[30;1m37 | [0m[35m        'database_type': 'PostgreSQL',[0m
[30;1m38 | [0m[35m        'url': 'postgresql://{}@{}:{}/{}'.format([0m
[30;1m39 | [0m[35m            parameterized_dsn.get('user', 'unknown'),[0m
[30;1m40 | [0m[35m            parameterized_dsn.get('host', 'unknown'),[0m
[30;1m41 | [0m[35m            parameterized_dsn.get('port', 'unknown'),[0m
[30;1m42 | [0m[35m            parameterized_dsn.get('dbname', 'unknown'),[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/async_context.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m94 | [0m[35m    # Share context with new task if possible[0m
[30;1m95 | [0m[35m    current_task = asyncio.current_task(loop=loop)[0m
[30;1m96 | [0m[35m    if current_task is not None and hasattr(current_task, 'context'):[0m
[30;1m97 | [0m[35m        if current_task.context.get('entities'):[0m
[30;1m98 | [0m[35m            # NOTE: (enowell) Because the `AWSXRayRecorder`'s `Context` decides[0m
[30;1m99 | [0m[35m            # the parent by looking at its `_local.entities`, we must copy the entities[0m
[30;1m100 | [0m[35m            # for concurrent subsegments. Otherwise, the subsegments would be[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/async_context.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m96 | [0m[35m    if current_task is not None and hasattr(current_task, 'context'):[0m
[30;1m97 | [0m[35m        if current_task.context.get('entities'):[0m
[30;1m98 | [0m[35m            # NOTE: (enowell) Because the `AWSXRayRecorder`'s `Context` decides[0m
[30;1m99 | [0m[35m            # the parent by looking at its `_local.entities`, we must copy the entities[0m
[30;1m100 | [0m[35m            # for concurrent subsegments. Otherwise, the subsegments would be[0m
[30;1m101 | [0m[35m            # modifying the same `entities` list and sugsegments would take other[0m
[30;1m102 | [0m[35m            # subsegments as parents instead of the original `segment`.[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/patcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m173 | [0m[35m            # Only patch methods of the class defined in the module, ignore other modules[0m
[30;1m174 | [0m[35m            if is_classmethod(member):[0m
[30;1m175 | [0m[35m                # classmethods are internally generated through descriptors. The classmethod[0m
[30;1m176 | [0m[35m                # decorator must be the last applied, so we cannot apply another one on top[0m
[30;1m177 | [0m[35m                log.warning('Cannot automatically patch classmethod %s.%s, '[0m
[30;1m178 | [0m[35m                            'please apply decorator manually', cls.__name__, member_name)[0m
[30;1m179 | [0m[35m            else:[0m
[30;1m180 | [0m[35m                _patch_func(cls, member_name, member)[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/pynamodb/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m    # in case of client timeout the return value will be empty[0m
[30;1m69 | [0m[35m    if return_value is not None:[0m
[30;1m70 | [0m[35m        aws_meta['request_id'] = return_value.headers.get('x-amzn-RequestId')[0m
[30;1m71 | [0m[35m        subsegment.put_http_meta(http.STATUS, return_value.status_code)[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m    if exception:[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/pynamodb/patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m65 | [0m[35m        'region': region[0m
[30;1m66 | [0m[35m    }[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m    # in case of client timeout the return value will be empty[0m
[30;1m69 | [0m[35m    if return_value is not None:[0m
[30;1m70 | [0m[35m        aws_meta['request_id'] = return_value.headers.get('x-amzn-RequestId')[0m
[30;1m71 | [0m[35m        subsegment.put_http_meta(http.STATUS, return_value.status_code)[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/pynamodb/patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m    # Check if it's a request to DynamoDB and return otherwise.[0m
[30;1m43 | [0m[35m    try:[0m
[30;1m44 | [0m[35m        service = args[0].headers['X-Amz-Target'].decode('utf-8').split('_')[0][0m
[30;1m45 | [0m[35m    except KeyError:[0m
[30;1m46 | [0m[35m        return wrapped(*args, **kwargs)[0m
[30;1m47 | [0m[35m    if service.lower() != 'dynamodb':[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/httpx/patch.py[0m
   Pattern: [32m.hostname[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m    async def handle_async_request(self, request: httpx.Request) -> httpx.Response:[0m
[30;1m57 | [0m[35m        async with xray_recorder.in_subsegment_async([0m
[30;1m58 | [0m[35m            get_hostname(str(request.url)), namespace="remote"[0m
[30;1m59 | [0m[35m        ) as subsegment:[0m
[30;1m60 | [0m[35m            if subsegment is not None:[0m
[30;1m61 | [0m[35m                subsegment.put_http_meta(http.METHOD, request.method)[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/httpx/patch.py[0m
   Pattern: [32m.hostname[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    def handle_request(self, request: httpx.Request) -> httpx.Response:[0m
[30;1m35 | [0m[35m        with xray_recorder.in_subsegment([0m
[30;1m36 | [0m[35m            get_hostname(str(request.url)), namespace="remote"[0m
[30;1m37 | [0m[35m        ) as subsegment:[0m
[30;1m38 | [0m[35m            if subsegment is not None:[0m
[30;1m39 | [0m[35m                subsegment.put_http_meta(http.METHOD, request.method)[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/httpx/patch.py[0m
   Pattern: [32m.hostname[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom aws_xray_sdk.core import xray_recorder[0m
[30;1m4 | [0m[35mfrom aws_xray_sdk.core.models import http[0m
[30;1m5 | [0m[35mfrom aws_xray_sdk.ext.util import inject_trace_header, get_hostname[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mdef patch():[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/target_poller.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m47 | [0m[35m    def _get_candidates(self, all_rules):[0m
[30;1m48 | [0m[35m        """[0m
[30;1m49 | [0m[35m        Don't report a rule statistics if any of the conditions is met:[0m
[30;1m50 | [0m[35m        1. The report time hasn't come(some rules might have larger report intervals).[0m
[30;1m51 | [0m[35m        2. The rule is never matched.[0m
[30;1m52 | [0m[35m        """[0m
[30;1m53 | [0m[35m        candidates = [][0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/target_poller.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport logging[0m
[30;1m2 | [0m[35mfrom random import Random[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mimport threading[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mlog = logging.getLogger(__name__)[0m
[30;1m7 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/PKG-INFO[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m526 | [0m[35masync def foo():[0m
[30;1m527 | [0m[35m    trace_config = aws_xray_trace_config()[0m
[30;1m528 | [0m[35m    async with ClientSession(loop=loop, trace_configs=[trace_config]) as session:[0m
[30;1m529 | [0m[35m        async with session.get(url) as resp[0m
[30;1m530 | [0m[35m            await resp.read()[0m
[30;1m531 | [0m[35m```[0m
[30;1m532 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/PKG-INFO[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m341 | [0m[35m    xray_recorder.set_trace_entity(trace_entity)[0m
[30;1m342 | [0m[35m    # Subsegment captured from the following HTTP GET will be[0m
[30;1m343 | [0m[35m    # a child of parent entity passed from the main thread.[0m
[30;1m344 | [0m[35m    resp = requests.get(url)[0m
[30;1m345 | [0m[35m    # prevent thread pollution[0m
[30;1m346 | [0m[35m    xray_recorder.clear_trace_entities()[0m
[30;1m347 | [0m[35m    return resp[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/PKG-INFO[0m
   Pattern: [32m.hostname[0m
[30;1m583 | [0m[35mxray_add_ignored(urls=['/test-path', '/other-test-path'])[0m
[30;1m584 | [0m[35m[0m
[30;1m585 | [0m[35m# ignore requests to myapp.com for /test-url[0m
[30;1m586 | [0m[35mxray_add_ignored(hostname='myapp.com', urls=['/test-url'])[0m
[30;1m587 | [0m[35m```[0m
[30;1m588 | [0m[35m[0m
[30;1m589 | [0m[35mIf you use a subclass of httplib to make your requests, you can also filter on the class name that i[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/PKG-INFO[0m
   Pattern: [32m.hostname[0m
[30;1m577 | [0m[35mxray_add_ignored(hostname='test.myapp.com')[0m
[30;1m578 | [0m[35m[0m
[30;1m579 | [0m[35m# ignore requests to a subdomain of myapp.com with a glob pattern[0m
[30;1m580 | [0m[35mxray_add_ignored(hostname='*.myapp.com')[0m
[30;1m581 | [0m[35m[0m
[30;1m582 | [0m[35m# ignore requests to /test-url and /other-test-url[0m
[30;1m583 | [0m[35mxray_add_ignored(urls=['/test-path', '/other-test-path'])[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/PKG-INFO[0m
   Pattern: [32m.hostname[0m
[30;1m574 | [0m[35mfrom aws_xray_sdk.ext.httplib import add_ignored as xray_add_ignored[0m
[30;1m575 | [0m[35m[0m
[30;1m576 | [0m[35m# ignore requests to test.myapp.com[0m
[30;1m577 | [0m[35mxray_add_ignored(hostname='test.myapp.com')[0m
[30;1m578 | [0m[35m[0m
[30;1m579 | [0m[35m# ignore requests to a subdomain of myapp.com with a glob pattern[0m
[30;1m580 | [0m[35mxray_add_ignored(hostname='*.myapp.com')[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/PKG-INFO[0m
   Pattern: [32m.hostname[0m
[30;1m568 | [0m[35m[0m
[30;1m569 | [0m[35m### Ignoring httplib requests[0m
[30;1m570 | [0m[35m[0m
[30;1m571 | [0m[35mIf you want to ignore certain httplib requests you can do so based on the hostname or URL that is be[0m
[30;1m572 | [0m[35m[0m
[30;1m573 | [0m[35m```python[0m
[30;1m574 | [0m[35mfrom aws_xray_sdk.ext.httplib import add_ignored as xray_add_ignored[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/PKG-INFO[0m
   Pattern: [32m.hostname[0m
[30;1m568 | [0m[35m[0m
[30;1m569 | [0m[35m### Ignoring httplib requests[0m
[30;1m570 | [0m[35m[0m
[30;1m571 | [0m[35mIf you want to ignore certain httplib requests you can do so based on the hostname or URL that is be[0m
[30;1m572 | [0m[35m[0m
[30;1m573 | [0m[35m```python[0m
[30;1m574 | [0m[35mfrom aws_xray_sdk.ext.httplib import add_ignored as xray_add_ignored[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m  | [0m[35msampled) requests (this is applicable for trace id injection into logs use case) then they should se[0m
[30;1m  | [0m[35m[0m
[30;1m  | [0m[35m### Disabling X-Ray[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m155 | [0m[35m```[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m### Oversampling Mitigation[0m
[30;1m158 | [0m[35mTo modify the sampling decision at the subsegment level, subsegments that inherit the decision of th[0m
[30;1m159 | [0m[35m`xray_recorder.begin_subsegment_without_sampling()`.[0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35mThe code snippet below demonstrates creating a sampled or unsampled subsegment based on the sampling[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35mTo install the SDK's testing dependencies, use the following command.[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m```[0m
[30;1m57 | [0m[35mpip install tox[0m
[30;1m58 | [0m[35m```[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m## Getting Help[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35mInstall the SDK using the following command (the SDK's non-testing dependencies will be installed).[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m```[0m
[30;1m51 | [0m[35mpip install aws-xray-sdk[0m
[30;1m52 | [0m[35m```[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35mTo install the SDK's testing dependencies, use the following command.[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/context.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m76 | [0m[35m        subsegment to end.[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m        :param float end_time: epoch in seconds. If not specified the current[0m
[30;1m79 | [0m[35m            system time will be used.[0m
[30;1m80 | [0m[35m        """[0m
[30;1m81 | [0m[35m        entity = self.get_trace_entity()[0m
[30;1m82 | [0m[35m        if self._is_subsegment(entity):[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/context.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m        End the current active segment.[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m        :param float end_time: epoch in seconds. If not specified the current[0m
[30;1m48 | [0m[35m            system time will be used.[0m
[30;1m49 | [0m[35m        """[0m
[30;1m50 | [0m[35m        entity = self.get_trace_entity()[0m
[30;1m51 | [0m[35m        if not entity:[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/context.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mlog = logging.getLogger(__name__)[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mMISSING_SEGMENT_MSG = 'cannot find the current segment/subsegment, please make sure you have a segme[0m
[30;1m13 | [0m[35mSUPPORTED_CONTEXT_MISSING = ('RUNTIME_ERROR', 'LOG_ERROR', 'IGNORE_ERROR')[0m
[30;1m14 | [0m[35mCXT_MISSING_STRATEGY_KEY = 'AWS_XRAY_CONTEXT_MISSING'[0m
[30;1m15 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/sampler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m            self.start() # only front-end that actually uses the sampler spawns poller threads[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m        now = int(time.time())[0m
[30;1m65 | [0m[35m        if sampling_req and not sampling_req.get('service_type', None):[0m
[30;1m66 | [0m[35m            sampling_req['service_type'] = self._origin[0m
[30;1m67 | [0m[35m        elif sampling_req is None:[0m
[30;1m68 | [0m[35m            sampling_req = {'service_type': self._origin}[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/sampler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport logging[0m
[30;1m2 | [0m[35mfrom random import Random[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mimport threading[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom .local.sampler import LocalSampler[0m
[30;1m7 | [0m[35mfrom .rule_cache import RuleCache[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/sampler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mclass DefaultSampler:[0m
[30;1m18 | [0m[35m    """Making sampling decisions based on centralized sampling rules defined[0m
[30;1m19 | [0m[35m    by X-Ray control plane APIs. It will fall back to local sampler if[0m
[30;1m20 | [0m[35m    centralized sampling rules are not available.[0m
[30;1m21 | [0m[35m    """[0m
[30;1m22 | [0m[35m    def __init__(self):[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/recorder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m89 | [0m[35m        Configure needs to run before patching thrid party libraries[0m
[30;1m90 | [0m[35m        to avoid creating dangling subsegment.[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m        :param bool sampling: If sampling is enabled, every time the recorder[0m
[30;1m93 | [0m[35m            creates a segment it decides whether to send this segment to[0m
[30;1m94 | [0m[35m            the X-Ray daemon. This setting is not used if the recorder[0m
[30;1m95 | [0m[35m            is running in AWS Lambda. The recorder always respect the incoming[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/recorder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m43 | [0m[35m    """[0m
[30;1m44 | [0m[35m    A global AWS X-Ray recorder that will begin/end segments/subsegments[0m
[30;1m45 | [0m[35m    and send them to the X-Ray daemon. This recorder is initialized during[0m
[30;1m46 | [0m[35m    loading time so you can use::[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m        from aws_xray_sdk.core import xray_recorder[0m
[30;1m49 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/recorder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mimport logging[0m
[30;1m4 | [0m[35mimport os[0m
[30;1m5 | [0m[35mimport platform[0m
[30;1m6 | [0m[35mimport time[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mfrom aws_xray_sdk import global_sdk_config[0m
[30;1m9 | [0m[35mfrom aws_xray_sdk.version import VERSION[0m
[30;1m10 | [0m[35mfrom .models.segment import Segment, SegmentContextManager[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/recorder.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m205 | [0m[35m                      parent_id=None, sampling=None):[0m
[30;1m206 | [0m[35m        """[0m
[30;1m207 | [0m[35m        Begin a segment on the current thread and return it. The recorder[0m
[30;1m208 | [0m[35m        only keeps one segment at a time. Create the second one without[0m
[30;1m209 | [0m[35m        closing existing one will overwrite it.[0m
[30;1m210 | [0m[35m[0m
[30;1m211 | [0m[35m        :param str name: the name of the segment[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/README.md[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m500 | [0m[35masync def foo():[0m
[30;1m501 | [0m[35m    trace_config = aws_xray_trace_config()[0m
[30;1m502 | [0m[35m    async with ClientSession(loop=loop, trace_configs=[trace_config]) as session:[0m
[30;1m503 | [0m[35m        async with session.get(url) as resp[0m
[30;1m504 | [0m[35m            await resp.read()[0m
[30;1m505 | [0m[35m```[0m
[30;1m506 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/README.md[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m315 | [0m[35m    xray_recorder.set_trace_entity(trace_entity)[0m
[30;1m316 | [0m[35m    # Subsegment captured from the following HTTP GET will be[0m
[30;1m317 | [0m[35m    # a child of parent entity passed from the main thread.[0m
[30;1m318 | [0m[35m    resp = requests.get(url)[0m
[30;1m319 | [0m[35m    # prevent thread pollution[0m
[30;1m320 | [0m[35m    xray_recorder.clear_trace_entities()[0m
[30;1m321 | [0m[35m    return resp[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/README.md[0m
   Pattern: [32m.hostname[0m
[30;1m557 | [0m[35mxray_add_ignored(urls=['/test-path', '/other-test-path'])[0m
[30;1m558 | [0m[35m[0m
[30;1m559 | [0m[35m# ignore requests to myapp.com for /test-url[0m
[30;1m560 | [0m[35mxray_add_ignored(hostname='myapp.com', urls=['/test-url'])[0m
[30;1m561 | [0m[35m```[0m
[30;1m562 | [0m[35m[0m
[30;1m563 | [0m[35mIf you use a subclass of httplib to make your requests, you can also filter on the class name that i[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/README.md[0m
   Pattern: [32m.hostname[0m
[30;1m551 | [0m[35mxray_add_ignored(hostname='test.myapp.com')[0m
[30;1m552 | [0m[35m[0m
[30;1m553 | [0m[35m# ignore requests to a subdomain of myapp.com with a glob pattern[0m
[30;1m554 | [0m[35mxray_add_ignored(hostname='*.myapp.com')[0m
[30;1m555 | [0m[35m[0m
[30;1m556 | [0m[35m# ignore requests to /test-url and /other-test-url[0m
[30;1m557 | [0m[35mxray_add_ignored(urls=['/test-path', '/other-test-path'])[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/README.md[0m
   Pattern: [32m.hostname[0m
[30;1m548 | [0m[35mfrom aws_xray_sdk.ext.httplib import add_ignored as xray_add_ignored[0m
[30;1m549 | [0m[35m[0m
[30;1m550 | [0m[35m# ignore requests to test.myapp.com[0m
[30;1m551 | [0m[35mxray_add_ignored(hostname='test.myapp.com')[0m
[30;1m552 | [0m[35m[0m
[30;1m553 | [0m[35m# ignore requests to a subdomain of myapp.com with a glob pattern[0m
[30;1m554 | [0m[35mxray_add_ignored(hostname='*.myapp.com')[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/README.md[0m
   Pattern: [32m.hostname[0m
[30;1m542 | [0m[35m[0m
[30;1m543 | [0m[35m### Ignoring httplib requests[0m
[30;1m544 | [0m[35m[0m
[30;1m545 | [0m[35mIf you want to ignore certain httplib requests you can do so based on the hostname or URL that is be[0m
[30;1m546 | [0m[35m[0m
[30;1m547 | [0m[35m```python[0m
[30;1m548 | [0m[35mfrom aws_xray_sdk.ext.httplib import add_ignored as xray_add_ignored[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/README.md[0m
   Pattern: [32m.hostname[0m
[30;1m542 | [0m[35m[0m
[30;1m543 | [0m[35m### Ignoring httplib requests[0m
[30;1m544 | [0m[35m[0m
[30;1m545 | [0m[35mIf you want to ignore certain httplib requests you can do so based on the hostname or URL that is be[0m
[30;1m546 | [0m[35m[0m
[30;1m547 | [0m[35m```python[0m
[30;1m548 | [0m[35mfrom aws_xray_sdk.ext.httplib import add_ignored as xray_add_ignored[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m  | [0m[35msampled) requests (this is applicable for trace id injection into logs use case) then they should se[0m
[30;1m  | [0m[35m[0m
[30;1m  | [0m[35m### Disabling X-Ray[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m129 | [0m[35m```[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m### Oversampling Mitigation[0m
[30;1m132 | [0m[35mTo modify the sampling decision at the subsegment level, subsegments that inherit the decision of th[0m
[30;1m133 | [0m[35m`xray_recorder.begin_subsegment_without_sampling()`.[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35mThe code snippet below demonstrates creating a sampled or unsampled subsegment based on the sampling[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35mTo install the SDK's testing dependencies, use the following command.[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m```[0m
[30;1m31 | [0m[35mpip install tox[0m
[30;1m32 | [0m[35m```[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m## Getting Help[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mInstall the SDK using the following command (the SDK's non-testing dependencies will be installed).[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m```[0m
[30;1m25 | [0m[35mpip install aws-xray-sdk[0m
[30;1m26 | [0m[35m```[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35mTo install the SDK's testing dependencies, use the following command.[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/django/db.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m71 | [0m[35m        if hasattr(self, 'settings_dict'):[0m
[30;1m72 | [0m[35m            settings = self.settings_dict[0m
[30;1m73 | [0m[35m            host = settings.get('HOST', None)[0m
[30;1m74 | [0m[35m            user = settings.get('USER', None)[0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m        if host:[0m
[30;1m77 | [0m[35m            meta['name'] = host[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/django/db.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m        if hasattr(self, 'settings_dict'):[0m
[30;1m72 | [0m[35m            settings = self.settings_dict[0m
[30;1m73 | [0m[35m            host = settings.get('HOST', None)[0m
[30;1m74 | [0m[35m            user = settings.get('USER', None)[0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m        if host:[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/models/facade_segment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35m    """[0m
[30;1m10 | [0m[35m    This type of segment should only be used in an AWS Lambda environment.[0m
[30;1m11 | [0m[35m    It holds the same id, traceid and sampling decision as[0m
[30;1m12 | [0m[35m    the segment generated by Lambda service but its properties cannot[0m
[30;1m13 | [0m[35m    be mutated except for its subsegments. If this segment is created[0m
[30;1m14 | [0m[35m    before Lambda worker finishes initializatioin, all the child[0m
[30;1m15 | [0m[35m    subsegments will be discarded.[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk.egg-info/PKG-INFO[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m526 | [0m[35masync def foo():[0m
[30;1m527 | [0m[35m    trace_config = aws_xray_trace_config()[0m
[30;1m528 | [0m[35m    async with ClientSession(loop=loop, trace_configs=[trace_config]) as session:[0m
[30;1m529 | [0m[35m        async with session.get(url) as resp[0m
[30;1m530 | [0m[35m            await resp.read()[0m
[30;1m531 | [0m[35m```[0m
[30;1m532 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk.egg-info/PKG-INFO[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m341 | [0m[35m    xray_recorder.set_trace_entity(trace_entity)[0m
[30;1m342 | [0m[35m    # Subsegment captured from the following HTTP GET will be[0m
[30;1m343 | [0m[35m    # a child of parent entity passed from the main thread.[0m
[30;1m344 | [0m[35m    resp = requests.get(url)[0m
[30;1m345 | [0m[35m    # prevent thread pollution[0m
[30;1m346 | [0m[35m    xray_recorder.clear_trace_entities()[0m
[30;1m347 | [0m[35m    return resp[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk.egg-info/PKG-INFO[0m
   Pattern: [32m.hostname[0m
[30;1m583 | [0m[35mxray_add_ignored(urls=['/test-path', '/other-test-path'])[0m
[30;1m584 | [0m[35m[0m
[30;1m585 | [0m[35m# ignore requests to myapp.com for /test-url[0m
[30;1m586 | [0m[35mxray_add_ignored(hostname='myapp.com', urls=['/test-url'])[0m
[30;1m587 | [0m[35m```[0m
[30;1m588 | [0m[35m[0m
[30;1m589 | [0m[35mIf you use a subclass of httplib to make your requests, you can also filter on the class name that i[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk.egg-info/PKG-INFO[0m
   Pattern: [32m.hostname[0m
[30;1m577 | [0m[35mxray_add_ignored(hostname='test.myapp.com')[0m
[30;1m578 | [0m[35m[0m
[30;1m579 | [0m[35m# ignore requests to a subdomain of myapp.com with a glob pattern[0m
[30;1m580 | [0m[35mxray_add_ignored(hostname='*.myapp.com')[0m
[30;1m581 | [0m[35m[0m
[30;1m582 | [0m[35m# ignore requests to /test-url and /other-test-url[0m
[30;1m583 | [0m[35mxray_add_ignored(urls=['/test-path', '/other-test-path'])[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk.egg-info/PKG-INFO[0m
   Pattern: [32m.hostname[0m
[30;1m574 | [0m[35mfrom aws_xray_sdk.ext.httplib import add_ignored as xray_add_ignored[0m
[30;1m575 | [0m[35m[0m
[30;1m576 | [0m[35m# ignore requests to test.myapp.com[0m
[30;1m577 | [0m[35mxray_add_ignored(hostname='test.myapp.com')[0m
[30;1m578 | [0m[35m[0m
[30;1m579 | [0m[35m# ignore requests to a subdomain of myapp.com with a glob pattern[0m
[30;1m580 | [0m[35mxray_add_ignored(hostname='*.myapp.com')[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk.egg-info/PKG-INFO[0m
   Pattern: [32m.hostname[0m
[30;1m568 | [0m[35m[0m
[30;1m569 | [0m[35m### Ignoring httplib requests[0m
[30;1m570 | [0m[35m[0m
[30;1m571 | [0m[35mIf you want to ignore certain httplib requests you can do so based on the hostname or URL that is be[0m
[30;1m572 | [0m[35m[0m
[30;1m573 | [0m[35m```python[0m
[30;1m574 | [0m[35mfrom aws_xray_sdk.ext.httplib import add_ignored as xray_add_ignored[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk.egg-info/PKG-INFO[0m
   Pattern: [32m.hostname[0m
[30;1m568 | [0m[35m[0m
[30;1m569 | [0m[35m### Ignoring httplib requests[0m
[30;1m570 | [0m[35m[0m
[30;1m571 | [0m[35mIf you want to ignore certain httplib requests you can do so based on the hostname or URL that is be[0m
[30;1m572 | [0m[35m[0m
[30;1m573 | [0m[35m```python[0m
[30;1m574 | [0m[35mfrom aws_xray_sdk.ext.httplib import add_ignored as xray_add_ignored[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk.egg-info/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m  | [0m[35msampled) requests (this is applicable for trace id injection into logs use case) then they should se[0m
[30;1m  | [0m[35m[0m
[30;1m  | [0m[35m### Disabling X-Ray[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk.egg-info/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m155 | [0m[35m```[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m### Oversampling Mitigation[0m
[30;1m158 | [0m[35mTo modify the sampling decision at the subsegment level, subsegments that inherit the decision of th[0m
[30;1m159 | [0m[35m`xray_recorder.begin_subsegment_without_sampling()`.[0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35mThe code snippet below demonstrates creating a sampled or unsampled subsegment based on the sampling[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35mTo install the SDK's testing dependencies, use the following command.[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m```[0m
[30;1m57 | [0m[35mpip install tox[0m
[30;1m58 | [0m[35m```[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m## Getting Help[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35mInstall the SDK using the following command (the SDK's non-testing dependencies will be installed).[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m```[0m
[30;1m51 | [0m[35mpip install aws-xray-sdk[0m
[30;1m52 | [0m[35m```[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35mTo install the SDK's testing dependencies, use the following command.[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/sdk_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m62 | [0m[35m        """[0m
[30;1m63 | [0m[35m        Modifies the enabled flag if the "AWS_XRAY_SDK_ENABLED" environment variable is not set,[0m
[30;1m64 | [0m[35m        otherwise, set the enabled flag to be equal to the environment variable. If the[0m
[30;1m65 | [0m[35m        env variable is an invalid string boolean, it will default to true.[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m        :param bool value: Flag to set whether the SDK is enabled or disabled.[0m
[30;1m68 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_serialize_entities.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m130 | [0m[35m        [0m
[30;1m131 | [0m[35m    class TestSubMetadata():[0m
[30;1m132 | [0m[35m        def __init__(self, time):[0m
[30;1m133 | [0m[35m            self.time = time[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m    segment = Segment('test')[0m
[30;1m136 | [0m[35m    [0m
[30;1m137 | [0m[35m    segment.put_metadata('key_one', TestMetadata(1,2), 'namespace_one')[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_utils.py[0m
   Pattern: [32m.hostname[0m
[30;1m42 | [0m[35m    s6 = get_hostname("")[0m
[30;1m43 | [0m[35m    assert s6 == UNKNOWN_HOST[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m    s7 = get_hostname(None)[0m
[30;1m46 | [0m[35m    assert s7 == UNKNOWN_HOST[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_utils.py[0m
   Pattern: [32m.hostname[0m
[30;1m39 | [0m[35m    s5 = get_hostname("INVALID_URL")[0m
[30;1m40 | [0m[35m    assert s5 == UNKNOWN_HOST[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m    s6 = get_hostname("")[0m
[30;1m43 | [0m[35m    assert s6 == UNKNOWN_HOST[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m    s7 = get_hostname(None)[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_utils.py[0m
   Pattern: [32m.hostname[0m
[30;1m36 | [0m[35m    s4 = get_hostname("https://amazon.com/somestuff?get=request&data=chiem")[0m
[30;1m37 | [0m[35m    assert s4 == "amazon.com"[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m    s5 = get_hostname("INVALID_URL")[0m
[30;1m40 | [0m[35m    assert s5 == UNKNOWN_HOST[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m    s6 = get_hostname("")[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_utils.py[0m
   Pattern: [32m.hostname[0m
[30;1m33 | [0m[35m    s3 = get_hostname("http://aws.amazon.com/should_get/sub/domains")[0m
[30;1m34 | [0m[35m    assert s3 == "aws.amazon.com"[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m    s4 = get_hostname("https://amazon.com/somestuff?get=request&data=chiem")[0m
[30;1m37 | [0m[35m    assert s4 == "amazon.com"[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m    s5 = get_hostname("INVALID_URL")[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_utils.py[0m
   Pattern: [32m.hostname[0m
[30;1m30 | [0m[35m    s2 = get_hostname("https://amazon.com/avery_long/path/and/stuff")[0m
[30;1m31 | [0m[35m    assert s2 == "amazon.com"[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    s3 = get_hostname("http://aws.amazon.com/should_get/sub/domains")[0m
[30;1m34 | [0m[35m    assert s3 == "aws.amazon.com"[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m    s4 = get_hostname("https://amazon.com/somestuff?get=request&data=chiem")[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_utils.py[0m
   Pattern: [32m.hostname[0m
[30;1m27 | [0m[35m    s1 = get_hostname("https://amazon.com/")[0m
[30;1m28 | [0m[35m    assert s1 == "amazon.com"[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m    s2 = get_hostname("https://amazon.com/avery_long/path/and/stuff")[0m
[30;1m31 | [0m[35m    assert s2 == "amazon.com"[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    s3 = get_hostname("http://aws.amazon.com/should_get/sub/domains")[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_utils.py[0m
   Pattern: [32m.hostname[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35mdef test_get_hostname():[0m
[30;1m27 | [0m[35m    s1 = get_hostname("https://amazon.com/")[0m
[30;1m28 | [0m[35m    assert s1 == "amazon.com"[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m    s2 = get_hostname("https://amazon.com/avery_long/path/and/stuff")[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_utils.py[0m
   Pattern: [32m.hostname[0m
[30;1m23 | [0m[35m    assert s4 == 'get_http_response'[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35mdef test_get_hostname():[0m
[30;1m27 | [0m[35m    s1 = get_hostname("https://amazon.com/")[0m
[30;1m28 | [0m[35m    assert s1 == "amazon.com"[0m
[30;1m29 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_utils.py[0m
   Pattern: [32m.hostname[0m
[30;1m1 | [0m[35mfrom aws_xray_sdk.ext.util import to_snake_case, get_hostname, strip_url, inject_trace_header[0m
[30;1m2 | [0m[35mfrom aws_xray_sdk.core.models.segment import Segment[0m
[30;1m3 | [0m[35mfrom aws_xray_sdk.core.models.subsegment import Subsegment[0m
[30;1m4 | [0m[35mfrom aws_xray_sdk.core.models.dummy_entities import DummySegment, DummySubsegment[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/streaming/default_streaming.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m26 | [0m[35m        Stream out all eligible children of the input entity.[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m        :param entity: The target entity to be streamed.[0m
[30;1m29 | [0m[35m        :param callback: The function that takes the node and[0m
[30;1m30 | [0m[35m            actually send it out.[0m
[30;1m31 | [0m[35m        """[0m
[30;1m32 | [0m[35m        with self._lock:[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/rule_poller.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    def wake_up(self):[0m
[30;1m38 | [0m[35m        """[0m
[30;1m39 | [0m[35m        Force the rule poller to pull the sampling rules from the service[0m
[30;1m40 | [0m[35m        regardless of the polling interval.[0m
[30;1m41 | [0m[35m        This method is intended to be used by ``TargetPoller`` only.[0m
[30;1m42 | [0m[35m        """[0m
[30;1m43 | [0m[35m        self._time_elapsed = self._time_to_wait + 1000[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/rule_poller.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport logging[0m
[30;1m2 | [0m[35mfrom random import Random[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mimport threading[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mlog = logging.getLogger(__name__)[0m
[30;1m7 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/models/trace_header.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m            return cls([0m
[30;1m65 | [0m[35m                root=header_dict.get(ROOT, None),[0m
[30;1m66 | [0m[35m                parent=header_dict.get(PARENT, None),[0m
[30;1m67 | [0m[35m                sampled=header_dict.get(SAMPLE, None),[0m
[30;1m68 | [0m[35m                data=data,[0m
[30;1m69 | [0m[35m            )[0m
[30;1m70 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/models/trace_header.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m            return cls([0m
[30;1m65 | [0m[35m                root=header_dict.get(ROOT, None),[0m
[30;1m66 | [0m[35m                parent=header_dict.get(PARENT, None),[0m
[30;1m67 | [0m[35m                sampled=header_dict.get(SAMPLE, None),[0m
[30;1m68 | [0m[35m                data=data,[0m
[30;1m69 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/models/trace_header.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m                    data[key] = entry[1][0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m            return cls([0m
[30;1m65 | [0m[35m                root=header_dict.get(ROOT, None),[0m
[30;1m66 | [0m[35m                parent=header_dict.get(PARENT, None),[0m
[30;1m67 | [0m[35m                sampled=header_dict.get(SAMPLE, None),[0m
[30;1m68 | [0m[35m                data=data,[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/models/trace_header.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14 | [0m[35m    """[0m
[30;1m15 | [0m[35m    The sampling decision and trace ID are added to HTTP requests in[0m
[30;1m16 | [0m[35m    tracing headers named ``X-Amzn-Trace-Id``. The first X-Ray-integrated[0m
[30;1m17 | [0m[35m    service that the request hits adds a tracing header, which is read[0m
[30;1m18 | [0m[35m    by the X-Ray SDK and included in the response. Learn more about[0m
[30;1m19 | [0m[35m    `Tracing Header <http://docs.aws.amazon.com/xray/latest/devguide/xray-concepts.html#xray-concept[0m
[30;1m20 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/requests/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35m                       return_value, exception, subsegment, stack):[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    method = kwargs.get('method') or args[0][0m
[30;1m48 | [0m[35m    url = kwargs.get('url') or args[1][0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m    subsegment.put_http_meta(http.METHOD, method)[0m
[30;1m51 | [0m[35m    subsegment.put_http_meta(http.URL, strip_url(url))[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/requests/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m44 | [0m[35mdef requests_processor(wrapped, instance, args, kwargs,[0m
[30;1m45 | [0m[35m                       return_value, exception, subsegment, stack):[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    method = kwargs.get('method') or args[0][0m
[30;1m48 | [0m[35m    url = kwargs.get('url') or args[1][0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m    subsegment.put_http_meta(http.METHOD, method)[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/requests/patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mdef _xray_traced_requests(wrapped, instance, args, kwargs):[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m    url = kwargs.get('url') or args[1][0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    return xray_recorder.record_subsegment([0m
[30;1m28 | [0m[35m        wrapped, instance, args, kwargs,[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/requests/patch.py[0m
   Pattern: [32m.hostname[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    return xray_recorder.record_subsegment([0m
[30;1m28 | [0m[35m        wrapped, instance, args, kwargs,[0m
[30;1m29 | [0m[35m        name=get_hostname(url),[0m
[30;1m30 | [0m[35m        namespace='remote',[0m
[30;1m31 | [0m[35m        meta_processor=requests_processor,[0m
[30;1m32 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/requests/patch.py[0m
   Pattern: [32m.hostname[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom aws_xray_sdk.core import xray_recorder[0m
[30;1m4 | [0m[35mfrom aws_xray_sdk.core.models import http[0m
[30;1m5 | [0m[35mfrom aws_xray_sdk.ext.util import inject_trace_header, strip_url, get_hostname[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mdef patch():[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/aiobotocore/patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35masync def _xray_traced_aiobotocore(wrapped, instance, args, kwargs):[0m
[30;1m31 | [0m[35m    service = instance._service_model.metadata["endpointPrefix"][0m
[30;1m32 | [0m[35m    result = await xray_recorder.record_subsegment_async([0m
[30;1m33 | [0m[35m        wrapped, instance, args, kwargs,[0m
[30;1m34 | [0m[35m        name=service,[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/sqlalchemy/util/decorators.py[0m
   Pattern: [32m.hostname[0m
[30;1m77 | [0m[35m# fragment	4	Fragment identifier	empty string[0m
[30;1m78 | [0m[35m# username	 	User name	None[0m
[30;1m79 | [0m[35m# password	 	Password	None[0m
[30;1m80 | [0m[35m# hostname	 	Host name (lower case)	None[0m
[30;1m81 | [0m[35m# port	 	Port number as integer, if present	None[0m
[30;1m82 | [0m[35m#[0m
[30;1m83 | [0m[35m# XRAY Trace SQL metaData Sample[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/models/subsegment.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m134 | [0m[35m        parent segment's ref counter by 1.[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m        :param float end_time: Epoch in seconds. If not specified[0m
[30;1m137 | [0m[35m            current time will be used.[0m
[30;1m138 | [0m[35m        """[0m
[30;1m139 | [0m[35m        super().close(end_time)[0m
[30;1m140 | [0m[35m        self.parent_segment.decrement_ref_counter()[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/models/entity.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m173 | [0m[35m            log.warning("Prefix 'AWS.' is reserved, drop metadata with namespace %s", namespace)[0m
[30;1m174 | [0m[35m            return[0m
[30;1m175 | [0m[35m[0m
[30;1m176 | [0m[35m        if self.metadata.get(namespace, None):[0m
[30;1m177 | [0m[35m            self.metadata[namespace][key] = value[0m
[30;1m178 | [0m[35m        else:[0m
[30;1m179 | [0m[35m            self.metadata[namespace] = {key: value}[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/models/entity.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mlog = logging.getLogger(__name__)[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m# Valid characters can be found at http://docs.aws.amazon.com/xray/latest/devguide/xray-api-segmentd[0m
[30;1m18 | [0m[35m_common_invalid_name_characters = '?;*()!$~^<>'[0m
[30;1m19 | [0m[35m_valid_annotation_key_characters = string.ascii_letters + string.digits + '_'[0m
[30;1m20 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/models/entity.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m65 | [0m[35m        and flip the in progress flag to False.[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m        :param float end_time: Epoch in seconds. If not specified[0m
[30;1m68 | [0m[35m            current time will be used.[0m
[30;1m69 | [0m[35m        """[0m
[30;1m70 | [0m[35m        self._check_ended()[0m
[30;1m71 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/models/entity.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport logging[0m
[30;1m2 | [0m[35mimport os[0m
[30;1m3 | [0m[35mimport binascii[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35mimport string[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mimport json[0m
[30;1m8 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/django/middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m93 | [0m[35m        elif meta.get(REMOTE_ADDR_KEY):[0m
[30;1m94 | [0m[35m            segment.put_http_meta(http.CLIENT_IP, meta.get(REMOTE_ADDR_KEY))[0m
[30;1m95 | [0m[35m            if self._urls_as_annotation():[0m
[30;1m96 | [0m[35m                segment.put_annotation(http.CLIENT_IP, meta.get(REMOTE_ADDR_KEY))[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m        response = self.get_response(request)[0m
[30;1m99 | [0m[35m        segment.put_http_meta(http.STATUS, response.status_code)[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/django/middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m                segment.put_annotation(http.CLIENT_IP, meta.get(X_FORWARDED_KEY))[0m
[30;1m92 | [0m[35m                segment.put_annotation(http.X_FORWARDED_FOR, True)[0m
[30;1m93 | [0m[35m        elif meta.get(REMOTE_ADDR_KEY):[0m
[30;1m94 | [0m[35m            segment.put_http_meta(http.CLIENT_IP, meta.get(REMOTE_ADDR_KEY))[0m
[30;1m95 | [0m[35m            if self._urls_as_annotation():[0m
[30;1m96 | [0m[35m                segment.put_annotation(http.CLIENT_IP, meta.get(REMOTE_ADDR_KEY))[0m
[30;1m97 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/django/middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m90 | [0m[35m            if self._urls_as_annotation():[0m
[30;1m91 | [0m[35m                segment.put_annotation(http.CLIENT_IP, meta.get(X_FORWARDED_KEY))[0m
[30;1m92 | [0m[35m                segment.put_annotation(http.X_FORWARDED_FOR, True)[0m
[30;1m93 | [0m[35m        elif meta.get(REMOTE_ADDR_KEY):[0m
[30;1m94 | [0m[35m            segment.put_http_meta(http.CLIENT_IP, meta.get(REMOTE_ADDR_KEY))[0m
[30;1m95 | [0m[35m            if self._urls_as_annotation():[0m
[30;1m96 | [0m[35m                segment.put_annotation(http.CLIENT_IP, meta.get(REMOTE_ADDR_KEY))[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/django/middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m88 | [0m[35m            segment.put_http_meta(http.CLIENT_IP, meta.get(X_FORWARDED_KEY))[0m
[30;1m89 | [0m[35m            segment.put_http_meta(http.X_FORWARDED_FOR, True)[0m
[30;1m90 | [0m[35m            if self._urls_as_annotation():[0m
[30;1m91 | [0m[35m                segment.put_annotation(http.CLIENT_IP, meta.get(X_FORWARDED_KEY))[0m
[30;1m92 | [0m[35m                segment.put_annotation(http.X_FORWARDED_FOR, True)[0m
[30;1m93 | [0m[35m        elif meta.get(REMOTE_ADDR_KEY):[0m
[30;1m94 | [0m[35m            segment.put_http_meta(http.CLIENT_IP, meta.get(REMOTE_ADDR_KEY))[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/django/middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m        if meta.get(X_FORWARDED_KEY):[0m
[30;1m86 | [0m[35m            # X_FORWARDED_FOR may come from untrusted source so we[0m
[30;1m87 | [0m[35m            # need to set the flag to true as additional information[0m
[30;1m88 | [0m[35m            segment.put_http_meta(http.CLIENT_IP, meta.get(X_FORWARDED_KEY))[0m
[30;1m89 | [0m[35m            segment.put_http_meta(http.X_FORWARDED_FOR, True)[0m
[30;1m90 | [0m[35m            if self._urls_as_annotation():[0m
[30;1m91 | [0m[35m                segment.put_annotation(http.CLIENT_IP, meta.get(X_FORWARDED_KEY))[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/django/middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m82 | [0m[35m            segment.put_http_meta(http.USER_AGENT, meta.get(USER_AGENT_KEY))[0m
[30;1m83 | [0m[35m            if self._urls_as_annotation():[0m
[30;1m84 | [0m[35m                segment.put_annotation(http.USER_AGENT, meta.get(USER_AGENT_KEY))[0m
[30;1m85 | [0m[35m        if meta.get(X_FORWARDED_KEY):[0m
[30;1m86 | [0m[35m            # X_FORWARDED_FOR may come from untrusted source so we[0m
[30;1m87 | [0m[35m            # need to set the flag to true as additional information[0m
[30;1m88 | [0m[35m            segment.put_http_meta(http.CLIENT_IP, meta.get(X_FORWARDED_KEY))[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/django/middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m        if meta.get(USER_AGENT_KEY):[0m
[30;1m82 | [0m[35m            segment.put_http_meta(http.USER_AGENT, meta.get(USER_AGENT_KEY))[0m
[30;1m83 | [0m[35m            if self._urls_as_annotation():[0m
[30;1m84 | [0m[35m                segment.put_annotation(http.USER_AGENT, meta.get(USER_AGENT_KEY))[0m
[30;1m85 | [0m[35m        if meta.get(X_FORWARDED_KEY):[0m
[30;1m86 | [0m[35m            # X_FORWARDED_FOR may come from untrusted source so we[0m
[30;1m87 | [0m[35m            # need to set the flag to true as additional information[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/django/middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m79 | [0m[35m            segment.put_annotation(http.METHOD, request.method)[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m        if meta.get(USER_AGENT_KEY):[0m
[30;1m82 | [0m[35m            segment.put_http_meta(http.USER_AGENT, meta.get(USER_AGENT_KEY))[0m
[30;1m83 | [0m[35m            if self._urls_as_annotation():[0m
[30;1m84 | [0m[35m                segment.put_annotation(http.USER_AGENT, meta.get(USER_AGENT_KEY))[0m
[30;1m85 | [0m[35m        if meta.get(X_FORWARDED_KEY):[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/django/middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m78 | [0m[35m            segment.put_annotation(http.URL, request.build_absolute_uri())[0m
[30;1m79 | [0m[35m            segment.put_annotation(http.METHOD, request.method)[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m        if meta.get(USER_AGENT_KEY):[0m
[30;1m82 | [0m[35m            segment.put_http_meta(http.USER_AGENT, meta.get(USER_AGENT_KEY))[0m
[30;1m83 | [0m[35m            if self._urls_as_annotation():[0m
[30;1m84 | [0m[35m                segment.put_annotation(http.USER_AGENT, meta.get(USER_AGENT_KEY))[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/django/middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m        name = calculate_segment_name(meta.get(HOST_KEY), xray_recorder)[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m        sampling_req = {[0m
[30;1m52 | [0m[35m            'host': meta.get(HOST_KEY),[0m
[30;1m53 | [0m[35m            'method': request.method,[0m
[30;1m54 | [0m[35m            'path': request.path,[0m
[30;1m55 | [0m[35m            'service': name,[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/django/middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m        meta = request.META[0m
[30;1m47 | [0m[35m        xray_header = construct_xray_header(meta)[0m
[30;1m48 | [0m[35m        # a segment name is required[0m
[30;1m49 | [0m[35m        name = calculate_segment_name(meta.get(HOST_KEY), xray_recorder)[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m        sampling_req = {[0m
[30;1m52 | [0m[35m            'host': meta.get(HOST_KEY),[0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000703[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Username[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_trace_entities.py[0m
   Pattern: [32m.userInfo[0m
[30;1m31 | [0m[35m    segment.set_user('whoami')[0m
[30;1m32 | [0m[35m    doc = entity_to_dict(segment)[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    assert doc['user'] == 'whoami'[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35mdef test_put_http_meta():[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000703[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Username[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_trace_entities.py[0m
   Pattern: [32m.userInfo[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35mdef test_segment_user():[0m
[30;1m30 | [0m[35m    segment = Segment('seg')[0m
[30;1m31 | [0m[35m    segment.set_user('whoami')[0m
[30;1m32 | [0m[35m    doc = entity_to_dict(segment)[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    assert doc['user'] == 'whoami'[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/httplib/patch.py[0m
   Pattern: [32m.hostname[0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35m    return xray_recorder.record_subsegment([0m
[30;1m172 | [0m[35m        wrapped, instance, args, kwargs,[0m
[30;1m173 | [0m[35m        name=get_hostname(xray_data.url),[0m
[30;1m174 | [0m[35m        namespace='remote',[0m
[30;1m175 | [0m[35m        meta_processor=http_read_processor[0m
[30;1m176 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/httplib/patch.py[0m
   Pattern: [32m.hostname[0m
[30;1m140 | [0m[35m        # we add a segment here in case connect fails[0m
[30;1m141 | [0m[35m        return xray_recorder.record_subsegment([0m
[30;1m142 | [0m[35m            wrapped, instance, args, kwargs,[0m
[30;1m143 | [0m[35m            name=get_hostname(xray_data.url),[0m
[30;1m144 | [0m[35m            namespace='remote',[0m
[30;1m145 | [0m[35m            meta_processor=http_send_request_processor[0m
[30;1m146 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/httplib/patch.py[0m
   Pattern: [32m.hostname[0m
[30;1m100 | [0m[35m        subclass = module + '.' + instance.__class__.__name__[0m
[30;1m101 | [0m[35m    for rule in _XRAY_IGNORE:[0m
[30;1m102 | [0m[35m        subclass_match = subclass == rule.subclass if rule.subclass is not None else True[0m
[30;1m103 | [0m[35m        host_match = fnmatch.fnmatch(hostname, rule.hostname) if rule.hostname is not None else True[0m
[30;1m104 | [0m[35m        url_match = url in rule.urls if rule.urls is not None else True[0m
[30;1m105 | [0m[35m        if url_match and host_match and subclass_match:[0m
[30;1m106 | [0m[35m            return True[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/httplib/patch.py[0m
   Pattern: [32m.hostname[0m
[30;1m100 | [0m[35m        subclass = module + '.' + instance.__class__.__name__[0m
[30;1m101 | [0m[35m    for rule in _XRAY_IGNORE:[0m
[30;1m102 | [0m[35m        subclass_match = subclass == rule.subclass if rule.subclass is not None else True[0m
[30;1m103 | [0m[35m        host_match = fnmatch.fnmatch(hostname, rule.hostname) if rule.hostname is not None else True[0m
[30;1m104 | [0m[35m        url_match = url in rule.urls if rule.urls is not None else True[0m
[30;1m105 | [0m[35m        if url_match and host_match and subclass_match:[0m
[30;1m106 | [0m[35m            return True[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/httplib/patch.py[0m
   Pattern: [32m.hostname[0m
[30;1m100 | [0m[35m        subclass = module + '.' + instance.__class__.__name__[0m
[30;1m101 | [0m[35m    for rule in _XRAY_IGNORE:[0m
[30;1m102 | [0m[35m        subclass_match = subclass == rule.subclass if rule.subclass is not None else True[0m
[30;1m103 | [0m[35m        host_match = fnmatch.fnmatch(hostname, rule.hostname) if rule.hostname is not None else True[0m
[30;1m104 | [0m[35m        url_match = url in rule.urls if rule.urls is not None else True[0m
[30;1m105 | [0m[35m        if url_match and host_match and subclass_match:[0m
[30;1m106 | [0m[35m            return True[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/httplib/patch.py[0m
   Pattern: [32m.hostname[0m
[30;1m91 | [0m[35m        subsegment.add_exception(exception, stack)[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35mdef _ignore_request(instance, hostname, url):[0m
[30;1m95 | [0m[35m    global _XRAY_IGNORE[0m
[30;1m96 | [0m[35m    module = instance.__class__.__module__[0m
[30;1m97 | [0m[35m    if module is None or module == str.__class__.__module__:[0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/httplib/patch.py[0m
   Pattern: [32m.hostname[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m    return xray_recorder.record_subsegment([0m
[30;1m73 | [0m[35m        wrapped, instance, args, kwargs,[0m
[30;1m74 | [0m[35m        name=get_hostname(xray_data.url),[0m
[30;1m75 | [0m[35m        namespace='remote',[0m
[30;1m76 | [0m[35m        meta_processor=http_response_processor,[0m
[30;1m77 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/httplib/patch.py[0m
   Pattern: [32m.hostname[0m
[30;1m26 | [0m[35m    global _XRAY_IGNORE[0m
[30;1m27 | [0m[35m    if subclass is not None or hostname is not None or urls is not None:[0m
[30;1m28 | [0m[35m        urls = urls if urls is None else tuple(urls)[0m
[30;1m29 | [0m[35m        _XRAY_IGNORE.add(_XRay_Ignore(subclass=subclass, hostname=hostname, urls=urls))[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35mdef reset_ignored():[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/httplib/patch.py[0m
   Pattern: [32m.hostname[0m
[30;1m26 | [0m[35m    global _XRAY_IGNORE[0m
[30;1m27 | [0m[35m    if subclass is not None or hostname is not None or urls is not None:[0m
[30;1m28 | [0m[35m        urls = urls if urls is None else tuple(urls)[0m
[30;1m29 | [0m[35m        _XRAY_IGNORE.add(_XRay_Ignore(subclass=subclass, hostname=hostname, urls=urls))[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35mdef reset_ignored():[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/httplib/patch.py[0m
   Pattern: [32m.hostname[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35mdef add_ignored(subclass=None, hostname=None, urls=None):[0m
[30;1m26 | [0m[35m    global _XRAY_IGNORE[0m
[30;1m27 | [0m[35m    if subclass is not None or hostname is not None or urls is not None:[0m
[30;1m28 | [0m[35m        urls = urls if urls is None else tuple(urls)[0m
[30;1m29 | [0m[35m        _XRAY_IGNORE.add(_XRay_Ignore(subclass=subclass, hostname=hostname, urls=urls))[0m
[30;1m30 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/httplib/patch.py[0m
   Pattern: [32m.hostname[0m
[30;1m22 | [0m[35m_XRAY_IGNORE = set()[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35mdef add_ignored(subclass=None, hostname=None, urls=None):[0m
[30;1m26 | [0m[35m    global _XRAY_IGNORE[0m
[30;1m27 | [0m[35m    if subclass is not None or hostname is not None or urls is not None:[0m
[30;1m28 | [0m[35m        urls = urls if urls is None else tuple(urls)[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/httplib/patch.py[0m
   Pattern: [32m.hostname[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m_XRAY_PROP = '_xray_prop'[0m
[30;1m17 | [0m[35m_XRay_Data = namedtuple('xray_data', ['method', 'host', 'url'])[0m
[30;1m18 | [0m[35m_XRay_Ignore = namedtuple('xray_ignore', ['subclass', 'hostname', 'urls'])[0m
[30;1m19 | [0m[35m# A flag indicates whether this module is X-Ray patched or not[0m
[30;1m20 | [0m[35mPATCH_FLAG = '__xray_patched'[0m
[30;1m21 | [0m[35m# Calls that should be ignored[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/httplib/patch.py[0m
   Pattern: [32m.hostname[0m
[30;1m8 | [0m[35mfrom aws_xray_sdk.core.exceptions.exceptions import SegmentNotFoundException[0m
[30;1m9 | [0m[35mfrom aws_xray_sdk.core.models import http[0m
[30;1m10 | [0m[35mfrom aws_xray_sdk.core.patcher import _PATCHED_MODULES[0m
[30;1m11 | [0m[35mfrom aws_xray_sdk.ext.util import get_hostname, inject_trace_header, strip_url, unwrap[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mhttplib_client_module = 'http.client'[0m
[30;1m14 | [0m[35mimport http.client as httplib[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/plugins/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m21 | [0m[35m    modules = [][0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    for plugin in plugins:[0m
[30;1m24 | [0m[35m        short_name = PLUGIN_MAPPING.get(plugin.lower(), plugin.lower())[0m
[30;1m25 | [0m[35m        full_path = '%s%s' % (module_prefix, short_name)[0m
[30;1m26 | [0m[35m        modules.append(importlib.import_module(full_path))[0m
[30;1m27 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/async_recorder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom aws_xray_sdk.core.recorder import AWSXRayRecorder[0m
[30;1m4 | [0m[35mfrom aws_xray_sdk.core.utils import stacktrace[0m
[30;1m5 | [0m[35mfrom aws_xray_sdk.core.models.subsegment import SubsegmentContextManager, is_already_recording, subs[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_recorder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m359 | [0m[35mdef test_begin_segment_matches_sampling_rule_on_name():[0m
[30;1m360 | [0m[35m    xray_recorder.configure(sampling=True, sampler=CustomSampler())[0m
[30;1m361 | [0m[35m    segment = xray_recorder.begin_segment("app_b")[0m
[30;1m362 | [0m[35m    assert segment.aws.get('xray').get('sampling_rule_name') == 'rule_b'[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_recorder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m359 | [0m[35mdef test_begin_segment_matches_sampling_rule_on_name():[0m
[30;1m360 | [0m[35m    xray_recorder.configure(sampling=True, sampler=CustomSampler())[0m
[30;1m361 | [0m[35m    segment = xray_recorder.begin_segment("app_b")[0m
[30;1m362 | [0m[35m    assert segment.aws.get('xray').get('sampling_rule_name') == 'rule_b'[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_recorder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m345 | [0m[35m                                       service='app_b')[0m
[30;1m346 | [0m[35m        rule_cache.load_rules([sampling_rule_a, sampling_rule_b])[0m
[30;1m347 | [0m[35m        now = int(time.time())[0m
[30;1m348 | [0m[35m        if sampling_req and not sampling_req.get('service_type', None):[0m
[30;1m349 | [0m[35m            sampling_req['service_type'] = self._origin[0m
[30;1m350 | [0m[35m        elif sampling_req is None:[0m
[30;1m351 | [0m[35m            sampling_req = {'service_type': self._origin}[0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_recorder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m97 | [0m[35m    assert 'value1' == segment.annotations['key1'][0m
[30;1m98 | [0m[35m    assert not segment.annotations.get('key2')[0m
[30;1m99 | [0m[35m    assert 'value2' == subsegment.metadata['default']['key2'][0m
[30;1m100 | [0m[35m    assert not subsegment.metadata['default'].get('key1')[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35mdef test_default_pass_through_with_missing_context():[0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_recorder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m95 | [0m[35m    xray_recorder.put_metadata('key2', 'value2')[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m    assert 'value1' == segment.annotations['key1'][0m
[30;1m98 | [0m[35m    assert not segment.annotations.get('key2')[0m
[30;1m99 | [0m[35m    assert 'value2' == subsegment.metadata['default']['key2'][0m
[30;1m100 | [0m[35m    assert not subsegment.metadata['default'].get('key1')[0m
[30;1m101 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_recorder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m    service = segment.service[0m
[30;1m41 | [0m[35m    assert platform.python_implementation() == service.get('runtime')[0m
[30;1m42 | [0m[35m    assert platform.python_version() == service.get('runtime_version')[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35mdef test_subsegment_parenting():[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_recorder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m38 | [0m[35m    assert VERSION == xray_meta.get('sdk_version')[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m    service = segment.service[0m
[30;1m41 | [0m[35m    assert platform.python_implementation() == service.get('runtime')[0m
[30;1m42 | [0m[35m    assert platform.python_version() == service.get('runtime_version')[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_recorder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35m    segment = xray_recorder.begin_segment('name')[0m
[30;1m36 | [0m[35m    xray_meta = segment.aws.get('xray')[0m
[30;1m37 | [0m[35m    assert 'X-Ray for Python' == xray_meta.get('sdk')[0m
[30;1m38 | [0m[35m    assert VERSION == xray_meta.get('sdk_version')[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m    service = segment.service[0m
[30;1m41 | [0m[35m    assert platform.python_implementation() == service.get('runtime')[0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_recorder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m34 | [0m[35mdef test_default_runtime_context():[0m
[30;1m35 | [0m[35m    segment = xray_recorder.begin_segment('name')[0m
[30;1m36 | [0m[35m    xray_meta = segment.aws.get('xray')[0m
[30;1m37 | [0m[35m    assert 'X-Ray for Python' == xray_meta.get('sdk')[0m
[30;1m38 | [0m[35m    assert VERSION == xray_meta.get('sdk_version')[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m    service = segment.service[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_recorder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35mdef test_default_runtime_context():[0m
[30;1m35 | [0m[35m    segment = xray_recorder.begin_segment('name')[0m
[30;1m36 | [0m[35m    xray_meta = segment.aws.get('xray')[0m
[30;1m37 | [0m[35m    assert 'X-Ray for Python' == xray_meta.get('sdk')[0m
[30;1m38 | [0m[35m    assert VERSION == xray_meta.get('sdk_version')[0m
[30;1m39 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_recorder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m37 | [0m[35m    assert 'X-Ray for Python' == xray_meta.get('sdk')[0m
[30;1m38 | [0m[35m    assert VERSION == xray_meta.get('sdk_version')[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m    service = segment.service[0m
[30;1m41 | [0m[35m    assert platform.python_implementation() == service.get('runtime')[0m
[30;1m42 | [0m[35m    assert platform.python_version() == service.get('runtime_version')[0m
[30;1m43 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_recorder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport platform[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mimport pytest[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom aws_xray_sdk.core.sampling.sampling_rule import SamplingRule[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/daemon_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m50 | [0m[35m            }[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m            tcp_info = mapping.get('tcp')[0m
[30;1m53 | [0m[35m            udp_info = mapping.get('udp')[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m            self._tcp_ip = tcp_info[1][0m
[30;1m56 | [0m[35m            self._tcp_port = int(tcp_info[2])[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/daemon_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m                configs2[0]: configs2,[0m
[30;1m50 | [0m[35m            }[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m            tcp_info = mapping.get('tcp')[0m
[30;1m53 | [0m[35m            udp_info = mapping.get('udp')[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m            self._tcp_ip = tcp_info[1][0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/daemon_config.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m14 | [0m[35m    A notation of '127.0.0.1:2000' or 'tcp:127.0.0.1:2000 udp:127.0.0.2:2001'[0m
[30;1m15 | [0m[35m    are both acceptable. The former one means UDP and TCP are running at[0m
[30;1m16 | [0m[35m    the same address.[0m
[30;1m17 | [0m[35m    By default it assumes a X-Ray daemon running at 127.0.0.1:2000[0m
[30;1m18 | [0m[35m    listening to both UDP and TCP traffic.[0m
[30;1m19 | [0m[35m    """[0m
[30;1m20 | [0m[35m    def __init__(self, daemon_address=DEFAULT_ADDRESS):[0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/daemon_config.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m12 | [0m[35m    string from ``AWS_TRACING_DAEMON_ADDRESS`` and then from recorder's[0m
[30;1m13 | [0m[35m    configuration for ``daemon_address``.[0m
[30;1m14 | [0m[35m    A notation of '127.0.0.1:2000' or 'tcp:127.0.0.1:2000 udp:127.0.0.2:2001'[0m
[30;1m15 | [0m[35m    are both acceptable. The former one means UDP and TCP are running at[0m
[30;1m16 | [0m[35m    the same address.[0m
[30;1m17 | [0m[35m    By default it assumes a X-Ray daemon running at 127.0.0.1:2000[0m
[30;1m18 | [0m[35m    listening to both UDP and TCP traffic.[0m
[30;1m19 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/daemon_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mclass DaemonConfig:[0m
[30;1m10 | [0m[35m    """The class that stores X-Ray daemon configuration about[0m
[30;1m11 | [0m[35m    the ip address and port for UDP and TCP port. It gets the address[0m
[30;1m12 | [0m[35m    string from ``AWS_TRACING_DAEMON_ADDRESS`` and then from recorder's[0m
[30;1m13 | [0m[35m    configuration for ``daemon_address``.[0m
[30;1m14 | [0m[35m    A notation of '127.0.0.1:2000' or 'tcp:127.0.0.1:2000 udp:127.0.0.2:2001'[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/django/conf.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m        if attr not in self.defaults:[0m
[30;1m57 | [0m[35m            raise AttributeError('Invalid setting: %s' % attr)[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m        if self.user_settings.get(attr, None) is not None:[0m
[30;1m60 | [0m[35m            if attr in SUPPORTED_ENV_VARS:[0m
[30;1m61 | [0m[35m                return os.getenv(attr, self.user_settings[attr])[0m
[30;1m62 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/django/conf.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m33 | [0m[35mclass XRaySettings:[0m
[30;1m34 | [0m[35m    """[0m
[30;1m35 | [0m[35m    A object of Django settings to easily modify certain fields.[0m
[30;1m36 | [0m[35m    The precedence for configurations at different places is as follows:[0m
[30;1m37 | [0m[35m    environment variables > user settings in settings.py > default settings[0m
[30;1m38 | [0m[35m    """[0m
[30;1m39 | [0m[35m    def __init__(self, user_settings=None):[0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/django/conf.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m19 | [0m[35m    'PATCH_MODULES': [],[0m
[30;1m20 | [0m[35m    'AUTO_PATCH_PARENT_SEGMENT_NAME': None,[0m
[30;1m21 | [0m[35m    'IGNORE_MODULE_PATTERNS': [],[0m
[30;1m22 | [0m[35m    'URLS_AS_ANNOTATION': 'LAMBDA',  # 3 valid values, NONE -> don't ever, LAMBDA -> only for AWS La[0m
[30;1m23 | [0m[35m}[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35mXRAY_NAMESPACE = 'XRAY_RECORDER'[0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_sampling_rule_cache.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35mimport pytest[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mfrom aws_xray_sdk.core.sampling.sampling_rule import SamplingRule[0m
[30;1m5 | [0m[35mfrom aws_xray_sdk.core.sampling.rule_cache import RuleCache[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/botocore/patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35mdef _xray_traced_botocore(wrapped, instance, args, kwargs):[0m
[30;1m31 | [0m[35m    service = instance._service_model.metadata["endpointPrefix"][0m
[30;1m32 | [0m[35m    if service == 'xray':[0m
[30;1m33 | [0m[35m        # skip tracing for SDK built-in sampling pollers[0m
[30;1m34 | [0m[35m        if ('GetSamplingRules' in args or[0m
[30;1m35 | [0m[35m            'GetSamplingTargets' in args or[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/botocore/patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35mdef _xray_traced_botocore(wrapped, instance, args, kwargs):[0m
[30;1m31 | [0m[35m    service = instance._service_model.metadata["endpointPrefix"][0m
[30;1m32 | [0m[35m    if service == 'xray':[0m
[30;1m33 | [0m[35m        # skip tracing for SDK built-in sampling pollers[0m
[30;1m34 | [0m[35m        if ('GetSamplingRules' in args or[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/local/sampling_rule.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m        self._host = rule_dict.get(self._host_key, None)[0m
[30;1m34 | [0m[35m        self._method = rule_dict.get(self.METHOD, None)[0m
[30;1m35 | [0m[35m        self._path = rule_dict.get(self.PATH, None)[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m        self._default = default[0m
[30;1m38 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/local/sampling_rule.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m        self._rate = rule_dict.get(self.RATE, None)[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m        self._host = rule_dict.get(self._host_key, None)[0m
[30;1m34 | [0m[35m        self._method = rule_dict.get(self.METHOD, None)[0m
[30;1m35 | [0m[35m        self._path = rule_dict.get(self.PATH, None)[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m        self._default = default[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/local/sampling_rule.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m30 | [0m[35m        self._fixed_target = rule_dict.get(self.FIXED_TARGET, None)[0m
[30;1m31 | [0m[35m        self._rate = rule_dict.get(self.RATE, None)[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m        self._host = rule_dict.get(self._host_key, None)[0m
[30;1m34 | [0m[35m        self._method = rule_dict.get(self.METHOD, None)[0m
[30;1m35 | [0m[35m        self._path = rule_dict.get(self.PATH, None)[0m
[30;1m36 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/local/sampling_rule.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m            self._host_key = self.SERVICE_NAME[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m        self._fixed_target = rule_dict.get(self.FIXED_TARGET, None)[0m
[30;1m31 | [0m[35m        self._rate = rule_dict.get(self.RATE, None)[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m        self._host = rule_dict.get(self._host_key, None)[0m
[30;1m34 | [0m[35m        self._method = rule_dict.get(self.METHOD, None)[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/local/sampling_rule.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m        elif version == 1:[0m
[30;1m28 | [0m[35m            self._host_key = self.SERVICE_NAME[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m        self._fixed_target = rule_dict.get(self.FIXED_TARGET, None)[0m
[30;1m31 | [0m[35m        self._rate = rule_dict.get(self.RATE, None)[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m        self._host = rule_dict.get(self._host_key, None)[0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/local/sampler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m        return self._should_trace(self._default_rule)[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    def load_local_rules(self, rules):[0m
[30;1m76 | [0m[35m        version = rules.get('version', None)[0m
[30;1m77 | [0m[35m        if version not in SUPPORTED_RULE_VERSION:[0m
[30;1m78 | [0m[35m            raise InvalidSamplingManifestError('Manifest version: %s is not supported.', version)[0m
[30;1m79 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/local/sampler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m        host = sampling_req.get('host', None)[0m
[30;1m66 | [0m[35m        method = sampling_req.get('method', None)[0m
[30;1m67 | [0m[35m        path = sampling_req.get('path', None)[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m        for rule in self._rules:[0m
[30;1m70 | [0m[35m            if rule.applies(host, method, path):[0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/local/sampler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m63 | [0m[35m            return self._should_trace(self._default_rule)[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m        host = sampling_req.get('host', None)[0m
[30;1m66 | [0m[35m        method = sampling_req.get('method', None)[0m
[30;1m67 | [0m[35m        path = sampling_req.get('path', None)[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m        for rule in self._rules:[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/local/sampler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m        if sampling_req is None:[0m
[30;1m63 | [0m[35m            return self._should_trace(self._default_rule)[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m        host = sampling_req.get('host', None)[0m
[30;1m66 | [0m[35m        method = sampling_req.get('method', None)[0m
[30;1m67 | [0m[35m        path = sampling_req.get('path', None)[0m
[30;1m68 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/util.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m66 | [0m[35m    a ``TraceHeader`` object regardless of tracing header's presence[0m
[30;1m67 | [0m[35m    in the incoming request.[0m
[30;1m68 | [0m[35m    """[0m
[30;1m69 | [0m[35m    header_str = headers.get(http.XRAY_HEADER) or headers.get(http.ALT_XRAY_HEADER)[0m
[30;1m70 | [0m[35m    if header_str:[0m
[30;1m71 | [0m[35m        return TraceHeader.from_header_str(header_str)[0m
[30;1m72 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/util.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m66 | [0m[35m    a ``TraceHeader`` object regardless of tracing header's presence[0m
[30;1m67 | [0m[35m    in the incoming request.[0m
[30;1m68 | [0m[35m    """[0m
[30;1m69 | [0m[35m    header_str = headers.get(http.XRAY_HEADER) or headers.get(http.ALT_XRAY_HEADER)[0m
[30;1m70 | [0m[35m    if header_str:[0m
[30;1m71 | [0m[35m        return TraceHeader.from_header_str(header_str)[0m
[30;1m72 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/util.py[0m
   Pattern: [32m.hostname[0m
[30;1m125 | [0m[35m    hostname = url_parse.hostname[0m
[30;1m126 | [0m[35m    if hostname is None:[0m
[30;1m127 | [0m[35m        return UNKNOWN_HOSTNAME[0m
[30;1m128 | [0m[35m    return hostname if hostname else url  # If hostname is none, we return the regular URL; indicati[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35mdef unwrap(obj, attr):[0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/util.py[0m
   Pattern: [32m.hostname[0m
[30;1m125 | [0m[35m    hostname = url_parse.hostname[0m
[30;1m126 | [0m[35m    if hostname is None:[0m
[30;1m127 | [0m[35m        return UNKNOWN_HOSTNAME[0m
[30;1m128 | [0m[35m    return hostname if hostname else url  # If hostname is none, we return the regular URL; indicati[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35mdef unwrap(obj, attr):[0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/util.py[0m
   Pattern: [32m.hostname[0m
[30;1m125 | [0m[35m    hostname = url_parse.hostname[0m
[30;1m126 | [0m[35m    if hostname is None:[0m
[30;1m127 | [0m[35m        return UNKNOWN_HOSTNAME[0m
[30;1m128 | [0m[35m    return hostname if hostname else url  # If hostname is none, we return the regular URL; indicati[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35mdef unwrap(obj, attr):[0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/util.py[0m
   Pattern: [32m.hostname[0m
[30;1m123 | [0m[35m        return UNKNOWN_HOSTNAME[0m
[30;1m124 | [0m[35m    url_parse = urlparse(url)[0m
[30;1m125 | [0m[35m    hostname = url_parse.hostname[0m
[30;1m126 | [0m[35m    if hostname is None:[0m
[30;1m127 | [0m[35m        return UNKNOWN_HOSTNAME[0m
[30;1m128 | [0m[35m    return hostname if hostname else url  # If hostname is none, we return the regular URL; indicati[0m
[30;1m129 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/util.py[0m
   Pattern: [32m.hostname[0m
[30;1m122 | [0m[35m    if url is None:[0m
[30;1m123 | [0m[35m        return UNKNOWN_HOSTNAME[0m
[30;1m124 | [0m[35m    url_parse = urlparse(url)[0m
[30;1m125 | [0m[35m    hostname = url_parse.hostname[0m
[30;1m126 | [0m[35m    if hostname is None:[0m
[30;1m127 | [0m[35m        return UNKNOWN_HOSTNAME[0m
[30;1m128 | [0m[35m    return hostname if hostname else url  # If hostname is none, we return the regular URL; indicati[0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/util.py[0m
   Pattern: [32m.hostname[0m
[30;1m122 | [0m[35m    if url is None:[0m
[30;1m123 | [0m[35m        return UNKNOWN_HOSTNAME[0m
[30;1m124 | [0m[35m    url_parse = urlparse(url)[0m
[30;1m125 | [0m[35m    hostname = url_parse.hostname[0m
[30;1m126 | [0m[35m    if hostname is None:[0m
[30;1m127 | [0m[35m        return UNKNOWN_HOSTNAME[0m
[30;1m128 | [0m[35m    return hostname if hostname else url  # If hostname is none, we return the regular URL; indicati[0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/util.py[0m
   Pattern: [32m.hostname[0m
[30;1m118 | [0m[35m    return url.partition('?')[0] if url else url[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35mdef get_hostname(url):[0m
[30;1m122 | [0m[35m    if url is None:[0m
[30;1m123 | [0m[35m        return UNKNOWN_HOSTNAME[0m
[30;1m124 | [0m[35m    url_parse = urlparse(url)[0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/lambda_launcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m101 | [0m[35m    def _refresh_context(self):[0m
[30;1m102 | [0m[35m        """[0m
[30;1m103 | [0m[35m        Get current segment. To prevent resource leaking in Lambda worker,[0m
[30;1m104 | [0m[35m        every time there is segment present, we compare its trace id to current[0m
[30;1m105 | [0m[35m        environment variables. If it is different we create a new segment[0m
[30;1m106 | [0m[35m        and clean up subsegments stored.[0m
[30;1m107 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/lambda_launcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m    def put_subsegment(self, subsegment):[0m
[30;1m68 | [0m[35m        """[0m
[30;1m69 | [0m[35m        Refresh the segment every time this function is invoked to prevent[0m
[30;1m70 | [0m[35m        a new subsegment from being attached to a leaked segment/subsegment.[0m
[30;1m71 | [0m[35m        """[0m
[30;1m72 | [0m[35m        current_entity = self.get_trace_entity()[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/lambda_launcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m    """[0m
[30;1m46 | [0m[35m    Lambda service will generate a segment for each function invocation which[0m
[30;1m47 | [0m[35m    cannot be mutated. The context doesn't keep any manually created segment[0m
[30;1m48 | [0m[35m    but instead every time ``get_trace_entity()`` gets called it refresh the[0m
[30;1m49 | [0m[35m    segment based on environment variables set by Lambda worker.[0m
[30;1m50 | [0m[35m    """[0m
[30;1m51 | [0m[35m    def __init__(self):[0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/lambda_launcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35mclass LambdaContext(Context):[0m
[30;1m45 | [0m[35m    """[0m
[30;1m46 | [0m[35m    Lambda service will generate a segment for each function invocation which[0m
[30;1m47 | [0m[35m    cannot be mutated. The context doesn't keep any manually created segment[0m
[30;1m48 | [0m[35m    but instead every time ``get_trace_entity()`` gets called it refresh the[0m
[30;1m49 | [0m[35m    segment based on environment variables set by Lambda worker.[0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/flask_sqlalchemy/query.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m        # mapper is None if someone tries to just get a connection[0m
[30;1m44 | [0m[35m        if mapper is not None:[0m
[30;1m45 | [0m[35m            info = getattr(mapper.mapped_table, 'info', {})[0m
[30;1m46 | [0m[35m            bind_key = info.get('bind_key')[0m
[30;1m47 | [0m[35m            if bind_key is not None:[0m
[30;1m48 | [0m[35m                state = get_state(self.app)[0m
[30;1m49 | [0m[35m                return state.db.get_engine(self.app, bind=bind_key)[0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/local/reservoir.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35mimport threading[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mclass Reservoir:[0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/sampling_rule.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m40 | [0m[35m        method = sampling_req.get('method', None)[0m
[30;1m41 | [0m[35m        path = sampling_req.get('path', None)[0m
[30;1m42 | [0m[35m        service = sampling_req.get('service', None)[0m
[30;1m43 | [0m[35m        service_type = sampling_req.get('service_type', None)[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m        return (not host or wildcard_match(self._host, host)) \[0m
[30;1m46 | [0m[35m            and (not method or wildcard_match(self._method, method)) \[0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/sampling_rule.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m39 | [0m[35m        host = sampling_req.get('host', None)[0m
[30;1m40 | [0m[35m        method = sampling_req.get('method', None)[0m
[30;1m41 | [0m[35m        path = sampling_req.get('path', None)[0m
[30;1m42 | [0m[35m        service = sampling_req.get('service', None)[0m
[30;1m43 | [0m[35m        service_type = sampling_req.get('service_type', None)[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m        return (not host or wildcard_match(self._host, host)) \[0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/sampling_rule.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m        host = sampling_req.get('host', None)[0m
[30;1m40 | [0m[35m        method = sampling_req.get('method', None)[0m
[30;1m41 | [0m[35m        path = sampling_req.get('path', None)[0m
[30;1m42 | [0m[35m        service = sampling_req.get('service', None)[0m
[30;1m43 | [0m[35m        service_type = sampling_req.get('service_type', None)[0m
[30;1m44 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/sampling_rule.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m37 | [0m[35m            return False[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m        host = sampling_req.get('host', None)[0m
[30;1m40 | [0m[35m        method = sampling_req.get('method', None)[0m
[30;1m41 | [0m[35m        path = sampling_req.get('path', None)[0m
[30;1m42 | [0m[35m        service = sampling_req.get('service', None)[0m
[30;1m43 | [0m[35m        service_type = sampling_req.get('service_type', None)[0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/sampling_rule.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m36 | [0m[35m        if sampling_req is None:[0m
[30;1m37 | [0m[35m            return False[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m        host = sampling_req.get('host', None)[0m
[30;1m40 | [0m[35m        method = sampling_req.get('method', None)[0m
[30;1m41 | [0m[35m        path = sampling_req.get('path', None)[0m
[30;1m42 | [0m[35m        service = sampling_req.get('service', None)[0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/sampling_rule.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m    def time_to_report(self):[0m
[30;1m90 | [0m[35m        """[0m
[30;1m91 | [0m[35m        Returns ``True`` if it is time to report sampling statistics[0m
[30;1m92 | [0m[35m        of this rule to refresh quota information for its reservoir.[0m
[30;1m93 | [0m[35m        """[0m
[30;1m94 | [0m[35m        return self.reservoir._time_to_report()[0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/sampling_rule.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m        return (not host or wildcard_match(self._host, host)) \[0m
[30;1m46 | [0m[35m            and (not method or wildcard_match(self._method, method)) \[0m
[30;1m47 | [0m[35m            and (not path or wildcard_match(self._path, path)) \[0m
[30;1m48 | [0m[35m            and (not service or wildcard_match(self._service, service)) \[0m
[30;1m49 | [0m[35m            and (not service_type or wildcard_match(self._service_type, service_type))[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    def is_default(self):[0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/sampling_rule.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35m        host = sampling_req.get('host', None)[0m
[30;1m40 | [0m[35m        method = sampling_req.get('method', None)[0m
[30;1m41 | [0m[35m        path = sampling_req.get('path', None)[0m
[30;1m42 | [0m[35m        service = sampling_req.get('service', None)[0m
[30;1m43 | [0m[35m        service_type = sampling_req.get('service_type', None)[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m        return (not host or wildcard_match(self._host, host)) \[0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/sampling_rule.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m19 | [0m[35m        self._host = host[0m
[30;1m20 | [0m[35m        self._method = method[0m
[30;1m21 | [0m[35m        self._path = path[0m
[30;1m22 | [0m[35m        self._service = service[0m
[30;1m23 | [0m[35m        self._service_type = service_type[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m        self._reservoir = Reservoir()[0m
[30;1m26 | [0m[35m        self._reset_statistics()[0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/boto_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m    aws_meta['request_id'] = response_metadata.get('RequestId')[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m    status_code = response_metadata.get('HTTPStatusCode')[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m    subsegment.put_http_meta(http.STATUS, status_code)[0m
[30;1m83 | [0m[35m    subsegment.add_exception(exception, stack, True)[0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/boto_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m75 | [0m[35m    if not response_metadata:[0m
[30;1m76 | [0m[35m        return[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m    aws_meta['request_id'] = response_metadata.get('RequestId')[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m    status_code = response_metadata.get('HTTPStatusCode')[0m
[30;1m81 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/boto_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m70 | [0m[35m    if not exception or not isinstance(exception, ClientError):[0m
[30;1m71 | [0m[35m        return[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m    response_metadata = exception.response.get('ResponseMetadata')[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    if not response_metadata:[0m
[30;1m76 | [0m[35m        return[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/boto_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m53 | [0m[35m            subsegment.put_http_meta(http.STATUS,[0m
[30;1m54 | [0m[35m                                     resp_meta.get('HTTPStatusCode'))[0m
[30;1m55 | [0m[35m            # for service like S3 that returns special request id in response headers[0m
[30;1m56 | [0m[35m            if 'HTTPHeaders' in resp_meta and resp_meta['HTTPHeaders'].get('x-amz-id-2'):[0m
[30;1m57 | [0m[35m                aws_meta['id_2'] = resp_meta['HTTPHeaders']['x-amz-id-2'][0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m    elif exception:[0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/boto_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m51 | [0m[35m        if resp_meta:[0m
[30;1m52 | [0m[35m            aws_meta['request_id'] = resp_meta.get('RequestId')[0m
[30;1m53 | [0m[35m            subsegment.put_http_meta(http.STATUS,[0m
[30;1m54 | [0m[35m                                     resp_meta.get('HTTPStatusCode'))[0m
[30;1m55 | [0m[35m            # for service like S3 that returns special request id in response headers[0m
[30;1m56 | [0m[35m            if 'HTTPHeaders' in resp_meta and resp_meta['HTTPHeaders'].get('x-amz-id-2'):[0m
[30;1m57 | [0m[35m                aws_meta['id_2'] = resp_meta['HTTPHeaders']['x-amz-id-2'][0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/boto_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m    if return_value:[0m
[30;1m50 | [0m[35m        resp_meta = return_value.get('ResponseMetadata')[0m
[30;1m51 | [0m[35m        if resp_meta:[0m
[30;1m52 | [0m[35m            aws_meta['request_id'] = resp_meta.get('RequestId')[0m
[30;1m53 | [0m[35m            subsegment.put_http_meta(http.STATUS,[0m
[30;1m54 | [0m[35m                                     resp_meta.get('HTTPStatusCode'))[0m
[30;1m55 | [0m[35m            # for service like S3 that returns special request id in response headers[0m

[31m--[ [0m[34mMatch #[0m[33m232[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/boto_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m47 | [0m[35m    }[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m    if return_value:[0m
[30;1m50 | [0m[35m        resp_meta = return_value.get('ResponseMetadata')[0m
[30;1m51 | [0m[35m        if resp_meta:[0m
[30;1m52 | [0m[35m            aws_meta['request_id'] = resp_meta.get('RequestId')[0m
[30;1m53 | [0m[35m            subsegment.put_http_meta(http.STATUS,[0m

[31m--[ [0m[34mMatch #[0m[33m233[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/boto_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m87 | [0m[35m                                aws_meta, args, kwargs, response):[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m    # check if service is whitelisted[0m
[30;1m90 | [0m[35m    if service not in whitelist['services']:[0m
[30;1m91 | [0m[35m        return[0m
[30;1m92 | [0m[35m    operations = whitelist['services'][service]['operations'][0m
[30;1m93 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m234[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/boto_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m86 | [0m[35mdef _extract_whitelisted_params(service, operation,[0m
[30;1m87 | [0m[35m                                aws_meta, args, kwargs, response):[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m    # check if service is whitelisted[0m
[30;1m90 | [0m[35m    if service not in whitelist['services']:[0m
[30;1m91 | [0m[35m        return[0m
[30;1m92 | [0m[35m    operations = whitelist['services'][service]['operations'][0m

[31m--[ [0m[34mMatch #[0m[33m235[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/boto_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m52 | [0m[35m            aws_meta['request_id'] = resp_meta.get('RequestId')[0m
[30;1m53 | [0m[35m            subsegment.put_http_meta(http.STATUS,[0m
[30;1m54 | [0m[35m                                     resp_meta.get('HTTPStatusCode'))[0m
[30;1m55 | [0m[35m            # for service like S3 that returns special request id in response headers[0m
[30;1m56 | [0m[35m            if 'HTTPHeaders' in resp_meta and resp_meta['HTTPHeaders'].get('x-amz-id-2'):[0m
[30;1m57 | [0m[35m                aws_meta['id_2'] = resp_meta['HTTPHeaders']['x-amz-id-2'][0m
[30;1m58 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m236[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/rule_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    def _load_targets(self, targets_dict):[0m
[30;1m58 | [0m[35m        for rule in self.rules:[0m
[30;1m59 | [0m[35m            target = targets_dict.get(rule.name, None)[0m
[30;1m60 | [0m[35m            if target:[0m
[30;1m61 | [0m[35m                rule.reservoir.load_quota(target['quota'],[0m
[30;1m62 | [0m[35m                                          target['TTL'],[0m

[31m--[ [0m[34mMatch #[0m[33m237[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/rule_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m        # Transfer state information to refreshed rules.[0m
[30;1m47 | [0m[35m        for rule in self.rules:[0m
[30;1m48 | [0m[35m            old = oldRules.get(rule.name, None)[0m
[30;1m49 | [0m[35m            if old:[0m
[30;1m50 | [0m[35m                rule.merge(old)[0m
[30;1m51 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m238[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/rule_cache.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m50 | [0m[35m                rule.merge(old)[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m        # The cache should maintain the order of the rules based on[0m
[30;1m53 | [0m[35m        # priority. If priority is the same we sort name by alphabet[0m
[30;1m54 | [0m[35m        # as rule name is unique.[0m
[30;1m55 | [0m[35m        self.rules.sort(key=attrgetter('priority', 'name'))[0m
[30;1m56 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m239[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/rule_cache.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m40 | [0m[35m        for rule in self.rules:[0m
[30;1m41 | [0m[35m            oldRules[rule.name] = rule[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m        # Update the rules in the cache.[0m
[30;1m44 | [0m[35m        self.rules = rules[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m        # Transfer state information to refreshed rules.[0m

[31m--[ [0m[34mMatch #[0m[33m240[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/flask/middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m        resp_header_str = prepare_response_header(origin_header, segment)[0m
[30;1m78 | [0m[35m        response.headers[http.XRAY_HEADER] = resp_header_str[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m        cont_len = response.headers.get('Content-Length')[0m
[30;1m81 | [0m[35m        if cont_len:[0m
[30;1m82 | [0m[35m            segment.put_http_meta(http.CONTENT_LENGTH, int(cont_len))[0m
[30;1m83 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m241[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/flask/middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m        segment.put_http_meta(http.METHOD, req.method)[0m
[30;1m60 | [0m[35m        segment.put_http_meta(http.USER_AGENT, headers.get('User-Agent'))[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m        client_ip = headers.get('X-Forwarded-For') or headers.get('HTTP_X_FORWARDED_FOR')[0m
[30;1m63 | [0m[35m        if client_ip:[0m
[30;1m64 | [0m[35m            segment.put_http_meta(http.CLIENT_IP, client_ip)[0m
[30;1m65 | [0m[35m            segment.put_http_meta(http.X_FORWARDED_FOR, True)[0m

[31m--[ [0m[34mMatch #[0m[33m242[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/flask/middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m        segment.put_http_meta(http.METHOD, req.method)[0m
[30;1m60 | [0m[35m        segment.put_http_meta(http.USER_AGENT, headers.get('User-Agent'))[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m        client_ip = headers.get('X-Forwarded-For') or headers.get('HTTP_X_FORWARDED_FOR')[0m
[30;1m63 | [0m[35m        if client_ip:[0m
[30;1m64 | [0m[35m            segment.put_http_meta(http.CLIENT_IP, client_ip)[0m
[30;1m65 | [0m[35m            segment.put_http_meta(http.X_FORWARDED_FOR, True)[0m

[31m--[ [0m[34mMatch #[0m[33m243[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/flask/middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m57 | [0m[35m        segment.save_origin_trace_header(xray_header)[0m
[30;1m58 | [0m[35m        segment.put_http_meta(http.URL, req.base_url)[0m
[30;1m59 | [0m[35m        segment.put_http_meta(http.METHOD, req.method)[0m
[30;1m60 | [0m[35m        segment.put_http_meta(http.USER_AGENT, headers.get('User-Agent'))[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m        client_ip = headers.get('X-Forwarded-For') or headers.get('HTTP_X_FORWARDED_FOR')[0m
[30;1m63 | [0m[35m        if client_ip:[0m

[31m--[ [0m[34mMatch #[0m[33m244[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/models/segment.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m151 | [0m[35m        if a segment is sampled because of that rule.[0m
[30;1m152 | [0m[35m        This method should be only used by the recorder.[0m
[30;1m153 | [0m[35m        """[0m
[30;1m154 | [0m[35m        if not self.aws.get('xray', None):[0m
[30;1m155 | [0m[35m            self.aws['xray'] = {}[0m
[30;1m156 | [0m[35m        self.aws['xray']['sampling_rule_name'] = rule_name[0m
[30;1m157 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m245[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/aiohttp/middleware.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m    """[0m
[30;1m19 | [0m[35m    # Create X-Ray headers[0m
[30;1m20 | [0m[35m    xray_header = construct_xray_header(request.headers)[0m
[30;1m21 | [0m[35m    # Get name of service or generate a dynamic one from host[0m
[30;1m22 | [0m[35m    name = calculate_segment_name(request.headers['host'].split(':', 1)[0], xray_recorder)[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m    sampling_req = {[0m

[31m--[ [0m[34mMatch #[0m[33m246[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/models/traceid.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport os[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35mimport binascii[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mclass TraceId:[0m

[31m--[ [0m[34mMatch #[0m[33m247[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_async_recorder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m    service = segment.service[0m
[30;1m46 | [0m[35m    assert platform.python_implementation() == service.get('runtime')[0m
[30;1m47 | [0m[35m    assert platform.python_version() == service.get('runtime_version')[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35masync def test_concurrent_calls(event_loop):[0m
[30;1m50 | [0m[35m    xray_recorder.configure([0m

[31m--[ [0m[34mMatch #[0m[33m248[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_async_recorder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m    assert VERSION == xray_meta.get('sdk_version')[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m    service = segment.service[0m
[30;1m46 | [0m[35m    assert platform.python_implementation() == service.get('runtime')[0m
[30;1m47 | [0m[35m    assert platform.python_version() == service.get('runtime_version')[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35masync def test_concurrent_calls(event_loop):[0m

[31m--[ [0m[34mMatch #[0m[33m249[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_async_recorder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m40 | [0m[35m    # Check runtime context is correctly attached[0m
[30;1m41 | [0m[35m    xray_meta = segment.aws.get('xray')[0m
[30;1m42 | [0m[35m    assert 'X-Ray for Python' == xray_meta.get('sdk')[0m
[30;1m43 | [0m[35m    assert VERSION == xray_meta.get('sdk_version')[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m    service = segment.service[0m
[30;1m46 | [0m[35m    assert platform.python_implementation() == service.get('runtime')[0m

[31m--[ [0m[34mMatch #[0m[33m250[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_async_recorder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m    # Check runtime context is correctly attached[0m
[30;1m41 | [0m[35m    xray_meta = segment.aws.get('xray')[0m
[30;1m42 | [0m[35m    assert 'X-Ray for Python' == xray_meta.get('sdk')[0m
[30;1m43 | [0m[35m    assert VERSION == xray_meta.get('sdk_version')[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m    service = segment.service[0m

[31m--[ [0m[34mMatch #[0m[33m251[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_async_recorder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m38 | [0m[35m    assert subsegment.subsegments[0].name == 'test_2'[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m    # Check runtime context is correctly attached[0m
[30;1m41 | [0m[35m    xray_meta = segment.aws.get('xray')[0m
[30;1m42 | [0m[35m    assert 'X-Ray for Python' == xray_meta.get('sdk')[0m
[30;1m43 | [0m[35m    assert VERSION == xray_meta.get('sdk_version')[0m
[30;1m44 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m252[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_async_recorder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m42 | [0m[35m    assert 'X-Ray for Python' == xray_meta.get('sdk')[0m
[30;1m43 | [0m[35m    assert VERSION == xray_meta.get('sdk_version')[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m    service = segment.service[0m
[30;1m46 | [0m[35m    assert platform.python_implementation() == service.get('runtime')[0m
[30;1m47 | [0m[35m    assert platform.python_version() == service.get('runtime_version')[0m
[30;1m48 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m253[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_sdk_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35mdef test_invalid_env_string():[0m
[30;1m85 | [0m[35m    os.environ[XRAY_ENABLED_KEY] = "INVALID"[0m
[30;1m86 | [0m[35m    # Env Variable takes precedence. This is called to activate the internal check[0m
[30;1m87 | [0m[35m    global_sdk_config.set_sdk_enabled(True)[0m
[30;1m88 | [0m[35m    assert global_sdk_config.sdk_enabled() is True[0m
[30;1m89 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m254[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_sdk_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35mdef test_env_enable_case():[0m
[30;1m50 | [0m[35m    os.environ[XRAY_ENABLED_KEY] = "TrUE"[0m
[30;1m51 | [0m[35m    # Env Variable takes precedence. This is called to activate the internal check[0m
[30;1m52 | [0m[35m    global_sdk_config.set_sdk_enabled(True)[0m
[30;1m53 | [0m[35m    assert global_sdk_config.sdk_enabled() is True[0m
[30;1m54 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m255[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/tests/test_sdk_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35mdef test_env_var_precedence():[0m
[30;1m31 | [0m[35m    os.environ[XRAY_ENABLED_KEY] = "true"[0m
[30;1m32 | [0m[35m    # Env Variable takes precedence. This is called to activate the internal check[0m
[30;1m33 | [0m[35m    global_sdk_config.set_sdk_enabled(False)[0m
[30;1m34 | [0m[35m    assert global_sdk_config.sdk_enabled() is True[0m
[30;1m35 | [0m[35m    os.environ[XRAY_ENABLED_KEY] = "false"[0m

[31m--[ [0m[34mMatch #[0m[33m256[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/core/emitters/udp_emitter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m    def set_daemon_address(self, address):[0m
[30;1m46 | [0m[35m        """[0m
[30;1m47 | [0m[35m        Set up UDP ip and port from the raw daemon address[0m
[30;1m48 | [0m[35m        string using ``DaemonConfig`` class utlities.[0m
[30;1m49 | [0m[35m        """[0m
[30;1m50 | [0m[35m        if address:[0m

[31m--[ [0m[34mMatch #[0m[33m257[0m[34m of [0m[33m257[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/sqlite3/patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport wrapt[0m
[30;1m2 | [0m[35mimport sqlite3[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mfrom aws_xray_sdk.ext.dbapi2 import XRayTracedConn[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m[0m

257 matches found.
